#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:01:30 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.952518979656 AA    0.000000000000   0.000000000000   1.800000000000 Bohr   0.0

nuclear repulsion = 20
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  0.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:        61.81


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp3_qyok74
max_memory 4000 MB (current use 160 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.1366469280558

WARN: Singularity detected in overlap matrix (condition number = 1.91e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.411563442743743  LUMO (Ag) = -0.232616164544876
cycle= 1 E= -75.1160073846338  delta_E= 1.02  |g|= 0.175  |ddm|= 1.65
HOMO (B1u) = -0.462886704875275  LUMO (Ag) = -0.0990177048643883
cycle= 2 E= -75.1270298311364  delta_E= -0.011  |g|= 0.057  |ddm|= 0.233
HOMO (B1u) = -0.438000780243469  LUMO (Ag) = -0.078929320281592
cycle= 3 E= -75.1282984729017  delta_E= -0.00127  |g|= 0.0157  |ddm|= 0.191
HOMO (B1u) = -0.440879448397981  LUMO (Ag) = -0.0869420301347723
cycle= 4 E= -75.1284487654917  delta_E= -0.00015  |g|= 0.00222  |ddm|= 0.0862
HOMO (B1u) = -0.441380240119146  LUMO (Ag) = -0.0882782976431982
cycle= 5 E= -75.1284520756329  delta_E= -3.31e-06  |g|= 0.000419  |ddm|= 0.0158
HOMO (B1u) = -0.441351661772561  LUMO (Ag) = -0.0881933274529143
cycle= 6 E= -75.1284521927704  delta_E= -1.17e-07  |g|= 2.77e-05  |ddm|= 0.00246
HOMO (B1u) = -0.441354048137821  LUMO (Ag) = -0.0881978149646894
cycle= 7 E= -75.1284521931898  delta_E= -4.19e-10  |g|= 1.77e-06  |ddm|= 0.000613
HOMO (B1u) = -0.441354076509795  LUMO (Ag) = -0.0881971474463695
cycle= 8 E= -75.128452193191  delta_E= -1.18e-12  |g|= 1.61e-07  |ddm|= 3.45e-05
HOMO (B1u) = -0.441354065704747  LUMO (Ag) = -0.0881971923695103
cycle= 9 E= -75.128452193191  delta_E= 7.11e-14  |g|= 1.18e-08  |ddm|= 1.67e-06
HOMO (B1u) = -0.441354065629878  LUMO (Ag) = -0.0881971880082743
cycle= 10 E= -75.128452193191  delta_E= -1.42e-14  |g|= 5.5e-09  |ddm|= 1.02e-07
HOMO (B1u) = -0.44135406550541  LUMO (Ag) = -0.088197187392723
cycle= 11 E= -75.128452193191  delta_E= -4.26e-14  |g|= 6.54e-10  |ddm|= 4.08e-08
HOMO (B1u) = -0.44135406554053  LUMO (Ag) = -0.0881971874471771
cycle= 12 E= -75.128452193191  delta_E= 5.68e-14  |g|= 4.36e-10  |ddm|= 2.26e-09
HOMO (B1u) = -0.441354065564895  LUMO (Ag) = -0.0881971875227354
cycle= 13 E= -75.128452193191  delta_E= -1.42e-14  |g|= 3.59e-10  |ddm|= 1.55e-09
HOMO (B1u) = -0.441354065534414  LUMO (Ag) = -0.0881971874633769
cycle= 14 E= -75.1284521931911  delta_E= -1.28e-13  |g|= 3.24e-10  |ddm|= 2.01e-09
HOMO (B1u) = -0.441354065500789  LUMO (Ag) = -0.0881971874077536
cycle= 15 E= -75.128452193191  delta_E= 8.53e-14  |g|= 3.92e-10  |ddm|= 4.72e-09
HOMO (B1u) = -0.441354065495858  LUMO (Ag) = -0.0881971874739294
cycle= 16 E= -75.128452193191  delta_E= -2.84e-14  |g|= 4.3e-10  |ddm|= 1.11e-08
HOMO (B1u) = -0.441354065536033  LUMO (Ag) = -0.0881971875100831
cycle= 17 E= -75.1284521931911  delta_E= -4.26e-14  |g|= 4.35e-10  |ddm|= 3.77e-10
HOMO (B1u) = -0.441354065584118  LUMO (Ag) = -0.088197187525531
cycle= 18 E= -75.128452193191  delta_E= 1.14e-13  |g|= 1.74e-10  |ddm|= 3.91e-09
HOMO (B1u) = -0.441354065575462  LUMO (Ag) = -0.0881971875104367
cycle= 19 E= -75.128452193191  delta_E= -4.26e-14  |g|= 6.19e-11  |ddm|= 1.07e-09
HOMO (B1u) = -0.441354065569851  LUMO (Ag) = -0.0881971875050107
cycle= 20 E= -75.1284521931911  delta_E= -5.68e-14  |g|= 5.18e-11  |ddm|= 6.92e-11
HOMO (B1u) = -0.441354065566616  LUMO (Ag) = -0.0881971875020764
cycle= 21 E= -75.1284521931911  delta_E= -5.68e-14  |g|= 4.66e-11  |ddm|= 2.54e-11
HOMO (B1u) = -0.441354065565958  LUMO (Ag) = -0.0881971875002064
cycle= 22 E= -75.128452193191  delta_E= 1.28e-13  |g|= 4.17e-11  |ddm|= 1.05e-11
HOMO (B1u) = -0.441354065565441  LUMO (Ag) = -0.0881971874998631
cycle= 23 E= -75.128452193191  delta_E= -2.84e-14  |g|= 4.17e-11  |ddm|= 3.43e-11
HOMO (B1u) = -0.441354065563011  LUMO (Ag) = -0.0881971874974826
cycle= 24 E= -75.128452193191  delta_E= 4.26e-14  |g|= 3.87e-11  |ddm|= 1.86e-10
HOMO (B1u) = -0.441354065559852  LUMO (Ag) = -0.0881971874906618
cycle= 25 E= -75.1284521931911  delta_E= -8.53e-14  |g|= 2.67e-11  |ddm|= 1.31e-10
HOMO (B1u) = -0.441354065557449  LUMO (Ag) = -0.0881971874853407
cycle= 26 E= -75.1284521931911  delta_E=    0  |g|= 1.49e-11  |ddm|= 1.37e-10
HOMO (B1u) = -0.441354065559088  LUMO (Ag) = -0.0881971874857111
Extra cycle  E= -75.1284521931909  delta_E= 1.42e-13  |g|= 4.54e-12  |ddm|= 5.51e-11
converged SCF energy = -75.1284521931909

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp3_qyok74
max_memory 4000 MB (current use 178 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.2773851266858  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.2921612576827  dE = -0.014776131  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3054533419386  dE = -0.013292084  S^2 = 0.0000000
               |grad[o]|=0.122  |ddm|=0.0317  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.317166594693  dE = -0.011713253  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|=0.022  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3257563504441  dE = -0.0085897558  S^2 = 0.0000000
               |grad[o]|=0.0806  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3312100963383  dE = -0.0054537459  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.00664  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3353808863999  dE = -0.0041707901  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3388115105725  dE = -0.0034306242  S^2 = 0.0000000
               |grad[o]|=0.0423  |ddm|=0.00197  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.341693793746  dE = -0.0028822832  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.00139  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.3441068786165  dE = -0.0024130849  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.00119  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.3460868967709  dE = -0.0019800182  S^2 = 0.0000000
               |grad[o]|=0.023  |ddm|=0.00138  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.3476533594343  dE = -0.0015664627  S^2 = 0.0000000
               |grad[o]|=0.0181  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.3488207504315  dE = -0.001167391  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00222  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.349602192022  dE = -0.00078144159  S^2 = 0.0000000
               |grad[o]|=0.00962  |ddm|=0.00269  |maxRot[o]|=0.0799
macro iter 14 (6 JK  0 micro), CASSCF E = -75.3500076021293  dE = -0.00040541011  S^2 = 0.0000000
               |grad[o]|=0.00596  |ddm|=0.00323  |maxRot[o]|=0.0799
macro iter 15 (4 JK  0 micro), CASSCF E = -75.3500690559526  dE = -6.1453823e-05  S^2 = 0.0000000
               |grad[o]|=0.00259  |ddm|=0.004  |maxRot[o]|=0.0356
macro iter 16 (3 JK  0 micro), CASSCF E = -75.3500711296794  dE = -2.0737268e-06  S^2 = 0.0000000
               |grad[o]|=0.000771  |ddm|=0.00302  |maxRot[o]|=0.0056
macro iter 17 (3 JK  0 micro), CASSCF E = -75.3500712273195  dE = -9.7640111e-08  S^2 = 0.0000000
               |grad[o]|=0.000204  |ddm|=0.00102  |maxRot[o]|=0.00111
macro iter 18 (3 JK  0 micro), CASSCF E = -75.3500712324682  dE = -5.1486495e-09  S^2 = 0.0000000
               |grad[o]|=5.3e-05  |ddm|=0.000289  |maxRot[o]|=0.000238
macro iter 19 (3 JK  0 micro), CASSCF E = -75.350071232753  dE = -2.8484237e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=6.97e-05  |maxRot[o]|=5.33e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.3500712327692  dE = -1.6171953e-11  S^2 = 0.0000000
               |grad[o]|=3.36e-06  |ddm|=1.72e-05  |maxRot[o]|=1.23e-05
2-step CASSCF converged in 20 macro (102 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99117055 1.9483733  1.94837323 1.38207917 0.61632491 0.05352421
 0.05352413 0.0066305 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00026   0.00000   0.00000   0.00156  -0.00335
  0 C 2s       0.56540   0.00000  -0.00000   0.40871  -0.42139
  0 C 3s      -0.05874   0.00000  -0.00000   0.01072  -0.04347
  0 C 2px     -0.00000  -0.00000   0.70297  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70297  -0.00000  -0.00000  -0.00000
  0 C 2pz      0.41246   0.00000  -0.00000  -0.57668   0.56528
  0 C 3px      0.00000   0.00000  -0.06368  -0.00000   0.00000
  0 C 3py     -0.00000  -0.06368   0.00000  -0.00000  -0.00000
  0 C 3pz     -0.06271   0.00000  -0.00000  -0.01322  -0.02762
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.04218   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.05310   0.00000  -0.00000   0.01011   0.01522
  0 C 3dxz    -0.00000   0.00000   0.04218  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s      -0.00026   0.00000   0.00000  -0.00156  -0.00335
  1 C 2s       0.56540  -0.00000   0.00000  -0.40871  -0.42139
  1 C 3s      -0.05874  -0.00000   0.00000  -0.01072  -0.04347
  1 C 2px      0.00000  -0.00000   0.70297   0.00000  -0.00000
  1 C 2py      0.00000   0.70297  -0.00000   0.00000   0.00000
  1 C 2pz     -0.41246   0.00000   0.00000  -0.57668  -0.56528
  1 C 3px      0.00000  -0.00000  -0.06368   0.00000   0.00000
  1 C 3py      0.00000  -0.06368   0.00000   0.00000   0.00000
  1 C 3pz      0.06271   0.00000  -0.00000  -0.01322   0.02762
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.04218  -0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.05310  -0.00000   0.00000  -0.01011   0.01522
  1 C 3dxz    -0.00000   0.00000  -0.04218  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00117
  0 C 2s      -0.00000   0.00000   0.57006
  0 C 3s      -0.00000   0.00000  -0.05590
  0 C 2px      0.70510  -0.00000  -0.00000
  0 C 2py      0.00000   0.70510   0.00000
  0 C 2pz     -0.00000   0.00000   0.40146
  0 C 3px     -0.04754  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04754   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01218
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02390   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.10289
  0 C 3dxz    -0.02390  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00117
  1 C 2s       0.00000  -0.00000  -0.57006
  1 C 3s       0.00000  -0.00000   0.05590
  1 C 2px     -0.70510   0.00000   0.00000
  1 C 2py      0.00000  -0.70510  -0.00000
  1 C 2pz     -0.00000   0.00000   0.40146
  1 C 3px      0.04754   0.00000   0.00000
  1 C 3py      0.00000   0.04754  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01218
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02390   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.10289
  1 C 3dxz    -0.02390  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99656097
<CAS-nat-orb|mo-hf>  4  4    0.99984847
<CAS-nat-orb|mo-hf>  5  5    0.99984847
<CAS-nat-orb|mo-hf>  6  6    0.99856152
<CAS-nat-orb|mo-hf>  7  7    0.98495368
<CAS-nat-orb|mo-hf>  8  8    0.83784467
<CAS-nat-orb|mo-hf>  8  15   -0.54092854
<CAS-nat-orb|mo-hf>  9  9    0.83784453
<CAS-nat-orb|mo-hf>  9  16   -0.54092872
<CAS-nat-orb|mo-hf>  10  20   -0.80017035
CASSCF energy = -75.3500712327692
CASCI E = -75.3500712327692  E(CI) = -19.5186694186751  S^2 = 0.0000000
Density matrix diagonal elements [1.99117066 1.94837313 1.94837326 1.38207967 0.61632433 0.05352419
 0.05352434 0.00663042]
i = 1  <i|F|i> = -11.23912324
i = 2  <i|F|i> = -11.21708111
i = 3  <i|F|i> =  -1.10017944
i = 4  <i|F|i> =  -0.49799767
i = 5  <i|F|i> =  -0.49799770
i = 6  <i|F|i> =  -0.32436134
i = 7  <i|F|i> =  -0.14576005
i = 8  <i|F|i> =   0.48070181
i = 9  <i|F|i> =   0.48070197
i = 10  <i|F|i> =   1.67683799
i = 11  <i|F|i> =   0.54376654
i = 12  <i|F|i> =   0.58270521
i = 13  <i|F|i> =   0.58270521
i = 14  <i|F|i> =   0.77633081
i = 15  <i|F|i> =   0.68252375
i = 16  <i|F|i> =   0.68252362
i = 17  <i|F|i> =   0.57253203
i = 18  <i|F|i> =   1.22203149
i = 19  <i|F|i> =   1.22203149
i = 20  <i|F|i> =   1.22938211
i = 21  <i|F|i> =   1.62765287
i = 22  <i|F|i> =   1.62765287
i = 23  <i|F|i> =   1.78900335
i = 24  <i|F|i> =   1.78900335
i = 25  <i|F|i> =   2.10319665
i = 26  <i|F|i> =   2.38513335
i = 27  <i|F|i> =   2.38513328
i = 28  <i|F|i> =   3.57170854
......production of RDMs took      43.35 sec
......reading the RDM took          0.45 sec
......production of RDMs took      61.02 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickSCNEVPT2-ijrs) =    -0.00070197852561
E(WickSCNEVPT2- rsi) =    -0.00153378345710
E(WickSCNEVPT2- ijr) =    -0.00059603562357
E(WickSCNEVPT2-  rs) =    -0.04193561096352
E(WickSCNEVPT2-  ij) =    -0.00016145843838
E(WickSCNEVPT2-  ir) =    -0.00159047714181
E(WickSCNEVPT2-   r) =    -0.03571444102110
E(WickSCNEVPT2-   i) =    -0.00036319401041
E(WickSCNEVPT2) = -75.43266821195068  E_corr_pt = -0.0825969791815067
Timings = pdms =  114.56 | eris =    0.62 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.03 | r =    0.60 | i =    0.24
Time cost =    788.755
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:14:39 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.978977840202 AA    0.000000000000   0.000000000000   1.850000000000 Bohr   0.0

nuclear repulsion = 19.4594594594595
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       685.72


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp38sthxpy
max_memory 4000 MB (current use 365 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.0853308429702

WARN: Singularity detected in overlap matrix (condition number = 1.7e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.413580977369315  LUMO (Ag) = -0.227598981995082
cycle= 1 E= -75.172693617241  delta_E= 0.913  |g|= 0.173  |ddm|= 1.63
HOMO (B1u) = -0.471112350140237  LUMO (Ag) = -0.104670423689866
cycle= 2 E= -75.1835008238031  delta_E= -0.0108  |g|= 0.0557  |ddm|= 0.215
HOMO (B1u) = -0.445209609873392  LUMO (Ag) = -0.0826198965911263
cycle= 3 E= -75.1846477232623  delta_E= -0.00115  |g|= 0.0156  |ddm|= 0.166
HOMO (B1u) = -0.447439744130485  LUMO (Ag) = -0.0899048584713106
cycle= 4 E= -75.1847993820881  delta_E= -0.000152  |g|= 0.00222  |ddm|= 0.0841
HOMO (B1u) = -0.44798498189054  LUMO (Ag) = -0.091312710623985
cycle= 5 E= -75.1848027365252  delta_E= -3.35e-06  |g|= 0.00041  |ddm|= 0.016
HOMO (B1u) = -0.447956467884103  LUMO (Ag) = -0.0912347091259269
cycle= 6 E= -75.1848028483201  delta_E= -1.12e-07  |g|= 2.74e-05  |ddm|= 0.00219
HOMO (B1u) = -0.447959917478175  LUMO (Ag) = -0.0912398214370604
cycle= 7 E= -75.184802848724  delta_E= -4.04e-10  |g|= 1.64e-06  |ddm|= 0.00057
HOMO (B1u) = -0.447959903825145  LUMO (Ag) = -0.0912392511181812
cycle= 8 E= -75.1848028487249  delta_E= -8.81e-13  |g|= 1.46e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.447959899406316  LUMO (Ag) = -0.0912392910122952
cycle= 9 E= -75.1848028487249  delta_E=    0  |g|= 1.12e-08  |ddm|= 1.31e-06
HOMO (B1u) = -0.447959898993981  LUMO (Ag) = -0.091239285821883
cycle= 10 E= -75.1848028487249  delta_E=    0  |g|= 5.76e-09  |ddm|= 8.38e-08
HOMO (B1u) = -0.447959899071174  LUMO (Ag) = -0.0912392856751296
cycle= 11 E= -75.1848028487249  delta_E=    0  |g|= 6.48e-10  |ddm|= 4.19e-08
HOMO (B1u) = -0.447959899094373  LUMO (Ag) = -0.0912392856953184
cycle= 12 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 4.37e-10  |ddm|= 1.37e-09
HOMO (B1u) = -0.44795989910054  LUMO (Ag) = -0.0912392857481459
cycle= 13 E= -75.1848028487249  delta_E= -2.84e-14  |g|= 3.44e-10  |ddm|= 1.22e-09
HOMO (B1u) = -0.447959899057687  LUMO (Ag) = -0.091239285676468
cycle= 14 E= -75.1848028487249  delta_E=    0  |g|= 3.4e-10  |ddm|= 1.72e-09
HOMO (B1u) = -0.447959899024858  LUMO (Ag) = -0.0912392856284244
cycle= 15 E= -75.184802848725  delta_E= -2.84e-14  |g|= 3.87e-10  |ddm|= 4.33e-09
HOMO (B1u) = -0.447959899017367  LUMO (Ag) = -0.0912392856891154
cycle= 16 E= -75.184802848725  delta_E= -5.68e-14  |g|= 4.2e-10  |ddm|= 8.95e-09
HOMO (B1u) = -0.447959899080589  LUMO (Ag) = -0.0912392857453395
cycle= 17 E= -75.1848028487249  delta_E= 1.14e-13  |g|= 4.44e-10  |ddm|= 7.33e-10
HOMO (B1u) = -0.447959899144175  LUMO (Ag) = -0.0912392857747061
cycle= 18 E= -75.1848028487249  delta_E=    0  |g|= 2.01e-10  |ddm|= 3.46e-09
HOMO (B1u) = -0.447959899126455  LUMO (Ag) = -0.0912392857540452
cycle= 19 E= -75.184802848725  delta_E= -8.53e-14  |g|= 6.74e-11  |ddm|= 1.01e-09
HOMO (B1u) = -0.447959899121945  LUMO (Ag) = -0.0912392857492457
cycle= 20 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 5.5e-11  |ddm|= 5.86e-11
HOMO (B1u) = -0.447959899118677  LUMO (Ag) = -0.0912392857463235
cycle= 21 E= -75.184802848725  delta_E= -2.84e-14  |g|= 4.85e-11  |ddm|= 3.07e-11
HOMO (B1u) = -0.447959899117653  LUMO (Ag) = -0.0912392857439891
cycle= 22 E= -75.184802848725  delta_E= -2.84e-14  |g|= 4.36e-11  |ddm|= 2.24e-11
HOMO (B1u) = -0.447959899116692  LUMO (Ag) = -0.0912392857430377
cycle= 23 E= -75.184802848725  delta_E= 2.84e-14  |g|= 4.36e-11  |ddm|= 1.37e-11
HOMO (B1u) = -0.447959899113512  LUMO (Ag) = -0.0912392857393004
cycle= 24 E= -75.1848028487249  delta_E= 8.53e-14  |g|= 3.95e-11  |ddm|= 1.45e-10
HOMO (B1u) = -0.447959899110107  LUMO (Ag) = -0.0912392857318101
cycle= 25 E= -75.1848028487249  delta_E= -5.68e-14  |g|= 2.79e-11  |ddm|= 1.13e-10
HOMO (B1u) = -0.447959899107603  LUMO (Ag) = -0.0912392857263633
cycle= 26 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 1.57e-11  |ddm|= 1.24e-10
HOMO (B1u) = -0.447959899107707  LUMO (Ag) = -0.0912392857264186
cycle= 27 E= -75.184802848725  delta_E= -1.14e-13  |g|= 1.14e-11  |ddm|= 2.69e-11
HOMO (B1u) = -0.447959899108151  LUMO (Ag) = -0.0912392857267738
cycle= 28 E= -75.184802848725  delta_E=    0  |g|= 9.92e-12  |ddm|= 6.1e-12
HOMO (B1u) = -0.447959899109456  LUMO (Ag) = -0.0912392857268816
Extra cycle  E= -75.1848028487249  delta_E= 5.68e-14  |g|= 3.32e-12  |ddm|= 3.3e-11
converged SCF energy = -75.1848028487249

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp38sthxpy
max_memory 4000 MB (current use 369 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3350875235252  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3504688288351  dE = -0.015381305  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3642209452154  dE = -0.013752116  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0334  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3762543999525  dE = -0.012033455  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|=0.0229  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3841494453995  dE = -0.0078950454  S^2 = 0.0000000
               |grad[o]|=0.0782  |ddm|=0.014  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3894371408314  dE = -0.0052876954  S^2 = 0.0000000
               |grad[o]|=0.0619  |ddm|=0.00584  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3935806183029  dE = -0.0041434775  S^2 = 0.0000000
               |grad[o]|=0.0506  |ddm|=0.0029  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3970259734245  dE = -0.0034453551  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.00187  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3999304003285  dE = -0.0029044269  S^2 = 0.0000000
               |grad[o]|=0.0343  |ddm|=0.00135  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.402357543918  dE = -0.0024271436  S^2 = 0.0000000
               |grad[o]|=0.0279  |ddm|=0.00128  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4043337729623  dE = -0.001976229  S^2 = 0.0000000
               |grad[o]|=0.0223  |ddm|=0.00152  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.405872606699  dE = -0.0015388337  S^2 = 0.0000000
               |grad[o]|=0.0173  |ddm|=0.00192  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4069843933309  dE = -0.0011117866  S^2 = 0.0000000
               |grad[o]|=0.0127  |ddm|=0.00237  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4076787731995  dE = -0.00069437987  S^2 = 0.0000000
               |grad[o]|=0.00858  |ddm|=0.00283  |maxRot[o]|=0.0799
macro iter 14 (5 JK  0 micro), CASSCF E = -75.407930358013  dE = -0.00025158481  S^2 = 0.0000000
               |grad[o]|=0.00476  |ddm|=0.00338  |maxRot[o]|=0.0599
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4079625115102  dE = -3.2153497e-05  S^2 = 0.0000000
               |grad[o]|=0.00199  |ddm|=0.0033  |maxRot[o]|= 0.02
macro iter 16 (3 JK  0 micro), CASSCF E = -75.407966337477  dE = -3.8259668e-06  S^2 = 0.0000000
               |grad[o]|=0.000823  |ddm|=0.00183  |maxRot[o]|=0.00719
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4079664742544  dE = -1.367773e-07  S^2 = 0.0000000
               |grad[o]|=0.000218  |ddm|=0.00105  |maxRot[o]|=0.00136
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4079664805251  dE = -6.2707244e-09  S^2 = 0.0000000
               |grad[o]|=5.52e-05  |ddm|=0.000306  |maxRot[o]|=0.000269
macro iter 19 (3 JK  0 micro), CASSCF E = -75.407966480839  dE = -3.1390357e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.59e-05  |maxRot[o]|=5.69e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.4079664808551  dE = -1.6115109e-11  S^2 = 0.0000000
               |grad[o]|=3.35e-06  |ddm|=1.8e-05  |maxRot[o]|=1.26e-05
2-step CASSCF converged in 20 macro (100 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99071502 1.94427796 1.94427775 1.40690755 0.59110188 0.05781831
 0.05781808 0.00708345]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00011   0.00000   0.00000   0.00165  -0.00303
  0 C 2s       0.56693  -0.00000   0.00000   0.41981  -0.41934
  0 C 3s      -0.05883   0.00000   0.00000   0.01056  -0.04125
  0 C 2px      0.00000  -0.00000   0.70357  -0.00000  -0.00000
  0 C 2py      0.00000   0.70357  -0.00000   0.00000   0.00000
  0 C 2pz      0.41060   0.00000   0.00000  -0.56869   0.56692
  0 C 3px      0.00000  -0.00000  -0.05731  -0.00000  -0.00000
  0 C 3py      0.00000  -0.05731  -0.00000  -0.00000   0.00000
  0 C 3pz     -0.06180   0.00000   0.00000  -0.01234  -0.02899
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.04122  -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.05218   0.00000   0.00000   0.00930   0.01419
  0 C 3dxz     0.00000  -0.00000   0.04122  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
  1 C 1s      -0.00011   0.00000   0.00000  -0.00165  -0.00303
  1 C 2s       0.56693  -0.00000  -0.00000  -0.41981  -0.41934
  1 C 3s      -0.05883  -0.00000  -0.00000  -0.01056  -0.04125
  1 C 2px     -0.00000  -0.00000   0.70357   0.00000   0.00000
  1 C 2py     -0.00000   0.70357   0.00000   0.00000  -0.00000
  1 C 2pz     -0.41060  -0.00000   0.00000  -0.56869  -0.56692
  1 C 3px     -0.00000   0.00000  -0.05731   0.00000   0.00000
  1 C 3py     -0.00000  -0.05731   0.00000   0.00000  -0.00000
  1 C 3pz      0.06180   0.00000   0.00000  -0.01234   0.02899
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.04122  -0.00000  -0.00000   0.00000
  1 C 3dz^2    0.05218   0.00000  -0.00000  -0.00930   0.01419
  1 C 3dxz     0.00000  -0.00000  -0.04122  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00113
  0 C 2s       0.00000  -0.00000   0.56365
  0 C 3s       0.00000  -0.00000  -0.05372
  0 C 2px      0.70531   0.00000   0.00000
  0 C 2py      0.00000   0.70531   0.00000
  0 C 2pz      0.00000   0.00000   0.41389
  0 C 3px     -0.04437   0.00000   0.00000
  0 C 3py      0.00000  -0.04437   0.00000
  0 C 3pz      0.00000  -0.00000  -0.01152
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02384   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.08932
  0 C 3dxz    -0.02384   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00113
  1 C 2s      -0.00000  -0.00000  -0.56365
  1 C 3s      -0.00000   0.00000   0.05372
  1 C 2px     -0.70531  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70531  -0.00000
  1 C 2pz      0.00000  -0.00000   0.41389
  1 C 3px      0.04437  -0.00000  -0.00000
  1 C 3py     -0.00000   0.04437  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.01152
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02384   0.00000
  1 C 3dz^2   -0.00000   0.00000   0.08932
  1 C 3dxz    -0.02384   0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99647819
<CAS-nat-orb|mo-hf>  4  4    0.99985488
<CAS-nat-orb|mo-hf>  5  5    0.99985488
<CAS-nat-orb|mo-hf>  6  6    0.99860559
<CAS-nat-orb|mo-hf>  7  7    0.98449183
<CAS-nat-orb|mo-hf>  8  8    0.85083700
<CAS-nat-orb|mo-hf>  8  15   -0.52116393
<CAS-nat-orb|mo-hf>  9  9    0.85083670
<CAS-nat-orb|mo-hf>  9  16   -0.52116437
<CAS-nat-orb|mo-hf>  10  20   -0.78474240
CASSCF energy = -75.4079664808551
CASCI E = -75.4079664808551  E(CI) = -19.3366965246069  S^2 = 0.0000000
Density matrix diagonal elements [1.99071519 1.94427766 1.94427766 1.40690883 0.59110041 0.05781844
 0.05781845 0.00708337]
i = 1  <i|F|i> = -11.23945504
i = 2  <i|F|i> = -11.22172225
i = 3  <i|F|i> =  -1.09585929
i = 4  <i|F|i> =  -0.48709920
i = 5  <i|F|i> =  -0.48709920
i = 6  <i|F|i> =  -0.33455090
i = 7  <i|F|i> =  -0.14378595
i = 8  <i|F|i> =   0.45564467
i = 9  <i|F|i> =   0.45564506
i = 10  <i|F|i> =   1.61916538
i = 11  <i|F|i> =   0.54757787
i = 12  <i|F|i> =   0.58999439
i = 13  <i|F|i> =   0.58999439
i = 14  <i|F|i> =   0.77150818
i = 15  <i|F|i> =   0.68586583
i = 16  <i|F|i> =   0.68586555
i = 17  <i|F|i> =   0.56900930
i = 18  <i|F|i> =   1.22222608
i = 19  <i|F|i> =   1.22222608
i = 20  <i|F|i> =   1.21977327
i = 21  <i|F|i> =   1.60389719
i = 22  <i|F|i> =   1.60389718
i = 23  <i|F|i> =   1.77480317
i = 24  <i|F|i> =   1.77480317
i = 25  <i|F|i> =   2.10079334
i = 26  <i|F|i> =   2.34949082
i = 27  <i|F|i> =   2.34949072
i = 28  <i|F|i> =   3.36713408
......production of RDMs took       2.94 sec
......reading the RDM took          0.45 sec
......production of RDMs took      60.49 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.70 sec

E(WickSCNEVPT2-ijrs) =    -0.00063268770473
E(WickSCNEVPT2- rsi) =    -0.00146403101318
E(WickSCNEVPT2- ijr) =    -0.00057553565433
E(WickSCNEVPT2-  rs) =    -0.04183381274523
E(WickSCNEVPT2-  ij) =    -0.00016636896409
E(WickSCNEVPT2-  ir) =    -0.00156020978027
E(WickSCNEVPT2-   r) =    -0.03635081633135
E(WickSCNEVPT2-   i) =    -0.00035789860613
E(WickSCNEVPT2) = -75.49090784165442  E_corr_pt = -0.08294136079932668
Timings = pdms =   73.57 | eris =    0.62 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.03 | r =    0.60 | i =    0.24
Time cost =    927.024
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:30:06 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.005436700748 AA    0.000000000000   0.000000000000   1.900000000000 Bohr   0.0

nuclear repulsion = 18.9473684210526
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   0.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1426.29


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpv57ogsx1
max_memory 4000 MB (current use 377 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.031041178399

WARN: Singularity detected in overlap matrix (condition number = 1.52e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.394985537155229  LUMO (Ag) = -0.222680456230756
cycle= 1 E= -75.2198455234797  delta_E= 0.811  |g|= 0.173  |ddm|= 1.61
HOMO (B1u) = -0.479415237903267  LUMO (Ag) = -0.109973136342066
cycle= 2 E= -75.2305447304664  delta_E= -0.0107  |g|= 0.0546  |ddm|= 0.201
HOMO (B1u) = -0.452535964635348  LUMO (Ag) = -0.086088840872582
cycle= 3 E= -75.2315902210701  delta_E= -0.00105  |g|= 0.0153  |ddm|= 0.145
HOMO (B1u) = -0.454103263824989  LUMO (Ag) = -0.0925462170063888
cycle= 4 E= -75.2317373690304  delta_E= -0.000147  |g|= 0.00222  |ddm|= 0.0805
HOMO (B1u) = -0.454675048897531  LUMO (Ag) = -0.0940058731975914
cycle= 5 E= -75.2317407777114  delta_E= -3.41e-06  |g|= 0.0004  |ddm|= 0.0162
HOMO (B1u) = -0.454646635749831  LUMO (Ag) = -0.0939357427361199
cycle= 6 E= -75.231740884219  delta_E= -1.07e-07  |g|= 2.7e-05  |ddm|= 0.00191
HOMO (B1u) = -0.454651041484012  LUMO (Ag) = -0.0939413575689293
cycle= 7 E= -75.2317408846097  delta_E= -3.91e-10  |g|= 1.59e-06  |ddm|= 0.000529
HOMO (B1u) = -0.454650997156086  LUMO (Ag) = -0.0939408954913429
cycle= 8 E= -75.2317408846106  delta_E= -8.95e-13  |g|= 1.33e-07  |ddm|= 2.94e-05
HOMO (B1u) = -0.454650997886304  LUMO (Ag) = -0.0939409273867556
cycle= 9 E= -75.2317408846106  delta_E= -8.53e-14  |g|= 9.79e-09  |ddm|= 1.1e-06
HOMO (B1u) = -0.454650996886786  LUMO (Ag) = -0.0939409222310318
cycle= 10 E= -75.2317408846106  delta_E= 2.84e-14  |g|= 6.09e-09  |ddm|= 5.21e-08
HOMO (B1u) = -0.454650997071932  LUMO (Ag) = -0.093940922395708
cycle= 11 E= -75.2317408846107  delta_E= -8.53e-14  |g|= 6.34e-10  |ddm|= 4.15e-08
HOMO (B1u) = -0.454650997074433  LUMO (Ag) = -0.0939409223810087
cycle= 12 E= -75.2317408846106  delta_E= 8.53e-14  |g|= 4.28e-10  |ddm|= 1.28e-09
HOMO (B1u) = -0.454650997137739  LUMO (Ag) = -0.0939409225126068
cycle= 13 E= -75.2317408846106  delta_E=    0  |g|= 3.37e-10  |ddm|= 1.13e-09
HOMO (B1u) = -0.454650997085283  LUMO (Ag) = -0.093940922442187
cycle= 14 E= -75.2317408846106  delta_E= 5.68e-14  |g|= 3.33e-10  |ddm|= 5.27e-10
HOMO (B1u) = -0.45465099704117  LUMO (Ag) = -0.0939409223966759
cycle= 15 E= -75.2317408846106  delta_E= -7.11e-14  |g|= 3.67e-10  |ddm|= 3.41e-09
HOMO (B1u) = -0.454650997076103  LUMO (Ag) = -0.0939409224730339
cycle= 16 E= -75.2317408846106  delta_E= 1.42e-14  |g|= 4e-10  |ddm|= 5.8e-09
HOMO (B1u) = -0.454650997123067  LUMO (Ag) = -0.0939409225133802
cycle= 17 E= -75.2317408846107  delta_E= -8.53e-14  |g|= 4.31e-10  |ddm|= 4.42e-10
HOMO (B1u) = -0.454650997190092  LUMO (Ag) = -0.0939409225475955
cycle= 18 E= -75.2317408846107  delta_E=    0  |g|= 2.33e-10  |ddm|= 2.6e-09
HOMO (B1u) = -0.454650997163641  LUMO (Ag) = -0.0939409225210893
cycle= 19 E= -75.2317408846106  delta_E= 7.11e-14  |g|= 7.39e-11  |ddm|= 9.5e-10
HOMO (B1u) = -0.454650997158352  LUMO (Ag) = -0.0939409225155294
cycle= 20 E= -75.2317408846106  delta_E= -1.42e-14  |g|= 6.02e-11  |ddm|= 6.22e-11
HOMO (B1u) = -0.454650997153659  LUMO (Ag) = -0.0939409225114527
cycle= 21 E= -75.2317408846107  delta_E= -5.68e-14  |g|= 5.41e-11  |ddm|= 3.38e-11
HOMO (B1u) = -0.454650997152518  LUMO (Ag) = -0.0939409225092321
cycle= 22 E= -75.2317408846106  delta_E= 5.68e-14  |g|= 4.85e-11  |ddm|= 2.83e-11
HOMO (B1u) = -0.454650997151139  LUMO (Ag) = -0.0939409225073986
cycle= 23 E= -75.2317408846106  delta_E=    0  |g|= 4.62e-11  |ddm|= 4.24e-11
HOMO (B1u) = -0.454650997142915  LUMO (Ag) = -0.093940922492351
Extra cycle  E= -75.2317408846107  delta_E= -2.84e-14  |g|= 1.33e-11  |ddm|= 1.6e-10
converged SCF energy = -75.2317408846107

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpv57ogsx1
max_memory 4000 MB (current use 377 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3834026666701  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3993895752472  dE = -0.015986909  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4135906512592  dE = -0.014201076  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0352  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4257782802993  dE = -0.012187629  S^2 = 0.0000000
               |grad[o]|=0.0987  |ddm|=0.0239  |maxRot[o]|=0.0787
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4331189720539  dE = -0.0073406918  S^2 = 0.0000000
               |grad[o]|=0.0761  |ddm|=0.0138  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.438273499348  dE = -0.0051545273  S^2 = 0.0000000
               |grad[o]|=0.0608  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4423993023617  dE = -0.004125803  S^2 = 0.0000000
               |grad[o]|=0.0498  |ddm|=0.00272  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4458591691259  dE = -0.0034598668  S^2 = 0.0000000
               |grad[o]|=0.041  |ddm|=0.00177  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4487792692964  dE = -0.0029201002  S^2 = 0.0000000
               |grad[o]|=0.0336  |ddm|=0.00136  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4512079251635  dE = -0.0024286559  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.0014  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4531618929966  dE = -0.0019539678  S^2 = 0.0000000
               |grad[o]|=0.0215  |ddm|=0.00171  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4546486323613  dE = -0.0014867394  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4556742884725  dE = -0.0010256561  S^2 = 0.0000000
               |grad[o]|=0.0116  |ddm|=0.00257  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4562441932396  dE = -0.00056990477  S^2 = 0.0000000
               |grad[o]|=0.00729  |ddm|=0.00301  |maxRot[o]|=0.0799
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4563598640015  dE = -0.00011567076  S^2 = 0.0000000
               |grad[o]|=0.00332  |ddm|=0.00359  |maxRot[o]|= 0.04
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4563704251768  dE = -1.0561175e-05  S^2 = 0.0000000
               |grad[o]|=0.00121  |ddm|=0.00264  |maxRot[o]|=0.0119
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4563707480314  dE = -3.2285452e-07  S^2 = 0.0000000
               |grad[o]|=0.000317  |ddm|=0.00143  |maxRot[o]|=0.0021
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4563707612965  dE = -1.3265108e-08  S^2 = 0.0000000
               |grad[o]|=7.82e-05  |ddm|=0.000427  |maxRot[o]|=0.000394
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4563707619108  dE = -6.1437788e-10  S^2 = 0.0000000
               |grad[o]|=1.87e-05  |ddm|=0.000113  |maxRot[o]|=7.93e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.4563707619389  dE = -2.8052227e-11  S^2 = 0.0000000
               |grad[o]|=4.01e-06  |ddm|=2.1e-05  |maxRot[o]|=1.68e-05
2-step CASSCF converged in 19 macro (96 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99022078 1.9399813  1.93998148 1.43110822 0.56650677 0.06231562
 0.0623158  0.00757002]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00012   0.00000   0.00000   0.00176  -0.00276
  0 C 2s       0.56879   0.00000   0.00000   0.43063  -0.41683
  0 C 3s      -0.05868   0.00000   0.00000   0.01038  -0.03881
  0 C 2px     -0.00000   0.00000   0.70409  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70409   0.00000   0.00000   0.00000
  0 C 2pz      0.40833   0.00000   0.00000  -0.56057   0.56889
  0 C 3px     -0.00000   0.00000  -0.05130  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.05130  -0.00000   0.00000  -0.00000
  0 C 3pz     -0.06076   0.00000  -0.00000  -0.01148  -0.03034
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.04026  -0.00000   0.00000  -0.00000
  0 C 3dz^2    0.05111   0.00000   0.00000   0.00848   0.01325
  0 C 3dxz    -0.00000   0.00000   0.04026  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00012   0.00000   0.00000  -0.00176  -0.00276
  1 C 2s       0.56879  -0.00000  -0.00000  -0.43063  -0.41683
  1 C 3s      -0.05868  -0.00000  -0.00000  -0.01038  -0.03881
  1 C 2px      0.00000  -0.00000   0.70409   0.00000   0.00000
  1 C 2py      0.00000   0.70409   0.00000   0.00000   0.00000
  1 C 2pz     -0.40833  -0.00000   0.00000  -0.56057  -0.56889
  1 C 3px      0.00000  -0.00000  -0.05130   0.00000   0.00000
  1 C 3py      0.00000  -0.05130   0.00000  -0.00000   0.00000
  1 C 3pz      0.06076   0.00000   0.00000  -0.01148   0.03034
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.04026  -0.00000   0.00000  -0.00000
  1 C 3dz^2    0.05111  -0.00000  -0.00000  -0.00848   0.01325
  1 C 3dxz    -0.00000   0.00000  -0.04026  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00109
  0 C 2s       0.00000   0.00000   0.55672
  0 C 3s      -0.00000   0.00000  -0.05173
  0 C 2px      0.70549  -0.00000   0.00000
  0 C 2py      0.00000   0.70549   0.00000
  0 C 2pz      0.00000  -0.00000   0.42574
  0 C 3px     -0.04149  -0.00000   0.00000
  0 C 3py     -0.00000  -0.04149   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01023
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02382   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.07763
  0 C 3dxz    -0.02382  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00109
  1 C 2s      -0.00000  -0.00000  -0.55672
  1 C 3s       0.00000  -0.00000   0.05173
  1 C 2px     -0.70549  -0.00000  -0.00000
  1 C 2py      0.00000  -0.70549   0.00000
  1 C 2pz      0.00000   0.00000   0.42574
  1 C 3px      0.04149   0.00000  -0.00000
  1 C 3py     -0.00000   0.04149  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01023
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.07763
  1 C 3dxz    -0.02382  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99637511
<CAS-nat-orb|mo-hf>  4  4    0.99985872
<CAS-nat-orb|mo-hf>  5  5    0.99985872
<CAS-nat-orb|mo-hf>  6  6    0.99864217
<CAS-nat-orb|mo-hf>  7  7    0.98400068
<CAS-nat-orb|mo-hf>  8  8    0.86287869
<CAS-nat-orb|mo-hf>  8  15   -0.50178860
<CAS-nat-orb|mo-hf>  9  9    0.86287886
<CAS-nat-orb|mo-hf>  9  16   -0.50178832
<CAS-nat-orb|mo-hf>  10  20   -0.76833535
CASSCF energy = -75.4563707619389
CASCI E = -75.4563707619389  E(CI) = -19.1577865087796  S^2 = 0.0000000
Density matrix diagonal elements [1.99022081 1.93998135 1.93998132 1.43110716 0.56650785 0.06231581
 0.06231577 0.00756994]
i = 1  <i|F|i> = -11.24126478
i = 2  <i|F|i> = -11.22696457
i = 3  <i|F|i> =  -1.09036238
i = 4  <i|F|i> =  -0.47679127
i = 5  <i|F|i> =  -0.47679126
i = 6  <i|F|i> =  -0.34453979
i = 7  <i|F|i> =  -0.14164119
i = 8  <i|F|i> =   0.43176041
i = 9  <i|F|i> =   0.43176022
i = 10  <i|F|i> =   1.55845546
i = 11  <i|F|i> =   0.55169742
i = 12  <i|F|i> =   0.59703884
i = 13  <i|F|i> =   0.59703884
i = 14  <i|F|i> =   0.76674332
i = 15  <i|F|i> =   0.68889820
i = 16  <i|F|i> =   0.68889837
i = 17  <i|F|i> =   0.56603244
i = 18  <i|F|i> =   1.22270325
i = 19  <i|F|i> =   1.22270325
i = 20  <i|F|i> =   1.21045788
i = 21  <i|F|i> =   1.58051679
i = 22  <i|F|i> =   1.58051678
i = 23  <i|F|i> =   1.76083034
i = 24  <i|F|i> =   1.76083034
i = 25  <i|F|i> =   2.09891258
i = 26  <i|F|i> =   2.31741657
i = 27  <i|F|i> =   2.31741660
i = 28  <i|F|i> =   3.19042994
......production of RDMs took       2.40 sec
......reading the RDM took          0.46 sec
......production of RDMs took      29.51 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickSCNEVPT2-ijrs) =    -0.00057395257267
E(WickSCNEVPT2- rsi) =    -0.00139945561498
E(WickSCNEVPT2- ijr) =    -0.00055578161726
E(WickSCNEVPT2-  rs) =    -0.04168693398116
E(WickSCNEVPT2-  ij) =    -0.00017002556968
E(WickSCNEVPT2-  ir) =    -0.00153127833064
E(WickSCNEVPT2-   r) =    -0.03700551476641
E(WickSCNEVPT2-   i) =    -0.00035216823641
E(WickSCNEVPT2) = -75.5396458726281  E_corr_pt = -0.08327511068920646
Timings = pdms =   42.08 | eris =    0.62 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.03 | r =    0.55 | i =    0.25
Time cost =    412.099
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:36:58 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.031895561294 AA    0.000000000000   0.000000000000   1.950000000000 Bohr   0.0

nuclear repulsion = 18.4615384615385
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2097.23


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpzvu067dr
max_memory 4000 MB (current use 356 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9746920535549

WARN: Singularity detected in overlap matrix (condition number = 1.36e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.376946372482714  LUMO (Ag) = -0.21790659790505
cycle= 1 E= -75.2586399523512  delta_E= 0.716  |g|= 0.174  |ddm|=  1.6
HOMO (B1u) = -0.487753910327477  LUMO (Ag) = -0.114938505564516
cycle= 2 E= -75.2693410539255  delta_E= -0.0107  |g|= 0.0537  |ddm|= 0.193
HOMO (B1u) = -0.459920537702701  LUMO (Ag) = -0.0893203899470897
cycle= 3 E= -75.2703049843485  delta_E= -0.000964  |g|= 0.0148  |ddm|= 0.127
HOMO (B1u) = -0.46084545813185  LUMO (Ag) = -0.0948990398153117
cycle= 4 E= -75.2704430756293  delta_E= -0.000138  |g|= 0.00223  |ddm|= 0.0758
HOMO (B1u) = -0.461426494056181  LUMO (Ag) = -0.0963896216507966
cycle= 5 E= -75.2704465290254  delta_E= -3.45e-06  |g|= 0.00039  |ddm|= 0.0164
HOMO (B1u) = -0.461398372411754  LUMO (Ag) = -0.0963285783601142
cycle= 6 E= -75.270446630032  delta_E= -1.01e-07  |g|= 2.67e-05  |ddm|= 0.00163
HOMO (B1u) = -0.46140360138768  LUMO (Ag) = -0.096334626636979
cycle= 7 E= -75.2704466304109  delta_E= -3.79e-10  |g|= 1.62e-06  |ddm|= 0.000491
HOMO (B1u) = -0.461403547807348  LUMO (Ag) = -0.0963342779054353
cycle= 8 E= -75.2704466304119  delta_E= -9.95e-13  |g|= 1.22e-07  |ddm|= 2.97e-05
HOMO (B1u) = -0.461403551923956  LUMO (Ag) = -0.096334302240793
cycle= 9 E= -75.2704466304118  delta_E= 2.84e-14  |g|= 8.39e-09  |ddm|= 9.29e-07
HOMO (B1u) = -0.461403550346232  LUMO (Ag) = -0.09633429765728
cycle= 10 E= -75.2704466304119  delta_E= -2.84e-14  |g|= 6.39e-09  |ddm|= 2.38e-08
HOMO (B1u) = -0.461403550614034  LUMO (Ag) = -0.0963342980877867
cycle= 11 E= -75.2704466304119  delta_E= -8.53e-14  |g|= 6.15e-10  |ddm|= 3.9e-08
HOMO (B1u) = -0.461403550664146  LUMO (Ag) = -0.0963342981493671
cycle= 12 E= -75.2704466304119  delta_E=    0  |g|= 4.19e-10  |ddm|= 1.6e-09
HOMO (B1u) = -0.461403550669138  LUMO (Ag) = -0.0963342982101286
cycle= 13 E= -75.270446630412  delta_E= -2.84e-14  |g|= 3.38e-10  |ddm|= 5.2e-10
HOMO (B1u) = -0.461403550602393  LUMO (Ag) = -0.0963342981346171
cycle= 14 E= -75.2704466304119  delta_E= 1.14e-13  |g|= 3.8e-10  |ddm|= 5.12e-10
HOMO (B1u) = -0.461403550575893  LUMO (Ag) = -0.0963342981199711
cycle= 15 E= -75.2704466304118  delta_E= 5.68e-14  |g|= 3.78e-10  |ddm|= 1.73e-09
HOMO (B1u) = -0.46140355063246  LUMO (Ag) = -0.0963342981795871
cycle= 16 E= -75.2704466304119  delta_E= -9.95e-14  |g|= 3.39e-10  |ddm|= 1.7e-09
HOMO (B1u) = -0.461403550698111  LUMO (Ag) = -0.0963342982349129
cycle= 17 E= -75.2704466304118  delta_E= 7.11e-14  |g|= 4.12e-10  |ddm|= 8.61e-10
HOMO (B1u) = -0.46140355075752  LUMO (Ag) = -0.0963342982659891
cycle= 18 E= -75.2704466304119  delta_E= -5.68e-14  |g|= 2.47e-10  |ddm|= 1.74e-09
HOMO (B1u) = -0.461403550723371  LUMO (Ag) = -0.0963342982347647
cycle= 19 E= -75.2704466304119  delta_E=    0  |g|= 7.36e-11  |ddm|= 8.44e-10
HOMO (B1u) = -0.461403550702713  LUMO (Ag) = -0.0963342982016507
Extra cycle  E= -75.2704466304119  delta_E= -2.84e-14  |g|= 1.89e-11  |ddm|= 3.5e-10
converged SCF energy = -75.2704466304119

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpzvu067dr
max_memory 4000 MB (current use 363 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4235309439021  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4401210484912  dE = -0.016590105  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4547605473225  dE = -0.014639499  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0372  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4667277310782  dE = -0.011967184  S^2 = 0.0000000
               |grad[o]|=0.0972  |ddm|=0.0249  |maxRot[o]|=0.0768
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4737200281126  dE = -0.006992297  S^2 = 0.0000000
               |grad[o]|=0.0746  |ddm|=0.0134  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4788108818807  dE = -0.0050908538  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.00488  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.482951019295  dE = -0.0041401374  S^2 = 0.0000000
               |grad[o]|=0.0492  |ddm|=0.00261  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4864411694633  dE = -0.0034901502  S^2 = 0.0000000
               |grad[o]|=0.0404  |ddm|=0.00172  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4893827139553  dE = -0.0029415445  S^2 = 0.0000000
               |grad[o]|=0.0329  |ddm|=0.00143  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4918101618476  dE = -0.0024274479  S^2 = 0.0000000
               |grad[o]|=0.0264  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4937310878988  dE = -0.0019209261  S^2 = 0.0000000
               |grad[o]|=0.0205  |ddm|=0.00194  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4951471176876  dE = -0.0014160298  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00236  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4960600259016  dE = -0.00091290821  S^2 = 0.0000000
               |grad[o]|=0.0103  |ddm|=0.00278  |maxRot[o]|=0.0799
macro iter 13 (5 JK  0 micro), CASSCF E = -75.4964166728624  dE = -0.00035664696  S^2 = 0.0000000
               |grad[o]|=0.00583  |ddm|=0.00322  |maxRot[o]|=0.0599
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4964898899841  dE = -7.3217122e-05  S^2 = 0.0000000
               |grad[o]|=0.0026  |ddm|=0.00297  |maxRot[o]|=0.0347
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4964915888361  dE = -1.6988519e-06  S^2 = 0.0000000
               |grad[o]|=0.000643  |ddm|=0.00246  |maxRot[o]|=0.00494
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4964916480309  dE = -5.9194846e-08  S^2 = 0.0000000
               |grad[o]|=0.000153  |ddm|=0.000803  |maxRot[o]|=0.000856
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4964916504785  dE = -2.4476492e-09  S^2 = 0.0000000
               |grad[o]|=3.6e-05  |ddm|=0.000218  |maxRot[o]|=0.000159
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4964916505853  dE = -1.0676615e-10  S^2 = 0.0000000
               |grad[o]|=8.02e-06  |ddm|=4.83e-05  |maxRot[o]|=3.2e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.4964916505898  dE = -4.4479975e-12  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=1.09e-05  |maxRot[o]|=6.69e-06
2-step CASSCF converged in 19 macro (95 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98968842 1.93548132 1.93548121 1.45436124 0.54286927 0.0670143
 0.06701424 0.00808999]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00041   0.00000   0.00000   0.00186  -0.00251
  0 C 2s       0.57092   0.00000   0.00000   0.44116  -0.41394
  0 C 3s      -0.05831   0.00000  -0.00000   0.01019  -0.03618
  0 C 2px      0.00000   0.00000   0.70454  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70454   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40572  -0.00000  -0.00000  -0.55236   0.57112
  0 C 3px      0.00000  -0.00000  -0.04561  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04561  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05958   0.00000  -0.00000  -0.01065  -0.03168
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.03931  -0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04991   0.00000  -0.00000   0.00767   0.01244
  0 C 3dxz     0.00000  -0.00000   0.03931  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00041   0.00000   0.00000  -0.00186  -0.00251
  1 C 2s       0.57092  -0.00000   0.00000  -0.44116  -0.41394
  1 C 3s      -0.05831  -0.00000   0.00000  -0.01019  -0.03618
  1 C 2px     -0.00000   0.00000   0.70454  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70454   0.00000   0.00000   0.00000
  1 C 2pz     -0.40572  -0.00000   0.00000  -0.55236  -0.57112
  1 C 3px     -0.00000  -0.00000  -0.04561   0.00000   0.00000
  1 C 3py      0.00000  -0.04561  -0.00000   0.00000   0.00000
  1 C 3pz      0.05958   0.00000   0.00000  -0.01065   0.03168
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03931   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04991  -0.00000  -0.00000  -0.00767   0.01244
  1 C 3dxz     0.00000   0.00000  -0.03931  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00105
  0 C 2s       0.00000   0.00000   0.54938
  0 C 3s      -0.00000  -0.00000  -0.04995
  0 C 2px      0.70564  -0.00000   0.00000
  0 C 2py     -0.00000   0.70564   0.00000
  0 C 2pz      0.00000  -0.00000   0.43709
  0 C 3px     -0.03887  -0.00000   0.00000
  0 C 3py     -0.00000  -0.03887  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.00850
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02381   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.06762
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00105
  1 C 2s       0.00000   0.00000  -0.54938
  1 C 3s      -0.00000   0.00000   0.04995
  1 C 2px     -0.70564   0.00000  -0.00000
  1 C 2py      0.00000  -0.70564  -0.00000
  1 C 2pz     -0.00000   0.00000   0.43709
  1 C 3px      0.03887   0.00000  -0.00000
  1 C 3py      0.00000   0.03887  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.00850
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02381   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.06762
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99625189
<CAS-nat-orb|mo-hf>  4  4    0.99986004
<CAS-nat-orb|mo-hf>  5  5    0.99986004
<CAS-nat-orb|mo-hf>  6  6    0.99867026
<CAS-nat-orb|mo-hf>  7  7    0.98348638
<CAS-nat-orb|mo-hf>  8  8    0.87399692
<CAS-nat-orb|mo-hf>  8  15   -0.48288163
<CAS-nat-orb|mo-hf>  9  9    0.87399683
<CAS-nat-orb|mo-hf>  9  16   -0.48288177
<CAS-nat-orb|mo-hf>  10  17    0.40709983
<CAS-nat-orb|mo-hf>  10  20   -0.75070510
CASSCF energy = -75.4964916505898
CASCI E = -75.4964916505898  E(CI) = -18.982189390356  S^2 = 0.0000000
Density matrix diagonal elements [1.98968852 1.9354811  1.93548121 1.45436495 0.54286552 0.06701435
 0.06701441 0.00808995]
i = 1  <i|F|i> = -11.24421922
i = 2  <i|F|i> = -11.23265567
i = 3  <i|F|i> =  -1.08386176
i = 4  <i|F|i> =  -0.46700969
i = 5  <i|F|i> =  -0.46700971
i = 6  <i|F|i> =  -0.35428201
i = 7  <i|F|i> =  -0.13941060
i = 8  <i|F|i> =   0.40899524
i = 9  <i|F|i> =   0.40899535
i = 10  <i|F|i> =   1.49603170
i = 11  <i|F|i> =   0.55609537
i = 12  <i|F|i> =   0.60383875
i = 13  <i|F|i> =   0.60383876
i = 14  <i|F|i> =   0.76208869
i = 15  <i|F|i> =   0.69162148
i = 16  <i|F|i> =   0.69162139
i = 17  <i|F|i> =   0.56349142
i = 18  <i|F|i> =   1.22346967
i = 19  <i|F|i> =   1.22346967
i = 20  <i|F|i> =   1.20145830
i = 21  <i|F|i> =   1.55754992
i = 22  <i|F|i> =   1.55754992
i = 23  <i|F|i> =   1.74709873
i = 24  <i|F|i> =   1.74709873
i = 25  <i|F|i> =   2.09737678
i = 26  <i|F|i> =   2.28847825
i = 27  <i|F|i> =   2.28847822
i = 28  <i|F|i> =   3.03771861
......production of RDMs took      43.21 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.04 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.71 sec

E(WickSCNEVPT2-ijrs) =    -0.00052426502187
E(WickSCNEVPT2- rsi) =    -0.00134006754522
E(WickSCNEVPT2- ijr) =    -0.00053717549334
E(WickSCNEVPT2-  rs) =    -0.04149994670648
E(WickSCNEVPT2-  ij) =    -0.00017240820612
E(WickSCNEVPT2-  ir) =    -0.00150360748266
E(WickSCNEVPT2-   r) =    -0.03767492653648
E(WickSCNEVPT2-   i) =    -0.00034613620860
E(WickSCNEVPT2) = -75.58009018379052  E_corr_pt = -0.08359853320075569
Timings = pdms =   73.38 | eris =    0.62 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.02 | r =    0.53 | i =    0.24
Time cost =    425.782
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:44:04 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.058354421840 AA    0.000000000000   0.000000000000   2.000000000000 Bohr   0.0

nuclear repulsion = 18
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 1.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2606.84


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpaxdo13_9
max_memory 4000 MB (current use 369 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9170535172816

WARN: Singularity detected in overlap matrix (condition number = 1.22e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.359902883841541  LUMO (Ag) = -0.213307043039731
cycle= 1 E= -75.2901241201449  delta_E= 0.627  |g|= 0.175  |ddm|= 1.58
HOMO (B1u) = -0.496094054564504  LUMO (Ag) = -0.119573071329235
cycle= 2 E= -75.3009349666094  delta_E= -0.0108  |g|= 0.0531  |ddm|= 0.188
HOMO (B1u) = -0.467321073254816  LUMO (Ag) = -0.0923011554436198
cycle= 3 E= -75.3018357121932  delta_E= -0.000901  |g|= 0.0141  |ddm|= 0.113
HOMO (B1u) = -0.467647600574112  LUMO (Ag) = -0.0969889779106485
cycle= 4 E= -75.3019617797126  delta_E= -0.000126  |g|= 0.00222  |ddm|= 0.0704
HOMO (B1u) = -0.468220968325749  LUMO (Ag) = -0.0984869419679166
cycle= 5 E= -75.3019652459277  delta_E= -3.47e-06  |g|= 0.000378  |ddm|= 0.0164
HOMO (B1u) = -0.468193490312784  LUMO (Ag) = -0.0984366742323401
cycle= 6 E= -75.3019653408538  delta_E= -9.49e-08  |g|= 2.64e-05  |ddm|= 0.00134
HOMO (B1u) = -0.468199393066123  LUMO (Ag) = -0.0984431261473294
cycle= 7 E= -75.3019653412214  delta_E= -3.68e-10  |g|= 1.72e-06  |ddm|= 0.000455
HOMO (B1u) = -0.468199353870889  LUMO (Ag) = -0.0984428907847602
cycle= 8 E= -75.3019653412226  delta_E= -1.19e-12  |g|= 1.15e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.468199359870133  LUMO (Ag) = -0.0984429094354663
cycle= 9 E= -75.3019653412226  delta_E=    0  |g|= 7.48e-09  |ddm|= 7.76e-07
HOMO (B1u) = -0.468199357849046  LUMO (Ag) = -0.0984429054936098
cycle= 10 E= -75.3019653412227  delta_E= -1.14e-13  |g|= 6.66e-09  |ddm|= 7.68e-09
HOMO (B1u) = -0.468199358148179  LUMO (Ag) = -0.0984429061084248
cycle= 11 E= -75.3019653412226  delta_E= 1.14e-13  |g|= 5.84e-10  |ddm|= 3.45e-08
HOMO (B1u) = -0.468199358179505  LUMO (Ag) = -0.0984429061482281
cycle= 12 E= -75.3019653412226  delta_E=    0  |g|= 3.79e-10  |ddm|= 1.87e-09
HOMO (B1u) = -0.468199358241285  LUMO (Ag) = -0.0984429062748779
cycle= 13 E= -75.3019653412226  delta_E= 5.68e-14  |g|= 3.43e-10  |ddm|= 2.3e-10
HOMO (B1u) = -0.468199358181536  LUMO (Ag) = -0.0984429062142393
cycle= 14 E= -75.3019653412226  delta_E= -5.68e-14  |g|= 3.61e-10  |ddm|= 8.58e-10
HOMO (B1u) = -0.468199358151525  LUMO (Ag) = -0.0984429062053521
cycle= 15 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 3.71e-10  |ddm|= 5.17e-10
HOMO (B1u) = -0.468199358199077  LUMO (Ag) = -0.0984429062311422
cycle= 16 E= -75.3019653412227  delta_E= -8.53e-14  |g|= 2.89e-10  |ddm|= 1.04e-09
HOMO (B1u) = -0.468199358285848  LUMO (Ag) = -0.098442906302341
cycle= 17 E= -75.3019653412226  delta_E= 8.53e-14  |g|= 4e-10  |ddm|= 1.23e-09
HOMO (B1u) = -0.468199358333099  LUMO (Ag) = -0.0984429063262976
cycle= 18 E= -75.3019653412226  delta_E= 1.42e-14  |g|= 2.56e-10  |ddm|= 1.08e-09
HOMO (B1u) = -0.468199358292453  LUMO (Ag) = -0.0984429062914072
cycle= 19 E= -75.3019653412226  delta_E= -4.26e-14  |g|= 6.88e-11  |ddm|= 7.03e-10
HOMO (B1u) = -0.468199358286613  LUMO (Ag) = -0.0984429062852524
cycle= 20 E= -75.3019653412227  delta_E= -5.68e-14  |g|= 5.91e-11  |ddm|= 5.46e-11
HOMO (B1u) = -0.468199358282913  LUMO (Ag) = -0.0984429062814692
cycle= 21 E= -75.3019653412226  delta_E= 7.11e-14  |g|= 5.5e-11  |ddm|= 1.84e-11
HOMO (B1u) = -0.468199358282181  LUMO (Ag) = -0.0984429062787696
cycle= 22 E= -75.3019653412226  delta_E= 1.42e-14  |g|= 4.82e-11  |ddm|= 4.04e-11
HOMO (B1u) = -0.468199358280931  LUMO (Ag) = -0.0984429062750436
cycle= 23 E= -75.3019653412226  delta_E= -2.84e-14  |g|= 4.19e-11  |ddm|= 8.38e-11
HOMO (B1u) = -0.468199358279268  LUMO (Ag) = -0.0984429062690598
cycle= 24 E= -75.3019653412226  delta_E= 7.11e-14  |g|= 3.45e-11  |ddm|= 7.42e-11
HOMO (B1u) = -0.468199358277893  LUMO (Ag) = -0.0984429062647388
cycle= 25 E= -75.3019653412226  delta_E= -4.26e-14  |g|= 2.84e-11  |ddm|= 3.75e-11
HOMO (B1u) = -0.468199358276582  LUMO (Ag) = -0.0984429062619437
cycle= 26 E= -75.3019653412227  delta_E= -5.68e-14  |g|= 1.73e-11  |ddm|= 4.9e-11
HOMO (B1u) = -0.468199358276886  LUMO (Ag) = -0.0984429062626116
cycle= 27 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 1.27e-11  |ddm|= 1.96e-11
HOMO (B1u) = -0.468199358277469  LUMO (Ag) = -0.0984429062628853
cycle= 28 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 1.11e-11  |ddm|= 1.16e-11
HOMO (B1u) = -0.468199358277916  LUMO (Ag) = -0.0984429062629188
cycle= 29 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 9.43e-12  |ddm|= 1.13e-11
HOMO (B1u) = -0.468199358278266  LUMO (Ag) = -0.0984429062627727
cycle= 30 E= -75.3019653412227  delta_E=    0  |g|= 7.75e-12  |ddm|= 1.17e-11
HOMO (B1u) = -0.468199358278578  LUMO (Ag) = -0.0984429062616603
Extra cycle  E= -75.3019653412227  delta_E= 2.84e-14  |g|= 2.81e-12  |ddm|= 2.77e-11
converged SCF energy = -75.3019653412227

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpaxdo13_9
max_memory 4000 MB (current use 369 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4565254955898  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4737144662214  dE = -0.017188971  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4887834694174  dE = -0.015069003  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0393  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5003060273456  dE = -0.011522558  S^2 = 0.0000000
               |grad[o]|=0.0957  |ddm|=0.0259  |maxRot[o]|=0.0796
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5070819997056  dE = -0.0067759724  S^2 = 0.0000000
               |grad[o]|=0.0736  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5121575569839  dE = -0.0050755573  S^2 = 0.0000000
               |grad[o]|=0.0594  |ddm|=0.00472  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5163346546474  dE = -0.0041770977  S^2 = 0.0000000
               |grad[o]|=0.0486  |ddm|=0.00258  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5198644556883  dE = -0.003529801  S^2 = 0.0000000
               |grad[o]|=0.0398  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5228265612236  dE = -0.0029621055  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.525242545042  dE = -0.0024159838  S^2 = 0.0000000
               |grad[o]|=0.0255  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5271105805105  dE = -0.0018680355  S^2 = 0.0000000
               |grad[o]|=0.0195  |ddm|=0.0022  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5284265121202  dE = -0.0013159316  S^2 = 0.0000000
               |grad[o]|=0.0139  |ddm|=0.00263  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5291872106803  dE = -0.00076069856  S^2 = 0.0000000
               |grad[o]|=0.00884  |ddm|=0.00303  |maxRot[o]|=0.0798
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5293600923331  dE = -0.00017288165  S^2 = 0.0000000
               |grad[o]|=0.00412  |ddm|=0.00349  |maxRot[o]|= 0.04
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5293894029125  dE = -2.9310579e-05  S^2 = 0.0000000
               |grad[o]|=0.00174  |ddm|=0.00233  |maxRot[o]|=0.0197
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5293900629002  dE = -6.5998766e-07  S^2 = 0.0000000
               |grad[o]|=0.000421  |ddm|=0.00168  |maxRot[o]|=0.00302
macro iter 16 (3 JK  0 micro), CASSCF E = -75.529390084557  dE = -2.1656845e-08  S^2 = 0.0000000
               |grad[o]|=9.61e-05  |ddm|=0.000516  |maxRot[o]|=0.000499
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5293900854118  dE = -8.5475449e-10  S^2 = 0.0000000
               |grad[o]|=2.13e-05  |ddm|=0.000131  |maxRot[o]|=9.08e-05
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5293900854452  dE = -3.3452352e-11  S^2 = 0.0000000
               |grad[o]|=4.17e-06  |ddm|=2.58e-05  |maxRot[o]|=1.78e-05
2-step CASSCF converged in 18 macro (91 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98911928 1.93077483 1.93077463 1.47651509 0.52034969 0.07191178
 0.07191156 0.00864315]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00076   0.00000   0.00000   0.00197  -0.00230
  0 C 2s       0.57327  -0.00000  -0.00000   0.45141  -0.41073
  0 C 3s      -0.05772  -0.00000   0.00000   0.00999  -0.03341
  0 C 2px     -0.00000   0.00000   0.70492   0.00000   0.00000
  0 C 2py     -0.00000   0.70492   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40282  -0.00000   0.00000  -0.54404   0.57355
  0 C 3px     -0.00000   0.00000  -0.04022   0.00000  -0.00000
  0 C 3py      0.00000  -0.04022  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05831  -0.00000   0.00000  -0.00984  -0.03298
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.03836   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04862  -0.00000   0.00000   0.00687   0.01178
  0 C 3dxz    -0.00000   0.00000   0.03836   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00076   0.00000   0.00000  -0.00197  -0.00230
  1 C 2s       0.57327   0.00000  -0.00000  -0.45141  -0.41073
  1 C 3s      -0.05772   0.00000  -0.00000  -0.00999  -0.03341
  1 C 2px      0.00000  -0.00000   0.70492  -0.00000   0.00000
  1 C 2py      0.00000   0.70492   0.00000   0.00000  -0.00000
  1 C 2pz     -0.40282   0.00000   0.00000  -0.54404  -0.57355
  1 C 3px      0.00000  -0.00000  -0.04022  -0.00000  -0.00000
  1 C 3py      0.00000  -0.04022  -0.00000   0.00000   0.00000
  1 C 3pz      0.05831  -0.00000   0.00000  -0.00984   0.03298
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03836   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04862   0.00000  -0.00000  -0.00687   0.01178
  1 C 3dxz    -0.00000   0.00000  -0.03836   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00101
  0 C 2s      -0.00000  -0.00000   0.54172
  0 C 3s       0.00000  -0.00000  -0.04839
  0 C 2px      0.70576  -0.00000   0.00000
  0 C 2py      0.00000   0.70576  -0.00000
  0 C 2pz     -0.00000   0.00000   0.44796
  0 C 3px     -0.03649  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03649  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00649
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02381  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.05909
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00101
  1 C 2s      -0.00000   0.00000  -0.54172
  1 C 3s      -0.00000   0.00000   0.04839
  1 C 2px     -0.70576   0.00000   0.00000
  1 C 2py      0.00000  -0.70576  -0.00000
  1 C 2pz      0.00000   0.00000   0.44796
  1 C 3px      0.03649   0.00000  -0.00000
  1 C 3py     -0.00000   0.03649   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00649
  1 C 3dxy    -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02381  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.05909
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99610894
<CAS-nat-orb|mo-hf>  4  4    0.99985893
<CAS-nat-orb|mo-hf>  5  5    0.99985893
<CAS-nat-orb|mo-hf>  6  6    0.99868925
<CAS-nat-orb|mo-hf>  7  7    0.98295349
<CAS-nat-orb|mo-hf>  8  8    0.88422779
<CAS-nat-orb|mo-hf>  8  15   -0.46451022
<CAS-nat-orb|mo-hf>  9  9    0.88422763
<CAS-nat-orb|mo-hf>  9  16   -0.46451050
<CAS-nat-orb|mo-hf>  10  17    0.44059927
<CAS-nat-orb|mo-hf>  10  20   -0.73158934
CASSCF energy = -75.5293900854452
CASCI E = -75.5293900854452  E(CI) = -18.8101054540078  S^2 = 0.0000000
Density matrix diagonal elements [1.98911946 1.93077452 1.93077468 1.47651335 0.52035138 0.07191176
 0.07191182 0.00864304]
i = 1  <i|F|i> = -11.24804895
i = 2  <i|F|i> = -11.23867034
i = 3  <i|F|i> =  -1.07651820
i = 4  <i|F|i> =  -0.45770118
i = 5  <i|F|i> =  -0.45770121
i = 6  <i|F|i> =  -0.36375498
i = 7  <i|F|i> =  -0.13714564
i = 8  <i|F|i> =   0.38729507
i = 9  <i|F|i> =   0.38729524
i = 10  <i|F|i> =   1.43295504
i = 11  <i|F|i> =   0.56073938
i = 12  <i|F|i> =   0.61039306
i = 13  <i|F|i> =   0.61039305
i = 14  <i|F|i> =   0.75758672
i = 15  <i|F|i> =   0.69404178
i = 16  <i|F|i> =   0.69404162
i = 17  <i|F|i> =   0.56132238
i = 18  <i|F|i> =   1.22452804
i = 19  <i|F|i> =   1.22452804
i = 20  <i|F|i> =   1.19277663
i = 21  <i|F|i> =   1.53503310
i = 22  <i|F|i> =   1.53503310
i = 23  <i|F|i> =   1.73361993
i = 24  <i|F|i> =   1.73361993
i = 25  <i|F|i> =   2.09594176
i = 26  <i|F|i> =   2.26224259
i = 27  <i|F|i> =   2.26224257
i = 28  <i|F|i> =   2.90566126
......production of RDMs took       2.24 sec
......reading the RDM took          0.45 sec
......production of RDMs took      60.76 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.69 sec

E(WickSCNEVPT2-ijrs) =    -0.00048231781802
E(WickSCNEVPT2- rsi) =    -0.00128576657920
E(WickSCNEVPT2- ijr) =    -0.00051998602007
E(WickSCNEVPT2-  rs) =    -0.04127679182276
E(WickSCNEVPT2-  ij) =    -0.00017355279558
E(WickSCNEVPT2-  ir) =    -0.00147712360882
E(WickSCNEVPT2-   r) =    -0.03835691217074
E(WickSCNEVPT2-   i) =    -0.00033991559880
E(WickSCNEVPT2) = -75.61330245185924  E_corr_pt = -0.08391236641399832
Timings = pdms =   73.12 | eris =    0.62 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.03 | r =    0.61 | i =    0.25
Time cost =    616.833
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:54:21 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.084813282386 AA    0.000000000000   0.000000000000   2.050000000000 Bohr   0.0

nuclear repulsion = 17.5609756097561
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3231.08


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmphnxxxlpc
max_memory 4000 MB (current use 357 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8587717717965

WARN: Singularity detected in overlap matrix (condition number = 1.1e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.343801090949931  LUMO (Ag) = -0.208899636382795
cycle= 1 E= -75.3152287127073  delta_E= 0.544  |g|= 0.177  |ddm|= 1.56
HOMO (B1u) = -0.504407518465331  LUMO (Ag) = -0.123879990102771
cycle= 2 E= -75.3262515819531  delta_E= -0.011  |g|= 0.0526  |ddm|= 0.188
HOMO (B1u) = -0.474708360691126  LUMO (Ag) = -0.0950218080877932
cycle= 3 E= -75.3271055696138  delta_E= -0.000854  |g|= 0.0134  |ddm|= 0.101
HOMO (B1u) = -0.474494822450148  LUMO (Ag) = -0.0988363835418905
cycle= 4 E= -75.3272181663453  delta_E= -0.000113  |g|= 0.00221  |ddm|= 0.0646
HOMO (B1u) = -0.475044448091173  LUMO (Ag) = -0.10031489519861
cycle= 5 E= -75.3272215916787  delta_E= -3.43e-06  |g|= 0.000363  |ddm|= 0.0164
HOMO (B1u) = -0.475018098728984  LUMO (Ag) = -0.10027761522135
cycle= 6 E= -75.3272216794877  delta_E= -8.78e-08  |g|= 2.61e-05  |ddm|= 0.00103
HOMO (B1u) = -0.47502451738407  LUMO (Ag) = -0.100284470661365
cycle= 7 E= -75.3272216798442  delta_E= -3.57e-10  |g|= 1.87e-06  |ddm|= 0.000419
HOMO (B1u) = -0.475024512000397  LUMO (Ag) = -0.100284344431198
cycle= 8 E= -75.3272216798457  delta_E= -1.48e-12  |g|= 1.12e-07  |ddm|= 3.22e-05
HOMO (B1u) = -0.475024518734557  LUMO (Ag) = -0.100284359328575
cycle= 9 E= -75.3272216798457  delta_E=    0  |g|= 7.11e-09  |ddm|= 6.36e-07
HOMO (B1u) = -0.475024516367194  LUMO (Ag) = -0.100284355794177
cycle= 10 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 6.87e-09  |ddm|= 8.54e-09
HOMO (B1u) = -0.475024518411648  LUMO (Ag) = -0.100284358872737
cycle= 11 E= -75.3272216798457  delta_E= -2.84e-14  |g|= 5.89e-09  |ddm|= 2.94e-08
HOMO (B1u) = -0.475024516800708  LUMO (Ag) = -0.100284356710031
cycle= 12 E= -75.3272216798457  delta_E=    0  |g|= 5.66e-10  |ddm|= 7.3e-09
HOMO (B1u) = -0.475024516784272  LUMO (Ag) = -0.100284356795131
cycle= 13 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 5.18e-10  |ddm|= 1.16e-09
HOMO (B1u) = -0.475024516719603  LUMO (Ag) = -0.100284356711536
cycle= 14 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 5.44e-10  |ddm|= 1.01e-09
HOMO (B1u) = -0.47502451668671  LUMO (Ag) = -0.100284356712261
cycle= 15 E= -75.3272216798456  delta_E= 7.11e-14  |g|= 5.41e-10  |ddm|= 5.24e-10
HOMO (B1u) = -0.475024516739613  LUMO (Ag) = -0.10028435671008
cycle= 16 E= -75.3272216798456  delta_E= 1.42e-14  |g|= 4.23e-10  |ddm|= 3.92e-09
HOMO (B1u) = -0.475024516863468  LUMO (Ag) = -0.100284356807443
cycle= 17 E= -75.3272216798456  delta_E= -5.68e-14  |g|= 5.73e-10  |ddm|= 1.52e-09
HOMO (B1u) = -0.475024516900905  LUMO (Ag) = -0.100284356826767
cycle= 18 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 4.2e-10  |ddm|= 6.14e-10
HOMO (B1u) = -0.47502451685619  LUMO (Ag) = -0.100284356792233
cycle= 19 E= -75.3272216798456  delta_E= -5.68e-14  |g|= 2.38e-10  |ddm|= 5.21e-10
HOMO (B1u) = -0.47502451688113  LUMO (Ag) = -0.100284356813104
cycle= 20 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 1.02e-10  |ddm|= 2.27e-10
HOMO (B1u) = -0.475024516876966  LUMO (Ag) = -0.100284356808923
cycle= 21 E= -75.3272216798456  delta_E= -8.53e-14  |g|= 9.34e-11  |ddm|= 3.54e-11
HOMO (B1u) = -0.475024516876381  LUMO (Ag) = -0.10028435680395
cycle= 22 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 8.27e-11  |ddm|= 1.02e-10
HOMO (B1u) = -0.475024516874411  LUMO (Ag) = -0.100284356797748
cycle= 23 E= -75.3272216798456  delta_E=    0  |g|= 7.23e-11  |ddm|= 1.49e-10
HOMO (B1u) = -0.475024516865298  LUMO (Ag) = -0.100284356774866
Extra cycle  E= -75.3272216798456  delta_E=    0  |g|= 2.33e-11  |ddm|= 2.2e-10
converged SCF energy = -75.3272216798456

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmphnxxxlpc
max_memory 4000 MB (current use 363 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4833111059112  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5010934953602  dE = -0.017782389  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5165853911107  dE = -0.015491896  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0415  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.527443878436  dE = -0.010858487  S^2 = 0.0000000
               |grad[o]|=0.0941  |ddm|=0.0269  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5341204713886  dE = -0.006676593  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0121  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5392309320764  dE = -0.0051104607  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00475  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5434695365266  dE = -0.0042386045  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.00267  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5470496056393  dE = -0.0035800691  S^2 = 0.0000000
               |grad[o]|=0.0393  |ddm|=0.00189  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5500313212136  dE = -0.0029817156  S^2 = 0.0000000
               |grad[o]|=0.0315  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5524229992475  dE = -0.002391678  S^2 = 0.0000000
               |grad[o]|=0.0245  |ddm|=0.0021  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5542142099431  dE = -0.0017912107  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5553943259034  dE = -0.001180116  S^2 = 0.0000000
               |grad[o]|=0.0125  |ddm|=0.00293  |maxRot[o]|=0.0798
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5559531753084  dE = -0.0005588494  S^2 = 0.0000000
               |grad[o]|=0.0071  |ddm|=0.00332  |maxRot[o]|=0.0798
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5559945764768  dE = -4.1401168e-05  S^2 = 0.0000000
               |grad[o]|=0.00221  |ddm|=0.00384  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5559984928513  dE = -3.9163745e-06  S^2 = 0.0000000
               |grad[o]|=0.000816  |ddm|=0.00163  |maxRot[o]|=0.00745
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5559985890167  dE = -9.6165365e-08  S^2 = 0.0000000
               |grad[o]|=0.00018  |ddm|=0.000846  |maxRot[o]|=0.00111
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5559985921979  dE = -3.1811709e-09  S^2 = 0.0000000
               |grad[o]|=3.84e-05  |ddm|=0.000226  |maxRot[o]|=0.000184
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5559985923316  dE = -1.3376678e-10  S^2 = 0.0000000
               |grad[o]|=7.88e-06  |ddm|=5.04e-05  |maxRot[o]|=3.29e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5559985923256  dE = 6.0254024e-12  S^2 = 0.0000000
               |grad[o]|=1.72e-06  |ddm|=1.39e-05  |maxRot[o]|=7.37e-06
2-step CASSCF converged in 18 macro (89 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98851466 1.92585828 1.92585829 1.49745306 0.4990744  0.07700631
 0.07700628 0.00922871]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00113   0.00000   0.00000   0.00208  -0.00211
  0 C 2s       0.57579   0.00000  -0.00000   0.46137  -0.40723
  0 C 3s      -0.05693  -0.00000  -0.00000   0.00979  -0.03053
  0 C 2px     -0.00000   0.00000   0.70524  -0.00000   0.00000
  0 C 2py      0.00000   0.70524   0.00000  -0.00000  -0.00000
  0 C 2pz      0.39967   0.00000   0.00000  -0.53565   0.57613
  0 C 3px     -0.00000   0.00000  -0.03513  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03513   0.00000   0.00000  -0.00000
  0 C 3pz     -0.05695  -0.00000   0.00000  -0.00906  -0.03424
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.03742   0.00000   0.00000  -0.00000
  0 C 3dz^2    0.04728  -0.00000   0.00000   0.00608   0.01129
  0 C 3dxz    -0.00000   0.00000   0.03741  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00113   0.00000   0.00000  -0.00208  -0.00211
  1 C 2s       0.57579   0.00000  -0.00000  -0.46137  -0.40723
  1 C 3s      -0.05693   0.00000   0.00000  -0.00979  -0.03053
  1 C 2px      0.00000  -0.00000   0.70524   0.00000   0.00000
  1 C 2py      0.00000   0.70524  -0.00000  -0.00000   0.00000
  1 C 2pz     -0.39967   0.00000  -0.00000  -0.53565  -0.57613
  1 C 3px      0.00000  -0.00000  -0.03513   0.00000  -0.00000
  1 C 3py      0.00000  -0.03513  -0.00000   0.00000   0.00000
  1 C 3pz      0.05695  -0.00000  -0.00000  -0.00906   0.03424
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.03742   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04728  -0.00000   0.00000  -0.00608   0.01129
  1 C 3dxz    -0.00000   0.00000  -0.03741  -0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00097
  0 C 2s      -0.00000   0.00000   0.53380
  0 C 3s      -0.00000   0.00000  -0.04704
  0 C 2px      0.70587   0.00000  -0.00000
  0 C 2py      0.00000   0.70587   0.00000
  0 C 2pz     -0.00000  -0.00000   0.45840
  0 C 3px     -0.03434   0.00000  -0.00000
  0 C 3py      0.00000  -0.03434  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.00431
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.05187
  0 C 3dxz    -0.02382  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00097
  1 C 2s       0.00000  -0.00000  -0.53380
  1 C 3s       0.00000  -0.00000   0.04704
  1 C 2px     -0.70587   0.00000   0.00000
  1 C 2py     -0.00000  -0.70587   0.00000
  1 C 2pz      0.00000   0.00000   0.45840
  1 C 3px      0.03434  -0.00000   0.00000
  1 C 3py     -0.00000   0.03434   0.00000
  1 C 3pz     -0.00000   0.00000  -0.00431
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.05187
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99594650
<CAS-nat-orb|mo-hf>  4  4    0.99985545
<CAS-nat-orb|mo-hf>  5  5    0.99985545
<CAS-nat-orb|mo-hf>  6  6    0.99869863
<CAS-nat-orb|mo-hf>  7  7    0.98240657
<CAS-nat-orb|mo-hf>  8  8    0.89361611
<CAS-nat-orb|mo-hf>  8  15   -0.44672580
<CAS-nat-orb|mo-hf>  9  9    0.89361608
<CAS-nat-orb|mo-hf>  9  16   -0.44672586
<CAS-nat-orb|mo-hf>  10  17    0.47419811
<CAS-nat-orb|mo-hf>  10  20   -0.71074863
CASSCF energy = -75.5559985923256
CASCI E = -75.5559985923256  E(CI) = -18.6416909102531  S^2 = 0.0000000
Density matrix diagonal elements [1.98851472 1.92585824 1.92585835 1.49745401 0.49907344 0.07700627
 0.0770063  0.00922867]
i = 1  <i|F|i> = -11.25253524
i = 2  <i|F|i> = -11.24490449
i = 3  <i|F|i> =  -1.06847790
i = 4  <i|F|i> =  -0.44882005
i = 5  <i|F|i> =  -0.44882007
i = 6  <i|F|i> =  -0.37294822
i = 7  <i|F|i> =  -0.13488225
i = 8  <i|F|i> =   0.36660423
i = 9  <i|F|i> =   0.36660427
i = 10  <i|F|i> =   1.37009405
i = 11  <i|F|i> =   0.56559468
i = 12  <i|F|i> =   0.61670021
i = 13  <i|F|i> =   0.61670022
i = 14  <i|F|i> =   0.75327479
i = 15  <i|F|i> =   0.69617258
i = 16  <i|F|i> =   0.69617254
i = 17  <i|F|i> =   0.55946699
i = 18  <i|F|i> =   1.22587779
i = 19  <i|F|i> =   1.22587779
i = 20  <i|F|i> =   1.18440833
i = 21  <i|F|i> =   1.51300115
i = 22  <i|F|i> =   1.51300115
i = 23  <i|F|i> =   1.72040347
i = 24  <i|F|i> =   1.72040347
i = 25  <i|F|i> =   2.09431067
i = 26  <i|F|i> =   2.23829343
i = 27  <i|F|i> =   2.23829342
i = 28  <i|F|i> =   2.79138039
......production of RDMs took       2.85 sec
......reading the RDM took          0.46 sec
......production of RDMs took      20.41 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.67 sec

E(WickSCNEVPT2-ijrs) =    -0.00044697427817
E(WickSCNEVPT2- rsi) =    -0.00123636415393
E(WickSCNEVPT2- ijr) =    -0.00050435224660
E(WickSCNEVPT2-  rs) =    -0.04102094238709
E(WickSCNEVPT2-  ij) =    -0.00017354151347
E(WickSCNEVPT2-  ir) =    -0.00145175998554
E(WickSCNEVPT2-   r) =    -0.03905002736301
E(WickSCNEVPT2-   i) =    -0.00033359442630
E(WickSCNEVPT2) = -75.6402161486797  E_corr_pt = -0.0842175563541005
Timings = pdms =   33.36 | eris =    0.62 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.03 | ir =    0.03 | r =    0.60 | i =    0.25
Time cost =    549.919
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:03:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.111272142932 AA    0.000000000000   0.000000000000   2.100000000000 Bohr   0.0

nuclear repulsion = 17.1428571428571
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3753.61


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp7xne7hf0
max_memory 4000 MB (current use 370 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8003866027882

WARN: Singularity detected in overlap matrix (condition number =  999). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.328588944868891  LUMO (Ag) = -0.204693729619156
cycle= 1 E= -75.334780023076  delta_E= 0.466  |g|= 0.18  |ddm|= 1.55
HOMO (B1u) = -0.512671455628695  LUMO (Ag) = -0.127860887413402
cycle= 2 E= -75.346109112634  delta_E= -0.0113  |g|= 0.0522  |ddm|= 0.19
HOMO (B1u) = -0.482062537885923  LUMO (Ag) = -0.0974769445191792
cycle= 3 E= -75.3469306677088  delta_E= -0.000822  |g|= 0.0126  |ddm|= 0.0913
HOMO (B1u) = -0.481374466024949  LUMO (Ag) = -0.100457341704974
cycle= 4 E= -75.3470296424031  delta_E= -9.9e-05  |g|= 0.00217  |ddm|= 0.0587
HOMO (B1u) = -0.481886259872508  LUMO (Ag) = -0.101886818572119
cycle= 5 E= -75.3470329570726  delta_E= -3.31e-06  |g|= 0.000344  |ddm|= 0.0161
HOMO (B1u) = -0.481861583616576  LUMO (Ag) = -0.101865081892995
cycle= 6 E= -75.3470330362213  delta_E= -7.91e-08  |g|= 2.58e-05  |ddm|= 0.000729
HOMO (B1u) = -0.4818683559872  LUMO (Ag) = -0.101872367771488
cycle= 7 E= -75.3470330365669  delta_E= -3.46e-10  |g|= 2.05e-06  |ddm|= 0.000385
HOMO (B1u) = -0.481868395860481  LUMO (Ag) = -0.101872342919466
cycle= 8 E= -75.3470330365686  delta_E= -1.71e-12  |g|= 1.14e-07  |ddm|= 3.34e-05
HOMO (B1u) = -0.481868402322704  LUMO (Ag) = -0.101872355526201
cycle= 9 E= -75.3470330365685  delta_E= 5.68e-14  |g|= 7.19e-09  |ddm|= 5.08e-07
HOMO (B1u) = -0.481868399648901  LUMO (Ag) = -0.101872352079335
cycle= 10 E= -75.3470330365686  delta_E= -7.11e-14  |g|= 7.13e-09  |ddm|= 1.11e-08
HOMO (B1u) = -0.481868400187329  LUMO (Ag) = -0.101872353261586
cycle= 11 E= -75.3470330365685  delta_E= 7.11e-14  |g|= 6.88e-10  |ddm|= 1.91e-08
HOMO (B1u) = -0.481868400200829  LUMO (Ag) = -0.101872353276425
cycle= 12 E= -75.3470330365687  delta_E= -1.56e-13  |g|= 4.62e-10  |ddm|= 1.76e-09
HOMO (B1u) = -0.481868400179027  LUMO (Ag) = -0.10187235330595
cycle= 13 E= -75.3470330365685  delta_E= 1.56e-13  |g|= 4.28e-10  |ddm|= 1.13e-09
HOMO (B1u) = -0.481868400172551  LUMO (Ag) = -0.101872353276016
cycle= 14 E= -75.3470330365686  delta_E= -8.53e-14  |g|= 3.69e-10  |ddm|= 2.37e-10
HOMO (B1u) = -0.481868400168641  LUMO (Ag) = -0.101872353281235
cycle= 15 E= -75.3470330365686  delta_E= 5.68e-14  |g|= 3.34e-10  |ddm|= 1.82e-10
HOMO (B1u) = -0.481868400196232  LUMO (Ag) = -0.10187235327912
cycle= 16 E= -75.3470330365686  delta_E= -5.68e-14  |g|= 2.88e-10  |ddm|= 1.68e-09
HOMO (B1u) = -0.481868400273101  LUMO (Ag) = -0.101872353333705
cycle= 17 E= -75.3470330365686  delta_E=    0  |g|= 4.41e-10  |ddm|= 8.03e-10
HOMO (B1u) = -0.481868400301001  LUMO (Ag) = -0.10187235334432
cycle= 18 E= -75.3470330365685  delta_E= 9.95e-14  |g|= 2.92e-10  |ddm|= 3.38e-10
HOMO (B1u) = -0.481868400249685  LUMO (Ag) = -0.101872353305611
cycle= 19 E= -75.3470330365686  delta_E= -1.14e-13  |g|= 8.2e-11  |ddm|= 4.09e-10
HOMO (B1u) = -0.481868400246646  LUMO (Ag) = -0.101872353301273
cycle= 20 E= -75.3470330365686  delta_E= 7.11e-14  |g|= 6.84e-11  |ddm|= 4.5e-11
HOMO (B1u) = -0.481868400245595  LUMO (Ag) = -0.1018723532991
cycle= 21 E= -75.3470330365686  delta_E=    0  |g|= 5.99e-11  |ddm|= 1.49e-11
HOMO (B1u) = -0.481868400243536  LUMO (Ag) = -0.101872353286586
Extra cycle  E= -75.3470330365685  delta_E= 4.26e-14  |g|= 1.75e-11  |ddm|= 1.75e-10
converged SCF energy = -75.3470330365685

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp7xne7hf0
max_memory 4000 MB (current use 370 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5047007388563  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5230707718479  dE = -0.018370033  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5389823046739  dE = -0.015911533  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5492400829398  dE = -0.010257778  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0279  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5558470381311  dE = -0.0066069552  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5609995555855  dE = -0.0051525175  S^2 = 0.0000000
               |grad[o]|=0.0585  |ddm|=0.00486  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5652985898188  dE = -0.0042990342  S^2 = 0.0000000
               |grad[o]|=0.0476  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.568916461862  dE = -0.003617872  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5718931626712  dE = -0.0029767008  S^2 = 0.0000000
               |grad[o]|=0.0304  |ddm|=0.00212  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5742225133747  dE = -0.0023293507  S^2 = 0.0000000
               |grad[o]|=0.0232  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5758843670066  dE = -0.0016618536  S^2 = 0.0000000
               |grad[o]|=0.0166  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.576861077888  dE = -0.00097671088  S^2 = 0.0000000
               |grad[o]|=0.0106  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 12 (5 JK  0 micro), CASSCF E = -75.5771323610574  dE = -0.00027128317  S^2 = 0.0000000
               |grad[o]|=0.00491  |ddm|=0.00368  |maxRot[o]|=0.0599
macro iter 13 (3 JK  0 micro), CASSCF E = -75.577137094218  dE = -4.7331606e-06  S^2 = 0.0000000
               |grad[o]|=0.00106  |ddm|=0.0034  |maxRot[o]|=0.00809
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5771372193368  dE = -1.2511887e-07  S^2 = 0.0000000
               |grad[o]|=0.000227  |ddm|=0.00107  |maxRot[o]|=0.00121
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5771372233949  dE = -4.0580801e-09  S^2 = 0.0000000
               |grad[o]|=4.47e-05  |ddm|=0.000274  |maxRot[o]|=0.000204
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5771372235462  dE = -1.5127455e-10  S^2 = 0.0000000
               |grad[o]|=8.73e-06  |ddm|=5.85e-05  |maxRot[o]|=3.68e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5771372235523  dE = -6.1248784e-12  S^2 = 0.0000000
               |grad[o]|=1.69e-06  |ddm|=1.21e-05  |maxRot[o]|=7.24e-06
2-step CASSCF converged in 17 macro (85 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98787579 1.9207281  1.92072834 1.51715844 0.47907021 0.08229648
 0.08229651 0.00984614]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00153   0.00000   0.00000   0.00220  -0.00194
  0 C 2s       0.57846  -0.00000  -0.00000   0.47106  -0.40350
  0 C 3s      -0.05596  -0.00000  -0.00000   0.00960  -0.02757
  0 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  0 C 2py      0.00000   0.70551  -0.00000  -0.00000   0.00000
  0 C 2pz      0.39631   0.00000  -0.00000  -0.52717   0.57883
  0 C 3px     -0.00000   0.00000  -0.03031   0.00000  -0.00000
  0 C 3py      0.00000  -0.03031  -0.00000   0.00000   0.00000
  0 C 3pz     -0.05553  -0.00000  -0.00000  -0.00832  -0.03544
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.03648  -0.00000   0.00000   0.00000
  0 C 3dz^2    0.04590  -0.00000  -0.00000   0.00531   0.01098
  0 C 3dxz     0.00000   0.00000   0.03648   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00153   0.00000   0.00000  -0.00220  -0.00194
  1 C 2s       0.57846   0.00000   0.00000  -0.47106  -0.40350
  1 C 3s      -0.05596   0.00000   0.00000  -0.00960  -0.02757
  1 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70551  -0.00000  -0.00000  -0.00000
  1 C 2pz     -0.39631   0.00000   0.00000  -0.52717  -0.57883
  1 C 3px     -0.00000   0.00000  -0.03031  -0.00000   0.00000
  1 C 3py     -0.00000  -0.03031   0.00000  -0.00000  -0.00000
  1 C 3pz      0.05553  -0.00000  -0.00000  -0.00832   0.03544
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.03648  -0.00000   0.00000   0.00000
  1 C 3dz^2    0.04590   0.00000   0.00000  -0.00531   0.01098
  1 C 3dxz     0.00000  -0.00000  -0.03648   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00092
  0 C 2s       0.00000  -0.00000   0.52568
  0 C 3s      -0.00000   0.00000  -0.04590
  0 C 2px      0.70596  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70596  -0.00000
  0 C 2pz     -0.00000   0.00000   0.46846
  0 C 3px     -0.03238  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03238   0.00000
  0 C 3pz     -0.00000   0.00000  -0.00204
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02383   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.04579
  0 C 3dxz    -0.02383  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00092
  1 C 2s       0.00000  -0.00000  -0.52568
  1 C 3s       0.00000  -0.00000   0.04590
  1 C 2px     -0.70596   0.00000   0.00000
  1 C 2py      0.00000  -0.70596  -0.00000
  1 C 2pz     -0.00000  -0.00000   0.46846
  1 C 3px      0.03238   0.00000   0.00000
  1 C 3py      0.00000   0.03238   0.00000
  1 C 3pz      0.00000   0.00000  -0.00204
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02383  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04579
  1 C 3dxz    -0.02383  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99576518
<CAS-nat-orb|mo-hf>  4  4    0.99984965
<CAS-nat-orb|mo-hf>  5  5    0.99984965
<CAS-nat-orb|mo-hf>  6  6    0.99869802
<CAS-nat-orb|mo-hf>  7  7    0.98184923
<CAS-nat-orb|mo-hf>  8  8    0.90221125
<CAS-nat-orb|mo-hf>  8  15   -0.42956745
<CAS-nat-orb|mo-hf>  9  9    0.90221129
<CAS-nat-orb|mo-hf>  9  16   -0.42956739
<CAS-nat-orb|mo-hf>  10  10    0.40783706
<CAS-nat-orb|mo-hf>  10  17    0.50741106
<CAS-nat-orb|mo-hf>  10  20   -0.68802314
CASSCF energy = -75.5771372235523
CASCI E = -75.5771372235523  E(CI) = -18.4770626177182  S^2 = 0.0000000
Density matrix diagonal elements [1.98787567 1.92072814 1.92072813 1.51715225 0.47907623 0.08229681
 0.08229664 0.00984613]
i = 1  <i|F|i> = -11.25749854
i = 2  <i|F|i> = -11.25126968
i = 3  <i|F|i> =  -1.05987226
i = 4  <i|F|i> =  -0.44032632
i = 5  <i|F|i> =  -0.44032632
i = 6  <i|F|i> =  -0.38186117
i = 7  <i|F|i> =  -0.13263996
i = 8  <i|F|i> =   0.34686902
i = 9  <i|F|i> =   0.34686899
i = 10  <i|F|i> =   1.30810028
i = 11  <i|F|i> =   0.57062510
i = 12  <i|F|i> =   0.62275859
i = 13  <i|F|i> =   0.62275860
i = 14  <i|F|i> =   0.74918445
i = 15  <i|F|i> =   0.69803210
i = 16  <i|F|i> =   0.69803213
i = 17  <i|F|i> =   0.55790048
i = 18  <i|F|i> =   1.22751612
i = 19  <i|F|i> =   1.22751612
i = 20  <i|F|i> =   1.17633703
i = 21  <i|F|i> =   1.49148803
i = 22  <i|F|i> =   1.49148804
i = 23  <i|F|i> =   1.70745762
i = 24  <i|F|i> =   1.70745762
i = 25  <i|F|i> =   2.09215530
i = 26  <i|F|i> =   2.21624378
i = 27  <i|F|i> =   2.21624380
i = 28  <i|F|i> =   2.69242912
......production of RDMs took       3.03 sec
......reading the RDM took          0.45 sec
......production of RDMs took      49.59 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickSCNEVPT2-ijrs) =    -0.00041725927674
E(WickSCNEVPT2- rsi) =    -0.00119161532892
E(WickSCNEVPT2- ijr) =    -0.00049029220097
E(WickSCNEVPT2-  rs) =    -0.04073540693924
E(WickSCNEVPT2-  ij) =    -0.00017247807724
E(WickSCNEVPT2-  ir) =    -0.00142743891741
E(WickSCNEVPT2-   r) =    -0.03975342893973
E(WickSCNEVPT2-   i) =    -0.00032723807109
E(WickSCNEVPT2) = -75.66165238130365  E_corr_pt = -0.08451515775133887
Timings = pdms =   62.90 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.03 | r =    0.61 | i =    0.36
Time cost =    618.859
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:13:49 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.137731003478 AA    0.000000000000   0.000000000000   2.150000000000 Bohr   0.0

nuclear repulsion = 16.7441860465116
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3994.63


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp8dpmz4vs
max_memory 4000 MB (current use 357 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.742346402077

WARN: Singularity detected in overlap matrix (condition number =  905). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.314216447683401  LUMO (Ag) = -0.20069252752058
cycle= 1 E= -75.349511035823  delta_E= 0.393  |g|= 0.183  |ddm|= 1.54
HOMO (B3u) = -0.511968787672981  LUMO (Ag) = -0.131517049931574
cycle= 2 E= -75.361230819294  delta_E= -0.0117  |g|= 0.052  |ddm|= 0.195
HOMO (B3u) = -0.477859245905662  LUMO (Ag) = -0.0996643076325098
cycle= 3 E= -75.3620321930708  delta_E= -0.000801  |g|= 0.0118  |ddm|= 0.0834
HOMO (B3u) = -0.480852254510821  LUMO (Ag) = -0.101863987618504
cycle= 4 E= -75.3621184017555  delta_E= -8.62e-05  |g|= 0.00212  |ddm|= 0.0529
HOMO (B2u) = -0.481684500444458  LUMO (Ag) = -0.103214149326982
cycle= 5 E= -75.3621215318462  delta_E= -3.13e-06  |g|= 0.000318  |ddm|= 0.0156
HOMO (B3u) = -0.481600836313234  LUMO (Ag) = -0.103210190493487
cycle= 6 E= -75.3621216003492  delta_E= -6.85e-08  |g|= 2.54e-05  |ddm|= 0.000515
HOMO (B3u) = -0.481601754909295  LUMO (Ag) = -0.103217967965933
cycle= 7 E= -75.362121600685  delta_E= -3.36e-10  |g|= 2.23e-06  |ddm|= 0.00035
HOMO (B3u) = -0.48160198740663  LUMO (Ag) = -0.103218034520496
cycle= 8 E= -75.362121600687  delta_E= -2.02e-12  |g|= 1.23e-07  |ddm|= 3.4e-05
HOMO (B2u) = -0.481601999517647  LUMO (Ag) = -0.103218045659883
cycle= 9 E= -75.3621216006869  delta_E= 1.14e-13  |g|= 7.62e-09  |ddm|= 3.86e-07
HOMO (B2u) = -0.481601998061569  LUMO (Ag) = -0.103218041936011
cycle= 10 E= -75.3621216006869  delta_E= -8.53e-14  |g|= 7.42e-09  |ddm|= 1.1e-08
HOMO (B2u) = -0.481601999733069  LUMO (Ag) = -0.103218043369842
cycle= 11 E= -75.362121600687  delta_E= -9.95e-14  |g|= 6.87e-10  |ddm|= 1.25e-08
HOMO (B2u) = -0.481601999845505  LUMO (Ag) = -0.103218043461425
cycle= 12 E= -75.3621216006869  delta_E= 9.95e-14  |g|= 5.05e-10  |ddm|= 2.43e-09
HOMO (B2u) = -0.481601999871472  LUMO (Ag) = -0.103218043494935
cycle= 13 E= -75.3621216006869  delta_E= 2.84e-14  |g|= 4.66e-10  |ddm|= 1.02e-09
HOMO (B2u) = -0.481601999856891  LUMO (Ag) = -0.103218043467695
cycle= 14 E= -75.3621216006869  delta_E= -1.42e-14  |g|= 3.92e-10  |ddm|= 1.66e-10
HOMO (B2u) = -0.481601999868314  LUMO (Ag) = -0.103218043467311
cycle= 15 E= -75.3621216006869  delta_E= -1.42e-14  |g|= 3.56e-10  |ddm|= 4.24e-10
HOMO (B2u) = -0.481601999840778  LUMO (Ag) = -0.103218043456748
cycle= 16 E= -75.362121600687  delta_E= -5.68e-14  |g|= 3.05e-10  |ddm|= 1.61e-09
HOMO (B2u) = -0.481601999854274  LUMO (Ag) = -0.103218043504912
cycle= 17 E= -75.362121600687  delta_E= 2.84e-14  |g|= 4.62e-10  |ddm|= 6.97e-10
HOMO (B2u) = -0.48160199990271  LUMO (Ag) = -0.103218043509653
cycle= 18 E= -75.362121600687  delta_E=    0  |g|= 3.01e-10  |ddm|= 2.69e-10
HOMO (B2u) = -0.481601999879426  LUMO (Ag) = -0.103218043468613
cycle= 19 E= -75.362121600687  delta_E= -2.84e-14  |g|= 8.31e-11  |ddm|= 4.59e-10
HOMO (B2u) = -0.481601999873893  LUMO (Ag) = -0.103218043463547
cycle= 20 E= -75.3621216006869  delta_E= 8.53e-14  |g|= 7.22e-11  |ddm|= 5.28e-11
HOMO (B2u) = -0.481601999873322  LUMO (Ag) = -0.103218043461946
cycle= 21 E= -75.3621216006869  delta_E=    0  |g|= 6.27e-11  |ddm|= 1.54e-11
HOMO (B3u) = -0.481601999871948  LUMO (Ag) = -0.103218043453428
Extra cycle  E= -75.362121600687  delta_E= -8.53e-14  |g|= 1.76e-11  |ddm|= 1.2e-10
converged SCF energy = -75.362121600687

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp8dpmz4vs
max_memory 4000 MB (current use 362 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5214099234426  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5403620704896  dE = -0.018952147  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5566943744679  dE = -0.016332304  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0461  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5664483853586  dE = -0.0097540109  S^2 = 0.0000000
               |grad[o]|=0.091  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5730073472845  dE = -0.0065589619  S^2 = 0.0000000
               |grad[o]|=0.0715  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5782102167503  dE = -0.0052028695  S^2 = 0.0000000
               |grad[o]|=0.0576  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5825630264569  dE = -0.0043528097  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5861977853267  dE = -0.0036347589  S^2 = 0.0000000
               |grad[o]|=0.0372  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5891324546796  dE = -0.0029346694  S^2 = 0.0000000
               |grad[o]|=0.0289  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5913444168698  dE = -0.0022119622  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.592802960606  dE = -0.0014585437  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5934808669139  dE = -0.00067790631  S^2 = 0.0000000
               |grad[o]|=0.00812  |ddm|=0.00368  |maxRot[o]|=0.0798
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5935226639145  dE = -4.1797001e-05  S^2 = 0.0000000
               |grad[o]|=0.00228  |ddm|=0.00417  |maxRot[o]|= 0.02
macro iter 13 (3 JK  0 micro), CASSCF E = -75.593527359043  dE = -4.6951286e-06  S^2 = 0.0000000
               |grad[o]|=0.000868  |ddm|=0.00146  |maxRot[o]|=0.00829
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5935274566684  dE = -9.762536e-08  S^2 = 0.0000000
               |grad[o]|=0.000175  |ddm|=0.000804  |maxRot[o]|=0.00112
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5935274594338  dE = -2.7654039e-09  S^2 = 0.0000000
               |grad[o]|=3.37e-05  |ddm|=0.000201  |maxRot[o]|=0.000174
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5935274595339  dE = -1.0010126e-10  S^2 = 0.0000000
               |grad[o]|=6.88e-06  |ddm|=4.95e-05  |maxRot[o]|=3.08e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5935274595375  dE = -3.6095571e-12  S^2 = 0.0000000
               |grad[o]|=1.18e-06  |ddm|=9.09e-06  |maxRot[o]|=5.92e-06
2-step CASSCF converged in 17 macro (83 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98720387 1.53562489 1.91537954 1.91537976 0.46035381 0.08778168
 0.08778187 0.01049457]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00194   0.00231   0.00000   0.00000  -0.00179
  0 C 2s       0.58123   0.48048  -0.00000  -0.00000  -0.39956
  0 C 3s      -0.05483   0.00943  -0.00000  -0.00000  -0.02456
  0 C 2px      0.00000   0.00000   0.00000   0.70574   0.00000
  0 C 2py      0.00000  -0.00000   0.70574   0.00000   0.00000
  0 C 2pz      0.39276  -0.51862   0.00000  -0.00000   0.58162
  0 C 3px      0.00000   0.00000  -0.00000  -0.02575   0.00000
  0 C 3py     -0.00000   0.00000  -0.02575  -0.00000   0.00000
  0 C 3pz     -0.05404  -0.00761  -0.00000  -0.00000  -0.03659
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.03555  -0.00000   0.00000
  0 C 3dz^2    0.04451   0.00457  -0.00000  -0.00000   0.01083
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03555   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00194  -0.00231   0.00000   0.00000  -0.00179
  1 C 2s       0.58123  -0.48048   0.00000   0.00000  -0.39956
  1 C 3s      -0.05483  -0.00943   0.00000   0.00000  -0.02456
  1 C 2px      0.00000  -0.00000   0.00000   0.70574  -0.00000
  1 C 2py      0.00000  -0.00000   0.70574   0.00000  -0.00000
  1 C 2pz     -0.39276  -0.51862  -0.00000  -0.00000  -0.58162
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.02575  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02575  -0.00000  -0.00000
  1 C 3pz      0.05404  -0.00761  -0.00000  -0.00000   0.03659
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03555   0.00000   0.00000
  1 C 3dz^2    0.04451  -0.00457   0.00000   0.00000   0.01083
  1 C 3dxz     0.00000   0.00000   0.00000  -0.03555   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00088
  0 C 2s      -0.00000  -0.00000   0.51738
  0 C 3s      -0.00000  -0.00000  -0.04498
  0 C 2px      0.70604   0.00000  -0.00000
  0 C 2py      0.00000   0.70604  -0.00000
  0 C 2pz     -0.00000   0.00000   0.47816
  0 C 3px     -0.03061   0.00000  -0.00000
  0 C 3py      0.00000  -0.03061  -0.00000
  0 C 3pz     -0.00000   0.00000   0.00024
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.04072
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00088
  1 C 2s       0.00000  -0.00000  -0.51738
  1 C 3s       0.00000   0.00000   0.04498
  1 C 2px     -0.70604  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70604   0.00000
  1 C 2pz     -0.00000  -0.00000   0.47816
  1 C 3px      0.03061  -0.00000   0.00000
  1 C 3py     -0.00000   0.03061   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00024
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04072
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99556546
<CAS-nat-orb|mo-hf>  4  4    0.99868710
<CAS-nat-orb|mo-hf>  5  5    0.99984158
<CAS-nat-orb|mo-hf>  6  6    0.99984158
<CAS-nat-orb|mo-hf>  7  7    0.98128498
<CAS-nat-orb|mo-hf>  8  8    0.91006591
<CAS-nat-orb|mo-hf>  8  15   -0.41306126
<CAS-nat-orb|mo-hf>  9  9    0.91006599
<CAS-nat-orb|mo-hf>  9  16   -0.41306109
<CAS-nat-orb|mo-hf>  10  10    0.41868601
<CAS-nat-orb|mo-hf>  10  17    0.53963890
<CAS-nat-orb|mo-hf>  10  20   -0.66337393
CASSCF energy = -75.5935274595375
CASCI E = -75.5935274595375  E(CI) = -18.3163035855642  S^2 = 0.0000000
Density matrix diagonal elements [1.98720393 1.53562745 1.9153797  1.91537956 0.46035123 0.08778185
 0.08778174 0.01049455]
i = 1  <i|F|i> = -11.26279327
i = 2  <i|F|i> = -11.25769248
i = 3  <i|F|i> =  -1.05081913
i = 4  <i|F|i> =  -0.39050191
i = 5  <i|F|i> =  -0.43218535
i = 6  <i|F|i> =  -0.43218533
i = 7  <i|F|i> =  -0.13042902
i = 8  <i|F|i> =   0.32803611
i = 9  <i|F|i> =   0.32803603
i = 10  <i|F|i> =   1.24747867
i = 11  <i|F|i> =   0.57579344
i = 12  <i|F|i> =   0.62856630
i = 13  <i|F|i> =   0.62856630
i = 14  <i|F|i> =   0.74534426
i = 15  <i|F|i> =   0.69964272
i = 16  <i|F|i> =   0.69964280
i = 17  <i|F|i> =   0.55660027
i = 18  <i|F|i> =   1.22943752
i = 19  <i|F|i> =   1.22943752
i = 20  <i|F|i> =   1.16854460
i = 21  <i|F|i> =   1.47052622
i = 22  <i|F|i> =   1.47052622
i = 23  <i|F|i> =   1.69478900
i = 24  <i|F|i> =   1.69478900
i = 25  <i|F|i> =   2.08913888
i = 26  <i|F|i> =   2.19574274
i = 27  <i|F|i> =   2.19574275
i = 28  <i|F|i> =   2.60670614
......production of RDMs took       1.82 sec
......reading the RDM took          0.45 sec
......production of RDMs took      34.64 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickSCNEVPT2-ijrs) =    -0.00039233114693
E(WickSCNEVPT2- rsi) =    -0.00115122695914
E(WickSCNEVPT2- ijr) =    -0.00047773020220
E(WickSCNEVPT2-  rs) =    -0.04042300343966
E(WickSCNEVPT2-  ij) =    -0.00017048343188
E(WickSCNEVPT2-  ir) =    -0.00140409153249
E(WickSCNEVPT2-   r) =    -0.04046672832259
E(WickSCNEVPT2-   i) =    -0.00032089205215
E(WickSCNEVPT2) = -75.67833394662456  E_corr_pt = -0.08480648708704913
Timings = pdms =   46.62 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.54 | i =    0.24
Time cost =     94.642
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:15:24 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.164189864024 AA    0.000000000000   0.000000000000   2.200000000000 Bohr   0.0

nuclear repulsion = 16.3636363636364
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.1]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      4077.38


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp615u2hz3
max_memory 4000 MB (current use 370 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6850211082767

WARN: Singularity detected in overlap matrix (condition number =  823). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.300635738182938  LUMO (Ag) = -0.196894745039134
cycle= 1 E= -75.3600714434764  delta_E= 0.325  |g|= 0.186  |ddm|= 1.52
HOMO (B2u) = -0.505767689307348  LUMO (Ag) = -0.134850139116739
cycle= 2 E= -75.3722557388853  delta_E= -0.0122  |g|= 0.0519  |ddm|= 0.201
HOMO (B3u) = -0.47104268602542  LUMO (Ag) = -0.101583923798026
cycle= 3 E= -75.3730472275437  delta_E= -0.000791  |g|= 0.011  |ddm|= 0.0769
HOMO (B3u) = -0.473583831878464  LUMO (Ag) = -0.103064436209408
cycle= 4 E= -75.3731222408077  delta_E= -7.5e-05  |g|= 0.00204  |ddm|= 0.0475
HOMO (B3u) = -0.474409949766168  LUMO (Ag) = -0.104308159498411
cycle= 5 E= -75.3731251255  delta_E= -2.88e-06  |g|= 0.000283  |ddm|= 0.0148
HOMO (B2u) = -0.474348151042957  LUMO (Ag) = -0.10432237944228
cycle= 6 E= -75.3731251811963  delta_E= -5.57e-08  |g|= 2.51e-05  |ddm|= 0.000586
HOMO (B2u) = -0.474349388268694  LUMO (Ag) = -0.104330764317116
cycle= 7 E= -75.3731251815251  delta_E= -3.29e-10  |g|= 2.41e-06  |ddm|= 0.000311
HOMO (B2u) = -0.474349685667095  LUMO (Ag) = -0.104330912577481
cycle= 8 E= -75.3731251815274  delta_E= -2.29e-12  |g|= 1.4e-07  |ddm|= 3.41e-05
HOMO (B3u) = -0.474349699392415  LUMO (Ag) = -0.10433092233006
cycle= 9 E= -75.3731251815274  delta_E= -1.42e-14  |g|= 8.38e-09  |ddm|= 2.86e-07
HOMO (B3u) = -0.474349697424536  LUMO (Ag) = -0.104330918014964
cycle= 10 E= -75.3731251815274  delta_E= 1.42e-14  |g|= 7.65e-09  |ddm|= 1.04e-08
HOMO (B3u) = -0.47434969952041  LUMO (Ag) = -0.104330919956305
cycle= 11 E= -75.3731251815274  delta_E= -2.84e-14  |g|= 8.11e-10  |ddm|= 1.34e-08
HOMO (B3u) = -0.474349699598714  LUMO (Ag) = -0.104330919996987
cycle= 12 E= -75.3731251815275  delta_E= -2.84e-14  |g|= 6.01e-10  |ddm|= 1.78e-09
HOMO (B2u) = -0.474349699594478  LUMO (Ag) = -0.104330919984968
cycle= 13 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 5.39e-10  |ddm|= 1.79e-09
HOMO (B2u) = -0.474349699605181  LUMO (Ag) = -0.104330919990653
cycle= 14 E= -75.3731251815274  delta_E= 1.42e-14  |g|= 4.51e-10  |ddm|= 5.6e-10
HOMO (B2u) = -0.474349699620007  LUMO (Ag) = -0.104330919984079
cycle= 15 E= -75.3731251815274  delta_E= 4.26e-14  |g|= 4.1e-10  |ddm|= 4.52e-10
HOMO (B3u) = -0.474349699583652  LUMO (Ag) = -0.104330919965972
cycle= 16 E= -75.3731251815274  delta_E=    0  |g|= 3.5e-10  |ddm|= 1.46e-09
HOMO (B3u) = -0.474349699579327  LUMO (Ag) = -0.104330920005794
cycle= 17 E= -75.3731251815274  delta_E=    0  |g|= 4.97e-10  |ddm|= 7.98e-10
HOMO (B2u) = -0.474349699623371  LUMO (Ag) = -0.104330920004103
cycle= 18 E= -75.3731251815274  delta_E=    0  |g|= 3.16e-10  |ddm|= 3.55e-10
HOMO (B2u) = -0.474349699595449  LUMO (Ag) = -0.10433091995967
cycle= 19 E= -75.3731251815275  delta_E= -8.53e-14  |g|= 9.83e-11  |ddm|= 6.37e-10
HOMO (B2u) = -0.474349699593137  LUMO (Ag) = -0.104330919955913
cycle= 20 E= -75.3731251815274  delta_E= 5.68e-14  |g|= 8.3e-11  |ddm|= 3.25e-11
HOMO (B2u) = -0.474349699593955  LUMO (Ag) = -0.104330919954961
cycle= 21 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 7.09e-11  |ddm|= 2.28e-11
HOMO (B3u) = -0.474349699592715  LUMO (Ag) = -0.104330919952283
cycle= 22 E= -75.3731251815274  delta_E= -5.68e-14  |g|= 5.84e-11  |ddm|= 6.09e-11
HOMO (B3u) = -0.474349699592211  LUMO (Ag) = -0.104330919950421
cycle= 23 E= -75.3731251815275  delta_E= -9.95e-14  |g|= 4.83e-11  |ddm|= 4.36e-11
HOMO (B2u) = -0.474349699591391  LUMO (Ag) = -0.104330919948966
cycle= 24 E= -75.3731251815275  delta_E= 7.11e-14  |g|= 4.17e-11  |ddm|= 5.88e-11
HOMO (B3u) = -0.474349699590859  LUMO (Ag) = -0.104330919947406
cycle= 25 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 3.56e-11  |ddm|= 1.86e-11
HOMO (B3u) = -0.474349699592307  LUMO (Ag) = -0.104330919946118
cycle= 26 E= -75.3731251815275  delta_E= -2.84e-14  |g|= 2.18e-11  |ddm|= 2.99e-11
HOMO (B3u) = -0.474349699594345  LUMO (Ag) = -0.104330919946813
cycle= 27 E= -75.3731251815274  delta_E= 8.53e-14  |g|= 1.55e-11  |ddm|= 2.32e-11
HOMO (B3u) = -0.474349699594354  LUMO (Ag) = -0.104330919946295
cycle= 28 E= -75.3731251815275  delta_E= -7.11e-14  |g|= 1.29e-11  |ddm|= 8.44e-12
HOMO (B3u) = -0.474349699594283  LUMO (Ag) = -0.104330919945754
cycle= 29 E= -75.3731251815274  delta_E= 4.26e-14  |g|= 1.05e-11  |ddm|= 7.96e-12
HOMO (B3u) = -0.474349699594222  LUMO (Ag) = -0.104330919945269
cycle= 30 E= -75.3731251815275  delta_E= -8.53e-14  |g|= 8.45e-12  |ddm|= 8e-12
HOMO (B3u) = -0.474349699594172  LUMO (Ag) = -0.104330919944858
cycle= 31 E= -75.3731251815274  delta_E= 8.53e-14  |g|= 6.77e-12  |ddm|= 5.63e-12
HOMO (B3u) = -0.474349699594144  LUMO (Ag) = -0.104330919944524
cycle= 32 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 5.37e-12  |ddm|= 3.78e-12
HOMO (B3u) = -0.474349699594159  LUMO (Ag) = -0.104330919944258
cycle= 33 E= -75.3731251815275  delta_E= -7.11e-14  |g|= 4.19e-12  |ddm|= 1.89e-12
HOMO (B3u) = -0.474349699594176  LUMO (Ag) = -0.104330919944038
cycle= 34 E= -75.3731251815274  delta_E= 4.26e-14  |g|= 3.27e-12  |ddm|= 1.52e-12
HOMO (B3u) = -0.474349699594171  LUMO (Ag) = -0.104330919943883
cycle= 35 E= -75.3731251815275  delta_E= -7.11e-14  |g|= 2.7e-12  |ddm|= 1.16e-12
HOMO (B3u) = -0.474349699594188  LUMO (Ag) = -0.104330919943767
cycle= 36 E= -75.3731251815275  delta_E= 1.42e-14  |g|= 2.2e-12  |ddm|= 1.67e-12
HOMO (B2u) = -0.474349699594207  LUMO (Ag) = -0.104330919943671
cycle= 37 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 1.78e-12  |ddm|= 1.43e-12
HOMO (B2u) = -0.474349699594224  LUMO (Ag) = -0.104330919943591
cycle= 38 E= -75.3731251815275  delta_E= -2.84e-14  |g|= 1.44e-12  |ddm|= 1.22e-12
HOMO (B2u) = -0.47434969959424  LUMO (Ag) = -0.104330919943528
cycle= 39 E= -75.3731251815274  delta_E= 7.11e-14  |g|= 1.17e-12  |ddm|= 8.08e-13
HOMO (B3u) = -0.474349699594255  LUMO (Ag) = -0.104330919943477
cycle= 40 E= -75.3731251815274  delta_E= -4.26e-14  |g|= 9.53e-13  |ddm|= 5.7e-13
HOMO (B2u) = -0.474349699594267  LUMO (Ag) = -0.104330919943436
cycle= 41 E= -75.3731251815275  delta_E= -1.42e-14  |g|= 7.87e-13  |ddm|= 4.01e-13
HOMO (B2u) = -0.474349699594276  LUMO (Ag) = -0.104330919943401
cycle= 42 E= -75.3731251815274  delta_E= 1.42e-14  |g|= 6.51e-13  |ddm|= 3.24e-13
HOMO (B3u) = -0.474349699594281  LUMO (Ag) = -0.104330919943371
cycle= 43 E= -75.3731251815274  delta_E= 5.68e-14  |g|= 5.4e-13  |ddm|= 3.68e-13
HOMO (B3u) = -0.474349699594283  LUMO (Ag) = -0.104330919943344
cycle= 44 E= -75.3731251815275  delta_E= -1.28e-13  |g|= 4.46e-13  |ddm|= 2.88e-13
HOMO (B3u) = -0.474349699594286  LUMO (Ag) = -0.104330919943322
cycle= 45 E= -75.3731251815274  delta_E= 7.11e-14  |g|= 3.67e-13  |ddm|= 3.31e-13
HOMO (B3u) = -0.474349699594288  LUMO (Ag) = -0.104330919943304
cycle= 46 E= -75.3731251815275  delta_E= -8.53e-14  |g|= 3.03e-13  |ddm|= 2.38e-13
HOMO (B3u) = -0.47434969959429  LUMO (Ag) = -0.104330919943289
cycle= 47 E= -75.3731251815275  delta_E= 4.26e-14  |g|= 2.52e-13  |ddm|= 1.31e-13
HOMO (B3u) = -0.474349699594292  LUMO (Ag) = -0.104330919943277
cycle= 48 E= -75.3731251815274  delta_E= 5.68e-14  |g|= 2.17e-13  |ddm|= 7.02e-14
HOMO (B3u) = -0.474349699594294  LUMO (Ag) = -0.104330919943267
cycle= 49 E= -75.3731251815275  delta_E= -4.26e-14  |g|= 1.85e-13  |ddm|= 1.58e-13
HOMO (B3u) = -0.474349699594296  LUMO (Ag) = -0.104330919943259
cycle= 50 E= -75.3731251815275  delta_E= -2.84e-14  |g|= 1.48e-13  |ddm|= 1.76e-13
SCF not converged.
SCF energy = -75.3731251815275

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp615u2hz3
max_memory 4000 MB (current use 370 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.534069226439  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5535986408657  dE = -0.019529414  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5700765822569  dE = -0.016477941  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0484  |maxRot[o]|=0.0784
macro iter 3 (6 JK  0 micro), CASSCF E = -75.579545678575  dE = -0.0094690963  S^2 = 0.0000000
               |grad[o]|=0.0899  |ddm|=0.0297  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5861247361214  dE = -0.0065790575  S^2 = 0.0000000
               |grad[o]|=0.0707  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5914072638803  dE = -0.0052825278  S^2 = 0.0000000
               |grad[o]|=0.0568  |ddm|=0.00536  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5958190891996  dE = -0.0044118253  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5994552531655  dE = -0.003636164  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6023109143985  dE = -0.0028556612  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.00296  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043454280627  dE = -0.0020345137  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.605482188268  dE = -0.0011367602  S^2 = 0.0000000
               |grad[o]|=0.012  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 11 (5 JK  0 micro), CASSCF E = -75.6057915430667  dE = -0.0003093548  S^2 = 0.0000000
               |grad[o]|=0.00551  |ddm|=0.00398  |maxRot[o]|=0.0599
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6058040753453  dE = -1.2532279e-05  S^2 = 0.0000000
               |grad[o]|=0.00133  |ddm|=0.00326  |maxRot[o]|=0.0137
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6058043185591  dE = -2.4321372e-07  S^2 = 0.0000000
               |grad[o]|=0.000278  |ddm|=0.00116  |maxRot[o]|=0.00175
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6058043249416  dE = -6.3825354e-09  S^2 = 0.0000000
               |grad[o]|=5.08e-05  |ddm|=0.000301  |maxRot[o]|=0.000267
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6058043251434  dE = -2.0180835e-10  S^2 = 0.0000000
               |grad[o]|=9.36e-06  |ddm|=6.66e-05  |maxRot[o]|=4.53e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.60580432515  dE = -6.65068e-12  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=1.38e-05  |maxRot[o]|=8.55e-06
2-step CASSCF converged in 16 macro (79 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98650073 1.55290079 1.90980644 1.90980676 0.44288817 0.09346214
 0.09346204 0.01117293]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00235   0.00241   0.00000   0.00000  -0.00166
  0 C 2s       0.58410   0.48964  -0.00000  -0.00000  -0.39544
  0 C 3s      -0.05356   0.00927  -0.00000  -0.00000  -0.02152
  0 C 2px     -0.00000   0.00000   0.00000   0.70593   0.00000
  0 C 2py      0.00000  -0.00000   0.70593  -0.00000  -0.00000
  0 C 2pz      0.38903  -0.51000   0.00000  -0.00000   0.58448
  0 C 3px     -0.00000   0.00000   0.00000  -0.02144   0.00000
  0 C 3py      0.00000  -0.00000  -0.02144  -0.00000  -0.00000
  0 C 3pz     -0.05250  -0.00695  -0.00000  -0.00000  -0.03768
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03464  -0.00000  -0.00000
  0 C 3dz^2    0.04312   0.00386  -0.00000  -0.00000   0.01086
  0 C 3dxz    -0.00000   0.00000   0.00000   0.03464   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00235  -0.00241   0.00000   0.00000  -0.00166
  1 C 2s       0.58410  -0.48964   0.00000   0.00000  -0.39544
  1 C 3s      -0.05356  -0.00927   0.00000   0.00000  -0.02152
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70593  -0.00000
  1 C 2py      0.00000   0.00000   0.70593   0.00000   0.00000
  1 C 2pz     -0.38903  -0.51000   0.00000  -0.00000  -0.58448
  1 C 3px      0.00000  -0.00000  -0.00000  -0.02144  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02144   0.00000   0.00000
  1 C 3pz      0.05250  -0.00695  -0.00000  -0.00000   0.03768
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03464  -0.00000  -0.00000
  1 C 3dz^2    0.04312  -0.00386   0.00000   0.00000   0.01086
  1 C 3dxz    -0.00000   0.00000   0.00000  -0.03464   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00084
  0 C 2s      -0.00000  -0.00000   0.50895
  0 C 3s      -0.00000  -0.00000  -0.04424
  0 C 2px      0.70611   0.00000  -0.00000
  0 C 2py      0.00000   0.70611  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.48752
  0 C 3px     -0.02900   0.00000  -0.00000
  0 C 3py      0.00000  -0.02900  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00249
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03651
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00084
  1 C 2s       0.00000   0.00000  -0.50895
  1 C 3s       0.00000   0.00000   0.04424
  1 C 2px     -0.70611  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70611   0.00000
  1 C 2pz     -0.00000   0.00000   0.48752
  1 C 3px      0.02900  -0.00000   0.00000
  1 C 3py     -0.00000   0.02900   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00249
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.03651
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99534814
<CAS-nat-orb|mo-hf>  4  4    0.99866563
<CAS-nat-orb|mo-hf>  5  5    0.99983126
<CAS-nat-orb|mo-hf>  6  6    0.99983126
<CAS-nat-orb|mo-hf>  7  7    0.98071661
<CAS-nat-orb|mo-hf>  8  8    0.91723376
<CAS-nat-orb|mo-hf>  9  9    0.91723382
<CAS-nat-orb|mo-hf>  10  10    0.43078504
<CAS-nat-orb|mo-hf>  10  17    0.57019754
<CAS-nat-orb|mo-hf>  10  20   -0.63691916
CASSCF energy = -75.60580432515
CASCI E = -75.60580432515  E(CI) = -18.1594673295269  S^2 = 0.0000000
Density matrix diagonal elements [1.98650096 1.55290249 1.90980625 1.909806   0.44288693 0.09346225
 0.09346228 0.01117284]
i = 1  <i|F|i> = -11.26829776
i = 2  <i|F|i> = -11.26410821
i = 3  <i|F|i> =  -1.04142138
i = 4  <i|F|i> =  -0.39887892
i = 5  <i|F|i> =  -0.42436508
i = 6  <i|F|i> =  -0.42436504
i = 7  <i|F|i> =  -0.12825476
i = 8  <i|F|i> =   0.31005534
i = 9  <i|F|i> =   0.31005523
i = 10  <i|F|i> =   1.18859839
i = 11  <i|F|i> =   0.58106249
i = 12  <i|F|i> =   0.63412209
i = 13  <i|F|i> =   0.63412208
i = 14  <i|F|i> =   0.74177984
i = 15  <i|F|i> =   0.70102948
i = 16  <i|F|i> =   0.70102954
i = 17  <i|F|i> =   0.55555653
i = 18  <i|F|i> =   1.23163519
i = 19  <i|F|i> =   1.23163519
i = 20  <i|F|i> =   1.16101010
i = 21  <i|F|i> =   1.45014795
i = 22  <i|F|i> =   1.45014795
i = 23  <i|F|i> =   1.68240368
i = 24  <i|F|i> =   1.68240368
i = 25  <i|F|i> =   2.08494014
i = 26  <i|F|i> =   2.17648010
i = 27  <i|F|i> =   2.17648014
i = 28  <i|F|i> =   2.53241535
......production of RDMs took       1.81 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.76 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.66 sec

E(WickSCNEVPT2-ijrs) =    -0.00037146662495
E(WickSCNEVPT2- rsi) =    -0.00111488345509
E(WickSCNEVPT2- ijr) =    -0.00046652171094
E(WickSCNEVPT2-  rs) =    -0.04008646459620
E(WickSCNEVPT2-  ij) =    -0.00016768380792
E(WickSCNEVPT2-  ir) =    -0.00138164491588
E(WickSCNEVPT2-   r) =    -0.04118943971109
E(WickSCNEVPT2-   i) =    -0.00031458517601
E(WickSCNEVPT2) = -75.69089701514812  E_corr_pt = -0.08509268999808085
Timings = pdms =   31.67 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.02 | r =    0.52 | i =    0.24
Time cost =    328.406
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:20:52 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.190648724570 AA    0.000000000000   0.000000000000   2.250000000000 Bohr   0.0

nuclear repulsion = 16
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.125]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      4342.34


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpj2lgpoco
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6287133444179

WARN: Singularity detected in overlap matrix (condition number =  749). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.287801147291401  LUMO (Ag) = -0.193295779361718
cycle= 1 E= -75.3670366286219  delta_E= 0.262  |g|= 0.19  |ddm|= 1.51
HOMO (B2u) = -0.499807889396644  LUMO (Ag) = -0.137862572577771
cycle= 2 E= -75.3797482358211  delta_E= -0.0127  |g|= 0.0519  |ddm|= 0.208
HOMO (B2u) = -0.46454022619521  LUMO (Ag) = -0.10323737569965
cycle= 3 E= -75.3805383397254  delta_E= -0.00079  |g|= 0.0104  |ddm|= 0.0716
HOMO (B2u) = -0.466699997579168  LUMO (Ag) = -0.104062742035946
cycle= 4 E= -75.3806041774367  delta_E= -6.58e-05  |g|= 0.00196  |ddm|= 0.0425
HOMO (B2u) = -0.467507612863154  LUMO (Ag) = -0.105181483870827
cycle= 5 E= -75.3806067875641  delta_E= -2.61e-06  |g|= 0.00024  |ddm|= 0.0138
HOMO (B3u) = -0.467469009904276  LUMO (Ag) = -0.105209990979466
cycle= 6 E= -75.3806068286269  delta_E= -4.11e-08  |g|= 2.47e-05  |ddm|= 0.000855
HOMO (B3u) = -0.467470595918395  LUMO (Ag) = -0.105219180794829
cycle= 7 E= -75.3806068289548  delta_E= -3.28e-10  |g|= 2.6e-06  |ddm|= 0.000264
HOMO (B3u) = -0.467470958374913  LUMO (Ag) = -0.105219406231784
cycle= 8 E= -75.3806068289574  delta_E= -2.53e-12  |g|= 1.64e-07  |ddm|= 3.35e-05
HOMO (B2u) = -0.467470973641466  LUMO (Ag) = -0.105219414001654
cycle= 9 E= -75.3806068289574  delta_E= -5.68e-14  |g|= 9.4e-09  |ddm|= 3.15e-07
HOMO (B3u) = -0.467470971056286  LUMO (Ag) = -0.105219408943475
cycle= 10 E= -75.3806068289574  delta_E= -1.42e-14  |g|= 7.59e-09  |ddm|= 1.06e-08
HOMO (B2u) = -0.467470973491017  LUMO (Ag) = -0.105219411340354
cycle= 11 E= -75.3806068289574  delta_E= 4.26e-14  |g|= 8.76e-10  |ddm|= 1.87e-08
HOMO (B2u) = -0.467470973609911  LUMO (Ag) = -0.105219411422781
cycle= 12 E= -75.3806068289575  delta_E= -7.11e-14  |g|= 6.99e-10  |ddm|= 2.49e-09
HOMO (B3u) = -0.467470973593472  LUMO (Ag) = -0.105219411395591
cycle= 13 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 5.85e-10  |ddm|= 1.31e-09
HOMO (B2u) = -0.467470973608662  LUMO (Ag) = -0.10521941140678
cycle= 14 E= -75.3806068289575  delta_E= -2.84e-14  |g|= 5.18e-10  |ddm|= 1.13e-10
HOMO (B2u) = -0.467470973617271  LUMO (Ag) = -0.105219411397953
cycle= 15 E= -75.3806068289574  delta_E= 1.42e-14  |g|= 4.55e-10  |ddm|= 4.7e-10
HOMO (B2u) = -0.467470973587045  LUMO (Ag) = -0.105219411378444
cycle= 16 E= -75.3806068289575  delta_E= -2.84e-14  |g|= 4.01e-10  |ddm|= 8.43e-10
HOMO (B2u) = -0.467470973563046  LUMO (Ag) = -0.10521941140118
cycle= 17 E= -75.3806068289574  delta_E= 8.53e-14  |g|= 5.27e-10  |ddm|= 1.02e-09
HOMO (B3u) = -0.467470973602524  LUMO (Ag) = -0.105219411391053
cycle= 18 E= -75.3806068289574  delta_E= -5.68e-14  |g|= 3.21e-10  |ddm|= 4.58e-10
HOMO (B2u) = -0.467470973565908  LUMO (Ag) = -0.105219411341513
cycle= 19 E= -75.3806068289575  delta_E= -5.68e-14  |g|= 1.11e-10  |ddm|= 7.68e-10
HOMO (B3u) = -0.467470973563244  LUMO (Ag) = -0.105219411337485
cycle= 20 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 9.49e-11  |ddm|= 3.93e-11
HOMO (B2u) = -0.467470973565395  LUMO (Ag) = -0.105219411337351
cycle= 21 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 8.01e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.46747097356565  LUMO (Ag) = -0.105219411335935
cycle= 22 E= -75.3806068289574  delta_E= 4.26e-14  |g|= 6.65e-11  |ddm|= 3.53e-11
HOMO (B3u) = -0.467470973566271  LUMO (Ag) = -0.105219411334845
cycle= 23 E= -75.3806068289575  delta_E= -1.28e-13  |g|= 5.46e-11  |ddm|= 3.54e-11
HOMO (B2u) = -0.467470973566535  LUMO (Ag) = -0.105219411334018
cycle= 24 E= -75.3806068289575  delta_E= 2.84e-14  |g|= 4.57e-11  |ddm|= 4.62e-11
HOMO (B2u) = -0.467470973566694  LUMO (Ag) = -0.105219411332908
cycle= 25 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 3.81e-11  |ddm|= 2.4e-11
HOMO (B3u) = -0.467470973568379  LUMO (Ag) = -0.105219411331749
cycle= 26 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 2.36e-11  |ddm|= 3.41e-11
HOMO (B3u) = -0.467470973570485  LUMO (Ag) = -0.10521941133261
cycle= 27 E= -75.3806068289575  delta_E= -1.14e-13  |g|= 1.74e-11  |ddm|= 2.64e-11
HOMO (B2u) = -0.467470973570332  LUMO (Ag) = -0.105219411331915
cycle= 28 E= -75.3806068289575  delta_E= 4.26e-14  |g|= 1.44e-11  |ddm|= 7.76e-12
HOMO (B2u) = -0.467470973570107  LUMO (Ag) = -0.105219411331207
cycle= 29 E= -75.3806068289574  delta_E= 1.42e-14  |g|= 1.17e-11  |ddm|= 6.9e-12
HOMO (B2u) = -0.467470973569936  LUMO (Ag) = -0.105219411330607
cycle= 30 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 9.41e-12  |ddm|= 6.75e-12
HOMO (B3u) = -0.467470973569807  LUMO (Ag) = -0.105219411330101
cycle= 31 E= -75.3806068289573  delta_E= 8.53e-14  |g|= 7.48e-12  |ddm|= 5.22e-12
HOMO (B3u) = -0.467470973569731  LUMO (Ag) = -0.105219411329702
cycle= 32 E= -75.3806068289574  delta_E= -8.53e-14  |g|= 5.91e-12  |ddm|= 3.63e-12
HOMO (B2u) = -0.467470973569719  LUMO (Ag) = -0.105219411329401
cycle= 33 E= -75.3806068289574  delta_E= 1.42e-14  |g|= 4.6e-12  |ddm|= 2.15e-12
HOMO (B3u) = -0.467470973569736  LUMO (Ag) = -0.105219411329174
cycle= 34 E= -75.3806068289574  delta_E=    0  |g|= 3.61e-12  |ddm|= 1.61e-12
HOMO (B3u) = -0.467470973569859  LUMO (Ag) = -0.105219411328676
Extra cycle  E= -75.3806068289575  delta_E= -7.11e-14  |g|= 1.25e-12  |ddm|= 6.22e-12
converged SCF energy = -75.3806068289575

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpj2lgpoco
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5432350451892  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5633378614218  dE = -0.020102816  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5798666640037  dE = -0.016528803  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0508  |maxRot[o]|=0.0765
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5891764366144  dE = -0.0093097726  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0302  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.595819658  dE = -0.0066432214  S^2 = 0.0000000
               |grad[o]|=0.0699  |ddm|=0.0111  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6011966167063  dE = -0.0053769587  S^2 = 0.0000000
               |grad[o]|=0.0557  |ddm|=0.00578  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6056569821176  dE = -0.0044603654  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00393  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6092561919872  dE = -0.0035992099  S^2 = 0.0000000
               |grad[o]|=0.034  |ddm|=0.00337  |maxRot[o]|=0.0797
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6118597708441  dE = -0.0026035789  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6135439051433  dE = -0.0016841343  S^2 = 0.0000000
               |grad[o]|=0.0171  |ddm|=0.00365  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6143871913542  dE = -0.00084328621  S^2 = 0.0000000
               |grad[o]|= 0.01  |ddm|=0.00384  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6145205407853  dE = -0.00013334943  S^2 = 0.0000000
               |grad[o]|=0.00374  |ddm|=0.00405  |maxRot[o]|= 0.04
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6145268325254  dE = -6.29174e-06  S^2 = 0.0000000
               |grad[o]|=0.000953  |ddm|=0.0023  |maxRot[o]|=0.00978
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6145269498081  dE = -1.172827e-07  S^2 = 0.0000000
               |grad[o]|=0.000186  |ddm|=0.000824  |maxRot[o]|=0.00121
macro iter 14 (3 JK  0 micro), CASSCF E = -75.614526952759  dE = -2.950884e-09  S^2 = 0.0000000
               |grad[o]|=3.32e-05  |ddm|=0.000205  |maxRot[o]|=0.000182
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6145269528459  dE = -8.6970431e-11  S^2 = 0.0000000
               |grad[o]|=6.05e-06  |ddm|=4.46e-05  |maxRot[o]|=3.08e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6145269528482  dE = -2.2595259e-12  S^2 = 0.0000000
               |grad[o]|=1.08e-06  |ddm|=9.17e-06  |maxRot[o]|=5.64e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98576842 1.56903903 1.90400116 1.90400163 0.42663284 0.0993385
 0.0993386  0.01187982]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00276   0.00252   0.00000   0.00000  -0.00155
  0 C 2s       0.58703   0.49855   0.00000   0.00000  -0.39116
  0 C 3s      -0.05216   0.00914   0.00000   0.00000  -0.01848
  0 C 2px      0.00000   0.00000  -0.00000   0.70609   0.00000
  0 C 2py     -0.00000  -0.00000   0.70609   0.00000  -0.00000
  0 C 2pz      0.38514  -0.50131   0.00000  -0.00000   0.58739
  0 C 3px      0.00000  -0.00000  -0.00000  -0.01737  -0.00000
  0 C 3py      0.00000  -0.00000  -0.01737   0.00000  -0.00000
  0 C 3pz     -0.05093  -0.00632   0.00000   0.00000  -0.03868
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03373   0.00000  -0.00000
  0 C 3dz^2    0.04175   0.00318   0.00000   0.00000   0.01107
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03373  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00276  -0.00252   0.00000   0.00000  -0.00155
  1 C 2s       0.58703  -0.49855  -0.00000  -0.00000  -0.39116
  1 C 3s      -0.05216  -0.00914  -0.00000  -0.00000  -0.01848
  1 C 2px     -0.00000   0.00000   0.00000   0.70609   0.00000
  1 C 2py     -0.00000   0.00000   0.70609  -0.00000   0.00000
  1 C 2pz     -0.38514  -0.50131   0.00000  -0.00000  -0.58739
  1 C 3px     -0.00000  -0.00000   0.00000  -0.01737   0.00000
  1 C 3py      0.00000   0.00000  -0.01737  -0.00000   0.00000
  1 C 3pz      0.05093  -0.00632   0.00000   0.00000   0.03868
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.03373   0.00000  -0.00000
  1 C 3dz^2    0.04175  -0.00318  -0.00000   0.00000   0.01107
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03373  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00080
  0 C 2s       0.00000   0.00000   0.50039
  0 C 3s      -0.00000  -0.00000  -0.04369
  0 C 2px      0.70617   0.00000  -0.00000
  0 C 2py      0.00000   0.70617   0.00000
  0 C 2pz     -0.00000  -0.00000   0.49657
  0 C 3px     -0.02753   0.00000  -0.00000
  0 C 3py      0.00000  -0.02753  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00467
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03305
  0 C 3dxz    -0.02382   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00080
  1 C 2s       0.00000   0.00000  -0.50039
  1 C 3s       0.00000   0.00000   0.04369
  1 C 2px     -0.70617  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70617   0.00000
  1 C 2pz     -0.00000   0.00000   0.49657
  1 C 3px      0.02753  -0.00000   0.00000
  1 C 3py     -0.00000   0.02753  -0.00000
  1 C 3pz     -0.00000  -0.00000   0.00467
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03305
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99511402
<CAS-nat-orb|mo-hf>  4  4    0.99863346
<CAS-nat-orb|mo-hf>  5  5    0.99981869
<CAS-nat-orb|mo-hf>  6  6    0.99981869
<CAS-nat-orb|mo-hf>  7  7    0.98014678
<CAS-nat-orb|mo-hf>  8  8    0.92376829
<CAS-nat-orb|mo-hf>  9  9    0.92376839
<CAS-nat-orb|mo-hf>  10  10    0.44416418
<CAS-nat-orb|mo-hf>  10  17    0.59838638
<CAS-nat-orb|mo-hf>  10  20   -0.60893960
CASSCF energy = -75.6145269528482
CASCI E = -75.6145269528482  E(CI) = -18.0065822075133  S^2 = 0.0000000
Density matrix diagonal elements [1.98576857 1.56904065 1.90400126 1.90400176 0.42663126 0.09933825
 0.09933854 0.01187973]
i = 1  <i|F|i> = -11.27391367
i = 2  <i|F|i> = -11.27046354
i = 3  <i|F|i> =  -1.03177040
i = 4  <i|F|i> =  -0.40700707
i = 5  <i|F|i> =  -0.41683748
i = 6  <i|F|i> =  -0.41683758
i = 7  <i|F|i> =  -0.12611617
i = 8  <i|F|i> =   0.29287785
i = 9  <i|F|i> =   0.29287766
i = 10  <i|F|i> =   1.13172458
i = 11  <i|F|i> =   0.58639535
i = 12  <i|F|i> =   0.63942453
i = 13  <i|F|i> =   0.63942452
i = 14  <i|F|i> =   0.73851489
i = 15  <i|F|i> =   0.70221860
i = 16  <i|F|i> =   0.70221870
i = 17  <i|F|i> =   0.55476185
i = 18  <i|F|i> =   1.23410007
i = 19  <i|F|i> =   1.23410007
i = 20  <i|F|i> =   1.15371323
i = 21  <i|F|i> =   1.43038414
i = 22  <i|F|i> =   1.43038415
i = 23  <i|F|i> =   1.67030643
i = 24  <i|F|i> =   1.67030643
i = 25  <i|F|i> =   2.07927179
i = 26  <i|F|i> =   2.15818594
i = 27  <i|F|i> =   2.15818596
i = 28  <i|F|i> =   2.46801470
......production of RDMs took       2.70 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.61 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickSCNEVPT2-ijrs) =    -0.00035404284274
E(WickSCNEVPT2- rsi) =    -0.00108225245083
E(WickSCNEVPT2- ijr) =    -0.00045648034235
E(WickSCNEVPT2-  rs) =    -0.03972849658329
E(WickSCNEVPT2-  ij) =    -0.00016420620910
E(WickSCNEVPT2-  ir) =    -0.00136003662287
E(WickSCNEVPT2-   r) =    -0.04192123036888
E(WickSCNEVPT2-   i) =    -0.00030833477440
E(WickSCNEVPT2) = -75.69990203304265  E_corr_pt = -0.0853750801944692
Timings = pdms =   33.46 | eris =    0.62 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.03 | ir =    0.03 | r =    0.60 | i =    0.24
Time cost =    572.965
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:30:25 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.217107585116 AA    0.000000000000   0.000000000000   2.300000000000 Bohr   0.0

nuclear repulsion = 15.6521739130435
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.15]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      4825.84


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpprwm4rbg
max_memory 4000 MB (current use 370 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.5736679955661

WARN: Singularity detected in overlap matrix (condition number =  684). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.275669226345097  LUMO (Ag) = -0.189888551192397
cycle= 1 E= -75.3709156762751  delta_E= 0.203  |g|= 0.194  |ddm|=  1.5
HOMO (B2u) = -0.494059555931339  LUMO (Ag) = -0.140557688111632
cycle= 2 E= -75.3842064529923  delta_E= -0.0133  |g|= 0.0519  |ddm|= 0.217
HOMO (B3u) = -0.458318448325724  LUMO (Ag) = -0.104627267109314
cycle= 3 E= -75.3850020490567  delta_E= -0.000796  |g|= 0.00987  |ddm|= 0.0675
HOMO (B3u) = -0.460162695295055  LUMO (Ag) = -0.104859312382325
cycle= 4 E= -75.3850609582637  delta_E= -5.89e-05  |g|= 0.00188  |ddm|= 0.038
HOMO (B3u) = -0.460946264390439  LUMO (Ag) = -0.105848218108887
cycle= 5 E= -75.3850633096871  delta_E= -2.35e-06  |g|= 0.000188  |ddm|= 0.0127
HOMO (B3u) = -0.460927636332221  LUMO (Ag) = -0.105880739343785
cycle= 6 E= -75.3850633353857  delta_E= -2.57e-08  |g|= 2.43e-05  |ddm|= 0.00106
HOMO (B2u) = -0.460929625185357  LUMO (Ag) = -0.105890953720648
cycle= 7 E= -75.3850633357242  delta_E= -3.38e-10  |g|= 2.81e-06  |ddm|= 0.000195
HOMO (B2u) = -0.46093005506614  LUMO (Ag) = -0.105891268417358
cycle= 8 E= -75.3850633357272  delta_E= -3.07e-12  |g|= 1.94e-07  |ddm|= 3.21e-05
HOMO (B3u) = -0.460930071210975  LUMO (Ag) = -0.105891273497124
cycle= 9 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 1.06e-08  |ddm|= 5.6e-07
HOMO (B2u) = -0.460930068168818  LUMO (Ag) = -0.105891267978091
cycle= 10 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 7.05e-09  |ddm|= 1.11e-08
HOMO (B2u) = -0.460930070703777  LUMO (Ag) = -0.10589127058748
cycle= 11 E= -75.3850633357272  delta_E= 5.68e-14  |g|= 9.89e-10  |ddm|= 1.89e-08
HOMO (B2u) = -0.460930070833522  LUMO (Ag) = -0.105891270667366
cycle= 12 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 7.98e-10  |ddm|= 2.19e-09
HOMO (B2u) = -0.460930070808308  LUMO (Ag) = -0.105891270626996
cycle= 13 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 6.37e-10  |ddm|= 8.52e-10
HOMO (B2u) = -0.460930070826721  LUMO (Ag) = -0.105891270646613
cycle= 14 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 6.04e-10  |ddm|= 7.31e-10
HOMO (B2u) = -0.460930070827575  LUMO (Ag) = -0.105891270639495
cycle= 15 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 5.26e-10  |ddm|= 5.36e-10
HOMO (B2u) = -0.460930070801349  LUMO (Ag) = -0.105891270620067
cycle= 16 E= -75.3850633357271  delta_E= 8.53e-14  |g|= 4.66e-10  |ddm|= 5e-10
HOMO (B2u) = -0.460930070761807  LUMO (Ag) = -0.105891270622026
cycle= 17 E= -75.3850633357272  delta_E= -7.11e-14  |g|= 5.5e-10  |ddm|= 1.22e-09
HOMO (B2u) = -0.460930070795083  LUMO (Ag) = -0.10589127060138
cycle= 18 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 3.07e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.460930070749345  LUMO (Ag) = -0.10589127054697
cycle= 19 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 1.29e-10  |ddm|= 7.19e-10
HOMO (B3u) = -0.460930070747966  LUMO (Ag) = -0.105891270543501
cycle= 20 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 1.11e-10  |ddm|= 3.45e-11
HOMO (B3u) = -0.460930070751214  LUMO (Ag) = -0.105891270544188
cycle= 21 E= -75.3850633357271  delta_E= 1.14e-13  |g|= 9.31e-11  |ddm|= 4.05e-11
HOMO (B3u) = -0.460930070752827  LUMO (Ag) = -0.105891270544099
cycle= 22 E= -75.3850633357272  delta_E= -8.53e-14  |g|= 7.89e-11  |ddm|= 2.76e-11
HOMO (B3u) = -0.460930070754225  LUMO (Ag) = -0.105891270543563
cycle= 23 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 6.42e-11  |ddm|= 3.78e-11
HOMO (B3u) = -0.4609300707553  LUMO (Ag) = -0.105891270542901
cycle= 24 E= -75.3850633357271  delta_E= 2.84e-14  |g|= 5.19e-11  |ddm|= 4.68e-11
HOMO (B3u) = -0.460930070756118  LUMO (Ag) = -0.1058912705419
cycle= 25 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 4.13e-11  |ddm|= 3.25e-11
HOMO (B3u) = -0.460930070757861  LUMO (Ag) = -0.105891270540639
cycle= 26 E= -75.3850633357273  delta_E= -8.53e-14  |g|= 2.66e-11  |ddm|= 3.19e-11
HOMO (B3u) = -0.460930070759832  LUMO (Ag) = -0.105891270541425
cycle= 27 E= -75.3850633357272  delta_E= 7.11e-14  |g|= 2.1e-11  |ddm|= 2.23e-11
HOMO (B3u) = -0.460930070759495  LUMO (Ag) = -0.105891270540478
cycle= 28 E= -75.3850633357273  delta_E= -9.95e-14  |g|= 1.74e-11  |ddm|= 8.67e-12
HOMO (B3u) = -0.460930070759118  LUMO (Ag) = -0.105891270539562
cycle= 29 E= -75.3850633357272  delta_E= 8.53e-14  |g|= 1.42e-11  |ddm|= 7.87e-12
HOMO (B3u) = -0.460930070758837  LUMO (Ag) = -0.105891270538797
cycle= 30 E= -75.3850633357273  delta_E= -5.68e-14  |g|= 1.15e-11  |ddm|= 7.57e-12
HOMO (B3u) = -0.460930070758628  LUMO (Ag) = -0.10589127053814
cycle= 31 E= -75.3850633357272  delta_E= 7.11e-14  |g|= 9.14e-12  |ddm|= 6.81e-12
HOMO (B2u) = -0.460930070758505  LUMO (Ag) = -0.10589127053762
cycle= 32 E= -75.3850633357272  delta_E= -4.26e-14  |g|= 7.21e-12  |ddm|= 5.13e-12
HOMO (B3u) = -0.460930070758464  LUMO (Ag) = -0.105891270537235
cycle= 33 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 5.68e-12  |ddm|= 3.22e-12
HOMO (B3u) = -0.460930070758475  LUMO (Ag) = -0.105891270536965
cycle= 34 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 4.56e-12  |ddm|= 1.97e-12
HOMO (B3u) = -0.460930070758486  LUMO (Ag) = -0.105891270536789
cycle= 35 E= -75.3850633357273  delta_E= -9.95e-14  |g|= 3.81e-12  |ddm|= 1.78e-12
HOMO (B3u) = -0.46093007075853  LUMO (Ag) = -0.105891270536659
cycle= 36 E= -75.3850633357273  delta_E= 7.11e-14  |g|= 3.12e-12  |ddm|= 2.34e-12
HOMO (B2u) = -0.460930070758564  LUMO (Ag) = -0.105891270536544
cycle= 37 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 2.54e-12  |ddm|= 2e-12
HOMO (B3u) = -0.460930070758587  LUMO (Ag) = -0.105891270536441
cycle= 38 E= -75.3850633357272  delta_E=    0  |g|= 2.07e-12  |ddm|= 1.68e-12
HOMO (B3u) = -0.460930070758615  LUMO (Ag) = -0.105891270536114
Extra cycle  E= -75.3850633357272  delta_E= -1.42e-14  |g|= 7.85e-13  |ddm|= 4.94e-12
converged SCF energy = -75.3850633357272

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpprwm4rbg
max_memory 4000 MB (current use 370 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5493989307648  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5700723750524  dE = -0.020673444  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.586570634069  dE = -0.016498259  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0532  |maxRot[o]|=0.0764
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5958320260301  dE = -0.009261392  S^2 = 0.0000000
               |grad[o]|=0.0881  |ddm|=0.0308  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6025808202263  dE = -0.0067487942  S^2 = 0.0000000
               |grad[o]|=0.069  |ddm|=0.0115  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6080431028909  dE = -0.0054622827  S^2 = 0.0000000
               |grad[o]|=0.0545  |ddm|=0.00631  |maxRot[o]|=0.0795
macro iter 6 (6 JK  0 micro), CASSCF E = -75.612331301463  dE = -0.0042881986  S^2 = 0.0000000
               |grad[o]|=0.0425  |ddm|=0.00445  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6155976436775  dE = -0.0032663422  S^2 = 0.0000000
               |grad[o]|=0.0324  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6179396575026  dE = -0.0023420138  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00362  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194238166356  dE = -0.0014841591  S^2 = 0.0000000
               |grad[o]|=0.016  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6201144309333  dE = -0.0006906143  S^2 = 0.0000000
               |grad[o]|=0.00899  |ddm|=0.0039  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201867175847  dE = -7.2286651e-05  S^2 = 0.0000000
               |grad[o]|=0.00281  |ddm|=0.00412  |maxRot[o]|=0.0333
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201877724459  dE = -1.0548612e-06  S^2 = 0.0000000
               |grad[o]|=0.00052  |ddm|=0.00202  |maxRot[o]|=0.00369
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201877958082  dE = -2.3362276e-08  S^2 = 0.0000000
               |grad[o]|=9.05e-05  |ddm|=0.000481  |maxRot[o]|=0.00051
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6201877964403  dE = -6.3212724e-10  S^2 = 0.0000000
               |grad[o]|=1.57e-05  |ddm|=0.000108  |maxRot[o]|=8.3e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6201877964596  dE = -1.9298341e-11  S^2 = 0.0000000
               |grad[o]|=2.92e-06  |ddm|=2.26e-05  |maxRot[o]|=1.42e-05
2-step CASSCF converged in 15 macro (76 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98500898 1.58412136 1.89795655 1.89795623 0.41151926 0.10541195
 0.10541182 0.01261384]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00317   0.00262   0.00000   0.00000  -0.00145
  0 C 2s       0.59002   0.50721   0.00000  -0.00000  -0.38673
  0 C 3s      -0.05064   0.00902   0.00000  -0.00000  -0.01545
  0 C 2px      0.00000  -0.00000  -0.00000   0.70621  -0.00000
  0 C 2py      0.00000   0.00000   0.70621  -0.00000  -0.00000
  0 C 2pz      0.38111  -0.49255   0.00000  -0.00000   0.59034
  0 C 3px      0.00000  -0.00000   0.00000  -0.01351   0.00000
  0 C 3py     -0.00000   0.00000  -0.01351   0.00000  -0.00000
  0 C 3pz     -0.04932  -0.00573   0.00000  -0.00000  -0.03961
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.03283   0.00000  -0.00000
  0 C 3dz^2    0.04041   0.00253   0.00000  -0.00000   0.01144
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03283   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00317  -0.00262   0.00000   0.00000  -0.00145
  1 C 2s       0.59002  -0.50721   0.00000   0.00000  -0.38673
  1 C 3s      -0.05064  -0.00902  -0.00000   0.00000  -0.01545
  1 C 2px     -0.00000   0.00000  -0.00000   0.70621  -0.00000
  1 C 2py      0.00000  -0.00000   0.70621  -0.00000   0.00000
  1 C 2pz     -0.38111  -0.49255   0.00000  -0.00000  -0.59034
  1 C 3px     -0.00000   0.00000   0.00000  -0.01351   0.00000
  1 C 3py     -0.00000  -0.00000  -0.01351   0.00000   0.00000
  1 C 3pz      0.04932  -0.00573   0.00000  -0.00000   0.03961
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03283  -0.00000  -0.00000
  1 C 3dz^2    0.04041  -0.00253  -0.00000   0.00000   0.01144
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03283  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00075
  0 C 2s      -0.00000   0.00000   0.49173
  0 C 3s      -0.00000   0.00000  -0.04330
  0 C 2px      0.70622  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70622   0.00000
  0 C 2pz     -0.00000  -0.00000   0.50534
  0 C 3px     -0.02618  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.02618   0.00000
  0 C 3pz     -0.00000   0.00000   0.00676
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02379   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.03024
  0 C 3dxz    -0.02379  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00075
  1 C 2s       0.00000  -0.00000  -0.49173
  1 C 3s       0.00000  -0.00000   0.04330
  1 C 2px     -0.70622   0.00000   0.00000
  1 C 2py      0.00000  -0.70622   0.00000
  1 C 2pz     -0.00000   0.00000   0.50534
  1 C 3px      0.02618   0.00000   0.00000
  1 C 3py      0.00000   0.02618  -0.00000
  1 C 3pz     -0.00000   0.00000   0.00676
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02379   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03024
  1 C 3dxz    -0.02379  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99486434
<CAS-nat-orb|mo-hf>  4  4    0.99859054
<CAS-nat-orb|mo-hf>  5  5    0.99980387
<CAS-nat-orb|mo-hf>  6  6    0.99980387
<CAS-nat-orb|mo-hf>  7  7    0.97957781
<CAS-nat-orb|mo-hf>  8  8    0.92972112
<CAS-nat-orb|mo-hf>  9  9    0.92972102
<CAS-nat-orb|mo-hf>  10  10    0.45886323
<CAS-nat-orb|mo-hf>  10  17    0.62354822
<CAS-nat-orb|mo-hf>  10  20   -0.57985787
CASSCF energy = -75.6201877964596
CASCI E = -75.6201877964596  E(CI) = -17.8576549918659  S^2 = 0.0000000
Density matrix diagonal elements [1.98500912 1.58412023 1.89795568 1.89795611 0.41152086 0.10541209
 0.10541213 0.01261377]
i = 1  <i|F|i> = -11.27955932
i = 2  <i|F|i> = -11.27671236
i = 3  <i|F|i> =  -1.02194624
i = 4  <i|F|i> =  -0.41490334
i = 5  <i|F|i> =  -0.40957669
i = 6  <i|F|i> =  -0.40957677
i = 7  <i|F|i> =  -0.12400809
i = 8  <i|F|i> =   0.27645803
i = 9  <i|F|i> =   0.27645817
i = 10  <i|F|i> =   1.07702891
i = 11  <i|F|i> =   0.59175606
i = 12  <i|F|i> =   0.64447250
i = 13  <i|F|i> =   0.64447250
i = 14  <i|F|i> =   0.73557137
i = 15  <i|F|i> =   0.70323612
i = 16  <i|F|i> =   0.70323601
i = 17  <i|F|i> =   0.55421759
i = 18  <i|F|i> =   1.23682174
i = 19  <i|F|i> =   1.23682174
i = 20  <i|F|i> =   1.14663410
i = 21  <i|F|i> =   1.41126534
i = 22  <i|F|i> =   1.41126534
i = 23  <i|F|i> =   1.65850146
i = 24  <i|F|i> =   1.65850146
i = 25  <i|F|i> =   2.07189617
i = 26  <i|F|i> =   2.14063008
i = 27  <i|F|i> =   2.14063005
i = 28  <i|F|i> =   2.41218823
......production of RDMs took       1.84 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.09 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.59 sec

E(WickSCNEVPT2-ijrs) =    -0.00033952433189
E(WickSCNEVPT2- rsi) =    -0.00105300145255
E(WickSCNEVPT2- ijr) =    -0.00044740148378
E(WickSCNEVPT2-  rs) =    -0.03935162615542
E(WickSCNEVPT2-  ij) =    -0.00016017107614
E(WickSCNEVPT2-  ir) =    -0.00133921072691
E(WickSCNEVPT2-   r) =    -0.04266231559486
E(WickSCNEVPT2-   i) =    -0.00030214731699
E(WickSCNEVPT2) = -75.70584319459812  E_corr_pt = -0.08565539813853446
Timings = pdms =   31.95 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.53 | i =    0.24
Time cost =    281.289
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:35:07 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.243566445662 AA    0.000000000000   0.000000000000   2.350000000000 Bohr   0.0

nuclear repulsion = 15.3191489361702
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.175]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5443.87


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmptl3553dz
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.520080440469

WARN: Singularity detected in overlap matrix (condition number =  625). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.264198750943281  LUMO (Ag) = -0.186664127921807
cycle= 1 E= -75.372158499346  delta_E= 0.148  |g|= 0.198  |ddm|= 1.49
HOMO (B2u) = -0.488497893717002  LUMO (Ag) = -0.142939777698249
cycle= 2 E= -75.3860697595072  delta_E= -0.0139  |g|= 0.052  |ddm|= 0.225
HOMO (B2u) = -0.452348284546128  LUMO (Ag) = -0.105756871897142
cycle= 3 E= -75.3868762726881  delta_E= -0.000807  |g|= 0.00951  |ddm|= 0.0641
HOMO (B3u) = -0.453936921014671  LUMO (Ag) = -0.105452022681082
cycle= 4 E= -75.3869305550891  delta_E= -5.43e-05  |g|= 0.00182  |ddm|= 0.034
HOMO (B2u) = -0.454699670412098  LUMO (Ag) = -0.106320748353529
cycle= 5 E= -75.3869327103432  delta_E= -2.16e-06  |g|= 0.00013  |ddm|= 0.0115
HOMO (B3u) = -0.45469219726859  LUMO (Ag) = -0.10634268067935
cycle= 6 E= -75.3869327222536  delta_E= -1.19e-08  |g|= 2.27e-05  |ddm|= 0.00104
HOMO (B3u) = -0.454694399587799  LUMO (Ag) = -0.106353370939748
cycle= 7 E= -75.3869327225933  delta_E= -3.4e-10  |g|= 3.04e-06  |ddm|= 8.49e-05
HOMO (B2u) = -0.454694907644844  LUMO (Ag) = -0.106353839610057
cycle= 8 E= -75.3869327225971  delta_E= -3.72e-12  |g|= 2.27e-07  |ddm|= 2.93e-05
HOMO (B3u) = -0.454694923997877  LUMO (Ag) = -0.106353843315754
cycle= 9 E= -75.386932722597  delta_E= 2.84e-14  |g|= 1.18e-08  |ddm|= 9.54e-07
HOMO (B3u) = -0.454694921256979  LUMO (Ag) = -0.106353838492462
cycle= 10 E= -75.386932722597  delta_E= 2.84e-14  |g|= 6.12e-09  |ddm|= 1.64e-08
HOMO (B3u) = -0.454694923057559  LUMO (Ag) = -0.106353840261734
cycle= 11 E= -75.386932722597  delta_E= -1.42e-14  |g|= 1.14e-09  |ddm|= 1.29e-08
HOMO (B3u) = -0.45469492318324  LUMO (Ag) = -0.10635384032924
cycle= 12 E= -75.386932722597  delta_E= 4.26e-14  |g|= 9.02e-10  |ddm|= 1.35e-09
HOMO (B2u) = -0.454694923150089  LUMO (Ag) = -0.10635384028127
cycle= 13 E= -75.386932722597  delta_E= -2.84e-14  |g|= 7.28e-10  |ddm|= 6.43e-10
HOMO (B2u) = -0.454694923168165  LUMO (Ag) = -0.106353840291051
cycle= 14 E= -75.386932722597  delta_E= -4.26e-14  |g|= 7e-10  |ddm|= 1.33e-09
HOMO (B2u) = -0.454694923166976  LUMO (Ag) = -0.106353840308967
cycle= 15 E= -75.386932722597  delta_E= 1.42e-14  |g|= 6.18e-10  |ddm|= 9.49e-10
HOMO (B2u) = -0.454694923134613  LUMO (Ag) = -0.106353840280587
cycle= 16 E= -75.3869327225971  delta_E= -5.68e-14  |g|= 5.54e-10  |ddm|= 5.94e-10
HOMO (B2u) = -0.454694923091208  LUMO (Ag) = -0.106353840262924
cycle= 17 E= -75.386932722597  delta_E= 5.68e-14  |g|= 5.81e-10  |ddm|= 1.26e-09
HOMO (B2u) = -0.454694923115622  LUMO (Ag) = -0.106353840230338
cycle= 18 E= -75.386932722597  delta_E= 2.84e-14  |g|= 2.92e-10  |ddm|= 6.61e-10
HOMO (B2u) = -0.454694923074754  LUMO (Ag) = -0.106353840179586
cycle= 19 E= -75.386932722597  delta_E= 2.84e-14  |g|= 1.55e-10  |ddm|= 4.73e-10
HOMO (B2u) = -0.45469492307502  LUMO (Ag) = -0.106353840176968
cycle= 20 E= -75.386932722597  delta_E= -5.68e-14  |g|= 1.33e-10  |ddm|= 4.28e-11
HOMO (B2u) = -0.454694923079041  LUMO (Ag) = -0.106353840178215
cycle= 21 E= -75.386932722597  delta_E= 1.42e-14  |g|= 1.14e-10  |ddm|= 5.07e-11
HOMO (B3u) = -0.454694923081408  LUMO (Ag) = -0.106353840178729
cycle= 22 E= -75.3869327225969  delta_E= 7.11e-14  |g|= 9.78e-11  |ddm|= 3.69e-11
HOMO (B3u) = -0.454694923082712  LUMO (Ag) = -0.106353840178409
cycle= 23 E= -75.386932722597  delta_E= -8.53e-14  |g|= 8.07e-11  |ddm|= 4.18e-11
HOMO (B3u) = -0.45469492308417  LUMO (Ag) = -0.106353840177047
cycle= 24 E= -75.386932722597  delta_E= 2.84e-14  |g|= 6.39e-11  |ddm|= 5.85e-11
HOMO (B3u) = -0.454694923085173  LUMO (Ag) = -0.10635384017524
cycle= 25 E= -75.386932722597  delta_E= -2.84e-14  |g|= 4.88e-11  |ddm|= 4.31e-11
HOMO (B3u) = -0.454694923086553  LUMO (Ag) = -0.106353840173301
cycle= 26 E= -75.386932722597  delta_E= 7.11e-14  |g|= 3.34e-11  |ddm|= 2.74e-11
HOMO (B3u) = -0.454694923087924  LUMO (Ag) = -0.106353840173333
cycle= 27 E= -75.386932722597  delta_E= -5.68e-14  |g|= 2.71e-11  |ddm|= 1.35e-11
HOMO (B3u) = -0.454694923087506  LUMO (Ag) = -0.106353840172159
cycle= 28 E= -75.3869327225971  delta_E= -4.26e-14  |g|= 2.28e-11  |ddm|= 1.03e-11
HOMO (B3u) = -0.454694923087077  LUMO (Ag) = -0.106353840171053
cycle= 29 E= -75.386932722597  delta_E= 4.26e-14  |g|= 1.89e-11  |ddm|= 1e-11
HOMO (B3u) = -0.454694923086766  LUMO (Ag) = -0.106353840170117
cycle= 30 E= -75.386932722597  delta_E= 4.26e-14  |g|= 1.55e-11  |ddm|= 9.84e-12
HOMO (B3u) = -0.454694923086539  LUMO (Ag) = -0.106353840169292
cycle= 31 E= -75.3869327225971  delta_E= -9.95e-14  |g|= 1.25e-11  |ddm|= 9.63e-12
HOMO (B3u) = -0.454694923086414  LUMO (Ag) = -0.106353840168596
cycle= 32 E= -75.3869327225971  delta_E= -2.84e-14  |g|= 9.87e-12  |ddm|= 7.97e-12
HOMO (B2u) = -0.454694923086376  LUMO (Ag) = -0.106353840168082
cycle= 33 E= -75.386932722597  delta_E= 7.11e-14  |g|= 7.85e-12  |ddm|= 5.5e-12
HOMO (B2u) = -0.45469492308639  LUMO (Ag) = -0.106353840167725
cycle= 34 E= -75.386932722597  delta_E= 5.68e-14  |g|= 6.4e-12  |ddm|= 3.69e-12
HOMO (B2u) = -0.454694923086405  LUMO (Ag) = -0.106353840167482
cycle= 35 E= -75.3869327225971  delta_E= -9.95e-14  |g|= 5.36e-12  |ddm|= 3.19e-12
HOMO (B2u) = -0.454694923086448  LUMO (Ag) = -0.106353840167294
cycle= 36 E= -75.3869327225971  delta_E= 1.42e-14  |g|= 4.44e-12  |ddm|= 3.23e-12
HOMO (B2u) = -0.454694923086478  LUMO (Ag) = -0.106353840167125
cycle= 37 E= -75.386932722597  delta_E= 4.26e-14  |g|= 3.66e-12  |ddm|= 2.83e-12
HOMO (B3u) = -0.454694923086496  LUMO (Ag) = -0.106353840166974
cycle= 38 E= -75.3869327225971  delta_E= -4.26e-14  |g|= 3e-12  |ddm|= 2.44e-12
HOMO (B2u) = -0.454694923086508  LUMO (Ag) = -0.10635384016684
cycle= 39 E= -75.386932722597  delta_E= 4.26e-14  |g|= 2.46e-12  |ddm|= 2.03e-12
HOMO (B2u) = -0.454694923086514  LUMO (Ag) = -0.106353840166727
cycle= 40 E= -75.3869327225971  delta_E= -5.68e-14  |g|= 2.02e-12  |ddm|= 1.57e-12
HOMO (B2u) = -0.454694923086518  LUMO (Ag) = -0.106353840166633
cycle= 41 E= -75.3869327225971  delta_E= -1.42e-14  |g|= 1.67e-12  |ddm|= 1.26e-12
HOMO (B2u) = -0.454694923086518  LUMO (Ag) = -0.106353840166556
cycle= 42 E= -75.3869327225971  delta_E= -1.42e-14  |g|= 1.39e-12  |ddm|= 1.03e-12
HOMO (B2u) = -0.454694923086518  LUMO (Ag) = -0.106353840166492
cycle= 43 E= -75.3869327225971  delta_E=    0  |g|= 1.16e-12  |ddm|= 8.19e-13
HOMO (B3u) = -0.454694923086525  LUMO (Ag) = -0.106353840166301
Extra cycle  E= -75.386932722597  delta_E= 1.28e-13  |g|= 4.68e-13  |ddm|= 2.48e-12
converged SCF energy = -75.386932722597

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmptl3553dz
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5529956225484  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5742379004911  dE = -0.021242278  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5907013338564  dE = -0.016463433  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0556  |maxRot[o]|=0.078
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5999891087202  dE = -0.0092877749  S^2 = 0.0000000
               |grad[o]|=0.0873  |ddm|=0.0313  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066426342087  dE = -0.0066535255  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.012  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6117776285509  dE = -0.0051349943  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.00672  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6158213926925  dE = -0.0040437641  S^2 = 0.0000000
               |grad[o]|=0.042  |ddm|=0.00468  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6189156562425  dE = -0.0030942636  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00394  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6211353675478  dE = -0.0022197113  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00375  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6225338703794  dE = -0.0013985028  S^2 = 0.0000000
               |grad[o]|=0.0158  |ddm|=0.0038  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6231660457141  dE = -0.00063217533  S^2 = 0.0000000
               |grad[o]|=0.00875  |ddm|=0.00396  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6232125140774  dE = -4.6468363e-05  S^2 = 0.0000000
               |grad[o]|=0.00249  |ddm|=0.00421  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6232205425115  dE = -8.0284341e-06  S^2 = 0.0000000
               |grad[o]|=0.00104  |ddm|=0.00126  |maxRot[o]|=0.0112
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6232206703334  dE = -1.2782198e-07  S^2 = 0.0000000
               |grad[o]|=0.000189  |ddm|=0.000799  |maxRot[o]|=0.00125
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6232206732061  dE = -2.8726248e-09  S^2 = 0.0000000
               |grad[o]|=3.19e-05  |ddm|=0.00018  |maxRot[o]|=0.000176
macro iter 15 (3 JK  0 micro), CASSCF E = -75.623220673284  dE = -7.7889695e-11  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=3.89e-05  |maxRot[o]|=2.9e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6232206732861  dE = -2.1600499e-12  S^2 = 0.0000000
               |grad[o]|=9.71e-07  |ddm|=7.82e-06  |maxRot[o]|=5.02e-06
2-step CASSCF converged in 16 macro (77 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98422464 1.59821723 1.89166128 1.89166097 0.39749232 0.1116852
 0.11168503 0.01337334]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00356   0.00273   0.00000   0.00000  -0.00136
  0 C 2s       0.59304   0.51564   0.00000   0.00000  -0.38216
  0 C 3s      -0.04903   0.00893   0.00000   0.00000  -0.01244
  0 C 2px      0.00000   0.00000  -0.00000   0.70632  -0.00000
  0 C 2py      0.00000  -0.00000   0.70632   0.00000  -0.00000
  0 C 2pz      0.37694  -0.48373   0.00000   0.00000   0.59331
  0 C 3px      0.00000   0.00000  -0.00000  -0.00987  -0.00000
  0 C 3py      0.00000  -0.00000  -0.00987  -0.00000   0.00000
  0 C 3pz     -0.04768  -0.00519   0.00000   0.00000  -0.04045
  0 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03194  -0.00000   0.00000
  0 C 3dz^2    0.03910   0.00193   0.00000   0.00000   0.01197
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03194  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00356  -0.00273   0.00000   0.00000  -0.00136
  1 C 2s       0.59304  -0.51564   0.00000   0.00000  -0.38216
  1 C 3s      -0.04903  -0.00893  -0.00000  -0.00000  -0.01244
  1 C 2px     -0.00000  -0.00000   0.00000   0.70632   0.00000
  1 C 2py     -0.00000   0.00000   0.70632   0.00000  -0.00000
  1 C 2pz     -0.37694  -0.48373   0.00000  -0.00000  -0.59331
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00987   0.00000
  1 C 3py     -0.00000   0.00000  -0.00987   0.00000  -0.00000
  1 C 3pz      0.04768  -0.00519   0.00000   0.00000   0.04045
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03194  -0.00000   0.00000
  1 C 3dz^2    0.03910  -0.00193  -0.00000  -0.00000   0.01197
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03194  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00071
  0 C 2s       0.00000   0.00000   0.48298
  0 C 3s       0.00000   0.00000  -0.04305
  0 C 2px      0.70627   0.00000  -0.00000
  0 C 2py     -0.00000   0.70627   0.00000
  0 C 2pz      0.00000   0.00000   0.51383
  0 C 3px     -0.02494   0.00000  -0.00000
  0 C 3py      0.00000  -0.02494   0.00000
  0 C 3pz     -0.00000   0.00000   0.00873
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02373   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02798
  0 C 3dxz    -0.02373   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00071
  1 C 2s       0.00000  -0.00000  -0.48298
  1 C 3s      -0.00000  -0.00000   0.04305
  1 C 2px     -0.70627  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70627  -0.00000
  1 C 2pz     -0.00000   0.00000   0.51383
  1 C 3px      0.02494  -0.00000   0.00000
  1 C 3py     -0.00000   0.02494  -0.00000
  1 C 3pz      0.00000   0.00000   0.00873
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02373   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02798
  1 C 3dxz    -0.02373   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99460039
<CAS-nat-orb|mo-hf>  4  4    0.99853697
<CAS-nat-orb|mo-hf>  5  5    0.99978677
<CAS-nat-orb|mo-hf>  6  6    0.99978677
<CAS-nat-orb|mo-hf>  7  7    0.97901221
<CAS-nat-orb|mo-hf>  8  8    0.93514186
<CAS-nat-orb|mo-hf>  9  9    0.93514178
<CAS-nat-orb|mo-hf>  10  10    0.47490967
<CAS-nat-orb|mo-hf>  10  17    0.64513932
<CAS-nat-orb|mo-hf>  10  20   -0.55018486
CASSCF energy = -75.6232206732861
CASCI E = -75.6232206732861  E(CI) = -17.7126744337431  S^2 = 0.0000000
Density matrix diagonal elements [1.98422465 1.59821654 1.89166133 1.89166107 0.39749311 0.11168507
 0.11168491 0.01337332]
i = 1  <i|F|i> = -11.28516790
i = 2  <i|F|i> = -11.28281589
i = 3  <i|F|i> =  -1.01201826
i = 4  <i|F|i> =  -0.42258436
i = 5  <i|F|i> =  -0.40255934
i = 6  <i|F|i> =  -0.40255929
i = 7  <i|F|i> =  -0.12192533
i = 8  <i|F|i> =   0.26075300
i = 9  <i|F|i> =   0.26075314
i = 10  <i|F|i> =   1.02462410
i = 11  <i|F|i> =   0.59710973
i = 12  <i|F|i> =   0.64926505
i = 13  <i|F|i> =   0.64926504
i = 14  <i|F|i> =   0.73297099
i = 15  <i|F|i> =   0.70410762
i = 16  <i|F|i> =   0.70410753
i = 17  <i|F|i> =   0.55392095
i = 18  <i|F|i> =   1.23978823
i = 19  <i|F|i> =   1.23978823
i = 20  <i|F|i> =   1.13975723
i = 21  <i|F|i> =   1.39282136
i = 22  <i|F|i> =   1.39282135
i = 23  <i|F|i> =   1.64699224
i = 24  <i|F|i> =   1.64699224
i = 25  <i|F|i> =   2.06263426
i = 26  <i|F|i> =   2.12361937
i = 27  <i|F|i> =   2.12361936
i = 28  <i|F|i> =   2.36380663
......production of RDMs took       1.81 sec
......reading the RDM took          0.45 sec
......production of RDMs took      18.46 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.67 sec

E(WickSCNEVPT2-ijrs) =    -0.00032744852268
E(WickSCNEVPT2- rsi) =    -0.00102680537250
E(WickSCNEVPT2- ijr) =    -0.00043908131963
E(WickSCNEVPT2-  rs) =    -0.03895860606016
E(WickSCNEVPT2-  ij) =    -0.00015569407280
E(WickSCNEVPT2-  ir) =    -0.00131911777895
E(WickSCNEVPT2-   r) =    -0.04341226268243
E(WickSCNEVPT2-   i) =    -0.00029602507070
E(WickSCNEVPT2) = -75.70915571416597  E_corr_pt = -0.08593504087985679
Timings = pdms =   30.40 | eris =    0.04 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.03 | ir =    0.02 | r =    0.52 | i =    0.24
Time cost =    196.073
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:38:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.270025306208 AA    0.000000000000   0.000000000000   2.400000000000 Bohr   0.0

nuclear repulsion = 15
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.2]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5546.80


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpz_8pkrz_
max_memory 4000 MB (current use 370 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4681036266052

WARN: Singularity detected in overlap matrix (condition number =  573). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.253350702957072  LUMO (Ag) = -0.183612207324934
cycle= 1 E= -75.3711621684052  delta_E= 0.0969  |g|= 0.203  |ddm|= 1.48
HOMO (B3u) = -0.483102395155574  LUMO (Ag) = -0.145014054403866
cycle= 2 E= -75.3857253013105  delta_E= -0.0146  |g|= 0.052  |ddm|= 0.234
HOMO (B3u) = -0.446604227160942  LUMO (Ag) = -0.106629940030311
cycle= 3 E= -75.3865468682809  delta_E= -0.000822  |g|= 0.00932  |ddm|= 0.0615
HOMO (B2u) = -0.44799076917457  LUMO (Ag) = -0.105837943292174
cycle= 4 E= -75.3865987559146  delta_E= -5.19e-05  |g|= 0.00179  |ddm|= 0.0304
HOMO (B3u) = -0.448742110750614  LUMO (Ag) = -0.106605000995199
cycle= 5 E= -75.3866008121181  delta_E= -2.06e-06  |g|= 7.74e-05  |ddm|= 0.0104
HOMO (B3u) = -0.448735377102866  LUMO (Ag) = -0.106607023368656
cycle= 6 E= -75.3866008154599  delta_E= -3.34e-09  |g|= 1.47e-05  |ddm|= 0.000795
HOMO (B3u) = -0.448736161720348  LUMO (Ag) = -0.106613403607881
cycle= 7 E= -75.3866008156198  delta_E= -1.6e-10  |g|= 2.92e-06  |ddm|= 4.96e-05
HOMO (B2u) = -0.448736721595923  LUMO (Ag) = -0.106614233435093
cycle= 8 E= -75.3866008156237  delta_E= -3.89e-12  |g|= 2.59e-07  |ddm|= 1.95e-05
HOMO (B2u) = -0.448736741737501  LUMO (Ag) = -0.10661425211874
cycle= 9 E= -75.3866008156238  delta_E= -9.95e-14  |g|= 1.3e-08  |ddm|= 1.45e-06
HOMO (B2u) = -0.4487367407522  LUMO (Ag) = -0.106614250133625
cycle= 10 E= -75.3866008156237  delta_E= 5.68e-14  |g|= 5.8e-09  |ddm|= 2.11e-08
HOMO (B3u) = -0.448736740317605  LUMO (Ag) = -0.106614249150481
cycle= 11 E= -75.3866008156237  delta_E=    0  |g|= 1.23e-09  |ddm|= 1.26e-08
HOMO (B3u) = -0.448736740435236  LUMO (Ag) = -0.106614249218721
cycle= 12 E= -75.3866008156238  delta_E= -9.95e-14  |g|= 9.84e-10  |ddm|= 1.21e-09
HOMO (B3u) = -0.448736740408791  LUMO (Ag) = -0.106614249167441
cycle= 13 E= -75.3866008156238  delta_E= 8.53e-14  |g|= 7.59e-10  |ddm|= 9.9e-10
HOMO (B3u) = -0.448736740433525  LUMO (Ag) = -0.106614249170649
cycle= 14 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 7.64e-10  |ddm|= 1.68e-09
HOMO (B3u) = -0.448736740438231  LUMO (Ag) = -0.10661424922013
cycle= 15 E= -75.3866008156238  delta_E= 5.68e-14  |g|= 6.89e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.44873674036066  LUMO (Ag) = -0.106614249172325
cycle= 16 E= -75.3866008156238  delta_E= -4.26e-14  |g|= 6.75e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.448736740336883  LUMO (Ag) = -0.106614249142246
cycle= 17 E= -75.3866008156238  delta_E= -4.26e-14  |g|= 6.33e-10  |ddm|= 1.07e-09
HOMO (B3u) = -0.448736740348262  LUMO (Ag) = -0.106614249099132
cycle= 18 E= -75.3866008156238  delta_E= 7.11e-14  |g|= 3.12e-10  |ddm|= 8.02e-10
HOMO (B3u) = -0.448736740350246  LUMO (Ag) = -0.106614249078724
cycle= 19 E= -75.3866008156238  delta_E= -4.26e-14  |g|= 1.76e-10  |ddm|= 3.34e-10
HOMO (B3u) = -0.448736740350359  LUMO (Ag) = -0.106614249075887
cycle= 20 E= -75.3866008156238  delta_E= 2.84e-14  |g|= 1.52e-10  |ddm|= 5.36e-11
HOMO (B3u) = -0.448736740353997  LUMO (Ag) = -0.10661424907679
cycle= 21 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 1.31e-10  |ddm|= 6.33e-11
HOMO (B3u) = -0.44873674035607  LUMO (Ag) = -0.106614249077182
cycle= 22 E= -75.3866008156237  delta_E= 7.11e-14  |g|= 1.16e-10  |ddm|= 4.15e-11
HOMO (B3u) = -0.448736740356342  LUMO (Ag) = -0.106614249076702
cycle= 23 E= -75.3866008156238  delta_E= -1.42e-14  |g|= 9.83e-11  |ddm|= 4.69e-11
HOMO (B3u) = -0.448736740357515  LUMO (Ag) = -0.10661424907478
cycle= 24 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 7.93e-11  |ddm|= 6.69e-11
HOMO (B3u) = -0.448736740357544  LUMO (Ag) = -0.106614249070615
cycle= 25 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 5.89e-11  |ddm|= 4.87e-11
HOMO (B3u) = -0.448736740357775  LUMO (Ag) = -0.106614249067295
cycle= 26 E= -75.3866008156238  delta_E= 1.42e-14  |g|= 4.15e-11  |ddm|= 2.92e-11
HOMO (B3u) = -0.448736740357713  LUMO (Ag) = -0.106614249065555
cycle= 27 E= -75.3866008156238  delta_E=    0  |g|= 3.3e-11  |ddm|= 1.52e-11
HOMO (B3u) = -0.448736740356839  LUMO (Ag) = -0.106614249060424
Extra cycle  E= -75.3866008156238  delta_E= 1.42e-14  |g|= 1.16e-11  |ddm|= 5.72e-11
converged SCF energy = -75.3866008156238

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpz_8pkrz_
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5544099472179  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5762198089564  dE = -0.021809862  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5926046135297  dE = -0.016384805  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0582  |maxRot[o]|=0.0788
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6014950261373  dE = -0.0088904126  S^2 = 0.0000000
               |grad[o]|=0.0866  |ddm|=0.0318  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6078328304639  dE = -0.0063378043  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.0122  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6127996764019  dE = -0.0049668459  S^2 = 0.0000000
               |grad[o]|=0.054  |ddm|=0.00702  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6167369301358  dE = -0.0039372537  S^2 = 0.0000000
               |grad[o]|=0.0426  |ddm|=0.00503  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6197643675748  dE = -0.0030274374  S^2 = 0.0000000
               |grad[o]|=0.0328  |ddm|=0.0042  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6219453401504  dE = -0.0021809726  S^2 = 0.0000000
               |grad[o]|=0.0241  |ddm|=0.0039  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6233253053496  dE = -0.0013799652  S^2 = 0.0000000
               |grad[o]|=0.0162  |ddm|=0.00389  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6239527365466  dE = -0.0006274312  S^2 = 0.0000000
               |grad[o]|=0.00898  |ddm|=0.00404  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6239994403116  dE = -4.6703765e-05  S^2 = 0.0000000
               |grad[o]|=0.00254  |ddm|=0.00433  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6240076588572  dE = -8.2185456e-06  S^2 = 0.0000000
               |grad[o]|=0.00105  |ddm|=0.00126  |maxRot[o]|=0.0113
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6240077853573  dE = -1.265001e-07  S^2 = 0.0000000
               |grad[o]|=0.000189  |ddm|=0.000798  |maxRot[o]|=0.00123
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6240077881096  dE = -2.7523015e-09  S^2 = 0.0000000
               |grad[o]|=3.14e-05  |ddm|=0.000172  |maxRot[o]|=0.00017
macro iter 15 (3 JK  0 micro), CASSCF E = -75.62400778818  dE = -7.0428996e-11  S^2 = 0.0000000
               |grad[o]|=5.07e-06  |ddm|=3.62e-05  |maxRot[o]|=2.77e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6240077881817  dE = -1.7195134e-12  S^2 = 0.0000000
               |grad[o]|=9.39e-07  |ddm|=7.18e-06  |maxRot[o]|=4.69e-06
2-step CASSCF converged in 16 macro (77 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98341796 1.61142014 1.88510523 1.88510467 0.38447467 0.11816041
 0.11816044 0.01415649]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00394   0.00282   0.00000   0.00000  -0.00128
  0 C 2s       0.59610   0.52384   0.00000  -0.00000  -0.37748
  0 C 3s      -0.04733   0.00887   0.00000  -0.00000  -0.00946
  0 C 2px      0.00000  -0.00000  -0.00000   0.70639  -0.00000
  0 C 2py     -0.00000   0.00000   0.70639  -0.00000  -0.00000
  0 C 2pz      0.37264  -0.47485  -0.00000  -0.00000   0.59629
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00643  -0.00000
  0 C 3py     -0.00000   0.00000  -0.00643  -0.00000  -0.00000
  0 C 3pz     -0.04603  -0.00469   0.00000  -0.00000  -0.04119
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.03106  -0.00000  -0.00000
  0 C 3dz^2    0.03783   0.00135   0.00000  -0.00000   0.01265
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03106  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00394  -0.00282   0.00000   0.00000  -0.00128
  1 C 2s       0.59610  -0.52384  -0.00000   0.00000  -0.37748
  1 C 3s      -0.04733  -0.00887  -0.00000   0.00000  -0.00946
  1 C 2px      0.00000   0.00000   0.00000   0.70639   0.00000
  1 C 2py      0.00000  -0.00000   0.70639   0.00000   0.00000
  1 C 2pz     -0.37264  -0.47485  -0.00000  -0.00000  -0.59629
  1 C 3px     -0.00000   0.00000   0.00000  -0.00643   0.00000
  1 C 3py      0.00000  -0.00000  -0.00643   0.00000   0.00000
  1 C 3pz      0.04603  -0.00469   0.00000  -0.00000   0.04119
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.03106  -0.00000  -0.00000
  1 C 3dz^2    0.03783  -0.00135  -0.00000   0.00000   0.01265
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03106  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00067
  0 C 2s       0.00000   0.00000   0.47414
  0 C 3s      -0.00000   0.00000  -0.04292
  0 C 2px      0.70631  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70631  -0.00000
  0 C 2pz      0.00000  -0.00000   0.52207
  0 C 3px     -0.02380   0.00000   0.00000
  0 C 3py      0.00000  -0.02380  -0.00000
  0 C 3pz     -0.00000   0.00000   0.01059
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02366   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02618
  0 C 3dxz    -0.02366   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00067
  1 C 2s       0.00000  -0.00000  -0.47414
  1 C 3s       0.00000  -0.00000   0.04292
  1 C 2px     -0.70631  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70631   0.00000
  1 C 2pz     -0.00000  -0.00000   0.52207
  1 C 3px      0.02380   0.00000   0.00000
  1 C 3py      0.00000   0.02380   0.00000
  1 C 3pz     -0.00000   0.00000   0.01059
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02366  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02618
  1 C 3dxz    -0.02366  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99432403
<CAS-nat-orb|mo-hf>  4  4    0.99847304
<CAS-nat-orb|mo-hf>  5  5    0.99976738
<CAS-nat-orb|mo-hf>  6  6    0.99976738
<CAS-nat-orb|mo-hf>  7  7    0.97845223
<CAS-nat-orb|mo-hf>  8  8    0.94007729
<CAS-nat-orb|mo-hf>  9  9    0.94007723
<CAS-nat-orb|mo-hf>  10  10    0.49233326
<CAS-nat-orb|mo-hf>  10  17    0.66275081
<CAS-nat-orb|mo-hf>  10  20   -0.52046340
CASSCF energy = -75.6240077881817
CASCI E = -75.6240077881817  E(CI) = -17.5716139906847  S^2 = 0.0000000
Density matrix diagonal elements [1.98341798 1.61141905 1.88510527 1.88510464 0.38447581 0.11816055
 0.11816022 0.01415649]
i = 1  <i|F|i> = -11.29068477
i = 2  <i|F|i> = -11.28874160
i = 3  <i|F|i> =  -1.00204732
i = 4  <i|F|i> =  -0.43006888
i = 5  <i|F|i> =  -0.39576359
i = 6  <i|F|i> =  -0.39576347
i = 7  <i|F|i> =  -0.11985929
i = 8  <i|F|i> =   0.24572230
i = 9  <i|F|i> =   0.24572244
i = 10  <i|F|i> =   0.97455873
i = 11  <i|F|i> =   0.60242248
i = 12  <i|F|i> =   0.65380121
i = 13  <i|F|i> =   0.65380122
i = 14  <i|F|i> =   0.73073416
i = 15  <i|F|i> =   0.70485726
i = 16  <i|F|i> =   0.70485720
i = 17  <i|F|i> =   0.55387784
i = 18  <i|F|i> =   1.24298621
i = 19  <i|F|i> =   1.24298621
i = 20  <i|F|i> =   1.13306720
i = 21  <i|F|i> =   1.37508143
i = 22  <i|F|i> =   1.37508141
i = 23  <i|F|i> =   1.63578169
i = 24  <i|F|i> =   1.63578169
i = 25  <i|F|i> =   2.05136970
i = 26  <i|F|i> =   2.10699459
i = 27  <i|F|i> =   2.10699458
i = 28  <i|F|i> =   2.32191414
......production of RDMs took       1.82 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.85 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickSCNEVPT2-ijrs) =    -0.00031742030570
E(WickSCNEVPT2- rsi) =    -0.00100335898657
E(WickSCNEVPT2- ijr) =    -0.00043133179690
E(WickSCNEVPT2-  rs) =    -0.03855199166851
E(WickSCNEVPT2-  ij) =    -0.00015087831926
E(WickSCNEVPT2-  ir) =    -0.00129971700088
E(WickSCNEVPT2-   r) =    -0.04417115692183
E(WickSCNEVPT2-   i) =    -0.00028996402974
E(WickSCNEVPT2) = -75.71022360721113  E_corr_pt = -0.08621581902938799
Timings = pdms =   31.86 | eris =    0.01 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.04 | ir =    0.03 | r =    0.67 | i =    0.40
Time cost =    154.803
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:40:58 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.296484166754 AA    0.000000000000   0.000000000000   2.450000000000 Bohr   0.0

nuclear repulsion = 14.6938775510204
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.225]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5610.84


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp1gsg50jq
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4178541557328

WARN: Singularity detected in overlap matrix (condition number =  525). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.243088233296001  LUMO (Ag) = -0.180721513540293
cycle= 1 E= -75.3682765376262  delta_E= 0.0496  |g|= 0.207  |ddm|= 1.47
HOMO (B3u) = -0.477856195390326  LUMO (Ag) = -0.146786594446604
cycle= 2 E= -75.3835137621144  delta_E= -0.0152  |g|= 0.0521  |ddm|= 0.243
HOMO (B3u) = -0.441063789154572  LUMO (Ag) = -0.107250630527328
cycle= 3 E= -75.3843533836984  delta_E= -0.00084  |g|= 0.00929  |ddm|= 0.0595
HOMO (B3u) = -0.442295646912941  LUMO (Ag) = -0.106015245128839
cycle= 4 E= -75.3844049545556  delta_E= -5.16e-05  |g|= 0.0018  |ddm|= 0.0274
HOMO (B3u) = -0.443045442143857  LUMO (Ag) = -0.106700546721387
cycle= 5 E= -75.3844070231975  delta_E= -2.07e-06  |g|= 7.54e-05  |ddm|= 0.0094
HOMO (B3u) = -0.443032060379304  LUMO (Ag) = -0.106682393250681
cycle= 6 E= -75.3844070255161  delta_E= -2.32e-09  |g|= 1.3e-05  |ddm|= 0.00058
HOMO (B3u) = -0.443029779172082  LUMO (Ag) = -0.106680098001435
cycle= 7 E= -75.3844070256074  delta_E= -9.13e-11  |g|= 1.64e-06  |ddm|= 2.88e-05
HOMO (B3u) = -0.443029714305118  LUMO (Ag) = -0.10667967191225
cycle= 8 E= -75.3844070256093  delta_E= -1.95e-12  |g|= 2.42e-07  |ddm|= 1.68e-05
HOMO (B3u) = -0.44302969044768  LUMO (Ag) = -0.106679577822372
cycle= 9 E= -75.3844070256094  delta_E= -4.26e-14  |g|= 1.45e-08  |ddm|= 6.37e-07
HOMO (B3u) = -0.44302969148033  LUMO (Ag) = -0.106679578765707
cycle= 10 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 7.83e-09  |ddm|= 1.24e-08
HOMO (B3u) = -0.443029688058912  LUMO (Ag) = -0.106679573922009
cycle= 11 E= -75.3844070256093  delta_E=    0  |g|= 1.29e-09  |ddm|= 2.46e-08
HOMO (B3u) = -0.443029688174303  LUMO (Ag) = -0.106679573997883
cycle= 12 E= -75.3844070256093  delta_E= 2.84e-14  |g|= 1.03e-09  |ddm|= 1.28e-09
HOMO (B3u) = -0.443029688161226  LUMO (Ag) = -0.106679573950375
cycle= 13 E= -75.3844070256094  delta_E= -1.14e-13  |g|= 8e-10  |ddm|= 8.13e-10
HOMO (B2u) = -0.443029688193204  LUMO (Ag) = -0.106679573943545
cycle= 14 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 7.69e-10  |ddm|= 1.6e-09
HOMO (B2u) = -0.443029688178595  LUMO (Ag) = -0.106679573919426
cycle= 15 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 6.83e-10  |ddm|= 1.76e-10
HOMO (B2u) = -0.443029688156576  LUMO (Ag) = -0.106679573899631
cycle= 16 E= -75.3844070256093  delta_E= 8.53e-14  |g|= 6.14e-10  |ddm|= 4.12e-10
HOMO (B2u) = -0.443029688050883  LUMO (Ag) = -0.106679573934639
cycle= 17 E= -75.3844070256094  delta_E= -8.53e-14  |g|= 7.85e-10  |ddm|= 5.62e-10
HOMO (B2u) = -0.443029688063117  LUMO (Ag) = -0.106679573858535
cycle= 18 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 4.07e-10  |ddm|= 7.24e-10
HOMO (B2u) = -0.443029688140497  LUMO (Ag) = -0.106679573882884
cycle= 19 E= -75.3844070256094  delta_E= 2.84e-14  |g|= 1.83e-10  |ddm|= 5.25e-10
HOMO (B3u) = -0.443029688139499  LUMO (Ag) = -0.106679573878442
cycle= 20 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 1.58e-10  |ddm|= 5.38e-11
HOMO (B2u) = -0.443029688142052  LUMO (Ag) = -0.106679573877696
cycle= 21 E= -75.3844070256093  delta_E=    0  |g|= 1.36e-10  |ddm|= 6.48e-11
HOMO (B2u) = -0.443029688143451  LUMO (Ag) = -0.106679573877096
cycle= 22 E= -75.3844070256093  delta_E= 7.11e-14  |g|= 1.2e-10  |ddm|= 4.66e-11
HOMO (B2u) = -0.443029688143089  LUMO (Ag) = -0.106679573876387
cycle= 23 E= -75.3844070256093  delta_E= -5.68e-14  |g|= 1.02e-10  |ddm|= 3.87e-11
HOMO (B2u) = -0.443029688142209  LUMO (Ag) = -0.106679573875473
cycle= 24 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 8.66e-11  |ddm|= 3.8e-11
HOMO (B3u) = -0.44302968814115  LUMO (Ag) = -0.106679573874423
cycle= 25 E= -75.3844070256094  delta_E= -8.53e-14  |g|= 7.34e-11  |ddm|= 3.03e-11
HOMO (B3u) = -0.443029688139549  LUMO (Ag) = -0.106679573866748
cycle= 26 E= -75.3844070256094  delta_E= 4.26e-14  |g|= 4.79e-11  |ddm|= 4.72e-11
HOMO (B3u) = -0.443029688137568  LUMO (Ag) = -0.106679573862182
cycle= 27 E= -75.3844070256095  delta_E= -5.68e-14  |g|= 3.53e-11  |ddm|= 2.49e-11
HOMO (B3u) = -0.443029688137592  LUMO (Ag) = -0.106679573861334
cycle= 28 E= -75.3844070256094  delta_E= 9.95e-14  |g|= 3.02e-11  |ddm|= 1.13e-11
HOMO (B3u) = -0.443029688137531  LUMO (Ag) = -0.106679573860527
cycle= 29 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 2.57e-11  |ddm|= 1.09e-11
HOMO (B3u) = -0.443029688137495  LUMO (Ag) = -0.106679573859839
cycle= 30 E= -75.3844070256093  delta_E= -4.26e-14  |g|= 2.17e-11  |ddm|= 1.11e-11
HOMO (B3u) = -0.443029688137474  LUMO (Ag) = -0.106679573859214
cycle= 31 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 1.81e-11  |ddm|= 1.13e-11
HOMO (B3u) = -0.443029688137515  LUMO (Ag) = -0.106679573858633
cycle= 32 E= -75.3844070256094  delta_E= -1.56e-13  |g|= 1.48e-11  |ddm|= 1e-11
HOMO (B3u) = -0.44302968813761  LUMO (Ag) = -0.106679573858078
cycle= 33 E= -75.3844070256094  delta_E= 7.11e-14  |g|= 1.19e-11  |ddm|= 8.78e-12
HOMO (B3u) = -0.443029688137738  LUMO (Ag) = -0.106679573857528
cycle= 34 E= -75.3844070256093  delta_E= 9.95e-14  |g|= 9.21e-12  |ddm|= 7.86e-12
HOMO (B3u) = -0.44302968813777  LUMO (Ag) = -0.106679573857169
cycle= 35 E= -75.3844070256093  delta_E= -7.11e-14  |g|= 7.54e-12  |ddm|= 5.41e-12
HOMO (B3u) = -0.443029688137729  LUMO (Ag) = -0.106679573856869
cycle= 36 E= -75.3844070256094  delta_E= -7.11e-14  |g|= 6.36e-12  |ddm|= 4.09e-12
HOMO (B3u) = -0.443029688137694  LUMO (Ag) = -0.106679573856603
cycle= 37 E= -75.3844070256093  delta_E= 7.11e-14  |g|= 5.33e-12  |ddm|= 3.78e-12
HOMO (B3u) = -0.443029688137664  LUMO (Ag) = -0.106679573856368
cycle= 38 E= -75.3844070256093  delta_E= 2.84e-14  |g|= 4.45e-12  |ddm|= 3.29e-12
HOMO (B3u) = -0.443029688137642  LUMO (Ag) = -0.106679573856162
cycle= 39 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 3.68e-12  |ddm|= 2.87e-12
HOMO (B3u) = -0.443029688137628  LUMO (Ag) = -0.106679573855986
cycle= 40 E= -75.3844070256093  delta_E= 8.53e-14  |g|= 3.02e-12  |ddm|= 2.43e-12
HOMO (B3u) = -0.443029688137621  LUMO (Ag) = -0.10667957385584
cycle= 41 E= -75.3844070256094  delta_E= -8.53e-14  |g|= 2.48e-12  |ddm|= 2.03e-12
HOMO (B3u) = -0.443029688137619  LUMO (Ag) = -0.106679573855723
cycle= 42 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 2.04e-12  |ddm|= 1.54e-12
HOMO (B3u) = -0.44302968813762  LUMO (Ag) = -0.106679573855636
cycle= 43 E= -75.3844070256093  delta_E= 7.11e-14  |g|= 1.7e-12  |ddm|= 1.28e-12
HOMO (B2u) = -0.443029688137622  LUMO (Ag) = -0.106679573855565
cycle= 44 E= -75.3844070256093  delta_E= 1.42e-14  |g|= 1.43e-12  |ddm|= 1.05e-12
HOMO (B2u) = -0.443029688137624  LUMO (Ag) = -0.106679573855505
cycle= 45 E= -75.3844070256094  delta_E= -8.53e-14  |g|= 1.19e-12  |ddm|= 8.76e-13
HOMO (B3u) = -0.443029688137627  LUMO (Ag) = -0.106679573855453
cycle= 46 E= -75.3844070256094  delta_E= 1.42e-14  |g|= 9.91e-13  |ddm|= 7.7e-13
HOMO (B2u) = -0.443029688137628  LUMO (Ag) = -0.106679573855409
cycle= 47 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 8.25e-13  |ddm|= 5.78e-13
HOMO (B3u) = -0.44302968813763  LUMO (Ag) = -0.106679573855372
cycle= 48 E= -75.3844070256093  delta_E= 7.11e-14  |g|= 6.86e-13  |ddm|= 4.97e-13
HOMO (B3u) = -0.443029688137631  LUMO (Ag) = -0.10667957385534
cycle= 49 E= -75.3844070256093  delta_E= 1.42e-14  |g|= 5.7e-13  |ddm|= 4.02e-13
HOMO (B2u) = -0.443029688137632  LUMO (Ag) = -0.106679573855315
cycle= 50 E= -75.3844070256093  delta_E= -2.84e-14  |g|= 4.73e-13  |ddm|= 4.22e-13
SCF not converged.
SCF energy = -75.3844070256093

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp1gsg50jq
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.553982708661  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5763588373788  dE = -0.022376129  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5917604119779  dE = -0.015401575  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0607  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6003940119298  dE = -0.0086336  S^2 = 0.0000000
               |grad[o]|=0.0877  |ddm|=0.031  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066572787239  dE = -0.0062632668  S^2 = 0.0000000
               |grad[o]|=0.0695  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6115944226798  dE = -0.004937144  S^2 = 0.0000000
               |grad[o]|=0.0556  |ddm|=0.00767  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6155233575953  dE = -0.0039289349  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00552  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6185579794731  dE = -0.0030346219  S^2 = 0.0000000
               |grad[o]|=0.0341  |ddm|=0.00451  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.62075737496  dE = -0.0021993955  S^2 = 0.0000000
               |grad[o]|=0.0252  |ddm|=0.00408  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6221629715032  dE = -0.0014055965  S^2 = 0.0000000
               |grad[o]|=0.017  |ddm|=0.00399  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6228190649019  dE = -0.0006560934  S^2 = 0.0000000
               |grad[o]|=0.00956  |ddm|=0.00414  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6228849775873  dE = -6.5912685e-05  S^2 = 0.0000000
               |grad[o]|=0.00284  |ddm|=0.00447  |maxRot[o]|=0.0322
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6228858553638  dE = -8.7777657e-07  S^2 = 0.0000000
               |grad[o]|=0.000486  |ddm|=0.00205  |maxRot[o]|=0.00324
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6228858734362  dE = -1.8072384e-08  S^2 = 0.0000000
               |grad[o]|=7.86e-05  |ddm|=0.000399  |maxRot[o]|=0.000423
macro iter 14 (3 JK  0 micro), CASSCF E = -75.622885873879  dE = -4.4273918e-10  S^2 = 0.0000000
               |grad[o]|=1.27e-05  |ddm|=8.07e-05  |maxRot[o]|=6.85e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6228858738904  dE = -1.1439738e-11  S^2 = 0.0000000
               |grad[o]|=2.51e-06  |ddm|=1.82e-05  |maxRot[o]|=1.16e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98259212 1.6238229  1.87827428 1.87827435 0.37239279 0.12484127
 0.12484106 0.01496124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00430   0.00292   0.00000   0.00000  -0.00121
  0 C 2s       0.59918   0.53182   0.00000  -0.00000  -0.37268
  0 C 3s      -0.04557   0.00882   0.00000  -0.00000  -0.00652
  0 C 2px      0.00000  -0.00000  -0.00000   0.70645   0.00000
  0 C 2py      0.00000   0.00000   0.70645  -0.00000  -0.00000
  0 C 2pz      0.36821  -0.46590  -0.00000   0.00000   0.59928
  0 C 3px      0.00000  -0.00000   0.00000  -0.00317  -0.00000
  0 C 3py      0.00000   0.00000  -0.00317  -0.00000  -0.00000
  0 C 3pz     -0.04436  -0.00424   0.00000  -0.00000  -0.04182
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.03019  -0.00000  -0.00000
  0 C 3dz^2    0.03661   0.00082   0.00000  -0.00000   0.01349
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03019  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00430  -0.00292   0.00000   0.00000  -0.00121
  1 C 2s       0.59918  -0.53182   0.00000   0.00000  -0.37268
  1 C 3s      -0.04557  -0.00882  -0.00000   0.00000  -0.00652
  1 C 2px     -0.00000   0.00000  -0.00000   0.70645   0.00000
  1 C 2py     -0.00000  -0.00000   0.70645  -0.00000  -0.00000
  1 C 2pz     -0.36821  -0.46590   0.00000  -0.00000  -0.59928
  1 C 3px     -0.00000   0.00000   0.00000  -0.00317  -0.00000
  1 C 3py     -0.00000  -0.00000  -0.00317   0.00000   0.00000
  1 C 3pz      0.04436  -0.00424   0.00000  -0.00000   0.04182
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03019  -0.00000  -0.00000
  1 C 3dz^2    0.03661  -0.00082  -0.00000   0.00000   0.01349
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.03019   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00063
  0 C 2s      -0.00000   0.00000   0.46522
  0 C 3s      -0.00000   0.00000  -0.04289
  0 C 2px      0.70635  -0.00000  -0.00000
  0 C 2py      0.00000   0.70635   0.00000
  0 C 2pz     -0.00000  -0.00000   0.53006
  0 C 3px     -0.02272   0.00000  -0.00000
  0 C 3py      0.00000  -0.02272   0.00000
  0 C 3pz     -0.00000   0.00000   0.01231
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02357   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02477
  0 C 3dxz    -0.02357   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00063
  1 C 2s       0.00000  -0.00000  -0.46522
  1 C 3s       0.00000  -0.00000   0.04289
  1 C 2px     -0.70635  -0.00000   0.00000
  1 C 2py      0.00000  -0.70635  -0.00000
  1 C 2pz     -0.00000   0.00000   0.53006
  1 C 3px      0.02272  -0.00000   0.00000
  1 C 3py     -0.00000   0.02272  -0.00000
  1 C 3pz     -0.00000   0.00000   0.01231
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02357   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02477
  1 C 3dxz    -0.02357   0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99403735
<CAS-nat-orb|mo-hf>  4  4    0.99839928
<CAS-nat-orb|mo-hf>  5  5    0.99974564
<CAS-nat-orb|mo-hf>  6  6    0.99974564
<CAS-nat-orb|mo-hf>  7  7    0.97790009
<CAS-nat-orb|mo-hf>  8  8    0.94457117
<CAS-nat-orb|mo-hf>  9  9    0.94457115
<CAS-nat-orb|mo-hf>  10  10    0.51114031
<CAS-nat-orb|mo-hf>  10  17    0.67613315
<CAS-nat-orb|mo-hf>  10  18   -0.49120162
CASSCF energy = -75.6228858738904
CASCI E = -75.6228858738904  E(CI) = -17.4344345074026  S^2 = 0.0000000
Density matrix diagonal elements [1.98259236 1.6238224  1.87827441 1.87827446 0.37239364 0.12484061
 0.12484097 0.01496115]
i = 1  <i|F|i> = -11.29606540
i = 2  <i|F|i> = -11.29446245
i = 3  <i|F|i> =  -0.99208609
i = 4  <i|F|i> =  -0.43737622
i = 5  <i|F|i> =  -0.38916934
i = 6  <i|F|i> =  -0.38916934
i = 7  <i|F|i> =  -0.11780043
i = 8  <i|F|i> =   0.23132853
i = 9  <i|F|i> =   0.23132847
i = 10  <i|F|i> =   0.92684663
i = 11  <i|F|i> =   0.60766152
i = 12  <i|F|i> =   0.65808016
i = 13  <i|F|i> =   0.65808016
i = 14  <i|F|i> =   0.72888115
i = 15  <i|F|i> =   0.70550753
i = 16  <i|F|i> =   0.70550751
i = 17  <i|F|i> =   0.55409011
i = 18  <i|F|i> =   1.12655297
i = 19  <i|F|i> =   1.24640121
i = 20  <i|F|i> =   1.24640121
i = 21  <i|F|i> =   1.35807431
i = 22  <i|F|i> =   1.35807431
i = 23  <i|F|i> =   1.62487231
i = 24  <i|F|i> =   1.62487231
i = 25  <i|F|i> =   2.03804823
i = 26  <i|F|i> =   2.09062687
i = 27  <i|F|i> =   2.09062688
i = 28  <i|F|i> =   2.28569764
......production of RDMs took       1.88 sec
......reading the RDM took          0.46 sec
......production of RDMs took      22.34 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.79 sec

E(WickSCNEVPT2-ijrs) =    -0.00030910015690
E(WickSCNEVPT2- rsi) =    -0.00098237600267
E(WickSCNEVPT2- ijr) =    -0.00042399024567
E(WickSCNEVPT2-  rs) =    -0.03813440691828
E(WickSCNEVPT2-  ij) =    -0.00014581837546
E(WickSCNEVPT2-  ir) =    -0.00128097825912
E(WickSCNEVPT2-   r) =    -0.04493895815322
E(WickSCNEVPT2-   i) =    -0.00028395955036
E(WickSCNEVPT2) = -75.70938546155209  E_corr_pt = -0.08649958766168257
Timings = pdms =   34.47 | eris =    0.01 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.61 | i =    0.29
Time cost =    162.326
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:43:40 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.322943027300 AA    0.000000000000   0.000000000000   2.500000000000 Bohr   0.0

nuclear repulsion = 14.4
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.25]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5767.27


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpv8_psrs9
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.3694175262293

WARN: Singularity detected in overlap matrix (condition number =  483). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.23337660812262  LUMO (Ag) = -0.177980136770164
cycle= 1 E= -75.3638092539421  delta_E= 0.00561  |g|= 0.211  |ddm|= 1.47
HOMO (B2u) = -0.472745514482946  LUMO (Ag) = -0.148264279814743
cycle= 2 E= -75.3797344374881  delta_E= -0.0159  |g|= 0.0521  |ddm|= 0.252
HOMO (B3u) = -0.435707130637768  LUMO (Ag) = -0.107623543297933
cycle= 3 E= -75.3805941182358  delta_E= -0.00086  |g|= 0.00941  |ddm|= 0.058
HOMO (B2u) = -0.436826447423382  LUMO (Ag) = -0.105984728580031
cycle= 4 E= -75.3806472395887  delta_E= -5.31e-05  |g|= 0.00184  |ddm|= 0.0247
HOMO (B3u) = -0.43758121013612  LUMO (Ag) = -0.106606422286031
cycle= 5 E= -75.3806494262655  delta_E= -2.19e-06  |g|= 0.000123  |ddm|= 0.0084
HOMO (B3u) = -0.437555273305047  LUMO (Ag) = -0.106565393729153
cycle= 6 E= -75.3806494342396  delta_E= -7.97e-09  |g|= 2.47e-05  |ddm|= 0.000449
HOMO (B3u) = -0.437550531930256  LUMO (Ag) = -0.106557643143757
cycle= 7 E= -75.3806494346656  delta_E= -4.26e-10  |g|= 3.1e-06  |ddm|= 0.000106
HOMO (B2u) = -0.437550642586829  LUMO (Ag) = -0.10655705700936
cycle= 8 E= -75.3806494346709  delta_E= -5.29e-12  |g|= 3.13e-07  |ddm|= 2.83e-05
HOMO (B3u) = -0.437550627656546  LUMO (Ag) = -0.106556986157519
cycle= 9 E= -75.380649434671  delta_E= -4.26e-14  |g|= 1.55e-08  |ddm|= 1.79e-06
HOMO (B2u) = -0.437550624651403  LUMO (Ag) = -0.106556982907061
cycle= 10 E= -75.380649434671  delta_E=    0  |g|= 1.93e-09  |ddm|= 3.86e-08
HOMO (B2u) = -0.437550624829389  LUMO (Ag) = -0.106556983038723
cycle= 11 E= -75.3806494346709  delta_E= 2.84e-14  |g|= 1.14e-09  |ddm|= 1.49e-09
HOMO (B2u) = -0.437550625013663  LUMO (Ag) = -0.106556983190228
cycle= 12 E= -75.3806494346711  delta_E= -1.14e-13  |g|= 9.98e-10  |ddm|= 9.77e-10
HOMO (B2u) = -0.437550624988629  LUMO (Ag) = -0.106556983147008
cycle= 13 E= -75.380649434671  delta_E= 2.84e-14  |g|= 7.69e-10  |ddm|= 9.16e-10
HOMO (B2u) = -0.43755062498617  LUMO (Ag) = -0.10655698311451
cycle= 14 E= -75.3806494346711  delta_E= -2.84e-14  |g|= 6.87e-10  |ddm|= 1.09e-09
HOMO (B3u) = -0.437550624978956  LUMO (Ag) = -0.106556983103681
cycle= 15 E= -75.3806494346709  delta_E= 1.42e-13  |g|= 6e-10  |ddm|= 5.83e-10
HOMO (B2u) = -0.437550624980792  LUMO (Ag) = -0.106556983131656
cycle= 16 E= -75.380649434671  delta_E= -1.28e-13  |g|= 5.54e-10  |ddm|= 9.76e-10
HOMO (B3u) = -0.437550624902057  LUMO (Ag) = -0.106556983104032
cycle= 17 E= -75.380649434671  delta_E= 4.26e-14  |g|= 6.12e-10  |ddm|= 9.15e-10
HOMO (B2u) = -0.437550624888174  LUMO (Ag) = -0.106556983015245
cycle= 18 E= -75.380649434671  delta_E=    0  |g|= 2.04e-10  |ddm|= 9.04e-10
HOMO (B3u) = -0.437550624886186  LUMO (Ag) = -0.106556983008153
cycle= 19 E= -75.380649434671  delta_E=    0  |g|= 1.62e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.437550624886803  LUMO (Ag) = -0.106556983005716
cycle= 20 E= -75.380649434671  delta_E=    0  |g|= 1.38e-10  |ddm|= 7.06e-11
HOMO (B3u) = -0.4375506248921  LUMO (Ag) = -0.106556983007834
cycle= 21 E= -75.3806494346711  delta_E= -8.53e-14  |g|= 1.15e-10  |ddm|= 7.9e-11
HOMO (B3u) = -0.437550624896246  LUMO (Ag) = -0.106556983009562
cycle= 22 E= -75.3806494346711  delta_E= 2.84e-14  |g|= 9.77e-11  |ddm|= 6.14e-11
HOMO (B2u) = -0.437550624898481  LUMO (Ag) = -0.106556983010887
cycle= 23 E= -75.380649434671  delta_E= 4.26e-14  |g|= 8.18e-11  |ddm|= 3.87e-11
HOMO (B3u) = -0.437550624900114  LUMO (Ag) = -0.106556983011651
cycle= 24 E= -75.380649434671  delta_E= 1.42e-14  |g|= 6.75e-11  |ddm|= 3.1e-11
HOMO (B2u) = -0.437550624901784  LUMO (Ag) = -0.106556983011112
cycle= 25 E= -75.3806494346711  delta_E= -8.53e-14  |g|= 5.22e-11  |ddm|= 3.59e-11
HOMO (B2u) = -0.43755062490256  LUMO (Ag) = -0.106556983007898
cycle= 26 E= -75.380649434671  delta_E= 7.11e-14  |g|= 3.36e-11  |ddm|= 3.22e-11
HOMO (B2u) = -0.437550624902249  LUMO (Ag) = -0.106556983006689
cycle= 27 E= -75.380649434671  delta_E= -1.42e-14  |g|= 2.8e-11  |ddm|= 9.86e-12
HOMO (B2u) = -0.437550624901806  LUMO (Ag) = -0.106556983005546
cycle= 28 E= -75.3806494346709  delta_E= 8.53e-14  |g|= 2.35e-11  |ddm|= 8.18e-12
HOMO (B2u) = -0.437550624901337  LUMO (Ag) = -0.106556983004473
cycle= 29 E= -75.3806494346711  delta_E= -1.14e-13  |g|= 1.96e-11  |ddm|= 7.66e-12
HOMO (B2u) = -0.437550624901001  LUMO (Ag) = -0.106556983003608
cycle= 30 E= -75.380649434671  delta_E= 2.84e-14  |g|= 1.62e-11  |ddm|= 7.24e-12
HOMO (B3u) = -0.437550624900765  LUMO (Ag) = -0.106556983002897
cycle= 31 E= -75.3806494346709  delta_E= 8.53e-14  |g|= 1.33e-11  |ddm|= 7.23e-12
HOMO (B2u) = -0.437550624900631  LUMO (Ag) = -0.106556983002284
cycle= 32 E= -75.380649434671  delta_E= -8.53e-14  |g|= 1.07e-11  |ddm|= 6.78e-12
HOMO (B3u) = -0.437550624900589  LUMO (Ag) = -0.106556983001764
cycle= 33 E= -75.380649434671  delta_E= 4.26e-14  |g|= 8.43e-12  |ddm|= 5.98e-12
HOMO (B3u) = -0.43755062490063  LUMO (Ag) = -0.106556983001397
cycle= 34 E= -75.380649434671  delta_E= 2.84e-14  |g|= 6.68e-12  |ddm|= 4.52e-12
HOMO (B2u) = -0.437550624900667  LUMO (Ag) = -0.106556983001192
cycle= 35 E= -75.380649434671  delta_E= -8.53e-14  |g|= 5.57e-12  |ddm|= 3.13e-12
HOMO (B2u) = -0.437550624900695  LUMO (Ag) = -0.10655698300101
cycle= 36 E= -75.380649434671  delta_E= 1.42e-14  |g|= 4.64e-12  |ddm|= 2.9e-12
HOMO (B2u) = -0.437550624900709  LUMO (Ag) = -0.106556983000843
cycle= 37 E= -75.380649434671  delta_E= 2.84e-14  |g|= 3.83e-12  |ddm|= 2.53e-12
HOMO (B2u) = -0.437550624900711  LUMO (Ag) = -0.106556983000691
cycle= 38 E= -75.380649434671  delta_E= 4.26e-14  |g|= 3.16e-12  |ddm|= 2.23e-12
HOMO (B2u) = -0.437550624900707  LUMO (Ag) = -0.106556983000552
cycle= 39 E= -75.3806494346711  delta_E= -9.95e-14  |g|= 2.6e-12  |ddm|= 1.93e-12
HOMO (B2u) = -0.437550624900701  LUMO (Ag) = -0.106556983000432
cycle= 40 E= -75.3806494346711  delta_E= -1.42e-14  |g|= 2.12e-12  |ddm|= 1.61e-12
HOMO (B3u) = -0.437550624900694  LUMO (Ag) = -0.106556983000329
cycle= 41 E= -75.380649434671  delta_E= 4.26e-14  |g|= 1.74e-12  |ddm|= 1.29e-12
HOMO (B3u) = -0.437550624900688  LUMO (Ag) = -0.106556983000246
cycle= 42 E= -75.380649434671  delta_E= 5.68e-14  |g|= 1.44e-12  |ddm|= 1.1e-12
HOMO (B3u) = -0.437550624900682  LUMO (Ag) = -0.106556983000179
cycle= 43 E= -75.380649434671  delta_E= -5.68e-14  |g|= 1.2e-12  |ddm|= 8.94e-13
HOMO (B3u) = -0.437550624900679  LUMO (Ag) = -0.106556983000124
cycle= 44 E= -75.3806494346711  delta_E= -2.84e-14  |g|= 9.99e-13  |ddm|= 7.27e-13
HOMO (B3u) = -0.437550624900678  LUMO (Ag) = -0.106556983000079
cycle= 45 E= -75.380649434671  delta_E= 7.11e-14  |g|= 8.31e-13  |ddm|= 5.57e-13
HOMO (B3u) = -0.437550624900678  LUMO (Ag) = -0.106556983000041
cycle= 46 E= -75.3806494346711  delta_E= -9.95e-14  |g|= 6.89e-13  |ddm|= 5.3e-13
HOMO (B3u) = -0.437550624900678  LUMO (Ag) = -0.10655698300001
cycle= 47 E= -75.380649434671  delta_E= 5.68e-14  |g|= 5.71e-13  |ddm|= 3.66e-13
HOMO (B3u) = -0.437550624900679  LUMO (Ag) = -0.106556982999984
cycle= 48 E= -75.3806494346711  delta_E= -5.68e-14  |g|= 4.77e-13  |ddm|= 3.41e-13
HOMO (B3u) = -0.43755062490068  LUMO (Ag) = -0.106556982999962
cycle= 49 E= -75.380649434671  delta_E= 5.68e-14  |g|= 3.95e-13  |ddm|= 3.12e-13
HOMO (B3u) = -0.437550624900681  LUMO (Ag) = -0.106556982999946
cycle= 50 E= -75.3806494346711  delta_E= -5.68e-14  |g|= 3.26e-13  |ddm|= 2.51e-13
SCF not converged.
SCF energy = -75.3806494346711

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpv8_psrs9
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5520156742894  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5749557691946  dE = -0.022940095  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.589307559989  dE = -0.014351791  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0633  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5977719040474  dE = -0.0084643441  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0299  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6039893910606  dE = -0.006217487  S^2 = 0.0000000
               |grad[o]|=0.071  |ddm|=0.0135  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6089055501019  dE = -0.004916159  S^2 = 0.0000000
               |grad[o]|=0.0571  |ddm|=0.00833  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6128209543748  dE = -0.0039154043  S^2 = 0.0000000
               |grad[o]|=0.0454  |ddm|=0.00602  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6158466050375  dE = -0.0030256507  S^2 = 0.0000000
               |grad[o]|=0.0352  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6180396311153  dE = -0.0021930261  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.619439513381  dE = -0.0013998823  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00412  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6200886537406  dE = -0.00064914036  S^2 = 0.0000000
               |grad[o]|=0.00981  |ddm|=0.00428  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201507320497  dE = -6.2078309e-05  S^2 = 0.0000000
               |grad[o]|=0.00282  |ddm|=0.00468  |maxRot[o]|=0.0311
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201515477166  dE = -8.1566691e-07  S^2 = 0.0000000
               |grad[o]|=0.000473  |ddm|=0.00207  |maxRot[o]|=0.00307
macro iter 13 (3 JK  0 micro), CASSCF E = -75.620151564329  dE = -1.6612461e-08  S^2 = 0.0000000
               |grad[o]|=7.49e-05  |ddm|=0.000374  |maxRot[o]|=0.000396
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6201515647232  dE = -3.9412384e-10  S^2 = 0.0000000
               |grad[o]|=1.22e-05  |ddm|=7.4e-05  |maxRot[o]|=6.42e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.620151564741  dE = -1.7834623e-11  S^2 = 0.0000000
               |grad[o]|=2.58e-06  |ddm|=1.82e-05  |maxRot[o]|=1.12e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98175021 1.63550775 1.8711556  1.87115624 0.3611846  0.13173008
 0.1317302  0.01578531]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00465   0.00301   0.00000   0.00000  -0.00114
  0 C 2s       0.60227   0.53958  -0.00000  -0.00000  -0.36778
  0 C 3s      -0.04374   0.00880  -0.00000  -0.00000  -0.00363
  0 C 2px      0.00000  -0.00000  -0.00000   0.70650  -0.00000
  0 C 2py      0.00000   0.00000   0.70650  -0.00000   0.00000
  0 C 2pz      0.36367  -0.45689  -0.00000  -0.00000   0.60227
  0 C 3px      0.00000  -0.00000   0.00000  -0.00009   0.00000
  0 C 3py     -0.00000   0.00000  -0.00009  -0.00000   0.00000
  0 C 3pz     -0.04268  -0.00383  -0.00000  -0.00000  -0.04233
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.02932  -0.00000   0.00000
  0 C 3dz^2    0.03544   0.00032  -0.00000  -0.00000   0.01448
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02932   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00465  -0.00301   0.00000   0.00000  -0.00114
  1 C 2s       0.60227  -0.53958   0.00000   0.00000  -0.36778
  1 C 3s      -0.04374  -0.00880   0.00000   0.00000  -0.00363
  1 C 2px     -0.00000   0.00000  -0.00000   0.70650  -0.00000
  1 C 2py      0.00000  -0.00000   0.70650   0.00000  -0.00000
  1 C 2pz     -0.36367  -0.45689  -0.00000   0.00000  -0.60227
  1 C 3px     -0.00000   0.00000   0.00000  -0.00009   0.00000
  1 C 3py     -0.00000  -0.00000  -0.00009   0.00000  -0.00000
  1 C 3pz      0.04268  -0.00383  -0.00000  -0.00000   0.04233
  1 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000  -0.02932  -0.00000   0.00000
  1 C 3dz^2    0.03544  -0.00032   0.00000   0.00000   0.01448
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02932  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s      -0.00000  -0.00000   0.45623
  0 C 3s      -0.00000  -0.00000  -0.04293
  0 C 2px      0.70638   0.00000  -0.00000
  0 C 2py      0.00000   0.70638  -0.00000
  0 C 2pz      0.00000  -0.00000   0.53783
  0 C 3px     -0.02172   0.00000  -0.00000
  0 C 3py      0.00000  -0.02172  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01389
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02345  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02369
  0 C 3dxz    -0.02345   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s       0.00000   0.00000  -0.45623
  1 C 3s       0.00000   0.00000   0.04293
  1 C 2px     -0.70638  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70638   0.00000
  1 C 2pz      0.00000  -0.00000   0.53783
  1 C 3px      0.02172  -0.00000   0.00000
  1 C 3py     -0.00000   0.02172   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01389
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02345  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02369
  1 C 3dxz    -0.02345   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99374273
<CAS-nat-orb|mo-hf>  4  4    0.99831642
<CAS-nat-orb|mo-hf>  5  5    0.99972153
<CAS-nat-orb|mo-hf>  6  6    0.99972153
<CAS-nat-orb|mo-hf>  7  7    0.97735853
<CAS-nat-orb|mo-hf>  8  8    0.94866393
<CAS-nat-orb|mo-hf>  9  9    0.94866398
<CAS-nat-orb|mo-hf>  10  10    0.53130849
<CAS-nat-orb|mo-hf>  10  17    0.68518248
<CAS-nat-orb|mo-hf>  10  18   -0.46282807
CASSCF energy = -75.620151564741
CASCI E = -75.620151564741  E(CI) = -17.3010863052877  S^2 = 0.0000000
Density matrix diagonal elements [1.98175036 1.63550679 1.87115563 1.87115589 0.36118591 0.13172999
 0.13173015 0.01578527]
i = 1  <i|F|i> = -11.30127417
i = 2  <i|F|i> = -11.29995650
i = 3  <i|F|i> =  -0.98217967
i = 4  <i|F|i> =  -0.44452360
i = 5  <i|F|i> =  -0.38275836
i = 6  <i|F|i> =  -0.38275841
i = 7  <i|F|i> =  -0.11574127
i = 8  <i|F|i> =   0.21753675
i = 9  <i|F|i> =   0.21753664
i = 10  <i|F|i> =   0.88147093
i = 11  <i|F|i> =   0.61279527
i = 12  <i|F|i> =   0.66210093
i = 13  <i|F|i> =   0.66210093
i = 14  <i|F|i> =   0.72743252
i = 15  <i|F|i> =   0.70607876
i = 16  <i|F|i> =   0.70607882
i = 17  <i|F|i> =   0.55455733
i = 18  <i|F|i> =   1.12020719
i = 19  <i|F|i> =   1.25001754
i = 20  <i|F|i> =   1.25001754
i = 21  <i|F|i> =   1.34182809
i = 22  <i|F|i> =   1.34182810
i = 23  <i|F|i> =   1.61426606
i = 24  <i|F|i> =   1.61426606
i = 25  <i|F|i> =   2.02267326
i = 26  <i|F|i> =   2.07441391
i = 27  <i|F|i> =   2.07441392
i = 28  <i|F|i> =   2.25447079
......production of RDMs took      15.78 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.62 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.68 sec

E(WickSCNEVPT2-ijrs) =    -0.00030220020040
E(WickSCNEVPT2- rsi) =    -0.00096359803627
E(WickSCNEVPT2- ijr) =    -0.00041692514891
E(WickSCNEVPT2-  rs) =    -0.03770849660412
E(WickSCNEVPT2-  ij) =    -0.00014059798976
E(WickSCNEVPT2-  ir) =    -0.00126287647824
E(WickSCNEVPT2-   r) =    -0.04571537734065
E(WickSCNEVPT2-   i) =    -0.00027800351112
E(WickSCNEVPT2) = -75.70693964005049  E_corr_pt = -0.0867880753094879
Timings = pdms =   45.52 | eris =    0.01 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.54 | i =    0.24
Time cost =    121.118
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:45:41 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.349401887846 AA    0.000000000000   0.000000000000   2.550000000000 Bohr   0.0

nuclear repulsion = 14.1176470588235
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.275]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5872.48


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp882kvsnh
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.322852658808

WARN: Singularity detected in overlap matrix (condition number =  444). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.224183141291852  LUMO (Ag) = -0.175375833613538
cycle= 1 E= -75.3580302281757  delta_E= -0.0352  |g|= 0.215  |ddm|= 1.46
HOMO (B3u) = -0.467759172708487  LUMO (Ag) = -0.14945475379878
cycle= 2 E= -75.3746497165005  delta_E= -0.0166  |g|= 0.0521  |ddm|= 0.26
HOMO (B3u) = -0.43051679398039  LUMO (Ag) = -0.107753824209473
cycle= 3 E= -75.3755305907905  delta_E= -0.000881  |g|= 0.00966  |ddm|= 0.0568
HOMO (B2u) = -0.431561534231314  LUMO (Ag) = -0.105750596270449
cycle= 4 E= -75.3755868789759  delta_E= -5.63e-05  |g|= 0.00191  |ddm|= 0.0225
HOMO (B3u) = -0.432324246357024  LUMO (Ag) = -0.106325540767305
cycle= 5 E= -75.3755892675815  delta_E= -2.39e-06  |g|= 0.000174  |ddm|= 0.00743
HOMO (B3u) = -0.432284401985619  LUMO (Ag) = -0.106263967776652
cycle= 6 E= -75.3755892854562  delta_E= -1.79e-08  |g|= 3.01e-05  |ddm|= 0.000369
HOMO (B3u) = -0.432278729183655  LUMO (Ag) = -0.106254488809738
cycle= 7 E= -75.3755892860987  delta_E= -6.43e-10  |g|= 3.64e-06  |ddm|= 0.000169
HOMO (B2u) = -0.432278901425327  LUMO (Ag) = -0.106253945307328
cycle= 8 E= -75.3755892861055  delta_E= -6.84e-12  |g|= 3.45e-07  |ddm|= 2.86e-05
HOMO (B3u) = -0.432278883343995  LUMO (Ag) = -0.106253871171858
cycle= 9 E= -75.3755892861056  delta_E= -5.68e-14  |g|= 1.65e-08  |ddm|= 2.14e-06
HOMO (B3u) = -0.432278879789834  LUMO (Ag) = -0.10625386864663
cycle= 10 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 2.15e-09  |ddm|= 4.37e-08
HOMO (B3u) = -0.432278879879026  LUMO (Ag) = -0.106253868644965
cycle= 11 E= -75.3755892861055  delta_E= -2.84e-14  |g|= 1.25e-09  |ddm|= 1.97e-09
HOMO (B3u) = -0.432278880147107  LUMO (Ag) = -0.106253868888644
cycle= 12 E= -75.3755892861055  delta_E= 2.84e-14  |g|= 1.12e-09  |ddm|= 7.8e-10
HOMO (B2u) = -0.432278880103144  LUMO (Ag) = -0.106253868831181
cycle= 13 E= -75.3755892861056  delta_E= -5.68e-14  |g|= 8.77e-10  |ddm|= 8.34e-10
HOMO (B3u) = -0.432278880095399  LUMO (Ag) = -0.106253868793957
cycle= 14 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 7.51e-10  |ddm|= 1.07e-09
HOMO (B3u) = -0.432278880082028  LUMO (Ag) = -0.106253868781054
cycle= 15 E= -75.3755892861056  delta_E= -8.53e-14  |g|= 6.69e-10  |ddm|= 7.69e-10
HOMO (B3u) = -0.432278880084761  LUMO (Ag) = -0.106253868820464
cycle= 16 E= -75.3755892861056  delta_E= 2.84e-14  |g|= 6.26e-10  |ddm|= 1.16e-09
HOMO (B3u) = -0.432278880012607  LUMO (Ag) = -0.106253868780539
cycle= 17 E= -75.3755892861056  delta_E= 1.42e-14  |g|= 6.64e-10  |ddm|= 8.18e-10
HOMO (B3u) = -0.432278879978669  LUMO (Ag) = -0.106253868675703
cycle= 18 E= -75.3755892861056  delta_E= -1.42e-14  |g|= 2.3e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.432278879978224  LUMO (Ag) = -0.106253868669065
cycle= 19 E= -75.3755892861056  delta_E=    0  |g|= 1.82e-10  |ddm|= 1.32e-10
HOMO (B3u) = -0.432278879978719  LUMO (Ag) = -0.106253868666426
cycle= 20 E= -75.3755892861056  delta_E= -2.84e-14  |g|= 1.56e-10  |ddm|= 8.94e-11
HOMO (B2u) = -0.432278879985325  LUMO (Ag) = -0.106253868669649
cycle= 21 E= -75.3755892861056  delta_E= 2.84e-14  |g|= 1.29e-10  |ddm|= 9.02e-11
HOMO (B3u) = -0.432278879990324  LUMO (Ag) = -0.106253868672056
cycle= 22 E= -75.3755892861056  delta_E= -5.68e-14  |g|= 1.09e-10  |ddm|= 7.54e-11
HOMO (B3u) = -0.432278879993528  LUMO (Ag) = -0.10625386867414
cycle= 23 E= -75.3755892861056  delta_E= 7.11e-14  |g|= 9.22e-11  |ddm|= 5.24e-11
HOMO (B2u) = -0.432278879995727  LUMO (Ag) = -0.106253868675061
cycle= 24 E= -75.3755892861056  delta_E= -7.11e-14  |g|= 7.6e-11  |ddm|= 3.89e-11
HOMO (B2u) = -0.432278879998036  LUMO (Ag) = -0.106253868674347
cycle= 25 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 5.8e-11  |ddm|= 3.65e-11
HOMO (B2u) = -0.432278879999227  LUMO (Ag) = -0.106253868671491
cycle= 26 E= -75.3755892861055  delta_E= 2.84e-14  |g|= 3.79e-11  |ddm|= 3.59e-11
HOMO (B2u) = -0.432278879998795  LUMO (Ag) = -0.106253868670044
cycle= 27 E= -75.3755892861055  delta_E= -1.42e-14  |g|= 3.16e-11  |ddm|= 1.15e-11
HOMO (B3u) = -0.432278879998264  LUMO (Ag) = -0.106253868668729
cycle= 28 E= -75.3755892861056  delta_E= -4.26e-14  |g|= 2.65e-11  |ddm|= 9.1e-12
HOMO (B3u) = -0.432278879997694  LUMO (Ag) = -0.106253868667471
cycle= 29 E= -75.3755892861055  delta_E= 2.84e-14  |g|= 2.2e-11  |ddm|= 8.28e-12
HOMO (B2u) = -0.432278879997303  LUMO (Ag) = -0.106253868666467
cycle= 30 E= -75.3755892861055  delta_E= 4.26e-14  |g|= 1.82e-11  |ddm|= 7.43e-12
HOMO (B3u) = -0.432278879997037  LUMO (Ag) = -0.106253868665643
cycle= 31 E= -75.3755892861055  delta_E= -4.26e-14  |g|= 1.49e-11  |ddm|= 7.19e-12
HOMO (B2u) = -0.432278879996887  LUMO (Ag) = -0.106253868664932
cycle= 32 E= -75.3755892861056  delta_E= -2.84e-14  |g|= 1.2e-11  |ddm|= 6.91e-12
HOMO (B2u) = -0.432278879996837  LUMO (Ag) = -0.106253868664341
cycle= 33 E= -75.3755892861056  delta_E=    0  |g|= 9.44e-12  |ddm|= 6.15e-12
HOMO (B2u) = -0.432278879997018  LUMO (Ag) = -0.106253868663176
Extra cycle  E= -75.3755892861056  delta_E=    0  |g|= 3.46e-12  |ddm|= 1.6e-11
converged SCF energy = -75.3755892861056

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp882kvsnh
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5487757489254  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5722752896029  dE = -0.023499541  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5857503370594  dE = -0.013475047  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0659  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5940452784948  dE = -0.0082949414  S^2 = 0.0000000
               |grad[o]|=0.0897  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6002049422472  dE = -0.0061596638  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0141  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6050819924673  dE = -0.0048770502  S^2 = 0.0000000
               |grad[o]|=0.0582  |ddm|=0.00893  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6089574830193  dE = -0.0038754906  S^2 = 0.0000000
               |grad[o]|=0.0463  |ddm|=0.00649  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.611939976937  dE = -0.0029824939  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00515  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6140852968682  dE = -0.0021453199  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00446  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6154329692987  dE = -0.0013476724  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6160256604574  dE = -0.00059269116  S^2 = 0.0000000
               |grad[o]|=0.00954  |ddm|=0.00447  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6160629694775  dE = -3.730902e-05  S^2 = 0.0000000
               |grad[o]|=0.00234  |ddm|=0.00498  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6160660554412  dE = -3.0859636e-06  S^2 = 0.0000000
               |grad[o]|=0.000716  |ddm|=0.00145  |maxRot[o]|=0.00665
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6160661048487  dE = -4.9407589e-08  S^2 = 0.0000000
               |grad[o]|=0.000124  |ddm|=0.000549  |maxRot[o]|=0.000717
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6160661059013  dE = -1.0525838e-09  S^2 = 0.0000000
               |grad[o]|=2.01e-05  |ddm|=0.000101  |maxRot[o]|=9.9e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.616066105928  dE = -2.6702196e-11  S^2 = 0.0000000
               |grad[o]|=3.08e-06  |ddm|=1.97e-05  |maxRot[o]|=1.59e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98089624 1.64657025 1.86373136 1.86373183 0.35078066 0.13883179
 0.13883164 0.01662622]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00498   0.00310   0.00000   0.00000  -0.00109
  0 C 2s       0.60537   0.54713  -0.00000   0.00000  -0.36277
  0 C 3s      -0.04187   0.00880  -0.00000  -0.00000  -0.00080
  0 C 2px      0.00000  -0.00000   0.00000   0.70653  -0.00000
  0 C 2py      0.00000  -0.00000   0.70653  -0.00000   0.00000
  0 C 2pz      0.35902  -0.44783   0.00000   0.00000   0.60525
  0 C 3px     -0.00000   0.00000   0.00000   0.00282   0.00000
  0 C 3py     -0.00000   0.00000   0.00282   0.00000   0.00000
  0 C 3pz     -0.04100  -0.00346  -0.00000  -0.00000  -0.04273
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.02846  -0.00000   0.00000
  0 C 3dz^2    0.03432  -0.00016  -0.00000  -0.00000   0.01561
  0 C 3dxz    -0.00000   0.00000   0.00000   0.02846   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00498  -0.00310   0.00000   0.00000  -0.00109
  1 C 2s       0.60537  -0.54713   0.00000   0.00000  -0.36277
  1 C 3s      -0.04187  -0.00880   0.00000   0.00000  -0.00080
  1 C 2px      0.00000  -0.00000  -0.00000   0.70653  -0.00000
  1 C 2py      0.00000  -0.00000   0.70653  -0.00000  -0.00000
  1 C 2pz     -0.35902  -0.44783   0.00000   0.00000  -0.60525
  1 C 3px     -0.00000   0.00000  -0.00000   0.00282   0.00000
  1 C 3py     -0.00000   0.00000   0.00282   0.00000  -0.00000
  1 C 3pz      0.04100  -0.00346  -0.00000  -0.00000   0.04273
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02846  -0.00000   0.00000
  1 C 3dz^2    0.03432   0.00016   0.00000  -0.00000   0.01561
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.02846  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s       0.00000  -0.00000   0.44717
  0 C 3s       0.00000   0.00000  -0.04302
  0 C 2px      0.70642  -0.00000   0.00000
  0 C 2py      0.00000   0.70642   0.00000
  0 C 2pz      0.00000   0.00000   0.54537
  0 C 3px     -0.02076  -0.00000   0.00000
  0 C 3py     -0.00000  -0.02076   0.00000
  0 C 3pz      0.00000   0.00000   0.01534
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02331   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02287
  0 C 3dxz    -0.02331  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000  -0.00000  -0.44717
  1 C 3s      -0.00000  -0.00000   0.04302
  1 C 2px     -0.70642   0.00000  -0.00000
  1 C 2py      0.00000  -0.70642   0.00000
  1 C 2pz      0.00000  -0.00000   0.54537
  1 C 3px      0.02076   0.00000  -0.00000
  1 C 3py     -0.00000   0.02076  -0.00000
  1 C 3pz      0.00000  -0.00000   0.01534
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02331   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02287
  1 C 3dxz    -0.02331  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99344302
<CAS-nat-orb|mo-hf>  4  4    0.99822556
<CAS-nat-orb|mo-hf>  5  5    0.99969500
<CAS-nat-orb|mo-hf>  6  6    0.99969500
<CAS-nat-orb|mo-hf>  7  7    0.97683028
<CAS-nat-orb|mo-hf>  8  8    0.95239324
<CAS-nat-orb|mo-hf>  9  9    0.95239327
<CAS-nat-orb|mo-hf>  10  10    0.55278430
<CAS-nat-orb|mo-hf>  10  17    0.68990824
<CAS-nat-orb|mo-hf>  10  18   -0.43567179
CASSCF energy = -75.616066105928
CASCI E = -75.616066105928  E(CI) = -17.1715111507202  S^2 = 0.0000000
Density matrix diagonal elements [1.98089604 1.64656615 1.86373231 1.86373333 0.35078324 0.1388314
 0.13883134 0.01662619]
i = 1  <i|F|i> = -11.30628331
i = 2  <i|F|i> = -11.30520688
i = 3  <i|F|i> =  -0.97236801
i = 4  <i|F|i> =  -0.45153030
i = 5  <i|F|i> =  -0.37651374
i = 6  <i|F|i> =  -0.37651394
i = 7  <i|F|i> =  -0.11367237
i = 8  <i|F|i> =   0.20431399
i = 9  <i|F|i> =   0.20431398
i = 10  <i|F|i> =   0.83838834
i = 11  <i|F|i> =   0.61779302
i = 12  <i|F|i> =   0.66586231
i = 13  <i|F|i> =   0.66586230
i = 14  <i|F|i> =   0.72640818
i = 15  <i|F|i> =   0.70658964
i = 16  <i|F|i> =   0.70658966
i = 17  <i|F|i> =   0.55528070
i = 18  <i|F|i> =   1.11402349
i = 19  <i|F|i> =   1.25381840
i = 20  <i|F|i> =   1.25381840
i = 21  <i|F|i> =   1.32637002
i = 22  <i|F|i> =   1.32637004
i = 23  <i|F|i> =   1.60396434
i = 24  <i|F|i> =   1.60396434
i = 25  <i|F|i> =   2.00529894
i = 26  <i|F|i> =   2.05827647
i = 27  <i|F|i> =   2.05827646
i = 28  <i|F|i> =   2.22765705
......production of RDMs took       1.83 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.51 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.67 sec

E(WickSCNEVPT2-ijrs) =    -0.00029647948780
E(WickSCNEVPT2- rsi) =    -0.00094679446075
E(WickSCNEVPT2- ijr) =    -0.00041003663008
E(WickSCNEVPT2-  rs) =    -0.03727682085696
E(WickSCNEVPT2-  ij) =    -0.00013528939859
E(WickSCNEVPT2-  ir) =    -0.00124539635236
E(WickSCNEVPT2-   r) =    -0.04650040835179
E(WickSCNEVPT2-   i) =    -0.00027208974069
E(WickSCNEVPT2) = -75.70314942120704  E_corr_pt = -0.08708331527901808
Timings = pdms =   31.46 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.02 | r =    0.55 | i =    0.24
Time cost =    408.461
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:52:30 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.375860748392 AA    0.000000000000   0.000000000000   2.600000000000 Bohr   0.0

nuclear repulsion = 13.8461538461538
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.3]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6149.06


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmplimsinv0
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.278195813693

WARN: Singularity detected in overlap matrix (condition number =  409). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.215477115824915  LUMO (Ag) = -0.172896295276614
cycle= 1 E= -75.3511756370242  delta_E= -0.073  |g|= 0.218  |ddm|= 1.45
HOMO (B2u) = -0.462888168119374  LUMO (Ag) = -0.150366392380425
cycle= 2 E= -75.3684890547635  delta_E= -0.0173  |g|= 0.0521  |ddm|= 0.268
HOMO (B3u) = -0.425477509345155  LUMO (Ag) = -0.107647319512263
cycle= 3 E= -75.369391499486  delta_E= -0.000902  |g|= 0.00999  |ddm|= 0.056
HOMO (B3u) = -0.426482502338422  LUMO (Ag) = -0.105320428216431
cycle= 4 E= -75.3694522894418  delta_E= -6.08e-05  |g|= 0.002  |ddm|= 0.0206
HOMO (B3u) = -0.42725384993031  LUMO (Ag) = -0.105864709294583
cycle= 5 E= -75.3694549331516  delta_E= -2.64e-06  |g|= 0.000217  |ddm|= 0.00651
HOMO (B2u) = -0.42720212896197  LUMO (Ag) = -0.105788865113734
cycle= 6 E= -75.3694549621127  delta_E= -2.9e-08  |g|= 3.29e-05  |ddm|= 0.000392
HOMO (B2u) = -0.427195922281584  LUMO (Ag) = -0.105778621503335
cycle= 7 E= -75.3694549628765  delta_E= -7.64e-10  |g|= 4.04e-06  |ddm|= 0.000193
HOMO (B3u) = -0.427196084833618  LUMO (Ag) = -0.105778048731925
cycle= 8 E= -75.3694549628847  delta_E= -8.19e-12  |g|= 3.71e-07  |ddm|= 2.79e-05
HOMO (B2u) = -0.42719606261592  LUMO (Ag) = -0.105777966012907
cycle= 9 E= -75.3694549628849  delta_E= -1.28e-13  |g|= 1.75e-08  |ddm|= 2.3e-06
HOMO (B2u) = -0.427196058477426  LUMO (Ag) = -0.105777964390644
cycle= 10 E= -75.3694549628848  delta_E= 8.53e-14  |g|= 2.34e-09  |ddm|= 4.88e-08
HOMO (B2u) = -0.427196058523833  LUMO (Ag) = -0.105777964301876
cycle= 11 E= -75.3694549628848  delta_E= -1.42e-14  |g|= 1.37e-09  |ddm|= 2.34e-09
HOMO (B2u) = -0.427196058860427  LUMO (Ag) = -0.105777964639637
cycle= 12 E= -75.3694549628849  delta_E= -7.11e-14  |g|= 1.25e-09  |ddm|= 6.79e-10
HOMO (B2u) = -0.427196058808443  LUMO (Ag) = -0.105777964573545
cycle= 13 E= -75.3694549628848  delta_E= 8.53e-14  |g|= 9.78e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.427196058787183  LUMO (Ag) = -0.105777964525761
cycle= 14 E= -75.3694549628847  delta_E= 7.11e-14  |g|= 8.27e-10  |ddm|= 9.38e-10
HOMO (B2u) = -0.427196058774651  LUMO (Ag) = -0.105777964513349
cycle= 15 E= -75.3694549628848  delta_E= -1.28e-13  |g|= 7.31e-10  |ddm|= 9.09e-10
HOMO (B2u) = -0.427196058780527  LUMO (Ag) = -0.105777964558646
cycle= 16 E= -75.3694549628848  delta_E= 5.68e-14  |g|= 6.83e-10  |ddm|= 1.29e-09
HOMO (B3u) = -0.427196058709288  LUMO (Ag) = -0.105777964511122
cycle= 17 E= -75.3694549628849  delta_E= -9.95e-14  |g|= 7.12e-10  |ddm|= 7e-10
HOMO (B3u) = -0.427196058654946  LUMO (Ag) = -0.105777964391069
cycle= 18 E= -75.3694549628847  delta_E= 1.71e-13  |g|= 2.56e-10  |ddm|= 1.18e-09
HOMO (B3u) = -0.427196058655489  LUMO (Ag) = -0.10577796438474
cycle= 19 E= -75.3694549628847  delta_E= -2.84e-14  |g|= 2.02e-10  |ddm|= 1.61e-10
HOMO (B3u) = -0.42719605865634  LUMO (Ag) = -0.105777964382297
cycle= 20 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 1.73e-10  |ddm|= 1.09e-10
HOMO (B3u) = -0.427196058664212  LUMO (Ag) = -0.105777964386539
cycle= 21 E= -75.3694549628848  delta_E=    0  |g|= 1.42e-10  |ddm|= 1.05e-10
HOMO (B2u) = -0.427196058670139  LUMO (Ag) = -0.105777964389695
cycle= 22 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 1.19e-10  |ddm|= 8.57e-11
HOMO (B3u) = -0.427196058674146  LUMO (Ag) = -0.105777964392352
cycle= 23 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 1e-10  |ddm|= 6.62e-11
HOMO (B3u) = -0.427196058677027  LUMO (Ag) = -0.105777964393746
cycle= 24 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 8.26e-11  |ddm|= 4.79e-11
HOMO (B2u) = -0.427196058679999  LUMO (Ag) = -0.105777964393408
cycle= 25 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 6.3e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.427196058681616  LUMO (Ag) = -0.10577796439101
cycle= 26 E= -75.3694549628848  delta_E=    0  |g|= 4.17e-11  |ddm|= 4.01e-11
HOMO (B3u) = -0.427196058678363  LUMO (Ag) = -0.105777964383468
Extra cycle  E= -75.3694549628848  delta_E= 2.84e-14  |g|= 1.39e-11  |ddm|= 4.99e-11
converged SCF energy = -75.3694549628848

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmplimsinv0
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.544498424191  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5681594686594  dE = -0.023661044  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0785
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5810819888403  dE = -0.01292252  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0676  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5892771745194  dE = -0.0081951857  S^2 = 0.0000000
               |grad[o]|=0.0906  |ddm|=0.0288  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5954033818078  dE = -0.0061262073  S^2 = 0.0000000
               |grad[o]|=0.0731  |ddm|=0.0147  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6002475134268  dE = -0.0048441316  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00955  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6040772524987  dE = -0.0038297391  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.00694  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6070010066268  dE = -0.0029237541  S^2 = 0.0000000
               |grad[o]|=0.0361  |ddm|=0.00545  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6090752023641  dE = -0.0020741957  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00465  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6103412344163  dE = -0.0012660321  S^2 = 0.0000000
               |grad[o]|=0.0172  |ddm|=0.00445  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6107871865149  dE = -0.0004459521  S^2 = 0.0000000
               |grad[o]|=0.00888  |ddm|=0.00473  |maxRot[o]|= 0.06
macro iter 11 (4 JK  0 micro), CASSCF E = -75.610858591358  dE = -7.1404843e-05  S^2 = 0.0000000
               |grad[o]|=0.00316  |ddm|=0.00398  |maxRot[o]|=0.0329
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6108594686037  dE = -8.7724572e-07  S^2 = 0.0000000
               |grad[o]|=0.0005  |ddm|=0.00241  |maxRot[o]|=0.00309
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6108594862082  dE = -1.7604464e-08  S^2 = 0.0000000
               |grad[o]|=7.67e-05  |ddm|=0.000366  |maxRot[o]|=0.000384
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6108594866081  dE = -3.9992187e-10  S^2 = 0.0000000
               |grad[o]|=1.26e-05  |ddm|=6.64e-05  |maxRot[o]|=6.02e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6108594866192  dE = -1.1127099e-11  S^2 = 0.0000000
               |grad[o]|=2.08e-06  |ddm|=1.32e-05  |maxRot[o]|=1.01e-05
2-step CASSCF converged in 15 macro (74 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98003344 1.65708287 1.85598498 1.85598555 0.341134   0.14614874
 0.14614893 0.01748149]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00530   0.00319   0.00000   0.00000  -0.00104
  0 C 2s       0.60847   0.55448  -0.00000  -0.00000  -0.35767
  0 C 3s      -0.03996   0.00882  -0.00000  -0.00000   0.00198
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655  -0.00000
  0 C 2py     -0.00000   0.00000   0.70655  -0.00000   0.00000
  0 C 2pz      0.35425  -0.43870  -0.00000  -0.00000   0.60822
  0 C 3px     -0.00000  -0.00000   0.00000   0.00558  -0.00000
  0 C 3py     -0.00000   0.00000   0.00558   0.00000   0.00000
  0 C 3pz     -0.03931  -0.00314  -0.00000  -0.00000  -0.04299
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02761   0.00000   0.00000
  0 C 3dz^2    0.03326  -0.00060  -0.00000  -0.00000   0.01688
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02761  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00530  -0.00319   0.00000   0.00000  -0.00104
  1 C 2s       0.60847  -0.55448   0.00000  -0.00000  -0.35767
  1 C 3s      -0.03996  -0.00882   0.00000   0.00000   0.00198
  1 C 2px     -0.00000   0.00000  -0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000  -0.00000
  1 C 2pz     -0.35425  -0.43870  -0.00000   0.00000  -0.60822
  1 C 3px      0.00000   0.00000   0.00000   0.00558   0.00000
  1 C 3py      0.00000  -0.00000   0.00558   0.00000  -0.00000
  1 C 3pz      0.03931  -0.00314  -0.00000  -0.00000   0.04299
  1 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02761  -0.00000   0.00000
  1 C 3dz^2    0.03326   0.00060   0.00000   0.00000   0.01688
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02761  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00051
  0 C 2s      -0.00000  -0.00000   0.43805
  0 C 3s      -0.00000  -0.00000  -0.04314
  0 C 2px      0.70645   0.00000   0.00000
  0 C 2py      0.00000   0.70645  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55270
  0 C 3px     -0.01985   0.00000   0.00000
  0 C 3py      0.00000  -0.01985  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01664
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02315  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02225
  0 C 3dxz    -0.02315   0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00051
  1 C 2s      -0.00000   0.00000  -0.43805
  1 C 3s       0.00000   0.00000   0.04314
  1 C 2px     -0.70645  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70645   0.00000
  1 C 2pz      0.00000  -0.00000   0.55270
  1 C 3px      0.01985  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01985   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01664
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02315  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02225
  1 C 3dxz    -0.02315   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99314132
<CAS-nat-orb|mo-hf>  4  4    0.99812795
<CAS-nat-orb|mo-hf>  5  5    0.99966602
<CAS-nat-orb|mo-hf>  6  6    0.99966602
<CAS-nat-orb|mo-hf>  7  7    0.97631889
<CAS-nat-orb|mo-hf>  8  8    0.95579302
<CAS-nat-orb|mo-hf>  9  9    0.95579308
<CAS-nat-orb|mo-hf>  10  10    0.57545984
<CAS-nat-orb|mo-hf>  10  17    0.69042018
<CAS-nat-orb|mo-hf>  10  18   -0.40995044
CASSCF energy = -75.6108594866192
CASCI E = -75.6108594866192  E(CI) = -17.0456439489907  S^2 = 0.0000000
Density matrix diagonal elements [1.9800333  1.65707948 1.85598587 1.85598589 0.34113618 0.14614913
 0.14614866 0.01748149]
i = 1  <i|F|i> = -11.31106939
i = 2  <i|F|i> = -11.31019888
i = 3  <i|F|i> =  -0.96268438
i = 4  <i|F|i> =  -0.45841239
i = 5  <i|F|i> =  -0.37041883
i = 6  <i|F|i> =  -0.37041885
i = 7  <i|F|i> =  -0.11158762
i = 8  <i|F|i> =   0.19163141
i = 9  <i|F|i> =   0.19163143
i = 10  <i|F|i> =   0.79754337
i = 11  <i|F|i> =   0.62262630
i = 12  <i|F|i> =   0.66936345
i = 13  <i|F|i> =   0.66936346
i = 14  <i|F|i> =   0.72582856
i = 15  <i|F|i> =   0.70705630
i = 16  <i|F|i> =   0.70705637
i = 17  <i|F|i> =   0.55625431
i = 18  <i|F|i> =   1.10800061
i = 19  <i|F|i> =   1.25778679
i = 20  <i|F|i> =   1.25778679
i = 21  <i|F|i> =   1.31172733
i = 22  <i|F|i> =   1.31172733
i = 23  <i|F|i> =   1.59396869
i = 24  <i|F|i> =   1.59396869
i = 25  <i|F|i> =   1.98602297
i = 26  <i|F|i> =   2.04215573
i = 27  <i|F|i> =   2.04215573
i = 28  <i|F|i> =   2.20477071
......production of RDMs took       1.83 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.22 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickSCNEVPT2-ijrs) =    -0.00029173755892
E(WickSCNEVPT2- rsi) =    -0.00093176299731
E(WickSCNEVPT2- ijr) =    -0.00040325594241
E(WickSCNEVPT2-  rs) =    -0.03684192395230
E(WickSCNEVPT2-  ij) =    -0.00012995489446
E(WickSCNEVPT2-  ir) =    -0.00122852879867
E(WickSCNEVPT2-   r) =    -0.04729382441183
E(WickSCNEVPT2-   i) =    -0.00026621131501
E(WickSCNEVPT2) = -75.69824668649014  E_corr_pt = -0.08738719987091301
Timings = pdms =   31.28 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.03 | r =    0.62 | i =    0.26
Time cost =    164.867
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:55:14 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.402319608938 AA    0.000000000000   0.000000000000   2.650000000000 Bohr   0.0

nuclear repulsion = 13.5849056603774
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.325]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6259.73


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpnt03_pww
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.2354639903452

WARN: Singularity detected in overlap matrix (condition number =  377). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.207229697178327  LUMO (Ag) = -0.170529385107337
cycle= 1 E= -75.3434515147689  delta_E= -0.108  |g|= 0.222  |ddm|= 1.45
HOMO (B3u) = -0.458125308046681  LUMO (Ag) = -0.151008288235489
cycle= 2 E= -75.3614525114845  delta_E= -0.018  |g|= 0.052  |ddm|= 0.276
HOMO (B3u) = -0.42057604488248  LUMO (Ag) = -0.107310756967325
cycle= 3 E= -75.3623762459038  delta_E= -0.000924  |g|= 0.0104  |ddm|= 0.0554
HOMO (B3u) = -0.421573778613678  LUMO (Ag) = -0.104704594692274
cycle= 4 E= -75.3624425687673  delta_E= -6.63e-05  |g|= 0.00208  |ddm|= 0.019
HOMO (B3u) = -0.422353066342066  LUMO (Ag) = -0.10523294916925
cycle= 5 E= -75.3624454885392  delta_E= -2.92e-06  |g|= 0.000251  |ddm|= 0.00568
HOMO (B2u) = -0.422292447876754  LUMO (Ag) = -0.105149049472674
cycle= 6 E= -75.3624455277622  delta_E= -3.92e-08  |g|= 3.5e-05  |ddm|= 0.000464
HOMO (B3u) = -0.422285778696182  LUMO (Ag) = -0.10513817366153
cycle= 7 E= -75.362445528617  delta_E= -8.55e-10  |g|= 4.37e-06  |ddm|= 0.0002
HOMO (B3u) = -0.422285894464519  LUMO (Ag) = -0.105137535804936
cycle= 8 E= -75.3624455286267  delta_E= -9.75e-12  |g|= 3.96e-07  |ddm|= 2.7e-05
HOMO (B2u) = -0.42228586876127  LUMO (Ag) = -0.105137442523049
cycle= 9 E= -75.3624455286267  delta_E=    0  |g|= 1.83e-08  |ddm|= 2.34e-06
HOMO (B3u) = -0.422285864047109  LUMO (Ag) = -0.105137442034635
cycle= 10 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 2.5e-09  |ddm|= 5.4e-08
HOMO (B2u) = -0.422285864208526  LUMO (Ag) = -0.105137442035481
cycle= 11 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 1.63e-09  |ddm|= 2.05e-09
HOMO (B2u) = -0.422285864471735  LUMO (Ag) = -0.105137442316619
cycle= 12 E= -75.3624455286267  delta_E= 7.11e-14  |g|= 1.38e-09  |ddm|= 8.32e-10
HOMO (B3u) = -0.422285864409205  LUMO (Ag) = -0.105137442235419
cycle= 13 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 1.09e-09  |ddm|= 1.12e-09
HOMO (B3u) = -0.422285864387832  LUMO (Ag) = -0.105137442189873
cycle= 14 E= -75.3624455286268  delta_E= 1.42e-14  |g|= 9.02e-10  |ddm|= 1.06e-09
HOMO (B3u) = -0.422285864372563  LUMO (Ag) = -0.105137442174114
cycle= 15 E= -75.3624455286267  delta_E= 4.26e-14  |g|= 7.9e-10  |ddm|= 8.83e-10
HOMO (B3u) = -0.422285864377231  LUMO (Ag) = -0.105137442219402
cycle= 16 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 7.38e-10  |ddm|= 1.3e-09
HOMO (B3u) = -0.422285864307914  LUMO (Ag) = -0.105137442168215
cycle= 17 E= -75.3624455286268  delta_E=    0  |g|= 7.58e-10  |ddm|= 5.5e-10
HOMO (B3u) = -0.422285864233419  LUMO (Ag) = -0.105137442035455
cycle= 18 E= -75.3624455286268  delta_E= -2.84e-14  |g|= 2.86e-10  |ddm|= 1.32e-09
HOMO (B3u) = -0.422285864234655  LUMO (Ag) = -0.105137442029412
cycle= 19 E= -75.3624455286267  delta_E= 8.53e-14  |g|= 2.28e-10  |ddm|= 1.9e-10
HOMO (B3u) = -0.422285864239228  LUMO (Ag) = -0.105137442029795
cycle= 20 E= -75.3624455286267  delta_E= 5.68e-14  |g|= 1.9e-10  |ddm|= 1.38e-10
HOMO (B3u) = -0.422285864248184  LUMO (Ag) = -0.105137442034869
cycle= 21 E= -75.3624455286268  delta_E= -8.53e-14  |g|= 1.56e-10  |ddm|= 1.19e-10
HOMO (B3u) = -0.422285864254724  LUMO (Ag) = -0.105137442038627
cycle= 22 E= -75.3624455286267  delta_E= 2.84e-14  |g|= 1.3e-10  |ddm|= 9.7e-11
HOMO (B3u) = -0.42228586425942  LUMO (Ag) = -0.105137442041842
cycle= 23 E= -75.3624455286268  delta_E= -4.26e-14  |g|= 1.08e-10  |ddm|= 7.55e-11
HOMO (B3u) = -0.422285864262946  LUMO (Ag) = -0.105137442043839
cycle= 24 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 8.91e-11  |ddm|= 5.7e-11
HOMO (B3u) = -0.422285864266428  LUMO (Ag) = -0.105137442043984
cycle= 25 E= -75.3624455286267  delta_E= 8.53e-14  |g|= 6.83e-11  |ddm|= 4.04e-11
HOMO (B3u) = -0.422285864268386  LUMO (Ag) = -0.105137442042084
cycle= 26 E= -75.3624455286267  delta_E= -2.84e-14  |g|= 4.58e-11  |ddm|= 4.51e-11
HOMO (B3u) = -0.422285864267599  LUMO (Ag) = -0.105137442040159
cycle= 27 E= -75.3624455286266  delta_E= 9.95e-14  |g|= 3.77e-11  |ddm|= 1.56e-11
HOMO (B2u) = -0.422285864266727  LUMO (Ag) = -0.105137442038417
cycle= 28 E= -75.3624455286267  delta_E= -4.26e-14  |g|= 3.13e-11  |ddm|= 1.21e-11
HOMO (B2u) = -0.422285864265949  LUMO (Ag) = -0.10513744203688
cycle= 29 E= -75.3624455286268  delta_E= -8.53e-14  |g|= 2.57e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.422285864265418  LUMO (Ag) = -0.105137442035685
cycle= 30 E= -75.3624455286268  delta_E=    0  |g|= 2.12e-11  |ddm|= 8.38e-12
HOMO (B2u) = -0.422285864264924  LUMO (Ag) = -0.105137442032741
Extra cycle  E= -75.3624455286268  delta_E= -2.84e-14  |g|= 7.33e-12  |ddm|= 2.76e-11
converged SCF energy = -75.3624455286268

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpnt03_pww
max_memory 4000 MB (current use 363 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.539390602364  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5630104601594  dE = -0.023619858  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0764
macro iter 2 (6 JK  0 micro), CASSCF E = -75.575566172623  dE = -0.012555712  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0687  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5837036694585  dE = -0.0081374968  S^2 = 0.0000000
               |grad[o]|=0.0914  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.589808085285  dE = -0.0061044158  S^2 = 0.0000000
               |grad[o]|=0.0739  |ddm|=0.0154  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5946166481776  dE = -0.0048085629  S^2 = 0.0000000
               |grad[o]|=0.0596  |ddm|=0.0101  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5983876151665  dE = -0.003770967  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00736  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6012309234098  dE = -0.0028433082  S^2 = 0.0000000
               |grad[o]|=0.036  |ddm|=0.00571  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6032054515105  dE = -0.0019745281  S^2 = 0.0000000
               |grad[o]|=0.0259  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043561327573  dE = -0.0011506812  S^2 = 0.0000000
               |grad[o]|=0.0165  |ddm|=0.00467  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6047080782075  dE = -0.00035194545  S^2 = 0.0000000
               |grad[o]|=0.00777  |ddm|=0.00509  |maxRot[o]|= 0.06
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6047337091184  dE = -2.5630911e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00437  |maxRot[o]|=0.0194
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6047340656798  dE = -3.5656142e-07  S^2 = 0.0000000
               |grad[o]|=0.000329  |ddm|=0.0016  |maxRot[o]|=0.00185
macro iter 13 (3 JK  0 micro), CASSCF E = -75.604734072753  dE = -7.0732113e-09  S^2 = 0.0000000
               |grad[o]|=5.38e-05  |ddm|=0.000237  |maxRot[o]|=0.00024
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6047340729174  dE = -1.6436275e-10  S^2 = 0.0000000
               |grad[o]|=7.44e-06  |ddm|=3.84e-05  |maxRot[o]|=3.68e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6047340729273  dE = -9.9618092e-12  S^2 = 0.0000000
               |grad[o]|=2.27e-06  |ddm|=1.32e-05  |maxRot[o]|=6.59e-06
2-step CASSCF converged in 15 macro (74 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97916617 1.66712587 1.84789479 1.84789575 0.33219718 0.15368589
 0.15368596 0.01834841]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00560   0.00327   0.00000   0.00000  -0.00099
  0 C 2s       0.61156   0.56162   0.00000  -0.00000  -0.35247
  0 C 3s      -0.03803   0.00886   0.00000  -0.00000   0.00469
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py     -0.00000   0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34937  -0.42951  -0.00000  -0.00000   0.61119
  0 C 3px     -0.00000   0.00000  -0.00000   0.00818   0.00000
  0 C 3py     -0.00000   0.00000   0.00818  -0.00000  -0.00000
  0 C 3pz     -0.03762  -0.00286   0.00000  -0.00000  -0.04310
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.02675  -0.00000  -0.00000
  0 C 3dz^2    0.03225  -0.00101   0.00000  -0.00000   0.01829
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02675   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00560  -0.00327   0.00000   0.00000  -0.00099
  1 C 2s       0.61156  -0.56162  -0.00000   0.00000  -0.35247
  1 C 3s      -0.03803  -0.00886  -0.00000   0.00000   0.00469
  1 C 2px      0.00000  -0.00000   0.00000   0.70655  -0.00000
  1 C 2py     -0.00000  -0.00000   0.70655   0.00000   0.00000
  1 C 2pz     -0.34937  -0.42951  -0.00000  -0.00000  -0.61119
  1 C 3px      0.00000   0.00000   0.00000   0.00818  -0.00000
  1 C 3py      0.00000  -0.00000   0.00818  -0.00000   0.00000
  1 C 3pz      0.03762  -0.00286   0.00000  -0.00000   0.04310
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02675  -0.00000  -0.00000
  1 C 3dz^2    0.03225   0.00101   0.00000   0.00000   0.01829
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02675   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00047
  0 C 2s      -0.00000   0.00000   0.42887
  0 C 3s       0.00000   0.00000  -0.04326
  0 C 2px      0.70648   0.00000  -0.00000
  0 C 2py     -0.00000   0.70648  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55983
  0 C 3px     -0.01896   0.00000   0.00000
  0 C 3py      0.00000  -0.01896  -0.00000
  0 C 3pz      0.00000   0.00000   0.01780
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02297  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02181
  0 C 3dxz    -0.02297   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00047
  1 C 2s      -0.00000  -0.00000  -0.42887
  1 C 3s      -0.00000  -0.00000   0.04326
  1 C 2px     -0.70648  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70648   0.00000
  1 C 2pz      0.00000  -0.00000   0.55983
  1 C 3px      0.01896  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01896   0.00000
  1 C 3pz     -0.00000   0.00000   0.01780
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02297  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02181
  1 C 3dxz    -0.02297   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99284124
<CAS-nat-orb|mo-hf>  4  4    0.99802529
<CAS-nat-orb|mo-hf>  5  5    0.99963455
<CAS-nat-orb|mo-hf>  6  6    0.99963455
<CAS-nat-orb|mo-hf>  7  7    0.97582852
<CAS-nat-orb|mo-hf>  8  8    0.95889489
<CAS-nat-orb|mo-hf>  9  9    0.95889494
<CAS-nat-orb|mo-hf>  10  10    0.59917818
<CAS-nat-orb|mo-hf>  10  17    0.68689328
CASSCF energy = -75.6047340729273
CASCI E = -75.6047340729273  E(CI) = -16.9234139258866  S^2 = 0.0000000
Density matrix diagonal elements [1.97916623 1.66712542 1.84789496 1.84789563 0.33219768 0.15368589
 0.15368578 0.0183484 ]
i = 1  <i|F|i> = -11.31561684
i = 2  <i|F|i> = -11.31492363
i = 3  <i|F|i> =  -0.95315835
i = 4  <i|F|i> =  -0.46518657
i = 5  <i|F|i> =  -0.36445882
i = 6  <i|F|i> =  -0.36445896
i = 7  <i|F|i> =  -0.10948217
i = 8  <i|F|i> =   0.17946062
i = 9  <i|F|i> =   0.17946058
i = 10  <i|F|i> =   0.75886410
i = 11  <i|F|i> =   0.62726844
i = 12  <i|F|i> =   0.67260287
i = 13  <i|F|i> =   0.67260287
i = 14  <i|F|i> =   0.72571234
i = 15  <i|F|i> =   0.70749333
i = 16  <i|F|i> =   0.70749339
i = 17  <i|F|i> =   0.55747284
i = 18  <i|F|i> =   1.10213708
i = 19  <i|F|i> =   1.26190427
i = 20  <i|F|i> =   1.26190427
i = 21  <i|F|i> =   1.29792540
i = 22  <i|F|i> =   1.29792541
i = 23  <i|F|i> =   1.58427958
i = 24  <i|F|i> =   1.58427958
i = 25  <i|F|i> =   1.96497623
i = 26  <i|F|i> =   2.02600909
i = 27  <i|F|i> =   2.02600908
i = 28  <i|F|i> =   2.18540077
......production of RDMs took       2.94 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.46 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickSCNEVPT2-ijrs) =    -0.00028781357563
E(WickSCNEVPT2- rsi) =    -0.00091833286016
E(WickSCNEVPT2- ijr) =    -0.00039654274524
E(WickSCNEVPT2-  rs) =    -0.03640633393707
E(WickSCNEVPT2-  ij) =    -0.00012464582966
E(WickSCNEVPT2-  ir) =    -0.00121227024586
E(WickSCNEVPT2-   r) =    -0.04809541768095
E(WickSCNEVPT2-   i) =    -0.00026036018989
E(WickSCNEVPT2) = -75.69243578999178  E_corr_pt = -0.08770171706446206
Timings = pdms =   33.55 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.56 | i =    0.25
Time cost =    134.351
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:57:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.428778469484 AA    0.000000000000   0.000000000000   2.700000000000 Bohr   0.0

nuclear repulsion = 13.3333333333333
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.35]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6457.33


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpx7m_cvta
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1946578857085

WARN: Singularity detected in overlap matrix (condition number =  348). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.199413840928996  LUMO (Ag) = -0.168263344015824
cycle= 1 E= -75.3350369843805  delta_E= -0.14  |g|= 0.225  |ddm|= 1.44
HOMO (B3u) = -0.453464888109062  LUMO (Ag) = -0.151390240663931
cycle= 2 E= -75.3537139122306  delta_E= -0.0187  |g|= 0.0519  |ddm|= 0.284
HOMO (B2u) = -0.415801083744366  LUMO (Ag) = -0.106751931948702
cycle= 3 E= -75.3546580860938  delta_E= -0.000944  |g|= 0.0108  |ddm|= 0.0549
HOMO (B2u) = -0.416822160762626  LUMO (Ag) = -0.103915433790313
cycle= 4 E= -75.3547306562047  delta_E= -7.26e-05  |g|= 0.00215  |ddm|= 0.0177
HOMO (B3u) = -0.417607675822702  LUMO (Ag) = -0.104440258456577
cycle= 5 E= -75.3547338450163  delta_E= -3.19e-06  |g|= 0.000277  |ddm|= 0.00497
HOMO (B2u) = -0.417541021758629  LUMO (Ag) = -0.104353293703205
cycle= 6 E= -75.3547338927567  delta_E= -4.77e-08  |g|= 3.68e-05  |ddm|= 0.000534
HOMO (B3u) = -0.417533919980039  LUMO (Ag) = -0.104341804406658
cycle= 7 E= -75.3547338936913  delta_E= -9.35e-10  |g|= 4.65e-06  |ddm|= 0.000197
HOMO (B3u) = -0.417533963921613  LUMO (Ag) = -0.104341084871144
cycle= 8 E= -75.3547338937025  delta_E= -1.11e-11  |g|= 4.19e-07  |ddm|= 2.62e-05
HOMO (B2u) = -0.417533935669133  LUMO (Ag) = -0.104340979663041
cycle= 9 E= -75.3547338937026  delta_E= -7.11e-14  |g|= 1.9e-08  |ddm|= 2.29e-06
HOMO (B2u) = -0.417533930414546  LUMO (Ag) = -0.104340980550984
cycle= 10 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 2.65e-09  |ddm|= 5.91e-08
HOMO (B2u) = -0.417533930818935  LUMO (Ag) = -0.104340980809838
cycle= 11 E= -75.3547338937025  delta_E= 4.26e-14  |g|= 1.98e-09  |ddm|= 1.67e-09
HOMO (B3u) = -0.417533930878076  LUMO (Ag) = -0.104340980872225
cycle= 12 E= -75.3547338937026  delta_E= -8.53e-14  |g|= 1.51e-09  |ddm|= 1.83e-09
HOMO (B2u) = -0.417533930823848  LUMO (Ag) = -0.104340980789429
cycle= 13 E= -75.3547338937026  delta_E= 4.26e-14  |g|= 1.19e-09  |ddm|= 1.39e-09
HOMO (B3u) = -0.417533930795114  LUMO (Ag) = -0.104340980739918
cycle= 14 E= -75.3547338937025  delta_E= 4.26e-14  |g|= 9.85e-10  |ddm|= 1.04e-09
HOMO (B3u) = -0.417533930775157  LUMO (Ag) = -0.104340980717903
cycle= 15 E= -75.3547338937025  delta_E= 2.84e-14  |g|= 8.54e-10  |ddm|= 7.7e-10
HOMO (B2u) = -0.417533930785127  LUMO (Ag) = -0.104340980767775
cycle= 16 E= -75.3547338937026  delta_E= -7.11e-14  |g|= 7.88e-10  |ddm|= 1.38e-09
HOMO (B3u) = -0.417533930718228  LUMO (Ag) = -0.104340980715597
cycle= 17 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 8.02e-10  |ddm|= 3.93e-10
HOMO (B3u) = -0.417533930624293  LUMO (Ag) = -0.104340980573338
cycle= 18 E= -75.3547338937026  delta_E=    0  |g|= 3.17e-10  |ddm|= 1.48e-09
HOMO (B3u) = -0.417533930625966  LUMO (Ag) = -0.104340980567532
cycle= 19 E= -75.3547338937026  delta_E= 2.84e-14  |g|= 2.57e-10  |ddm|= 2.19e-10
HOMO (B2u) = -0.417533930636341  LUMO (Ag) = -0.104340980572464
cycle= 20 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 2.06e-10  |ddm|= 1.72e-10
HOMO (B2u) = -0.417533930645953  LUMO (Ag) = -0.104340980578023
cycle= 21 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 1.69e-10  |ddm|= 1.34e-10
HOMO (B2u) = -0.417533930652994  LUMO (Ag) = -0.104340980582366
cycle= 22 E= -75.3547338937026  delta_E= 5.68e-14  |g|= 1.4e-10  |ddm|= 1.06e-10
HOMO (B3u) = -0.417533930658133  LUMO (Ag) = -0.104340980586006
cycle= 23 E= -75.3547338937026  delta_E= 1.42e-14  |g|= 1.16e-10  |ddm|= 8.49e-11
HOMO (B3u) = -0.41753393066211  LUMO (Ag) = -0.104340980588592
cycle= 24 E= -75.3547338937026  delta_E= -4.26e-14  |g|= 9.51e-11  |ddm|= 6.87e-11
HOMO (B2u) = -0.417533930666024  LUMO (Ag) = -0.104340980589369
cycle= 25 E= -75.3547338937025  delta_E= 8.53e-14  |g|= 7.33e-11  |ddm|= 4.61e-11
HOMO (B2u) = -0.41753393066829  LUMO (Ag) = -0.104340980588074
cycle= 26 E= -75.3547338937025  delta_E= 2.84e-14  |g|= 4.98e-11  |ddm|= 5.07e-11
HOMO (B3u) = -0.417533930667262  LUMO (Ag) = -0.104340980585873
cycle= 27 E= -75.3547338937026  delta_E= -1.14e-13  |g|= 4.08e-11  |ddm|= 1.82e-11
HOMO (B3u) = -0.41753393066614  LUMO (Ag) = -0.10434098058385
cycle= 28 E= -75.3547338937025  delta_E= 9.95e-14  |g|= 3.34e-11  |ddm|= 1.41e-11
HOMO (B3u) = -0.417533930665295  LUMO (Ag) = -0.104340980582257
cycle= 29 E= -75.3547338937024  delta_E= 5.68e-14  |g|= 2.74e-11  |ddm|= 1.12e-11
HOMO (B3u) = -0.417533930664706  LUMO (Ag) = -0.104340980581029
cycle= 30 E= -75.3547338937025  delta_E= -5.68e-14  |g|= 2.24e-11  |ddm|= 9.1e-12
HOMO (B2u) = -0.417533930664309  LUMO (Ag) = -0.104340980580057
cycle= 31 E= -75.3547338937026  delta_E= -9.95e-14  |g|= 1.82e-11  |ddm|= 7.69e-12
HOMO (B3u) = -0.417533930664071  LUMO (Ag) = -0.104340980579262
cycle= 32 E= -75.3547338937026  delta_E= 2.84e-14  |g|= 1.46e-11  |ddm|= 6.77e-12
HOMO (B3u) = -0.417533930663963  LUMO (Ag) = -0.104340980578617
cycle= 33 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 1.15e-11  |ddm|= 6.03e-12
HOMO (B3u) = -0.417533930663979  LUMO (Ag) = -0.104340980578199
cycle= 34 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 9.09e-12  |ddm|= 4.79e-12
HOMO (B3u) = -0.417533930664057  LUMO (Ag) = -0.104340980577977
cycle= 35 E= -75.3547338937025  delta_E= 9.95e-14  |g|= 7.48e-12  |ddm|= 3.52e-12
HOMO (B3u) = -0.417533930664104  LUMO (Ag) = -0.104340980577773
cycle= 36 E= -75.3547338937026  delta_E= -1.14e-13  |g|= 6.14e-12  |ddm|= 3.05e-12
HOMO (B3u) = -0.417533930664121  LUMO (Ag) = -0.104340980577579
cycle= 37 E= -75.3547338937026  delta_E= 1.42e-14  |g|= 5.03e-12  |ddm|= 2.65e-12
HOMO (B3u) = -0.417533930664118  LUMO (Ag) = -0.104340980577397
cycle= 38 E= -75.3547338937026  delta_E= 1.42e-14  |g|= 4.1e-12  |ddm|= 2.3e-12
HOMO (B3u) = -0.417533930664104  LUMO (Ag) = -0.10434098057723
cycle= 39 E= -75.3547338937026  delta_E= 1.42e-14  |g|= 3.34e-12  |ddm|= 1.96e-12
HOMO (B3u) = -0.417533930664084  LUMO (Ag) = -0.10434098057708
cycle= 40 E= -75.3547338937025  delta_E= 4.26e-14  |g|= 2.72e-12  |ddm|= 1.69e-12
HOMO (B3u) = -0.417533930664063  LUMO (Ag) = -0.104340980576953
cycle= 41 E= -75.3547338937026  delta_E= -4.26e-14  |g|= 2.21e-12  |ddm|= 1.38e-12
HOMO (B3u) = -0.417533930664043  LUMO (Ag) = -0.104340980576847
cycle= 42 E= -75.3547338937025  delta_E= 7.11e-14  |g|= 1.81e-12  |ddm|= 1.18e-12
HOMO (B2u) = -0.417533930664026  LUMO (Ag) = -0.104340980576761
cycle= 43 E= -75.3547338937026  delta_E= -8.53e-14  |g|= 1.49e-12  |ddm|= 9.32e-13
HOMO (B3u) = -0.417533930664015  LUMO (Ag) = -0.104340980576691
cycle= 44 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 1.23e-12  |ddm|= 8.36e-13
HOMO (B3u) = -0.417533930664008  LUMO (Ag) = -0.104340980576634
cycle= 45 E= -75.3547338937026  delta_E= -4.26e-14  |g|= 1.01e-12  |ddm|= 6.57e-13
HOMO (B2u) = -0.417533930664004  LUMO (Ag) = -0.104340980576588
cycle= 46 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 8.29e-13  |ddm|= 5.67e-13
HOMO (B3u) = -0.417533930664001  LUMO (Ag) = -0.104340980576549
cycle= 47 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 6.85e-13  |ddm|= 4.51e-13
HOMO (B3u) = -0.417533930663999  LUMO (Ag) = -0.104340980576519
cycle= 48 E= -75.3547338937026  delta_E= 2.84e-14  |g|= 5.64e-13  |ddm|= 4.11e-13
HOMO (B2u) = -0.417533930663997  LUMO (Ag) = -0.104340980576492
cycle= 49 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 4.66e-13  |ddm|= 3.48e-13
HOMO (B2u) = -0.417533930663996  LUMO (Ag) = -0.104340980576471
cycle= 50 E= -75.3547338937026  delta_E= 2.84e-14  |g|= 3.83e-13  |ddm|= 2.46e-13
SCF not converged.
SCF energy = -75.3547338937026

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpx7m_cvta
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5336329215184  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5570298593017  dE = -0.023396938  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0768
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5693666525341  dE = -0.012336793  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0694  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5774849618822  dE = -0.0081183093  S^2 = 0.0000000
               |grad[o]|=0.0922  |ddm|=0.0294  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5835779169644  dE = -0.0060929551  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0162  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5883468964724  dE = -0.0047689795  S^2 = 0.0000000
               |grad[o]|=0.0599  |ddm|=0.0107  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5920450999812  dE = -0.0036982035  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00775  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5947857838679  dE = -0.0027406839  S^2 = 0.0000000
               |grad[o]|=0.0356  |ddm|=0.00594  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5966321676907  dE = -0.0018463838  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00502  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5976345635036  dE = -0.0010023958  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00495  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5978367086502  dE = -0.00020214515  S^2 = 0.0000000
               |grad[o]|=0.00622  |ddm|=0.00558  |maxRot[o]|= 0.04
macro iter 11 (3 JK  0 micro), CASSCF E = -75.597867096195  dE = -3.0387545e-05  S^2 = 0.0000000
               |grad[o]|=0.00217  |ddm|=0.00321  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5978677929632  dE = -6.967682e-07  S^2 = 0.0000000
               |grad[o]|=0.000398  |ddm|=0.00173  |maxRot[o]|=0.00283
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5978678057743  dE = -1.28111e-08  S^2 = 0.0000000
               |grad[o]|=6.59e-05  |ddm|=0.000311  |maxRot[o]|=0.000323
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5978678060433  dE = -2.690399e-10  S^2 = 0.0000000
               |grad[o]|=1.02e-05  |ddm|=4.86e-05  |maxRot[o]|=4.75e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5978678060503  dE = -7.0343731e-12  S^2 = 0.0000000
               |grad[o]|=1.58e-06  |ddm|=8.75e-06  |maxRot[o]|=7.7e-06
2-step CASSCF converged in 15 macro (72 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97829963 1.67678201 1.83943573 1.83943619 0.32392972 0.16144632
 0.16144639 0.01922401]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00588   0.00336   0.00000   0.00000  -0.00095
  0 C 2s       0.61465   0.56857  -0.00000  -0.00000  -0.34718
  0 C 3s      -0.03607   0.00891  -0.00000   0.00000   0.00734
  0 C 2px      0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py      0.00000  -0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34438  -0.42027   0.00000   0.00000   0.61414
  0 C 3px      0.00000   0.00000  -0.00000   0.01064   0.00000
  0 C 3py      0.00000  -0.00000   0.01064   0.00000  -0.00000
  0 C 3pz     -0.03594  -0.00262  -0.00000   0.00000  -0.04307
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.02590   0.00000  -0.00000
  0 C 3dz^2    0.03130  -0.00139  -0.00000   0.00000   0.01982
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02590   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00588  -0.00336   0.00000   0.00000  -0.00095
  1 C 2s       0.61465  -0.56857   0.00000  -0.00000  -0.34718
  1 C 3s      -0.03607  -0.00891   0.00000  -0.00000   0.00734
  1 C 2px      0.00000  -0.00000   0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000   0.00000
  1 C 2pz     -0.34438  -0.42027   0.00000   0.00000  -0.61414
  1 C 3px     -0.00000   0.00000   0.00000   0.01064  -0.00000
  1 C 3py     -0.00000   0.00000   0.01064  -0.00000   0.00000
  1 C 3pz      0.03594  -0.00262  -0.00000   0.00000   0.04307
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02590   0.00000  -0.00000
  1 C 3dz^2    0.03130   0.00139   0.00000  -0.00000   0.01982
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02590   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00044
  0 C 2s      -0.00000  -0.00000   0.41964
  0 C 3s       0.00000  -0.00000  -0.04337
  0 C 2px      0.70651  -0.00000   0.00000
  0 C 2py     -0.00000   0.70651  -0.00000
  0 C 2pz      0.00000  -0.00000   0.56675
  0 C 3px     -0.01810  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01810  -0.00000
  0 C 3pz      0.00000  -0.00000   0.01881
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02276  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02148
  0 C 3dxz    -0.02276  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00044
  1 C 2s      -0.00000   0.00000  -0.41964
  1 C 3s      -0.00000   0.00000   0.04337
  1 C 2px     -0.70651   0.00000   0.00000
  1 C 2py      0.00000  -0.70651   0.00000
  1 C 2pz     -0.00000   0.00000   0.56675
  1 C 3px      0.01810   0.00000  -0.00000
  1 C 3py      0.00000   0.01810   0.00000
  1 C 3pz      0.00000  -0.00000   0.01881
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02276  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02148
  1 C 3dxz    -0.02276  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99254642
<CAS-nat-orb|mo-hf>  4  4    0.99791955
<CAS-nat-orb|mo-hf>  5  5    0.99960057
<CAS-nat-orb|mo-hf>  6  6    0.99960057
<CAS-nat-orb|mo-hf>  7  7    0.97536358
<CAS-nat-orb|mo-hf>  8  8    0.96172748
<CAS-nat-orb|mo-hf>  9  9    0.96172750
<CAS-nat-orb|mo-hf>  10  10    0.62371856
<CAS-nat-orb|mo-hf>  10  17    0.67956522
CASSCF energy = -75.5978678060503
CASCI E = -75.5978678060503  E(CI) = -16.8047461472215  S^2 = 0.0000000
Density matrix diagonal elements [1.97829949 1.67677898 1.83943634 1.83943637 0.32393208 0.16144635
 0.16144637 0.01922402]
i = 1  <i|F|i> = -11.31991257
i = 2  <i|F|i> = -11.31937357
i = 3  <i|F|i> =  -0.94381463
i = 4  <i|F|i> =  -0.47186812
i = 5  <i|F|i> =  -0.35861909
i = 6  <i|F|i> =  -0.35861910
i = 7  <i|F|i> =  -0.10735300
i = 8  <i|F|i> =   0.16777611
i = 9  <i|F|i> =   0.16777608
i = 10  <i|F|i> =   0.72227470
i = 11  <i|F|i> =   0.63169625
i = 12  <i|F|i> =   0.67557943
i = 13  <i|F|i> =   0.67557943
i = 14  <i|F|i> =   0.72607641
i = 15  <i|F|i> =   0.70791349
i = 16  <i|F|i> =   0.70791352
i = 17  <i|F|i> =   0.55892584
i = 18  <i|F|i> =   1.09643370
i = 19  <i|F|i> =   1.26615254
i = 20  <i|F|i> =   1.26615254
i = 21  <i|F|i> =   1.28498921
i = 22  <i|F|i> =   1.28498921
i = 23  <i|F|i> =   1.57489766
i = 24  <i|F|i> =   1.57489766
i = 25  <i|F|i> =   1.94231569
i = 26  <i|F|i> =   2.00980877
i = 27  <i|F|i> =   2.00980877
i = 28  <i|F|i> =   2.16919377
......production of RDMs took       1.81 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.62 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.63 sec

E(WickSCNEVPT2-ijrs) =    -0.00028457826252
E(WickSCNEVPT2- rsi) =    -0.00090635720314
E(WickSCNEVPT2- ijr) =    -0.00038987910127
E(WickSCNEVPT2-  rs) =    -0.03597247856518
E(WickSCNEVPT2-  ij) =    -0.00011940506204
E(WickSCNEVPT2-  ir) =    -0.00119662206147
E(WickSCNEVPT2-   r) =    -0.04890496508826
E(WickSCNEVPT2-   i) =    -0.00025453041905
E(WickSCNEVPT2) = -75.68589662181327  E_corr_pt = -0.08802881576293478
Timings = pdms =   31.51 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.53 | i =    0.25
Time cost =     74.110
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:58:43 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.455237330030 AA    0.000000000000   0.000000000000   2.750000000000 Bohr   0.0

nuclear repulsion = 13.0909090909091
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.375]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6520.90


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpcdggkkgd
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1557644738047

WARN: Singularity detected in overlap matrix (condition number =  321). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.19200419727189  LUMO (Ag) = -0.16608696150487
cycle= 1 E= -75.3260871697503  delta_E= -0.17  |g|= 0.228  |ddm|= 1.44
HOMO (B3u) = -0.448902413635198  LUMO (Ag) = -0.151522743525037
cycle= 2 E= -75.3454236890815  delta_E= -0.0193  |g|= 0.0517  |ddm|= 0.291
HOMO (B2u) = -0.411143114796125  LUMO (Ag) = -0.105979877749066
cycle= 3 E= -75.3463869604458  delta_E= -0.000963  |g|= 0.0112  |ddm|= 0.0546
HOMO (B3u) = -0.412216378156837  LUMO (Ag) = -0.102966454342325
cycle= 4 E= -75.3464661736963  delta_E= -7.92e-05  |g|= 0.00221  |ddm|= 0.0168
HOMO (B3u) = -0.413005500150535  LUMO (Ag) = -0.103497081119969
cycle= 5 E= -75.3464696035283  delta_E= -3.43e-06  |g|= 0.000295  |ddm|= 0.00439
HOMO (B3u) = -0.412935226123344  LUMO (Ag) = -0.103410770619275
cycle= 6 E= -75.3464696577873  delta_E= -5.43e-08  |g|= 3.83e-05  |ddm|= 0.000585
HOMO (B2u) = -0.412927742673197  LUMO (Ag) = -0.10339872264774
cycle= 7 E= -75.346469658793  delta_E= -1.01e-09  |g|= 4.88e-06  |ddm|= 0.00019
HOMO (B3u) = -0.412927696344284  LUMO (Ag) = -0.103397915940698
cycle= 8 E= -75.3464696588055  delta_E= -1.25e-11  |g|= 4.41e-07  |ddm|= 2.55e-05
HOMO (B2u) = -0.412927666372128  LUMO (Ag) = -0.103397797537505
cycle= 9 E= -75.3464696588056  delta_E= -1.14e-13  |g|= 1.96e-08  |ddm|= 2.16e-06
HOMO (B2u) = -0.412927660626365  LUMO (Ag) = -0.103397800029288
cycle= 10 E= -75.3464696588056  delta_E= 5.68e-14  |g|= 2.79e-09  |ddm|= 6.41e-08
HOMO (B2u) = -0.412927661256422  LUMO (Ag) = -0.103397800544617
cycle= 11 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 2.25e-09  |ddm|= 1.98e-09
HOMO (B2u) = -0.412927661145529  LUMO (Ag) = -0.103397800410487
cycle= 12 E= -75.3464696588055  delta_E= -2.84e-14  |g|= 1.62e-09  |ddm|= 2.36e-09
HOMO (B2u) = -0.412927661098562  LUMO (Ag) = -0.103397800324271
cycle= 13 E= -75.3464696588055  delta_E= 7.11e-14  |g|= 1.28e-09  |ddm|= 1.55e-09
HOMO (B2u) = -0.412927661060482  LUMO (Ag) = -0.103397800268608
cycle= 14 E= -75.3464696588055  delta_E= -7.11e-14  |g|= 1.06e-09  |ddm|= 9.97e-10
HOMO (B2u) = -0.41292766103956  LUMO (Ag) = -0.103397800245124
cycle= 15 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 9.1e-10  |ddm|= 6.99e-10
HOMO (B2u) = -0.41292766104906  LUMO (Ag) = -0.103397800290741
cycle= 16 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 8.3e-10  |ddm|= 1.32e-09
HOMO (B3u) = -0.412927660984871  LUMO (Ag) = -0.103397800239507
cycle= 17 E= -75.3464696588055  delta_E= 8.53e-14  |g|= 8.36e-10  |ddm|= 2.48e-10
HOMO (B2u) = -0.412927660872987  LUMO (Ag) = -0.103397800091555
cycle= 18 E= -75.3464696588056  delta_E= -1.71e-13  |g|= 3.43e-10  |ddm|= 1.65e-09
HOMO (B3u) = -0.412927660874841  LUMO (Ag) = -0.103397800085885
cycle= 19 E= -75.3464696588056  delta_E= 5.68e-14  |g|= 2.8e-10  |ddm|= 2.47e-10
HOMO (B3u) = -0.412927660889628  LUMO (Ag) = -0.103397800094422
cycle= 20 E= -75.3464696588056  delta_E= -4.26e-14  |g|= 2.21e-10  |ddm|= 1.92e-10
HOMO (B3u) = -0.412927660899904  LUMO (Ag) = -0.103397800100474
cycle= 21 E= -75.3464696588055  delta_E= 9.95e-14  |g|= 1.8e-10  |ddm|= 1.44e-10
HOMO (B3u) = -0.412927660907416  LUMO (Ag) = -0.103397800105439
cycle= 22 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 1.48e-10  |ddm|= 1.11e-10
HOMO (B3u) = -0.412927660912906  LUMO (Ag) = -0.103397800109509
cycle= 23 E= -75.3464696588055  delta_E= -5.68e-14  |g|= 1.22e-10  |ddm|= 9.19e-11
HOMO (B2u) = -0.412927660917442  LUMO (Ag) = -0.103397800112852
cycle= 24 E= -75.3464696588057  delta_E= -1.42e-13  |g|= 9.97e-11  |ddm|= 7.82e-11
HOMO (B3u) = -0.412927660921768  LUMO (Ag) = -0.103397800114453
cycle= 25 E= -75.3464696588056  delta_E= 9.95e-14  |g|= 7.73e-11  |ddm|= 5.35e-11
HOMO (B3u) = -0.412927660924355  LUMO (Ag) = -0.10339780011393
cycle= 26 E= -75.3464696588056  delta_E=    0  |g|= 5.32e-11  |ddm|= 5.66e-11
HOMO (B3u) = -0.412927660918835  LUMO (Ag) = -0.103397800104405
Extra cycle  E= -75.3464696588056  delta_E= -1.42e-14  |g|= 1.7e-11  |ddm|= 6.95e-11
converged SCF energy = -75.3464696588056

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpcdggkkgd
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.527381749504  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5505812895237  dE = -0.02319954  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0789
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5627423957474  dE = -0.012161106  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5708416789259  dE = -0.0080992832  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0298  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.576911425564  dE = -0.0060697466  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0169  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5816202918538  dE = -0.0047088663  S^2 = 0.0000000
               |grad[o]|=0.0598  |ddm|=0.0112  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5852180142656  dE = -0.0035977224  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.00806  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5878220968978  dE = -0.0026040826  S^2 = 0.0000000
               |grad[o]|=0.0347  |ddm|=0.00612  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5895016097378  dE = -0.0016795128  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5903141997755  dE = -0.00081259004  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.00535  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5904157790264  dE = -0.00010157925  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.00625  |maxRot[o]|=0.0374
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5904169954666  dE = -1.2164402e-06  S^2 = 0.0000000
               |grad[o]|=0.000611  |ddm|=0.00344  |maxRot[o]|=0.00344
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5904170207647  dE = -2.5298078e-08  S^2 = 0.0000000
               |grad[o]|=9.15e-05  |ddm|=0.000453  |maxRot[o]|=0.000415
macro iter 13 (3 JK  0 micro), CASSCF E = -75.590417021312  dE = -5.4731686e-10  S^2 = 0.0000000
               |grad[o]|=1.51e-05  |ddm|=6.86e-05  |maxRot[o]|=6.34e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5904170213273  dE = -1.5276669e-11  S^2 = 0.0000000
               |grad[o]|=2.37e-06  |ddm|=1.28e-05  |maxRot[o]|=1.1e-05
2-step CASSCF converged in 14 macro (69 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97743796 1.68610721 1.83058145 1.83058041 0.31631683 0.16943524
 0.16943537 0.02010553]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00615   0.00344   0.00000   0.00000  -0.00091
  0 C 2s       0.61773   0.57533   0.00000  -0.00000  -0.34180
  0 C 3s      -0.03411   0.00898  -0.00000  -0.00000   0.00990
  0 C 2px      0.00000  -0.00000  -0.00000   0.70654  -0.00000
  0 C 2py     -0.00000   0.00000   0.70654  -0.00000  -0.00000
  0 C 2pz      0.33928  -0.41097  -0.00000  -0.00000   0.61707
  0 C 3px     -0.00000  -0.00000   0.00000   0.01297  -0.00000
  0 C 3py      0.00000  -0.00000   0.01297   0.00000  -0.00000
  0 C 3pz     -0.03426  -0.00242  -0.00000  -0.00000  -0.04286
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02505   0.00000  -0.00000
  0 C 3dz^2    0.03040  -0.00175  -0.00000  -0.00000   0.02149
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02505  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00615  -0.00344   0.00000   0.00000  -0.00091
  1 C 2s       0.61773  -0.57533  -0.00000   0.00000  -0.34180
  1 C 3s      -0.03411  -0.00898   0.00000   0.00000   0.00990
  1 C 2px      0.00000   0.00000  -0.00000   0.70654  -0.00000
  1 C 2py      0.00000   0.00000   0.70654  -0.00000   0.00000
  1 C 2pz     -0.33928  -0.41097  -0.00000   0.00000  -0.61707
  1 C 3px     -0.00000   0.00000   0.00000   0.01297   0.00000
  1 C 3py      0.00000  -0.00000   0.01297  -0.00000   0.00000
  1 C 3pz      0.03426  -0.00242  -0.00000  -0.00000   0.04286
  1 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02505   0.00000  -0.00000
  1 C 3dz^2    0.03040   0.00175   0.00000   0.00000   0.02149
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02505  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s      -0.00000   0.00000   0.41035
  0 C 3s      -0.00000  -0.00000  -0.04345
  0 C 2px      0.70654   0.00000  -0.00000
  0 C 2py     -0.00000   0.70654  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.57349
  0 C 3px     -0.01725  -0.00000   0.00000
  0 C 3py     -0.00000  -0.01725  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01967
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02253  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02125
  0 C 3dxz    -0.02253  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.41035
  1 C 3s       0.00000   0.00000   0.04345
  1 C 2px     -0.70654   0.00000  -0.00000
  1 C 2py      0.00000  -0.70654   0.00000
  1 C 2pz      0.00000   0.00000   0.57349
  1 C 3px      0.01725  -0.00000   0.00000
  1 C 3py      0.00000   0.01725   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01967
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02253  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02125
  1 C 3dxz    -0.02253   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99226092
<CAS-nat-orb|mo-hf>  4  4    0.99781292
<CAS-nat-orb|mo-hf>  5  5    0.99956408
<CAS-nat-orb|mo-hf>  6  6    0.99956408
<CAS-nat-orb|mo-hf>  7  7    0.97493010
<CAS-nat-orb|mo-hf>  8  8    0.96431698
<CAS-nat-orb|mo-hf>  9  9    0.96431697
<CAS-nat-orb|mo-hf>  10  10    0.64879987
<CAS-nat-orb|mo-hf>  10  17    0.66873221
CASSCF energy = -75.5904170213273
CASCI E = -75.5904170213273  E(CI) = -16.6895622816507  S^2 = 0.0000000
Density matrix diagonal elements [1.97743766 1.68610189 1.83058286 1.83058159 0.31631925 0.16943545
 0.16943573 0.02010557]
i = 1  <i|F|i> = -11.32394820
i = 2  <i|F|i> = -11.32354456
i = 3  <i|F|i> =  -0.93467424
i = 4  <i|F|i> =  -0.47847007
i = 5  <i|F|i> =  -0.35288569
i = 6  <i|F|i> =  -0.35288545
i = 7  <i|F|i> =  -0.10520179
i = 8  <i|F|i> =   0.15655395
i = 9  <i|F|i> =   0.15655387
i = 10  <i|F|i> =   0.68769342
i = 11  <i|F|i> =   0.63589216
i = 12  <i|F|i> =   0.67829196
i = 13  <i|F|i> =   0.67829196
i = 14  <i|F|i> =   0.72693411
i = 15  <i|F|i> =   0.70832789
i = 16  <i|F|i> =   0.70832788
i = 17  <i|F|i> =   0.56059880
i = 18  <i|F|i> =   1.09089247
i = 19  <i|F|i> =   1.27051277
i = 20  <i|F|i> =   1.27051277
i = 21  <i|F|i> =   1.27294207
i = 22  <i|F|i> =   1.27294205
i = 23  <i|F|i> =   1.56582295
i = 24  <i|F|i> =   1.56582295
i = 25  <i|F|i> =   1.91821587
i = 26  <i|F|i> =   1.99353864
i = 27  <i|F|i> =   1.99353866
i = 28  <i|F|i> =   2.15583957
......production of RDMs took       2.09 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.22 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.74 sec

E(WickSCNEVPT2-ijrs) =    -0.00028193247587
E(WickSCNEVPT2- rsi) =    -0.00089571705604
E(WickSCNEVPT2- ijr) =    -0.00038326606544
E(WickSCNEVPT2-  rs) =    -0.03554281227909
E(WickSCNEVPT2-  ij) =    -0.00011426672100
E(WickSCNEVPT2-  ir) =    -0.00118158926117
E(WickSCNEVPT2-   r) =    -0.04972196266512
E(WickSCNEVPT2-   i) =    -0.00024871444393
E(WickSCNEVPT2) = -75.67878728229493  E_corr_pt = -0.08837026096763202
Timings = pdms =   31.50 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.53 | i =    0.24
Time cost =    409.995
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:05:33 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.481696190576 AA    0.000000000000   0.000000000000   2.800000000000 Bohr   0.0

nuclear repulsion = 12.8571428571429
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.4]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6941.19


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpo7omewf0
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1187592585641

WARN: Singularity detected in overlap matrix (condition number =  297). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.184977014444633  LUMO (Ag) = -0.163989710542375
cycle= 1 E= -75.3167358242476  delta_E= -0.198  |g|= 0.231  |ddm|= 1.44
HOMO (B3u) = -0.444434359277164  LUMO (Ag) = -0.15141696369634
cycle= 2 E= -75.3367114409982  delta_E= -0.02  |g|= 0.0515  |ddm|= 0.298
HOMO (B2u) = -0.406594326641875  LUMO (Ag) = -0.105005000614388
cycle= 3 E= -75.3376920455643  delta_E= -0.000981  |g|= 0.0117  |ddm|= 0.0545
HOMO (B2u) = -0.407746719644285  LUMO (Ag) = -0.101871698894466
cycle= 4 E= -75.3377779901322  delta_E= -8.59e-05  |g|= 0.00225  |ddm|= 0.0162
HOMO (B3u) = -0.408536003811461  LUMO (Ag) = -0.10241415354726
cycle= 5 E= -75.3377816192104  delta_E= -3.63e-06  |g|= 0.000309  |ddm|= 0.00396
HOMO (B2u) = -0.40846404012632  LUMO (Ag) = -0.102331174534056
cycle= 6 E= -75.3377816780684  delta_E= -5.89e-08  |g|= 3.95e-05  |ddm|= 0.000618
HOMO (B2u) = -0.40845625601886  LUMO (Ag) = -0.102318677176285
cycle= 7 E= -75.3377816791323  delta_E= -1.06e-09  |g|= 5.06e-06  |ddm|= 0.00018
HOMO (B3u) = -0.408456106236034  LUMO (Ag) = -0.102317785563318
cycle= 8 E= -75.337781679146  delta_E= -1.37e-11  |g|= 4.62e-07  |ddm|= 2.48e-05
HOMO (B2u) = -0.40845607514388  LUMO (Ag) = -0.102317652725498
cycle= 9 E= -75.3377816791461  delta_E= -7.11e-14  |g|= 2.02e-08  |ddm|= 1.99e-06
HOMO (B3u) = -0.408456068963823  LUMO (Ag) = -0.102317657025672
cycle= 10 E= -75.3377816791461  delta_E=    0  |g|= 2.92e-09  |ddm|= 6.88e-08
HOMO (B3u) = -0.408456069756296  LUMO (Ag) = -0.102317657742368
cycle= 11 E= -75.337781679146  delta_E= 8.53e-14  |g|= 2.43e-09  |ddm|= 2.38e-09
HOMO (B3u) = -0.408456069540476  LUMO (Ag) = -0.102317657474579
cycle= 12 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 1.71e-09  |ddm|= 2.69e-09
HOMO (B3u) = -0.408456069500244  LUMO (Ag) = -0.102317657377949
cycle= 13 E= -75.337781679146  delta_E= 8.53e-14  |g|= 1.39e-09  |ddm|= 1.62e-09
HOMO (B3u) = -0.408456069460796  LUMO (Ag) = -0.102317657325893
cycle= 14 E= -75.3377816791461  delta_E= -5.68e-14  |g|= 1.14e-09  |ddm|= 1.05e-09
HOMO (B3u) = -0.408456069437117  LUMO (Ag) = -0.102317657300382
cycle= 15 E= -75.3377816791461  delta_E= -5.68e-14  |g|= 9.7e-10  |ddm|= 6.22e-10
HOMO (B3u) = -0.408456069437559  LUMO (Ag) = -0.102317657335218
cycle= 16 E= -75.3377816791461  delta_E= 5.68e-14  |g|= 8.89e-10  |ddm|= 1.18e-09
HOMO (B3u) = -0.408456069387386  LUMO (Ag) = -0.102317657293465
cycle= 17 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 8.67e-10  |ddm|= 8.49e-11
HOMO (B3u) = -0.408456069259561  LUMO (Ag) = -0.102317657143873
cycle= 18 E= -75.337781679146  delta_E= 7.11e-14  |g|= 3.66e-10  |ddm|= 1.82e-09
HOMO (B3u) = -0.408456069261322  LUMO (Ag) = -0.102317657138171
cycle= 19 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 2.99e-10  |ddm|= 2.73e-10
HOMO (B3u) = -0.408456069278545  LUMO (Ag) = -0.102317657148957
cycle= 20 E= -75.337781679146  delta_E= 1.42e-14  |g|= 2.36e-10  |ddm|= 2.09e-10
HOMO (B3u) = -0.408456069289295  LUMO (Ag) = -0.102317657155332
cycle= 21 E= -75.3377816791461  delta_E= -4.26e-14  |g|= 1.92e-10  |ddm|= 1.54e-10
HOMO (B3u) = -0.408456069296932  LUMO (Ag) = -0.102317657160855
cycle= 22 E= -75.3377816791461  delta_E= -4.26e-14  |g|= 1.57e-10  |ddm|= 1.19e-10
HOMO (B3u) = -0.408456069302638  LUMO (Ag) = -0.102317657165368
cycle= 23 E= -75.337781679146  delta_E= 1.42e-13  |g|= 1.28e-10  |ddm|= 9.8e-11
HOMO (B3u) = -0.408456069307687  LUMO (Ag) = -0.102317657169558
cycle= 24 E= -75.3377816791462  delta_E= -1.71e-13  |g|= 1.04e-10  |ddm|= 8.82e-11
HOMO (B3u) = -0.408456069312197  LUMO (Ag) = -0.102317657171824
cycle= 25 E= -75.3377816791461  delta_E= 2.84e-14  |g|= 8.07e-11  |ddm|= 6.41e-11
HOMO (B3u) = -0.408456069315169  LUMO (Ag) = -0.102317657172299
cycle= 26 E= -75.3377816791461  delta_E= 4.26e-14  |g|= 5.62e-11  |ddm|= 6.32e-11
HOMO (B3u) = -0.408456069313838  LUMO (Ag) = -0.102317657169856
cycle= 27 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 4.57e-11  |ddm|= 2.27e-11
HOMO (B2u) = -0.408456069312365  LUMO (Ag) = -0.10231765716754
cycle= 28 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 3.69e-11  |ddm|= 1.74e-11
HOMO (B2u) = -0.408456069311364  LUMO (Ag) = -0.102317657165914
cycle= 29 E= -75.337781679146  delta_E= 1.42e-14  |g|= 3e-11  |ddm|= 1.35e-11
HOMO (B2u) = -0.408456069310633  LUMO (Ag) = -0.102317657164703
cycle= 30 E= -75.3377816791461  delta_E= -9.95e-14  |g|= 2.42e-11  |ddm|= 1.07e-11
HOMO (B2u) = -0.408456069310139  LUMO (Ag) = -0.102317657163786
cycle= 31 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 1.95e-11  |ddm|= 8.66e-12
HOMO (B2u) = -0.408456069309831  LUMO (Ag) = -0.102317657163072
cycle= 32 E= -75.3377816791461  delta_E= 2.84e-14  |g|= 1.55e-11  |ddm|= 7e-12
HOMO (B2u) = -0.408456069309674  LUMO (Ag) = -0.102317657162513
cycle= 33 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 1.22e-11  |ddm|= 5.83e-12
HOMO (B2u) = -0.408456069309655  LUMO (Ag) = -0.102317657162156
cycle= 34 E= -75.337781679146  delta_E= 9.95e-14  |g|= 9.65e-12  |ddm|= 4.67e-12
HOMO (B2u) = -0.408456069309727  LUMO (Ag) = -0.102317657161977
cycle= 35 E= -75.337781679146  delta_E= -1.42e-14  |g|= 7.85e-12  |ddm|= 3.47e-12
HOMO (B2u) = -0.408456069309763  LUMO (Ag) = -0.102317657161809
cycle= 36 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 6.38e-12  |ddm|= 2.94e-12
HOMO (B3u) = -0.408456069309765  LUMO (Ag) = -0.102317657161648
cycle= 37 E= -75.3377816791461  delta_E=    0  |g|= 5.17e-12  |ddm|= 2.44e-12
HOMO (B3u) = -0.408456069309609  LUMO (Ag) = -0.102317657160999
Extra cycle  E= -75.3377816791461  delta_E= 1.42e-14  |g|= 1.79e-12  |ddm|= 7.51e-12
converged SCF energy = -75.3377816791461

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpo7omewf0
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5207710561399  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5435858178722  dE = -0.022814762  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5556863536553  dE = -0.012100536  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5638012283029  dE = -0.0081148746  S^2 = 0.0000000
               |grad[o]|=0.0929  |ddm|=0.0305  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5698554857256  dE = -0.0060542574  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0176  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.574497457882  dE = -0.0046419722  S^2 = 0.0000000
               |grad[o]|=0.0595  |ddm|=0.0117  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.577978503312  dE = -0.0034810454  S^2 = 0.0000000
               |grad[o]|=0.0458  |ddm|=0.00833  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5804227194729  dE = -0.0024442162  S^2 = 0.0000000
               |grad[o]|=0.0334  |ddm|=0.00629  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5819072097378  dE = -0.0014844903  S^2 = 0.0000000
               |grad[o]|=0.0219  |ddm|=0.00549  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5824311518786  dE = -0.00052394214  S^2 = 0.0000000
               |grad[o]|=0.0112  |ddm|=0.00592  |maxRot[o]|= 0.06
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5825178886291  dE = -8.6736751e-05  S^2 = 0.0000000
               |grad[o]|=0.00395  |ddm|=0.00526  |maxRot[o]|=0.0339
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5825189143668  dE = -1.0257377e-06  S^2 = 0.0000000
               |grad[o]|=0.00057  |ddm|=0.00341  |maxRot[o]|=0.00308
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5825189359808  dE = -2.1613943e-08  S^2 = 0.0000000
               |grad[o]|=8.53e-05  |ddm|=0.000437  |maxRot[o]|=0.000367
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5825189364279  dE = -4.4711612e-10  S^2 = 0.0000000
               |grad[o]|=1.4e-05  |ddm|=6.12e-05  |maxRot[o]|=5.56e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5825189364314  dE = -3.524292e-12  S^2 = 0.0000000
               |grad[o]|=1.99e-06  |ddm|=1.03e-05  |maxRot[o]|=9.54e-06
2-step CASSCF converged in 14 macro (68 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97658606 1.69515621 1.82129801 1.82129742 0.3093552  0.17765866
 0.17765826 0.02099018]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00641   0.00352   0.00000   0.00000  -0.00088
  0 C 2s       0.62079   0.58190   0.00000  -0.00000  -0.33633
  0 C 3s      -0.03214   0.00906   0.00000  -0.00000   0.01238
  0 C 2px     -0.00000   0.00000  -0.00000   0.70653   0.00000
  0 C 2py      0.00000  -0.00000   0.70653   0.00000  -0.00000
  0 C 2pz      0.33407  -0.40161   0.00000   0.00000   0.61999
  0 C 3px     -0.00000  -0.00000  -0.00000   0.01517  -0.00000
  0 C 3py      0.00000  -0.00000   0.01517   0.00000  -0.00000
  0 C 3pz     -0.03258  -0.00225   0.00000   0.00000  -0.04249
  0 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02420   0.00000  -0.00000
  0 C 3dz^2    0.02955  -0.00209   0.00000  -0.00000   0.02326
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.02420  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00641  -0.00352   0.00000   0.00000  -0.00088
  1 C 2s       0.62079  -0.58190  -0.00000  -0.00000  -0.33633
  1 C 3s      -0.03214  -0.00906  -0.00000   0.00000   0.01238
  1 C 2px      0.00000   0.00000   0.00000   0.70653   0.00000
  1 C 2py     -0.00000   0.00000   0.70653   0.00000  -0.00000
  1 C 2pz     -0.33407  -0.40161   0.00000  -0.00000  -0.61999
  1 C 3px      0.00000  -0.00000   0.00000   0.01517  -0.00000
  1 C 3py     -0.00000   0.00000   0.01517  -0.00000   0.00000
  1 C 3pz      0.03258  -0.00225   0.00000  -0.00000   0.04249
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02420   0.00000  -0.00000
  1 C 3dz^2    0.02955   0.00209  -0.00000   0.00000   0.02326
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02420   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000   0.00000   0.40101
  0 C 3s      -0.00000  -0.00000  -0.04346
  0 C 2px      0.70657  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70657   0.00000
  0 C 2pz     -0.00000   0.00000   0.58004
  0 C 3px     -0.01641  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01641  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02037
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02228  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02106
  0 C 3dxz    -0.02228  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s       0.00000   0.00000  -0.40101
  1 C 3s       0.00000  -0.00000   0.04346
  1 C 2px     -0.70657   0.00000   0.00000
  1 C 2py      0.00000  -0.70657   0.00000
  1 C 2pz     -0.00000   0.00000   0.58004
  1 C 3px      0.01641   0.00000   0.00000
  1 C 3py      0.00000   0.01641  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02037
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02228   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02106
  1 C 3dxz    -0.02228  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99198874
<CAS-nat-orb|mo-hf>  4  4    0.99770782
<CAS-nat-orb|mo-hf>  5  5    0.99952508
<CAS-nat-orb|mo-hf>  6  6    0.99952508
<CAS-nat-orb|mo-hf>  7  7    0.97453484
<CAS-nat-orb|mo-hf>  8  8    0.96668736
<CAS-nat-orb|mo-hf>  9  9    0.96668730
<CAS-nat-orb|mo-hf>  10  10    0.67408746
<CAS-nat-orb|mo-hf>  10  17    0.65475223
CASSCF energy = -75.5825189364314
CASCI E = -75.5825189364314  E(CI) = -16.5777815975582  S^2 = 0.0000000
Density matrix diagonal elements [1.97658597 1.69515468 1.82129974 1.82129794 0.30935478 0.1776583
 0.17765841 0.02099018]
i = 1  <i|F|i> = -11.32771811
i = 2  <i|F|i> = -11.32743437
i = 3  <i|F|i> =  -0.92575498
i = 4  <i|F|i> =  -0.48500486
i = 5  <i|F|i> =  -0.34724422
i = 6  <i|F|i> =  -0.34724388
i = 7  <i|F|i> =  -0.10303479
i = 8  <i|F|i> =   0.14577198
i = 9  <i|F|i> =   0.14577199
i = 10  <i|F|i> =   0.65503726
i = 11  <i|F|i> =   0.63984566
i = 12  <i|F|i> =   0.68073953
i = 13  <i|F|i> =   0.68073953
i = 14  <i|F|i> =   0.72829309
i = 15  <i|F|i> =   0.70874638
i = 16  <i|F|i> =   0.70874630
i = 17  <i|F|i> =   0.56247274
i = 18  <i|F|i> =   1.08551612
i = 19  <i|F|i> =   1.26180564
i = 20  <i|F|i> =   1.26180562
i = 21  <i|F|i> =   1.27496608
i = 22  <i|F|i> =   1.27496608
i = 23  <i|F|i> =   1.55705516
i = 24  <i|F|i> =   1.55705516
i = 25  <i|F|i> =   1.89286220
i = 26  <i|F|i> =   1.97719261
i = 27  <i|F|i> =   1.97719264
i = 28  <i|F|i> =   2.14505729
......production of RDMs took       1.82 sec
......reading the RDM took          0.46 sec
......production of RDMs took      19.81 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.68 sec

E(WickSCNEVPT2-ijrs) =    -0.00027980145968
E(WickSCNEVPT2- rsi) =    -0.00088631469131
E(WickSCNEVPT2- ijr) =    -0.00037671720791
E(WickSCNEVPT2-  rs) =    -0.03511972758408
E(WickSCNEVPT2-  ij) =    -0.00010925750634
E(WickSCNEVPT2-  ir) =    -0.00116718286633
E(WickSCNEVPT2-   r) =    -0.05054605165186
E(WickSCNEVPT2-   i) =    -0.00024290561653
E(WickSCNEVPT2) = -75.67124689501546  E_corr_pt = -0.08872795858402729
Timings = pdms =   31.76 | eris =    0.01 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.03 | r =    0.56 | i =    0.26
Time cost =    158.061
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:08:11 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.508155051122 AA    0.000000000000   0.000000000000   2.850000000000 Bohr   0.0

nuclear repulsion = 12.6315789473684
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.425]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6985.24


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp3jkrloz6
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0836082427711

WARN: Singularity detected in overlap matrix (condition number =  275). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.178310042866847  LUMO (Ag) = -0.161961845746924
cycle= 1 E= -75.3070977055452  delta_E= -0.223  |g|= 0.234  |ddm|= 1.43
HOMO (B3u) = -0.440057963112903  LUMO (Ag) = -0.151084704136087
cycle= 2 E= -75.3276882495978  delta_E= -0.0206  |g|= 0.0513  |ddm|= 0.304
HOMO (B2u) = -0.402148496278865  LUMO (Ag) = -0.103839161942738
cycle= 3 E= -75.3286840635262  delta_E= -0.000996  |g|= 0.0121  |ddm|= 0.0544
HOMO (B2u) = -0.403404739232162  LUMO (Ag) = -0.100645294675411
cycle= 4 E= -75.3287765426504  delta_E= -9.25e-05  |g|= 0.00228  |ddm|= 0.0159
HOMO (B2u) = -0.404190054526262  LUMO (Ag) = -0.101202470957944
cycle= 5 E= -75.3287803215959  delta_E= -3.78e-06  |g|= 0.000318  |ddm|= 0.00364
HOMO (B3u) = -0.404117903551407  LUMO (Ag) = -0.101124705066541
cycle= 6 E= -75.3287803833538  delta_E= -6.18e-08  |g|= 4.04e-05  |ddm|= 0.000637
HOMO (B3u) = -0.404109925173548  LUMO (Ag) = -0.101111910622258
cycle= 7 E= -75.3287803844586  delta_E= -1.1e-09  |g|= 5.18e-06  |ddm|= 0.000169
HOMO (B2u) = -0.40410966396869  LUMO (Ag) = -0.101110942652318
cycle= 8 E= -75.3287803844732  delta_E= -1.46e-11  |g|= 4.83e-07  |ddm|= 2.4e-05
HOMO (B3u) = -0.404109632109852  LUMO (Ag) = -0.10111079424772
cycle= 9 E= -75.3287803844734  delta_E= -1.42e-13  |g|= 2.07e-08  |ddm|= 1.8e-06
HOMO (B3u) = -0.404109625552916  LUMO (Ag) = -0.101110800522628
cycle= 10 E= -75.3287803844733  delta_E= 8.53e-14  |g|= 3.06e-09  |ddm|= 7.31e-08
HOMO (B2u) = -0.404109626452993  LUMO (Ag) = -0.10111080137887
cycle= 11 E= -75.3287803844733  delta_E= -5.68e-14  |g|= 2.52e-09  |ddm|= 2.92e-09
HOMO (B3u) = -0.404109626198789  LUMO (Ag) = -0.101110801055609
cycle= 12 E= -75.3287803844733  delta_E=    0  |g|= 1.8e-09  |ddm|= 2.87e-09
HOMO (B3u) = -0.40410962615724  LUMO (Ag) = -0.101110800936428
cycle= 13 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 1.49e-09  |ddm|= 1.54e-09
HOMO (B2u) = -0.404109626116926  LUMO (Ag) = -0.10111080088964
cycle= 14 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 1.23e-09  |ddm|= 1.09e-09
HOMO (B2u) = -0.404109626090413  LUMO (Ag) = -0.101110800862834
cycle= 15 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 1.04e-09  |ddm|= 6.13e-10
HOMO (B2u) = -0.404109626088457  LUMO (Ag) = -0.101110800890585
cycle= 16 E= -75.3287803844734  delta_E= -7.11e-14  |g|= 9.43e-10  |ddm|= 1.1e-09
HOMO (B2u) = -0.404109626047945  LUMO (Ag) = -0.101110800856278
cycle= 17 E= -75.3287803844734  delta_E= 1.42e-14  |g|= 8.96e-10  |ddm|= 2e-10
HOMO (B2u) = -0.404109625906889  LUMO (Ag) = -0.101110800709369
cycle= 18 E= -75.3287803844733  delta_E= 4.26e-14  |g|= 3.85e-10  |ddm|= 1.99e-09
HOMO (B2u) = -0.404109625908362  LUMO (Ag) = -0.101110800703535
cycle= 19 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 3.15e-10  |ddm|= 2.96e-10
HOMO (B2u) = -0.404109625926565  LUMO (Ag) = -0.101110800715491
cycle= 20 E= -75.3287803844734  delta_E= -1.42e-14  |g|= 2.5e-10  |ddm|= 2.2e-10
HOMO (B3u) = -0.404109625937795  LUMO (Ag) = -0.101110800722172
cycle= 21 E= -75.3287803844734  delta_E= -1.42e-14  |g|= 2.04e-10  |ddm|= 1.59e-10
HOMO (B3u) = -0.404109625945345  LUMO (Ag) = -0.101110800728218
cycle= 22 E= -75.3287803844733  delta_E= 5.68e-14  |g|= 1.66e-10  |ddm|= 1.26e-10
HOMO (B3u) = -0.404109625951099  LUMO (Ag) = -0.101110800733132
cycle= 23 E= -75.3287803844733  delta_E=    0  |g|= 1.34e-10  |ddm|= 1.04e-10
HOMO (B3u) = -0.404109625956536  LUMO (Ag) = -0.101110800738147
cycle= 24 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 1.09e-10  |ddm|= 9.78e-11
HOMO (B3u) = -0.404109625961278  LUMO (Ag) = -0.101110800741323
cycle= 25 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 8.39e-11  |ddm|= 7.45e-11
HOMO (B3u) = -0.404109625964634  LUMO (Ag) = -0.101110800742937
cycle= 26 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 5.91e-11  |ddm|= 7.03e-11
HOMO (B3u) = -0.404109625963261  LUMO (Ag) = -0.101110800740557
cycle= 27 E= -75.3287803844733  delta_E= -8.53e-14  |g|= 4.8e-11  |ddm|= 2.49e-11
HOMO (B3u) = -0.404109625961707  LUMO (Ag) = -0.101110800738265
cycle= 28 E= -75.3287803844733  delta_E= 4.26e-14  |g|= 3.87e-11  |ddm|= 1.89e-11
HOMO (B3u) = -0.404109625960634  LUMO (Ag) = -0.101110800736687
cycle= 29 E= -75.3287803844733  delta_E= -1.42e-14  |g|= 3.13e-11  |ddm|= 1.48e-11
HOMO (B3u) = -0.404109625959835  LUMO (Ag) = -0.101110800735551
cycle= 30 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 2.52e-11  |ddm|= 1.18e-11
HOMO (B2u) = -0.404109625959288  LUMO (Ag) = -0.101110800734708
cycle= 31 E= -75.3287803844734  delta_E=    0  |g|= 2.01e-11  |ddm|= 9.41e-12
HOMO (B3u) = -0.404109625958865  LUMO (Ag) = -0.101110800733109
Extra cycle  E= -75.3287803844734  delta_E=    0  |g|= 6.53e-12  |ddm|= 2.36e-11
converged SCF energy = -75.3287803844734

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp3jkrloz6
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5139143945433  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5362301908141  dE = -0.022315796  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5483398809821  dE = -0.01210969  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0695  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5564887719875  dE = -0.008148891  S^2 = 0.0000000
               |grad[o]|=0.0932  |ddm|=0.0312  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5625262374719  dE = -0.0060374655  S^2 = 0.0000000
               |grad[o]|=0.0747  |ddm|=0.0183  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5670881352979  dE = -0.0045618978  S^2 = 0.0000000
               |grad[o]|=0.0588  |ddm|=0.0122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5704313549285  dE = -0.0033432196  S^2 = 0.0000000
               |grad[o]|=0.0446  |ddm|=0.00858  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5726887962908  dE = -0.0022574414  S^2 = 0.0000000
               |grad[o]|=0.0317  |ddm|=0.00647  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5739475221515  dE = -0.0012587259  S^2 = 0.0000000
               |grad[o]|=0.0197  |ddm|=0.00591  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5742840857051  dE = -0.00033656355  S^2 = 0.0000000
               |grad[o]|=0.00857  |ddm|=0.00674  |maxRot[o]|= 0.06
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5742936841768  dE = -9.5984717e-06  S^2 = 0.0000000
               |grad[o]|=0.00138  |ddm|=0.00615  |maxRot[o]|=0.0106
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5742938473245  dE = -1.631477e-07  S^2 = 0.0000000
               |grad[o]|=0.00024  |ddm|=0.00135  |maxRot[o]|=0.00105
macro iter 12 (3 JK  0 micro), CASSCF E = -75.574293850464  dE = -3.1395899e-09  S^2 = 0.0000000
               |grad[o]|=3.74e-05  |ddm|=0.000171  |maxRot[o]|=0.00015
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5742938505335  dE = -6.9405814e-11  S^2 = 0.0000000
               |grad[o]|=4.73e-06  |ddm|=2.25e-05  |maxRot[o]|=2.25e-05
2-step CASSCF converged in 13 macro (65 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97574992 1.70399847 1.81154522 1.81154426 0.30304426 0.18612138
 0.1861214  0.02187509]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00665   0.00360   0.00000   0.00000  -0.00085
  0 C 2s       0.62384   0.58827  -0.00000   0.00000  -0.33076
  0 C 3s      -0.03017   0.00916   0.00000   0.00000   0.01475
  0 C 2px      0.00000  -0.00000  -0.00000   0.70651  -0.00000
  0 C 2py      0.00000  -0.00000   0.70651  -0.00000   0.00000
  0 C 2pz      0.32876  -0.39221   0.00000  -0.00000   0.62289
  0 C 3px      0.00000  -0.00000   0.00000   0.01725  -0.00000
  0 C 3py      0.00000  -0.00000   0.01725   0.00000   0.00000
  0 C 3pz     -0.03092  -0.00212   0.00000   0.00000  -0.04192
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02335   0.00000   0.00000
  0 C 3dz^2    0.02875  -0.00240   0.00000   0.00000   0.02515
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02335  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00665  -0.00360   0.00000   0.00000  -0.00085
  1 C 2s       0.62384  -0.58827  -0.00000  -0.00000  -0.33076
  1 C 3s      -0.03017  -0.00916  -0.00000  -0.00000   0.01475
  1 C 2px     -0.00000   0.00000  -0.00000   0.70651   0.00000
  1 C 2py     -0.00000   0.00000   0.70651  -0.00000  -0.00000
  1 C 2pz     -0.32876  -0.39221  -0.00000   0.00000  -0.62289
  1 C 3px     -0.00000   0.00000   0.00000   0.01725   0.00000
  1 C 3py     -0.00000   0.00000   0.01725   0.00000  -0.00000
  1 C 3pz      0.03092  -0.00212   0.00000   0.00000   0.04192
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02335  -0.00000   0.00000
  1 C 3dz^2    0.02875   0.00240  -0.00000  -0.00000   0.02515
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02335  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00033
  0 C 2s       0.00000  -0.00000   0.39163
  0 C 3s       0.00000   0.00000  -0.04339
  0 C 2px      0.70659   0.00000   0.00000
  0 C 2py      0.00000   0.70659   0.00000
  0 C 2pz      0.00000   0.00000   0.58640
  0 C 3px     -0.01557   0.00000   0.00000
  0 C 3py      0.00000  -0.01557   0.00000
  0 C 3pz      0.00000  -0.00000   0.02090
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02201   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02090
  0 C 3dxz    -0.02201   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00033
  1 C 2s       0.00000   0.00000  -0.39163
  1 C 3s      -0.00000  -0.00000   0.04339
  1 C 2px     -0.70659  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70659  -0.00000
  1 C 2pz      0.00000   0.00000   0.58640
  1 C 3px      0.01557  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01557  -0.00000
  1 C 3pz      0.00000   0.00000   0.02090
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02201   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02090
  1 C 3dxz    -0.02201   0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99173412
<CAS-nat-orb|mo-hf>  4  4    0.99760703
<CAS-nat-orb|mo-hf>  5  5    0.99948360
<CAS-nat-orb|mo-hf>  6  6    0.99948359
<CAS-nat-orb|mo-hf>  7  7    0.97418543
<CAS-nat-orb|mo-hf>  8  8    0.96886035
<CAS-nat-orb|mo-hf>  9  9    0.96886034
<CAS-nat-orb|mo-hf>  10  10    0.69921469
<CAS-nat-orb|mo-hf>  10  15   -0.63804094
CASSCF energy = -75.5742938505335
CASCI E = -75.5742938505335  E(CI) = -16.4693217945525  S^2 = 0.0000000
Density matrix diagonal elements [1.97574977 1.70399292 1.81154694 1.81154635 0.30304693 0.18612105
 0.18612097 0.02187507]
i = 1  <i|F|i> = -11.33121906
i = 2  <i|F|i> = -11.33104257
i = 3  <i|F|i> =  -0.91707179
i = 4  <i|F|i> =  -0.49148412
i = 5  <i|F|i> =  -0.34168022
i = 6  <i|F|i> =  -0.34168011
i = 7  <i|F|i> =  -0.10086144
i = 8  <i|F|i> =   0.13540970
i = 9  <i|F|i> =   0.13540973
i = 10  <i|F|i> =   0.62422172
i = 11  <i|F|i> =   0.64355463
i = 12  <i|F|i> =   0.68292166
i = 13  <i|F|i> =   0.68292165
i = 14  <i|F|i> =   0.73015370
i = 15  <i|F|i> =   0.56452735
i = 16  <i|F|i> =   0.70917737
i = 17  <i|F|i> =   0.70917736
i = 18  <i|F|i> =   1.08030629
i = 19  <i|F|i> =   1.25159949
i = 20  <i|F|i> =   1.25159949
i = 21  <i|F|i> =   1.27949379
i = 22  <i|F|i> =   1.27949379
i = 23  <i|F|i> =   1.54859374
i = 24  <i|F|i> =   1.54859374
i = 25  <i|F|i> =   1.86644482
i = 26  <i|F|i> =   1.96077271
i = 27  <i|F|i> =   1.96077272
i = 28  <i|F|i> =   2.13658401
......production of RDMs took      43.48 sec
......reading the RDM took          0.45 sec
......production of RDMs took      21.18 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.65 sec

E(WickSCNEVPT2-ijrs) =    -0.00027813098363
E(WickSCNEVPT2- rsi) =    -0.00087807125756
E(WickSCNEVPT2- ijr) =    -0.00037025387102
E(WickSCNEVPT2-  rs) =    -0.03470554418262
E(WickSCNEVPT2-  ij) =    -0.00010439718915
E(WickSCNEVPT2-  ir) =    -0.00115341386145
E(WickSCNEVPT2-   r) =    -0.05137691081927
E(WickSCNEVPT2-   i) =    -0.00023709678817
E(WickSCNEVPT2) = -75.66339766948632  E_corr_pt = -0.08910381895286515
Timings = pdms =   74.75 | eris =    0.01 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.53 | i =    0.25
Time cost =    113.385
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:10:04 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.534613911668 AA    0.000000000000   0.000000000000   2.900000000000 Bohr   0.0

nuclear repulsion = 12.4137931034483
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.45]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7056.97


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp5ctnyxcj
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0502696488693

WARN: Singularity detected in overlap matrix (condition number =  255). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.171982441441623  LUMO (Ag) = -0.159994465911487
cycle= 1 E= -75.2972707224472  delta_E= -0.247  |g|= 0.236  |ddm|= 1.43
HOMO (B2u) = -0.435771051837408  LUMO (Ag) = -0.150538347855669
cycle= 2 E= -75.3184487790456  delta_E= -0.0212  |g|= 0.051  |ddm|= 0.31
HOMO (B2u) = -0.39780086513172  LUMO (Ag) = -0.102495692949929
cycle= 3 E= -75.3194573772646  delta_E= -0.00101  |g|= 0.0124  |ddm|= 0.0544
HOMO (B2u) = -0.399183030564799  LUMO (Ag) = -0.099301161566548
cycle= 4 E= -75.3195559425281  delta_E= -9.86e-05  |g|= 0.00229  |ddm|= 0.0157
HOMO (B3u) = -0.399959753294004  LUMO (Ag) = -0.0998732578136644
cycle= 5 E= -75.3195598190019  delta_E= -3.88e-06  |g|= 0.000323  |ddm|= 0.00343
HOMO (B3u) = -0.399888567456492  LUMO (Ag) = -0.0998019916939263
cycle= 6 E= -75.3195598822275  delta_E= -6.32e-08  |g|= 4.09e-05  |ddm|= 0.000646
HOMO (B3u) = -0.399880517827683  LUMO (Ag) = -0.0997890778930979
cycle= 7 E= -75.3195598833514  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000156
HOMO (B3u) = -0.399880142870902  LUMO (Ag) = -0.0997880477227933
cycle= 8 E= -75.319559883367  delta_E= -1.56e-11  |g|= 5.02e-07  |ddm|= 2.32e-05
HOMO (B3u) = -0.399880110369076  LUMO (Ag) = -0.099787882835251
cycle= 9 E= -75.319559883367  delta_E= -8.53e-14  |g|= 2.12e-08  |ddm|= 1.59e-06
HOMO (B2u) = -0.399880103488951  LUMO (Ag) = -0.0997878912045873
cycle= 10 E= -75.319559883367  delta_E= 2.84e-14  |g|= 3.19e-09  |ddm|= 7.71e-08
HOMO (B2u) = -0.39988010447517  LUMO (Ag) = -0.0997878921753163
cycle= 11 E= -75.3195598833669  delta_E= 1.14e-13  |g|= 2.57e-09  |ddm|= 3.53e-09
HOMO (B3u) = -0.399880104200802  LUMO (Ag) = -0.0997878918229779
cycle= 12 E= -75.3195598833671  delta_E= -1.71e-13  |g|= 1.87e-09  |ddm|= 2.82e-09
HOMO (B2u) = -0.399880104170683  LUMO (Ag) = -0.0997878916924098
cycle= 13 E= -75.319559883367  delta_E= 8.53e-14  |g|= 1.58e-09  |ddm|= 1.61e-09
HOMO (B3u) = -0.399880104127216  LUMO (Ag) = -0.0997878916474526
cycle= 14 E= -75.319559883367  delta_E= -2.84e-14  |g|= 1.31e-09  |ddm|= 1.08e-09
HOMO (B3u) = -0.399880104099938  LUMO (Ag) = -0.0997878916242524
cycle= 15 E= -75.3195598833671  delta_E= -1.14e-13  |g|= 1.11e-09  |ddm|= 6.97e-10
HOMO (B3u) = -0.399880104086465  LUMO (Ag) = -0.0997878916344847
cycle= 16 E= -75.3195598833671  delta_E= 2.84e-14  |g|= 1.01e-09  |ddm|= 9e-10
HOMO (B3u) = -0.399880104058221  LUMO (Ag) = -0.0997878916093153
cycle= 17 E= -75.3195598833671  delta_E= 2.84e-14  |g|= 9.26e-10  |ddm|= 3.42e-10
HOMO (B3u) = -0.399880103907182  LUMO (Ag) = -0.0997878914694936
cycle= 18 E= -75.319559883367  delta_E= 5.68e-14  |g|= 4.03e-10  |ddm|= 2.15e-09
HOMO (B3u) = -0.399880103908235  LUMO (Ag) = -0.0997878914634885
cycle= 19 E= -75.3195598833671  delta_E= -1.14e-13  |g|= 3.3e-10  |ddm|= 3.17e-10
HOMO (B3u) = -0.399880103926838  LUMO (Ag) = -0.0997878914761571
cycle= 20 E= -75.3195598833671  delta_E= 2.84e-14  |g|= 2.64e-10  |ddm|= 2.27e-10
HOMO (B3u) = -0.39988010393837  LUMO (Ag) = -0.0997878914830142
cycle= 21 E= -75.319559883367  delta_E= 5.68e-14  |g|= 2.17e-10  |ddm|= 1.65e-10
HOMO (B3u) = -0.399880103945825  LUMO (Ag) = -0.099787891489618
cycle= 22 E= -75.3195598833671  delta_E= -2.84e-14  |g|= 1.76e-10  |ddm|= 1.3e-10
HOMO (B3u) = -0.399880103951559  LUMO (Ag) = -0.0997878914949612
cycle= 23 E= -75.3195598833671  delta_E= -5.68e-14  |g|= 1.42e-10  |ddm|= 1.08e-10
HOMO (B3u) = -0.399880103957389  LUMO (Ag) = -0.0997878915007947
cycle= 24 E= -75.319559883367  delta_E= 1.14e-13  |g|= 1.14e-10  |ddm|= 1.04e-10
HOMO (B3u) = -0.399880103962192  LUMO (Ag) = -0.0997878915047473
cycle= 25 E= -75.319559883367  delta_E= -2.84e-14  |g|= 8.75e-11  |ddm|= 8.46e-11
HOMO (B3u) = -0.399880103965888  LUMO (Ag) = -0.0997878915075497
cycle= 26 E= -75.319559883367  delta_E= 8.53e-14  |g|= 6.24e-11  |ddm|= 7.76e-11
HOMO (B3u) = -0.3998801039645  LUMO (Ag) = -0.0997878915052894
cycle= 27 E= -75.3195598833671  delta_E= -1.42e-13  |g|= 5.08e-11  |ddm|= 2.69e-11
HOMO (B3u) = -0.39988010396289  LUMO (Ag) = -0.0997878915030673
cycle= 28 E= -75.3195598833671  delta_E= 2.84e-14  |g|= 4.11e-11  |ddm|= 2.03e-11
HOMO (B2u) = -0.39988010396175  LUMO (Ag) = -0.0997878915015592
cycle= 29 E= -75.3195598833669  delta_E= 1.42e-13  |g|= 3.32e-11  |ddm|= 1.6e-11
HOMO (B2u) = -0.399880103960879  LUMO (Ag) = -0.0997878915005081
cycle= 30 E= -75.319559883367  delta_E= -8.53e-14  |g|= 2.65e-11  |ddm|= 1.28e-11
HOMO (B2u) = -0.39988010396028  LUMO (Ag) = -0.0997878914997534
cycle= 31 E= -75.319559883367  delta_E=    0  |g|= 2.11e-11  |ddm|= 1.03e-11
HOMO (B3u) = -0.399880103959738  LUMO (Ag) = -0.0997878914984706
Extra cycle  E= -75.319559883367  delta_E=    0  |g|= 6.81e-12  |ddm|= 2.47e-11
converged SCF energy = -75.319559883367

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp5ctnyxcj
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5069071999528  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5287942623678  dE = -0.021887062  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.72  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5408991693862  dE = -0.012104907  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0689  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5490639029596  dE = -0.0081647336  S^2 = 0.0000000
               |grad[o]|=0.093  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5550610059754  dE = -0.005997103  S^2 = 0.0000000
               |grad[o]|=0.0741  |ddm|=0.0189  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5595129978588  dE = -0.0044519919  S^2 = 0.0000000
               |grad[o]|=0.0577  |ddm|=0.0126  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5626837707656  dE = -0.0031707729  S^2 = 0.0000000
               |grad[o]|=0.043  |ddm|=0.00882  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5647161333965  dE = -0.0020323626  S^2 = 0.0000000
               |grad[o]|=0.0294  |ddm|=0.00676  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5657087101227  dE = -0.00099257673  S^2 = 0.0000000
               |grad[o]|=0.0169  |ddm|=0.00658  |maxRot[o]|=0.0799
macro iter 9 (4 JK  0 micro), CASSCF E = -75.565845329849  dE = -0.00013661973  S^2 = 0.0000000
               |grad[o]|=0.00539  |ddm|=0.00791  |maxRot[o]|= 0.04
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5658470539865  dE = -1.7241375e-06  S^2 = 0.0000000
               |grad[o]|=0.000739  |ddm|=0.00486  |maxRot[o]|=0.00387
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5658470909476  dE = -3.6961126e-08  S^2 = 0.0000000
               |grad[o]|=0.000114  |ddm|=0.000648  |maxRot[o]|=0.000437
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5658470916857  dE = -7.3808337e-10  S^2 = 0.0000000
               |grad[o]|=1.91e-05  |ddm|=8.13e-05  |maxRot[o]|=6.69e-05
macro iter 13 (3 JK  0 micro), CASSCF E = -75.565847091702  dE = -1.628564e-11  S^2 = 0.0000000
               |grad[o]|=2.73e-06  |ddm|=1.31e-05  |maxRot[o]|=1.18e-05
2-step CASSCF converged in 13 macro (64 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97493415 1.71266198 1.80128063 1.80127968 0.2974251  0.19483039
 0.1948301  0.02275797]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00688   0.00368   0.00000   0.00000  -0.00082
  0 C 2s       0.62688   0.59446  -0.00000  -0.00000  -0.32511
  0 C 3s      -0.02821   0.00928  -0.00000  -0.00000   0.01701
  0 C 2px      0.00000  -0.00000  -0.00000   0.70649   0.00000
  0 C 2py     -0.00000  -0.00000   0.70649  -0.00000   0.00000
  0 C 2pz      0.32333  -0.38275   0.00000  -0.00000   0.62577
  0 C 3px      0.00000  -0.00000   0.00000   0.01921   0.00000
  0 C 3py     -0.00000   0.00000   0.01921   0.00000  -0.00000
  0 C 3pz     -0.02927  -0.00203  -0.00000  -0.00000  -0.04115
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02251   0.00000  -0.00000
  0 C 3dz^2    0.02800  -0.00269  -0.00000  -0.00000   0.02714
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02251   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00688  -0.00368   0.00000   0.00000  -0.00082
  1 C 2s       0.62688  -0.59446   0.00000   0.00000  -0.32511
  1 C 3s      -0.02821  -0.00928   0.00000   0.00000   0.01701
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70649  -0.00000
  1 C 2py      0.00000  -0.00000   0.70649  -0.00000   0.00000
  1 C 2pz     -0.32333  -0.38275  -0.00000  -0.00000  -0.62577
  1 C 3px     -0.00000   0.00000   0.00000   0.01921  -0.00000
  1 C 3py      0.00000  -0.00000   0.01921   0.00000  -0.00000
  1 C 3pz      0.02927  -0.00203  -0.00000  -0.00000   0.04115
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02251  -0.00000  -0.00000
  1 C 3dz^2    0.02800   0.00269  -0.00000   0.00000   0.02714
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02251   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.38221
  0 C 3s      -0.00000  -0.00000  -0.04321
  0 C 2px      0.70662  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70662  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.59260
  0 C 3px     -0.01471  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01471  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02126
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02171  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02074
  0 C 3dxz    -0.02171  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.38221
  1 C 3s       0.00000   0.00000   0.04321
  1 C 2px     -0.70662   0.00000   0.00000
  1 C 2py      0.00000  -0.70662   0.00000
  1 C 2pz     -0.00000  -0.00000   0.59260
  1 C 3px      0.01471   0.00000   0.00000
  1 C 3py      0.00000   0.01471   0.00000
  1 C 3pz     -0.00000  -0.00000   0.02126
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02171  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02074
  1 C 3dxz    -0.02171  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99150096
<CAS-nat-orb|mo-hf>  4  4    0.99751312
<CAS-nat-orb|mo-hf>  5  5    0.99943968
<CAS-nat-orb|mo-hf>  6  6    0.99943968
<CAS-nat-orb|mo-hf>  7  7    0.97389130
<CAS-nat-orb|mo-hf>  8  8    0.97085580
<CAS-nat-orb|mo-hf>  9  9    0.97085576
<CAS-nat-orb|mo-hf>  10  10    0.72379474
<CAS-nat-orb|mo-hf>  10  14   -0.61908421
CASSCF energy = -75.565847091702
CASCI E = -75.565847091702  E(CI) = -16.3640995525063  S^2 = 0.0000000
Density matrix diagonal elements [1.97493419 1.71266134 1.80128111 1.80128068 0.29742571 0.19482968
 0.19482934 0.02275795]
i = 1  <i|F|i> = -11.33444963
i = 2  <i|F|i> = -11.33436997
i = 3  <i|F|i> =  -0.90863638
i = 4  <i|F|i> =  -0.49791672
i = 5  <i|F|i> =  -0.33617932
i = 6  <i|F|i> =  -0.33617925
i = 7  <i|F|i> =  -0.09869923
i = 8  <i|F|i> =   0.12544862
i = 9  <i|F|i> =   0.12544873
i = 10  <i|F|i> =   0.59516688
i = 11  <i|F|i> =   0.64702856
i = 12  <i|F|i> =   0.68483865
i = 13  <i|F|i> =   0.68483864
i = 14  <i|F|i> =   0.56673412
i = 15  <i|F|i> =   0.73250757
i = 16  <i|F|i> =   0.70962832
i = 17  <i|F|i> =   0.70962827
i = 18  <i|F|i> =   1.07526638
i = 19  <i|F|i> =   1.24234087
i = 20  <i|F|i> =   1.24234086
i = 21  <i|F|i> =   1.28407754
i = 22  <i|F|i> =   1.28407754
i = 23  <i|F|i> =   1.54043780
i = 24  <i|F|i> =   1.54043780
i = 25  <i|F|i> =   1.83915494
i = 26  <i|F|i> =   1.94428771
i = 27  <i|F|i> =   1.94428772
i = 28  <i|F|i> =   2.13016395
......production of RDMs took       1.85 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.83 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.63 sec

E(WickSCNEVPT2-ijrs) =    -0.00027688237226
E(WickSCNEVPT2- rsi) =    -0.00087092236885
E(WickSCNEVPT2- ijr) =    -0.00036390081008
E(WickSCNEVPT2-  rs) =    -0.03430270990662
E(WickSCNEVPT2-  ij) =    -0.00009970130228
E(WickSCNEVPT2-  ir) =    -0.00114029586022
E(WickSCNEVPT2-   r) =    -0.05221371476577
E(WickSCNEVPT2-   i) =    -0.00023128135931
E(WickSCNEVPT2) = -75.65534650044741  E_corr_pt = -0.08949940874539195
Timings = pdms =   31.76 | eris =    0.30 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.02 | r =    0.52 | i =    0.24
Time cost =    311.650
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:15:16 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.561072772214 AA    0.000000000000   0.000000000000   2.950000000000 Bohr   0.0

nuclear repulsion = 12.2033898305085
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.475]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7398.23


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpbafvcsob
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0186954217207

WARN: Singularity detected in overlap matrix (condition number =  236). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.165974687131635  LUMO (Ag) = -0.158079543422896
cycle= 1 E= -75.2873378760355  delta_E= -0.269  |g|= 0.239  |ddm|= 1.43
HOMO (B3u) = -0.431571893819985  LUMO (Ag) = -0.149790781563185
cycle= 2 E= -75.3090731833373  delta_E= -0.0217  |g|= 0.0507  |ddm|= 0.316
HOMO (B2u) = -0.393547996937855  LUMO (Ag) = -0.100989331184846
cycle= 3 E= -75.3100918952136  delta_E= -0.00102  |g|= 0.0127  |ddm|= 0.0544
HOMO (B3u) = -0.395075054129109  LUMO (Ag) = -0.0978528282721969
cycle= 4 E= -75.3101958879618  delta_E= -0.000104  |g|= 0.00229  |ddm|= 0.0157
HOMO (B3u) = -0.395838291352907  LUMO (Ag) = -0.0984379062399655
cycle= 5 E= -75.3101998099164  delta_E= -3.92e-06  |g|= 0.000326  |ddm|= 0.00328
HOMO (B2u) = -0.395768945444502  LUMO (Ag) = -0.0983739814936242
cycle= 6 E= -75.3101998734464  delta_E= -6.35e-08  |g|= 4.1e-05  |ddm|= 0.000649
HOMO (B3u) = -0.3957609545034  LUMO (Ag) = -0.0983611341563398
cycle= 7 E= -75.3101998745661  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000143
HOMO (B3u) = -0.395760469633699  LUMO (Ag) = -0.0983600611975822
cycle= 8 E= -75.310199874582  delta_E= -1.59e-11  |g|= 5.2e-07  |ddm|= 2.23e-05
HOMO (B2u) = -0.395760436404868  LUMO (Ag) = -0.0983598792416386
cycle= 9 E= -75.3101998745822  delta_E= -1.28e-13  |g|= 2.17e-08  |ddm|= 1.39e-06
HOMO (B2u) = -0.395760429248384  LUMO (Ag) = -0.0983598897706417
cycle= 10 E= -75.3101998745822  delta_E=    0  |g|= 3.33e-09  |ddm|= 8.05e-08
HOMO (B3u) = -0.395760430325855  LUMO (Ag) = -0.0983598908616538
cycle= 11 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 2.59e-09  |ddm|= 4.27e-09
HOMO (B2u) = -0.395760430014859  LUMO (Ag) = -0.0983598904651992
cycle= 12 E= -75.3101998745822  delta_E= 2.84e-14  |g|= 1.94e-09  |ddm|= 2.47e-09
HOMO (B2u) = -0.395760430008569  LUMO (Ag) = -0.0983598903360794
cycle= 13 E= -75.3101998745823  delta_E= -8.53e-14  |g|= 1.67e-09  |ddm|= 1.77e-09
HOMO (B2u) = -0.39576042995668  LUMO (Ag) = -0.0983598902852299
cycle= 14 E= -75.3101998745821  delta_E= 1.71e-13  |g|= 1.39e-09  |ddm|= 9.83e-10
HOMO (B2u) = -0.395760429928329  LUMO (Ag) = -0.0983598902664376
cycle= 15 E= -75.3101998745822  delta_E= -8.53e-14  |g|= 1.19e-09  |ddm|= 8e-10
HOMO (B2u) = -0.395760429913413  LUMO (Ag) = -0.0983598902680438
cycle= 16 E= -75.3101998745822  delta_E= -2.84e-14  |g|= 1.06e-09  |ddm|= 8.03e-10
HOMO (B2u) = -0.395760429891963  LUMO (Ag) = -0.0983598902484079
cycle= 17 E= -75.3101998745821  delta_E= 9.95e-14  |g|= 9.59e-10  |ddm|= 4.22e-10
HOMO (B2u) = -0.395760429734503  LUMO (Ag) = -0.0983598901197892
cycle= 18 E= -75.3101998745822  delta_E= -7.11e-14  |g|= 4.21e-10  |ddm|= 2.31e-09
HOMO (B3u) = -0.395760429735038  LUMO (Ag) = -0.0983598901135651
cycle= 19 E= -75.3101998745822  delta_E= -1.42e-14  |g|= 3.44e-10  |ddm|= 3.34e-10
HOMO (B3u) = -0.395760429753968  LUMO (Ag) = -0.0983598901269001
cycle= 20 E= -75.3101998745822  delta_E= 4.26e-14  |g|= 2.78e-10  |ddm|= 2.27e-10
HOMO (B2u) = -0.39576042976547  LUMO (Ag) = -0.0983598901337266
cycle= 21 E= -75.3101998745822  delta_E= -7.11e-14  |g|= 2.31e-10  |ddm|= 1.71e-10
HOMO (B2u) = -0.395760429772708  LUMO (Ag) = -0.098359890140813
cycle= 22 E= -75.3101998745822  delta_E= 1.42e-14  |g|= 1.87e-10  |ddm|= 1.33e-10
HOMO (B2u) = -0.395760429778203  LUMO (Ag) = -0.098359890146506
cycle= 23 E= -75.3101998745822  delta_E=    0  |g|= 1.51e-10  |ddm|= 1.13e-10
HOMO (B2u) = -0.395760429784156  LUMO (Ag) = -0.0983598901529739
cycle= 24 E= -75.3101998745822  delta_E= 1.42e-14  |g|= 1.2e-10  |ddm|= 1.11e-10
HOMO (B2u) = -0.395760429789066  LUMO (Ag) = -0.0983598901578719
cycle= 25 E= -75.3101998745821  delta_E= 7.11e-14  |g|= 9.18e-11  |ddm|= 9.33e-11
HOMO (B3u) = -0.395760429793045  LUMO (Ag) = -0.0983598901618792
cycle= 26 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 6.6e-11  |ddm|= 8.5e-11
HOMO (B2u) = -0.395760429791673  LUMO (Ag) = -0.0983598901597978
cycle= 27 E= -75.3101998745822  delta_E=    0  |g|= 5.39e-11  |ddm|= 2.88e-11
HOMO (B3u) = -0.395760429786396  LUMO (Ag) = -0.0983598901539625
Extra cycle  E= -75.3101998745822  delta_E= -4.26e-14  |g|= 1.67e-11  |ddm|= 7.72e-11
converged SCF energy = -75.3101998745822

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpbafvcsob
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.499829537802  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5213335335738  dE = -0.021503996  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5334161381941  dE = -0.012082605  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0682  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5415789229047  dE = -0.0081627847  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0323  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.547512401009  dE = -0.0059334781  S^2 = 0.0000000
               |grad[o]|=0.0732  |ddm|=0.0196  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5518257257331  dE = -0.0043133247  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0131  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.55479137052  dE = -0.0029656448  S^2 = 0.0000000
               |grad[o]|=0.0409  |ddm|=0.00918  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5565626349571  dE = -0.0017712644  S^2 = 0.0000000
               |grad[o]|=0.0267  |ddm|=0.00732  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5571750232566  dE = -0.0006123883  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00767  |maxRot[o]|= 0.06
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5572696087176  dE = -9.4585461e-05  S^2 = 0.0000000
               |grad[o]|=0.00458  |ddm|=0.00702  |maxRot[o]|=0.0325
macro iter 10 (3 JK  0 micro), CASSCF E = -75.55727072122  dE = -1.1125024e-06  S^2 = 0.0000000
               |grad[o]|=0.000629  |ddm|=0.00451  |maxRot[o]|=0.00289
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5572707457968  dE = -2.4576778e-08  S^2 = 0.0000000
               |grad[o]|=9.69e-05  |ddm|=0.000585  |maxRot[o]|=0.000339
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5572707462856  dE = -4.8876814e-10  S^2 = 0.0000000
               |grad[o]|=1.64e-05  |ddm|=7.43e-05  |maxRot[o]|=4.96e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5572707462966  dE = -1.1041834e-11  S^2 = 0.0000000
               |grad[o]|=2.45e-06  |ddm|=1.14e-05  |maxRot[o]|=8.68e-06
2-step CASSCF converged in 13 macro (62 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97414482 1.72120466 1.79044094 1.79044226 0.29254404 0.20379325
 0.20379322 0.02363682]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00710   0.00377   0.00000   0.00000  -0.00079
  0 C 2s       0.62989   0.60047   0.00000   0.00000  -0.31937
  0 C 3s      -0.02627   0.00941  -0.00000   0.00000   0.01911
  0 C 2px     -0.00000   0.00000   0.00000   0.70646  -0.00000
  0 C 2py      0.00000  -0.00000   0.70646  -0.00000  -0.00000
  0 C 2pz      0.31779  -0.37325   0.00000   0.00000   0.62862
  0 C 3px     -0.00000   0.00000  -0.00000   0.02107  -0.00000
  0 C 3py      0.00000  -0.00000   0.02107  -0.00000  -0.00000
  0 C 3pz     -0.02764  -0.00196  -0.00000   0.00000  -0.04016
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02166  -0.00000  -0.00000
  0 C 3dz^2    0.02729  -0.00296  -0.00000   0.00000   0.02921
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02166  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00710  -0.00377   0.00000   0.00000  -0.00079
  1 C 2s       0.62989  -0.60047   0.00000  -0.00000  -0.31937
  1 C 3s      -0.02627  -0.00941  -0.00000  -0.00000   0.01911
  1 C 2px      0.00000   0.00000  -0.00000   0.70646   0.00000
  1 C 2py      0.00000   0.00000   0.70646   0.00000   0.00000
  1 C 2pz     -0.31779  -0.37325   0.00000   0.00000  -0.62862
  1 C 3px      0.00000  -0.00000  -0.00000   0.02107   0.00000
  1 C 3py     -0.00000   0.00000   0.02107   0.00000   0.00000
  1 C 3pz      0.02764  -0.00196   0.00000   0.00000   0.04016
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02166  -0.00000  -0.00000
  1 C 3dz^2    0.02729   0.00296  -0.00000  -0.00000   0.02921
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02166  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00027
  0 C 2s       0.00000   0.00000   0.37274
  0 C 3s       0.00000  -0.00000  -0.04290
  0 C 2px      0.70665  -0.00000   0.00000
  0 C 2py     -0.00000   0.70665   0.00000
  0 C 2pz      0.00000  -0.00000   0.59862
  0 C 3px     -0.01384   0.00000   0.00000
  0 C 3py      0.00000  -0.01384  -0.00000
  0 C 3pz      0.00000  -0.00000   0.02142
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02139  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02055
  0 C 3dxz    -0.02139   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00027
  1 C 2s      -0.00000   0.00000  -0.37274
  1 C 3s      -0.00000   0.00000   0.04290
  1 C 2px     -0.70665   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70665   0.00000
  1 C 2pz      0.00000   0.00000   0.59862
  1 C 3px      0.01384   0.00000  -0.00000
  1 C 3py      0.00000   0.01384   0.00000
  1 C 3pz      0.00000  -0.00000   0.02142
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02139  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02055
  1 C 3dxz    -0.02139  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99129326
<CAS-nat-orb|mo-hf>  4  4    0.99742902
<CAS-nat-orb|mo-hf>  5  5    0.99939339
<CAS-nat-orb|mo-hf>  6  6    0.99939339
<CAS-nat-orb|mo-hf>  7  7    0.97366309
<CAS-nat-orb|mo-hf>  8  8    0.97269185
<CAS-nat-orb|mo-hf>  9  9    0.97269186
<CAS-nat-orb|mo-hf>  10  10    0.74746745
<CAS-nat-orb|mo-hf>  10  14   -0.59840371
CASSCF energy = -75.5572707462966
CASCI E = -75.5572707462966  E(CI) = -16.2620310686456  S^2 = 0.0000000
Density matrix diagonal elements [1.97414479 1.72120402 1.79044158 1.79044347 0.29254381 0.20379274
 0.20379282 0.02363676]
i = 1  <i|F|i> = -11.33741014
i = 2  <i|F|i> = -11.33741861
i = 3  <i|F|i> =  -0.90045847
i = 4  <i|F|i> =  -0.50431181
i = 5  <i|F|i> =  -0.33072493
i = 6  <i|F|i> =  -0.33072527
i = 7  <i|F|i> =  -0.09657174
i = 8  <i|F|i> =   0.11587127
i = 9  <i|F|i> =   0.11587130
i = 10  <i|F|i> =   0.56778911
i = 11  <i|F|i> =   0.65028751
i = 12  <i|F|i> =   0.68649158
i = 13  <i|F|i> =   0.68649158
i = 14  <i|F|i> =   0.56906859
i = 15  <i|F|i> =   0.73533713
i = 16  <i|F|i> =   0.71010574
i = 17  <i|F|i> =   0.71010575
i = 18  <i|F|i> =   1.07039694
i = 19  <i|F|i> =   1.23404376
i = 20  <i|F|i> =   1.23404377
i = 21  <i|F|i> =   1.28869943
i = 22  <i|F|i> =   1.28869943
i = 23  <i|F|i> =   1.53258608
i = 24  <i|F|i> =   1.53258608
i = 25  <i|F|i> =   1.81117988
i = 26  <i|F|i> =   1.92775170
i = 27  <i|F|i> =   1.92775168
i = 28  <i|F|i> =   2.12554407
......production of RDMs took       1.84 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.89 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickSCNEVPT2-ijrs) =    -0.00027603158347
E(WickSCNEVPT2- rsi) =    -0.00086482026346
E(WickSCNEVPT2- ijr) =    -0.00035768225269
E(WickSCNEVPT2-  rs) =    -0.03391352096645
E(WickSCNEVPT2-  ij) =    -0.00009517881666
E(WickSCNEVPT2-  ir) =    -0.00112784273203
E(WickSCNEVPT2-   r) =    -0.05305598540500
E(WickSCNEVPT2-   i) =    -0.00022545088649
E(WickSCNEVPT2) = -75.64718725920285  E_corr_pt = -0.0899165129062392
Timings = pdms =   31.94 | eris =    0.01 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.57 | i =    0.27
Time cost =    157.426
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:17:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.587531632760 AA    0.000000000000   0.000000000000   3.000000000000 Bohr   0.0

nuclear repulsion = 12
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.5]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7461.05


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpglzjqnd3
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9888325390205

WARN: Singularity detected in overlap matrix (condition number =  219). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.16026848860678  LUMO (Ag) = -0.156209924431071
cycle= 1 E= -75.2773690146387  delta_E= -0.289  |g|= 0.241  |ddm|= 1.43
HOMO (B2u) = -0.427459076932469  LUMO (Ag) = -0.148855300078027
cycle= 2 E= -75.2996288397616  delta_E= -0.0223  |g|= 0.0503  |ddm|= 0.321
HOMO (B2u) = -0.389387614274558  LUMO (Ag) = -0.0993360736972417
cycle= 3 E= -75.3006548036907  delta_E= -0.00103  |g|= 0.013  |ddm|= 0.0545
HOMO (B3u) = -0.39107500180769  LUMO (Ag) = -0.096313313287663
cycle= 4 E= -75.300763401749  delta_E= -0.000109  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.391819817512154  LUMO (Ag) = -0.0969078799501824
cycle= 5 E= -75.3007673195955  delta_E= -3.92e-06  |g|= 0.000327  |ddm|= 0.00318
HOMO (B3u) = -0.391752968347544  LUMO (Ag) = -0.0968518020879552
cycle= 6 E= -75.3007673825198  delta_E= -6.29e-08  |g|= 4.07e-05  |ddm|= 0.000647
HOMO (B3u) = -0.391745163678231  LUMO (Ag) = -0.0968392001457724
cycle= 7 E= -75.3007673836116  delta_E= -1.09e-09  |g|= 5.16e-06  |ddm|= 0.00013
HOMO (B3u) = -0.391744579298907  LUMO (Ag) = -0.0968381087429909
cycle= 8 E= -75.3007673836275  delta_E= -1.59e-11  |g|= 5.37e-07  |ddm|= 2.12e-05
HOMO (B3u) = -0.391744545069323  LUMO (Ag) = -0.0968379095777782
cycle= 9 E= -75.3007673836276  delta_E= -1.28e-13  |g|= 2.23e-08  |ddm|= 1.2e-06
HOMO (B3u) = -0.391744537674297  LUMO (Ag) = -0.0968379222718547
cycle= 10 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 3.48e-09  |ddm|= 8.33e-08
HOMO (B3u) = -0.3917445387834  LUMO (Ag) = -0.09683792341499
cycle= 11 E= -75.3007673836275  delta_E= 7.11e-14  |g|= 2.63e-09  |ddm|= 4.53e-09
HOMO (B3u) = -0.391744538505575  LUMO (Ag) = -0.0968379230556905
cycle= 12 E= -75.3007673836277  delta_E= -1.14e-13  |g|= 2e-09  |ddm|= 2.59e-09
HOMO (B3u) = -0.391744538510616  LUMO (Ag) = -0.0968379229129834
cycle= 13 E= -75.3007673836277  delta_E= -2.84e-14  |g|= 1.76e-09  |ddm|= 1.81e-09
HOMO (B3u) = -0.391744538456187  LUMO (Ag) = -0.0968379228641036
cycle= 14 E= -75.3007673836277  delta_E= 1.42e-14  |g|= 1.47e-09  |ddm|= 9.42e-10
HOMO (B3u) = -0.391744538422892  LUMO (Ag) = -0.096837922845267
cycle= 15 E= -75.3007673836276  delta_E= 1.14e-13  |g|= 1.27e-09  |ddm|= 8.89e-10
HOMO (B3u) = -0.391744538403728  LUMO (Ag) = -0.0968379228367202
cycle= 16 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 1.14e-09  |ddm|= 6.92e-10
HOMO (B3u) = -0.391744538390087  LUMO (Ag) = -0.0968379228224105
cycle= 17 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 1e-09  |ddm|= 4.87e-10
HOMO (B3u) = -0.391744538229883  LUMO (Ag) = -0.0968379227085945
cycle= 18 E= -75.3007673836276  delta_E=    0  |g|= 4.41e-10  |ddm|= 2.45e-09
HOMO (B2u) = -0.391744538229819  LUMO (Ag) = -0.0968379227020963
cycle= 19 E= -75.3007673836275  delta_E= 1.28e-13  |g|= 3.6e-10  |ddm|= 3.48e-10
HOMO (B2u) = -0.391744538248043  LUMO (Ag) = -0.0968379227153243
cycle= 20 E= -75.3007673836276  delta_E= -8.53e-14  |g|= 2.95e-10  |ddm|= 2.34e-10
HOMO (B2u) = -0.39174453825967  LUMO (Ag) = -0.0968379227222116
cycle= 21 E= -75.3007673836276  delta_E= -4.26e-14  |g|= 2.47e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.39174453826654  LUMO (Ag) = -0.0968379227297549
cycle= 22 E= -75.3007673836276  delta_E=    0  |g|= 2e-10  |ddm|= 1.37e-10
HOMO (B3u) = -0.391744538271795  LUMO (Ag) = -0.0968379227358045
cycle= 23 E= -75.3007673836276  delta_E= 5.68e-14  |g|= 1.62e-10  |ddm|= 1.17e-10
HOMO (B3u) = -0.391744538277749  LUMO (Ag) = -0.0968379227428056
cycle= 24 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 1.28e-10  |ddm|= 1.16e-10
HOMO (B3u) = -0.39174453828262  LUMO (Ag) = -0.0968379227484695
cycle= 25 E= -75.3007673836276  delta_E= 5.68e-14  |g|= 9.73e-11  |ddm|= 1.01e-10
HOMO (B3u) = -0.39174453828683  LUMO (Ag) = -0.0968379227536583
cycle= 26 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 7.05e-11  |ddm|= 9.22e-11
HOMO (B3u) = -0.391744538285512  LUMO (Ag) = -0.0968379227518166
cycle= 27 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 5.79e-11  |ddm|= 3.08e-11
HOMO (B2u) = -0.391744538283885  LUMO (Ag) = -0.096837922749906
cycle= 28 E= -75.3007673836276  delta_E= 5.68e-14  |g|= 4.73e-11  |ddm|= 2.32e-11
HOMO (B3u) = -0.391744538282664  LUMO (Ag) = -0.0968379227486503
cycle= 29 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 3.84e-11  |ddm|= 1.86e-11
HOMO (B3u) = -0.391744538281678  LUMO (Ag) = -0.0968379227478516
cycle= 30 E= -75.3007673836276  delta_E= 1.42e-14  |g|= 3.07e-11  |ddm|= 1.52e-11
HOMO (B2u) = -0.391744538280993  LUMO (Ag) = -0.0968379227473383
cycle= 31 E= -75.3007673836275  delta_E= 7.11e-14  |g|= 2.44e-11  |ddm|= 1.24e-11
HOMO (B2u) = -0.391744538280543  LUMO (Ag) = -0.096837922747041
cycle= 32 E= -75.3007673836276  delta_E= -9.95e-14  |g|= 1.92e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.391744538280271  LUMO (Ag) = -0.0968379227468618
cycle= 33 E= -75.3007673836276  delta_E= 2.84e-14  |g|= 1.51e-11  |ddm|= 7.59e-12
HOMO (B2u) = -0.39174453828015  LUMO (Ag) = -0.0968379227467833
cycle= 34 E= -75.3007673836275  delta_E= 5.68e-14  |g|= 1.21e-11  |ddm|= 5.4e-12
HOMO (B2u) = -0.391744538280158  LUMO (Ag) = -0.096837922746775
cycle= 35 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 9.86e-12  |ddm|= 3.58e-12
HOMO (B2u) = -0.391744538280137  LUMO (Ag) = -0.0968379227467647
cycle= 36 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 8.02e-12  |ddm|= 2.9e-12
HOMO (B3u) = -0.39174453828009  LUMO (Ag) = -0.0968379227467469
cycle= 37 E= -75.3007673836276  delta_E= 2.84e-14  |g|= 6.49e-12  |ddm|= 2.34e-12
HOMO (B3u) = -0.391744538280031  LUMO (Ag) = -0.0968379227467218
cycle= 38 E= -75.3007673836276  delta_E= 2.84e-14  |g|= 5.22e-12  |ddm|= 1.89e-12
HOMO (B3u) = -0.391744538279969  LUMO (Ag) = -0.0968379227466892
cycle= 39 E= -75.3007673836277  delta_E= -9.95e-14  |g|= 4.2e-12  |ddm|= 1.5e-12
HOMO (B3u) = -0.391744538279907  LUMO (Ag) = -0.0968379227466508
cycle= 40 E= -75.3007673836276  delta_E= 8.53e-14  |g|= 3.38e-12  |ddm|= 1.19e-12
HOMO (B2u) = -0.391744538279848  LUMO (Ag) = -0.0968379227466081
cycle= 41 E= -75.3007673836276  delta_E=    0  |g|= 2.73e-12  |ddm|= 9.52e-13
HOMO (B2u) = -0.391744538279666  LUMO (Ag) = -0.0968379227464782
Extra cycle  E= -75.3007673836276  delta_E= -2.84e-14  |g|= 9.35e-13  |ddm|= 2.68e-12
converged SCF energy = -75.3007673836276

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpglzjqnd3
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4927493145095  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.513884857011  dE = -0.021135543  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5259228808435  dE = -0.012038024  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.53406731458  dE = -0.0081444337  S^2 = 0.0000000
               |grad[o]|=0.0918  |ddm|=0.0329  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5399163566917  dE = -0.0058490421  S^2 = 0.0000000
               |grad[o]|=0.0719  |ddm|=0.0206  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5440667830708  dE = -0.0041504264  S^2 = 0.0000000
               |grad[o]|=0.0544  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.546799667042  dE = -0.002732884  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00993  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5482783207084  dE = -0.0014786537  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00842  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5486404656313  dE = -0.00036214492  S^2 = 0.0000000
               |grad[o]|=0.00986  |ddm|=0.00938  |maxRot[o]|= 0.06
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5486450984633  dE = -4.632832e-06  S^2 = 0.0000000
               |grad[o]|=0.00124  |ddm|=0.0088  |maxRot[o]|=0.00593
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5486452003136  dE = -1.0185035e-07  S^2 = 0.0000000
               |grad[o]|=0.000216  |ddm|=0.00137  |maxRot[o]|=0.00062
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5486452023076  dE = -1.9939534e-09  S^2 = 0.0000000
               |grad[o]|=3.57e-05  |ddm|=0.000184  |maxRot[o]|=8.97e-05
macro iter 12 (3 JK  0 micro), CASSCF E = -75.548645202353  dE = -4.5361048e-11  S^2 = 0.0000000
               |grad[o]|=5.19e-06  |ddm|=2.78e-05  |maxRot[o]|=1.6e-05
2-step CASSCF converged in 12 macro (59 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97338733 1.72966171 1.77895355 1.77895233 0.28849582 0.21301943
 0.21301931 0.02451051]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00731   0.00385   0.00000   0.00000  -0.00077
  0 C 2s       0.63288   0.60630   0.00000  -0.00000  -0.31355
  0 C 3s      -0.02435   0.00955  -0.00000  -0.00000   0.02103
  0 C 2px      0.00000  -0.00000  -0.00000   0.70643  -0.00000
  0 C 2py     -0.00000   0.00000   0.70643   0.00000  -0.00000
  0 C 2pz      0.31214  -0.36370  -0.00000  -0.00000   0.63146
  0 C 3px      0.00000  -0.00000  -0.00000   0.02283  -0.00000
  0 C 3py      0.00000  -0.00000   0.02283   0.00000  -0.00000
  0 C 3pz     -0.02602  -0.00192  -0.00000  -0.00000  -0.03894
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02081   0.00000  -0.00000
  0 C 3dz^2    0.02662  -0.00320  -0.00000  -0.00000   0.03135
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02081  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00731  -0.00385   0.00000   0.00000  -0.00077
  1 C 2s       0.63288  -0.60630   0.00000   0.00000  -0.31355
  1 C 3s      -0.02435  -0.00955   0.00000   0.00000   0.02103
  1 C 2px     -0.00000   0.00000   0.00000   0.70643   0.00000
  1 C 2py      0.00000   0.00000   0.70643  -0.00000   0.00000
  1 C 2pz     -0.31214  -0.36370   0.00000   0.00000  -0.63146
  1 C 3px     -0.00000   0.00000   0.00000   0.02283   0.00000
  1 C 3py      0.00000  -0.00000   0.02283  -0.00000   0.00000
  1 C 3pz      0.02602  -0.00192  -0.00000  -0.00000   0.03894
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02081   0.00000  -0.00000
  1 C 3dz^2    0.02662   0.00320   0.00000   0.00000   0.03135
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02081  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s       0.00000   0.00000   0.36324
  0 C 3s      -0.00000   0.00000  -0.04243
  0 C 2px      0.70668   0.00000  -0.00000
  0 C 2py     -0.00000   0.70668  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.60447
  0 C 3px     -0.01294  -0.00000   0.00000
  0 C 3py      0.00000  -0.01294   0.00000
  0 C 3pz     -0.00000   0.00000   0.02137
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02104   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02031
  0 C 3dxz    -0.02104  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000  -0.00000  -0.36324
  1 C 3s       0.00000  -0.00000   0.04243
  1 C 2px     -0.70668   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70668  -0.00000
  1 C 2pz      0.00000   0.00000   0.60447
  1 C 3px      0.01294  -0.00000   0.00000
  1 C 3py      0.00000   0.01294  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02137
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02104   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02031
  1 C 3dxz    -0.02104   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99111461
<CAS-nat-orb|mo-hf>  4  4    0.99735746
<CAS-nat-orb|mo-hf>  5  5    0.99934482
<CAS-nat-orb|mo-hf>  6  6    0.99934482
<CAS-nat-orb|mo-hf>  7  7    0.97351400
<CAS-nat-orb|mo-hf>  8  8    0.97438519
<CAS-nat-orb|mo-hf>  9  9    0.97438516
<CAS-nat-orb|mo-hf>  10  10    0.76990744
<CAS-nat-orb|mo-hf>  10  14   -0.57655943
CASSCF energy = -75.548645202353
CASCI E = -75.548645202353  E(CI) = -16.1630327259085  S^2 = 0.0000000
Density matrix diagonal elements [1.97338725 1.72966045 1.77895714 1.77895491 0.28849393 0.21301797
 0.21301783 0.02451053]
i = 1  <i|F|i> = -11.34010200
i = 2  <i|F|i> = -11.34019149
i = 3  <i|F|i> =  -0.89254590
i = 4  <i|F|i> =  -0.51067752
i = 5  <i|F|i> =  -0.32529928
i = 6  <i|F|i> =  -0.32529889
i = 7  <i|F|i> =  -0.09451543
i = 8  <i|F|i> =   0.10666230
i = 9  <i|F|i> =   0.10666229
i = 10  <i|F|i> =   0.54201106
i = 11  <i|F|i> =   0.65336423
i = 12  <i|F|i> =   0.68788273
i = 13  <i|F|i> =   0.68788273
i = 14  <i|F|i> =   0.57150006
i = 15  <i|F|i> =   0.73861562
i = 16  <i|F|i> =   0.71061555
i = 17  <i|F|i> =   0.71061552
i = 18  <i|F|i> =   1.06569795
i = 19  <i|F|i> =   1.22671867
i = 20  <i|F|i> =   1.22671865
i = 21  <i|F|i> =   1.29334206
i = 22  <i|F|i> =   1.29334206
i = 23  <i|F|i> =   1.52503672
i = 24  <i|F|i> =   1.52503672
i = 25  <i|F|i> =   1.78270165
i = 26  <i|F|i> =   1.91118298
i = 27  <i|F|i> =   1.91118302
i = 28  <i|F|i> =   2.12246764
......production of RDMs took       4.22 sec
......reading the RDM took          0.46 sec
......production of RDMs took      60.68 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickSCNEVPT2-ijrs) =    -0.00027556391324
E(WickSCNEVPT2- rsi) =    -0.00085972617476
E(WickSCNEVPT2- ijr) =    -0.00035161795228
E(WickSCNEVPT2-  rs) =    -0.03354030486675
E(WickSCNEVPT2-  ij) =    -0.00009083567062
E(WickSCNEVPT2-  ir) =    -0.00111607067968
E(WickSCNEVPT2-   r) =    -0.05390336080960
E(WickSCNEVPT2-   i) =    -0.00021959680525
E(WickSCNEVPT2) = -75.63900227922514  E_corr_pt = -0.09035707687218288
Timings = pdms =   75.10 | eris =    0.03 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.58 | i =    0.28
Time cost =    187.104
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:21:00 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.613990493306 AA    0.000000000000   0.000000000000   3.050000000000 Bohr   0.0

nuclear repulsion = 11.8032786885246
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.525]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7565.60


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpxtn8vuz4
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9606241516019

WARN: Singularity detected in overlap matrix (condition number =  203). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.154846704479716  LUMO (Ag) = -0.154379304561515

WARN: Ag LUMO -0.154379304561515 < system HOMO -0.154846704479716


WARN: B2u HOMO -0.154846704479716 > system LUMO -0.154379304561515


WARN: B3u HOMO -0.154846704479716 > system LUMO -0.154379304561515

cycle= 1 E= -75.2674224197194  delta_E= -0.307  |g|= 0.242  |ddm|= 1.42
HOMO (B3u) = -0.423431408188683  LUMO (Ag) = -0.147745494594374
cycle= 2 E= -75.2901719236938  delta_E= -0.0227  |g|= 0.0499  |ddm|= 0.326
HOMO (B2u) = -0.385318413495458  LUMO (Ag) = -0.0975529483033093
cycle= 3 E= -75.2912021417109  delta_E= -0.00103  |g|= 0.0132  |ddm|= 0.0546
HOMO (B3u) = -0.387177687087389  LUMO (Ag) = -0.0946950408357199
cycle= 4 E= -75.291314408399  delta_E= -0.000112  |g|= 0.00225  |ddm|= 0.0161
HOMO (B2u) = -0.387899311052258  LUMO (Ag) = -0.0952945928883288
cycle= 5 E= -75.2913182764059  delta_E= -3.87e-06  |g|= 0.000326  |ddm|= 0.00311
HOMO (B3u) = -0.387835444387874  LUMO (Ag) = -0.0952466102829212
cycle= 6 E= -75.2913183380416  delta_E= -6.16e-08  |g|= 4.01e-05  |ddm|= 0.000644
HOMO (B3u) = -0.387827943274185  LUMO (Ag) = -0.0952344140423388
cycle= 7 E= -75.2913183390841  delta_E= -1.04e-09  |g|= 5.01e-06  |ddm|= 0.000118
HOMO (B3u) = -0.38782727640127  LUMO (Ag) = -0.0952333329362455
cycle= 8 E= -75.2913183390996  delta_E= -1.55e-11  |g|= 5.51e-07  |ddm|= 1.99e-05
HOMO (B3u) = -0.387827240724853  LUMO (Ag) = -0.0952331169889099
cycle= 9 E= -75.2913183390998  delta_E= -1.42e-13  |g|= 2.29e-08  |ddm|= 1.04e-06
HOMO (B2u) = -0.387827233118364  LUMO (Ag) = -0.0952331317889676
cycle= 10 E= -75.2913183390997  delta_E= 7.11e-14  |g|= 3.63e-09  |ddm|= 8.55e-08
HOMO (B2u) = -0.387827234291154  LUMO (Ag) = -0.0952331330214353
cycle= 11 E= -75.2913183390997  delta_E= -4.26e-14  |g|= 2.64e-09  |ddm|= 5.05e-09
HOMO (B2u) = -0.387827234014554  LUMO (Ag) = -0.0952331326637916
cycle= 12 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 2.05e-09  |ddm|= 2.41e-09
HOMO (B2u) = -0.387827234012782  LUMO (Ag) = -0.0952331324868701
cycle= 13 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 1.85e-09  |ddm|= 1.69e-09
HOMO (B2u) = -0.387827233970933  LUMO (Ag) = -0.0952331324569892
cycle= 14 E= -75.2913183390999  delta_E= -5.68e-14  |g|= 1.55e-09  |ddm|= 1.03e-09
HOMO (B2u) = -0.387827233948759  LUMO (Ag) = -0.095233132459693
cycle= 15 E= -75.2913183390998  delta_E= 8.53e-14  |g|= 1.35e-09  |ddm|= 1.05e-09
HOMO (B2u) = -0.387827233907026  LUMO (Ag) = -0.0952331324190702
cycle= 16 E= -75.2913183390998  delta_E=    0  |g|= 1.21e-09  |ddm|= 4.04e-10
HOMO (B2u) = -0.387827233900504  LUMO (Ag) = -0.0952331324084392
cycle= 17 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 1.05e-09  |ddm|= 5.32e-10
HOMO (B2u) = -0.387827233741219  LUMO (Ag) = -0.0952331323123496
cycle= 18 E= -75.2913183390997  delta_E= 1.14e-13  |g|= 4.6e-10  |ddm|= 2.57e-09
HOMO (B2u) = -0.387827233740552  LUMO (Ag) = -0.095233132305583
cycle= 19 E= -75.2913183390997  delta_E= -1.42e-14  |g|= 3.76e-10  |ddm|= 3.58e-10
HOMO (B2u) = -0.38782723375858  LUMO (Ag) = -0.09523313231909
cycle= 20 E= -75.2913183390998  delta_E= -9.95e-14  |g|= 3.11e-10  |ddm|= 2.31e-10
HOMO (B2u) = -0.387827233770307  LUMO (Ag) = -0.0952331323260115
cycle= 21 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 2.64e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.387827233776462  LUMO (Ag) = -0.0952331323338156
cycle= 22 E= -75.2913183390998  delta_E= 1.42e-14  |g|= 2.14e-10  |ddm|= 1.42e-10
HOMO (B2u) = -0.387827233781413  LUMO (Ag) = -0.0952331323401946
cycle= 23 E= -75.2913183390997  delta_E= 7.11e-14  |g|= 1.74e-10  |ddm|= 1.2e-10
HOMO (B2u) = -0.387827233787541  LUMO (Ag) = -0.095233132347703
cycle= 24 E= -75.2913183390997  delta_E= -2.84e-14  |g|= 1.37e-10  |ddm|= 1.15e-10
HOMO (B2u) = -0.387827233792201  LUMO (Ag) = -0.0952331323538759
cycle= 25 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 1.04e-10  |ddm|= 1.07e-10
HOMO (B2u) = -0.387827233796528  LUMO (Ag) = -0.0952331323600997
cycle= 26 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 7.54e-11  |ddm|= 9.84e-11
HOMO (B2u) = -0.38782723379525  LUMO (Ag) = -0.095233132358478
cycle= 27 E= -75.2913183390998  delta_E= 4.26e-14  |g|= 6.23e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.387827233793624  LUMO (Ag) = -0.0952331323567316
cycle= 28 E= -75.2913183390998  delta_E= -1.42e-14  |g|= 5.13e-11  |ddm|= 2.43e-11
HOMO (B2u) = -0.387827233792373  LUMO (Ag) = -0.095233132355609
cycle= 29 E= -75.2913183390997  delta_E= 5.68e-14  |g|= 4.18e-11  |ddm|= 1.97e-11
HOMO (B2u) = -0.387827233791344  LUMO (Ag) = -0.0952331323549469
cycle= 30 E= -75.2913183390997  delta_E=    0  |g|= 3.35e-11  |ddm|= 1.63e-11
HOMO (B3u) = -0.38782723378976  LUMO (Ag) = -0.095233132354284
Extra cycle  E= -75.2913183390998  delta_E= -5.68e-14  |g|= 1.11e-11  |ddm|= 4.21e-11
converged SCF energy = -75.2913183390998

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpxtn8vuz4
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4857258490083  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5064676357521  dE = -0.020741787  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.68  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5184322415604  dE = -0.011964606  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0656  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5265434924926  dE = -0.0081112509  S^2 = 0.0000000
               |grad[o]|=0.0908  |ddm|=0.0339  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5322928409387  dE = -0.0057493484  S^2 = 0.0000000
               |grad[o]|=0.0705  |ddm|=0.0223  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5362657476443  dE = -0.0039729067  S^2 = 0.0000000
               |grad[o]|=0.0523  |ddm|=0.0155  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5387478318593  dE = -0.0024820842  S^2 = 0.0000000
               |grad[o]|=0.0357  |ddm|=0.0116  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5399094906494  dE = -0.0011616588  S^2 = 0.0000000
               |grad[o]|=0.0201  |ddm|=0.0105  |maxRot[o]|=0.0799
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5400388138306  dE = -0.00012932318  S^2 = 0.0000000
               |grad[o]|=0.00582  |ddm|=0.0121  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5400404965115  dE = -1.6826808e-06  S^2 = 0.0000000
               |grad[o]|=0.000811  |ddm|=0.00672  |maxRot[o]|=0.00294
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5400405390596  dE = -4.2548109e-08  S^2 = 0.0000000
               |grad[o]|=0.000142  |ddm|=0.00102  |maxRot[o]|=0.000305
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5400405400962  dE = -1.0365682e-09  S^2 = 0.0000000
               |grad[o]|=2.61e-05  |ddm|=0.000167  |maxRot[o]|=3.42e-05
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5400405401232  dE = -2.7000624e-11  S^2 = 0.0000000
               |grad[o]|=4.51e-06  |ddm|=2.97e-05  |maxRot[o]|=5.56e-06
2-step CASSCF converged in 12 macro (58 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97266787 1.73807369 1.7667182  1.7667191  0.2854188  0.22251155
 0.2225117  0.02537908]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00752   0.00393   0.00000   0.00000  -0.00075
  0 C 2s       0.63584   0.61195  -0.00000  -0.00000  -0.30764
  0 C 3s      -0.02245   0.00972   0.00000   0.00000   0.02272
  0 C 2px     -0.00000   0.00000  -0.00000   0.70640   0.00000
  0 C 2py     -0.00000   0.00000   0.70640  -0.00000   0.00000
  0 C 2pz      0.30639  -0.35411   0.00000   0.00000   0.63428
  0 C 3px     -0.00000  -0.00000  -0.00000   0.02449   0.00000
  0 C 3py     -0.00000   0.00000   0.02449  -0.00000   0.00000
  0 C 3pz     -0.02442  -0.00191   0.00000   0.00000  -0.03747
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.01996  -0.00000   0.00000
  0 C 3dz^2    0.02599  -0.00343   0.00000   0.00000   0.03354
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.01996   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00752  -0.00393   0.00000   0.00000  -0.00075
  1 C 2s       0.63584  -0.61195  -0.00000  -0.00000  -0.30764
  1 C 3s      -0.02245  -0.00972  -0.00000  -0.00000   0.02272
  1 C 2px     -0.00000   0.00000   0.00000   0.70640  -0.00000
  1 C 2py      0.00000  -0.00000   0.70640   0.00000   0.00000
  1 C 2pz     -0.30639  -0.35411  -0.00000   0.00000  -0.63428
  1 C 3px      0.00000  -0.00000   0.00000   0.02449  -0.00000
  1 C 3py      0.00000  -0.00000   0.02449   0.00000  -0.00000
  1 C 3pz      0.02442  -0.00191   0.00000   0.00000   0.03747
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.01996  -0.00000   0.00000
  1 C 3dz^2    0.02599   0.00343  -0.00000  -0.00000   0.03354
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.01996   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.35370
  0 C 3s       0.00000   0.00000  -0.04177
  0 C 2px      0.70670  -0.00000   0.00000
  0 C 2py     -0.00000   0.70670  -0.00000
  0 C 2pz      0.00000  -0.00000   0.61017
  0 C 3px     -0.01201   0.00000   0.00000
  0 C 3py      0.00000  -0.01201  -0.00000
  0 C 3pz      0.00000   0.00000   0.02109
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02067  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01998
  0 C 3dxz    -0.02067   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s      -0.00000  -0.00000  -0.35370
  1 C 3s      -0.00000  -0.00000   0.04177
  1 C 2px     -0.70670  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70670   0.00000
  1 C 2pz      0.00000  -0.00000   0.61017
  1 C 3px      0.01201   0.00000  -0.00000
  1 C 3py      0.00000   0.01201   0.00000
  1 C 3pz      0.00000   0.00000   0.02109
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02067  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.01998
  1 C 3dxz    -0.02067  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99096817
<CAS-nat-orb|mo-hf>  4  4    0.99730115
<CAS-nat-orb|mo-hf>  5  5    0.99929408
<CAS-nat-orb|mo-hf>  6  6    0.99929409
<CAS-nat-orb|mo-hf>  7  7    0.97345968
<CAS-nat-orb|mo-hf>  8  8    0.97595059
<CAS-nat-orb|mo-hf>  9  9    0.97595060
<CAS-nat-orb|mo-hf>  10  10    0.79085176
<CAS-nat-orb|mo-hf>  10  14   -0.55411998
CASSCF energy = -75.5400405401232
CASCI E = -75.5400405401232  E(CI) = -16.0670213510594  S^2 = 0.0000000
Density matrix diagonal elements [1.97266775 1.73807363 1.76672143 1.76672194 0.28541535 0.22251047
 0.22251033 0.02537909]
i = 1  <i|F|i> = -11.34252690
i = 2  <i|F|i> = -11.34269151
i = 3  <i|F|i> =  -0.88490500
i = 4  <i|F|i> =  -0.51702296
i = 5  <i|F|i> =  -0.31987896
i = 6  <i|F|i> =  -0.31987906
i = 7  <i|F|i> =  -0.09258009
i = 8  <i|F|i> =   0.09780954
i = 9  <i|F|i> =   0.09780956
i = 10  <i|F|i> =   0.51775934
i = 11  <i|F|i> =   0.65630299
i = 12  <i|F|i> =   0.68901597
i = 13  <i|F|i> =   0.68901597
i = 14  <i|F|i> =   0.57399584
i = 15  <i|F|i> =   0.74230828
i = 16  <i|F|i> =   0.71116258
i = 17  <i|F|i> =   0.71116260
i = 18  <i|F|i> =   1.06116920
i = 19  <i|F|i> =   1.22037212
i = 20  <i|F|i> =   1.22037212
i = 21  <i|F|i> =   1.29798890
i = 22  <i|F|i> =   1.29798890
i = 23  <i|F|i> =   1.51778762
i = 24  <i|F|i> =   1.51778762
i = 25  <i|F|i> =   1.75389495
i = 26  <i|F|i> =   1.89460363
i = 27  <i|F|i> =   1.89460362
i = 28  <i|F|i> =   2.12067216
......production of RDMs took       1.82 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.21 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.61 sec

E(WickSCNEVPT2-ijrs) =    -0.00027547136441
E(WickSCNEVPT2- rsi) =    -0.00085560629233
E(WickSCNEVPT2- ijr) =    -0.00034571999743
E(WickSCNEVPT2-  rs) =    -0.03318536017275
E(WickSCNEVPT2-  ij) =    -0.00008667550015
E(WickSCNEVPT2-  ir) =    -0.00110499964456
E(WickSCNEVPT2-   r) =    -0.05475604550638
E(WickSCNEVPT2-   i) =    -0.00021371149732
E(WickSCNEVPT2) = -75.6308641300985  E_corr_pt = -0.0908235899753225
Timings = pdms =   32.08 | eris =    0.01 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.53 | i =    0.24
Time cost =     70.533
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:22:11 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.640449353852 AA    0.000000000000   0.000000000000   3.100000000000 Bohr   0.0

nuclear repulsion = 11.6129032258065
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.55]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7608.57


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpen9annzx
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9340105731017

WARN: Singularity detected in overlap matrix (condition number =  188). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.149693266404789  LUMO (B3u) = -0.149693266404789

WARN: B2u HOMO -0.149693266404789 > system LUMO -0.149693266404789

cycle= 1 E= -75.3573845713053  delta_E= -0.423  |g|= 0.265  |ddm|= 1.55
HOMO (B2u) = -0.413310367291845  LUMO (B3u) = -0.0846696262312548
cycle= 2 E= -75.3843760014416  delta_E= -0.027  |g|= 0.0539  |ddm|= 0.354
HOMO (B2u) = -0.373182146511252  LUMO (B3u) = -0.0395668514335564
cycle= 3 E= -75.3858456567449  delta_E= -0.00147  |g|= 0.018  |ddm|= 0.0717
HOMO (B2u) = -0.377721327859488  LUMO (B3u) = -0.0440841679310596
cycle= 4 E= -75.3860530258635  delta_E= -0.000207  |g|= 0.000721  |ddm|= 0.0382
HOMO (B2u) = -0.377699771169469  LUMO (B3u) = -0.0442008432276685
cycle= 5 E= -75.3860532373451  delta_E= -2.11e-07  |g|= 8.07e-05  |ddm|= 0.00144
HOMO (B2u) = -0.377674560909568  LUMO (B3u) = -0.0441740446286827
cycle= 6 E= -75.3860532409993  delta_E= -3.65e-09  |g|= 1.32e-05  |ddm|= 0.000134
HOMO (B2u) = -0.377672848926092  LUMO (B3u) = -0.044175801509025
cycle= 7 E= -75.3860532411126  delta_E= -1.13e-10  |g|= 1.86e-06  |ddm|= 3.43e-05
HOMO (B2u) = -0.37767210044314  LUMO (B3u) = -0.0441752784120207
cycle= 8 E= -75.3860532411149  delta_E= -2.22e-12  |g|= 1.02e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.377672134543062  LUMO (B3u) = -0.0441753126352445
cycle= 9 E= -75.3860532411149  delta_E= -2.84e-14  |g|= 9.15e-09  |ddm|= 2.08e-07
HOMO (B2u) = -0.377672135423389  LUMO (B3u) = -0.0441753150829187
cycle= 10 E= -75.3860532411149  delta_E=    0  |g|= 5.29e-09  |ddm|= 8.76e-09
HOMO (B2u) = -0.377672135483835  LUMO (B3u) = -0.0441753151230324
cycle= 11 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 4.99e-09  |ddm|= 4.29e-09
HOMO (B2u) = -0.377672134119825  LUMO (B3u) = -0.0441753136889755
cycle= 12 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 4.61e-09  |ddm|= 2.32e-09
HOMO (B2u) = -0.377672133910599  LUMO (B3u) = -0.0441753133919444
cycle= 13 E= -75.3860532411148  delta_E= 7.11e-14  |g|= 9.11e-10  |ddm|= 7.57e-09
HOMO (B2u) = -0.377672133972788  LUMO (B3u) = -0.0441753134340407
cycle= 14 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 7.91e-10  |ddm|= 4.43e-10
HOMO (B2u) = -0.377672134141226  LUMO (B3u) = -0.0441753135500954
cycle= 15 E= -75.3860532411149  delta_E=    0  |g|= 6.67e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.377672134097074  LUMO (B3u) = -0.0441753135968617
cycle= 16 E= -75.3860532411149  delta_E= -8.53e-14  |g|= 7.84e-10  |ddm|= 1.29e-09
HOMO (B2u) = -0.37767213414862  LUMO (B3u) = -0.0441753136133675
cycle= 17 E= -75.3860532411149  delta_E= 4.26e-14  |g|= 8.41e-10  |ddm|= 6.61e-10
HOMO (B2u) = -0.377672134162078  LUMO (B3u) = -0.0441753136097736
cycle= 18 E= -75.3860532411148  delta_E= 7.11e-14  |g|= 5.73e-10  |ddm|= 5.54e-10
HOMO (B2u) = -0.377672134187349  LUMO (B3u) = -0.044175313633846
cycle= 19 E= -75.3860532411149  delta_E= -2.84e-14  |g|= 4.46e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.377672134218691  LUMO (B3u) = -0.044175313662681
cycle= 20 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 3.16e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.377672134234056  LUMO (B3u) = -0.0441753136723535
cycle= 21 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 1.88e-10  |ddm|= 2.77e-10
HOMO (B2u) = -0.377672134234343  LUMO (B3u) = -0.0441753136702812
cycle= 22 E= -75.3860532411149  delta_E=    0  |g|= 1.63e-10  |ddm|= 7.58e-11
HOMO (B2u) = -0.377672134234184  LUMO (B3u) = -0.044175313668597
cycle= 23 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 1.44e-10  |ddm|= 6.7e-11
HOMO (B2u) = -0.377672134231501  LUMO (B3u) = -0.0441753136668676
cycle= 24 E= -75.3860532411149  delta_E= 4.26e-14  |g|= 1.31e-10  |ddm|= 5.93e-11
HOMO (B2u) = -0.37767213423442  LUMO (B3u) = -0.0441753136670273
cycle= 25 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 1.06e-10  |ddm|= 6.66e-11
HOMO (B2u) = -0.377672134236875  LUMO (B3u) = -0.0441753136680539
cycle= 26 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 7.9e-11  |ddm|= 6.25e-11
HOMO (B2u) = -0.377672134238174  LUMO (B3u) = -0.0441753136685322
cycle= 27 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 6.08e-11  |ddm|= 4.3e-11
HOMO (B2u) = -0.377672134239297  LUMO (B3u) = -0.044175313668892
cycle= 28 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 4.61e-11  |ddm|= 3.45e-11
HOMO (B2u) = -0.377672134240361  LUMO (B3u) = -0.0441753136693565
cycle= 29 E= -75.3860532411149  delta_E= 8.53e-14  |g|= 3.57e-11  |ddm|= 2.52e-11
HOMO (B2u) = -0.377672134241072  LUMO (B3u) = -0.0441753136697268
cycle= 30 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 3e-11  |ddm|= 1.56e-11
HOMO (B2u) = -0.377672134241625  LUMO (B3u) = -0.0441753136700056
cycle= 31 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 2.5e-11  |ddm|= 1.35e-11
HOMO (B2u) = -0.377672134242063  LUMO (B3u) = -0.0441753136702055
cycle= 32 E= -75.3860532411149  delta_E=    0  |g|= 2.03e-11  |ddm|= 1.2e-11
HOMO (B2u) = -0.377672134243448  LUMO (B3u) = -0.0441753136707494
Extra cycle  E= -75.3860532411149  delta_E=    0  |g|= 6.55e-12  |ddm|= 3.44e-11
converged SCF energy = -75.3860532411149

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpen9annzx
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4764159496082  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4872396096411  dE = -0.01082366  S^2 = 0.0000000
               |grad[o]|=0.0774  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4972270887886  dE = -0.0099874791  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0605  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5063987161879  dE = -0.0091716274  S^2 = 0.0000000
               |grad[o]|=0.0682  |ddm|=0.0991  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5143818192383  dE = -0.0079831031  S^2 = 0.0000000
               |grad[o]|=0.0667  |ddm|=0.194  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5204922499907  dE = -0.0061104308  S^2 = 0.0000000
               |grad[o]|=0.0614  |ddm|=0.222  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5243786184213  dE = -0.0038863684  S^2 = 0.0000000
               |grad[o]|=0.048  |ddm|=0.157  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.525753421205  dE = -0.0013748028  S^2 = 0.0000000
               |grad[o]|=0.0286  |ddm|=  0.1  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5259733306675  dE = -0.00021990946  S^2 = 0.0000000
               |grad[o]|=0.0122  |ddm|=0.0931  |maxRot[o]|=0.0188
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5262794789197  dE = -0.00030614825  S^2 = 0.0000000
               |grad[o]|=0.0118  |ddm|=0.171  |maxRot[o]|=0.00855
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5272581186315  dE = -0.00097863971  S^2 = 0.0000000
               |grad[o]|=0.022  |ddm|=0.309  |maxRot[o]|=0.019
macro iter 11 (4 JK  0 micro), CASSCF E = -75.5294134818012  dE = -0.0021553632  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.465  |maxRot[o]|=0.0329
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5311332614766  dE = -0.0017197797  S^2 = 0.0000000
               |grad[o]|=0.0308  |ddm|=0.348  |maxRot[o]|= 0.04
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5314667398081  dE = -0.00033347833  S^2 = 0.0000000
               |grad[o]|=0.0126  |ddm|=0.107  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5315144591071  dE = -4.7719299e-05  S^2 = 0.0000000
               |grad[o]|=0.00437  |ddm|=0.0224  |maxRot[o]|=0.00856
macro iter 15 (3 JK  0 micro), CASSCF E = -75.53151758872  dE = -3.1296129e-06  S^2 = 0.0000000
               |grad[o]|=0.00109  |ddm|=0.00794  |maxRot[o]|=0.00211
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5315177947157  dE = -2.0599568e-07  S^2 = 0.0000000
               |grad[o]|=0.000288  |ddm|=0.00204  |maxRot[o]|=0.000518
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5315178084867  dE = -1.3770972e-08  S^2 = 0.0000000
               |grad[o]|=7.68e-05  |ddm|=0.000533  |maxRot[o]|=0.000129
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5315178094244  dE = -9.3773167e-10  S^2 = 0.0000000
               |grad[o]|=2.05e-05  |ddm|=0.00014  |maxRot[o]|=3.33e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.531517809487  dE = -6.2598815e-11  S^2 = 0.0000000
               |grad[o]|=5.47e-06  |ddm|=3.78e-05  |maxRot[o]|=8.79e-06
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5315178094906  dE = -3.6521897e-12  S^2 = 0.0000000
               |grad[o]|=1.41e-06  |ddm|=9.82e-06  |maxRot[o]|=2.34e-06
2-step CASSCF converged in 20 macro (80 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97199268 1.74648642 0.28354296 1.75359769 1.75359611 0.2322697
 0.23226976 0.02624468]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00771   0.00402  -0.00073   0.00000   0.00000
  0 C 2s       0.63877   0.61742  -0.30165   0.00000   0.00000
  0 C 3s      -0.02059   0.00990   0.02411   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.70637
  0 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  0 C 2pz      0.30053  -0.34447   0.63708  -0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000   0.02607
  0 C 3py      0.00000  -0.00000   0.00000   0.02607  -0.00000
  0 C 3pz     -0.02284  -0.00193  -0.03571   0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000   0.01911  -0.00000
  0 C 3dz^2    0.02539  -0.00363   0.03576   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000   0.01911
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00771  -0.00402  -0.00073   0.00000   0.00000
  1 C 2s       0.63877  -0.61742  -0.30165  -0.00000  -0.00000
  1 C 3s      -0.02059  -0.00990   0.02411  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000   0.00000   0.70637
  1 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  1 C 2pz     -0.30053  -0.34447  -0.63708  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000   0.02607
  1 C 3py      0.00000  -0.00000  -0.00000   0.02607  -0.00000
  1 C 3pz      0.02284  -0.00193   0.03571   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01911   0.00000
  1 C 3dz^2    0.02539   0.00363   0.03576  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000  -0.01911
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s       0.00000   0.00000   0.34413
  0 C 3s       0.00000   0.00000  -0.04088
  0 C 2px      0.00000   0.70673   0.00000
  0 C 2py      0.70673   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.61571
  0 C 3px      0.00000  -0.01104   0.00000
  0 C 3py     -0.01104   0.00000   0.00000
  0 C 3pz      0.00000   0.00000   0.02055
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.02028   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01955
  0 C 3dxz     0.00000  -0.02028   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.34413
  1 C 3s      -0.00000  -0.00000   0.04088
  1 C 2px     -0.00000  -0.70673  -0.00000
  1 C 2py     -0.70673  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.61571
  1 C 3px     -0.00000   0.01104  -0.00000
  1 C 3py      0.01104  -0.00000  -0.00000
  1 C 3pz      0.00000   0.00000   0.02055
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.02028   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.01955
  1 C 3dxz     0.00000  -0.02028   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99970732
<CAS-nat-orb|mo-hf>  4  4    0.99969115
<CAS-nat-orb|mo-hf>  5  5    0.99206275
<CAS-nat-orb|mo-hf>  6  6    0.99749856
<CAS-nat-orb|mo-hf>  7  7    0.98939317
<CAS-nat-orb|mo-hf>  8  8    0.97289816
<CAS-nat-orb|mo-hf>  9  9    0.95779871
<CAS-nat-orb|mo-hf>  10  10    0.87337001
<CAS-nat-orb|mo-hf>  10  12   -0.42886300
CASSCF energy = -75.5315178094906
CASCI E = -75.5315178094906  E(CI) = -15.9739146589017  S^2 = 0.0000000
Density matrix diagonal elements [1.97199259 1.7464861  0.28354157 1.75359887 1.75359697 0.23226957
 0.23226961 0.02624474]
i = 1  <i|F|i> = -11.34468693
i = 2  <i|F|i> = -11.34492180
i = 3  <i|F|i> =  -0.87754086
i = 4  <i|F|i> =  -0.52335791
i = 5  <i|F|i> =  -0.09084200
i = 6  <i|F|i> =  -0.31443583
i = 7  <i|F|i> =  -0.31443548
i = 8  <i|F|i> =   0.08930509
i = 9  <i|F|i> =   0.08930510
i = 10  <i|F|i> =   0.49496168
i = 11  <i|F|i> =   0.65916167
i = 12  <i|F|i> =   0.57652368
i = 13  <i|F|i> =   0.68989692
i = 14  <i|F|i> =   0.68989692
i = 15  <i|F|i> =   0.74637407
i = 16  <i|F|i> =   0.71175141
i = 17  <i|F|i> =   0.71175144
i = 18  <i|F|i> =   1.05680805
i = 19  <i|F|i> =   1.21500629
i = 20  <i|F|i> =   1.21500631
i = 21  <i|F|i> =   1.30262422
i = 22  <i|F|i> =   1.30262422
i = 23  <i|F|i> =   1.51083587
i = 24  <i|F|i> =   1.51083587
i = 25  <i|F|i> =   1.72492645
i = 26  <i|F|i> =   1.87803831
i = 27  <i|F|i> =   1.87803834
i = 28  <i|F|i> =   2.11989234
......production of RDMs took       1.81 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.48 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickSCNEVPT2-ijrs) =    -0.00027575425504
E(WickSCNEVPT2- rsi) =    -0.00085243866645
E(WickSCNEVPT2- ijr) =    -0.00033999089623
E(WickSCNEVPT2-  rs) =    -0.03285108906965
E(WickSCNEVPT2-  ij) =    -0.00008269838253
E(WickSCNEVPT2-  ir) =    -0.00109465263223
E(WickSCNEVPT2-   r) =    -0.05561499068331
E(WickSCNEVPT2-   i) =    -0.00020778436202
E(WickSCNEVPT2) = -75.6228372084381  E_corr_pt = -0.09131939894746299
Timings = pdms =   31.50 | eris =    0.61 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.53 | i =    0.24
Time cost =    550.564
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:31:22 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.666908214398 AA    0.000000000000   0.000000000000   3.150000000000 Bohr   0.0

nuclear repulsion = 11.4285714285714
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.575]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7920.61


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp3l66f2rs
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9089301361996

WARN: Singularity detected in overlap matrix (condition number =  175). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.144793107119775  LUMO (B3u) = -0.144793107119776

WARN: B2u HOMO -0.144793107119775 > system LUMO -0.144793107119776

cycle= 1 E= -75.3499635205345  delta_E= -0.441  |g|= 0.262  |ddm|= 1.54
HOMO (B2u) = -0.407994029365035  LUMO (B3u) = -0.0815659278261177
cycle= 2 E= -75.3765746590879  delta_E= -0.0266  |g|= 0.0534  |ddm|= 0.353
HOMO (B2u) = -0.368435737958924  LUMO (B3u) = -0.0370562210896329
cycle= 3 E= -75.3780458200466  delta_E= -0.00147  |g|= 0.0181  |ddm|= 0.0711
HOMO (B2u) = -0.372975542135577  LUMO (B3u) = -0.0415562017768425
cycle= 4 E= -75.3782577251018  delta_E= -0.000212  |g|= 0.000712  |ddm|= 0.0382
HOMO (B2u) = -0.372986320268991  LUMO (B3u) = -0.0417075409102714
cycle= 5 E= -75.3782579293203  delta_E= -2.04e-07  |g|= 8.31e-05  |ddm|= 0.00134
HOMO (B2u) = -0.372958407634993  LUMO (B3u) = -0.0416782676150353
cycle= 6 E= -75.3782579331955  delta_E= -3.88e-09  |g|= 1.36e-05  |ddm|= 0.000138
HOMO (B2u) = -0.372956778075034  LUMO (B3u) = -0.0416799724229582
cycle= 7 E= -75.3782579333153  delta_E= -1.2e-10  |g|= 1.9e-06  |ddm|= 3.4e-05
HOMO (B2u) = -0.372956024408634  LUMO (B3u) = -0.0416794932468547
cycle= 8 E= -75.3782579333177  delta_E= -2.36e-12  |g|= 1.05e-07  |ddm|= 4.17e-06
HOMO (B2u) = -0.372956052025516  LUMO (B3u) = -0.041679519062214
cycle= 9 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 8.2e-09  |ddm|= 2.09e-07
HOMO (B2u) = -0.372956052946303  LUMO (B3u) = -0.0416795215565728
cycle= 10 E= -75.3782579333177  delta_E= -4.26e-14  |g|= 4.91e-09  |ddm|= 8.05e-09
HOMO (B2u) = -0.372956052907041  LUMO (B3u) = -0.0416795214932564
cycle= 11 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 4.53e-09  |ddm|= 4.18e-09
HOMO (B2u) = -0.372956051584459  LUMO (B3u) = -0.0416795201020502
cycle= 12 E= -75.3782579333176  delta_E= 1.14e-13  |g|= 4.18e-09  |ddm|= 2.1e-09
HOMO (B2u) = -0.372956051859839  LUMO (B3u) = -0.0416795203492437
cycle= 13 E= -75.3782579333177  delta_E= -5.68e-14  |g|= 3.58e-09  |ddm|= 9.59e-10
HOMO (B2u) = -0.37295605144232  LUMO (B3u) = -0.0416795198744415
cycle= 14 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 6.87e-10  |ddm|= 5.81e-09
HOMO (B2u) = -0.372956051678623  LUMO (B3u) = -0.0416795200412877
cycle= 15 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 6.54e-10  |ddm|= 1.57e-09
HOMO (B2u) = -0.372956051603964  LUMO (B3u) = -0.041679520081722
cycle= 16 E= -75.3782579333177  delta_E= 5.68e-14  |g|= 8e-10  |ddm|= 1.64e-09
HOMO (B2u) = -0.37295605165609  LUMO (B3u) = -0.0416795200906441
cycle= 17 E= -75.3782579333176  delta_E= 4.26e-14  |g|= 8.09e-10  |ddm|= 7.39e-10
HOMO (B2u) = -0.37295605166283  LUMO (B3u) = -0.0416795200818876
cycle= 18 E= -75.3782579333178  delta_E= -1.28e-13  |g|= 5.76e-10  |ddm|= 4.36e-10
HOMO (B2u) = -0.372956051684792  LUMO (B3u) = -0.0416795201033053
cycle= 19 E= -75.3782579333177  delta_E= 9.95e-14  |g|= 4.86e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.372956051711178  LUMO (B3u) = -0.0416795201278916
cycle= 20 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 3.79e-10  |ddm|= 1.94e-10
HOMO (B2u) = -0.372956051722228  LUMO (B3u) = -0.0416795201341164
cycle= 21 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 2.58e-10  |ddm|= 2.18e-10
HOMO (B2u) = -0.372956051734031  LUMO (B3u) = -0.0416795201426583
cycle= 22 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 1.57e-10  |ddm|= 1.95e-10
HOMO (B2u) = -0.372956051733236  LUMO (B3u) = -0.0416795201402855
cycle= 23 E= -75.3782579333177  delta_E= 4.26e-14  |g|= 1.49e-10  |ddm|= 5.82e-11
HOMO (B2u) = -0.372956051729236  LUMO (B3u) = -0.041679520138045
cycle= 24 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 1.38e-10  |ddm|= 5.99e-11
HOMO (B2u) = -0.372956051732144  LUMO (B3u) = -0.0416795201379926
cycle= 25 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 1.13e-10  |ddm|= 6.49e-11
HOMO (B2u) = -0.372956051734056  LUMO (B3u) = -0.0416795201385805
cycle= 26 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 8.8e-11  |ddm|= 5.32e-11
HOMO (B2u) = -0.372956051735016  LUMO (B3u) = -0.0416795201387548
cycle= 27 E= -75.3782579333177  delta_E= -7.11e-14  |g|= 7.07e-11  |ddm|= 3.76e-11
HOMO (B2u) = -0.372956051735877  LUMO (B3u) = -0.0416795201388616
cycle= 28 E= -75.3782579333177  delta_E=    0  |g|= 5.47e-11  |ddm|= 3.39e-11
HOMO (B2u) = -0.372956051738654  LUMO (B3u) = -0.0416795201397838
Extra cycle  E= -75.3782579333178  delta_E= -2.84e-14  |g|= 1.85e-11  |ddm|= 8.28e-11
converged SCF energy = -75.3782579333178

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp3l66f2rs
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4725934895905  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4837385432457  dE = -0.011145054  S^2 = 0.0000000
               |grad[o]|=0.0791  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4938627006698  dE = -0.010124157  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0567  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5028935336811  dE = -0.009030833  S^2 = 0.0000000
               |grad[o]|=0.0659  |ddm|=0.0667  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5105630063536  dE = -0.0076694727  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5162482933895  dE = -0.005685287  S^2 = 0.0000000
               |grad[o]|=0.051  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5197013967998  dE = -0.0034531034  S^2 = 0.0000000
               |grad[o]|=0.0355  |ddm|=0.0366  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.5210733309299  dE = -0.0013719341  S^2 = 0.0000000
               |grad[o]|=0.0178  |ddm|=0.0634  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5215988184168  dE = -0.00052548749  S^2 = 0.0000000
               |grad[o]|=0.0113  |ddm|=0.115  |maxRot[o]|= 0.02
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5222374490168  dE = -0.0006386306  S^2 = 0.0000000
               |grad[o]|=0.0104  |ddm|=0.0771  |maxRot[o]|=0.033
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5226563533688  dE = -0.00041890435  S^2 = 0.0000000
               |grad[o]|=0.00749  |ddm|=0.064  |maxRot[o]|=0.0335
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5227995203758  dE = -0.00014316701  S^2 = 0.0000000
               |grad[o]|=0.00438  |ddm|=0.0306  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5228528705769  dE = -5.3350201e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.0113  |maxRot[o]|=0.0144
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5228636275606  dE = -1.0756984e-05  S^2 = 0.0000000
               |grad[o]|=0.00112  |ddm|=0.00642  |maxRot[o]|=0.00668
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5228655523389  dE = -1.9247783e-06  S^2 = 0.0000000
               |grad[o]|=0.000479  |ddm|=0.00263  |maxRot[o]|=0.00287
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5228658806959  dE = -3.2835703e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.00108  |maxRot[o]|=0.00119
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5228659357625  dE = -5.5066621e-08  S^2 = 0.0000000
               |grad[o]|=8.2e-05  |ddm|=0.000438  |maxRot[o]|=0.000488
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5228659449376  dE = -9.1750678e-09  S^2 = 0.0000000
               |grad[o]|=3.35e-05  |ddm|=0.000178  |maxRot[o]|=0.000199
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5228659464736  dE = -1.5360229e-09  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.23e-05  |maxRot[o]|=8.09e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.5228659467354  dE = -2.6173552e-10  S^2 = 0.0000000
               |grad[o]|=5.53e-06  |ddm|=2.94e-05  |maxRot[o]|=3.29e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5228659467819  dE = -4.6583182e-11  S^2 = 0.0000000
               |grad[o]|=2.25e-06  |ddm|=1.19e-05  |maxRot[o]|=1.33e-05
2-step CASSCF converged in 20 macro (77 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96757995 1.92636359 1.90257312 1.85304912 0.08669295 0.15330618
 0.05997838 0.05045671]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00942   0.00931  -0.00604   0.00000   0.00000
  0 C 2s       0.58733   0.63316  -0.39276   0.00000  -0.00000
  0 C 3s      -0.02996   0.01840  -0.05304   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69586
  0 C 2py      0.00000   0.00000   0.00000   0.70455   0.00000
  0 C 2pz      0.38981  -0.31366   0.58451   0.00000  -0.00000
  0 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05174
  0 C 3py      0.00000  -0.00000   0.00000   0.04283  -0.00000
  0 C 3pz     -0.02787  -0.00316  -0.00116   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.04212  -0.00000
  0 C 3dz^2    0.03630  -0.01553   0.03447   0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000  -0.11447
 0 C 3dx2-y2  -0.00196   0.00750  -0.00750   0.00000  -0.00000
  1 C 1s       0.00942  -0.00931  -0.00604   0.00000   0.00000
  1 C 2s       0.58733  -0.63316  -0.39276  -0.00000  -0.00000
  1 C 3s      -0.02996  -0.01840  -0.05304  -0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69586
  1 C 2py     -0.00000   0.00000  -0.00000   0.70455   0.00000
  1 C 2pz     -0.38981  -0.31366  -0.58451  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000   0.00000  -0.05174
  1 C 3py     -0.00000  -0.00000  -0.00000   0.04283  -0.00000
  1 C 3pz      0.02787  -0.00316   0.00116   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.04212   0.00000
  1 C 3dz^2    0.03630   0.01553   0.03447  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000   0.11447
 1 C 3dx2-y2  -0.00196  -0.00750  -0.00750   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s       0.00000  -0.00000   0.31126
  0 C 3s       0.00000   0.00000   0.04123
  0 C 2px     -0.00000   0.69686   0.00000
  0 C 2py      0.70644  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.62985
  0 C 3px     -0.00000   0.00767   0.00000
  0 C 3py     -0.02723  -0.00000   0.00000
  0 C 3pz      0.00000   0.00000  -0.05999
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.01434   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000   0.01543
  0 C 3dxz    -0.00000  -0.11967   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02938
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s      -0.00000  -0.00000  -0.31126
  1 C 3s      -0.00000  -0.00000  -0.04123
  1 C 2px     -0.00000  -0.69686  -0.00000
  1 C 2py     -0.70644   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.62985
  1 C 3px      0.00000  -0.00767  -0.00000
  1 C 3py      0.02723   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.05999
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01434  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.01543
  1 C 3dxz    -0.00000  -0.11967   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02938
<CAS-nat-orb|mo-hf>  3  3    0.98488177
<CAS-nat-orb|mo-hf>  4  4    0.99976478
<CAS-nat-orb|mo-hf>  5  5    0.98488756
<CAS-nat-orb|mo-hf>  6  6    0.99934351
<CAS-nat-orb|mo-hf>  7  7    0.94550984
<CAS-nat-orb|mo-hf>  8  8    0.96719800
<CAS-nat-orb|mo-hf>  9  9    0.95784087
<CAS-nat-orb|mo-hf>  10  10    0.82549313
<CAS-nat-orb|mo-hf>  10  11   -0.53364519
CASSCF energy = -75.5228659467819
CASCI E = -75.5228659467819  E(CI) = -15.8845981664487  S^2 = 0.0000000
Density matrix diagonal elements [1.96757991 1.92636425 1.90257844 1.85304905 0.08668752 0.15330602
 0.05997801 0.0504568 ]
i = 1  <i|F|i> = -11.33674529
i = 2  <i|F|i> = -11.33675283
i = 3  <i|F|i> =  -0.88551728
i = 4  <i|F|i> =  -0.59963609
i = 5  <i|F|i> =  -0.40273020
i = 6  <i|F|i> =  -0.33727456
i = 7  <i|F|i> =   0.06361541
i = 8  <i|F|i> =   0.10630660
i = 9  <i|F|i> =   0.20959079
i = 10  <i|F|i> =   0.45728881
i = 11  <i|F|i> =   0.56339554
i = 12  <i|F|i> =   0.68392255
i = 13  <i|F|i> =   0.68760840
i = 14  <i|F|i> =   0.65697447
i = 15  <i|F|i> =   0.73254179
i = 16  <i|F|i> =   0.70900041
i = 17  <i|F|i> =   0.72285354
i = 18  <i|F|i> =   1.05235276
i = 19  <i|F|i> =   1.14674207
i = 20  <i|F|i> =   1.21205890
i = 21  <i|F|i> =   1.29773601
i = 22  <i|F|i> =   1.29790745
i = 23  <i|F|i> =   1.48990403
i = 24  <i|F|i> =   1.48787047
i = 25  <i|F|i> =   1.69726098
i = 26  <i|F|i> =   1.81014255
i = 27  <i|F|i> =   1.87735389
i = 28  <i|F|i> =   2.13374440
......production of RDMs took       1.79 sec
......reading the RDM took          0.45 sec
......production of RDMs took      60.97 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.68 sec

E(WickSCNEVPT2-ijrs) =    -0.00028234425258
E(WickSCNEVPT2- rsi) =    -0.00080811447435
E(WickSCNEVPT2- ijr) =    -0.00029150320021
E(WickSCNEVPT2-  rs) =    -0.03511084068459
E(WickSCNEVPT2-  ij) =    -0.00008990323501
E(WickSCNEVPT2-  ir) =    -0.00108726613729
E(WickSCNEVPT2-   r) =    -0.05488328709617
E(WickSCNEVPT2-   i) =    -0.00009808050130
E(WickSCNEVPT2) = -75.61551728636344  E_corr_pt = -0.0926513395815112
Timings = pdms =   72.88 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.02 | r =    0.54 | i =    0.25
Time cost =    555.835
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:40:37 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.693367074944 AA    0.000000000000   0.000000000000   3.200000000000 Bohr   0.0

nuclear repulsion = 11.25
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.6]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      8108.50


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp81g8_xo_
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8853199307072

WARN: Singularity detected in overlap matrix (condition number =  163). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.140132093357862  LUMO (B3u) = -0.140132093357862

WARN: B2u HOMO -0.140132093357862 > system LUMO -0.140132093357862

cycle= 1 E= -75.3423788059563  delta_E= -0.457  |g|= 0.259  |ddm|= 1.53
HOMO (B2u) = -0.402834374141247  LUMO (B3u) = -0.0785386739836378
cycle= 2 E= -75.3685959970364  delta_E= -0.0262  |g|= 0.053  |ddm|= 0.353
HOMO (B2u) = -0.363851731217672  LUMO (B3u) = -0.034630422436522
cycle= 3 E= -75.3700649559038  delta_E= -0.00147  |g|= 0.0182  |ddm|= 0.0704
HOMO (B2u) = -0.368389012587529  LUMO (B3u) = -0.0391108103436476
cycle= 4 E= -75.3702805696255  delta_E= -0.000216  |g|= 0.000703  |ddm|= 0.0381
HOMO (B2u) = -0.368430097958785  LUMO (B3u) = -0.0392945410036856
cycle= 5 E= -75.37028076688  delta_E= -1.97e-07  |g|= 8.62e-05  |ddm|= 0.00125
HOMO (B2u) = -0.368399790742492  LUMO (B3u) = -0.0392632961118435
cycle= 6 E= -75.3702807710482  delta_E= -4.17e-09  |g|= 1.41e-05  |ddm|= 0.000143
HOMO (B2u) = -0.368398140839544  LUMO (B3u) = -0.0392648663308327
cycle= 7 E= -75.3702807711757  delta_E= -1.28e-10  |g|= 1.92e-06  |ddm|= 3.39e-05
HOMO (B2u) = -0.368397398349188  LUMO (B3u) = -0.0392644368519429
cycle= 8 E= -75.3702807711782  delta_E= -2.44e-12  |g|= 1.08e-07  |ddm|= 4.2e-06
HOMO (B2u) = -0.368397420521526  LUMO (B3u) = -0.0392644560489657
cycle= 9 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 7.49e-09  |ddm|= 2.14e-07
HOMO (B2u) = -0.368397421407989  LUMO (B3u) = -0.0392644585116422
cycle= 10 E= -75.3702807711782  delta_E= -8.53e-14  |g|= 4.69e-09  |ddm|= 7.64e-09
HOMO (B2u) = -0.368397421283678  LUMO (B3u) = -0.0392644583578121
cycle= 11 E= -75.3702807711782  delta_E= 5.68e-14  |g|= 4.19e-09  |ddm|= 4.06e-09
HOMO (B2u) = -0.368397419986717  LUMO (B3u) = -0.0392644569938379
cycle= 12 E= -75.3702807711782  delta_E=    0  |g|= 3.87e-09  |ddm|= 1.95e-09
HOMO (B2u) = -0.368397420307902  LUMO (B3u) = -0.0392644572884979
cycle= 13 E= -75.3702807711782  delta_E=    0  |g|= 3.34e-09  |ddm|= 8.4e-10
HOMO (B2u) = -0.368397419921133  LUMO (B3u) = -0.0392644568733409
cycle= 14 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 5.28e-10  |ddm|= 5e-09
HOMO (B2u) = -0.368397420132693  LUMO (B3u) = -0.0392644570113382
cycle= 15 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 5.84e-10  |ddm|= 1.53e-09
HOMO (B2u) = -0.368397420040914  LUMO (B3u) = -0.0392644570361462
cycle= 16 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 7.31e-10  |ddm|= 1.55e-09
HOMO (B2u) = -0.368397420093294  LUMO (B3u) = -0.0392644570383387
cycle= 17 E= -75.3702807711781  delta_E= 8.53e-14  |g|= 7.08e-10  |ddm|= 8.36e-10
HOMO (B2u) = -0.368397420093641  LUMO (B3u) = -0.0392644570252649
cycle= 18 E= -75.3702807711782  delta_E= -1.14e-13  |g|= 5.02e-10  |ddm|= 3.46e-10
HOMO (B2u) = -0.368397420112435  LUMO (B3u) = -0.0392644570441155
cycle= 19 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 4.32e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.368397420134235  LUMO (B3u) = -0.039264457064857
cycle= 20 E= -75.3702807711782  delta_E=    0  |g|= 3.41e-10  |ddm|= 1.43e-10
HOMO (B2u) = -0.368397420141231  LUMO (B3u) = -0.0392644570678669
cycle= 21 E= -75.3702807711782  delta_E= 5.68e-14  |g|= 2.32e-10  |ddm|= 1.8e-10
HOMO (B2u) = -0.368397420149846  LUMO (B3u) = -0.0392644570741602
cycle= 22 E= -75.3702807711782  delta_E= -4.26e-14  |g|= 1.37e-10  |ddm|= 1.65e-10
HOMO (B2u) = -0.368397420149559  LUMO (B3u) = -0.0392644570722571
cycle= 23 E= -75.3702807711781  delta_E= 5.68e-14  |g|= 1.32e-10  |ddm|= 4.11e-11
HOMO (B2u) = -0.368397420145653  LUMO (B3u) = -0.0392644570701661
cycle= 24 E= -75.3702807711781  delta_E=    0  |g|= 1.23e-10  |ddm|= 5.37e-11
HOMO (B2u) = -0.36839742014831  LUMO (B3u) = -0.0392644570698355
cycle= 25 E= -75.3702807711781  delta_E= 1.42e-14  |g|= 9.97e-11  |ddm|= 5.85e-11
HOMO (B2u) = -0.368397420149557  LUMO (B3u) = -0.0392644570699886
cycle= 26 E= -75.3702807711782  delta_E= -4.26e-14  |g|= 7.84e-11  |ddm|= 4.05e-11
HOMO (B2u) = -0.368397420150068  LUMO (B3u) = -0.0392644570698649
cycle= 27 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 6.42e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.368397420150557  LUMO (B3u) = -0.03926445706973
cycle= 28 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 5.02e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.36839742015113  LUMO (B3u) = -0.0392644570697709
cycle= 29 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 3.86e-11  |ddm|= 2.35e-11
HOMO (B2u) = -0.368397420151516  LUMO (B3u) = -0.0392644570697962
cycle= 30 E= -75.3702807711782  delta_E= 8.53e-14  |g|= 3.08e-11  |ddm|= 1.66e-11
HOMO (B2u) = -0.368397420151826  LUMO (B3u) = -0.0392644570698711
cycle= 31 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 2.65e-11  |ddm|= 1.02e-11
HOMO (B2u) = -0.36839742015203  LUMO (B3u) = -0.0392644570698839
cycle= 32 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 2.2e-11  |ddm|= 1.02e-11
HOMO (B2u) = -0.368397420152341  LUMO (B3u) = -0.0392644570699102
cycle= 33 E= -75.3702807711782  delta_E= -7.11e-14  |g|= 1.78e-11  |ddm|= 9.34e-12
HOMO (B2u) = -0.368397420152531  LUMO (B3u) = -0.0392644570699276
cycle= 34 E= -75.3702807711782  delta_E= 4.26e-14  |g|= 1.44e-11  |ddm|= 7.33e-12
HOMO (B2u) = -0.368397420152671  LUMO (B3u) = -0.0392644570699352
cycle= 35 E= -75.3702807711782  delta_E= -4.26e-14  |g|= 1.17e-11  |ddm|= 5.88e-12
HOMO (B2u) = -0.368397420152779  LUMO (B3u) = -0.0392644570699306
cycle= 36 E= -75.3702807711782  delta_E=    0  |g|= 9.43e-12  |ddm|= 4.99e-12
HOMO (B2u) = -0.368397420153059  LUMO (B3u) = -0.0392644570699008
Extra cycle  E= -75.3702807711782  delta_E= -1.42e-14  |g|= 3.44e-12  |ddm|= 1.34e-11
converged SCF energy = -75.3702807711782

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp81g8_xo_
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4686639234795  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4801659097228  dE = -0.011501986  S^2 = 0.0000000
               |grad[o]|=0.0808  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4904755225454  dE = -0.010309613  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0571  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4994469984847  dE = -0.0089714759  S^2 = 0.0000000
               |grad[o]|=0.0646  |ddm|=0.0512  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5069095409293  dE = -0.0074625424  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0778  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.51236405855  dE = -0.0054545176  S^2 = 0.0000000
               |grad[o]|=0.0456  |ddm|=0.0796  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5156468201258  dE = -0.0032827616  S^2 = 0.0000000
               |grad[o]|=0.0301  |ddm|=0.0211  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5168779321699  dE = -0.001231112  S^2 = 0.0000000
               |grad[o]|=0.015  |ddm|=0.0787  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5176271585394  dE = -0.00074922637  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0722  |maxRot[o]|= 0.04
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5179500779134  dE = -0.00032291937  S^2 = 0.0000000
               |grad[o]|=0.00624  |ddm|=0.0442  |maxRot[o]|=0.0327
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5180290722482  dE = -7.8994335e-05  S^2 = 0.0000000
               |grad[o]|=0.00298  |ddm|=0.0185  |maxRot[o]|=0.0178
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5180431645367  dE = -1.4092288e-05  S^2 = 0.0000000
               |grad[o]|=0.00127  |ddm|=0.00708  |maxRot[o]|=0.0078
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5180453677531  dE = -2.2032165e-06  S^2 = 0.0000000
               |grad[o]|=0.000512  |ddm|=0.00271  |maxRot[o]|=0.00313
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5180456955226  dE = -3.2776947e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.00104  |maxRot[o]|=0.00122
macro iter 14 (3 JK  0 micro), CASSCF E = -75.518045743319  dE = -4.7796433e-08  S^2 = 0.0000000
               |grad[o]|=7.71e-05  |ddm|=0.000395  |maxRot[o]|=0.000466
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5180457501981  dE = -6.8790058e-09  S^2 = 0.0000000
               |grad[o]|=2.95e-05  |ddm|=0.00015  |maxRot[o]|=0.000178
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5180457511752  dE = -9.7709574e-10  S^2 = 0.0000000
               |grad[o]|=1.12e-05  |ddm|=5.71e-05  |maxRot[o]|=6.77e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5180457513066  dE = -1.3147883e-10  S^2 = 0.0000000
               |grad[o]|=4.24e-06  |ddm|=2.16e-05  |maxRot[o]|=2.54e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.518045751323  dE = -1.6385115e-11  S^2 = 0.0000000
               |grad[o]|=1.61e-06  |ddm|=8.17e-06  |maxRot[o]|=9.68e-06
2-step CASSCF converged in 18 macro (71 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9663057  1.92713079 1.90282925 1.84406996 0.08365691 0.16227412
 0.0596417  0.05409157]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00972   0.00945  -0.00589   0.00000   0.00000
  0 C 2s       0.59726   0.63748  -0.37752  -0.00000   0.00000
  0 C 3s      -0.02696   0.01811  -0.05147  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000  -0.00000   0.00000   0.69538
  0 C 2py     -0.00000   0.00000   0.00000   0.70451   0.00000
  0 C 2pz      0.37495  -0.30481   0.59459   0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.05355
  0 C 3py     -0.00000   0.00000   0.00000   0.04456  -0.00000
  0 C 3pz     -0.02582  -0.00292  -0.00005  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.04098  -0.00000
  0 C 3dz^2    0.03462  -0.01515   0.03455  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11653
 0 C 3dx2-y2  -0.00172   0.00737  -0.00749  -0.00000   0.00000
  1 C 1s       0.00972  -0.00945  -0.00589   0.00000   0.00000
  1 C 2s       0.59726  -0.63748  -0.37752  -0.00000   0.00000
  1 C 3s      -0.02696  -0.01811  -0.05147   0.00000   0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69538
  1 C 2py      0.00000  -0.00000   0.00000   0.70451   0.00000
  1 C 2pz     -0.37495  -0.30481  -0.59459  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00000  -0.05355
  1 C 3py      0.00000  -0.00000  -0.00000   0.04456  -0.00000
  1 C 3pz      0.02582  -0.00292   0.00005  -0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.04098   0.00000
  1 C 3dz^2    0.03462   0.01515   0.03455   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000  -0.00000   0.00000   0.11653
 1 C 3dx2-y2  -0.00172  -0.00737  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s      -0.00000   0.00000   0.30262
  0 C 3s      -0.00000   0.00000   0.04028
  0 C 2px      0.00000   0.69699  -0.00000
  0 C 2py      0.70653   0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.63446
  0 C 3px      0.00000   0.00537   0.00000
  0 C 3py     -0.02507   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05718
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01392   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01415
  0 C 3dxz     0.00000  -0.11904   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02809
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000   0.00000  -0.30262
  1 C 3s       0.00000  -0.00000  -0.04028
  1 C 2px     -0.00000  -0.69699  -0.00000
  1 C 2py     -0.70653  -0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.63446
  1 C 3px     -0.00000  -0.00537   0.00000
  1 C 3py      0.02507  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.05718
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.01392   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01415
  1 C 3dxz     0.00000  -0.11904  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02809
<CAS-nat-orb|mo-hf>  3  3    0.98713996
<CAS-nat-orb|mo-hf>  4  4    0.99975825
<CAS-nat-orb|mo-hf>  5  5    0.98714928
<CAS-nat-orb|mo-hf>  6  6    0.99929981
<CAS-nat-orb|mo-hf>  7  7    0.94370155
<CAS-nat-orb|mo-hf>  8  8    0.96917400
<CAS-nat-orb|mo-hf>  9  9    0.95823418
<CAS-nat-orb|mo-hf>  10  10    0.84381041
<CAS-nat-orb|mo-hf>  10  11   -0.50815317
CASSCF energy = -75.518045751323
CASCI E = -75.518045751323  E(CI) = -15.8005832192871  S^2 = 0.0000000
Density matrix diagonal elements [1.96630586 1.92713133 1.90283033 1.84407008 0.08365522 0.162274
 0.05964164 0.05409153]
i = 1  <i|F|i> = -11.33818284
i = 2  <i|F|i> = -11.33824792
i = 3  <i|F|i> =  -0.87927468
i = 4  <i|F|i> =  -0.60319887
i = 5  <i|F|i> =  -0.39717345
i = 6  <i|F|i> =  -0.33144659
i = 7  <i|F|i> =   0.06926816
i = 8  <i|F|i> =   0.09800327
i = 9  <i|F|i> =   0.20617571
i = 10  <i|F|i> =   0.43305052
i = 11  <i|F|i> =   0.56783537
i = 12  <i|F|i> =   0.69022159
i = 13  <i|F|i> =   0.68892872
i = 14  <i|F|i> =   0.65531619
i = 15  <i|F|i> =   0.73417127
i = 16  <i|F|i> =   0.71039014
i = 17  <i|F|i> =   0.72226333
i = 18  <i|F|i> =   1.04724383
i = 19  <i|F|i> =   1.14546059
i = 20  <i|F|i> =   1.20950931
i = 21  <i|F|i> =   1.30325462
i = 22  <i|F|i> =   1.30342988
i = 23  <i|F|i> =   1.48444251
i = 24  <i|F|i> =   1.48257413
i = 25  <i|F|i> =   1.66921916
i = 26  <i|F|i> =   1.79422580
i = 27  <i|F|i> =   1.86103043
i = 28  <i|F|i> =   2.13561226
......production of RDMs took       1.93 sec
......reading the RDM took          0.45 sec
......production of RDMs took      21.14 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickSCNEVPT2-ijrs) =    -0.00028243922577
E(WickSCNEVPT2- rsi) =    -0.00080534278798
E(WickSCNEVPT2- ijr) =    -0.00028784074926
E(WickSCNEVPT2-  rs) =    -0.03491637072770
E(WickSCNEVPT2-  ij) =    -0.00008631943298
E(WickSCNEVPT2-  ir) =    -0.00107600667696
E(WickSCNEVPT2-   r) =    -0.05530054558226
E(WickSCNEVPT2-   i) =    -0.00009304165088
E(WickSCNEVPT2) = -75.61089365815681  E_corr_pt = -0.09284790683380063
Timings = pdms =   33.28 | eris =    0.06 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.53 | i =    0.24
Time cost =    360.852
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:46:38 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.719825935490 AA    0.000000000000   0.000000000000   3.250000000000 Bohr   0.0

nuclear repulsion = 11.0769230769231
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.625]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      8535.92


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpuutfqeo2
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8631164371269

WARN: Singularity detected in overlap matrix (condition number =  151). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.13569696344616  LUMO (B3u) = -0.13569696344616

WARN: B2u HOMO -0.13569696344616 > system LUMO -0.13569696344616

cycle= 1 E= -75.3346710578886  delta_E= -0.472  |g|= 0.257  |ddm|= 1.52
HOMO (B2u) = -0.397829563278945  LUMO (B3u) = -0.0755897093543544
cycle= 2 E= -75.360485940034  delta_E= -0.0258  |g|= 0.0524  |ddm|= 0.352
HOMO (B2u) = -0.35942419421082  LUMO (B3u) = -0.032286636697358
cycle= 3 E= -75.3619492644576  delta_E= -0.00146  |g|= 0.0182  |ddm|= 0.0697
HOMO (B2u) = -0.363955951245317  LUMO (B3u) = -0.0367454491314113
cycle= 4 E= -75.3621677667453  delta_E= -0.000219  |g|= 0.000695  |ddm|= 0.0379
HOMO (B2u) = -0.364024863853047  LUMO (B3u) = -0.0369588213878724
cycle= 5 E= -75.362167957504  delta_E= -1.91e-07  |g|= 8.98e-05  |ddm|= 0.00116
HOMO (B2u) = -0.363992517085416  LUMO (B3u) = -0.0369261206635515
cycle= 6 E= -75.3621679620313  delta_E= -4.53e-09  |g|= 1.46e-05  |ddm|= 0.000149
HOMO (B2u) = -0.363990782245934  LUMO (B3u) = -0.0369275152560893
cycle= 7 E= -75.3621679621673  delta_E= -1.36e-10  |g|= 1.94e-06  |ddm|= 3.41e-05
HOMO (B2u) = -0.363990060624676  LUMO (B3u) = -0.0369271360119105
cycle= 8 E= -75.3621679621696  delta_E= -2.32e-12  |g|= 1.11e-07  |ddm|= 4.19e-06
HOMO (B2u) = -0.36399007836502  LUMO (B3u) = -0.0369271500510073
cycle= 9 E= -75.3621679621697  delta_E= -1.42e-13  |g|= 7.05e-09  |ddm|= 2.21e-07
HOMO (B2u) = -0.363990079145782  LUMO (B3u) = -0.0369271524158624
cycle= 10 E= -75.3621679621697  delta_E= 5.68e-14  |g|= 4.67e-09  |ddm|= 7.46e-09
HOMO (B2u) = -0.363990078979242  LUMO (B3u) = -0.0369271522204963
cycle= 11 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 4e-09  |ddm|= 4.01e-09
HOMO (B2u) = -0.363990077684173  LUMO (B3u) = -0.0369271508576433
cycle= 12 E= -75.3621679621697  delta_E= -5.68e-14  |g|= 3.68e-09  |ddm|= 1.86e-09
HOMO (B2u) = -0.363990078038734  LUMO (B3u) = -0.0369271511892956
cycle= 13 E= -75.3621679621697  delta_E= 7.11e-14  |g|= 3.22e-09  |ddm|= 8.35e-10
HOMO (B2u) = -0.363990077657259  LUMO (B3u) = -0.0369271508032791
cycle= 14 E= -75.3621679621697  delta_E= -9.95e-14  |g|= 4.12e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.363990077851424  LUMO (B3u) = -0.036927150928577
cycle= 15 E= -75.3621679621697  delta_E= 5.68e-14  |g|= 5.37e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.363990077764457  LUMO (B3u) = -0.0369271509412607
cycle= 16 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 6.62e-10  |ddm|= 1.35e-09
HOMO (B2u) = -0.363990077805962  LUMO (B3u) = -0.036927150939642
cycle= 17 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 6.48e-10  |ddm|= 7.17e-10
HOMO (B2u) = -0.363990077800125  LUMO (B3u) = -0.0369271509228915
cycle= 18 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 4.6e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.363990077815576  LUMO (B3u) = -0.0369271509391777
cycle= 19 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 3.99e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.363990077833274  LUMO (B3u) = -0.0369271509566772
cycle= 20 E= -75.3621679621696  delta_E= 8.53e-14  |g|= 3.18e-10  |ddm|= 1.18e-10
HOMO (B2u) = -0.363990077836391  LUMO (B3u) = -0.0369271509567629
cycle= 21 E= -75.3621679621697  delta_E= -5.68e-14  |g|= 2.16e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.363990077841882  LUMO (B3u) = -0.0369271509608895
cycle= 22 E= -75.3621679621696  delta_E= 2.84e-14  |g|= 1.25e-10  |ddm|= 1.53e-10
HOMO (B2u) = -0.363990077841476  LUMO (B3u) = -0.0369271509590004
cycle= 23 E= -75.3621679621698  delta_E= -1.28e-13  |g|= 1.23e-10  |ddm|= 2.67e-11
HOMO (B2u) = -0.363990077837806  LUMO (B3u) = -0.0369271509570287
cycle= 24 E= -75.3621679621697  delta_E= 7.11e-14  |g|= 1.12e-10  |ddm|= 4.75e-11
HOMO (B2u) = -0.363990077839657  LUMO (B3u) = -0.0369271509564533
cycle= 25 E= -75.3621679621698  delta_E= -8.53e-14  |g|= 9.11e-11  |ddm|= 4.86e-11
HOMO (B2u) = -0.363990077840176  LUMO (B3u) = -0.0369271509561638
cycle= 26 E= -75.3621679621697  delta_E= 5.68e-14  |g|= 7.24e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.36399007784019  LUMO (B3u) = -0.0369271509557349
cycle= 27 E= -75.3621679621697  delta_E= 7.11e-14  |g|= 6.02e-11  |ddm|= 2.12e-11
HOMO (B2u) = -0.363990077840264  LUMO (B3u) = -0.0369271509553544
cycle= 28 E= -75.3621679621697  delta_E= -4.26e-14  |g|= 4.74e-11  |ddm|= 2.39e-11
HOMO (B2u) = -0.363990077840499  LUMO (B3u) = -0.0369271509551917
cycle= 29 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 3.66e-11  |ddm|= 2.09e-11
HOMO (B2u) = -0.363990077840629  LUMO (B3u) = -0.0369271509550548
cycle= 30 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 2.92e-11  |ddm|= 1.48e-11
HOMO (B2u) = -0.36399007784077  LUMO (B3u) = -0.0369271509550159
cycle= 31 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 2.52e-11  |ddm|= 8.63e-12
HOMO (B2u) = -0.363990077840825  LUMO (B3u) = -0.0369271509549337
cycle= 32 E= -75.3621679621697  delta_E=    0  |g|= 2.1e-11  |ddm|= 9.09e-12
HOMO (B2u) = -0.363990077841169  LUMO (B3u) = -0.0369271509546964
Extra cycle  E= -75.3621679621697  delta_E= -2.84e-14  |g|= 7.79e-12  |ddm|= 2.77e-11
converged SCF energy = -75.3621679621697

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpuutfqeo2
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4646530045346  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4765356118777  dE = -0.011882607  S^2 = 0.0000000
               |grad[o]|=0.0827  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4870504127969  dE = -0.010514801  S^2 = 0.0000000
               |grad[o]|=0.0737  |ddm|=0.0595  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.495987741907  dE = -0.0089373291  S^2 = 0.0000000
               |grad[o]|=0.0638  |ddm|=0.044  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5032500656424  dE = -0.0072623237  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.0592  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5084942261187  dE = -0.0052441605  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.0625  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.511603300452  dE = -0.0031090743  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5125684622314  dE = -0.00096516178  S^2 = 0.0000000
               |grad[o]|=0.0119  |ddm|=0.0749  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5130317828079  dE = -0.00046332058  S^2 = 0.0000000
               |grad[o]|=0.00731  |ddm|=0.0414  |maxRot[o]|=0.0388
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5131334897659  dE = -0.00010170696  S^2 = 0.0000000
               |grad[o]|=0.00337  |ddm|=0.0207  |maxRot[o]|= 0.02
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5131512581341  dE = -1.7768368e-05  S^2 = 0.0000000
               |grad[o]|=0.00142  |ddm|=0.00715  |maxRot[o]|=0.00888
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5131537359663  dE = -2.4778322e-06  S^2 = 0.0000000
               |grad[o]|=0.000543  |ddm|=0.00276  |maxRot[o]|=0.00337
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5131540649679  dE = -3.2900164e-07  S^2 = 0.0000000
               |grad[o]|=0.000202  |ddm|=0.000999  |maxRot[o]|=0.00124
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5131541079163  dE = -4.2948344e-08  S^2 = 0.0000000
               |grad[o]|=7.36e-05  |ddm|=0.000361  |maxRot[o]|=0.000449
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5131541134676  dE = -5.5512857e-09  S^2 = 0.0000000
               |grad[o]|=2.66e-05  |ddm|=0.00013  |maxRot[o]|=0.000162
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5131541141774  dE = -7.0981798e-10  S^2 = 0.0000000
               |grad[o]|=9.58e-06  |ddm|=4.67e-05  |maxRot[o]|=5.83e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5131541142659  dE = -8.8490992e-11  S^2 = 0.0000000
               |grad[o]|=3.46e-06  |ddm|=1.68e-05  |maxRot[o]|=2.1e-05
2-step CASSCF converged in 16 macro (65 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96506513 1.92787018 1.90242015 1.83461648 0.08106132 0.17170008
 0.05932555 0.0579411 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01001   0.00958  -0.00569   0.00000   0.00000
  0 C 2s       0.60769   0.64161  -0.36054  -0.00000   0.00000
  0 C 3s      -0.02394   0.01781  -0.04989  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69498
  0 C 2py     -0.00000   0.00000  -0.00000   0.70448  -0.00000
  0 C 2pz      0.35831  -0.29606   0.60517  -0.00000  -0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.05520
  0 C 3py     -0.00000   0.00000   0.00000   0.04615   0.00000
  0 C 3pz     -0.02386  -0.00271   0.00109  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03981  -0.00000
  0 C 3dz^2    0.03287  -0.01476   0.03469  -0.00000  -0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.11816
 0 C 3dx2-y2  -0.00145   0.00725  -0.00749   0.00000  -0.00000
  1 C 1s       0.01001  -0.00958  -0.00569   0.00000   0.00000
  1 C 2s       0.60769  -0.64161  -0.36054   0.00000   0.00000
  1 C 3s      -0.02394  -0.01781  -0.04989   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69498
  1 C 2py      0.00000  -0.00000   0.00000   0.70448   0.00000
  1 C 2pz     -0.35831  -0.29606  -0.60517  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05520
  1 C 3py      0.00000  -0.00000  -0.00000   0.04615   0.00000
  1 C 3pz      0.02386  -0.00271  -0.00109  -0.00000   0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03981  -0.00000
  1 C 3dz^2    0.03287   0.01476   0.03469   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11816
 1 C 3dx2-y2  -0.00145  -0.00725  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00052
  0 C 2s      -0.00000   0.00000   0.29408
  0 C 3s      -0.00000  -0.00000   0.03931
  0 C 2px      0.00000   0.69713  -0.00000
  0 C 2py      0.70661   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.63885
  0 C 3px      0.00000   0.00311  -0.00000
  0 C 3py     -0.02293   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05440
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01349   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.01292
  0 C 3dxz     0.00000  -0.11834  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02684
  1 C 1s       0.00000   0.00000   0.00052
  1 C 2s       0.00000   0.00000  -0.29408
  1 C 3s       0.00000   0.00000  -0.03931
  1 C 2px     -0.00000  -0.69713   0.00000
  1 C 2py     -0.70661  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.63885
  1 C 3px     -0.00000  -0.00311   0.00000
  1 C 3py      0.02293  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.05440
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01349   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.01292
  1 C 3dxz     0.00000  -0.11834  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02684
<CAS-nat-orb|mo-hf>  3  3    0.98958162
<CAS-nat-orb|mo-hf>  4  4    0.99975150
<CAS-nat-orb|mo-hf>  5  5    0.98959416
<CAS-nat-orb|mo-hf>  6  6    0.99925428
<CAS-nat-orb|mo-hf>  7  7    0.94209804
<CAS-nat-orb|mo-hf>  8  8    0.97102424
<CAS-nat-orb|mo-hf>  9  9    0.95858985
<CAS-nat-orb|mo-hf>  10  10    0.86001483
<CAS-nat-orb|mo-hf>  10  11   -0.48380369
CASSCF energy = -75.5131541142659
CASCI E = -75.5131541142659  E(CI) = -15.7189305753107  S^2 = 0.0000000
Density matrix diagonal elements [1.96506534 1.92787136 1.90242346 1.83461676 0.08105701 0.17169976
 0.05932521 0.0579411 ]
i = 1  <i|F|i> = -11.33948734
i = 2  <i|F|i> = -11.33960314
i = 3  <i|F|i> =  -0.87345923
i = 4  <i|F|i> =  -0.60666534
i = 5  <i|F|i> =  -0.39134281
i = 6  <i|F|i> =  -0.32570729
i = 7  <i|F|i> =   0.07435586
i = 8  <i|F|i> =   0.08996158
i = 9  <i|F|i> =   0.20288096
i = 10  <i|F|i> =   0.41009375
i = 11  <i|F|i> =   0.57226235
i = 12  <i|F|i> =   0.68995170
i = 13  <i|F|i> =   0.69596438
i = 14  <i|F|i> =   0.65349797
i = 15  <i|F|i> =   0.73644034
i = 16  <i|F|i> =   0.71175484
i = 17  <i|F|i> =   0.72172175
i = 18  <i|F|i> =   1.04234308
i = 19  <i|F|i> =   1.14537815
i = 20  <i|F|i> =   1.20788777
i = 21  <i|F|i> =   1.30864747
i = 22  <i|F|i> =   1.30882747
i = 23  <i|F|i> =   1.47924181
i = 24  <i|F|i> =   1.47752774
i = 25  <i|F|i> =   1.64146536
i = 26  <i|F|i> =   1.77851160
i = 27  <i|F|i> =   1.84479797
i = 28  <i|F|i> =   2.13743596
......production of RDMs took       1.79 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.76 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickSCNEVPT2-ijrs) =    -0.00028273956543
E(WickSCNEVPT2- rsi) =    -0.00080333032616
E(WickSCNEVPT2- ijr) =    -0.00028445878930
E(WickSCNEVPT2-  rs) =    -0.03472205949915
E(WickSCNEVPT2-  ij) =    -0.00008295667739
E(WickSCNEVPT2-  ir) =    -0.00106553298556
E(WickSCNEVPT2-   r) =    -0.05572453157771
E(WickSCNEVPT2-   i) =    -0.00008837365433
E(WickSCNEVPT2) = -75.60620809734088  E_corr_pt = -0.09305398307502465
Timings = pdms =   32.74 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.53 | i =    0.25
Time cost =    170.519
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:49:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.746284796036 AA    0.000000000000   0.000000000000   3.300000000000 Bohr   0.0

nuclear repulsion = 10.9090909090909
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.65]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      8652.42


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp6v3cff27
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.842256067793

WARN: Singularity detected in overlap matrix (condition number =  141). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.131475269334874  LUMO (B3u) = -0.131475269334874

WARN: B2u HOMO -0.131475269334874 > system LUMO -0.131475269334874

cycle= 1 E= -75.3268751185369  delta_E= -0.485  |g|= 0.254  |ddm|= 1.52
HOMO (B2u) = -0.392977692990135  LUMO (B3u) = -0.0727206501017202
cycle= 2 E= -75.3522841088372  delta_E= -0.0254  |g|= 0.0519  |ddm|= 0.352
HOMO (B2u) = -0.355147584178282  LUMO (B3u) = -0.0300222920891326
cycle= 3 E= -75.3537386656221  delta_E= -0.00145  |g|= 0.0182  |ddm|= 0.0689
HOMO (B2u) = -0.35967101704659  LUMO (B3u) = -0.0344578300630356
cycle= 4 E= -75.3539592586542  delta_E= -0.000221  |g|= 0.000688  |ddm|= 0.0377
HOMO (B2u) = -0.359764894042612  LUMO (B3u) = -0.0346976899212337
cycle= 5 E= -75.3539594435199  delta_E= -1.85e-07  |g|= 9.37e-05  |ddm|= 0.00109
HOMO (B2u) = -0.359730880125604  LUMO (B3u) = -0.0346640305640385
cycle= 6 E= -75.3539594484633  delta_E= -4.94e-09  |g|= 1.51e-05  |ddm|= 0.000157
HOMO (B2u) = -0.359729026578328  LUMO (B3u) = -0.0346652386509408
cycle= 7 E= -75.3539594486084  delta_E= -1.45e-10  |g|= 1.94e-06  |ddm|= 3.44e-05
HOMO (B2u) = -0.35972833101723  LUMO (B3u) = -0.034664907694506
cycle= 8 E= -75.3539594486108  delta_E= -2.39e-12  |g|= 1.14e-07  |ddm|= 4.16e-06
HOMO (B2u) = -0.359728345183197  LUMO (B3u) = -0.0346649176992063
cycle= 9 E= -75.3539594486109  delta_E= -5.68e-14  |g|= 6.91e-09  |ddm|= 2.29e-07
HOMO (B2u) = -0.359728345815413  LUMO (B3u) = -0.034664919933616
cycle= 10 E= -75.3539594486107  delta_E= 1.14e-13  |g|= 4.83e-09  |ddm|= 7.44e-09
HOMO (B2u) = -0.359728345626694  LUMO (B3u) = -0.0346649197192488
cycle= 11 E= -75.3539594486108  delta_E= -5.68e-14  |g|= 3.95e-09  |ddm|= 4.04e-09
HOMO (B2u) = -0.359728344324681  LUMO (B3u) = -0.0346649183503387
cycle= 12 E= -75.3539594486108  delta_E=    0  |g|= 3.62e-09  |ddm|= 1.84e-09
HOMO (B2u) = -0.359728344700716  LUMO (B3u) = -0.0346649187080005
cycle= 13 E= -75.3539594486108  delta_E=    0  |g|= 3.21e-09  |ddm|= 9.37e-10
HOMO (B2u) = -0.359728344323063  LUMO (B3u) = -0.0346649183510509
cycle= 14 E= -75.3539594486109  delta_E= -8.53e-14  |g|= 3.93e-10  |ddm|= 4.6e-09
HOMO (B2u) = -0.359728344496097  LUMO (B3u) = -0.0346649184551597
cycle= 15 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 5.5e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.359728344408525  LUMO (B3u) = -0.034664918460069
cycle= 16 E= -75.3539594486109  delta_E= -2.84e-14  |g|= 6.41e-10  |ddm|= 1.25e-09
HOMO (B2u) = -0.359728344445491  LUMO (B3u) = -0.0346649184557383
cycle= 17 E= -75.3539594486109  delta_E= -1.42e-14  |g|= 6.39e-10  |ddm|= 6.96e-10
HOMO (B2u) = -0.359728344433687  LUMO (B3u) = -0.0346649184358923
cycle= 18 E= -75.3539594486109  delta_E= -1.42e-14  |g|= 4.57e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.359728344445654  LUMO (B3u) = -0.0346649184497206
cycle= 19 E= -75.3539594486109  delta_E= 1.42e-14  |g|= 3.95e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.359728344459472  LUMO (B3u) = -0.0346649184644291
cycle= 20 E= -75.3539594486108  delta_E= 4.26e-14  |g|= 3.17e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.359728344458899  LUMO (B3u) = -0.0346649184619261
cycle= 21 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 2.19e-10  |ddm|= 1.63e-10
HOMO (B2u) = -0.359728344461313  LUMO (B3u) = -0.0346649184640201
cycle= 22 E= -75.3539594486108  delta_E= 7.11e-14  |g|= 1.26e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.359728344460742  LUMO (B3u) = -0.0346649184621279
cycle= 23 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 1.23e-10  |ddm|= 1.77e-11
HOMO (B2u) = -0.359728344456856  LUMO (B3u) = -0.034664918460048
cycle= 24 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 1.11e-10  |ddm|= 4.67e-11
HOMO (B2u) = -0.35972834445795  LUMO (B3u) = -0.0346649184591158
cycle= 25 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 9.02e-11  |ddm|= 4.48e-11
HOMO (B2u) = -0.3597283444577  LUMO (B3u) = -0.0346649184583874
cycle= 26 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 7.23e-11  |ddm|= 3.21e-11
HOMO (B2u) = -0.359728344457184  LUMO (B3u) = -0.0346649184576526
cycle= 27 E= -75.3539594486109  delta_E= -9.95e-14  |g|= 6.06e-11  |ddm|= 2.13e-11
HOMO (B2u) = -0.35972834445682  LUMO (B3u) = -0.0346649184570261
cycle= 28 E= -75.3539594486108  delta_E= 8.53e-14  |g|= 4.81e-11  |ddm|= 2.38e-11
HOMO (B2u) = -0.3597283444567  LUMO (B3u) = -0.0346649184566597
cycle= 29 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 3.73e-11  |ddm|= 2.11e-11
HOMO (B2u) = -0.359728344456561  LUMO (B3u) = -0.0346649184563597
cycle= 30 E= -75.3539594486108  delta_E= -4.26e-14  |g|= 2.98e-11  |ddm|= 1.52e-11
HOMO (B2u) = -0.35972834445652  LUMO (B3u) = -0.0346649184562046
cycle= 31 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 2.57e-11  |ddm|= 8.68e-12
HOMO (B2u) = -0.359728344456416  LUMO (B3u) = -0.0346649184560266
cycle= 32 E= -75.3539594486108  delta_E=    0  |g|= 2.14e-11  |ddm|= 9.08e-12
HOMO (B2u) = -0.359728344456282  LUMO (B3u) = -0.0346649184555128
Extra cycle  E= -75.3539594486108  delta_E=    0  |g|= 8.11e-12  |ddm|= 2.77e-11
converged SCF energy = -75.3539594486108

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp6v3cff27
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4605852262835  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4728649095988  dE = -0.012279683  S^2 = 0.0000000
               |grad[o]|=0.0845  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4835908921755  dE = -0.010725983  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0629  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4924933536821  dE = -0.0089024615  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.0412  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4995415975225  dE = -0.0070482438  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0503  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.504561352323  dE = -0.0050197548  S^2 = 0.0000000
               |grad[o]|=0.0383  |ddm|=0.0585  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5070403288536  dE = -0.0024789765  S^2 = 0.0000000
               |grad[o]|=0.0222  |ddm|=0.0398  |maxRot[o]|= 0.06
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5078465774085  dE = -0.00080624855  S^2 = 0.0000000
               |grad[o]|=0.0105  |ddm|=0.0554  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.508167099407  dE = -0.000320522  S^2 = 0.0000000
               |grad[o]|=0.00584  |ddm|=0.0262  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5082201129816  dE = -5.3013575e-05  S^2 = 0.0000000
               |grad[o]|=0.0024  |ddm|=0.0133  |maxRot[o]|=0.0153
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5082271260864  dE = -7.0131047e-06  S^2 = 0.0000000
               |grad[o]|=0.000905  |ddm|=0.00451  |maxRot[o]|=0.00572
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5082279839394  dE = -8.57853e-07  S^2 = 0.0000000
               |grad[o]|=0.000325  |ddm|=0.00156  |maxRot[o]|=0.00202
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5082280860406  dE = -1.0210121e-07  S^2 = 0.0000000
               |grad[o]|=0.000114  |ddm|=0.000538  |maxRot[o]|=0.0007
macro iter 13 (2 JK  0 micro), CASSCF E = -75.508228098037  dE = -1.1996448e-08  S^2 = 0.0000000
               |grad[o]|=3.95e-05  |ddm|=0.000185  |maxRot[o]|=0.000241
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5082280994326  dE = -1.3956196e-09  S^2 = 0.0000000
               |grad[o]|=1.37e-05  |ddm|=6.4e-05  |maxRot[o]|=8.32e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5082280995928  dE = -1.6018475e-10  S^2 = 0.0000000
               |grad[o]|=4.71e-06  |ddm|=2.19e-05  |maxRot[o]|=2.86e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.508228099607  dE = -1.4210855e-11  S^2 = 0.0000000
               |grad[o]|=1.56e-06  |ddm|=7e-06  |maxRot[o]|=9.46e-06
2-step CASSCF converged in 16 macro (63 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96387359 1.92858695 1.90144122 1.82466897 0.07878278 0.18160432
 0.05902031 0.06202185]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01031   0.00970  -0.00544   0.00000   0.00000
  0 C 2s       0.61830   0.64554  -0.34208   0.00000  -0.00000
  0 C 3s      -0.02094   0.01752  -0.04828   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69463
  0 C 2py      0.00000  -0.00000   0.00000   0.70445   0.00000
  0 C 2pz      0.34017  -0.28744   0.61591   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.05672
  0 C 3py     -0.00000   0.00000   0.00000   0.04759  -0.00000
  0 C 3pz     -0.02200  -0.00251   0.00227   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.03863  -0.00000
  0 C 3dz^2    0.03108  -0.01437   0.03487   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.11945
 0 C 3dx2-y2  -0.00117   0.00712  -0.00747   0.00000  -0.00000
  1 C 1s       0.01031  -0.00970  -0.00544   0.00000   0.00000
  1 C 2s       0.61830  -0.64554  -0.34208   0.00000   0.00000
  1 C 3s      -0.02094  -0.01752  -0.04828  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69463
  1 C 2py      0.00000  -0.00000  -0.00000   0.70445   0.00000
  1 C 2pz     -0.34017  -0.28744  -0.61591   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.05672
  1 C 3py     -0.00000   0.00000  -0.00000   0.04759  -0.00000
  1 C 3pz      0.02200  -0.00251  -0.00227   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.03863   0.00000
  1 C 3dz^2    0.03108   0.01437   0.03487  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.11945
 1 C 3dx2-y2  -0.00117  -0.00712  -0.00747   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00049
  0 C 2s       0.00000  -0.00000   0.28563
  0 C 3s       0.00000  -0.00000   0.03833
  0 C 2px     -0.00000   0.69726  -0.00000
  0 C 2py      0.70668  -0.00000   0.00000
  0 C 2pz      0.00000  -0.00000   0.64303
  0 C 3px     -0.00000   0.00091  -0.00000
  0 C 3py     -0.02081  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.05165
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.01306  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.01176
  0 C 3dxz    -0.00000  -0.11759  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02562
  1 C 1s       0.00000   0.00000   0.00049
  1 C 2s      -0.00000   0.00000  -0.28563
  1 C 3s      -0.00000   0.00000  -0.03833
  1 C 2px      0.00000  -0.69726  -0.00000
  1 C 2py     -0.70668   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.64303
  1 C 3px      0.00000  -0.00091   0.00000
  1 C 3py      0.02081   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.05165
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01306  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.01176
  1 C 3dxz    -0.00000  -0.11759  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.02562
<CAS-nat-orb|mo-hf>  3  3    0.99201756
<CAS-nat-orb|mo-hf>  4  4    0.99974451
<CAS-nat-orb|mo-hf>  5  5    0.99203281
<CAS-nat-orb|mo-hf>  6  6    0.99920694
<CAS-nat-orb|mo-hf>  7  7    0.94066257
<CAS-nat-orb|mo-hf>  8  8    0.97275729
<CAS-nat-orb|mo-hf>  9  9    0.95891046
<CAS-nat-orb|mo-hf>  10  10    0.87431676
<CAS-nat-orb|mo-hf>  10  11   -0.46069473
CASSCF energy = -75.508228099607
CASCI E = -75.508228099607  E(CI) = -15.6395663675254  S^2 = 0.0000000
Density matrix diagonal elements [1.96387368 1.92858773 1.90144192 1.82466898 0.0787815  0.18160418
 0.05902019 0.06202182]
i = 1  <i|F|i> = -11.34065953
i = 2  <i|F|i> = -11.34081998
i = 3  <i|F|i> =  -0.86788198
i = 4  <i|F|i> =  -0.61003702
i = 5  <i|F|i> =  -0.38544721
i = 6  <i|F|i> =  -0.32005152
i = 7  <i|F|i> =   0.07899155
i = 8  <i|F|i> =   0.08216831
i = 9  <i|F|i> =   0.19971645
i = 10  <i|F|i> =   0.38833560
i = 11  <i|F|i> =   0.57666769
i = 12  <i|F|i> =   0.69068894
i = 13  <i|F|i> =   0.70098412
i = 14  <i|F|i> =   0.65153725
i = 15  <i|F|i> =   0.73949302
i = 16  <i|F|i> =   0.71309559
i = 17  <i|F|i> =   0.72122831
i = 18  <i|F|i> =   1.03764731
i = 19  <i|F|i> =   1.14637123
i = 20  <i|F|i> =   1.20716809
i = 21  <i|F|i> =   1.31390298
i = 22  <i|F|i> =   1.31408881
i = 23  <i|F|i> =   1.47429605
i = 24  <i|F|i> =   1.47272637
i = 25  <i|F|i> =   1.61411477
i = 26  <i|F|i> =   1.76300726
i = 27  <i|F|i> =   1.82868408
i = 28  <i|F|i> =   2.13899306
......production of RDMs took       1.95 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.52 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.64 sec

E(WickSCNEVPT2-ijrs) =    -0.00028323588753
E(WickSCNEVPT2- rsi) =    -0.00080203314754
E(WickSCNEVPT2- ijr) =    -0.00028134754761
E(WickSCNEVPT2-  rs) =    -0.03452722089774
E(WickSCNEVPT2-  ij) =    -0.00007980764637
E(WickSCNEVPT2-  ir) =    -0.00105580466179
E(WickSCNEVPT2-   r) =    -0.05614920346773
E(WickSCNEVPT2-   i) =    -0.00008402047056
E(WickSCNEVPT2) = -75.60149077333391  E_corr_pt = -0.09326267372686806
Timings = pdms =   32.56 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.52 | i =    0.24
Time cost =    398.683
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:56:07 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.772743656582 AA    0.000000000000   0.000000000000   3.350000000000 Bohr   0.0

nuclear repulsion = 10.7462686567164
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.675]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9011.79


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpll_g7lvp
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8226756263582

WARN: Singularity detected in overlap matrix (condition number =  131). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.127455322759628  LUMO (B3u) = -0.127455322759628

WARN: B2u HOMO -0.127455322759628 > system LUMO -0.127455322759628

cycle= 1 E= -75.3190207821596  delta_E= -0.496  |g|= 0.252  |ddm|= 1.51
HOMO (B2u) = -0.388276779674661  LUMO (B3u) = -0.069932874908027
cycle= 2 E= -75.3440245529482  delta_E= -0.025  |g|= 0.0513  |ddm|= 0.351
HOMO (B2u) = -0.351016713810031  LUMO (B3u) = -0.027835041739
cycle= 3 E= -75.3454675220222  delta_E= -0.00144  |g|= 0.0181  |ddm|= 0.0681
HOMO (B2u) = -0.355529260677998  LUMO (B3u) = -0.0322458808802161
cycle= 4 E= -75.3456894433558  delta_E= -0.000222  |g|= 0.000681  |ddm|= 0.0375
HOMO (B2u) = -0.355644927845466  LUMO (B3u) = -0.0325087452095926
cycle= 5 E= -75.3456896230235  delta_E= -1.8e-07  |g|= 9.78e-05  |ddm|= 0.00103
HOMO (B2u) = -0.355609613190062  LUMO (B3u) = -0.0324745833916065
cycle= 6 E= -75.3456896284285  delta_E= -5.4e-09  |g|= 1.56e-05  |ddm|= 0.000165
HOMO (B2u) = -0.355607628482649  LUMO (B3u) = -0.0324756124305586
cycle= 7 E= -75.345689628583  delta_E= -1.54e-10  |g|= 1.94e-06  |ddm|= 3.47e-05
HOMO (B2u) = -0.355606961354816  LUMO (B3u) = -0.0324753268421095
cycle= 8 E= -75.3456896285854  delta_E= -2.47e-12  |g|= 1.17e-07  |ddm|= 4.13e-06
HOMO (B2u) = -0.355606972649811  LUMO (B3u) = -0.0324753336780895
cycle= 9 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 7.02e-09  |ddm|= 2.39e-07
HOMO (B2u) = -0.355606973119422  LUMO (B3u) = -0.032475335782171
cycle= 10 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 5.12e-09  |ddm|= 7.53e-09
HOMO (B2u) = -0.355606972920784  LUMO (B3u) = -0.0324753355638078
cycle= 11 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 4.02e-09  |ddm|= 4.16e-09
HOMO (B2u) = -0.355606971600126  LUMO (B3u) = -0.032475334177156
cycle= 12 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 3.67e-09  |ddm|= 1.91e-09
HOMO (B2u) = -0.355606971984541  LUMO (B3u) = -0.0324753345468824
cycle= 13 E= -75.3456896285855  delta_E= -2.84e-14  |g|= 3.28e-09  |ddm|= 1.07e-09
HOMO (B2u) = -0.355606971978571  LUMO (B3u) = -0.0324753345652896
cycle= 14 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 3.08e-09  |ddm|= 7.19e-10
HOMO (B2u) = -0.355606971764285  LUMO (B3u) = -0.0324753342957847
cycle= 15 E= -75.3456896285854  delta_E=    0  |g|= 7.18e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.355606971668439  LUMO (B3u) = -0.0324753342957657
cycle= 16 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 7.71e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.355606971704424  LUMO (B3u) = -0.0324753342895903
cycle= 17 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 7.69e-10  |ddm|= 7.32e-10
HOMO (B2u) = -0.355606971687217  LUMO (B3u) = -0.0324753342674595
cycle= 18 E= -75.3456896285854  delta_E=    0  |g|= 5.86e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.355606971696063  LUMO (B3u) = -0.0324753342793688
cycle= 19 E= -75.3456896285855  delta_E= -2.84e-14  |g|= 5.26e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.355606971706703  LUMO (B3u) = -0.0324753342921001
cycle= 20 E= -75.3456896285853  delta_E= 1.14e-13  |g|= 4.52e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.355606971702987  LUMO (B3u) = -0.0324753342876215
cycle= 21 E= -75.3456896285855  delta_E= -1.14e-13  |g|= 3.59e-10  |ddm|= 1.75e-10
HOMO (B2u) = -0.35560697170269  LUMO (B3u) = -0.0324753342881127
cycle= 22 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 2.69e-10  |ddm|= 1.7e-10
HOMO (B2u) = -0.355606971702987  LUMO (B3u) = -0.0324753342883557
cycle= 23 E= -75.3456896285855  delta_E= -5.68e-14  |g|= 1.74e-10  |ddm|= 1.82e-10
HOMO (B2u) = -0.355606971698119  LUMO (B3u) = -0.0324753342857581
cycle= 24 E= -75.3456896285855  delta_E=    0  |g|= 1.55e-10  |ddm|= 5.84e-11
HOMO (B2u) = -0.355606971698311  LUMO (B3u) = -0.0324753342842538
cycle= 25 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 1.3e-10  |ddm|= 5.28e-11
HOMO (B2u) = -0.355606971697104  LUMO (B3u) = -0.032475334282939
cycle= 26 E= -75.3456896285855  delta_E= -2.84e-14  |g|= 1.09e-10  |ddm|= 4.42e-11
HOMO (B2u) = -0.355606971695856  LUMO (B3u) = -0.0324753342817288
cycle= 27 E= -75.3456896285855  delta_E=    0  |g|= 9.32e-11  |ddm|= 3.29e-11
HOMO (B2u) = -0.355606971692809  LUMO (B3u) = -0.0324753342784652
Extra cycle  E= -75.3456896285854  delta_E= 2.84e-14  |g|= 3.48e-11  |ddm|= 1.21e-10
converged SCF energy = -75.3456896285854

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpll_g7lvp
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4564838553942  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4691733729362  dE = -0.012689518  S^2 = 0.0000000
               |grad[o]|=0.0865  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4801083821053  dE = -0.010935009  S^2 = 0.0000000
               |grad[o]|=0.0752  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4889631035533  dE = -0.0088547214  S^2 = 0.0000000
               |grad[o]|=0.0624  |ddm|=0.0406  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4957789712888  dE = -0.0068158677  S^2 = 0.0000000
               |grad[o]|=0.0491  |ddm|=0.0471  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5005605118461  dE = -0.0047815406  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.0609  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5027257962522  dE = -0.0021652844  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.0448  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5031948312491  dE = -0.000469035  S^2 = 0.0000000
               |grad[o]|=0.00722  |ddm|=0.0469  |maxRot[o]|= 0.04
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5032865778877  dE = -9.1746639e-05  S^2 = 0.0000000
               |grad[o]|=0.00309  |ddm|=0.0149  |maxRot[o]|= 0.02
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5032982747811  dE = -1.1696893e-05  S^2 = 0.0000000
               |grad[o]|=0.00115  |ddm|=0.00551  |maxRot[o]|=0.00744
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5032995997977  dE = -1.3250166e-06  S^2 = 0.0000000
               |grad[o]|=0.000405  |ddm|=0.00187  |maxRot[o]|=0.00253
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5032997456182  dE = -1.4582051e-07  S^2 = 0.0000000
               |grad[o]|=0.000138  |ddm|=0.000621  |maxRot[o]|=0.000845
macro iter 12 (2 JK  0 micro), CASSCF E = -75.5032997614883  dE = -1.5870015e-08  S^2 = 0.0000000
               |grad[o]|=4.59e-05  |ddm|=0.000206  |maxRot[o]|=0.000279
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5032997632074  dE = -1.7191581e-09  S^2 = 0.0000000
               |grad[o]|=1.52e-05  |ddm|=6.73e-05  |maxRot[o]|=9.2e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5032997633895  dE = -1.8212631e-10  S^2 = 0.0000000
               |grad[o]|=5.06e-06  |ddm|=2.27e-05  |maxRot[o]|=3.05e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5032997634143  dE = -2.4812152e-11  S^2 = 0.0000000
               |grad[o]|=1.69e-06  |ddm|=7.63e-06  |maxRot[o]|=1.01e-05
2-step CASSCF converged in 15 macro (59 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96274301 1.92928247 1.89992238 1.8142028  0.07676462 0.19201084
 0.05872205 0.06635183]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01059   0.00982  -0.00515   0.00000   0.00000
  0 C 2s       0.62877   0.64927  -0.32247   0.00000   0.00000
  0 C 3s      -0.01802   0.01723  -0.04662  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69435
  0 C 2py     -0.00000   0.00000  -0.00000   0.70442   0.00000
  0 C 2pz      0.32084  -0.27893   0.62651  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000  -0.05813
  0 C 3py     -0.00000   0.00000  -0.00000   0.04890  -0.00000
  0 C 3pz     -0.02026  -0.00235   0.00351  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03743  -0.00000
  0 C 3dz^2    0.02926  -0.01397   0.03504  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000  -0.12042
 0 C 3dx2-y2  -0.00088   0.00700  -0.00745  -0.00000   0.00000
  1 C 1s       0.01059  -0.00982  -0.00515   0.00000   0.00000
  1 C 2s       0.62877  -0.64927  -0.32247   0.00000  -0.00000
  1 C 3s      -0.01802  -0.01723  -0.04662   0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70442   0.00000
  1 C 2pz     -0.32084  -0.27893  -0.62651  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.05813
  1 C 3py      0.00000  -0.00000   0.00000   0.04890  -0.00000
  1 C 3pz      0.02026  -0.00235  -0.00351  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.03743   0.00000
  1 C 3dz^2    0.02926   0.01397   0.03504   0.00000  -0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12042
 1 C 3dx2-y2  -0.00088  -0.00700  -0.00745   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00046
  0 C 2s      -0.00000   0.00000   0.27729
  0 C 3s      -0.00000   0.00000   0.03734
  0 C 2px     -0.00000   0.69739   0.00000
  0 C 2py      0.70675   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.64700
  0 C 3px     -0.00000  -0.00124   0.00000
  0 C 3py     -0.01872   0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.04893
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01263  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01067
  0 C 3dxz     0.00000  -0.11680   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.02442
  1 C 1s       0.00000   0.00000   0.00046
  1 C 2s      -0.00000  -0.00000  -0.27729
  1 C 3s       0.00000  -0.00000  -0.03734
  1 C 2px     -0.00000  -0.69739  -0.00000
  1 C 2py     -0.70675   0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.64700
  1 C 3px      0.00000   0.00124  -0.00000
  1 C 3py      0.01872  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04893
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01263  -0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01067
  1 C 3dxz    -0.00000  -0.11680   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02442
<CAS-nat-orb|mo-hf>  3  3    0.99427993
<CAS-nat-orb|mo-hf>  4  4    0.99973720
<CAS-nat-orb|mo-hf>  5  5    0.99429720
<CAS-nat-orb|mo-hf>  6  6    0.99915774
<CAS-nat-orb|mo-hf>  7  7    0.93938547
<CAS-nat-orb|mo-hf>  8  8    0.97438152
<CAS-nat-orb|mo-hf>  9  9    0.95919913
<CAS-nat-orb|mo-hf>  10  10    0.88692941
<CAS-nat-orb|mo-hf>  10  11   -0.43885970
CASSCF energy = -75.5032997634143
CASCI E = -75.5032997634143  E(CI) = -15.5624178249741  S^2 = 0.0000000
Density matrix diagonal elements [1.96274315 1.92928299 1.89992312 1.8142033  0.07676329 0.19201048
 0.05872185 0.06635183]
i = 1  <i|F|i> = -11.34170113
i = 2  <i|F|i> = -11.34190061
i = 3  <i|F|i> =  -0.86237766
i = 4  <i|F|i> =  -0.61331382
i = 5  <i|F|i> =  -0.37966104
i = 6  <i|F|i> =  -0.31447341
i = 7  <i|F|i> =   0.08322256
i = 8  <i|F|i> =   0.07460995
i = 9  <i|F|i> =   0.19668350
i = 10  <i|F|i> =   0.36769793
i = 11  <i|F|i> =   0.58104384
i = 12  <i|F|i> =   0.69115484
i = 13  <i|F|i> =   0.64946847
i = 14  <i|F|i> =   0.70516575
i = 15  <i|F|i> =   0.74342043
i = 16  <i|F|i> =   0.71441350
i = 17  <i|F|i> =   0.72078074
i = 18  <i|F|i> =   1.03315317
i = 19  <i|F|i> =   1.14835446
i = 20  <i|F|i> =   1.20731821
i = 21  <i|F|i> =   1.31901148
i = 22  <i|F|i> =   1.31920444
i = 23  <i|F|i> =   1.46959970
i = 24  <i|F|i> =   1.46816517
i = 25  <i|F|i> =   1.58727323
i = 26  <i|F|i> =   1.74772841
i = 27  <i|F|i> =   1.81271545
i = 28  <i|F|i> =   2.14007633
......production of RDMs took       5.46 sec
......reading the RDM took          0.45 sec
......production of RDMs took      22.00 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.71 sec

E(WickSCNEVPT2-ijrs) =    -0.00028392175789
E(WickSCNEVPT2- rsi) =    -0.00080141576685
E(WickSCNEVPT2- ijr) =    -0.00027849285635
E(WickSCNEVPT2-  rs) =    -0.03433098178599
E(WickSCNEVPT2-  ij) =    -0.00007686048437
E(WickSCNEVPT2-  ir) =    -0.00104679026385
E(WickSCNEVPT2-   r) =    -0.05657064879805
E(WickSCNEVPT2-   i) =    -0.00007994468709
E(WickSCNEVPT2) = -75.5967688198148  E_corr_pt = -0.09346905640044538
Timings = pdms =   37.61 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.02 | r =    0.59 | i =    0.25
Time cost =    135.603
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:58:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.799202517128 AA    0.000000000000   0.000000000000   3.400000000000 Bohr   0.0

nuclear repulsion = 10.5882352941176
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.7]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9236.33


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpykjiey99
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8043126951475

WARN: Singularity detected in overlap matrix (condition number =  122). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.123626145223849  LUMO (B3u) = -0.123626145223849

WARN: B2u HOMO -0.123626145223849 > system LUMO -0.123626145223849

cycle= 1 E= -75.3111334513161  delta_E= -0.507  |g|= 0.249  |ddm|=  1.5
HOMO (B2u) = -0.383724747851052  LUMO (B3u) = -0.0672275188573568
cycle= 2 E= -75.3357364104633  delta_E= -0.0246  |g|= 0.0507  |ddm|= 0.351
HOMO (B2u) = -0.34702671827607  LUMO (B3u) = -0.0257227421999452
cycle= 3 E= -75.337165289928  delta_E= -0.00143  |g|= 0.0181  |ddm|= 0.0673
HOMO (B2u) = -0.351526070447293  LUMO (B3u) = -0.0301077062023755
cycle= 4 E= -75.3373878233178  delta_E= -0.000223  |g|= 0.000675  |ddm|= 0.0372
HOMO (B2u) = -0.351660112314434  LUMO (B3u) = -0.0303898359337077
cycle= 5 E= -75.3373879985295  delta_E= -1.75e-07  |g|= 0.000102  |ddm|= 0.000975
HOMO (B2u) = -0.351623840121638  LUMO (B3u) = -0.0303555719623969
cycle= 6 E= -75.3373880044287  delta_E= -5.9e-09  |g|= 1.61e-05  |ddm|= 0.000173
HOMO (B2u) = -0.351621725064435  LUMO (B3u) = -0.0303564386936724
cycle= 7 E= -75.3373880045927  delta_E= -1.64e-10  |g|= 1.94e-06  |ddm|= 3.52e-05
HOMO (B2u) = -0.351621087024048  LUMO (B3u) = -0.0303561953012788
cycle= 8 E= -75.3373880045952  delta_E= -2.47e-12  |g|= 1.2e-07  |ddm|= 4.09e-06
HOMO (B2u) = -0.351621096027948  LUMO (B3u) = -0.0303561996522633
cycle= 9 E= -75.3373880045952  delta_E= 1.42e-14  |g|= 7.3e-09  |ddm|= 2.5e-07
HOMO (B2u) = -0.351621096335779  LUMO (B3u) = -0.0303562016384793
cycle= 10 E= -75.3373880045952  delta_E=    0  |g|= 5.49e-09  |ddm|= 7.67e-09
HOMO (B2u) = -0.351621096129145  LUMO (B3u) = -0.0303562014193521
cycle= 11 E= -75.3373880045953  delta_E= -7.11e-14  |g|= 4.19e-09  |ddm|= 4.36e-09
HOMO (B2u) = -0.351621094785391  LUMO (B3u) = -0.03035620001044
cycle= 12 E= -75.3373880045953  delta_E=    0  |g|= 3.79e-09  |ddm|= 1.99e-09
HOMO (B2u) = -0.351621095168635  LUMO (B3u) = -0.0303562003840457
cycle= 13 E= -75.3373880045952  delta_E= 8.53e-14  |g|= 3.4e-09  |ddm|= 1.23e-09
HOMO (B2u) = -0.351621095129806  LUMO (B3u) = -0.0303562003622537
cycle= 14 E= -75.3373880045952  delta_E=    0  |g|= 3.04e-09  |ddm|= 6.93e-10
HOMO (B2u) = -0.351621094932019  LUMO (B3u) = -0.0303562001382682
cycle= 15 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 7.9e-10  |ddm|= 4.8e-09
HOMO (B2u) = -0.351621094828847  LUMO (B3u) = -0.0303562001338456
cycle= 16 E= -75.3373880045953  delta_E= -5.68e-14  |g|= 8.05e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.351621094865932  LUMO (B3u) = -0.0303562001249612
cycle= 17 E= -75.3373880045952  delta_E= 5.68e-14  |g|= 8.23e-10  |ddm|= 8.24e-10
HOMO (B2u) = -0.351621094843584  LUMO (B3u) = -0.0303562001009121
cycle= 18 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 6.29e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.351621094849307  LUMO (B3u) = -0.0303562001110383
cycle= 19 E= -75.3373880045953  delta_E= -4.26e-14  |g|= 5.5e-10  |ddm|= 3.07e-10
HOMO (B2u) = -0.351621094856917  LUMO (B3u) = -0.0303562001220133
cycle= 20 E= -75.3373880045952  delta_E= 4.26e-14  |g|= 4.68e-10  |ddm|= 2.06e-10
HOMO (B2u) = -0.351621094850133  LUMO (B3u) = -0.0303562001157004
cycle= 21 E= -75.3373880045952  delta_E= 1.42e-14  |g|= 3.7e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.351621094847088  LUMO (B3u) = -0.0303562001145423
cycle= 22 E= -75.3373880045951  delta_E= 7.11e-14  |g|= 2.74e-10  |ddm|= 1.96e-10
HOMO (B2u) = -0.351621094844435  LUMO (B3u) = -0.0303562001131804
cycle= 23 E= -75.3373880045952  delta_E= -4.26e-14  |g|= 1.83e-10  |ddm|= 1.88e-10
HOMO (B2u) = -0.351621094838947  LUMO (B3u) = -0.0303562001103522
cycle= 24 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 1.61e-10  |ddm|= 6.43e-11
HOMO (B2u) = -0.351621094838501  LUMO (B3u) = -0.0303562001084867
cycle= 25 E= -75.3373880045952  delta_E= 4.26e-14  |g|= 1.36e-10  |ddm|= 5.73e-11
HOMO (B2u) = -0.351621094836492  LUMO (B3u) = -0.0303562001067929
cycle= 26 E= -75.3373880045952  delta_E= -4.26e-14  |g|= 1.12e-10  |ddm|= 5.33e-11
HOMO (B2u) = -0.351621094834667  LUMO (B3u) = -0.0303562001053161
cycle= 27 E= -75.3373880045952  delta_E=    0  |g|= 9.56e-11  |ddm|= 4.01e-11
HOMO (B2u) = -0.351621094829988  LUMO (B3u) = -0.0303562001013312
Extra cycle  E= -75.3373880045953  delta_E= -4.26e-14  |g|= 3.54e-11  |ddm|= 1.32e-10
converged SCF energy = -75.3373880045953

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpykjiey99
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4523708352864  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4654802673699  dE = -0.013109432  S^2 = 0.0000000
               |grad[o]|=0.0884  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4766184169971  dE = -0.01113815  S^2 = 0.0000000
               |grad[o]|=0.0759  |ddm|=0.0715  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4854060650731  dE = -0.0087876481  S^2 = 0.0000000
               |grad[o]|=0.0617  |ddm|=0.0413  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4919732081386  dE = -0.0065671431  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.048  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4965052075387  dE = -0.0045319994  S^2 = 0.0000000
               |grad[o]|=0.0318  |ddm|=0.0653  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4980364476433  dE = -0.0015312401  S^2 = 0.0000000
               |grad[o]|=0.0142  |ddm|=0.0476  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4983508478308  dE = -0.00031440019  S^2 = 0.0000000
               |grad[o]|=0.00565  |ddm|=0.0316  |maxRot[o]|=0.0358
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4983917552916  dE = -4.0907461e-05  S^2 = 0.0000000
               |grad[o]|=0.0021  |ddm|=0.0103  |maxRot[o]|=0.0138
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4983962080755  dE = -4.452784e-06  S^2 = 0.0000000
               |grad[o]|=0.000736  |ddm|=0.0033  |maxRot[o]|=0.00467
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4983966685694  dE = -4.6049387e-07  S^2 = 0.0000000
               |grad[o]|=0.000246  |ddm|=0.00107  |maxRot[o]|=0.00151
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4983967154179  dE = -4.6848484e-08  S^2 = 0.0000000
               |grad[o]|=7.99e-05  |ddm|=0.000342  |maxRot[o]|=0.000483
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4983967201881  dE = -4.7702713e-09  S^2 = 0.0000000
               |grad[o]|=2.57e-05  |ddm|=0.000109  |maxRot[o]|=0.000155
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4983967206663  dE = -4.7820947e-10  S^2 = 0.0000000
               |grad[o]|=8.2e-06  |ddm|=3.47e-05  |maxRot[o]|=4.91e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4983967207138  dE = -4.7464255e-11  S^2 = 0.0000000
               |grad[o]|=2.59e-06  |ddm|=1.1e-05  |maxRot[o]|=1.54e-05
2-step CASSCF converged in 14 macro (57 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96168427 1.92995961 1.89788677 1.80319402 0.07495279 0.20294448
 0.05842681 0.07095125]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01086   0.00993  -0.00483   0.00000   0.00000
  0 C 2s       0.63886   0.65282  -0.30204  -0.00000  -0.00000
  0 C 3s      -0.01519   0.01695  -0.04490  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69411
  0 C 2py      0.00000  -0.00000  -0.00000   0.70440   0.00000
  0 C 2pz      0.30069  -0.27056   0.63672  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.05943
  0 C 3py      0.00000  -0.00000  -0.00000   0.05007   0.00000
  0 C 3pz     -0.01863  -0.00220   0.00482  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03622   0.00000
  0 C 3dz^2    0.02743  -0.01357   0.03519  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.12113
 0 C 3dx2-y2  -0.00059   0.00688  -0.00742  -0.00000  -0.00000
  1 C 1s       0.01086  -0.00993  -0.00483   0.00000   0.00000
  1 C 2s       0.63886  -0.65282  -0.30204   0.00000  -0.00000
  1 C 3s      -0.01519  -0.01695  -0.04490   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69411
  1 C 2py     -0.00000   0.00000   0.00000   0.70440  -0.00000
  1 C 2pz     -0.30069  -0.27056  -0.63672  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.05943
  1 C 3py     -0.00000   0.00000   0.00000   0.05007  -0.00000
  1 C 3pz      0.01863  -0.00220  -0.00482  -0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03622   0.00000
  1 C 3dz^2    0.02743   0.01357   0.03519   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12113
 1 C 3dx2-y2  -0.00059  -0.00688  -0.00742   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00043
  0 C 2s      -0.00000  -0.00000   0.26907
  0 C 3s      -0.00000  -0.00000   0.03634
  0 C 2px      0.00000   0.69753  -0.00000
  0 C 2py      0.70681   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.65078
  0 C 3px      0.00000  -0.00334  -0.00000
  0 C 3py     -0.01665   0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04624
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01219   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00964
  0 C 3dxz     0.00000  -0.11596  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02324
  1 C 1s       0.00000   0.00000   0.00043
  1 C 2s       0.00000  -0.00000  -0.26907
  1 C 3s       0.00000   0.00000  -0.03634
  1 C 2px      0.00000  -0.69753   0.00000
  1 C 2py     -0.70681  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.65078
  1 C 3px     -0.00000   0.00334   0.00000
  1 C 3py      0.01665  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04624
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.01219   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00964
  1 C 3dxz     0.00000  -0.11596  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02324
<CAS-nat-orb|mo-hf>  3  3    0.99623595
<CAS-nat-orb|mo-hf>  4  4    0.99972951
<CAS-nat-orb|mo-hf>  5  5    0.99625438
<CAS-nat-orb|mo-hf>  6  6    0.99910667
<CAS-nat-orb|mo-hf>  7  7    0.93825029
<CAS-nat-orb|mo-hf>  8  8    0.97590449
<CAS-nat-orb|mo-hf>  9  9    0.95945853
<CAS-nat-orb|mo-hf>  10  10    0.89805646
<CAS-nat-orb|mo-hf>  10  11   -0.41828627
CASSCF energy = -75.4983967207138
CASCI E = -75.4983967207138  E(CI) = -15.4874144112172  S^2 = 0.0000000
Density matrix diagonal elements [1.96168457 1.92996036 1.89788831 1.80319423 0.07495045 0.20294435
 0.05842652 0.07095121]
i = 1  <i|F|i> = -11.34261351
i = 2  <i|F|i> = -11.34284696
i = 3  <i|F|i> =  -0.85681815
i = 4  <i|F|i> =  -0.61649540
i = 5  <i|F|i> =  -0.37411765
i = 6  <i|F|i> =  -0.30896690
i = 7  <i|F|i> =   0.08710433
i = 8  <i|F|i> =   0.06727355
i = 9  <i|F|i> =   0.19378343
i = 10  <i|F|i> =   0.34810746
i = 11  <i|F|i> =   0.58538483
i = 12  <i|F|i> =   0.69136623
i = 13  <i|F|i> =   0.64731837
i = 14  <i|F|i> =   0.70850007
i = 15  <i|F|i> =   0.74820609
i = 16  <i|F|i> =   0.71570929
i = 17  <i|F|i> =   0.72037683
i = 18  <i|F|i> =   1.02885677
i = 19  <i|F|i> =   1.15123645
i = 20  <i|F|i> =   1.20830065
i = 21  <i|F|i> =   1.32396481
i = 22  <i|F|i> =   1.32416661
i = 23  <i|F|i> =   1.46514723
i = 24  <i|F|i> =   1.46383917
i = 25  <i|F|i> =   1.56103852
i = 26  <i|F|i> =   1.73268995
i = 27  <i|F|i> =   1.79691808
i = 28  <i|F|i> =   2.14049860
......production of RDMs took       2.48 sec
......reading the RDM took          0.45 sec
......production of RDMs took      36.73 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.71 sec

E(WickSCNEVPT2-ijrs) =    -0.00028478793364
E(WickSCNEVPT2- rsi) =    -0.00080143703252
E(WickSCNEVPT2- ijr) =    -0.00027587588978
E(WickSCNEVPT2-  rs) =    -0.03413486114624
E(WickSCNEVPT2-  ij) =    -0.00007410409514
E(WickSCNEVPT2-  ir) =    -0.00103845700493
E(WickSCNEVPT2-   r) =    -0.05698468123692
E(WickSCNEVPT2-   i) =    -0.00007611450857
E(WickSCNEVPT2) = -75.59206703956156  E_corr_pt = -0.09367031884773966
Timings = pdms =   49.36 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.54 | i =    0.25
Time cost =     89.606
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:59:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.825661377674 AA    0.000000000000   0.000000000000   3.450000000000 Bohr   0.0

nuclear repulsion = 10.4347826086957
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.725]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9279.49


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpu8po9mb3
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7871059587891

WARN: Singularity detected in overlap matrix (condition number =  114). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.119977421491999  LUMO (B3u) = -0.119977421491999

WARN: B2u HOMO -0.119977421491999 > system LUMO -0.119977421491999

cycle= 1 E= -75.3032347208422  delta_E= -0.516  |g|= 0.247  |ddm|=  1.5
HOMO (B2u) = -0.379319419622635  LUMO (B3u) = -0.0646054692258423
cycle= 2 E= -75.3274445047689  delta_E= -0.0242  |g|= 0.0501  |ddm|= 0.35
HOMO (B2u) = -0.34317302235637  LUMO (B3u) = -0.0236834315639844
cycle= 3 E= -75.3288571081841  delta_E= -0.00141  |g|= 0.018  |ddm|= 0.0664
HOMO (B2u) = -0.347657119428849  LUMO (B3u) = -0.0280415501187825
cycle= 4 E= -75.3290795920014  delta_E= -0.000222  |g|= 0.00067  |ddm|= 0.0369
HOMO (B2u) = -0.347805946692313  LUMO (B3u) = -0.0283390207305985
cycle= 5 E= -75.3290797635008  delta_E= -1.71e-07  |g|= 0.000106  |ddm|= 0.000935
HOMO (B2u) = -0.347769025805501  LUMO (B3u) = -0.0283049912511352
cycle= 6 E= -75.3290797699135  delta_E= -6.41e-09  |g|= 1.65e-05  |ddm|= 0.000181
HOMO (B2u) = -0.347766788756663  LUMO (B3u) = -0.0283057158319138
cycle= 7 E= -75.3290797700874  delta_E= -1.74e-10  |g|= 1.94e-06  |ddm|= 3.58e-05
HOMO (B2u) = -0.347766179406878  LUMO (B3u) = -0.0283055115204927
cycle= 8 E= -75.3290797700899  delta_E= -2.42e-12  |g|= 1.22e-07  |ddm|= 4.05e-06
HOMO (B2u) = -0.347766186617818  LUMO (B3u) = -0.0283055139495514
cycle= 9 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 7.66e-09  |ddm|= 2.61e-07
HOMO (B2u) = -0.347766186755262  LUMO (B3u) = -0.0283055158161351
cycle= 10 E= -75.3290797700898  delta_E=    0  |g|= 5.89e-09  |ddm|= 7.8e-09
HOMO (B2u) = -0.347766186551671  LUMO (B3u) = -0.0283055156109385
cycle= 11 E= -75.3290797700899  delta_E= -1.14e-13  |g|= 4.4e-09  |ddm|= 4.61e-09
HOMO (B2u) = -0.347766185193089  LUMO (B3u) = -0.0283055141901287
cycle= 12 E= -75.3290797700898  delta_E= 9.95e-14  |g|= 3.94e-09  |ddm|= 2.13e-09
HOMO (B2u) = -0.34776618556583  LUMO (B3u) = -0.0283055145568457
cycle= 13 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 3.55e-09  |ddm|= 1.35e-09
HOMO (B2u) = -0.347766185498218  LUMO (B3u) = -0.0283055145012134
cycle= 14 E= -75.3290797700899  delta_E= -1.42e-14  |g|= 3.06e-09  |ddm|= 9.45e-10
HOMO (B2u) = -0.347766185312401  LUMO (B3u) = -0.0283055143169249
cycle= 15 E= -75.3290797700898  delta_E= 4.26e-14  |g|= 8.69e-10  |ddm|= 5.07e-09
HOMO (B2u) = -0.347766185209105  LUMO (B3u) = -0.0283055143074677
cycle= 16 E= -75.3290797700898  delta_E=    0  |g|= 8.55e-10  |ddm|= 1.37e-09
HOMO (B2u) = -0.34776618524118  LUMO (B3u) = -0.0283055142975048
cycle= 17 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 8.92e-10  |ddm|= 7.74e-10
HOMO (B2u) = -0.34776618521432  LUMO (B3u) = -0.028305514272134
cycle= 18 E= -75.3290797700898  delta_E= -1.42e-14  |g|= 6.83e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.347766185217008  LUMO (B3u) = -0.0283055142807051
cycle= 19 E= -75.3290797700898  delta_E= -1.42e-14  |g|= 5.83e-10  |ddm|= 3.65e-10
HOMO (B2u) = -0.347766185221911  LUMO (B3u) = -0.0283055142902934
cycle= 20 E= -75.3290797700899  delta_E= -4.26e-14  |g|= 4.91e-10  |ddm|= 2.5e-10
HOMO (B2u) = -0.347766185212446  LUMO (B3u) = -0.0283055142825412
cycle= 21 E= -75.3290797700899  delta_E= 1.42e-14  |g|= 3.86e-10  |ddm|= 2.35e-10
HOMO (B2u) = -0.347766185206879  LUMO (B3u) = -0.0283055142799931
cycle= 22 E= -75.3290797700897  delta_E= 1.14e-13  |g|= 2.84e-10  |ddm|= 2.23e-10
HOMO (B2u) = -0.347766185201639  LUMO (B3u) = -0.0283055142773458
cycle= 23 E= -75.3290797700898  delta_E= -9.95e-14  |g|= 1.94e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.347766185195546  LUMO (B3u) = -0.0283055142743023
cycle= 24 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 1.7e-10  |ddm|= 7.07e-11
HOMO (B2u) = -0.347766185194212  LUMO (B3u) = -0.0283055142721249
cycle= 25 E= -75.3290797700899  delta_E= -4.26e-14  |g|= 1.43e-10  |ddm|= 6.19e-11
HOMO (B2u) = -0.347766185191446  LUMO (B3u) = -0.0283055142701077
cycle= 26 E= -75.3290797700898  delta_E= 7.11e-14  |g|= 1.18e-10  |ddm|= 6.3e-11
HOMO (B2u) = -0.34776618518907  LUMO (B3u) = -0.0283055142684057
cycle= 27 E= -75.3290797700898  delta_E=    0  |g|= 9.9e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.347766185182804  LUMO (B3u) = -0.0283055142638148
Extra cycle  E= -75.3290797700898  delta_E=    0  |g|= 3.61e-11  |ddm|= 1.45e-10
converged SCF energy = -75.3290797700898

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpu8po9mb3
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4482666492426  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4618049986755  dE = -0.013538349  S^2 = 0.0000000
               |grad[o]|=0.0903  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4731372408995  dE = -0.011332242  S^2 = 0.0000000
               |grad[o]|=0.0766  |ddm|=0.0762  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4818347664706  dE = -0.0086975256  S^2 = 0.0000000
               |grad[o]|=0.0609  |ddm|=0.0424  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4881398056584  dE = -0.0063050392  S^2 = 0.0000000
               |grad[o]|=0.0447  |ddm|=0.0518  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4917456919588  dE = -0.0036058863  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.0696  |maxRot[o]|= 0.06
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4932311762216  dE = -0.0014854843  S^2 = 0.0000000
               |grad[o]|=0.014  |ddm|=0.0391  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.493507162887  dE = -0.00027598667  S^2 = 0.0000000
               |grad[o]|=0.00522  |ddm|=0.0263  |maxRot[o]|=0.034
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4935391201177  dE = -3.1957231e-05  S^2 = 0.0000000
               |grad[o]|=0.00188  |ddm|=0.00869  |maxRot[o]|=0.0124
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4935423354116  dE = -3.215294e-06  S^2 = 0.0000000
               |grad[o]|=0.000641  |ddm|=0.00271  |maxRot[o]|=0.004
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4935426466091  dE = -3.1119751e-07  S^2 = 0.0000000
               |grad[o]|=0.000207  |ddm|=0.000854  |maxRot[o]|=0.00125
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4935426764192  dE = -2.9810053e-08  S^2 = 0.0000000
               |grad[o]|=6.54e-05  |ddm|=0.000266  |maxRot[o]|=0.000388
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4935426792612  dE = -2.8420288e-09  S^2 = 0.0000000
               |grad[o]|=2.04e-05  |ddm|=8.28e-05  |maxRot[o]|=0.00012
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4935426795291  dE = -2.6787461e-10  S^2 = 0.0000000
               |grad[o]|=6.32e-06  |ddm|=2.56e-05  |maxRot[o]|=3.72e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4935426795535  dE = -2.4371616e-11  S^2 = 0.0000000
               |grad[o]|=1.96e-06  |ddm|=7.9e-06  |maxRot[o]|=1.15e-05
2-step CASSCF converged in 14 macro (56 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96070609 1.93062246 1.89534328 1.79161505 0.07330624 0.21443249
 0.05813181 0.07584257]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01111   0.01003  -0.00449   0.00000   0.00000
  0 C 2s       0.64834   0.65619  -0.28117   0.00000   0.00000
  0 C 3s      -0.01251   0.01666  -0.04312  -0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69393
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439   0.00000
  0 C 2pz      0.28005  -0.26233   0.64632  -0.00000   0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06065
  0 C 3py      0.00000  -0.00000   0.00000   0.05111   0.00000
  0 C 3pz     -0.01714  -0.00207   0.00620  -0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.03500   0.00000
  0 C 3dz^2    0.02561  -0.01317   0.03529  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.12160
 0 C 3dx2-y2  -0.00030   0.00676  -0.00739   0.00000   0.00000
  1 C 1s       0.01111  -0.01003  -0.00449   0.00000   0.00000
  1 C 2s       0.64834  -0.65619  -0.28117   0.00000   0.00000
  1 C 3s      -0.01251  -0.01666  -0.04312   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69393
  1 C 2py     -0.00000   0.00000  -0.00000   0.70439  -0.00000
  1 C 2pz     -0.28005  -0.26233  -0.64632   0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000  -0.06065
  1 C 3py     -0.00000   0.00000   0.00000   0.05111  -0.00000
  1 C 3pz      0.01714  -0.00207  -0.00620  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03500   0.00000
  1 C 3dz^2    0.02561   0.01317   0.03529   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12160
 1 C 3dx2-y2  -0.00030  -0.00676  -0.00739  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s       0.00000   0.00000   0.26097
  0 C 3s      -0.00000   0.00000   0.03534
  0 C 2px     -0.00000   0.69766   0.00000
  0 C 2py      0.70686  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.65436
  0 C 3px     -0.00000  -0.00539  -0.00000
  0 C 3py     -0.01459  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04356
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01176  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00868
  0 C 3dxz    -0.00000  -0.11509   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02209
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.26097
  1 C 3s       0.00000  -0.00000  -0.03534
  1 C 2px      0.00000  -0.69766   0.00000
  1 C 2py     -0.70686   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.65436
  1 C 3px      0.00000   0.00539  -0.00000
  1 C 3py      0.01459   0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04356
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01176  -0.00000   0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00868
  1 C 3dxz    -0.00000  -0.11509   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02209
<CAS-nat-orb|mo-hf>  3  3    0.99779512
<CAS-nat-orb|mo-hf>  4  4    0.99972139
<CAS-nat-orb|mo-hf>  5  5    0.99781371
<CAS-nat-orb|mo-hf>  6  6    0.99905368
<CAS-nat-orb|mo-hf>  7  7    0.93724395
<CAS-nat-orb|mo-hf>  8  8    0.97733329
<CAS-nat-orb|mo-hf>  9  9    0.95969121
<CAS-nat-orb|mo-hf>  10  10    0.90788563
CASSCF energy = -75.4935426795535
CASCI E = -75.4935426795535  E(CI) = -15.414487534516  S^2 = 0.0000000
Density matrix diagonal elements [1.9607064  1.93062285 1.8953433  1.79161591 0.07330536 0.214432
 0.05813169 0.07584249]
i = 1  <i|F|i> = -11.34339815
i = 2  <i|F|i> = -11.34366104
i = 3  <i|F|i> =  -0.85111785
i = 4  <i|F|i> =  -0.61958111
i = 5  <i|F|i> =  -0.36890398
i = 6  <i|F|i> =  -0.30352605
i = 7  <i|F|i> =   0.09068052
i = 8  <i|F|i> =   0.06014667
i = 9  <i|F|i> =   0.19101584
i = 10  <i|F|i> =   0.32949508
i = 11  <i|F|i> =   0.58968599
i = 12  <i|F|i> =   0.69134186
i = 13  <i|F|i> =   0.64511319
i = 14  <i|F|i> =   0.71108638
i = 15  <i|F|i> =   0.75372288
i = 16  <i|F|i> =   0.71698347
i = 17  <i|F|i> =   0.72001406
i = 18  <i|F|i> =   1.02475402
i = 19  <i|F|i> =   1.15493252
i = 20  <i|F|i> =   1.21007274
i = 21  <i|F|i> =   1.32875617
i = 22  <i|F|i> =   1.32896908
i = 23  <i|F|i> =   1.46093309
i = 24  <i|F|i> =   1.45974326
i = 25  <i|F|i> =   1.53550128
i = 26  <i|F|i> =   1.71790779
i = 27  <i|F|i> =   1.78131704
i = 28  <i|F|i> =   2.14009629
......production of RDMs took       1.94 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.98 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.74 sec

E(WickSCNEVPT2-ijrs) =    -0.00028582396995
E(WickSCNEVPT2- rsi) =    -0.00080205376345
E(WickSCNEVPT2- ijr) =    -0.00027347481026
E(WickSCNEVPT2-  rs) =    -0.03394218009607
E(WickSCNEVPT2-  ij) =    -0.00007152687468
E(WickSCNEVPT2-  ir) =    -0.00103077281159
E(WickSCNEVPT2-   r) =    -0.05738747139361
E(WickSCNEVPT2-   i) =    -0.00007250483512
E(WickSCNEVPT2) = -75.58740848810821  E_corr_pt = -0.09386580855473338
Timings = pdms =   33.11 | eris =    0.16 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.04 | ir =    0.03 | r =    0.57 | i =    0.26
Time cost =    129.364
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:02:02 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.852120238220 AA    0.000000000000   0.000000000000   3.500000000000 Bohr   0.0

nuclear repulsion = 10.2857142857143
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.75]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9341.14


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpehkufx2c
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.770995471526

WARN: Singularity detected in overlap matrix (condition number =  106). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.116499456302712  LUMO (B3u) = -0.116499456302711

WARN: B2u HOMO -0.116499456302712 > system LUMO -0.116499456302711

cycle= 1 E= -75.2953428985397  delta_E= -0.524  |g|= 0.245  |ddm|= 1.49
HOMO (B2u) = -0.375058505355514  LUMO (B3u) = -0.062067362653831
cycle= 2 E= -75.3191698853078  delta_E= -0.0238  |g|= 0.0495  |ddm|= 0.35
HOMO (B2u) = -0.339451307241012  LUMO (B3u) = -0.021715306524039
cycle= 3 E= -75.3205643325183  delta_E= -0.00139  |g|= 0.0179  |ddm|= 0.0655
HOMO (B2u) = -0.343918314413036  LUMO (B3u) = -0.0260457604373088
cycle= 4 E= -75.320786165773  delta_E= -0.000222  |g|= 0.000666  |ddm|= 0.0365
HOMO (B2u) = -0.344078228753202  LUMO (B3u) = -0.0263545301612762
cycle= 5 E= -75.3207863342662  delta_E= -1.68e-07  |g|= 0.00011  |ddm|= 0.000905
HOMO (B2u) = -0.344040928123838  LUMO (B3u) = -0.0263210064987894
cycle= 6 E= -75.3207863411989  delta_E= -6.93e-09  |g|= 1.7e-05  |ddm|= 0.000188
HOMO (B2u) = -0.344038581299416  LUMO (B3u) = -0.0263216091209567
cycle= 7 E= -75.3207863413827  delta_E= -1.84e-10  |g|= 1.93e-06  |ddm|= 3.63e-05
HOMO (B2u) = -0.344037999604689  LUMO (B3u) = -0.0263214409572327
cycle= 8 E= -75.3207863413852  delta_E= -2.53e-12  |g|= 1.24e-07  |ddm|= 4.02e-06
HOMO (B2u) = -0.344038005466646  LUMO (B3u) = -0.0263214419457197
cycle= 9 E= -75.3207863413852  delta_E= 2.84e-14  |g|= 8.04e-09  |ddm|= 2.72e-07
HOMO (B2u) = -0.344038005453481  LUMO (B3u) = -0.0263214437221253
cycle= 10 E= -75.3207863413852  delta_E=    0  |g|= 6.26e-09  |ddm|= 7.91e-09
HOMO (B2u) = -0.344038005259377  LUMO (B3u) = -0.0263214435371924
cycle= 11 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 4.62e-09  |ddm|= 4.89e-09
HOMO (B2u) = -0.344038003880771  LUMO (B3u) = -0.0263214420965979
cycle= 12 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 4.1e-09  |ddm|= 2.25e-09
HOMO (B2u) = -0.344038004235066  LUMO (B3u) = -0.0263214424506257
cycle= 13 E= -75.3207863413852  delta_E=    0  |g|= 3.69e-09  |ddm|= 1.49e-09
HOMO (B2u) = -0.344038004143292  LUMO (B3u) = -0.026321442366138
cycle= 14 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 3.11e-09  |ddm|= 1.26e-09
HOMO (B2u) = -0.344038003955487  LUMO (B3u) = -0.0263214422136508
cycle= 15 E= -75.3207863413851  delta_E= -2.84e-14  |g|= 9.31e-10  |ddm|= 5.21e-09
HOMO (B2u) = -0.344038003851089  LUMO (B3u) = -0.0263214422044347
cycle= 16 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 8.97e-10  |ddm|= 1.22e-09
HOMO (B2u) = -0.344038003889177  LUMO (B3u) = -0.0263214421913496
cycle= 17 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 9.61e-10  |ddm|= 9.81e-10
HOMO (B2u) = -0.344038003858427  LUMO (B3u) = -0.0263214421652801
cycle= 18 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 7.37e-10  |ddm|= 5.29e-10
HOMO (B2u) = -0.34403800385857  LUMO (B3u) = -0.0263214421727953
cycle= 19 E= -75.3207863413851  delta_E= -2.84e-14  |g|= 6.17e-10  |ddm|= 4.19e-10
HOMO (B2u) = -0.3440380038613  LUMO (B3u) = -0.0263214421815386
cycle= 20 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 5.15e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.344038003849509  LUMO (B3u) = -0.0263214421727859
cycle= 21 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 4.04e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.344038003841714  LUMO (B3u) = -0.0263214421691272
cycle= 22 E= -75.3207863413851  delta_E= -2.84e-14  |g|= 2.96e-10  |ddm|= 2.48e-10
HOMO (B2u) = -0.344038003834222  LUMO (B3u) = -0.0263214421655101
cycle= 23 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 2.07e-10  |ddm|= 2.11e-10
HOMO (B2u) = -0.344038003827957  LUMO (B3u) = -0.026321442162359
cycle= 24 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.79e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.344038003826301  LUMO (B3u) = -0.0263214421599135
cycle= 25 E= -75.3207863413851  delta_E= -8.53e-14  |g|= 1.51e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.344038003822882  LUMO (B3u) = -0.026321442157639
cycle= 26 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 1.23e-10  |ddm|= 7.2e-11
HOMO (B2u) = -0.344038003820043  LUMO (B3u) = -0.0263214421557609
cycle= 27 E= -75.3207863413852  delta_E= -1.14e-13  |g|= 1.03e-10  |ddm|= 5.49e-11
HOMO (B2u) = -0.344038003817709  LUMO (B3u) = -0.0263214421541762
cycle= 28 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 8.36e-11  |ddm|= 4.71e-11
HOMO (B2u) = -0.344038003815909  LUMO (B3u) = -0.0263214421529692
cycle= 29 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 6.65e-11  |ddm|= 4.03e-11
HOMO (B2u) = -0.344038003814386  LUMO (B3u) = -0.0263214421519459
cycle= 30 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 5.27e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.344038003813242  LUMO (B3u) = -0.0263214421511847
cycle= 31 E= -75.3207863413851  delta_E= -5.68e-14  |g|= 4.26e-11  |ddm|= 2.38e-11
HOMO (B2u) = -0.344038003812438  LUMO (B3u) = -0.0263214421506447
cycle= 32 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 3.55e-11  |ddm|= 1.66e-11
HOMO (B2u) = -0.344038003811839  LUMO (B3u) = -0.0263214421501881
cycle= 33 E= -75.3207863413852  delta_E= -8.53e-14  |g|= 2.94e-11  |ddm|= 1.44e-11
HOMO (B2u) = -0.344038003811273  LUMO (B3u) = -0.026321442149804
cycle= 34 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 2.43e-11  |ddm|= 1.22e-11
HOMO (B2u) = -0.344038003810815  LUMO (B3u) = -0.0263214421494894
cycle= 35 E= -75.3207863413852  delta_E= -8.53e-14  |g|= 2.01e-11  |ddm|= 9.99e-12
HOMO (B2u) = -0.344038003810437  LUMO (B3u) = -0.0263214421492233
cycle= 36 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 1.64e-11  |ddm|= 8.42e-12
HOMO (B2u) = -0.344038003810131  LUMO (B3u) = -0.026321442149005
cycle= 37 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.34e-11  |ddm|= 6.88e-12
HOMO (B2u) = -0.34403800380989  LUMO (B3u) = -0.0263214421488311
cycle= 38 E= -75.3207863413851  delta_E=    0  |g|= 1.1e-11  |ddm|= 5.47e-12
HOMO (B2u) = -0.344038003809242  LUMO (B3u) = -0.0263214421483577
Extra cycle  E= -75.3207863413851  delta_E=    0  |g|= 4.22e-12  |ddm|= 1.52e-11
converged SCF energy = -75.3207863413851

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpehkufx2c
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4441902032777  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.45816640188  dE = -0.013976199  S^2 = 0.0000000
               |grad[o]|=0.0923  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4696819209061  dE = -0.011515519  S^2 = 0.0000000
               |grad[o]|=0.0772  |ddm|=0.0811  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4782645461803  dE = -0.0085826253  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.0433  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4842992499606  dE = -0.0060347038  S^2 = 0.0000000
               |grad[o]|=0.0424  |ddm|=0.0579  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4876547161987  dE = -0.0033554662  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.0727  |maxRot[o]|=0.0598
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4884265086838  dE = -0.00077179249  S^2 = 0.0000000
               |grad[o]|=0.0102  |ddm|=0.0385  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4887230889611  dE = -0.00029658028  S^2 = 0.0000000
               |grad[o]|=0.00537  |ddm|=0.0131  |maxRot[o]|=0.0351
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4887546373467  dE = -3.1548386e-05  S^2 = 0.0000000
               |grad[o]|=0.00189  |ddm|=0.0083  |maxRot[o]|=0.0124
macro iter 9 (3 JK  0 micro), CASSCF E = -75.488757631922  dE = -2.9945754e-06  S^2 = 0.0000000
               |grad[o]|=0.000634  |ddm|=0.00254  |maxRot[o]|=0.00388
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4887579066453  dE = -2.7472323e-07  S^2 = 0.0000000
               |grad[o]|=0.000199  |ddm|=0.000782  |maxRot[o]|=0.00118
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4887579316398  dE = -2.4994506e-08  S^2 = 0.0000000
               |grad[o]|=6.16e-05  |ddm|=0.000238  |maxRot[o]|=0.000357
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4887579338977  dE = -2.2578774e-09  S^2 = 0.0000000
               |grad[o]|=1.87e-05  |ddm|=7.12e-05  |maxRot[o]|=0.000108
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4887579341011  dE = -2.0342839e-10  S^2 = 0.0000000
               |grad[o]|=5.64e-06  |ddm|=2.16e-05  |maxRot[o]|=3.22e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4887579341158  dE = -1.4708235e-11  S^2 = 0.0000000
               |grad[o]|=1.72e-06  |ddm|=6.52e-06  |maxRot[o]|=9.79e-06
2-step CASSCF converged in 14 macro (55 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95981388 1.93127285 1.8922826  1.77943942 0.07180263 0.22650183
 0.05783615 0.08105064]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01133   0.01013  -0.00414   0.00000   0.00000
  0 C 2s       0.65705   0.65938  -0.26022  -0.00000  -0.00000
  0 C 3s      -0.00998   0.01639  -0.04128   0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69378
  0 C 2py     -0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.25932  -0.25424   0.65514  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06179
  0 C 3py     -0.00000   0.00000   0.00000   0.05203   0.00000
  0 C 3pz     -0.01577  -0.00197   0.00765   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.03378   0.00000
  0 C 3dz^2    0.02382  -0.01278   0.03532  -0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000  -0.12186
 0 C 3dx2-y2  -0.00000   0.00665  -0.00734  -0.00000   0.00000
  1 C 1s       0.01133  -0.01013  -0.00414   0.00000   0.00000
  1 C 2s       0.65705  -0.65938  -0.26022  -0.00000  -0.00000
  1 C 3s      -0.00998  -0.01639  -0.04128   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69378
  1 C 2py     -0.00000   0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.25932  -0.25424  -0.65514  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06179
  1 C 3py      0.00000  -0.00000  -0.00000   0.05203  -0.00000
  1 C 3pz      0.01577  -0.00197  -0.00765  -0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03378   0.00000
  1 C 3dz^2    0.02382   0.01278   0.03532   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12186
 1 C 3dx2-y2  -0.00000  -0.00665  -0.00734  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000  -0.00000   0.25300
  0 C 3s      -0.00000   0.00000   0.03435
  0 C 2px     -0.00000   0.69779  -0.00000
  0 C 2py      0.70690   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.65775
  0 C 3px     -0.00000  -0.00738  -0.00000
  0 C 3py     -0.01256  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.04088
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01132  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00778
  0 C 3dxz    -0.00000  -0.11419   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02095
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s      -0.00000  -0.00000  -0.25300
  1 C 3s       0.00000   0.00000  -0.03435
  1 C 2px      0.00000  -0.69779  -0.00000
  1 C 2py     -0.70690   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.65775
  1 C 3px      0.00000   0.00738   0.00000
  1 C 3py      0.01256   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04088
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01132  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00778
  1 C 3dxz    -0.00000  -0.11419  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02095
<CAS-nat-orb|mo-hf>  3  3    0.99891158
<CAS-nat-orb|mo-hf>  4  4    0.99971276
<CAS-nat-orb|mo-hf>  5  5    0.99892917
<CAS-nat-orb|mo-hf>  6  6    0.99899872
<CAS-nat-orb|mo-hf>  7  7    0.93636098
<CAS-nat-orb|mo-hf>  8  8    0.97867429
<CAS-nat-orb|mo-hf>  9  9    0.95989986
<CAS-nat-orb|mo-hf>  10  10    0.91658565
CASSCF energy = -75.4887579341158
CASCI E = -75.4887579341158  E(CI) = -15.3435702378967  S^2 = 0.0000000
Density matrix diagonal elements [1.95981402 1.93127356 1.89228386 1.77943919 0.0718009  0.22650193
 0.05783594 0.08105061]
i = 1  <i|F|i> = -11.34405675
i = 2  <i|F|i> = -11.34434492
i = 3  <i|F|i> =  -0.84523435
i = 4  <i|F|i> =  -0.62257020
i = 5  <i|F|i> =  -0.36406053
i = 6  <i|F|i> =  -0.29814452
i = 7  <i|F|i> =   0.09397672
i = 8  <i|F|i> =   0.05321735
i = 9  <i|F|i> =   0.18837783
i = 10  <i|F|i> =   0.31179551
i = 11  <i|F|i> =   0.59394373
i = 12  <i|F|i> =   0.69110208
i = 13  <i|F|i> =   0.64288277
i = 14  <i|F|i> =   0.71308029
i = 15  <i|F|i> =   0.71823615
i = 16  <i|F|i> =   0.71968949
i = 17  <i|F|i> =   0.75978473
i = 18  <i|F|i> =   1.02084084
i = 19  <i|F|i> =   1.15936767
i = 20  <i|F|i> =   1.21258730
i = 21  <i|F|i> =   1.33337991
i = 22  <i|F|i> =   1.33360713
i = 23  <i|F|i> =   1.45695167
i = 24  <i|F|i> =   1.45587217
i = 25  <i|F|i> =   1.51074630
i = 26  <i|F|i> =   1.70339982
i = 27  <i|F|i> =   1.76593632
i = 28  <i|F|i> =   2.13873209
......production of RDMs took       1.81 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.16 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.66 sec

E(WickSCNEVPT2-ijrs) =    -0.00028701891628
E(WickSCNEVPT2- rsi) =    -0.00080322266758
E(WickSCNEVPT2- ijr) =    -0.00027126627700
E(WickSCNEVPT2-  rs) =    -0.03375581388229
E(WickSCNEVPT2-  ij) =    -0.00006911634259
E(WickSCNEVPT2-  ir) =    -0.00102370795450
E(WickSCNEVPT2-   r) =    -0.05777624317054
E(WickSCNEVPT2-   i) =    -0.00006909542480
E(WickSCNEVPT2) = -75.58281341875139  E_corr_pt = -0.09405548463558509
Timings = pdms =   32.06 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.55 | i =    0.24
Time cost =    551.172
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:11:13 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.878579098766 AA    0.000000000000   0.000000000000   3.550000000000 Bohr   0.0

nuclear repulsion = 10.1408450704225
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.775]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9653.52


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp0smb1sq4
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.755922874727

WARN: Singularity detected in overlap matrix (condition number = 98.8). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.113183134036075  LUMO (B3u) = -0.113183134036075

WARN: B2u HOMO -0.113183134036075 > system LUMO -0.113183134036075

cycle= 1 E= -75.2874734693519  delta_E= -0.532  |g|= 0.242  |ddm|= 1.48
HOMO (B2u) = -0.370939595595211  LUMO (B3u) = -0.0596135835397227
cycle= 2 E= -75.3109303175842  delta_E= -0.0235  |g|= 0.0489  |ddm|= 0.349
HOMO (B2u) = -0.335857476925404  LUMO (B3u) = -0.0198166980956895
cycle= 3 E= -75.3123050204644  delta_E= -0.00137  |g|= 0.0178  |ddm|= 0.0646
HOMO (B2u) = -0.340305747412607  LUMO (B3u) = -0.0241187549333956
cycle= 4 E= -75.3125256665475  delta_E= -0.000221  |g|= 0.000662  |ddm|= 0.0362
HOMO (B2u) = -0.340473004463874  LUMO (B3u) = -0.0244347316795403
cycle= 5 E= -75.3125258326696  delta_E= -1.66e-07  |g|= 0.000114  |ddm|= 0.000883
HOMO (B2u) = -0.340435552234744  LUMO (B3u) = -0.0244019229355875
cycle= 6 E= -75.3125258401168  delta_E= -7.45e-09  |g|= 1.75e-05  |ddm|= 0.000196
HOMO (B2u) = -0.340433109443011  LUMO (B3u) = -0.0244024220699469
cycle= 7 E= -75.3125258403105  delta_E= -1.94e-10  |g|= 1.93e-06  |ddm|= 3.69e-05
HOMO (B2u) = -0.340432553987163  LUMO (B3u) = -0.0244022873481505
cycle= 8 E= -75.3125258403129  delta_E= -2.42e-12  |g|= 1.26e-07  |ddm|= 4e-06
HOMO (B2u) = -0.340432558917058  LUMO (B3u) = -0.0244022873230195
cycle= 9 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 8.38e-09  |ddm|= 2.82e-07
HOMO (B2u) = -0.340432558748864  LUMO (B3u) = -0.0244022890038686
cycle= 10 E= -75.3125258403129  delta_E=    0  |g|= 6.61e-09  |ddm|= 7.95e-09
HOMO (B2u) = -0.340432558577938  LUMO (B3u) = -0.0244022888587754
cycle= 11 E= -75.3125258403129  delta_E=    0  |g|= 4.83e-09  |ddm|= 5.21e-09
HOMO (B2u) = -0.340432557195561  LUMO (B3u) = -0.0244022874172098
cycle= 12 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 4.25e-09  |ddm|= 2.4e-09
HOMO (B2u) = -0.340432557527057  LUMO (B3u) = -0.0244022877525277
cycle= 13 E= -75.3125258403128  delta_E= -2.84e-14  |g|= 3.83e-09  |ddm|= 1.58e-09
HOMO (B2u) = -0.340432557415283  LUMO (B3u) = -0.0244022876443536
cycle= 14 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 3.17e-09  |ddm|= 1.55e-09
HOMO (B2u) = -0.340432557232128  LUMO (B3u) = -0.0244022875217237
cycle= 15 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 9.91e-10  |ddm|= 5.61e-09
HOMO (B2u) = -0.340432557126558  LUMO (B3u) = -0.0244022875097373
cycle= 16 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 9.39e-10  |ddm|= 1.27e-09
HOMO (B2u) = -0.340432557163251  LUMO (B3u) = -0.0244022874952653
cycle= 17 E= -75.3125258403128  delta_E=    0  |g|= 1.02e-09  |ddm|= 1.01e-09
HOMO (B2u) = -0.340432557129496  LUMO (B3u) = -0.0244022874690825
cycle= 18 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 7.86e-10  |ddm|= 5.81e-10
HOMO (B2u) = -0.340432557127196  LUMO (B3u) = -0.0244022874757082
cycle= 19 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 6.48e-10  |ddm|= 4.68e-10
HOMO (B2u) = -0.340432557128129  LUMO (B3u) = -0.024402287483893
cycle= 20 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 5.36e-10  |ddm|= 3.25e-10
HOMO (B2u) = -0.34043255711455  LUMO (B3u) = -0.0244022874745579
cycle= 21 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 4.2e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.340432557104935  LUMO (B3u) = -0.0244022874701148
cycle= 22 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 3.06e-10  |ddm|= 2.7e-10
HOMO (B2u) = -0.340432557095643  LUMO (B3u) = -0.0244022874658667
cycle= 23 E= -75.3125258403129  delta_E=    0  |g|= 2.17e-10  |ddm|= 2.25e-10
HOMO (B2u) = -0.340432557088908  LUMO (B3u) = -0.0244022874625731
cycle= 24 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 1.87e-10  |ddm|= 7.91e-11
HOMO (B2u) = -0.340432557086663  LUMO (B3u) = -0.0244022874599249
cycle= 25 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 1.58e-10  |ddm|= 7.09e-11
HOMO (B2u) = -0.340432557082676  LUMO (B3u) = -0.0244022874574718
cycle= 26 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 1.28e-10  |ddm|= 7.98e-11
HOMO (B2u) = -0.340432557079428  LUMO (B3u) = -0.0244022874554771
cycle= 27 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 1.06e-10  |ddm|= 6.11e-11
HOMO (B2u) = -0.340432557076755  LUMO (B3u) = -0.024402287453799
cycle= 28 E= -75.3125258403128  delta_E= 2.84e-14  |g|= 8.58e-11  |ddm|= 5.1e-11
HOMO (B2u) = -0.34043255707467  LUMO (B3u) = -0.0244022874525137
cycle= 29 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 6.81e-11  |ddm|= 4.29e-11
HOMO (B2u) = -0.340432557072921  LUMO (B3u) = -0.0244022874514314
cycle= 30 E= -75.3125258403129  delta_E=    0  |g|= 5.39e-11  |ddm|= 3.41e-11
HOMO (B2u) = -0.340432557068699  LUMO (B3u) = -0.0244022874487677
Extra cycle  E= -75.3125258403128  delta_E= 2.84e-14  |g|= 1.96e-11  |ddm|= 8.28e-11
converged SCF energy = -75.3125258403128

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp0smb1sq4
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4401587585066  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4545821847277  dE = -0.014423426  S^2 = 0.0000000
               |grad[o]|=0.0942  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4662692480556  dE = -0.011687063  S^2 = 0.0000000
               |grad[o]|=0.0778  |ddm|=0.0861  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4747099542609  dE = -0.0084407062  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.0439  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4804719532846  dE = -0.005761999  S^2 = 0.0000000
               |grad[o]|= 0.04  |ddm|=0.0658  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4831435204836  dE = -0.0026715672  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.0737  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4838239796159  dE = -0.00068045913  S^2 = 0.0000000
               |grad[o]|=0.00925  |ddm|=0.0308  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4840371160353  dE = -0.00021313642  S^2 = 0.0000000
               |grad[o]|=0.00453  |ddm|=0.0109  |maxRot[o]|=0.0304
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4840577811658  dE = -2.066513e-05  S^2 = 0.0000000
               |grad[o]|=0.00158  |ddm|=0.00643  |maxRot[o]|=0.0101
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4840596355541  dE = -1.8543884e-06  S^2 = 0.0000000
               |grad[o]|=0.000517  |ddm|=0.00195  |maxRot[o]|=0.00307
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4840597983765  dE = -1.6282239e-07  S^2 = 0.0000000
               |grad[o]|=0.000159  |ddm|=0.000592  |maxRot[o]|=0.000913
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4840598125418  dE = -1.4165295e-08  S^2 = 0.0000000
               |grad[o]|=4.79e-05  |ddm|=0.000176  |maxRot[o]|=0.00027
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4840598137745  dE = -1.2326495e-09  S^2 = 0.0000000
               |grad[o]|=1.43e-05  |ddm|=5.21e-05  |maxRot[o]|=7.95e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4840598138814  dE = -1.0692247e-10  S^2 = 0.0000000
               |grad[o]|=4.23e-06  |ddm|=1.54e-05  |maxRot[o]|=2.35e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4840598138906  dE = -9.1660013e-12  S^2 = 0.0000000
               |grad[o]|=1.25e-06  |ddm|=4.55e-06  |maxRot[o]|=6.92e-06
2-step CASSCF converged in 14 macro (55 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95901066 1.93191387 1.88869909 1.76663822 0.07041579 0.23918108
 0.05753793 0.08660336]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01153   0.01022  -0.00378   0.00000   0.00000
  0 C 2s       0.66488   0.66240  -0.23954  -0.00000  -0.00000
  0 C 3s      -0.00763   0.01613  -0.03939  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69368
  0 C 2py      0.00000  -0.00000  -0.00000   0.70438  -0.00000
  0 C 2pz      0.23883  -0.24630   0.66308  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06285
  0 C 3py     -0.00000  -0.00000  -0.00000   0.05282  -0.00000
  0 C 3pz     -0.01454  -0.00188   0.00916  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.00000  -0.00000   0.03256  -0.00000
  0 C 3dz^2    0.02207  -0.01238   0.03528  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.12191
 0 C 3dx2-y2   0.00028   0.00654  -0.00728   0.00000  -0.00000
  1 C 1s       0.01153  -0.01022  -0.00378   0.00000   0.00000
  1 C 2s       0.66488  -0.66240  -0.23954   0.00000   0.00000
  1 C 3s      -0.00763  -0.01613  -0.03939   0.00000   0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69368
  1 C 2py      0.00000  -0.00000   0.00000   0.70438   0.00000
  1 C 2pz     -0.23883  -0.24630  -0.66308   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06285
  1 C 3py     -0.00000   0.00000   0.00000   0.05282   0.00000
  1 C 3pz      0.01454  -0.00188  -0.00916  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03256  -0.00000
  1 C 3dz^2    0.02207   0.01238   0.03528   0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12191
 1 C 3dx2-y2   0.00028  -0.00654  -0.00728   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00035
  0 C 2s      -0.00000  -0.00000   0.24517
  0 C 3s      -0.00000  -0.00000   0.03335
  0 C 2px     -0.00000   0.69791  -0.00000
  0 C 2py      0.70694   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.66096
  0 C 3px      0.00000  -0.00931  -0.00000
  0 C 3py     -0.01055  -0.00000   0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03822
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.01090  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00694
  0 C 3dxz     0.00000  -0.11326  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01984
  1 C 1s       0.00000   0.00000   0.00035
  1 C 2s       0.00000   0.00000  -0.24517
  1 C 3s       0.00000   0.00000  -0.03335
  1 C 2px     -0.00000  -0.69791  -0.00000
  1 C 2py     -0.70694   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.66096
  1 C 3px      0.00000   0.00931   0.00000
  1 C 3py      0.01055  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03822
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01090   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00694
  1 C 3dxz    -0.00000  -0.11326  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01984
<CAS-nat-orb|mo-hf>  3  3    0.99958549
<CAS-nat-orb|mo-hf>  4  4    0.99970353
<CAS-nat-orb|mo-hf>  5  5    0.99960080
<CAS-nat-orb|mo-hf>  6  6    0.99894173
<CAS-nat-orb|mo-hf>  7  7    0.93559187
<CAS-nat-orb|mo-hf>  8  8    0.97993346
<CAS-nat-orb|mo-hf>  9  9    0.96008674
<CAS-nat-orb|mo-hf>  10  10    0.92430540
CASSCF energy = -75.4840598138906
CASCI E = -75.4840598138906  E(CI) = -15.2745978907237  S^2 = 0.0000000
Density matrix diagonal elements [1.95901083 1.93191411 1.88870033 1.76663797 0.07041432 0.23918133
 0.05753775 0.08660336]
i = 1  <i|F|i> = -11.34459083
i = 2  <i|F|i> = -11.34490056
i = 3  <i|F|i> =  -0.83916933
i = 4  <i|F|i> =  -0.62546185
i = 5  <i|F|i> =  -0.35958216
i = 6  <i|F|i> =  -0.29281660
i = 7  <i|F|i> =   0.09702292
i = 8  <i|F|i> =   0.04647434
i = 9  <i|F|i> =   0.18586676
i = 10  <i|F|i> =   0.29494710
i = 11  <i|F|i> =   0.59815531
i = 12  <i|F|i> =   0.69066828
i = 13  <i|F|i> =   0.64064937
i = 14  <i|F|i> =   0.71463686
i = 15  <i|F|i> =   0.71946735
i = 16  <i|F|i> =   0.71939993
i = 17  <i|F|i> =   0.76620299
i = 18  <i|F|i> =   1.01711312
i = 19  <i|F|i> =   1.16446642
i = 20  <i|F|i> =   1.21579320
i = 21  <i|F|i> =   1.33783109
i = 22  <i|F|i> =   1.33807735
i = 23  <i|F|i> =   1.45319723
i = 24  <i|F|i> =   1.45222052
i = 25  <i|F|i> =   1.48685387
i = 26  <i|F|i> =   1.68918311
i = 27  <i|F|i> =   1.75079880
i = 28  <i|F|i> =   2.13629650
......production of RDMs took      23.02 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.33 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickSCNEVPT2-ijrs) =    -0.00028835922520
E(WickSCNEVPT2- rsi) =    -0.00080489637756
E(WickSCNEVPT2- ijr) =    -0.00026922583876
E(WickSCNEVPT2-  rs) =    -0.03357749208754
E(WickSCNEVPT2-  ij) =    -0.00006686135373
E(WickSCNEVPT2-  ir) =    -0.00101722939556
E(WickSCNEVPT2-   r) =    -0.05814829674852
E(WickSCNEVPT2-   i) =    -0.00006586939756
E(WickSCNEVPT2) = -75.57829804431499  E_corr_pt = -0.09423823042443388
Timings = pdms =   53.54 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.55 | i =    0.25
Time cost =    156.667
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:13:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.905037959312 AA    0.000000000000   0.000000000000   3.600000000000 Bohr   0.0

nuclear repulsion = 10
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.8]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9737.11


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmplrnpywc8
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7418315703506

WARN: Singularity detected in overlap matrix (condition number = 92.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.110019881100111  LUMO (B3u) = -0.110019881100111

WARN: B2u HOMO -0.110019881100111 > system LUMO -0.110019881100111

cycle= 1 E= -75.2796395081188  delta_E= -0.538  |g|= 0.24  |ddm|= 1.48
HOMO (B2u) = -0.366960154497002  LUMO (B3u) = -0.057244263765565
cycle= 2 E= -75.3027407260661  delta_E= -0.0231  |g|= 0.0483  |ddm|= 0.349
HOMO (B2u) = -0.332387624443795  LUMO (B3u) = -0.0179860460523906
cycle= 3 E= -75.3040943705399  delta_E= -0.00135  |g|= 0.0177  |ddm|= 0.0637
HOMO (B2u) = -0.33681565062269  LUMO (B3u) = -0.0222589901147924
cycle= 4 E= -75.3043133588737  delta_E= -0.000219  |g|= 0.000659  |ddm|= 0.0358
HOMO (B2u) = -0.33698652190454  LUMO (B3u) = -0.0225780980112818
cycle= 5 E= -75.3043135231658  delta_E= -1.64e-07  |g|= 0.000118  |ddm|= 0.000867
HOMO (B2u) = -0.336949107818828  LUMO (B3u) = -0.0225461573189919
cycle= 6 E= -75.3043135311109  delta_E= -7.95e-09  |g|= 1.79e-05  |ddm|= 0.000202
HOMO (B2u) = -0.336946583100418  LUMO (B3u) = -0.0225465689188833
cycle= 7 E= -75.3043135313142  delta_E= -2.03e-10  |g|= 1.93e-06  |ddm|= 3.75e-05
HOMO (B2u) = -0.336946052255824  LUMO (B3u) = -0.0225464651749353
cycle= 8 E= -75.3043135313166  delta_E= -2.42e-12  |g|= 1.28e-07  |ddm|= 3.99e-06
HOMO (B2u) = -0.336946056653829  LUMO (B3u) = -0.022546464522756
cycle= 9 E= -75.3043135313166  delta_E=    0  |g|= 8.63e-09  |ddm|= 2.92e-07
HOMO (B2u) = -0.336946056353298  LUMO (B3u) = -0.0225464661360493
cycle= 10 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 6.9e-09  |ddm|= 7.94e-09
HOMO (B2u) = -0.336946056206123  LUMO (B3u) = -0.0225464660303369
cycle= 11 E= -75.3043135313166  delta_E= 5.68e-14  |g|= 4.99e-09  |ddm|= 5.48e-09
HOMO (B2u) = -0.336946054829608  LUMO (B3u) = -0.0225464645958947
cycle= 12 E= -75.3043135313167  delta_E= -4.26e-14  |g|= 4.37e-09  |ddm|= 2.54e-09
HOMO (B2u) = -0.336946055133916  LUMO (B3u) = -0.0225464649076816
cycle= 13 E= -75.3043135313167  delta_E=    0  |g|= 3.93e-09  |ddm|= 1.64e-09
HOMO (B2u) = -0.336946055006361  LUMO (B3u) = -0.0225464647809157
cycle= 14 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 3.23e-09  |ddm|= 1.79e-09
HOMO (B2u) = -0.336946054816842  LUMO (B3u) = -0.0225464646819985
cycle= 15 E= -75.3043135313166  delta_E= 7.11e-14  |g|= 1.03e-09  |ddm|= 5.76e-09
HOMO (B2u) = -0.336946054715514  LUMO (B3u) = -0.0225464646717912
cycle= 16 E= -75.3043135313166  delta_E=    0  |g|= 9.61e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.336946054755395  LUMO (B3u) = -0.0225464646548104
cycle= 17 E= -75.3043135313166  delta_E=    0  |g|= 1.07e-09  |ddm|= 1.17e-09
HOMO (B2u) = -0.336946054719484  LUMO (B3u) = -0.0225464646290889
cycle= 18 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 8.24e-10  |ddm|= 6.21e-10
HOMO (B2u) = -0.336946054715365  LUMO (B3u) = -0.0225464646352996
cycle= 19 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 6.72e-10  |ddm|= 5.09e-10
HOMO (B2u) = -0.336946054715029  LUMO (B3u) = -0.0225464646433078
cycle= 20 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 5.53e-10  |ddm|= 3.53e-10
HOMO (B2u) = -0.336946054700162  LUMO (B3u) = -0.0225464646338292
cycle= 21 E= -75.3043135313167  delta_E=    0  |g|= 4.31e-10  |ddm|= 3.1e-10
HOMO (B2u) = -0.336946054689126  LUMO (B3u) = -0.0225464646289392
cycle= 22 E= -75.3043135313167  delta_E=    0  |g|= 3.14e-10  |ddm|= 2.86e-10
HOMO (B2u) = -0.336946054678452  LUMO (B3u) = -0.0225464646243896
cycle= 23 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 2.24e-10  |ddm|= 2.37e-10
HOMO (B2u) = -0.336946054671711  LUMO (B3u) = -0.0225464646210616
cycle= 24 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 1.93e-10  |ddm|= 8.15e-11
HOMO (B2u) = -0.33694605466921  LUMO (B3u) = -0.0225464646182718
cycle= 25 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 1.63e-10  |ddm|= 7.31e-11
HOMO (B2u) = -0.3369460546648  LUMO (B3u) = -0.0225464646157231
cycle= 26 E= -75.3043135313167  delta_E= -4.26e-14  |g|= 1.31e-10  |ddm|= 8.58e-11
HOMO (B2u) = -0.336946054661259  LUMO (B3u) = -0.0225464646136756
cycle= 27 E= -75.3043135313167  delta_E=    0  |g|= 1.08e-10  |ddm|= 6.59e-11
HOMO (B2u) = -0.336946054658347  LUMO (B3u) = -0.0225464646119558
cycle= 28 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 8.7e-11  |ddm|= 5.4e-11
HOMO (B2u) = -0.336946054656063  LUMO (B3u) = -0.0225464646106333
cycle= 29 E= -75.3043135313166  delta_E= 8.53e-14  |g|= 6.89e-11  |ddm|= 4.49e-11
HOMO (B2u) = -0.336946054654165  LUMO (B3u) = -0.0225464646095273
cycle= 30 E= -75.3043135313167  delta_E= -8.53e-14  |g|= 5.44e-11  |ddm|= 3.54e-11
HOMO (B2u) = -0.336946054652744  LUMO (B3u) = -0.022546464608709
cycle= 31 E= -75.3043135313167  delta_E=    0  |g|= 4.4e-11  |ddm|= 2.58e-11
HOMO (B2u) = -0.336946054649094  LUMO (B3u) = -0.0225464646064907
Extra cycle  E= -75.3043135313167  delta_E= -1.42e-14  |g|= 1.59e-11  |ddm|= 6.87e-11
converged SCF energy = -75.3043135313167

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmplrnpywc8
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4361879187434  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4510691607453  dE = -0.014881242  S^2 = 0.0000000
               |grad[o]|=0.0962  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4629145321985  dE = -0.011845371  S^2 = 0.0000000
               |grad[o]|=0.0783  |ddm|=0.0912  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4711866391327  dE = -0.0082721069  S^2 = 0.0000000
               |grad[o]|=0.0578  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4766787942648  dE = -0.0054921551  S^2 = 0.0000000
               |grad[o]|=0.0375  |ddm|=0.075  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4787632077886  dE = -0.0020844135  S^2 = 0.0000000
               |grad[o]|=0.0178  |ddm|=0.0723  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4793231918271  dE = -0.00055998404  S^2 = 0.0000000
               |grad[o]|=0.00799  |ddm|=0.0239  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4794386335794  dE = -0.00011544175  S^2 = 0.0000000
               |grad[o]|=0.00353  |ddm|=0.00914  |maxRot[o]|= 0.02
macro iter 8 (3 JK  0 micro), CASSCF E = -75.479460980122  dE = -2.2346543e-05  S^2 = 0.0000000
               |grad[o]|=0.00158  |ddm|=0.00384  |maxRot[o]|=0.0105
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4794629087142  dE = -1.9285922e-06  S^2 = 0.0000000
               |grad[o]|=0.000536  |ddm|=0.00194  |maxRot[o]|=0.00314
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4794630725591  dE = -1.6384493e-07  S^2 = 0.0000000
               |grad[o]|=0.000164  |ddm|=0.000582  |maxRot[o]|=0.000918
macro iter 11 (3 JK  0 micro), CASSCF E = -75.479463086382  dE = -1.3822898e-08  S^2 = 0.0000000
               |grad[o]|=4.88e-05  |ddm|=0.000171  |maxRot[o]|=0.000267
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4794630875462  dE = -1.1642385e-09  S^2 = 0.0000000
               |grad[o]|=1.44e-05  |ddm|=5.01e-05  |maxRot[o]|=7.74e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4794630876436  dE = -9.7372777e-11  S^2 = 0.0000000
               |grad[o]|=4.2e-06  |ddm|=1.46e-05  |maxRot[o]|=2.25e-05
2-step CASSCF converged in 13 macro (52 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95829684 1.93254559 1.88457143 1.75318656 0.06913527 0.2524963
 0.05723697 0.09253104]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01171   0.01031  -0.00343   0.00000   0.00000
  0 C 2s       0.67180   0.66526  -0.21945   0.00000  -0.00000
  0 C 3s      -0.00547   0.01587  -0.03746   0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69361
  0 C 2py      0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.21892  -0.23851   0.67009   0.00000  -0.00000
  0 C 3px      0.00000   0.00000   0.00000   0.00000  -0.06384
  0 C 3py      0.00000   0.00000   0.00000   0.05350  -0.00000
  0 C 3pz     -0.01342  -0.00181   0.01074   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000   0.03134   0.00000
  0 C 3dz^2    0.02038  -0.01199   0.03514   0.00000   0.00000
  0 C 3dxz     0.00000   0.00000   0.00000  -0.00000  -0.12178
 0 C 3dx2-y2   0.00055   0.00643  -0.00721  -0.00000  -0.00000
  1 C 1s       0.01171  -0.01031  -0.00343   0.00000   0.00000
  1 C 2s       0.67180  -0.66526  -0.21945  -0.00000  -0.00000
  1 C 3s      -0.00547  -0.01587  -0.03746  -0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69361
  1 C 2py     -0.00000  -0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.21892  -0.23851  -0.67009   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06384
  1 C 3py     -0.00000  -0.00000  -0.00000   0.05350  -0.00000
  1 C 3pz      0.01342  -0.00181  -0.01074   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.03134   0.00000
  1 C 3dz^2    0.02038   0.01199   0.03514  -0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12178
 1 C 3dx2-y2   0.00055  -0.00643  -0.00721   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00032
  0 C 2s       0.00000  -0.00000   0.23748
  0 C 3s      -0.00000  -0.00000   0.03235
  0 C 2px      0.00000   0.69804  -0.00000
  0 C 2py      0.70698  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.66400
  0 C 3px     -0.00000  -0.01120  -0.00000
  0 C 3py     -0.00856  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03555
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01047  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00616
  0 C 3dxz    -0.00000  -0.11230  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01875
  1 C 1s       0.00000   0.00000   0.00032
  1 C 2s       0.00000  -0.00000  -0.23748
  1 C 3s       0.00000   0.00000  -0.03235
  1 C 2px      0.00000  -0.69804   0.00000
  1 C 2py     -0.70698   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66400
  1 C 3px     -0.00000   0.01120   0.00000
  1 C 3py      0.00856   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03555
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01047  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00616
  1 C 3dxz     0.00000  -0.11230  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01875
<CAS-nat-orb|mo-hf>  3  3    0.99985292
<CAS-nat-orb|mo-hf>  4  4    0.99969360
<CAS-nat-orb|mo-hf>  5  5    0.99986456
<CAS-nat-orb|mo-hf>  6  6    0.99888267
<CAS-nat-orb|mo-hf>  7  7    0.93493366
<CAS-nat-orb|mo-hf>  8  8    0.98111604
<CAS-nat-orb|mo-hf>  9  9    0.96025422
<CAS-nat-orb|mo-hf>  10  10    0.93117477
CASSCF energy = -75.4794630876436
CASCI E = -75.4794630876436  E(CI) = -15.2075075305851  S^2 = 0.0000000
Density matrix diagonal elements [1.95829738 1.93254685 1.88457248 1.75318649 0.0691328  0.25249623
 0.05723685 0.09253092]
i = 1  <i|F|i> = -11.34500220
i = 2  <i|F|i> = -11.34533014
i = 3  <i|F|i> =  -0.83295723
i = 4  <i|F|i> =  -0.62825523
i = 5  <i|F|i> =  -0.35542819
i = 6  <i|F|i> =  -0.28753668
i = 7  <i|F|i> =   0.09983449
i = 8  <i|F|i> =   0.03990745
i = 9  <i|F|i> =   0.18347799
i = 10  <i|F|i> =   0.27889198
i = 11  <i|F|i> =   0.60231860
i = 12  <i|F|i> =   0.69006255
i = 13  <i|F|i> =   0.63843920
i = 14  <i|F|i> =   0.71588185
i = 15  <i|F|i> =   0.72067660
i = 16  <i|F|i> =   0.71914203
i = 17  <i|F|i> =   0.77281467
i = 18  <i|F|i> =   1.01356683
i = 19  <i|F|i> =   1.17015964
i = 20  <i|F|i> =   1.21963610
i = 21  <i|F|i> =   1.34210489
i = 22  <i|F|i> =   1.34237766
i = 23  <i|F|i> =   1.44966394
i = 24  <i|F|i> =   1.44878273
i = 25  <i|F|i> =   1.46390138
i = 26  <i|F|i> =   1.67527558
i = 27  <i|F|i> =   1.73592612
i = 28  <i|F|i> =   2.13270809
......production of RDMs took       1.79 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.39 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.62 sec

E(WickSCNEVPT2-ijrs) =    -0.00028983132507
E(WickSCNEVPT2- rsi) =    -0.00080703005038
E(WickSCNEVPT2- ijr) =    -0.00026732966285
E(WickSCNEVPT2-  rs) =    -0.03340800653339
E(WickSCNEVPT2-  ij) =    -0.00006475009964
E(WickSCNEVPT2-  ir) =    -0.00101130627209
E(WickSCNEVPT2-   r) =    -0.05850180360512
E(WickSCNEVPT2-   i) =    -0.00006281449233
E(WickSCNEVPT2) = -75.57387595968449  E_corr_pt = -0.0944128720408753
Timings = pdms =   31.24 | eris =    0.20 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.52 | i =    0.24
Time cost =    199.280
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:17:09 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.931496819858 AA    0.000000000000   0.000000000000   3.650000000000 Bohr   0.0

nuclear repulsion = 9.86301369863014
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.825]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9882.09


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp4t5mvp0j
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7286668554631

WARN: Singularity detected in overlap matrix (condition number = 86.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.107001630831573  LUMO (B3u) = -0.107001630831574

WARN: B2u HOMO -0.107001630831573 > system LUMO -0.107001630831574

cycle= 1 E= -75.2718520447977  delta_E= -0.543  |g|= 0.238  |ddm|= 1.48
HOMO (B2u) = -0.363117515186496  LUMO (B3u) = -0.0549592840356618
cycle= 2 E= -75.2946135925964  delta_E= -0.0228  |g|= 0.0477  |ddm|= 0.349
HOMO (B2u) = -0.329037998444987  LUMO (B3u) = -0.016221872430452
cycle= 3 E= -75.2959451182036  delta_E= -0.00133  |g|= 0.0175  |ddm|= 0.0628
HOMO (B2u) = -0.333444355785578  LUMO (B3u) = -0.0204649331299241
cycle= 4 E= -75.296162044047  delta_E= -0.000217  |g|= 0.000656  |ddm|= 0.0354
HOMO (B2u) = -0.333615190019284  LUMO (B3u) = -0.0207831790531201
cycle= 5 E= -75.2961622069416  delta_E= -1.63e-07  |g|= 0.000121  |ddm|= 0.000855
HOMO (B2u) = -0.33357796987633  LUMO (B3u) = -0.0207522115134138
cycle= 6 E= -75.2961622153582  delta_E= -8.42e-09  |g|= 1.83e-05  |ddm|= 0.000208
HOMO (B2u) = -0.333575376692501  LUMO (B3u) = -0.020752548741817
cycle= 7 E= -75.296162215571  delta_E= -2.13e-10  |g|= 1.93e-06  |ddm|= 3.81e-05
HOMO (B2u) = -0.333574868730938  LUMO (B3u) = -0.0207524737519073
cycle= 8 E= -75.2961622155733  delta_E= -2.3e-12  |g|= 1.29e-07  |ddm|= 4e-06
HOMO (B2u) = -0.333574872987106  LUMO (B3u) = -0.020752472826897
cycle= 9 E= -75.2961622155733  delta_E=    0  |g|= 8.8e-09  |ddm|= 3e-07
HOMO (B2u) = -0.333574872571017  LUMO (B3u) = -0.0207524743912856
cycle= 10 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 7.1e-09  |ddm|= 7.85e-09
HOMO (B2u) = -0.333574872451473  LUMO (B3u) = -0.0207524743261721
cycle= 11 E= -75.2961622155733  delta_E= 4.26e-14  |g|= 5.12e-09  |ddm|= 5.68e-09
HOMO (B2u) = -0.333574871097623  LUMO (B3u) = -0.020752472916391
cycle= 12 E= -75.2961622155733  delta_E=    0  |g|= 4.45e-09  |ddm|= 2.65e-09
HOMO (B2u) = -0.333574871371904  LUMO (B3u) = -0.0207524732023092
cycle= 13 E= -75.2961622155733  delta_E= -7.11e-14  |g|= 4e-09  |ddm|= 1.72e-09
HOMO (B2u) = -0.333574871232255  LUMO (B3u) = -0.020752473061009
cycle= 14 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 3.27e-09  |ddm|= 2e-09
HOMO (B2u) = -0.333574871044353  LUMO (B3u) = -0.0207524729849062
cycle= 15 E= -75.2961622155733  delta_E=    0  |g|= 1.05e-09  |ddm|= 6.09e-09
HOMO (B2u) = -0.333574870954696  LUMO (B3u) = -0.020752472970601
cycle= 16 E= -75.2961622155733  delta_E= -1.42e-14  |g|= 1e-09  |ddm|= 1.13e-09
HOMO (B2u) = -0.333574870984074  LUMO (B3u) = -0.0207524729552051
cycle= 17 E= -75.2961622155732  delta_E= 7.11e-14  |g|= 1.1e-09  |ddm|= 9.39e-10
HOMO (B2u) = -0.333574870946947  LUMO (B3u) = -0.0207524729304936
cycle= 18 E= -75.2961622155733  delta_E= -1.42e-14  |g|= 8.51e-10  |ddm|= 6.48e-10
HOMO (B2u) = -0.333574870941661  LUMO (B3u) = -0.0207524729366678
cycle= 19 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 6.88e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.333574870940535  LUMO (B3u) = -0.0207524729447836
cycle= 20 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 5.63e-10  |ddm|= 3.74e-10
HOMO (B2u) = -0.333574870924991  LUMO (B3u) = -0.0207524729356055
cycle= 21 E= -75.2961622155733  delta_E= -7.11e-14  |g|= 4.38e-10  |ddm|= 3.24e-10
HOMO (B2u) = -0.333574870913076  LUMO (B3u) = -0.0207524729306091
cycle= 22 E= -75.2961622155733  delta_E= 4.26e-14  |g|= 3.19e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.333574870901555  LUMO (B3u) = -0.0207524729260766
cycle= 23 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 2.28e-10  |ddm|= 2.46e-10
HOMO (B2u) = -0.333574870894649  LUMO (B3u) = -0.0207524729227139
cycle= 24 E= -75.2961622155733  delta_E= -1.42e-14  |g|= 1.97e-10  |ddm|= 8.27e-11
HOMO (B2u) = -0.333574870891371  LUMO (B3u) = -0.0207524729198813
cycle= 25 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 1.66e-10  |ddm|= 7.68e-11
HOMO (B2u) = -0.333574870886658  LUMO (B3u) = -0.0207524729173261
cycle= 26 E= -75.2961622155734  delta_E= -8.53e-14  |g|= 1.33e-10  |ddm|= 9.01e-11
HOMO (B2u) = -0.333574870882906  LUMO (B3u) = -0.0207524729152925
cycle= 27 E= -75.2961622155733  delta_E= 8.53e-14  |g|= 1.08e-10  |ddm|= 6.95e-11
HOMO (B2u) = -0.333574870879812  LUMO (B3u) = -0.0207524729135828
cycle= 28 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 8.71e-11  |ddm|= 5.6e-11
HOMO (B2u) = -0.333574870877365  LUMO (B3u) = -0.0207524729122637
cycle= 29 E= -75.2961622155733  delta_E= -7.11e-14  |g|= 6.87e-11  |ddm|= 4.62e-11
HOMO (B2u) = -0.333574870875339  LUMO (B3u) = -0.0207524729111649
cycle= 30 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 5.42e-11  |ddm|= 3.63e-11
HOMO (B2u) = -0.333574870873815  LUMO (B3u) = -0.0207524729103542
cycle= 31 E= -75.2961622155733  delta_E= -4.26e-14  |g|= 4.38e-11  |ddm|= 2.65e-11
HOMO (B2u) = -0.333574870872728  LUMO (B3u) = -0.0207524729097469
cycle= 32 E= -75.2961622155733  delta_E= 4.26e-14  |g|= 3.61e-11  |ddm|= 1.88e-11
HOMO (B2u) = -0.333574870871863  LUMO (B3u) = -0.0207524729092335
cycle= 33 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 2.96e-11  |ddm|= 1.63e-11
HOMO (B2u) = -0.333574870871088  LUMO (B3u) = -0.0207524729088061
cycle= 34 E= -75.2961622155733  delta_E= -7.11e-14  |g|= 2.42e-11  |ddm|= 1.39e-11
HOMO (B2u) = -0.333574870870464  LUMO (B3u) = -0.0207524729084579
cycle= 35 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 1.98e-11  |ddm|= 1.11e-11
HOMO (B2u) = -0.333574870869951  LUMO (B3u) = -0.0207524729081646
cycle= 36 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 1.61e-11  |ddm|= 9.04e-12
HOMO (B2u) = -0.333574870869538  LUMO (B3u) = -0.0207524729079245
cycle= 37 E= -75.2961622155733  delta_E= 4.26e-14  |g|= 1.3e-11  |ddm|= 7.26e-12
HOMO (B2u) = -0.33357487086921  LUMO (B3u) = -0.0207524729077341
cycle= 38 E= -75.2961622155733  delta_E=    0  |g|= 1.06e-11  |ddm|= 5.72e-12
HOMO (B2u) = -0.333574870868328  LUMO (B3u) = -0.0207524729072106
Extra cycle  E= -75.2961622155733  delta_E= -1.42e-14  |g|= 3.97e-12  |ddm|= 1.56e-11
converged SCF energy = -75.2961622155733

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp4t5mvp0j
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4322916655018  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.447641785121  dE = -0.01535012  S^2 = 0.0000000
               |grad[o]|=0.0982  |ddm|= 3.79  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4596313154456  dE = -0.01198953  S^2 = 0.0000000
               |grad[o]|=0.0787  |ddm|=0.0963  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4677080360273  dE = -0.0080767206  S^2 = 0.0000000
               |grad[o]|=0.0566  |ddm|=0.0425  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4729323362533  dE = -0.0052243002  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.0846  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4745134386445  dE = -0.0015811024  S^2 = 0.0000000
               |grad[o]|=0.0141  |ddm|=0.069  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4749250270436  dE = -0.0004115884  S^2 = 0.0000000
               |grad[o]|=0.00645  |ddm|=0.0178  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4749755961071  dE = -5.0569063e-05  S^2 = 0.0000000
               |grad[o]|=0.00239  |ddm|=0.00767  |maxRot[o]|=0.0157
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4749799280373  dE = -4.3319302e-06  S^2 = 0.0000000
               |grad[o]|=0.00081  |ddm|=0.00276  |maxRot[o]|=0.00471
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4749802891726  dE = -3.6113532e-07  S^2 = 0.0000000
               |grad[o]|=0.000249  |ddm|=0.00084  |maxRot[o]|=0.00136
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4749803191  dE = -2.9927421e-08  S^2 = 0.0000000
               |grad[o]|=7.39e-05  |ddm|=0.000248  |maxRot[o]|=0.000392
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4749803215773  dE = -2.4773072e-09  S^2 = 0.0000000
               |grad[o]|=2.16e-05  |ddm|=7.21e-05  |maxRot[o]|=0.000112
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4749803217822  dE = -2.0490631e-10  S^2 = 0.0000000
               |grad[o]|=6.26e-06  |ddm|=2.09e-05  |maxRot[o]|=3.23e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4749803217993  dE = -1.7081447e-11  S^2 = 0.0000000
               |grad[o]|=1.81e-06  |ddm|=6.02e-06  |maxRot[o]|=9.28e-06
2-step CASSCF converged in 13 macro (51 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95767231 1.93317369 1.87988783 1.73905658 0.0679361  0.26647505
 0.056932   0.09886644]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01187   0.01040  -0.00309   0.00000   0.00000
  0 C 2s       0.67780   0.66796  -0.20019  -0.00000  -0.00000
  0 C 3s      -0.00350   0.01562  -0.03551  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69358
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439  -0.00000
  0 C 2pz      0.19981  -0.23087   0.67619  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06476
  0 C 3py      0.00000  -0.00000  -0.00000   0.05406  -0.00000
  0 C 3pz     -0.01243  -0.00176   0.01236  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03012  -0.00000
  0 C 3dz^2    0.01877  -0.01161   0.03492  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.12148
 0 C 3dx2-y2   0.00081   0.00633  -0.00713   0.00000   0.00000
  1 C 1s       0.01187  -0.01040  -0.00309   0.00000   0.00000
  1 C 2s       0.67780  -0.66796  -0.20019   0.00000   0.00000
  1 C 3s      -0.00350  -0.01562  -0.03551   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69358
  1 C 2py     -0.00000   0.00000   0.00000   0.70439   0.00000
  1 C 2pz     -0.19981  -0.23087  -0.67619  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06476
  1 C 3py     -0.00000   0.00000   0.00000   0.05406   0.00000
  1 C 3pz      0.01243  -0.00176  -0.01236  -0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03012  -0.00000
  1 C 3dz^2    0.01877   0.01161   0.03492   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12148
 1 C 3dx2-y2   0.00081  -0.00633  -0.00713  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.22994
  0 C 3s      -0.00000  -0.00000   0.03135
  0 C 2px     -0.00000   0.69817  -0.00000
  0 C 2py      0.70700  -0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.66687
  0 C 3px      0.00000  -0.01303  -0.00000
  0 C 3py     -0.00659   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03288
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01006   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00544
  0 C 3dxz     0.00000  -0.11131  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01768
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.22994
  1 C 3s       0.00000   0.00000  -0.03135
  1 C 2px     -0.00000  -0.69817   0.00000
  1 C 2py     -0.70700  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66687
  1 C 3px     -0.00000   0.01303   0.00000
  1 C 3py      0.00659   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03288
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01006   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00544
  1 C 3dxz     0.00000  -0.11131  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01768
<CAS-nat-orb|mo-hf>  3  3    0.99977693
<CAS-nat-orb|mo-hf>  4  4    0.99968291
<CAS-nat-orb|mo-hf>  5  5    0.99978338
<CAS-nat-orb|mo-hf>  6  6    0.99882147
<CAS-nat-orb|mo-hf>  7  7    0.93437311
<CAS-nat-orb|mo-hf>  8  8    0.98222688
<CAS-nat-orb|mo-hf>  9  9    0.96040421
<CAS-nat-orb|mo-hf>  10  10    0.93730552
CASSCF energy = -75.4749803217993
CASCI E = -75.4749803217993  E(CI) = -15.1422389244405  S^2 = 0.0000000
Density matrix diagonal elements [1.95767256 1.93317406 1.87988841 1.73905662 0.06793501 0.26647501
 0.05693194 0.09886639]
i = 1  <i|F|i> = -11.34529225
i = 2  <i|F|i> = -11.34563541
i = 3  <i|F|i> =  -0.82665679
i = 4  <i|F|i> =  -0.63095031
i = 5  <i|F|i> =  -0.35153489
i = 6  <i|F|i> =  -0.28229911
i = 7  <i|F|i> =   0.10244569
i = 8  <i|F|i> =   0.03350668
i = 9  <i|F|i> =   0.18120984
i = 10  <i|F|i> =   0.26357601
i = 11  <i|F|i> =   0.60643199
i = 12  <i|F|i> =   0.68930702
i = 13  <i|F|i> =   0.63626563
i = 14  <i|F|i> =   0.71690790
i = 15  <i|F|i> =   0.72186338
i = 16  <i|F|i> =   0.71891330
i = 17  <i|F|i> =   0.77948552
i = 18  <i|F|i> =   1.01019748
i = 19  <i|F|i> =   1.17637125
i = 20  <i|F|i> =   1.22405926
i = 21  <i|F|i> =   1.34619497
i = 22  <i|F|i> =   1.34650705
i = 23  <i|F|i> =   1.44196580
i = 24  <i|F|i> =   1.44634572
i = 25  <i|F|i> =   1.44555295
i = 26  <i|F|i> =   1.66169112
i = 27  <i|F|i> =   1.72133872
i = 28  <i|F|i> =   2.12791305
......production of RDMs took       1.80 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.81 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.65 sec

E(WickSCNEVPT2-ijrs) =    -0.00029141884760
E(WickSCNEVPT2- rsi) =    -0.00080957433001
E(WickSCNEVPT2- ijr) =    -0.00026555390909
E(WickSCNEVPT2-  rs) =    -0.03324782632587
E(WickSCNEVPT2-  ij) =    -0.00006277301054
E(WickSCNEVPT2-  ir) =    -0.00100590430132
E(WickSCNEVPT2-   r) =    -0.05883494597400
E(WickSCNEVPT2-   i) =    -0.00005991450697
E(WickSCNEVPT2) = -75.5695582330047  E_corr_pt = -0.0945779112053951
Timings = pdms =   31.70 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.52 | i =    0.24
Time cost =    222.978
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:20:52 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.957955680404 AA    0.000000000000   0.000000000000   3.700000000000 Bohr   0.0

nuclear repulsion = 9.72972972972973
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.85]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10059.43


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpoai5qv10
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7163760223708

WARN: Singularity detected in overlap matrix (condition number = 80.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.104120790735629  LUMO (B3u) = -0.104120790735628

WARN: B2u HOMO -0.104120790735629 > system LUMO -0.104120790735628

cycle= 1 E= -75.2641203852923  delta_E= -0.548  |g|= 0.236  |ddm|= 1.47
HOMO (B2u) = -0.359408877513719  LUMO (B3u) = -0.0527582771899447
cycle= 2 E= -75.2865593123333  delta_E= -0.0224  |g|= 0.0471  |ddm|= 0.348
HOMO (B2u) = -0.325804970810902  LUMO (B3u) = -0.0145227547118901
cycle= 3 E= -75.2878678904737  delta_E= -0.00131  |g|= 0.0174  |ddm|= 0.0619
HOMO (B2u) = -0.330188258882719  LUMO (B3u) = -0.0187350374973025
cycle= 4 E= -75.2880824131579  delta_E= -0.000215  |g|= 0.000653  |ddm|= 0.035
HOMO (B2u) = -0.330355542534974  LUMO (B3u) = -0.019048577280891
cycle= 5 E= -75.288082574972  delta_E= -1.62e-07  |g|= 0.000124  |ddm|= 0.000847
HOMO (B2u) = -0.330318643630838  LUMO (B3u) = -0.0190186484174824
cycle= 6 E= -75.2880825838256  delta_E= -8.85e-09  |g|= 1.86e-05  |ddm|= 0.000214
HOMO (B2u) = -0.330315994378313  LUMO (B3u) = -0.0190189216398521
cycle= 7 E= -75.2880825840469  delta_E= -2.21e-10  |g|= 1.93e-06  |ddm|= 3.86e-05
HOMO (B2u) = -0.330315507539104  LUMO (B3u) = -0.0190188734083591
cycle= 8 E= -75.2880825840493  delta_E= -2.43e-12  |g|= 1.29e-07  |ddm|= 4.01e-06
HOMO (B2u) = -0.330315512036583  LUMO (B3u) = -0.0190188725353627
cycle= 9 E= -75.2880825840493  delta_E=    0  |g|= 8.84e-09  |ddm|= 3.07e-07
HOMO (B2u) = -0.33031551152043  LUMO (B3u) = -0.0190188740683419
cycle= 10 E= -75.2880825840493  delta_E= -1.42e-14  |g|= 7.22e-09  |ddm|= 7.71e-09
HOMO (B2u) = -0.330315511433772  LUMO (B3u) = -0.0190188740487035
cycle= 11 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 5.19e-09  |ddm|= 5.82e-09
HOMO (B2u) = -0.330315510117708  LUMO (B3u) = -0.0190188726788315
cycle= 12 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 4.49e-09  |ddm|= 2.77e-09
HOMO (B2u) = -0.330315510361304  LUMO (B3u) = -0.0190188729365566
cycle= 13 E= -75.2880825840494  delta_E=    0  |g|= 4.02e-09  |ddm|= 1.73e-09
HOMO (B2u) = -0.330315510214084  LUMO (B3u) = -0.0190188727854315
cycle= 14 E= -75.2880825840493  delta_E= 7.11e-14  |g|= 3.28e-09  |ddm|= 2.15e-09
HOMO (B2u) = -0.330315510028862  LUMO (B3u) = -0.0190188727301389
cycle= 15 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 1.06e-09  |ddm|= 6.34e-09
HOMO (B2u) = -0.3303155099406  LUMO (B3u) = -0.0190188727154128
cycle= 16 E= -75.2880825840493  delta_E=    0  |g|= 9.94e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.330315509969933  LUMO (B3u) = -0.0190188726985039
cycle= 17 E= -75.2880825840493  delta_E= -1.42e-14  |g|= 1.11e-09  |ddm|= 1e-09
HOMO (B2u) = -0.330315509932555  LUMO (B3u) = -0.0190188726752648
cycle= 18 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 8.6e-10  |ddm|= 6.58e-10
HOMO (B2u) = -0.330315509926694  LUMO (B3u) = -0.0190188726817586
cycle= 19 E= -75.2880825840494  delta_E= -7.11e-14  |g|= 6.9e-10  |ddm|= 5.59e-10
HOMO (B2u) = -0.330315509925293  LUMO (B3u) = -0.0190188726902648
cycle= 20 E= -75.2880825840493  delta_E= 1.14e-13  |g|= 5.62e-10  |ddm|= 3.88e-10
HOMO (B2u) = -0.330315509909653  LUMO (B3u) = -0.0190188726817738
cycle= 21 E= -75.2880825840493  delta_E= -1.42e-14  |g|= 4.37e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.330315509897358  LUMO (B3u) = -0.0190188726770235
cycle= 22 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 3.17e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.330315509885454  LUMO (B3u) = -0.0190188726728222
cycle= 23 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 2.27e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.330315509878494  LUMO (B3u) = -0.0190188726694856
cycle= 24 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 1.96e-10  |ddm|= 8.25e-11
HOMO (B2u) = -0.330315509875075  LUMO (B3u) = -0.0190188726666675
cycle= 25 E= -75.2880825840493  delta_E= -1.42e-14  |g|= 1.65e-10  |ddm|= 7.64e-11
HOMO (B2u) = -0.330315509870237  LUMO (B3u) = -0.0190188726641978
cycle= 26 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 1.32e-10  |ddm|= 9.2e-11
HOMO (B2u) = -0.330315509866412  LUMO (B3u) = -0.0190188726622477
cycle= 27 E= -75.2880825840492  delta_E= 9.95e-14  |g|= 1.07e-10  |ddm|= 7.12e-11
HOMO (B2u) = -0.330315509863252  LUMO (B3u) = -0.0190188726606014
cycle= 28 E= -75.2880825840493  delta_E= -9.95e-14  |g|= 8.58e-11  |ddm|= 5.68e-11
HOMO (B2u) = -0.330315509860739  LUMO (B3u) = -0.0190188726593267
cycle= 29 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 6.76e-11  |ddm|= 4.65e-11
HOMO (B2u) = -0.330315509858668  LUMO (B3u) = -0.0190188726582684
cycle= 30 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 5.32e-11  |ddm|= 3.64e-11
HOMO (B2u) = -0.33031550985711  LUMO (B3u) = -0.0190188726574898
cycle= 31 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 4.29e-11  |ddm|= 2.65e-11
HOMO (B2u) = -0.330315509855998  LUMO (B3u) = -0.0190188726568968
cycle= 32 E= -75.2880825840493  delta_E= -1.42e-14  |g|= 3.54e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.33031550985511  LUMO (B3u) = -0.0190188726563968
cycle= 33 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 2.89e-11  |ddm|= 1.63e-11
HOMO (B2u) = -0.330315509854315  LUMO (B3u) = -0.0190188726559819
cycle= 34 E= -75.2880825840494  delta_E= -9.95e-14  |g|= 2.36e-11  |ddm|= 1.39e-11
HOMO (B2u) = -0.330315509853674  LUMO (B3u) = -0.0190188726556441
cycle= 35 E= -75.2880825840494  delta_E=    0  |g|= 1.92e-11  |ddm|= 1.1e-11
HOMO (B2u) = -0.330315509851914  LUMO (B3u) = -0.0190188726546745
Extra cycle  E= -75.2880825840493  delta_E= 8.53e-14  |g|= 6.98e-12  |ddm|= 2.98e-11
converged SCF energy = -75.2880825840493

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpoai5qv10
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4284824270337  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4443133541925  dE = -0.015830927  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|= 3.78  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4564312005321  dE = -0.012117846  S^2 = 0.0000000
               |grad[o]|=0.079  |ddm|=0.101  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4642866715383  dE = -0.007855471  S^2 = 0.0000000
               |grad[o]|=0.0552  |ddm|=0.0402  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4683743861323  dE = -0.0040877146  S^2 = 0.0000000
               |grad[o]|=0.032  |ddm|=0.0939  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4701448490496  dE = -0.0017704629  S^2 = 0.0000000
               |grad[o]|=0.0156  |ddm|=0.0559  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4705677128546  dE = -0.00042286381  S^2 = 0.0000000
               |grad[o]|=0.00657  |ddm|=0.0184  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4706176210692  dE = -4.9908215e-05  S^2 = 0.0000000
               |grad[o]|=0.00242  |ddm|=0.00761  |maxRot[o]|=0.0156
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4706218171141  dE = -4.1960449e-06  S^2 = 0.0000000
               |grad[o]|=0.000823  |ddm|=0.00269  |maxRot[o]|=0.00463
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4706221621622  dE = -3.4504812e-07  S^2 = 0.0000000
               |grad[o]|=0.000251  |ddm|=0.000815  |maxRot[o]|=0.00133
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4706221904069  dE = -2.8244671e-08  S^2 = 0.0000000
               |grad[o]|=7.44e-05  |ddm|=0.00024  |maxRot[o]|=0.000379
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4706221927126  dE = -2.305768e-09  S^2 = 0.0000000
               |grad[o]|=2.17e-05  |ddm|=6.94e-05  |maxRot[o]|=0.000108
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4706221929015  dE = -1.8887647e-10  S^2 = 0.0000000
               |grad[o]|=6.23e-06  |ddm|=2.01e-05  |maxRot[o]|=3.08e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4706221929169  dE = -1.5418777e-11  S^2 = 0.0000000
               |grad[o]|=1.79e-06  |ddm|=5.75e-06  |maxRot[o]|=8.82e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95713289 1.93379643 1.87461992 1.72422801 0.06681526 0.28113864
 0.05662336 0.10564549]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01200   0.01047  -0.00276   0.00000   0.00000
  0 C 2s       0.68293   0.67051  -0.18198   0.00000  -0.00000
  0 C 3s      -0.00172   0.01539  -0.03356   0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69358
  0 C 2py     -0.00000   0.00000  -0.00000   0.70441   0.00000
  0 C 2pz      0.18173  -0.22338   0.68140   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06561
  0 C 3py     -0.00000   0.00000  -0.00000   0.05451   0.00000
  0 C 3pz     -0.01154  -0.00172   0.01401   0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02892  -0.00000
  0 C 3dz^2    0.01723  -0.01123   0.03460   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.12102
 0 C 3dx2-y2   0.00106   0.00623  -0.00705   0.00000   0.00000
  1 C 1s       0.01200  -0.01047  -0.00276   0.00000   0.00000
  1 C 2s       0.68293  -0.67051  -0.18198   0.00000  -0.00000
  1 C 3s      -0.00172  -0.01539  -0.03356  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69358
  1 C 2py      0.00000  -0.00000  -0.00000   0.70441   0.00000
  1 C 2pz     -0.18173  -0.22338  -0.68140   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06561
  1 C 3py      0.00000  -0.00000   0.00000   0.05451  -0.00000
  1 C 3pz      0.01154  -0.00172  -0.01401   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02892   0.00000
  1 C 3dz^2    0.01723   0.01123   0.03460  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12102
 1 C 3dx2-y2   0.00106  -0.00623  -0.00705   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00028
  0 C 2s       0.00000  -0.00000   0.22254
  0 C 3s       0.00000  -0.00000   0.03036
  0 C 2px     -0.00000   0.69830  -0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.66959
  0 C 3px     -0.00000  -0.01481   0.00000
  0 C 3py     -0.00465   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.03021
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00965   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00477
  0 C 3dxz    -0.00000  -0.11029  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01664
  1 C 1s       0.00000   0.00000   0.00028
  1 C 2s      -0.00000   0.00000  -0.22254
  1 C 3s      -0.00000   0.00000  -0.03036
  1 C 2px      0.00000  -0.69830  -0.00000
  1 C 2py     -0.70703  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66959
  1 C 3px      0.00000   0.01481   0.00000
  1 C 3py      0.00465   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.03021
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00965  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00477
  1 C 3dxz    -0.00000  -0.11029  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01664
<CAS-nat-orb|mo-hf>  3  3    0.99943449
<CAS-nat-orb|mo-hf>  4  4    0.99967130
<CAS-nat-orb|mo-hf>  5  5    0.99943415
<CAS-nat-orb|mo-hf>  6  6    0.99875809
<CAS-nat-orb|mo-hf>  7  7    0.93391056
<CAS-nat-orb|mo-hf>  8  8    0.98327030
<CAS-nat-orb|mo-hf>  9  9    0.96053902
<CAS-nat-orb|mo-hf>  10  10    0.94279395
CASSCF energy = -75.4706221929169
CASCI E = -75.4706221929169  E(CI) = -15.0787332351371  S^2 = 0.0000000
Density matrix diagonal elements [1.95713307 1.93379692 1.87462015 1.72422678 0.0668147  0.28113984
 0.05662316 0.10564538]
i = 1  <i|F|i> = -11.34546297
i = 2  <i|F|i> = -11.34581867
i = 3  <i|F|i> =  -0.82033739
i = 4  <i|F|i> =  -0.63354655
i = 5  <i|F|i> =  -0.34782438
i = 6  <i|F|i> =  -0.27709905
i = 7  <i|F|i> =   0.10486162
i = 8  <i|F|i> =   0.02726357
i = 9  <i|F|i> =   0.17905574
i = 10  <i|F|i> =   0.24894785
i = 11  <i|F|i> =   0.61049377
i = 12  <i|F|i> =   0.68842378
i = 13  <i|F|i> =   0.63415098
i = 14  <i|F|i> =   0.71778001
i = 15  <i|F|i> =   0.72302681
i = 16  <i|F|i> =   0.71870987
i = 17  <i|F|i> =   0.78610439
i = 18  <i|F|i> =   1.00700133
i = 19  <i|F|i> =   1.18304087
i = 20  <i|F|i> =   1.22900418
i = 21  <i|F|i> =   1.35008953
i = 22  <i|F|i> =   1.35046566
i = 23  <i|F|i> =   1.42112833
i = 24  <i|F|i> =   1.44323650
i = 25  <i|F|i> =   1.44252531
i = 26  <i|F|i> =   1.64844806
i = 27  <i|F|i> =   1.70705559
i = 28  <i|F|i> =   2.12188379
......production of RDMs took       1.86 sec
......reading the RDM took          0.45 sec
......production of RDMs took      19.59 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickSCNEVPT2-ijrs) =    -0.00029310630934
E(WickSCNEVPT2- rsi) =    -0.00081248445253
E(WickSCNEVPT2- ijr) =    -0.00026387712585
E(WickSCNEVPT2-  rs) =    -0.03309716783621
E(WickSCNEVPT2-  ij) =    -0.00006091952563
E(WickSCNEVPT2-  ir) =    -0.00100099338129
E(WickSCNEVPT2-   r) =    -0.05914652056883
E(WickSCNEVPT2-   i) =    -0.00005716143406
E(WickSCNEVPT2) = -75.56535442355066  E_corr_pt = -0.09473223063374196
Timings = pdms =   31.66 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.62 | i =    0.29
Time cost =    118.263
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:22:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.984414540950 AA    0.000000000000   0.000000000000   3.750000000000 Bohr   0.0

nuclear repulsion = 9.6
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.875]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10163.95


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp2eb41tdv
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7049084284725

WARN: Singularity detected in overlap matrix (condition number = 75.6). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.101370211913452  LUMO (B3u) = -0.101370211913452

WARN: B2u HOMO -0.101370211913452 > system LUMO -0.101370211913452

cycle= 1 E= -75.2564523906342  delta_E= -0.552  |g|= 0.234  |ddm|= 1.47
HOMO (B2u) = -0.355831308623933  LUMO (B3u) = -0.0506406338501564
cycle= 2 E= -75.2785865089975  delta_E= -0.0221  |g|= 0.0465  |ddm|= 0.348
HOMO (B2u) = -0.32268500614147  LUMO (B3u) = -0.0128872994795389
cycle= 3 E= -75.279871520809  delta_E= -0.00129  |g|= 0.0172  |ddm|= 0.061
HOMO (B2u) = -0.327043790963025  LUMO (B3u) = -0.0170677233110594
cycle= 4 E= -75.2800833606865  delta_E= -0.000212  |g|= 0.000651  |ddm|= 0.0346
HOMO (B2u) = -0.327204207243869  LUMO (B3u) = -0.0173729266447974
cycle= 5 E= -75.280083521623  delta_E= -1.61e-07  |g|= 0.000127  |ddm|= 0.00084
HOMO (B2u) = -0.327167734029072  LUMO (B3u) = -0.0173440705847769
cycle= 6 E= -75.2800835308716  delta_E= -9.25e-09  |g|= 1.89e-05  |ddm|= 0.000218
HOMO (B2u) = -0.327165039753311  LUMO (B3u) = -0.0173442874866645
cycle= 7 E= -75.2800835311011  delta_E= -2.3e-10  |g|= 1.94e-06  |ddm|= 3.91e-05
HOMO (B2u) = -0.327164572284037  LUMO (B3u) = -0.017344264225914
cycle= 8 E= -75.2800835311035  delta_E= -2.36e-12  |g|= 1.3e-07  |ddm|= 4.03e-06
HOMO (B2u) = -0.327164577390651  LUMO (B3u) = -0.0173442637009141
cycle= 9 E= -75.2800835311035  delta_E= -5.68e-14  |g|= 8.76e-09  |ddm|= 3.12e-07
HOMO (B2u) = -0.327164576780317  LUMO (B3u) = -0.0173442652040343
cycle= 10 E= -75.2800835311035  delta_E=    0  |g|= 7.28e-09  |ddm|= 7.49e-09
HOMO (B2u) = -0.327164576740845  LUMO (B3u) = -0.0173442652450502
cycle= 11 E= -75.2800835311035  delta_E=    0  |g|= 5.2e-09  |ddm|= 5.93e-09
HOMO (B2u) = -0.327164575481159  LUMO (B3u) = -0.0173442639353407
cycle= 12 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 4.47e-09  |ddm|= 2.87e-09
HOMO (B2u) = -0.327164575694784  LUMO (B3u) = -0.0173442641642444
cycle= 13 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 4e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.327164575241035  LUMO (B3u) = -0.01734426393144
cycle= 14 E= -75.2800835311036  delta_E=    0  |g|= 9.56e-10  |ddm|= 7.34e-09
HOMO (B2u) = -0.327164575348893  LUMO (B3u) = -0.0173442639680069
cycle= 15 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 9.67e-10  |ddm|= 1.36e-09
HOMO (B2u) = -0.327164575269123  LUMO (B3u) = -0.0173442639535585
cycle= 16 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 9.09e-10  |ddm|= 1.07e-09
HOMO (B2u) = -0.327164575295471  LUMO (B3u) = -0.0173442639368013
cycle= 17 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 1.03e-09  |ddm|= 9.57e-10
HOMO (B2u) = -0.327164575258303  LUMO (B3u) = -0.0173442639153255
cycle= 18 E= -75.2800835311035  delta_E= 8.53e-14  |g|= 7.75e-10  |ddm|= 6.6e-10
HOMO (B2u) = -0.327164575251785  LUMO (B3u) = -0.0173442639222036
cycle= 19 E= -75.2800835311035  delta_E=    0  |g|= 6.01e-10  |ddm|= 5.76e-10
HOMO (B2u) = -0.327164575250018  LUMO (B3u) = -0.0173442639311754
cycle= 20 E= -75.2800835311035  delta_E=    0  |g|= 4.73e-10  |ddm|= 4.02e-10
HOMO (B2u) = -0.327164575234337  LUMO (B3u) = -0.0173442639236072
cycle= 21 E= -75.2800835311035  delta_E=    0  |g|= 3.47e-10  |ddm|= 3.39e-10
HOMO (B2u) = -0.327164575221618  LUMO (B3u) = -0.0173442639192935
cycle= 22 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 2.28e-10  |ddm|= 3.1e-10
HOMO (B2u) = -0.327164575218655  LUMO (B3u) = -0.0173442639165216
cycle= 23 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 2.01e-10  |ddm|= 7.27e-11
HOMO (B2u) = -0.327164575212243  LUMO (B3u) = -0.0173442639134301
cycle= 24 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 1.72e-10  |ddm|= 7.57e-11
HOMO (B2u) = -0.327164575209022  LUMO (B3u) = -0.0173442639108331
cycle= 25 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 1.44e-10  |ddm|= 7.08e-11
HOMO (B2u) = -0.327164575204548  LUMO (B3u) = -0.0173442639086282
cycle= 26 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 1.13e-10  |ddm|= 8.64e-11
HOMO (B2u) = -0.327164575201132  LUMO (B3u) = -0.0173442639069283
cycle= 27 E= -75.2800835311035  delta_E=    0  |g|= 9.07e-11  |ddm|= 6.54e-11
HOMO (B2u) = -0.32716457519276  LUMO (B3u) = -0.0173442639025004
Extra cycle  E= -75.2800835311035  delta_E= -2.84e-14  |g|= 3.1e-11  |ddm|= 1.54e-10
converged SCF energy = -75.2800835311035

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp2eb41tdv
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4247711667704  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4410961607658  dE = -0.016324994  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4533243763495  dE = -0.012228216  S^2 = 0.0000000
               |grad[o]|=0.0793  |ddm|=0.107  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.460934868147  dE = -0.0076104918  S^2 = 0.0000000
               |grad[o]|=0.0537  |ddm|=0.0363  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4644374668677  dE = -0.0035025987  S^2 = 0.0000000
               |grad[o]|=0.029  |ddm|=0.102  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4660330713076  dE = -0.0015956044  S^2 = 0.0000000
               |grad[o]|=0.0144  |ddm|=0.0465  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4663655365153  dE = -0.00033246521  S^2 = 0.0000000
               |grad[o]|=0.00576  |ddm|=0.0163  |maxRot[o]|=0.0375
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4663950794203  dE = -2.9542905e-05  S^2 = 0.0000000
               |grad[o]|=0.00202  |ddm|=0.00671  |maxRot[o]|=0.0121
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4663975357624  dE = -2.4563421e-06  S^2 = 0.0000000
               |grad[o]|=0.000663  |ddm|=0.00206  |maxRot[o]|=0.00353
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4663977370562  dE = -2.0129373e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.000624  |maxRot[o]|=0.00101
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4663977534853  dE = -1.6429169e-08  S^2 = 0.0000000
               |grad[o]|=5.9e-05  |ddm|=0.000183  |maxRot[o]|=0.000287
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4663977548322  dE = -1.346848e-09  S^2 = 0.0000000
               |grad[o]|=1.71e-05  |ddm|=5.31e-05  |maxRot[o]|=8.13e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4663977549444  dE = -1.1216628e-10  S^2 = 0.0000000
               |grad[o]|=4.95e-06  |ddm|=1.52e-05  |maxRot[o]|=2.35e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4663977549535  dE = -9.1802121e-12  S^2 = 0.0000000
               |grad[o]|=1.43e-06  |ddm|=4.49e-06  |maxRot[o]|=6.65e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95667457 1.9344164  1.86874334 1.70868175 0.06576131 0.29650692
 0.0563102  0.1129055 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01211   0.01055  -0.00246   0.00000   0.00000
  0 C 2s       0.68726   0.67292  -0.16495  -0.00000  -0.00000
  0 C 3s      -0.00012   0.01517  -0.03163  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69361
  0 C 2py      0.00000  -0.00000  -0.00000   0.70443  -0.00000
  0 C 2pz      0.16481  -0.21605   0.68580   0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06639
  0 C 3py      0.00000  -0.00000  -0.00000   0.05485  -0.00000
  0 C 3pz     -0.01075  -0.00170   0.01569  -0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02772  -0.00000
  0 C 3dz^2    0.01579  -0.01087   0.03419  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.12041
 0 C 3dx2-y2   0.00128   0.00613  -0.00696   0.00000  -0.00000
  1 C 1s       0.01211  -0.01055  -0.00246   0.00000   0.00000
  1 C 2s       0.68726  -0.67292  -0.16495   0.00000   0.00000
  1 C 3s      -0.00012  -0.01517  -0.03163   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69361
  1 C 2py      0.00000  -0.00000  -0.00000   0.70443   0.00000
  1 C 2pz     -0.16481  -0.21605  -0.68580   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.06639
  1 C 3py     -0.00000   0.00000   0.00000   0.05485   0.00000
  1 C 3pz      0.01075  -0.00170  -0.01569  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02772  -0.00000
  1 C 3dz^2    0.01579   0.01087   0.03419   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.12041
 1 C 3dx2-y2   0.00128  -0.00613  -0.00696   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00026
  0 C 2s      -0.00000  -0.00000   0.21528
  0 C 3s      -0.00000  -0.00000   0.02936
  0 C 2px     -0.00000   0.69842   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67214
  0 C 3px      0.00000  -0.01654  -0.00000
  0 C 3py     -0.00273  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02753
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00925   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00414
  0 C 3dxz     0.00000  -0.10923   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01562
  1 C 1s       0.00000   0.00000   0.00026
  1 C 2s       0.00000   0.00000  -0.21528
  1 C 3s       0.00000   0.00000  -0.02936
  1 C 2px     -0.00000  -0.69842   0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.67214
  1 C 3px      0.00000   0.01654  -0.00000
  1 C 3py      0.00273  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02753
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00925   0.00000   0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00414
  1 C 3dxz    -0.00000  -0.10923   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01562
<CAS-nat-orb|mo-hf>  3  3    0.99890662
<CAS-nat-orb|mo-hf>  4  4    0.99965866
<CAS-nat-orb|mo-hf>  5  5    0.99889779
<CAS-nat-orb|mo-hf>  6  6    0.99869247
<CAS-nat-orb|mo-hf>  7  7    0.93353913
<CAS-nat-orb|mo-hf>  8  8    0.98425021
<CAS-nat-orb|mo-hf>  9  9    0.96066028
<CAS-nat-orb|mo-hf>  10  10    0.94772193
CASSCF energy = -75.4663977549535
CASCI E = -75.4663977549535  E(CI) = -15.0169341303923  S^2 = 0.0000000
Density matrix diagonal elements [1.9566748  1.93441654 1.86874407 1.70868165 0.06576029 0.29650709
 0.05631014 0.11290543]
i = 1  <i|F|i> = -11.34551650
i = 2  <i|F|i> = -11.34588233
i = 3  <i|F|i> =  -0.81407052
i = 4  <i|F|i> =  -0.63604414
i = 5  <i|F|i> =  -0.34421774
i = 6  <i|F|i> =  -0.27193268
i = 7  <i|F|i> =   0.10710097
i = 8  <i|F|i> =   0.02117077
i = 9  <i|F|i> =   0.17701195
i = 10  <i|F|i> =   0.23496001
i = 11  <i|F|i> =   0.61450207
i = 12  <i|F|i> =   0.68743422
i = 13  <i|F|i> =   0.63210884
i = 14  <i|F|i> =   0.71854329
i = 15  <i|F|i> =   0.72416590
i = 16  <i|F|i> =   0.71852844
i = 17  <i|F|i> =   0.79257466
i = 18  <i|F|i> =   1.00397415
i = 19  <i|F|i> =   1.19010236
i = 20  <i|F|i> =   1.23441140
i = 21  <i|F|i> =   1.35375648
i = 22  <i|F|i> =   1.35425444
i = 23  <i|F|i> =   1.40148973
i = 24  <i|F|i> =   1.44032993
i = 25  <i|F|i> =   1.43969367
i = 26  <i|F|i> =   1.63556044
i = 27  <i|F|i> =   1.69309436
i = 28  <i|F|i> =   2.11461662
......production of RDMs took       1.96 sec
......reading the RDM took          0.46 sec
......production of RDMs took      27.15 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.66 sec

E(WickSCNEVPT2-ijrs) =    -0.00029487669947
E(WickSCNEVPT2- rsi) =    -0.00081571366658
E(WickSCNEVPT2- ijr) =    -0.00026227930395
E(WickSCNEVPT2-  rs) =    -0.03295628040502
E(WickSCNEVPT2-  ij) =    -0.00005918088152
E(WickSCNEVPT2-  ir) =    -0.00099654086252
E(WickSCNEVPT2-   r) =    -0.05943491099804
E(WickSCNEVPT2-   i) =    -0.00005454473949
E(WickSCNEVPT2) = -75.56127208251013  E_corr_pt = -0.09487432755659704
Timings = pdms =   41.28 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.63 | i =    0.30
Time cost =     80.514
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:24:11 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.010873401496 AA    0.000000000000   0.000000000000   3.800000000000 Bohr   0.0

nuclear repulsion = 9.47368421052632
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10208.58


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp_aqu0wca
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6942155395781

WARN: Singularity detected in overlap matrix (condition number = 70.9). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0987431605477892  LUMO (B3u) = -0.0987431605477894

WARN: B2u HOMO -0.0987431605477892 > system LUMO -0.0987431605477894

cycle= 1 E= -75.2488547171612  delta_E= -0.555  |g|= 0.232  |ddm|= 1.46
HOMO (B2u) = -0.352381746665134  LUMO (B3u) = -0.0486055106897025
cycle= 2 E= -75.2707023112208  delta_E= -0.0218  |g|= 0.046  |ddm|= 0.348
HOMO (B2u) = -0.319674633980572  LUMO (B3u) = -0.0113141174561863
cycle= 3 E= -75.2719633258624  delta_E= -0.00126  |g|= 0.0171  |ddm|= 0.0602
HOMO (B2u) = -0.324007395733246  LUMO (B3u) = -0.0154613624878797
cycle= 4 E= -75.2721722602516  delta_E= -0.000209  |g|= 0.000648  |ddm|= 0.0343
HOMO (B2u) = -0.324157880743131  LUMO (B3u) = -0.0157548749526147
cycle= 5 E= -75.2721724204055  delta_E= -1.6e-07  |g|= 0.000129  |ddm|= 0.000835
HOMO (B2u) = -0.324121920212105  LUMO (B3u) = -0.0157271018699667
cycle= 6 E= -75.2721724300014  delta_E= -9.6e-09  |g|= 1.92e-05  |ddm|= 0.000222
HOMO (B2u) = -0.324119190447213  LUMO (B3u) = -0.0157272676284048
cycle= 7 E= -75.2721724302383  delta_E= -2.37e-10  |g|= 1.95e-06  |ddm|= 3.95e-05
HOMO (B2u) = -0.324118740620273  LUMO (B3u) = -0.0157272677303702
cycle= 8 E= -75.2721724302408  delta_E= -2.46e-12  |g|= 1.3e-07  |ddm|= 4.06e-06
HOMO (B2u) = -0.324118746685159  LUMO (B3u) = -0.0157272678197198
cycle= 9 E= -75.2721724302408  delta_E= -2.84e-14  |g|= 8.56e-09  |ddm|= 3.15e-07
HOMO (B2u) = -0.324118745997646  LUMO (B3u) = -0.0157272693141166
cycle= 10 E= -75.2721724302408  delta_E= 1.42e-14  |g|= 7.23e-09  |ddm|= 7.24e-09
HOMO (B2u) = -0.324118746006841  LUMO (B3u) = -0.0157272694130145
cycle= 11 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 5.15e-09  |ddm|= 5.93e-09
HOMO (B2u) = -0.324118744820868  LUMO (B3u) = -0.0157272681801869
cycle= 12 E= -75.2721724302408  delta_E= -7.11e-14  |g|= 4.4e-09  |ddm|= 2.94e-09
HOMO (B2u) = -0.324118745005779  LUMO (B3u) = -0.0157272683814003
cycle= 13 E= -75.2721724302407  delta_E= 9.95e-14  |g|= 3.94e-09  |ddm|= 1.68e-09
HOMO (B2u) = -0.324118744560558  LUMO (B3u) = -0.0157272681655091
cycle= 14 E= -75.2721724302408  delta_E= -7.11e-14  |g|= 9.13e-10  |ddm|= 7.36e-09
HOMO (B2u) = -0.32411874466796  LUMO (B3u) = -0.0157272682019515
cycle= 15 E= -75.2721724302408  delta_E= -4.26e-14  |g|= 9.35e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.324118744591146  LUMO (B3u) = -0.0157272681873979
cycle= 16 E= -75.2721724302408  delta_E= 4.26e-14  |g|= 8.7e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.324118744616428  LUMO (B3u) = -0.0157272681692031
cycle= 17 E= -75.2721724302407  delta_E= 1.14e-13  |g|= 9.98e-10  |ddm|= 9.93e-10
HOMO (B2u) = -0.324118744580832  LUMO (B3u) = -0.0157272681499888
cycle= 18 E= -75.2721724302407  delta_E= -5.68e-14  |g|= 7.54e-10  |ddm|= 6.37e-10
HOMO (B2u) = -0.324118744574931  LUMO (B3u) = -0.0157272681577752
cycle= 19 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 5.82e-10  |ddm|= 5.74e-10
HOMO (B2u) = -0.324118744573831  LUMO (B3u) = -0.0157272681675955
cycle= 20 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 4.57e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.324118744559233  LUMO (B3u) = -0.0157272681614776
cycle= 21 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 3.35e-10  |ddm|= 3.32e-10
HOMO (B2u) = -0.324118744547204  LUMO (B3u) = -0.0157272681580995
cycle= 22 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 2.18e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.32411874454443  LUMO (B3u) = -0.0157272681554556
cycle= 23 E= -75.2721724302407  delta_E= -1.42e-14  |g|= 1.93e-10  |ddm|= 6.88e-11
HOMO (B2u) = -0.324118744538229  LUMO (B3u) = -0.015727268152492
cycle= 24 E= -75.2721724302407  delta_E= -1.42e-14  |g|= 1.65e-10  |ddm|= 7.26e-11
HOMO (B2u) = -0.324118744535118  LUMO (B3u) = -0.0157272681500452
cycle= 25 E= -75.2721724302407  delta_E= -4.26e-14  |g|= 1.38e-10  |ddm|= 6.72e-11
HOMO (B2u) = -0.324118744530836  LUMO (B3u) = -0.0157272681480854
cycle= 26 E= -75.2721724302408  delta_E= -1.42e-14  |g|= 1.08e-10  |ddm|= 8.37e-11
HOMO (B2u) = -0.324118744527585  LUMO (B3u) = -0.0157272681465825
cycle= 27 E= -75.2721724302407  delta_E= 1.42e-14  |g|= 8.7e-11  |ddm|= 6.36e-11
HOMO (B2u) = -0.324118744524968  LUMO (B3u) = -0.0157272681452988
cycle= 28 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 6.91e-11  |ddm|= 4.83e-11
HOMO (B2u) = -0.324118744522976  LUMO (B3u) = -0.0157272681443213
cycle= 29 E= -75.2721724302408  delta_E= 4.26e-14  |g|= 5.42e-11  |ddm|= 3.79e-11
HOMO (B2u) = -0.324118744521457  LUMO (B3u) = -0.0157272681435349
cycle= 30 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 4.29e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.324118744520472  LUMO (B3u) = -0.0157272681429956
cycle= 31 E= -75.2721724302407  delta_E=    0  |g|= 3.57e-11  |ddm|= 1.77e-11
HOMO (B2u) = -0.324118744517202  LUMO (B3u) = -0.0157272681412946
Extra cycle  E= -75.2721724302407  delta_E= -2.84e-14  |g|= 1.26e-11  |ddm|= 5.76e-11
converged SCF energy = -75.2721724302407

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp_aqu0wca
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4211674784896  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4380007566063  dE = -0.016833278  S^2 = 0.0000000
               |grad[o]|=0.104  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4503194901033  dE = -0.012318733  S^2 = 0.0000000
               |grad[o]|=0.0795  |ddm|=0.112  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4576628758654  dE = -0.0073433858  S^2 = 0.0000000
               |grad[o]|=0.052  |ddm|=0.0313  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4606478981249  dE = -0.0029850223  S^2 = 0.0000000
               |grad[o]|=0.0258  |ddm|=0.108  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.462054710213  dE = -0.0014068121  S^2 = 0.0000000
               |grad[o]|=0.0131  |ddm|=0.0375  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4622921063011  dE = -0.00023739609  S^2 = 0.0000000
               |grad[o]|=0.00495  |ddm|=0.0145  |maxRot[o]|=0.0323
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4623127843088  dE = -2.0678008e-05  S^2 = 0.0000000
               |grad[o]|=0.00178  |ddm|=0.00552  |maxRot[o]|=0.0101
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4623145068646  dE = -1.7225558e-06  S^2 = 0.0000000
               |grad[o]|=0.000579  |ddm|=0.00172  |maxRot[o]|=0.00294
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4623146489297  dE = -1.4206509e-07  S^2 = 0.0000000
               |grad[o]|=0.000174  |ddm|=0.000526  |maxRot[o]|=0.000839
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4623146606368  dE = -1.1707101e-08  S^2 = 0.0000000
               |grad[o]|=5.14e-05  |ddm|=0.000155  |maxRot[o]|=0.000239
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4623146616044  dE = -9.6758868e-10  S^2 = 0.0000000
               |grad[o]|=1.5e-05  |ddm|=4.51e-05  |maxRot[o]|=6.85e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.462314661692  dE = -8.7652552e-11  S^2 = 0.0000000
               |grad[o]|=4.32e-06  |ddm|=1.31e-05  |maxRot[o]|=1.93e-05
2-step CASSCF converged in 12 macro (48 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9562916  1.9350335  1.86223013 1.69240306 0.06476757 0.31259499
 0.05599298 0.12068616]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01220   0.01062  -0.00217   0.00000   0.00000
  0 C 2s       0.69087   0.67520  -0.14918  -0.00000   0.00000
  0 C 3s       0.00130   0.01496  -0.02972  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69367
  0 C 2py      0.00000  -0.00000  -0.00000   0.70446   0.00000
  0 C 2pz      0.14914  -0.20886   0.68947  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06711
  0 C 3py      0.00000  -0.00000  -0.00000   0.05509  -0.00000
  0 C 3pz     -0.01004  -0.00168   0.01737  -0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02654   0.00000
  0 C 3dz^2    0.01444  -0.01051   0.03370  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.11966
 0 C 3dx2-y2   0.00150   0.00603  -0.00686  -0.00000  -0.00000
  1 C 1s       0.01220  -0.01062  -0.00217   0.00000   0.00000
  1 C 2s       0.69087  -0.67520  -0.14918   0.00000  -0.00000
  1 C 3s       0.00130  -0.01496  -0.02972   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69367
  1 C 2py     -0.00000   0.00000   0.00000   0.70446  -0.00000
  1 C 2pz     -0.14914  -0.20886  -0.68947   0.00000   0.00000
  1 C 3px     -0.00000  -0.00000   0.00000   0.00000  -0.06711
  1 C 3py     -0.00000   0.00000   0.00000   0.05509  -0.00000
  1 C 3pz      0.01004  -0.00168  -0.01737  -0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02654   0.00000
  1 C 3dz^2    0.01444   0.01051   0.03370   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11966
 1 C 3dx2-y2   0.00150  -0.00603  -0.00686  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s      -0.00000   0.00000   0.20816
  0 C 3s      -0.00000   0.00000   0.02837
  0 C 2px     -0.00000   0.69855   0.00000
  0 C 2py      0.70705  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67455
  0 C 3px     -0.00000  -0.01822   0.00000
  0 C 3py     -0.00084  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.02485
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00885  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00357
  0 C 3dxz    -0.00000  -0.10813  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01462
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000   0.00000  -0.20816
  1 C 3s       0.00000  -0.00000  -0.02837
  1 C 2px      0.00000  -0.69855  -0.00000
  1 C 2py     -0.70705   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.67455
  1 C 3px      0.00000   0.01822  -0.00000
  1 C 3py      0.00084   0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.02485
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00885  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00357
  1 C 3dxz    -0.00000  -0.10813   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01462
<CAS-nat-orb|mo-hf>  3  3    0.99826978
<CAS-nat-orb|mo-hf>  4  4    0.99964484
<CAS-nat-orb|mo-hf>  5  5    0.99825063
<CAS-nat-orb|mo-hf>  6  6    0.99862457
<CAS-nat-orb|mo-hf>  7  7    0.93325604
<CAS-nat-orb|mo-hf>  8  8    0.98517025
<CAS-nat-orb|mo-hf>  9  9    0.96077010
<CAS-nat-orb|mo-hf>  10  10    0.95215926
CASSCF energy = -75.462314661692
CASCI E = -75.462314661692  E(CI) = -14.9567871966282  S^2 = 0.0000000
Density matrix diagonal elements [1.95629204 1.93503426 1.8622311  1.69240341 0.06476555 0.31259506
 0.05599277 0.12068582]
i = 1  <i|F|i> = -11.34545482
i = 2  <i|F|i> = -11.34582863
i = 3  <i|F|i> =  -0.80792134
i = 4  <i|F|i> =  -0.63844329
i = 5  <i|F|i> =  -0.34064106
i = 6  <i|F|i> =  -0.26679581
i = 7  <i|F|i> =   0.10917251
i = 8  <i|F|i> =   0.01522116
i = 9  <i|F|i> =   0.17507227
i = 10  <i|F|i> =   0.22156804
i = 11  <i|F|i> =   0.61845488
i = 12  <i|F|i> =   0.68635897
i = 13  <i|F|i> =   0.63015304
i = 14  <i|F|i> =   0.71922927
i = 15  <i|F|i> =   0.72527967
i = 16  <i|F|i> =   0.71836544
i = 17  <i|F|i> =   0.79880834
i = 18  <i|F|i> =   1.00111208
i = 19  <i|F|i> =   1.19749746
i = 20  <i|F|i> =   1.24022130
i = 21  <i|F|i> =   1.35706229
i = 22  <i|F|i> =   1.35787538
i = 23  <i|F|i> =   1.38325198
i = 24  <i|F|i> =   1.43761966
i = 25  <i|F|i> =   1.43705190
i = 26  <i|F|i> =   1.62304408
i = 27  <i|F|i> =   1.67947128
i = 28  <i|F|i> =   2.10612955
......production of RDMs took       1.83 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.57 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickSCNEVPT2-ijrs) =    -0.00029671296152
E(WickSCNEVPT2- rsi) =    -0.00081921746746
E(WickSCNEVPT2- ijr) =    -0.00026074267803
E(WickSCNEVPT2-  rs) =    -0.03282536604816
E(WickSCNEVPT2-  ij) =    -0.00005754869151
E(WickSCNEVPT2-  ir) =    -0.00099251700612
E(WickSCNEVPT2-   r) =    -0.05969732908026
E(WickSCNEVPT2-   i) =    -0.00005205684864
E(WickSCNEVPT2) = -75.55731615247373  E_corr_pt = -0.09500149078169561
Timings = pdms =   32.57 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.03 | r =    0.61 | i =    0.27
Time cost =     70.152
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:25:21 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.037332262042 AA    0.000000000000   0.000000000000   3.850000000000 Bohr   0.0

nuclear repulsion = 9.35064935064935
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10257.38


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpiy3ybe9i
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6842509501291

WARN: Singularity detected in overlap matrix (condition number = 66.5). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0962332913313835  LUMO (B3u) = -0.0962332913313834

WARN: B2u HOMO -0.0962332913313835 > system LUMO -0.0962332913313834

cycle= 1 E= -75.2413330204141  delta_E= -0.557  |g|= 0.231  |ddm|= 1.46
HOMO (B2u) = -0.349057007799765  LUMO (B3u) = -0.046651841498527
cycle= 2 E= -75.2629125920112  delta_E= -0.0216  |g|= 0.0454  |ddm|= 0.348
HOMO (B2u) = -0.316770424633127  LUMO (B3u) = -0.00980180087757543
cycle= 3 E= -75.2641493459228  delta_E= -0.00124  |g|= 0.0169  |ddm|= 0.0593
HOMO (B2u) = -0.321075514288454  LUMO (B3u) = -0.013914269460281
cycle= 4 E= -75.2643552043106  delta_E= -0.000206  |g|= 0.000645  |ddm|= 0.0339
HOMO (B2u) = -0.321213308623814  LUMO (B3u) = -0.0141930697532566
cycle= 5 E= -75.2643553636796  delta_E= -1.59e-07  |g|= 0.000131  |ddm|= 0.00083
HOMO (B2u) = -0.321177935176441  LUMO (B3u) = -0.0141663723644044
cycle= 6 E= -75.2643553735705  delta_E= -9.89e-09  |g|= 1.94e-05  |ddm|= 0.000225
HOMO (B2u) = -0.32117517787336  LUMO (B3u) = -0.0141664898415932
cycle= 7 E= -75.2643553738138  delta_E= -2.43e-10  |g|= 1.96e-06  |ddm|= 3.98e-05
HOMO (B2u) = -0.321174743989144  LUMO (B3u) = -0.0141665118435157
cycle= 8 E= -75.2643553738162  delta_E= -2.4e-12  |g|= 1.29e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.321174751334321  LUMO (B3u) = -0.0141665127831322
cycle= 9 E= -75.2643553738163  delta_E= -7.11e-14  |g|= 8.24e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.321174750586668  LUMO (B3u) = -0.0141665142926702
cycle= 10 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 7.09e-09  |ddm|= 7e-09
HOMO (B2u) = -0.321174750649635  LUMO (B3u) = -0.0141665144490522
cycle= 11 E= -75.2643553738162  delta_E= 2.84e-14  |g|= 5.04e-09  |ddm|= 5.8e-09
HOMO (B2u) = -0.321174749547466  LUMO (B3u) = -0.014166513301637
cycle= 12 E= -75.2643553738163  delta_E= -8.53e-14  |g|= 4.3e-09  |ddm|= 2.95e-09
HOMO (B2u) = -0.32117474970569  LUMO (B3u) = -0.0141665134762692
cycle= 13 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 3.84e-09  |ddm|= 1.62e-09
HOMO (B2u) = -0.32117474927601  LUMO (B3u) = -0.0141665132806579
cycle= 14 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 8.46e-10  |ddm|= 7.27e-09
HOMO (B2u) = -0.32117474938436  LUMO (B3u) = -0.0141665133175369
cycle= 15 E= -75.2643553738164  delta_E= -4.26e-14  |g|= 8.86e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.321174749309232  LUMO (B3u) = -0.0141665133032473
cycle= 16 E= -75.2643553738163  delta_E= 5.68e-14  |g|= 8.1e-10  |ddm|= 1.02e-09
HOMO (B2u) = -0.321174749333775  LUMO (B3u) = -0.0141665132831054
cycle= 17 E= -75.2643553738162  delta_E= 8.53e-14  |g|= 9.48e-10  |ddm|= 1.05e-09
HOMO (B2u) = -0.321174749300575  LUMO (B3u) = -0.0141665132663903
cycle= 18 E= -75.2643553738163  delta_E= -5.68e-14  |g|= 7.17e-10  |ddm|= 5.96e-10
HOMO (B2u) = -0.321174749296099  LUMO (B3u) = -0.0141665132754289
cycle= 19 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 5.51e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.321174749296212  LUMO (B3u) = -0.0141665132863444
cycle= 20 E= -75.2643553738162  delta_E= 7.11e-14  |g|= 4.33e-10  |ddm|= 3.85e-10
HOMO (B2u) = -0.321174749283245  LUMO (B3u) = -0.0141665132819944
cycle= 21 E= -75.2643553738163  delta_E= -5.68e-14  |g|= 3.15e-10  |ddm|= 3.17e-10
HOMO (B2u) = -0.3211747492724  LUMO (B3u) = -0.0141665132798459
cycle= 22 E= -75.2643553738162  delta_E= 2.84e-14  |g|= 2.04e-10  |ddm|= 2.88e-10
HOMO (B2u) = -0.321174749269934  LUMO (B3u) = -0.0141665132773767
cycle= 23 E= -75.2643553738164  delta_E= -1.14e-13  |g|= 1.8e-10  |ddm|= 6.27e-11
HOMO (B2u) = -0.321174749264031  LUMO (B3u) = -0.0141665132745883
cycle= 24 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 1.54e-10  |ddm|= 6.81e-11
HOMO (B2u) = -0.321174749261188  LUMO (B3u) = -0.0141665132723448
cycle= 25 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 1.29e-10  |ddm|= 6.16e-11
HOMO (B2u) = -0.321174749257253  LUMO (B3u) = -0.0141665132707072
cycle= 26 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 1.01e-10  |ddm|= 7.86e-11
HOMO (B2u) = -0.321174749254283  LUMO (B3u) = -0.0141665132694591
cycle= 27 E= -75.2643553738163  delta_E= -4.26e-14  |g|= 8.15e-11  |ddm|= 5.99e-11
HOMO (B2u) = -0.32117474925187  LUMO (B3u) = -0.0141665132683594
cycle= 28 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 6.48e-11  |ddm|= 4.52e-11
HOMO (B2u) = -0.32117474925002  LUMO (B3u) = -0.0141665132675103
cycle= 29 E= -75.2643553738163  delta_E=    0  |g|= 5.07e-11  |ddm|= 3.53e-11
HOMO (B2u) = -0.321174749245467  LUMO (B3u) = -0.0141665132652727
Extra cycle  E= -75.2643553738163  delta_E= -4.26e-14  |g|= 1.78e-11  |ddm|= 8.18e-11
converged SCF energy = -75.2643553738163

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpiy3ybe9i
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4176796778921  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4350360693862  dE = -0.017356391  S^2 = 0.0000000
               |grad[o]|=0.106  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4474226988753  dE = -0.012386629  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.117  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4544788060403  dE = -0.0070561072  S^2 = 0.0000000
               |grad[o]|=0.0502  |ddm|=0.0257  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4570100432067  dE = -0.0025312372  S^2 = 0.0000000
               |grad[o]|=0.0225  |ddm|= 0.11  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4582120425089  dE = -0.0012019993  S^2 = 0.0000000
               |grad[o]|=0.0117  |ddm|=0.0293  |maxRot[o]|=0.0599
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4583431399368  dE = -0.00013109743  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.013  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4583762943611  dE = -3.3154424e-05  S^2 = 0.0000000
               |grad[o]|=0.00212  |ddm|=0.00331  |maxRot[o]|=0.0127
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4583790907347  dE = -2.7963736e-06  S^2 = 0.0000000
               |grad[o]|=0.000733  |ddm|=0.00214  |maxRot[o]|=0.00372
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4583793249555  dE = -2.3422086e-07  S^2 = 0.0000000
               |grad[o]|=0.000228  |ddm|=0.000666  |maxRot[o]|=0.00107
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4583793444849  dE = -1.9529338e-08  S^2 = 0.0000000
               |grad[o]|=6.8e-05  |ddm|=0.0002  |maxRot[o]|=0.000307
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4583793461193  dE = -1.6344472e-09  S^2 = 0.0000000
               |grad[o]|=2e-05  |ddm|=5.91e-05  |maxRot[o]|=8.82e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4583793462598  dE = -1.4051693e-10  S^2 = 0.0000000
               |grad[o]|=5.87e-06  |ddm|=1.72e-05  |maxRot[o]|=2.55e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4583793462635  dE = -3.623768e-12  S^2 = 0.0000000
               |grad[o]|=1.7e-06  |ddm|=4.77e-06  |maxRot[o]|=7.43e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95597942 1.93565101 1.85505357 1.67538719 0.06382152 0.32940982
 0.05567107 0.12902641]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01228   0.01069  -0.00190   0.00000   0.00000
  0 C 2s       0.69385   0.67734  -0.13470  -0.00000  -0.00000
  0 C 3s       0.00257   0.01477  -0.02786  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69376
  0 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  0 C 2pz      0.13475  -0.20184   0.69251   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06778
  0 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  0 C 3pz     -0.00941  -0.00168   0.01906  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02538  -0.00000
  0 C 3dz^2    0.01317  -0.01016   0.03314  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.11878
 0 C 3dx2-y2   0.00169   0.00594  -0.00676   0.00000  -0.00000
  1 C 1s       0.01228  -0.01069  -0.00190   0.00000   0.00000
  1 C 2s       0.69385  -0.67734  -0.13470   0.00000  -0.00000
  1 C 3s       0.00257  -0.01477  -0.02786  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69376
  1 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  1 C 2pz     -0.13475  -0.20184  -0.69251  -0.00000  -0.00000
  1 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06778
  1 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  1 C 3pz      0.00941  -0.00168  -0.01906   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.02538   0.00000
  1 C 3dz^2    0.01317   0.01016   0.03314  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11878
 1 C 3dx2-y2   0.00169  -0.00594  -0.00676  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.20120
  0 C 3s      -0.00000  -0.00000   0.02738
  0 C 2px     -0.00000   0.69868  -0.00000
  0 C 2py      0.70706  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.67682
  0 C 3px     -0.00000  -0.01985  -0.00000
  0 C 3py      0.00101  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02216
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00847   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00304
  0 C 3dxz    -0.00000  -0.10700  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01365
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s       0.00000   0.00000  -0.20120
  1 C 3s       0.00000   0.00000  -0.02738
  1 C 2px      0.00000  -0.69868   0.00000
  1 C 2py     -0.70706   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67682
  1 C 3px      0.00000   0.01985   0.00000
  1 C 3py     -0.00101   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02216
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00847  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00304
  1 C 3dxz    -0.00000  -0.10700  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01365
<CAS-nat-orb|mo-hf>  3  3    0.99758995
<CAS-nat-orb|mo-hf>  4  4    0.99962978
<CAS-nat-orb|mo-hf>  5  5    0.99755853
<CAS-nat-orb|mo-hf>  6  6    0.99855438
<CAS-nat-orb|mo-hf>  7  7    0.93305005
<CAS-nat-orb|mo-hf>  8  8    0.98603349
<CAS-nat-orb|mo-hf>  9  9    0.96086979
<CAS-nat-orb|mo-hf>  10  10    0.95616481
CASSCF energy = -75.4583793462635
CASCI E = -75.4583793462635  E(CI) = -14.8982403377172  S^2 = 0.0000000
Density matrix diagonal elements [1.95597961 1.93565121 1.8550537  1.67538705 0.06382106 0.32940997
 0.05567109 0.1290263 ]
i = 1  <i|F|i> = -11.34528046
i = 2  <i|F|i> = -11.34566036
i = 3  <i|F|i> =  -0.80194431
i = 4  <i|F|i> =  -0.64074484
i = 5  <i|F|i> =  -0.33703231
i = 6  <i|F|i> =  -0.26168607
i = 7  <i|F|i> =   0.11110101
i = 8  <i|F|i> =   0.00940969
i = 9  <i|F|i> =   0.17323408
i = 10  <i|F|i> =   0.20873165
i = 11  <i|F|i> =   0.62234970
i = 12  <i|F|i> =   0.68521751
i = 13  <i|F|i> =   0.62828852
i = 14  <i|F|i> =   0.71985997
i = 15  <i|F|i> =   0.72636668
i = 16  <i|F|i> =   0.71821846
i = 17  <i|F|i> =   0.80472150
i = 18  <i|F|i> =   0.99841064
i = 19  <i|F|i> =   1.20516013
i = 20  <i|F|i> =   1.24637463
i = 21  <i|F|i> =   1.35859832
i = 22  <i|F|i> =   1.36133099
i = 23  <i|F|i> =   1.36789144
i = 24  <i|F|i> =   1.43509904
i = 25  <i|F|i> =   1.43459349
i = 26  <i|F|i> =   1.61090865
i = 27  <i|F|i> =   1.66620113
i = 28  <i|F|i> =   2.09645904
......production of RDMs took       2.00 sec
......reading the RDM took          0.45 sec
......production of RDMs took      28.55 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.70 sec

E(WickSCNEVPT2-ijrs) =    -0.00029859720898
E(WickSCNEVPT2- rsi) =    -0.00082295028086
E(WickSCNEVPT2- ijr) =    -0.00025925177624
E(WickSCNEVPT2-  rs) =    -0.03270534160845
E(WickSCNEVPT2-  ij) =    -0.00005601627953
E(WickSCNEVPT2-  ir) =    -0.00098888947666
E(WickSCNEVPT2-   r) =    -0.05992151246306
E(WickSCNEVPT2-   i) =    -0.00004968935962
E(WickSCNEVPT2) = -75.55348159471684  E_corr_pt = -0.09510224845338162
Timings = pdms =   40.80 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.57 | i =    0.27
Time cost =     78.707
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:26:40 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.063791122588 AA    0.000000000000   0.000000000000   3.900000000000 Bohr   0.0

nuclear repulsion = 9.23076923076923
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10297.22


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpa2shx16e
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6749703835052

WARN: Singularity detected in overlap matrix (condition number = 62.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0938346227346639  LUMO (B3u) = -0.0938346227346635

WARN: B2u HOMO -0.0938346227346639 > system LUMO -0.0938346227346635

cycle= 1 E= -75.2338921256662  delta_E= -0.559  |g|= 0.229  |ddm|= 1.46
HOMO (B2u) = -0.345853796512398  LUMO (B3u) = -0.0447783510681946
cycle= 2 E= -75.2552221736388  delta_E= -0.0213  |g|= 0.0449  |ddm|= 0.347
HOMO (B2u) = -0.313968969330059  LUMO (B3u) = -0.00834890411120198
cycle= 3 E= -75.2564345511741  delta_E= -0.00121  |g|= 0.0167  |ddm|= 0.0585
HOMO (B2u) = -0.318244577067681  LUMO (B3u) = -0.0124246975036471
cycle= 4 E= -75.256637209921  delta_E= -0.000203  |g|= 0.000641  |ddm|= 0.0335
HOMO (B2u) = -0.318367270990408  LUMO (B3u) = -0.0126861477138976
cycle= 5 E= -75.2566373684187  delta_E= -1.58e-07  |g|= 0.000132  |ddm|= 0.000824
HOMO (B2u) = -0.318332550664857  LUMO (B3u) = -0.0126605067829967
cycle= 6 E= -75.2566373785487  delta_E= -1.01e-08  |g|= 1.96e-05  |ddm|= 0.000227
HOMO (B2u) = -0.318329772186369  LUMO (B3u) = -0.0126605767315262
cycle= 7 E= -75.2566373787974  delta_E= -2.49e-10  |g|= 1.98e-06  |ddm|= 4.01e-05
HOMO (B2u) = -0.31832935256657  LUMO (B3u) = -0.0126606192769711
cycle= 8 E= -75.2566373788  delta_E= -2.53e-12  |g|= 1.29e-07  |ddm|= 4.15e-06
HOMO (B2u) = -0.318329361478732  LUMO (B3u) = -0.0126606212717347
cycle= 9 E= -75.2566373788  delta_E= -2.84e-14  |g|= 7.84e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.318329360676008  LUMO (B3u) = -0.0126606228037239
cycle= 10 E= -75.2566373788  delta_E=    0  |g|= 6.9e-09  |ddm|= 6.79e-09
HOMO (B2u) = -0.318329360805361  LUMO (B3u) = -0.0126606230282965
cycle= 11 E= -75.2566373788  delta_E= -2.84e-14  |g|= 4.89e-09  |ddm|= 5.6e-09
HOMO (B2u) = -0.318329359796729  LUMO (B3u) = -0.0126606219767127
cycle= 12 E= -75.2566373788  delta_E=    0  |g|= 4.15e-09  |ddm|= 2.93e-09
HOMO (B2u) = -0.318329359932279  LUMO (B3u) = -0.0126606221275724
cycle= 13 E= -75.2566373788  delta_E= 5.68e-14  |g|= 3.71e-09  |ddm|= 1.53e-09
HOMO (B2u) = -0.318329359525032  LUMO (B3u) = -0.012660621955252
cycle= 14 E= -75.2566373788  delta_E=    0  |g|= 7.6e-10  |ddm|= 7.09e-09
HOMO (B2u) = -0.318329359627918  LUMO (B3u) = -0.0126606219882142
cycle= 15 E= -75.2566373788  delta_E= -5.68e-14  |g|= 8.15e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.318329359559835  LUMO (B3u) = -0.0126606219793896
cycle= 16 E= -75.2566373788001  delta_E= -5.68e-14  |g|= 7.33e-10  |ddm|= 8.25e-10
HOMO (B2u) = -0.318329359584522  LUMO (B3u) = -0.0126606219560456
cycle= 17 E= -75.2566373788  delta_E= 2.84e-14  |g|= 8.83e-10  |ddm|= 1.15e-09
HOMO (B2u) = -0.318329359554377  LUMO (B3u) = -0.0126606219419886
cycle= 18 E= -75.2566373788  delta_E=    0  |g|= 6.69e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.318329359551817  LUMO (B3u) = -0.0126606219524527
cycle= 19 E= -75.2566373788  delta_E= 8.53e-14  |g|= 5.12e-10  |ddm|= 5.27e-10
HOMO (B2u) = -0.318329359553562  LUMO (B3u) = -0.0126606219646456
cycle= 20 E= -75.2566373788  delta_E=    0  |g|= 4.02e-10  |ddm|= 3.63e-10
HOMO (B2u) = -0.318329359542691  LUMO (B3u) = -0.0126606219622895
cycle= 21 E= -75.2566373788  delta_E= -5.68e-14  |g|= 2.91e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.318329359533471  LUMO (B3u) = -0.0126606219616096
cycle= 22 E= -75.2566373788  delta_E= -2.84e-14  |g|= 1.86e-10  |ddm|= 2.67e-10
HOMO (B2u) = -0.318329359531398  LUMO (B3u) = -0.0126606219593394
cycle= 23 E= -75.2566373788  delta_E= 5.68e-14  |g|= 1.65e-10  |ddm|= 5.47e-11
HOMO (B2u) = -0.318329359526165  LUMO (B3u) = -0.0126606219568999
cycle= 24 E= -75.2566373788  delta_E= 2.84e-14  |g|= 1.4e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.318329359523761  LUMO (B3u) = -0.0126606219548835
cycle= 25 E= -75.2566373788  delta_E= -2.84e-14  |g|= 1.18e-10  |ddm|= 5.42e-11
HOMO (B2u) = -0.318329359520318  LUMO (B3u) = -0.0126606219536401
cycle= 26 E= -75.2566373788  delta_E= -5.68e-14  |g|= 9.24e-11  |ddm|= 7.11e-11
HOMO (B2u) = -0.31832935951774  LUMO (B3u) = -0.0126606219527008
cycle= 27 E= -75.2566373788  delta_E= 5.68e-14  |g|= 7.47e-11  |ddm|= 5.46e-11
HOMO (B2u) = -0.318329359515617  LUMO (B3u) = -0.0126606219518241
cycle= 28 E= -75.2566373787999  delta_E= 5.68e-14  |g|= 5.95e-11  |ddm|= 4.08e-11
HOMO (B2u) = -0.318329359513981  LUMO (B3u) = -0.0126606219511327
cycle= 29 E= -75.2566373787999  delta_E=    0  |g|= 4.65e-11  |ddm|= 3.18e-11
HOMO (B2u) = -0.318329359509987  LUMO (B3u) = -0.0126606219492725
Extra cycle  E= -75.2566373788  delta_E= -5.68e-14  |g|= 1.65e-11  |ddm|= 7.32e-11
converged SCF energy = -75.2566373788

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpa2shx16e
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4143148843349  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4322089312392  dE = -0.017894047  S^2 = 0.0000000
               |grad[o]|=0.108  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4446390101767  dE = -0.012430079  S^2 = 0.0000000
               |grad[o]|=0.0797  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4513833169117  dE = -0.0067443067  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.0218  |maxRot[o]|=0.0798
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4535226182018  dE = -0.0021393013  S^2 = 0.0000000
               |grad[o]|=0.0191  |ddm|=0.109  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4543051838365  dE = -0.00078256563  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0227  |maxRot[o]|= 0.04
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4545713709192  dE = -0.00026618708  S^2 = 0.0000000
               |grad[o]|=0.00524  |ddm|=0.00808  |maxRot[o]|=0.0333
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4545949240893  dE = -2.355317e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00574  |maxRot[o]|=0.0107
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4545969675311  dE = -2.0434419e-06  S^2 = 0.0000000
               |grad[o]|=0.000657  |ddm|=0.00185  |maxRot[o]|=0.00315
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4545971430736  dE = -1.7554248e-07  S^2 = 0.0000000
               |grad[o]|=0.000203  |ddm|=0.000583  |maxRot[o]|=0.000913
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4545971581105  dE = -1.5036861e-08  S^2 = 0.0000000
               |grad[o]|=6.12e-05  |ddm|=0.000176  |maxRot[o]|=0.000265
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4545971593833  dE = -1.2728663e-09  S^2 = 0.0000000
               |grad[o]|=1.82e-05  |ddm|=5.27e-05  |maxRot[o]|=7.71e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4545971594909  dE = -1.0757617e-10  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=1.57e-05  |maxRot[o]|=2.24e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4545971594996  dE = -8.6686214e-12  S^2 = 0.0000000
               |grad[o]|=1.57e-06  |ddm|=4.58e-06  |maxRot[o]|=6.58e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95573076 1.93626698 1.84718162 1.65763445 0.06292257 0.34695114
 0.05534507 0.13796741]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01234   0.01075  -0.00166   0.00000   0.00000
  0 C 2s       0.69629   0.67936  -0.12152  -0.00000  -0.00000
  0 C 3s       0.00370   0.01459  -0.02605   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69387
  0 C 2py     -0.00000   0.00000   0.00000   0.70453  -0.00000
  0 C 2pz      0.12164  -0.19495   0.69500  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06838
  0 C 3py     -0.00000   0.00000  -0.00000   0.05527   0.00000
  0 C 3pz     -0.00884  -0.00169   0.02073   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02424   0.00000
  0 C 3dz^2    0.01200  -0.00982   0.03250   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.11777
 0 C 3dx2-y2   0.00188   0.00585  -0.00666  -0.00000  -0.00000
  1 C 1s       0.01234  -0.01075  -0.00166   0.00000   0.00000
  1 C 2s       0.69629  -0.67936  -0.12152  -0.00000   0.00000
  1 C 3s       0.00370  -0.01459  -0.02605  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69387
  1 C 2py      0.00000  -0.00000   0.00000   0.70453  -0.00000
  1 C 2pz     -0.12164  -0.19495  -0.69500  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06838
  1 C 3py      0.00000  -0.00000  -0.00000   0.05527   0.00000
  1 C 3pz      0.00884  -0.00169  -0.02073   0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.02424  -0.00000
  1 C 3dz^2    0.01200   0.00982   0.03250  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.11777
 1 C 3dx2-y2   0.00188  -0.00585  -0.00666   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00021
  0 C 2s      -0.00000  -0.00000   0.19437
  0 C 3s       0.00000  -0.00000   0.02640
  0 C 2px     -0.00000   0.69881  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.67895
  0 C 3px      0.00000  -0.02144   0.00000
  0 C 3py      0.00283  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01949
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00809  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00255
  0 C 3dxz     0.00000  -0.10583   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01271
  1 C 1s       0.00000   0.00000   0.00021
  1 C 2s      -0.00000   0.00000  -0.19437
  1 C 3s       0.00000   0.00000  -0.02640
  1 C 2px     -0.00000  -0.69881  -0.00000
  1 C 2py     -0.70705   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67895
  1 C 3px      0.00000   0.02144   0.00000
  1 C 3py     -0.00283  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01949
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00809  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00255
  1 C 3dxz    -0.00000  -0.10583  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.01271
<CAS-nat-orb|mo-hf>  3  3    0.99692136
<CAS-nat-orb|mo-hf>  4  4    0.99961325
<CAS-nat-orb|mo-hf>  5  5    0.99687558
<CAS-nat-orb|mo-hf>  6  6    0.99848189
<CAS-nat-orb|mo-hf>  7  7    0.93292275
<CAS-nat-orb|mo-hf>  8  8    0.98684296
<CAS-nat-orb|mo-hf>  9  9    0.96096128
<CAS-nat-orb|mo-hf>  10  10    0.95978892
CASSCF energy = -75.4545971594996
CASCI E = -75.4545971594996  E(CI) = -14.8412429814284  S^2 = 0.0000000
Density matrix diagonal elements [1.95573092 1.93626737 1.84718142 1.65763442 0.06292248 0.34695117
 0.05534504 0.13796719]
i = 1  <i|F|i> = -11.34499658
i = 2  <i|F|i> = -11.34538087
i = 3  <i|F|i> =  -0.79618173
i = 4  <i|F|i> =  -0.64294962
i = 5  <i|F|i> =  -0.33334099
i = 6  <i|F|i> =  -0.25660193
i = 7  <i|F|i> =   0.11288496
i = 8  <i|F|i> =   0.00373200
i = 9  <i|F|i> =   0.17148989
i = 10  <i|F|i> =   0.19641221
i = 11  <i|F|i> =   0.62618351
i = 12  <i|F|i> =   0.68402806
i = 13  <i|F|i> =   0.62652807
i = 14  <i|F|i> =   0.72045084
i = 15  <i|F|i> =   0.72742572
i = 16  <i|F|i> =   0.71808328
i = 17  <i|F|i> =   0.81023243
i = 18  <i|F|i> =   0.99586607
i = 19  <i|F|i> =   1.21304155
i = 20  <i|F|i> =   1.25281309
i = 21  <i|F|i> =   1.34827189
i = 22  <i|F|i> =   1.36462446
i = 23  <i|F|i> =   1.36556723
i = 24  <i|F|i> =   1.43276136
i = 25  <i|F|i> =   1.43231199
i = 26  <i|F|i> =   1.59916908
i = 27  <i|F|i> =   1.65329712
i = 28  <i|F|i> =   2.08565739
......production of RDMs took       1.82 sec
......reading the RDM took          0.45 sec
......production of RDMs took      32.35 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickSCNEVPT2-ijrs) =    -0.00030051284537
E(WickSCNEVPT2- rsi) =    -0.00082687135309
E(WickSCNEVPT2- ijr) =    -0.00025779389245
E(WickSCNEVPT2-  rs) =    -0.03259178851214
E(WickSCNEVPT2-  ij) =    -0.00005457658825
E(WickSCNEVPT2-  ir) =    -0.00098563849736
E(WickSCNEVPT2-   r) =    -0.06017522644705
E(WickSCNEVPT2-   i) =    -0.00004743608277
E(WickSCNEVPT2) = -75.54983700371804  E_corr_pt = -0.09523984421847119
Timings = pdms =   44.36 | eris =    0.16 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.01 | ij =    0.02 | ir =    0.02 | r =    0.61 | i =    0.28
Time cost =     82.692
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:28:02 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.090249983134 AA    0.000000000000   0.000000000000   3.950000000000 Bohr   0.0

nuclear repulsion = 9.11392405063291
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10342.03


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpile3la09
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6663316753772

WARN: Singularity detected in overlap matrix (condition number = 58.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0915415140147806  LUMO (B3u) = -0.0915415140147809

WARN: B2u HOMO -0.0915415140147806 > system LUMO -0.0915415140147809

cycle= 1 E= -75.2265361682301  delta_E= -0.56  |g|= 0.228  |ddm|= 1.46
HOMO (B2u) = -0.342768719019989  LUMO (B3u) = -0.0429835717594455
cycle= 2 E= -75.2476350005992  delta_E= -0.0211  |g|= 0.0444  |ddm|= 0.347
HOMO (B2u) = -0.311266865337973  LUMO (B3u) = -0.00695392831510969
cycle= 3 E= -75.2488230162567  delta_E= -0.00119  |g|= 0.0166  |ddm|= 0.0577
HOMO (B2u) = -0.315511002797546  LUMO (B3u) = -0.0109908406189046
cycle= 4 E= -75.24902239302  delta_E= -0.000199  |g|= 0.000637  |ddm|= 0.0332
HOMO (B2u) = -0.315616573066831  LUMO (B3u) = -0.0112327274277425
cycle= 5 E= -75.2490225504907  delta_E= -1.57e-07  |g|= 0.000134  |ddm|= 0.000817
HOMO (B2u) = -0.315582567140404  LUMO (B3u) = -0.0112081163367566
cycle= 6 E= -75.2490225608019  delta_E= -1.03e-08  |g|= 1.98e-05  |ddm|= 0.000228
HOMO (B2u) = -0.315579772310331  LUMO (B3u) = -0.011208137615714
cycle= 7 E= -75.249022561055  delta_E= -2.53e-10  |g|= 2e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.315579365287556  LUMO (B3u) = -0.011208199412946
cycle= 8 E= -75.2490225610577  delta_E= -2.67e-12  |g|= 1.29e-07  |ddm|= 4.21e-06
HOMO (B2u) = -0.315579376014501  LUMO (B3u) = -0.0112082026370385
cycle= 9 E= -75.2490225610575  delta_E= 1.42e-13  |g|= 7.39e-09  |ddm|= 3.13e-07
HOMO (B2u) = -0.315579375157072  LUMO (B3u) = -0.0112082041955355
cycle= 10 E= -75.2490225610576  delta_E= -8.53e-14  |g|= 6.69e-09  |ddm|= 6.71e-09
HOMO (B2u) = -0.3155793753734  LUMO (B3u) = -0.0112082045126428
cycle= 11 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 4.7e-09  |ddm|= 5.42e-09
HOMO (B2u) = -0.31557937445607  LUMO (B3u) = -0.0112082035522822
cycle= 12 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 3.98e-09  |ddm|= 2.87e-09
HOMO (B2u) = -0.315579374574232  LUMO (B3u) = -0.0112082036830085
cycle= 13 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 3.56e-09  |ddm|= 1.41e-09
HOMO (B2u) = -0.315579374205011  LUMO (B3u) = -0.0112082035344345
cycle= 14 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 7.09e-10  |ddm|= 6.53e-09
HOMO (B2u) = -0.315579374303713  LUMO (B3u) = -0.011208203570166
cycle= 15 E= -75.2490225610576  delta_E=    0  |g|= 7.47e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.315579374231862  LUMO (B3u) = -0.0112082035635517
cycle= 16 E= -75.2490225610576  delta_E=    0  |g|= 6.5e-10  |ddm|= 8.6e-10
HOMO (B2u) = -0.315579374257347  LUMO (B3u) = -0.011208203534994
cycle= 17 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 8.07e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.315579374230817  LUMO (B3u) = -0.0112082035236324
cycle= 18 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 6.14e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.315579374230578  LUMO (B3u) = -0.0112082035356697
cycle= 19 E= -75.2490225610576  delta_E=    0  |g|= 4.68e-10  |ddm|= 4.88e-10
HOMO (B2u) = -0.315579374234536  LUMO (B3u) = -0.011208203549385
cycle= 20 E= -75.2490225610576  delta_E=    0  |g|= 3.68e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.315579374226204  LUMO (B3u) = -0.0112082035491759
cycle= 21 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 2.65e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.315579374219019  LUMO (B3u) = -0.0112082035501439
cycle= 22 E= -75.2490225610576  delta_E=    0  |g|= 1.67e-10  |ddm|= 2.4e-10
HOMO (B2u) = -0.315579374217208  LUMO (B3u) = -0.0112082035482608
cycle= 23 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 1.48e-10  |ddm|= 4.96e-11
HOMO (B2u) = -0.315579374212327  LUMO (B3u) = -0.0112082035460589
cycle= 24 E= -75.2490225610577  delta_E= -2.84e-14  |g|= 1.25e-10  |ddm|= 5.57e-11
HOMO (B2u) = -0.315579374210473  LUMO (B3u) = -0.0112082035442397
cycle= 25 E= -75.2490225610575  delta_E= 1.42e-13  |g|= 1.06e-10  |ddm|= 4.69e-11
HOMO (B2u) = -0.315579374207617  LUMO (B3u) = -0.0112082035434433
cycle= 26 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 8.31e-11  |ddm|= 6.16e-11
HOMO (B2u) = -0.315579374205497  LUMO (B3u) = -0.0112082035428511
cycle= 27 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 6.76e-11  |ddm|= 4.76e-11
HOMO (B2u) = -0.315579374203707  LUMO (B3u) = -0.0112082035422217
cycle= 28 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 5.42e-11  |ddm|= 3.53e-11
HOMO (B2u) = -0.315579374202309  LUMO (B3u) = -0.0112082035417054
cycle= 29 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 4.24e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.315579374201242  LUMO (B3u) = -0.0112082035412566
cycle= 30 E= -75.2490225610576  delta_E=    0  |g|= 3.35e-11  |ddm|= 2.02e-11
HOMO (B2u) = -0.315579374198531  LUMO (B3u) = -0.0112082035400726
Extra cycle  E= -75.2490225610576  delta_E= -5.68e-14  |g|= 1.22e-11  |ddm|= 4.94e-11
converged SCF energy = -75.2490225610576

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpile3la09
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4110790881552  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4295260725507  dE = -0.018446984  S^2 = 0.0000000
               |grad[o]|= 0.11  |ddm|= 3.74  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4419549870826  dE = -0.012428915  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.127  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4482968221548  dE = -0.0063418351  S^2 = 0.0000000
               |grad[o]|=0.0462  |ddm|=0.0237  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4501430171581  dE = -0.001846195  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.104  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4507876396841  dE = -0.00064462253  S^2 = 0.0000000
               |grad[o]|=0.00867  |ddm|=0.0182  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4509297658616  dE = -0.00014212618  S^2 = 0.0000000
               |grad[o]|=0.00428  |ddm|=0.00737  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4509686911439  dE = -3.8925282e-05  S^2 = 0.0000000
               |grad[o]|=0.00227  |ddm|=0.00337  |maxRot[o]|=0.0135
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4509721356547  dE = -3.4445109e-06  S^2 = 0.0000000
               |grad[o]|=0.000835  |ddm|=0.00232  |maxRot[o]|=0.00406
macro iter 9 (3 JK  0 micro), CASSCF E = -75.450972441234  dE = -3.0557925e-07  S^2 = 0.0000000
               |grad[o]|=0.000269  |ddm|=0.000751  |maxRot[o]|=0.0012
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4509724682703  dE = -2.7036336e-08  S^2 = 0.0000000
               |grad[o]|=8.26e-05  |ddm|=0.000234  |maxRot[o]|=0.000351
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4509724706799  dE = -2.4096067e-09  S^2 = 0.0000000
               |grad[o]|=2.5e-05  |ddm|=7.12e-05  |maxRot[o]|=0.000104
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4509724708869  dE = -2.0700952e-10  S^2 = 0.0000000
               |grad[o]|=7.49e-06  |ddm|=2.18e-05  |maxRot[o]|=3.08e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4509724709117  dE = -2.4783731e-11  S^2 = 0.0000000
               |grad[o]|=2.29e-06  |ddm|=6.43e-06  |maxRot[o]|=8.97e-06
2-step CASSCF converged in 13 macro (48 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95553917 1.93688266 1.83858342 1.63915689 0.06206762 0.36520863
 0.05501491 0.1475467 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01239   0.01081  -0.00143   0.00000   0.00000
  0 C 2s       0.69827   0.68127  -0.10961  -0.00000   0.00000
  0 C 3s       0.00470   0.01443  -0.02431  -0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000   0.00000   0.69401
  0 C 2py     -0.00000  -0.00000  -0.00000   0.70457   0.00000
  0 C 2pz      0.10978  -0.18822   0.69702  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  0 C 3py     -0.00000   0.00000   0.00000   0.05523   0.00000
  0 C 3pz     -0.00833  -0.00170   0.02237  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02312   0.00000
  0 C 3dz^2    0.01091  -0.00949   0.03179  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000  -0.00000  -0.11663
 0 C 3dx2-y2   0.00204   0.00576  -0.00656   0.00000  -0.00000
  1 C 1s       0.01239  -0.01081  -0.00143   0.00000   0.00000
  1 C 2s       0.69827  -0.68127  -0.10961   0.00000  -0.00000
  1 C 3s       0.00470  -0.01443  -0.02431   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69401
  1 C 2py      0.00000  -0.00000   0.00000   0.70457  -0.00000
  1 C 2pz     -0.10978  -0.18822  -0.69702   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  1 C 3py      0.00000   0.00000   0.00000   0.05523   0.00000
  1 C 3pz      0.00833  -0.00170  -0.02237  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000  -0.02312  -0.00000
  1 C 3dz^2    0.01091   0.00949   0.03179   0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000   0.00000   0.11663
 1 C 3dx2-y2   0.00204  -0.00576  -0.00656   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s      -0.00000   0.00000   0.18769
  0 C 3s       0.00000  -0.00000   0.02542
  0 C 2px      0.00000   0.69895  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.68096
  0 C 3px      0.00000  -0.02298  -0.00000
  0 C 3py      0.00461   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01682
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00772   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00210
  0 C 3dxz     0.00000  -0.10461  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01180
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.18769
  1 C 3s       0.00000   0.00000  -0.02542
  1 C 2px     -0.00000  -0.69895   0.00000
  1 C 2py     -0.70705  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.68096
  1 C 3px     -0.00000   0.02298   0.00000
  1 C 3py     -0.00461  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01682
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00772  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00210
  1 C 3dxz     0.00000  -0.10461  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01180
<CAS-nat-orb|mo-hf>  3  3    0.99630523
<CAS-nat-orb|mo-hf>  4  4    0.99959512
<CAS-nat-orb|mo-hf>  5  5    0.99624282
<CAS-nat-orb|mo-hf>  6  6    0.99840712
<CAS-nat-orb|mo-hf>  7  7    0.93287017
<CAS-nat-orb|mo-hf>  8  8    0.98760133
<CAS-nat-orb|mo-hf>  9  9    0.96104580
<CAS-nat-orb|mo-hf>  10  10    0.96307389
CASSCF energy = -75.4509724709117
CASCI E = -75.4509724709117  E(CI) = -14.7857465824137  S^2 = 0.0000000
Density matrix diagonal elements [1.95553952 1.93688274 1.83858443 1.63915708 0.06206605 0.36520843
 0.05501503 0.14754671]
i = 1  <i|F|i> = -11.34460680
i = 2  <i|F|i> = -11.34499390
i = 3  <i|F|i> =  -0.79066351
i = 4  <i|F|i> =  -0.64505885
i = 5  <i|F|i> =  -0.32952975
i = 6  <i|F|i> =  -0.25154313
i = 7  <i|F|i> =   0.11453374
i = 8  <i|F|i> =  -0.00181478
i = 9  <i|F|i> =   0.16983457
i = 10  <i|F|i> =   0.18457548
i = 11  <i|F|i> =   0.62995274
i = 12  <i|F|i> =   0.68280746
i = 13  <i|F|i> =   0.62487934
i = 14  <i|F|i> =   0.72101284
i = 15  <i|F|i> =   0.72845533
i = 16  <i|F|i> =   0.71795621
i = 17  <i|F|i> =   0.81526059
i = 18  <i|F|i> =   0.99347404
i = 19  <i|F|i> =   1.22108691
i = 20  <i|F|i> =   1.25947996
i = 21  <i|F|i> =   1.33427528
i = 22  <i|F|i> =   1.36775945
i = 23  <i|F|i> =   1.36815110
i = 24  <i|F|i> =   1.43059971
i = 25  <i|F|i> =   1.43020071
i = 26  <i|F|i> =   1.58783590
i = 27  <i|F|i> =   1.64077099
i = 28  <i|F|i> =   2.07378946
......production of RDMs took       1.96 sec
......reading the RDM took          0.45 sec
......production of RDMs took      21.15 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickSCNEVPT2-ijrs) =    -0.00030244331761
E(WickSCNEVPT2- rsi) =    -0.00083094027000
E(WickSCNEVPT2- ijr) =    -0.00025635879985
E(WickSCNEVPT2-  rs) =    -0.03249025729133
E(WickSCNEVPT2-  ij) =    -0.00005322371754
E(WickSCNEVPT2-  ir) =    -0.00098272500353
E(WickSCNEVPT2-   r) =    -0.06037056550199
E(WickSCNEVPT2-   i) =    -0.00004529158706
E(WickSCNEVPT2) = -75.54630427640063  E_corr_pt = -0.09533180548890988
Timings = pdms =   33.39 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.02 | r =    0.63 | i =    0.28
Time cost =     76.336
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:29:19 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.116708843680 AA    0.000000000000   0.000000000000   4.000000000000 Bohr   0.0

nuclear repulsion = 9
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 2.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10420.51


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpavd838l5
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.65829474285

WARN: Singularity detected in overlap matrix (condition number = 55.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0893486438705835  LUMO (B3u) = -0.0893486438705835

WARN: B2u HOMO -0.0893486438705835 > system LUMO -0.0893486438705835

cycle= 1 E= -75.2192687068769  delta_E= -0.561  |g|= 0.226  |ddm|= 1.45
HOMO (B2u) = -0.339798299416294  LUMO (B3u) = -0.0412658624563699
cycle= 2 E= -75.240154283596  delta_E= -0.0209  |g|= 0.0439  |ddm|= 0.347
HOMO (B2u) = -0.308660706394018  LUMO (B3u) = -0.00561531074292667
cycle= 3 E= -75.2413180659384  delta_E= -0.00116  |g|= 0.0164  |ddm|= 0.0569
HOMO (B2u) = -0.312871203858106  LUMO (B3u) = -0.00961084060264619
cycle= 4 E= -75.2415141140049  delta_E= -0.000196  |g|= 0.000633  |ddm|= 0.0328
HOMO (B2u) = -0.312958040513247  LUMO (B3u) = -0.00983140550670168
cycle= 5 E= -75.2415142702404  delta_E= -1.56e-07  |g|= 0.000135  |ddm|= 0.00081
HOMO (B2u) = -0.312924808517806  LUMO (B3u) = -0.00980779398986067
cycle= 6 E= -75.2415142806734  delta_E= -1.04e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.312922000715267  LUMO (B3u) = -0.00980776379454693
cycle= 7 E= -75.2415142809298  delta_E= -2.56e-10  |g|= 2.02e-06  |ddm|= 4.04e-05
HOMO (B2u) = -0.312921604622336  LUMO (B3u) = -0.00980784357418378
cycle= 8 E= -75.2415142809325  delta_E= -2.69e-12  |g|= 1.28e-07  |ddm|= 4.27e-06
HOMO (B2u) = -0.312921617365196  LUMO (B3u) = -0.00980784817115738
cycle= 9 E= -75.2415142809324  delta_E= 4.26e-14  |g|= 6.97e-09  |ddm|= 3.09e-07
HOMO (B2u) = -0.312921616457483  LUMO (B3u) = -0.00980784977093011
cycle= 10 E= -75.2415142809325  delta_E= -5.68e-14  |g|= 6.48e-09  |ddm|= 6.77e-09
HOMO (B2u) = -0.312921616766723  LUMO (B3u) = -0.00980785017977217
cycle= 11 E= -75.2415142809325  delta_E=    0  |g|= 4.52e-09  |ddm|= 5.12e-09
HOMO (B2u) = -0.312921615944438  LUMO (B3u) = -0.00980784931581177
cycle= 12 E= -75.2415142809324  delta_E= 7.11e-14  |g|= 3.83e-09  |ddm|= 2.79e-09
HOMO (B2u) = -0.312921616048608  LUMO (B3u) = -0.00980784942798914
cycle= 13 E= -75.2415142809324  delta_E= -1.42e-14  |g|= 3.44e-09  |ddm|= 1.26e-09
HOMO (B2u) = -0.312921615711801  LUMO (B3u) = -0.0098078493068668
cycle= 14 E= -75.2415142809325  delta_E= -7.11e-14  |g|= 6.03e-10  |ddm|= 6.18e-09
HOMO (B2u) = -0.312921615819784  LUMO (B3u) = -0.00980784934702493
cycle= 15 E= -75.2415142809325  delta_E= 2.84e-14  |g|= 6.91e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615748239  LUMO (B3u) = -0.00980784933456689
cycle= 16 E= -75.2415142809325  delta_E=    0  |g|= 5.81e-10  |ddm|= 9.48e-10
HOMO (B2u) = -0.312921615768304  LUMO (B3u) = -0.00980784930668164
cycle= 17 E= -75.2415142809325  delta_E=    0  |g|= 7.32e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615745711  LUMO (B3u) = -0.00980784929796197
cycle= 18 E= -75.2415142809325  delta_E=    0  |g|= 5.57e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.312921615748291  LUMO (B3u) = -0.00980784931171131
cycle= 19 E= -75.2415142809325  delta_E=    0  |g|= 4.24e-10  |ddm|= 4.39e-10
HOMO (B2u) = -0.31292161575473  LUMO (B3u) = -0.00980784932707325
cycle= 20 E= -75.2415142809325  delta_E=    0  |g|= 3.34e-10  |ddm|= 2.91e-10
HOMO (B2u) = -0.31292161574924  LUMO (B3u) = -0.0098078493291216
cycle= 21 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 2.39e-10  |ddm|= 2.29e-10
HOMO (B2u) = -0.312921615744366  LUMO (B3u) = -0.00980784933188447
cycle= 22 E= -75.2415142809325  delta_E= 4.26e-14  |g|= 1.48e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.312921615743179  LUMO (B3u) = -0.00980784933026609
cycle= 23 E= -75.2415142809325  delta_E= -4.26e-14  |g|= 1.31e-10  |ddm|= 3.98e-11
HOMO (B2u) = -0.312921615738652  LUMO (B3u) = -0.0098078493282525
cycle= 24 E= -75.2415142809325  delta_E=    0  |g|= 1.11e-10  |ddm|= 5.14e-11
HOMO (B2u) = -0.31292161573719  LUMO (B3u) = -0.00980784932686147
cycle= 25 E= -75.2415142809325  delta_E=    0  |g|= 9.34e-11  |ddm|= 3.98e-11
HOMO (B2u) = -0.312921615730197  LUMO (B3u) = -0.00980784932517376
Extra cycle  E= -75.2415142809325  delta_E= 2.84e-14  |g|= 3.04e-11  |ddm|= 1.48e-10
converged SCF energy = -75.2415142809325

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpavd838l5
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4079772031603  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4269928701519  dE = -0.019015667  S^2 = 0.0000000
               |grad[o]|=0.112  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4392401163903  dE = -0.012247246  S^2 = 0.0000000
               |grad[o]|=0.0794  |ddm|=0.133  |maxRot[o]|=0.079
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4451921759396  dE = -0.0059520595  S^2 = 0.0000000
               |grad[o]|=0.0445  |ddm|=0.0301  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4468428193125  dE = -0.0016506434  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.0981  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4473888812611  dE = -0.00054606195  S^2 = 0.0000000
               |grad[o]|=0.0077  |ddm|=0.0155  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4474923150802  dE = -0.00010343382  S^2 = 0.0000000
               |grad[o]|=0.00362  |ddm|=0.00704  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4475072129747  dE = -1.4897894e-05  S^2 = 0.0000000
               |grad[o]|=0.00159  |ddm|=0.00339  |maxRot[o]|=0.00836
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4475085952737  dE = -1.3822991e-06  S^2 = 0.0000000
               |grad[o]|=0.000559  |ddm|=0.00151  |maxRot[o]|=0.00253
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4475087228392  dE = -1.2756541e-07  S^2 = 0.0000000
               |grad[o]|=0.000179  |ddm|=0.000495  |maxRot[o]|=0.000757
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4475087345608  dE = -1.1721625e-08  S^2 = 0.0000000
               |grad[o]|=5.56e-05  |ddm|=0.000156  |maxRot[o]|=0.000227
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4475087356465  dE = -1.0856809e-09  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=4.8e-05  |maxRot[o]|=6.85e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4475087357395  dE = -9.2995833e-11  S^2 = 0.0000000
               |grad[o]|=5.27e-06  |ddm|=1.47e-05  |maxRot[o]|=2.04e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95539885 1.93749708 1.8292365  1.61997882 0.06124694 0.38415954
 0.05468074 0.15780153]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01243   0.01086  -0.00123   0.00000   0.00000
  0 C 2s       0.69987   0.68306  -0.09890  -0.00000   0.00000
  0 C 3s       0.00559   0.01429  -0.02264   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.69417
  0 C 2py      0.00000  -0.00000  -0.00000   0.70461   0.00000
  0 C 2pz      0.09912  -0.18163   0.69866   0.00000   0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.06942
  0 C 3py      0.00000  -0.00000  -0.00000   0.05510   0.00000
  0 C 3pz     -0.00787  -0.00173   0.02398   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02202   0.00000
  0 C 3dz^2    0.00990  -0.00917   0.03103   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.11537
 0 C 3dx2-y2   0.00220   0.00568  -0.00646   0.00000   0.00000
  1 C 1s       0.01243  -0.01086  -0.00123   0.00000   0.00000
  1 C 2s       0.69987  -0.68306  -0.09890  -0.00000   0.00000
  1 C 3s       0.00559  -0.01429  -0.02264  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000  -0.00000  -0.00000   0.69417
  1 C 2py     -0.00000   0.00000   0.00000   0.70461  -0.00000
  1 C 2pz     -0.09912  -0.18163  -0.69866   0.00000   0.00000
  1 C 3px      0.00000   0.00000  -0.00000  -0.00000  -0.06942
  1 C 3py     -0.00000   0.00000   0.00000   0.05510  -0.00000
  1 C 3pz      0.00787  -0.00173  -0.02398   0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02202  -0.00000
  1 C 3dz^2    0.00990   0.00917   0.03103  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000   0.11537
 1 C 3dx2-y2   0.00220  -0.00568  -0.00646  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00018
  0 C 2s      -0.00000  -0.00000   0.18114
  0 C 3s      -0.00000   0.00000   0.02444
  0 C 2px      0.00000   0.69909   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.68284
  0 C 3px     -0.00000  -0.02448   0.00000
  0 C 3py      0.00635  -0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.01417
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00736   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00169
  0 C 3dxz    -0.00000  -0.10334   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01092
  1 C 1s       0.00000   0.00000   0.00018
  1 C 2s       0.00000  -0.00000  -0.18114
  1 C 3s       0.00000  -0.00000  -0.02444
  1 C 2px      0.00000  -0.69909  -0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.68284
  1 C 3px     -0.00000   0.02448  -0.00000
  1 C 3py     -0.00635  -0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01417
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00736   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00169
  1 C 3dxz     0.00000  -0.10334   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01092
<CAS-nat-orb|mo-hf>  3  3    0.99576781
<CAS-nat-orb|mo-hf>  4  4    0.99957524
<CAS-nat-orb|mo-hf>  5  5    0.99568632
<CAS-nat-orb|mo-hf>  6  6    0.99833014
<CAS-nat-orb|mo-hf>  7  7    0.93288519
<CAS-nat-orb|mo-hf>  8  8    0.98831105
<CAS-nat-orb|mo-hf>  9  9    0.96112500
<CAS-nat-orb|mo-hf>  10  10    0.96605593
CASSCF energy = -75.4475087357395
CASCI E = -75.4475087357395  E(CI) = -14.7317045576553  S^2 = 0.0000000
Density matrix diagonal elements [1.95539933 1.93749779 1.82923627 1.61997896 0.06124623 0.38415942
 0.05468108 0.15780091]
i = 1  <i|F|i> = -11.34411509
i = 2  <i|F|i> = -11.34450369
i = 3  <i|F|i> =  -0.78540601
i = 4  <i|F|i> =  -0.64707423
i = 5  <i|F|i> =  -0.32557613
i = 6  <i|F|i> =  -0.24651091
i = 7  <i|F|i> =   0.11605952
i = 8  <i|F|i> =  -0.00723209
i = 9  <i|F|i> =   0.16826213
i = 10  <i|F|i> =   0.17318937
i = 11  <i|F|i> =   0.63365360
i = 12  <i|F|i> =   0.68157112
i = 13  <i|F|i> =   0.62334220
i = 14  <i|F|i> =   0.72155366
i = 15  <i|F|i> =   0.72945404
i = 16  <i|F|i> =   0.71783406
i = 17  <i|F|i> =   0.81972737
i = 18  <i|F|i> =   0.99123042
i = 19  <i|F|i> =   1.22924695
i = 20  <i|F|i> =   1.26632053
i = 21  <i|F|i> =   1.32134780
i = 22  <i|F|i> =   1.37074001
i = 23  <i|F|i> =   1.37096337
i = 24  <i|F|i> =   1.42860707
i = 25  <i|F|i> =   1.42825289
i = 26  <i|F|i> =   1.57691873
i = 27  <i|F|i> =   1.62863299
i = 28  <i|F|i> =   2.06093014
......production of RDMs took       1.94 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.63 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.85 sec

E(WickSCNEVPT2-ijrs) =    -0.00030437144302
E(WickSCNEVPT2- rsi) =    -0.00083511563170
E(WickSCNEVPT2- ijr) =    -0.00025493832033
E(WickSCNEVPT2-  rs) =    -0.03239836108982
E(WickSCNEVPT2-  ij) =    -0.00005195351514
E(WickSCNEVPT2-  ir) =    -0.00098012679445
E(WickSCNEVPT2-   r) =    -0.06054211954207
E(WickSCNEVPT2-   i) =    -0.00004325047977
E(WickSCNEVPT2) = -75.54291897255577  E_corr_pt = -0.09541023681630038
Timings = pdms =   32.88 | eris =    0.19 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.59 | i =    0.28
Time cost =     70.016
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:30:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.143167704226 AA    0.000000000000   0.000000000000   4.050000000000 Bohr   0.0

nuclear repulsion = 8.88888888888889
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10478.93


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpfim8xrif
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.650821541947

WARN: Singularity detected in overlap matrix (condition number = 52.1). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0872509906487013  LUMO (B3u) = -0.087250990648701

WARN: B2u HOMO -0.0872509906487013 > system LUMO -0.087250990648701

cycle= 1 E= -75.2120928138537  delta_E= -0.561  |g|= 0.225  |ddm|= 1.45
HOMO (B2u) = -0.336938998033694  LUMO (B3u) = -0.0396234294723663
cycle= 2 E= -75.2327826177341  delta_E= -0.0207  |g|= 0.0434  |ddm|= 0.347
HOMO (B2u) = -0.306147078592025  LUMO (B3u) = -0.00433141905845659
cycle= 3 E= -75.2339223949765  delta_E= -0.00114  |g|= 0.0162  |ddm|= 0.0561
HOMO (B2u) = -0.310321597199801  LUMO (B3u) = -0.0082827986497057
cycle= 4 E= -75.2341150976661  delta_E= -0.000193  |g|= 0.000629  |ddm|= 0.0325
HOMO (B2u) = -0.310388518956864  LUMO (B3u) = -0.00848075571953715
cycle= 5 E= -75.2341152524229  delta_E= -1.55e-07  |g|= 0.000135  |ddm|= 0.000802
HOMO (B2u) = -0.310356121170237  LUMO (B3u) = -0.00845811286980732
cycle= 6 E= -75.2341152629183  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.310353302460651  LUMO (B3u) = -0.0084580269781943
cycle= 7 E= -75.2341152631768  delta_E= -2.58e-10  |g|= 2.04e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.310352915622137  LUMO (B3u) = -0.0084581234520507
cycle= 8 E= -75.2341152631795  delta_E= -2.67e-12  |g|= 1.28e-07  |ddm|= 4.34e-06
HOMO (B2u) = -0.31035293053586  LUMO (B3u) = -0.00845812953652329
cycle= 9 E= -75.2341152631795  delta_E=    0  |g|= 6.66e-09  |ddm|= 3.04e-07
HOMO (B2u) = -0.310352929576029  LUMO (B3u) = -0.00845813118788793
cycle= 10 E= -75.2341152631795  delta_E=    0  |g|= 6.32e-09  |ddm|= 7.05e-09
HOMO (B2u) = -0.310352929992803  LUMO (B3u) = -0.00845813170242117
cycle= 11 E= -75.2341152631795  delta_E= 2.84e-14  |g|= 4.38e-09  |ddm|= 4.8e-09
HOMO (B2u) = -0.310352929258109  LUMO (B3u) = -0.00845813092347378
cycle= 12 E= -75.2341152631795  delta_E=    0  |g|= 3.72e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.310352929350467  LUMO (B3u) = -0.00845813101899009
cycle= 13 E= -75.2341152631795  delta_E=    0  |g|= 3.35e-09  |ddm|= 1.1e-09
HOMO (B2u) = -0.310352929050743  LUMO (B3u) = -0.00845813092932275
cycle= 14 E= -75.2341152631794  delta_E= 5.68e-14  |g|= 5.26e-10  |ddm|= 5.83e-09
HOMO (B2u) = -0.310352929162678  LUMO (B3u) = -0.00845813096844651
cycle= 15 E= -75.2341152631795  delta_E= -8.53e-14  |g|= 6.38e-10  |ddm|= 1.08e-09
HOMO (B2u) = -0.310352929093803  LUMO (B3u) = -0.00845813095607035
cycle= 16 E= -75.2341152631794  delta_E= 4.26e-14  |g|= 5.3e-10  |ddm|= 9.19e-10
HOMO (B2u) = -0.310352929110798  LUMO (B3u) = -0.00845813092666004
cycle= 17 E= -75.2341152631795  delta_E= -1.42e-14  |g|= 6.74e-10  |ddm|= 1.16e-09
HOMO (B2u) = -0.310352929092274  LUMO (B3u) = -0.00845813092040424
cycle= 18 E= -75.2341152631795  delta_E=    0  |g|= 5.14e-10  |ddm|= 3e-10
HOMO (B2u) = -0.310352929097974  LUMO (B3u) = -0.00845813093593587
cycle= 19 E= -75.2341152631795  delta_E=    0  |g|= 3.9e-10  |ddm|= 3.84e-10
HOMO (B2u) = -0.310352929107247  LUMO (B3u) = -0.00845813095310967
cycle= 20 E= -75.2341152631795  delta_E= -1.42e-14  |g|= 3.09e-10  |ddm|= 2.48e-10
HOMO (B2u) = -0.310352929104754  LUMO (B3u) = -0.00845813095747723
cycle= 21 E= -75.2341152631795  delta_E= -2.84e-14  |g|= 2.2e-10  |ddm|= 1.93e-10
HOMO (B2u) = -0.310352929102358  LUMO (B3u) = -0.00845813096211385
cycle= 22 E= -75.2341152631794  delta_E= 1.14e-13  |g|= 1.33e-10  |ddm|= 1.79e-10
HOMO (B2u) = -0.310352929101778  LUMO (B3u) = -0.00845813096067511
cycle= 23 E= -75.2341152631795  delta_E= -8.53e-14  |g|= 1.19e-10  |ddm|= 3.46e-11
HOMO (B2u) = -0.310352929097864  LUMO (B3u) = -0.00845813095900158
cycle= 24 E= -75.2341152631794  delta_E= 5.68e-14  |g|= 1e-10  |ddm|= 4.73e-11
HOMO (B2u) = -0.310352929096955  LUMO (B3u) = -0.00845813095799236
cycle= 25 E= -75.2341152631794  delta_E= 1.42e-14  |g|= 8.42e-11  |ddm|= 3.49e-11
HOMO (B2u) = -0.310352929095532  LUMO (B3u) = -0.00845813095820799
cycle= 26 E= -75.2341152631795  delta_E= -1.14e-13  |g|= 6.69e-11  |ddm|= 3.86e-11
HOMO (B2u) = -0.310352929094523  LUMO (B3u) = -0.00845813095839812
cycle= 27 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 5.58e-11  |ddm|= 3.03e-11
HOMO (B2u) = -0.310352929093543  LUMO (B3u) = -0.00845813095832701
cycle= 28 E= -75.2341152631794  delta_E= 1.42e-14  |g|= 4.54e-11  |ddm|= 2.25e-11
HOMO (B2u) = -0.310352929092737  LUMO (B3u) = -0.00845813095821255
cycle= 29 E= -75.2341152631795  delta_E= -4.26e-14  |g|= 3.56e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.310352929092108  LUMO (B3u) = -0.00845813095805631
cycle= 30 E= -75.2341152631794  delta_E= 4.26e-14  |g|= 2.82e-11  |ddm|= 1.4e-11
HOMO (B2u) = -0.310352929091715  LUMO (B3u) = -0.00845813095790709
cycle= 31 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 2.35e-11  |ddm|= 8.86e-12
HOMO (B2u) = -0.310352929091304  LUMO (B3u) = -0.00845813095778158
cycle= 32 E= -75.2341152631794  delta_E= -7.11e-14  |g|= 1.93e-11  |ddm|= 7.89e-12
HOMO (B2u) = -0.310352929091022  LUMO (B3u) = -0.00845813095770184
cycle= 33 E= -75.2341152631795  delta_E= -5.68e-14  |g|= 1.59e-11  |ddm|= 6.4e-12
HOMO (B2u) = -0.31035292909076  LUMO (B3u) = -0.00845813095765535
cycle= 34 E= -75.2341152631795  delta_E= 2.84e-14  |g|= 1.33e-11  |ddm|= 5.3e-12
HOMO (B2u) = -0.310352929090549  LUMO (B3u) = -0.00845813095760545
cycle= 35 E= -75.2341152631794  delta_E= 5.68e-14  |g|= 1.11e-11  |ddm|= 4.28e-12
HOMO (B2u) = -0.310352929090367  LUMO (B3u) = -0.00845813095754391
cycle= 36 E= -75.2341152631794  delta_E=    0  |g|= 9.12e-12  |ddm|= 3.74e-12
HOMO (B2u) = -0.310352929089848  LUMO (B3u) = -0.00845813095732903
Extra cycle  E= -75.2341152631795  delta_E= -5.68e-14  |g|= 3.59e-12  |ddm|= 1.05e-11
converged SCF energy = -75.2341152631795

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpfim8xrif
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.405013104616  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4242837882182  dE = -0.019270684  S^2 = 0.0000000
               |grad[o]|=0.114  |ddm|= 3.72  |maxRot[o]|=0.0784
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4363857272397  dE = -0.012101939  S^2 = 0.0000000
               |grad[o]|=0.0799  |ddm|=0.135  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4421036045552  dE = -0.0057178773  S^2 = 0.0000000
               |grad[o]|=0.0439  |ddm|=0.0337  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4436293618157  dE = -0.0015257573  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.0939  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4441199083516  dE = -0.00049054654  S^2 = 0.0000000
               |grad[o]|=0.00716  |ddm|=0.0142  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4441997253219  dE = -7.981697e-05  S^2 = 0.0000000
               |grad[o]|=0.00326  |ddm|=0.00696  |maxRot[o]|=0.019
macro iter 7 (3 JK  0 micro), CASSCF E = -75.444207674456  dE = -7.949134e-06  S^2 = 0.0000000
               |grad[o]|=0.00128  |ddm|=0.0033  |maxRot[o]|=0.00603
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4442084507923  dE = -7.7633635e-07  S^2 = 0.0000000
               |grad[o]|=0.000435  |ddm|=0.00116  |maxRot[o]|=0.00186
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4442085256887  dE = -7.4896391e-08  S^2 = 0.0000000
               |grad[o]|=0.00014  |ddm|=0.000383  |maxRot[o]|=0.000569
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4442085328941  dE = -7.2054007e-09  S^2 = 0.0000000
               |grad[o]|=4.42e-05  |ddm|=0.000122  |maxRot[o]|=0.000175
macro iter 11 (2 JK  0 micro), CASSCF E = -75.444208533582  dE = -6.8791906e-10  S^2 = 0.0000000
               |grad[o]|=1.38e-05  |ddm|=3.84e-05  |maxRot[o]|=5.39e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4442085336482  dE = -6.6137318e-11  S^2 = 0.0000000
               |grad[o]|=4.29e-06  |ddm|=1.2e-05  |maxRot[o]|=1.66e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95530405 1.93811148 1.81911524 1.60013605 0.06045908 0.40376984
 0.05434302 0.16876124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01246   0.01091  -0.00105   0.00000   0.00000
  0 C 2s       0.70117   0.68475  -0.08932   0.00000   0.00000
  0 C 3s       0.00639   0.01416  -0.02106   0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69435
  0 C 2py      0.00000   0.00000  -0.00000   0.70466  -0.00000
  0 C 2pz      0.08959  -0.17518   0.69998   0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06986
  0 C 3py     -0.00000   0.00000   0.00000   0.05490   0.00000
  0 C 3pz     -0.00744  -0.00175   0.02554   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.02095   0.00000
  0 C 3dz^2    0.00897  -0.00886   0.03021   0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11401
 0 C 3dx2-y2   0.00234   0.00560  -0.00636   0.00000   0.00000
  1 C 1s       0.01246  -0.01091  -0.00105   0.00000   0.00000
  1 C 2s       0.70117  -0.68475  -0.08932   0.00000   0.00000
  1 C 3s       0.00639  -0.01416  -0.02106  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70466  -0.00000
  1 C 2pz     -0.08959  -0.17518  -0.69998   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000   0.00000  -0.06986
  1 C 3py      0.00000  -0.00000   0.00000   0.05490  -0.00000
  1 C 3pz      0.00744  -0.00175  -0.02554   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02095   0.00000
  1 C 3dz^2    0.00897   0.00886   0.03021  -0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11401
 1 C 3dx2-y2   0.00234  -0.00560  -0.00636  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00016
  0 C 2s       0.00000   0.00000   0.17473
  0 C 3s       0.00000   0.00000   0.02347
  0 C 2px     -0.00000   0.69923   0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68460
  0 C 3px     -0.00000  -0.02593  -0.00000
  0 C 3py      0.00804  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.01155
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00702  -0.00000  -0.00000
  0 C 3dz^2    0.00000   0.00000   0.00132
  0 C 3dxz    -0.00000  -0.10203   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01008
  1 C 1s       0.00000   0.00000   0.00016
  1 C 2s      -0.00000  -0.00000  -0.17473
  1 C 3s      -0.00000  -0.00000  -0.02347
  1 C 2px      0.00000  -0.69923   0.00000
  1 C 2py     -0.70703   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68460
  1 C 3px      0.00000   0.02593  -0.00000
  1 C 3py     -0.00804   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.01155
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00702   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00132
  1 C 3dxz    -0.00000  -0.10203   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01008
<CAS-nat-orb|mo-hf>  3  3    0.99532683
<CAS-nat-orb|mo-hf>  4  4    0.99955353
<CAS-nat-orb|mo-hf>  5  5    0.99522359
<CAS-nat-orb|mo-hf>  6  6    0.99825105
<CAS-nat-orb|mo-hf>  7  7    0.93296321
<CAS-nat-orb|mo-hf>  8  8    0.98897441
<CAS-nat-orb|mo-hf>  9  9    0.96119969
<CAS-nat-orb|mo-hf>  10  10    0.96876542
CASSCF energy = -75.4442085336482
CASCI E = -75.4442085336482  E(CI) = -14.6790716900881  S^2 = 0.0000000
Density matrix diagonal elements [1.95530449 1.93811202 1.81911598 1.60013641 0.06045804 0.4037695
 0.05434306 0.1687605 ]
i = 1  <i|F|i> = -11.34352671
i = 2  <i|F|i> = -11.34391560
i = 3  <i|F|i> =  -0.78041793
i = 4  <i|F|i> =  -0.64899785
i = 5  <i|F|i> =  -0.32146696
i = 6  <i|F|i> =  -0.24150820
i = 7  <i|F|i> =   0.11747225
i = 8  <i|F|i> =  -0.01252016
i = 9  <i|F|i> =   0.16676914
i = 10  <i|F|i> =   0.16222578
i = 11  <i|F|i> =   0.63728161
i = 12  <i|F|i> =   0.68033279
i = 13  <i|F|i> =   0.62192092
i = 14  <i|F|i> =   0.72207848
i = 15  <i|F|i> =   0.73042018
i = 16  <i|F|i> =   0.71771397
i = 17  <i|F|i> =   0.82355772
i = 18  <i|F|i> =   0.98913049
i = 19  <i|F|i> =   1.23747043
i = 20  <i|F|i> =   1.27328242
i = 21  <i|F|i> =   1.30983149
i = 22  <i|F|i> =   1.37357030
i = 23  <i|F|i> =   1.37371436
i = 24  <i|F|i> =   1.42677611
i = 25  <i|F|i> =   1.42646143
i = 26  <i|F|i> =   1.56642252
i = 27  <i|F|i> =   1.61689171
i = 28  <i|F|i> =   2.04716129
......production of RDMs took       1.83 sec
......reading the RDM took          0.45 sec
......production of RDMs took      22.18 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         12.08 sec

E(WickSCNEVPT2-ijrs) =    -0.00030628244014
E(WickSCNEVPT2- rsi) =    -0.00083936130944
E(WickSCNEVPT2- ijr) =    -0.00025352709145
E(WickSCNEVPT2-  rs) =    -0.03231590669815
E(WickSCNEVPT2-  ij) =    -0.00005076122346
E(WickSCNEVPT2-  ir) =    -0.00097781738913
E(WickSCNEVPT2-   r) =    -0.06069065383654
E(WickSCNEVPT2-   i) =    -0.00004130643907
E(WickSCNEVPT2) = -75.53968415007554  E_corr_pt = -0.09547561642738686
Timings = pdms =   37.52 | eris =    0.01 | ijrs =    0.00 | rsi =    0.01 | ijr =    0.01 | rs =    0.01 | ij =    0.03 | ir =    0.03 | r =    0.81 | i =    0.38
Time cost =     74.053
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:31:43 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.169626564772 AA    0.000000000000   0.000000000000   4.100000000000 Bohr   0.0

nuclear repulsion = 8.78048780487805
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   2.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10529.53


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpjn9bfp3i
max_memory 4000 MB (current use 371 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.643876015773

WARN: Singularity detected in overlap matrix (condition number = 49.2). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.085243814003195  LUMO (B3u) = -0.0852438140031956

WARN: B2u HOMO -0.085243814003195 > system LUMO -0.0852438140031956

cycle= 1 E= -75.2050111450144  delta_E= -0.561  |g|= 0.224  |ddm|= 1.45
HOMO (B2u) = -0.334187231388071  LUMO (B3g) = -0.0398454588841023
cycle= 2 E= -75.2255220782413  delta_E= -0.0205  |g|= 0.043  |ddm|= 0.347
HOMO (B2u) = -0.303722561565161  LUMO (B3g) = -0.00486882385407558
cycle= 3 E= -75.2266381654048  delta_E= -0.00112  |g|= 0.0161  |ddm|= 0.0554
HOMO (B2u) = -0.307858619678189  LUMO (B3g) = -0.00776666805283165
cycle= 4 E= -75.226827530681  delta_E= -0.000189  |g|= 0.000623  |ddm|= 0.0321
HOMO (B2u) = -0.307904877132322  LUMO (B3g) = -0.00791200473592744
cycle= 5 E= -75.2268276836983  delta_E= -1.53e-07  |g|= 0.000135  |ddm|= 0.000792
HOMO (B2u) = -0.307873376598217  LUMO (B3g) = -0.00787181864144975
cycle= 6 E= -75.2268276941975  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000228
HOMO (B2u) = -0.307870547891905  LUMO (B3g) = -0.00786924076200101
cycle= 7 E= -75.2268276944567  delta_E= -2.59e-10  |g|= 2.07e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.307870168621765  LUMO (B3g) = -0.00786899944456939
cycle= 8 E= -75.2268276944595  delta_E= -2.79e-12  |g|= 1.28e-07  |ddm|= 4.42e-06
HOMO (B2u) = -0.30787018580922  LUMO (B3g) = -0.00786900390113106
cycle= 9 E= -75.2268276944594  delta_E= 5.68e-14  |g|= 6.56e-09  |ddm|= 2.97e-07
HOMO (B2u) = -0.307870184792701  LUMO (B3g) = -0.0078690050103703
cycle= 10 E= -75.2268276944595  delta_E= -5.68e-14  |g|= 6.27e-09  |ddm|= 7.53e-09
HOMO (B2u) = -0.307870185324055  LUMO (B3g) = -0.00786900549079167
cycle= 11 E= -75.2268276944595  delta_E=    0  |g|= 4.35e-09  |ddm|= 4.43e-09
HOMO (B2u) = -0.307870184673539  LUMO (B3g) = -0.00786900468966384
cycle= 12 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 3.7e-09  |ddm|= 2.57e-09
HOMO (B2u) = -0.30787018475642  LUMO (B3g) = -0.00786900477076422
cycle= 13 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 3.34e-09  |ddm|= 9.61e-10
HOMO (B2u) = -0.307870184502954  LUMO (B3g) = -0.00786900460322978
cycle= 14 E= -75.2268276944595  delta_E=    0  |g|= 5.17e-10  |ddm|= 5.32e-09
HOMO (B2u) = -0.30787018461642  LUMO (B3g) = -0.00786900470669426
cycle= 15 E= -75.2268276944594  delta_E= 4.26e-14  |g|= 6.33e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.307870184545116  LUMO (B3g) = -0.0078690046441331
cycle= 16 E= -75.2268276944595  delta_E= -1.14e-13  |g|= 5.26e-10  |ddm|= 9.33e-10
HOMO (B2u) = -0.307870184560423  LUMO (B3g) = -0.00786900465951643
cycle= 17 E= -75.2268276944595  delta_E= 7.11e-14  |g|= 6.55e-10  |ddm|= 1.23e-09
HOMO (B2u) = -0.307870184545912  LUMO (B3g) = -0.00786900465074495
cycle= 18 E= -75.2268276944595  delta_E= -1.42e-14  |g|= 5.01e-10  |ddm|= 2.42e-10
HOMO (B2u) = -0.30787018455488  LUMO (B3g) = -0.00786900465764348
cycle= 19 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 3.81e-10  |ddm|= 3.34e-10
HOMO (B2u) = -0.307870184567083  LUMO (B3g) = -0.00786900467006377
cycle= 20 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 3.04e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.307870184567671  LUMO (B3g) = -0.00786900467410279
cycle= 21 E= -75.2268276944595  delta_E=    0  |g|= 2.16e-10  |ddm|= 1.62e-10
HOMO (B2u) = -0.307870184567839  LUMO (B3g) = -0.00786900467886528
cycle= 22 E= -75.2268276944595  delta_E= -5.68e-14  |g|= 1.31e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.307870184567808  LUMO (B3g) = -0.00786900467970061
cycle= 23 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 1.16e-10  |ddm|= 3.44e-11
HOMO (B2u) = -0.307870184564364  LUMO (B3g) = -0.00786900467778106
cycle= 24 E= -75.2268276944594  delta_E= 2.84e-14  |g|= 9.8e-11  |ddm|= 4.83e-11
HOMO (B2u) = -0.307870184564073  LUMO (B3g) = -0.00786900467856763
cycle= 25 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 8.24e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.307870184563419  LUMO (B3g) = -0.00786900467864725
cycle= 26 E= -75.2268276944595  delta_E= -5.68e-14  |g|= 6.58e-11  |ddm|= 2.95e-11
HOMO (B2u) = -0.307870184563003  LUMO (B3g) = -0.00786900467861723
cycle= 27 E= -75.2268276944595  delta_E= 7.11e-14  |g|= 5.53e-11  |ddm|= 2.3e-11
HOMO (B2u) = -0.307870184562453  LUMO (B3g) = -0.0078690046786359
cycle= 28 E= -75.2268276944595  delta_E= -4.26e-14  |g|= 4.52e-11  |ddm|= 1.79e-11
HOMO (B2u) = -0.307870184561961  LUMO (B3g) = -0.00786900467878314
cycle= 29 E= -75.2268276944594  delta_E= 5.68e-14  |g|= 3.55e-11  |ddm|= 1.62e-11
HOMO (B2u) = -0.30787018456156  LUMO (B3g) = -0.00786900467889665
cycle= 30 E= -75.2268276944595  delta_E= -1.42e-14  |g|= 2.82e-11  |ddm|= 1.26e-11
HOMO (B2u) = -0.307870184561315  LUMO (B3g) = -0.00786900467898628
cycle= 31 E= -75.2268276944595  delta_E= -4.26e-14  |g|= 2.35e-11  |ddm|= 8.4e-12
HOMO (B2u) = -0.307870184561037  LUMO (B3g) = -0.00786900467900928
cycle= 32 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 1.93e-11  |ddm|= 7.37e-12
HOMO (B2u) = -0.307870184560875  LUMO (B3g) = -0.00786900467908001
cycle= 33 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 1.6e-11  |ddm|= 5.78e-12
HOMO (B2u) = -0.307870184560715  LUMO (B3g) = -0.00786900467910273
cycle= 34 E= -75.2268276944595  delta_E= -4.26e-14  |g|= 1.34e-11  |ddm|= 4.54e-12
HOMO (B2u) = -0.307870184560581  LUMO (B3g) = -0.0078690046791262
cycle= 35 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 1.12e-11  |ddm|= 3.79e-12
HOMO (B2u) = -0.307870184560458  LUMO (B3g) = -0.00786900467914976
cycle= 36 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 9.22e-12  |ddm|= 3.5e-12
HOMO (B2u) = -0.307870184560351  LUMO (B3g) = -0.00786900467916935
cycle= 37 E= -75.2268276944595  delta_E= -1.42e-14  |g|= 7.56e-12  |ddm|= 3.02e-12
HOMO (B2u) = -0.307870184560264  LUMO (B3g) = -0.00786900467918413
cycle= 38 E= -75.2268276944595  delta_E= 8.53e-14  |g|= 6.23e-12  |ddm|= 2.43e-12
HOMO (B2u) = -0.307870184560195  LUMO (B3g) = -0.00786900467919526
cycle= 39 E= -75.2268276944595  delta_E= -4.26e-14  |g|= 5.18e-12  |ddm|= 1.94e-12
HOMO (B2u) = -0.307870184560136  LUMO (B3g) = -0.00786900467920356
cycle= 40 E= -75.2268276944594  delta_E= 5.68e-14  |g|= 4.31e-12  |ddm|= 1.61e-12
HOMO (B2u) = -0.307870184560089  LUMO (B3g) = -0.00786900467921149
cycle= 41 E= -75.2268276944594  delta_E=    0  |g|= 3.6e-12  |ddm|= 1.32e-12
HOMO (B2u) = -0.307870184559945  LUMO (B3g) = -0.00786900467923679
Extra cycle  E= -75.2268276944595  delta_E= -2.84e-14  |g|= 1.44e-12  |ddm|= 4.04e-12
converged SCF energy = -75.2268276944595

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmpjn9bfp3i
max_memory 4000 MB (current use 371 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4021896555602  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4214649606423  dE = -0.019275305  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4334658808326  dE = -0.01200092  S^2 = 0.0000000
               |grad[o]|=0.0809  |ddm|=0.135  |maxRot[o]|=0.0799
macro iter 3 (5 JK  0 micro), CASSCF E = -75.4382739601378  dE = -0.0048080793  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.0331  |maxRot[o]|= 0.06
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4401616771833  dE = -0.001887717  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.0842  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.440872606538  dE = -0.00071092935  S^2 = 0.0000000
               |grad[o]|=0.00949  |ddm|=0.0179  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.441024953678  dE = -0.00015234714  S^2 = 0.0000000
               |grad[o]|=0.0045  |ddm|=0.00833  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4410686424733  dE = -4.3688795e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.00376  |maxRot[o]|=0.0138
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4410730802276  dE = -4.4377543e-06  S^2 = 0.0000000
               |grad[o]|=0.000978  |ddm|=0.00262  |maxRot[o]|=0.00444
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4410735333522  dE = -4.531246e-07  S^2 = 0.0000000
               |grad[o]|=0.000336  |ddm|=0.000902  |maxRot[o]|=0.00139
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4410735792916  dE = -4.593943e-08  S^2 = 0.0000000
               |grad[o]|=0.00011  |ddm|=0.0003  |maxRot[o]|=0.000438
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4410735839379  dE = -4.6462532e-09  S^2 = 0.0000000
               |grad[o]|=3.55e-05  |ddm|=9.77e-05  |maxRot[o]|=0.000139
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4410735844029  dE = -4.6500759e-10  S^2 = 0.0000000
               |grad[o]|=1.14e-05  |ddm|=3.12e-05  |maxRot[o]|=4.36e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4410735844491  dE = -4.6242121e-11  S^2 = 0.0000000
               |grad[o]|=3.63e-06  |ddm|=1e-05  |maxRot[o]|=1.38e-05
2-step CASSCF converged in 13 macro (47 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95524813 1.93872441 1.80820228 1.57967996 0.42398994 0.05970186
 0.05400188 0.18045154]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01248   0.01096  -0.00089   0.00000   0.00000
  0 C 2s       0.70221   0.68634  -0.08081   0.00000   0.00000
  0 C 3s       0.00710   0.01405  -0.01955  -0.00000   0.00000
  0 C 2px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 2py      0.00000  -0.00000   0.00000   0.70471   0.70701
  0 C 2pz      0.08112  -0.16887   0.70104   0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3py      0.00000  -0.00000   0.00000   0.05462   0.00967
  0 C 3pz     -0.00705  -0.00178   0.02705  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.01990   0.00668
  0 C 3dz^2    0.00810  -0.00856   0.02935  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.00000
 0 C 3dx2-y2   0.00247   0.00552  -0.00626   0.00000  -0.00000
  1 C 1s       0.01248  -0.01096  -0.00089   0.00000   0.00000
  1 C 2s       0.70221  -0.68634  -0.08081   0.00000   0.00000
  1 C 3s       0.00710  -0.01405  -0.01955  -0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 2py     -0.00000   0.00000  -0.00000   0.70471  -0.70701
  1 C 2pz     -0.08112  -0.16887  -0.70104   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3py     -0.00000   0.00000  -0.00000   0.05462  -0.00967
  1 C 3pz      0.00705  -0.00178  -0.02705   0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.01990   0.00668
  1 C 3dz^2    0.00810   0.00856   0.02935  -0.00000  -0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
 1 C 3dx2-y2   0.00247  -0.00552  -0.00626  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00015
  0 C 2s       0.00000   0.00000   0.16846
  0 C 3s       0.00000  -0.00000   0.02250
  0 C 2px      0.69455   0.69937   0.00000
  0 C 2py     -0.00000  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68626
  0 C 3px     -0.07025  -0.02735   0.00000
  0 C 3py     -0.00000   0.00000   0.00000
  0 C 3pz      0.00000  -0.00000  -0.00897
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00098
  0 C 3dxz    -0.11253  -0.10066   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00927
  1 C 1s       0.00000   0.00000   0.00015
  1 C 2s      -0.00000   0.00000  -0.16846
  1 C 3s      -0.00000  -0.00000  -0.02250
  1 C 2px      0.69455  -0.69937  -0.00000
  1 C 2py      0.00000  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.68626
  1 C 3px     -0.07025   0.02735  -0.00000
  1 C 3py     -0.00000   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.00897
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00098
  1 C 3dxz     0.11253  -0.10066   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00927
<CAS-nat-orb|mo-hf>  3  3    0.99498963
<CAS-nat-orb|mo-hf>  4  4    0.99952982
<CAS-nat-orb|mo-hf>  5  5    0.99486173
<CAS-nat-orb|mo-hf>  6  6    0.99817000
<CAS-nat-orb|mo-hf>  7  7    0.98959359
<CAS-nat-orb|mo-hf>  8  8    0.93310195
<CAS-nat-orb|mo-hf>  9  9    0.96127102
<CAS-nat-orb|mo-hf>  10  10    0.97122875
CASSCF energy = -75.4410735844491
CASCI E = -75.4410735844491  E(CI) = -14.6278043064795  S^2 = 0.0000000
Density matrix diagonal elements [1.95524844 1.93872489 1.80820259 1.57967994 0.42398994 0.05970133
 0.05400184 0.18045104]
i = 1  <i|F|i> = -11.34284732
i = 2  <i|F|i> = -11.34323537
i = 3  <i|F|i> =  -0.77569882
i = 4  <i|F|i> =  -0.65083185
i = 5  <i|F|i> =  -0.31719849
i = 6  <i|F|i> =  -0.23653946
i = 7  <i|F|i> =  -0.01767782
i = 8  <i|F|i> =   0.11877419
i = 9  <i|F|i> =   0.16534864
i = 10  <i|F|i> =   0.15165859
i = 11  <i|F|i> =   0.64083229
i = 12  <i|F|i> =   0.67910489
i = 13  <i|F|i> =   0.62061787
i = 14  <i|F|i> =   0.72259061
i = 15  <i|F|i> =   0.73135220
i = 16  <i|F|i> =   0.71759170
i = 17  <i|F|i> =   0.82668342
i = 18  <i|F|i> =   0.98716994
i = 19  <i|F|i> =   1.24571597
i = 20  <i|F|i> =   1.28031601
i = 21  <i|F|i> =   1.29981874
i = 22  <i|F|i> =   1.37625483
i = 23  <i|F|i> =   1.37635389
i = 24  <i|F|i> =   1.42509947
i = 25  <i|F|i> =   1.42481933
i = 26  <i|F|i> =   1.55635533
i = 27  <i|F|i> =   1.60555424
i = 28  <i|F|i> =   2.03256983
......production of RDMs took       1.83 sec
......reading the RDM took          0.45 sec
......production of RDMs took      20.22 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickSCNEVPT2-ijrs) =    -0.00030816155871
E(WickSCNEVPT2- rsi) =    -0.00084364135472
E(WickSCNEVPT2- ijr) =    -0.00025212168362
E(WickSCNEVPT2-  rs) =    -0.03224260049511
E(WickSCNEVPT2-  ij) =    -0.00004964322785
E(WickSCNEVPT2-  ir) =    -0.00097577215313
E(WickSCNEVPT2-   r) =    -0.06081662222116
E(WickSCNEVPT2-   i) =    -0.00003945679075
E(WickSCNEVPT2) = -75.53660160393416  E_corr_pt = -0.09552801948505642
Timings = pdms =   32.27 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.02 | ir =    0.02 | r =    0.55 | i =    0.26
Time cost =     71.144
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:32:54 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.196085425318 AA    0.000000000000   0.000000000000   4.150000000000 Bohr   0.0

nuclear repulsion = 8.67469879518072
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10571.96


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp9isxvrm8
max_memory 4000 MB (current use 358 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6374240354882

WARN: Singularity detected in overlap matrix (condition number = 46.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.083322637909666  LUMO (B3u) = -0.0833226379096662

WARN: B2u HOMO -0.083322637909666 > system LUMO -0.0833226379096662

cycle= 1 E= -75.1980259935244  delta_E= -0.561  |g|= 0.223  |ddm|= 1.45
HOMO (B2u) = -0.331539393004465  LUMO (B3g) = -0.0424794268999033
cycle= 2 E= -75.2183742970649  delta_E= -0.0203  |g|= 0.0426  |ddm|= 0.347
HOMO (B2u) = -0.301383734536959  LUMO (B3g) = -0.00782777517474486
cycle= 3 E= -75.2194670845425  delta_E= -0.00109  |g|= 0.0159  |ddm|= 0.0547
HOMO (B2u) = -0.305478746489494  LUMO (B3g) = -0.0107333088759239
cycle= 4 E= -75.2196531399389  delta_E= -0.000186  |g|= 0.000618  |ddm|= 0.0318
HOMO (B2u) = -0.305504012954425  LUMO (B3g) = -0.0108540193385361
cycle= 5 E= -75.2196532909579  delta_E= -1.51e-07  |g|= 0.000135  |ddm|= 0.000782
HOMO (B2u) = -0.3054734770586  LUMO (B3g) = -0.0108148524604093
cycle= 6 E= -75.2196533014041  delta_E= -1.04e-08  |g|= 1.98e-05  |ddm|= 0.000227
HOMO (B2u) = -0.305470638287286  LUMO (B3g) = -0.0108121741027754
cycle= 7 E= -75.2196533016625  delta_E= -2.58e-10  |g|= 2.1e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.305470264892506  LUMO (B3g) = -0.0108119322510844
cycle= 8 E= -75.2196533016654  delta_E= -2.84e-12  |g|= 1.29e-07  |ddm|= 4.5e-06
HOMO (B2u) = -0.305470284406213  LUMO (B3g) = -0.0108119381625938
cycle= 9 E= -75.2196533016653  delta_E= 7.11e-14  |g|= 6.74e-09  |ddm|= 2.91e-07
HOMO (B2u) = -0.305470283329177  LUMO (B3g) = -0.0108119393077802
cycle= 10 E= -75.2196533016653  delta_E= -2.84e-14  |g|= 6.36e-09  |ddm|= 8.15e-09
HOMO (B2u) = -0.305470283983499  LUMO (B3g) = -0.0108119399121909
cycle= 11 E= -75.2196533016654  delta_E= -7.11e-14  |g|= 4.45e-09  |ddm|= 4.09e-09
HOMO (B2u) = -0.305470283403816  LUMO (B3g) = -0.0108119391825472
cycle= 12 E= -75.2196533016653  delta_E= 4.26e-14  |g|= 3.78e-09  |ddm|= 2.5e-09
HOMO (B2u) = -0.305470283231288  LUMO (B3g) = -0.0108119391067146
cycle= 13 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 3.38e-10  |ddm|= 5.63e-09
HOMO (B2u) = -0.305470283280864  LUMO (B3g) = -0.0108119391357018
cycle= 14 E= -75.2196533016653  delta_E= -2.84e-14  |g|= 4.47e-10  |ddm|= 6.63e-10
HOMO (B2u) = -0.305470283380785  LUMO (B3g) = -0.0108119392267977
cycle= 15 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 5.45e-10  |ddm|= 9.28e-10
HOMO (B2u) = -0.305470283317358  LUMO (B3g) = -0.0108119391694788
cycle= 16 E= -75.2196533016653  delta_E=    0  |g|= 4.75e-10  |ddm|= 8.13e-10
HOMO (B2u) = -0.305470283328594  LUMO (B3g) = -0.0108119391822028
cycle= 17 E= -75.2196533016653  delta_E= 5.68e-14  |g|= 5.84e-10  |ddm|= 1.12e-09
HOMO (B2u) = -0.305470283317632  LUMO (B3g) = -0.0108119391766187
cycle= 18 E= -75.2196533016653  delta_E= -5.68e-14  |g|= 4.22e-10  |ddm|= 2.55e-10
HOMO (B2u) = -0.305470283329725  LUMO (B3g) = -0.0108119391863405
cycle= 19 E= -75.2196533016653  delta_E= 4.26e-14  |g|= 2.86e-10  |ddm|= 2.99e-10
HOMO (B2u) = -0.305470283344779  LUMO (B3g) = -0.0108119392015174
cycle= 20 E= -75.2196533016653  delta_E= -2.84e-14  |g|= 1.97e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.305470283348154  LUMO (B3g) = -0.0108119392083001
cycle= 21 E= -75.2196533016653  delta_E=    0  |g|= 1.04e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.305470283348718  LUMO (B3g) = -0.010811939208232
cycle= 22 E= -75.2196533016653  delta_E=    0  |g|= 1.03e-10  |ddm|= 1.96e-11
HOMO (B2u) = -0.305470283349339  LUMO (B3g) = -0.0108119392094604
cycle= 23 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 9.01e-11  |ddm|= 3.44e-11
HOMO (B2u) = -0.305470283346979  LUMO (B3g) = -0.0108119392082499
cycle= 24 E= -75.2196533016653  delta_E= -1.42e-14  |g|= 7.53e-11  |ddm|= 4.36e-11
HOMO (B2u) = -0.305470283347415  LUMO (B3g) = -0.0108119392095278
cycle= 25 E= -75.2196533016653  delta_E= -2.84e-14  |g|= 6.18e-11  |ddm|= 3.8e-11
HOMO (B2u) = -0.30547028334767  LUMO (B3g) = -0.0108119392102766
cycle= 26 E= -75.2196533016653  delta_E= -1.42e-14  |g|= 4.61e-11  |ddm|= 2.42e-11
HOMO (B2u) = -0.305470283348003  LUMO (B3g) = -0.0108119392107365
cycle= 27 E= -75.2196533016653  delta_E=    0  |g|= 3.72e-11  |ddm|= 1.76e-11
HOMO (B2u) = -0.305470283348066  LUMO (B3g) = -0.0108119392120296
Extra cycle  E= -75.2196533016653  delta_E= 2.84e-14  |g|= 1.32e-11  |ddm|= 4.05e-11
converged SCF energy = -75.2196533016653

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-sc-nevpt2/tmp9isxvrm8
max_memory 4000 MB (current use 364 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-sc-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-sc-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-sc-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3995087253752  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4185114041757  dE = -0.019002679  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.430566843659  dE = -0.012055439  S^2 = 0.0000000
               |grad[o]|=0.0825  |ddm|=0.132  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4361439010165  dE = -0.0055770574  S^2 = 0.0000000
               |grad[o]|=0.0449  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4375519165773  dE = -0.0014080156  S^2 = 0.0000000
               |grad[o]|=0.013  |ddm|=0.0914  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4380256239178  dE = -0.00047370734  S^2 = 0.0000000
               |grad[o]|=0.00692  |ddm|=0.0133  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.438095843894  dE = -7.0219976e-05  S^2 = 0.0000000
               |grad[o]|=0.0032  |ddm|=0.00727  |maxRot[o]|=0.0175
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4381037763663  dE = -7.9324723e-06  S^2 = 0.0000000
               |grad[o]|=0.0013  |ddm|=0.00326  |maxRot[o]|=0.00586
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4381046435678  dE = -8.6720146e-07  S^2 = 0.0000000
               |grad[o]|=0.000463  |ddm|=0.00121  |maxRot[o]|=0.0019
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4381047367794  dE = -9.3211568e-08  S^2 = 0.0000000
               |grad[o]|=0.000156  |ddm|=0.000418  |maxRot[o]|=0.000616
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4381047467064  dE = -9.9270068e-09  S^2 = 0.0000000
               |grad[o]|=5.18e-05  |ddm|=0.00014  |maxRot[o]|=0.0002
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4381047477632  dE = -1.0568044e-09  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=4.62e-05  |maxRot[o]|=6.5e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.438104747875  dE = -1.1179679e-10  S^2 = 0.0000000
               |grad[o]|=5.58e-06  |ddm|=1.52e-05  |maxRot[o]|=2.12e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4381047478866  dE = -1.1610268e-11  S^2 = 0.0000000
               |grad[o]|=1.82e-06  |ddm|=4.99e-06  |maxRot[o]|=6.9e-06
2-step CASSCF converged in 13 macro (48 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95522558 1.93933508 1.79648698 1.55867498 0.44475735 0.05897222
 0.05365785 0.19288996]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01249   0.01101  -0.00075   0.00000   0.00000
  0 C 2s       0.70304   0.68783  -0.07328   0.00000   0.00000
  0 C 3s       0.00773   0.01395  -0.01813   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 2py     -0.00000   0.00000  -0.00000   0.70477   0.70699
  0 C 2pz      0.07361  -0.16270   0.70188  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3py      0.00000   0.00000  -0.00000   0.05427   0.01126
  0 C 3pz     -0.00668  -0.00182   0.02850   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.01889   0.00635
  0 C 3dz^2    0.00731  -0.00827   0.02845   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 0 C 3dx2-y2   0.00258   0.00545  -0.00616  -0.00000  -0.00000
  1 C 1s       0.01249  -0.01101  -0.00075   0.00000   0.00000
  1 C 2s       0.70304  -0.68783  -0.07328  -0.00000  -0.00000
  1 C 3s       0.00773  -0.01395  -0.01813  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 2py     -0.00000   0.00000   0.00000   0.70477  -0.70699
  1 C 2pz     -0.07361  -0.16270  -0.70188  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3py      0.00000  -0.00000  -0.00000   0.05427  -0.01126
  1 C 3pz      0.00668  -0.00182  -0.02850   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01889   0.00635
  1 C 3dz^2    0.00731   0.00827   0.02845   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 1 C 3dx2-y2   0.00258  -0.00545  -0.00616   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00014
  0 C 2s      -0.00000   0.00000   0.16232
  0 C 3s       0.00000  -0.00000   0.02153
  0 C 2px      0.69477   0.69952  -0.00000
  0 C 2py      0.00000  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.68780
  0 C 3px     -0.07060  -0.02872  -0.00000
  0 C 3py      0.00000   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00644
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00067
  0 C 3dxz    -0.11095  -0.09923  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00851
  1 C 1s       0.00000   0.00000   0.00014
  1 C 2s       0.00000   0.00000  -0.16232
  1 C 3s      -0.00000   0.00000  -0.02153
  1 C 2px      0.69477  -0.69952   0.00000
  1 C 2py      0.00000  -0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68780
  1 C 3px     -0.07060   0.02872   0.00000
  1 C 3py     -0.00000   0.00000   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00644
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00067
  1 C 3dxz     0.11095  -0.09923  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00851
<CAS-nat-orb|mo-hf>  3  3    0.99475642
<CAS-nat-orb|mo-hf>  4  4    0.99950402
<CAS-nat-orb|mo-hf>  5  5    0.99460067
<CAS-nat-orb|mo-hf>  6  6    0.99808720
<CAS-nat-orb|mo-hf>  7  7    0.99017070
<CAS-nat-orb|mo-hf>  8  8    0.93329646
<CAS-nat-orb|mo-hf>  9  9    0.96133984
<CAS-nat-orb|mo-hf>  10  10    0.97346862
CASSCF energy = -75.4381047478866
CASCI E = -75.4381047478866  E(CI) = -14.5778600953508  S^2 = 0.0000000
Density matrix diagonal elements [1.95522571 1.93933514 1.79648724 1.5586749  0.44475743 0.05897173
 0.05365804 0.19288982]
i = 1  <i|F|i> = -11.34208370
i = 2  <i|F|i> = -11.34246992
i = 3  <i|F|i> =  -0.77124251
i = 4  <i|F|i> =  -0.65257890
i = 5  <i|F|i> =  -0.31277562
i = 6  <i|F|i> =  -0.23161106
i = 7  <i|F|i> =  -0.02270276
i = 8  <i|F|i> =   0.11997316
i = 9  <i|F|i> =   0.16399560
i = 10  <i|F|i> =   0.14146451
i = 11  <i|F|i> =   0.64430107
i = 12  <i|F|i> =   0.67789822
i = 13  <i|F|i> =   0.61943246
i = 14  <i|F|i> =   0.72309183
i = 15  <i|F|i> =   0.73224843
i = 16  <i|F|i> =   0.71746391
i = 17  <i|F|i> =   0.82904595
i = 18  <i|F|i> =   0.98534401
i = 19  <i|F|i> =   1.25394109
i = 20  <i|F|i> =   1.28737462
i = 21  <i|F|i> =   1.29135053
i = 22  <i|F|i> =   1.37879798
i = 23  <i|F|i> =   1.37886901
i = 24  <i|F|i> =   1.42356952
i = 25  <i|F|i> =   1.42331924
i = 26  <i|F|i> =   1.54672073
i = 27  <i|F|i> =   1.59462605
i = 28  <i|F|i> =   2.01724529
......production of RDMs took       1.84 sec
......reading the RDM took          0.45 sec
......production of RDMs took      23.45 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.83 sec

E(WickSCNEVPT2-ijrs) =    -0.00030999539000
E(WickSCNEVPT2- rsi) =    -0.00084792199744
E(WickSCNEVPT2- ijr) =    -0.00025072063070
E(WickSCNEVPT2-  rs) =    -0.03217813519038
E(WickSCNEVPT2-  ij) =    -0.00004859633268
E(WickSCNEVPT2-  ir) =    -0.00097396607022
E(WickSCNEVPT2-   r) =    -0.06092061461103
E(WickSCNEVPT2-   i) =    -0.00003769626296
E(WickSCNEVPT2) = -75.533672394372  E_corr_pt = -0.09556764648541295
Timings = pdms =   35.58 | eris =    0.00 | ijrs =    0.00 | rsi =    0.00 | ijr =    0.01 | rs =    0.02 | ij =    0.03 | ir =    0.02 | r =    0.69 | i =    0.41
Time cost =    100.017
