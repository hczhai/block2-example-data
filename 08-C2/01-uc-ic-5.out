#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:05:48 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.952518979656 AA    0.000000000000   0.000000000000   1.800000000000 Bohr   0.0

nuclear repulsion = 20
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  0.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:        55.55


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpy4rzq5i3
max_memory 4000 MB (current use 158 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.1366469280558

WARN: Singularity detected in overlap matrix (condition number = 1.91e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.411563442743743  LUMO (Ag) = -0.232616164544876
cycle= 1 E= -75.1160073846338  delta_E= 1.02  |g|= 0.175  |ddm|= 1.65
HOMO (B1u) = -0.462886704875273  LUMO (Ag) = -0.099017704864388
cycle= 2 E= -75.1270298311364  delta_E= -0.011  |g|= 0.057  |ddm|= 0.233
HOMO (B1u) = -0.43800078024347  LUMO (Ag) = -0.0789293202815917
cycle= 3 E= -75.1282984729018  delta_E= -0.00127  |g|= 0.0157  |ddm|= 0.191
HOMO (B1u) = -0.440879448397977  LUMO (Ag) = -0.0869420301347685
cycle= 4 E= -75.1284487654917  delta_E= -0.00015  |g|= 0.00222  |ddm|= 0.0862
HOMO (B1u) = -0.441380240119148  LUMO (Ag) = -0.0882782976431999
cycle= 5 E= -75.128452075633  delta_E= -3.31e-06  |g|= 0.000419  |ddm|= 0.0158
HOMO (B1u) = -0.441351661772561  LUMO (Ag) = -0.088193327452912
cycle= 6 E= -75.1284521927704  delta_E= -1.17e-07  |g|= 2.77e-05  |ddm|= 0.00246
HOMO (B1u) = -0.441354048137815  LUMO (Ag) = -0.0881978149646851
cycle= 7 E= -75.1284521931899  delta_E= -4.19e-10  |g|= 1.77e-06  |ddm|= 0.000613
HOMO (B1u) = -0.4413540765098  LUMO (Ag) = -0.0881971474463631
cycle= 8 E= -75.1284521931911  delta_E= -1.18e-12  |g|= 1.61e-07  |ddm|= 3.45e-05
HOMO (B1u) = -0.441354065704955  LUMO (Ag) = -0.0881971923686859
cycle= 9 E= -75.128452193191  delta_E= 7.11e-14  |g|= 1.18e-08  |ddm|= 1.67e-06
HOMO (B1u) = -0.44135406563113  LUMO (Ag) = -0.0881971880097446
cycle= 10 E= -75.128452193191  delta_E= -4.26e-14  |g|= 5.5e-09  |ddm|= 1.02e-07
HOMO (B1u) = -0.441354065544179  LUMO (Ag) = -0.0881971874611793
cycle= 11 E= -75.1284521931911  delta_E= -2.84e-14  |g|= 6.47e-10  |ddm|= 4.17e-08
HOMO (B1u) = -0.441354065557059  LUMO (Ag) = -0.0881971874766035
cycle= 12 E= -75.128452193191  delta_E= 7.11e-14  |g|= 4.44e-10  |ddm|= 1.48e-09
HOMO (B1u) = -0.441354065561627  LUMO (Ag) = -0.0881971875222874
cycle= 13 E= -75.1284521931909  delta_E= 5.68e-14  |g|= 3.64e-10  |ddm|= 1.49e-09
HOMO (B1u) = -0.441354065533174  LUMO (Ag) = -0.0881971874634049
cycle= 14 E= -75.128452193191  delta_E= -8.53e-14  |g|= 3.28e-10  |ddm|= 2.04e-09
HOMO (B1u) = -0.44135406549909  LUMO (Ag) = -0.0881971874063428
cycle= 15 E= -75.128452193191  delta_E= 2.84e-14  |g|= 4e-10  |ddm|= 4.88e-09
HOMO (B1u) = -0.441354065482228  LUMO (Ag) = -0.0881971874622884
cycle= 16 E= -75.1284521931911  delta_E= -9.95e-14  |g|= 4.26e-10  |ddm|= 1.09e-08
HOMO (B1u) = -0.44135406553415  LUMO (Ag) = -0.0881971875095776
cycle= 17 E= -75.1284521931911  delta_E= -1.42e-14  |g|= 4.38e-10  |ddm|= 6.59e-10
HOMO (B1u) = -0.441354065582229  LUMO (Ag) = -0.0881971875251198
cycle= 18 E= -75.128452193191  delta_E= 1.42e-13  |g|= 1.76e-10  |ddm|= 3.91e-09
HOMO (B1u) = -0.441354065573567  LUMO (Ag) = -0.0881971875101079
cycle= 19 E= -75.1284521931911  delta_E= -1.14e-13  |g|= 6.35e-11  |ddm|= 1.07e-09
HOMO (B1u) = -0.441354065569504  LUMO (Ag) = -0.0881971875058031
cycle= 20 E= -75.128452193191  delta_E= 2.84e-14  |g|= 5.34e-11  |ddm|= 5.67e-11
HOMO (B1u) = -0.441354065566793  LUMO (Ag) = -0.0881971875031885
cycle= 21 E= -75.1284521931909  delta_E= 9.95e-14  |g|= 4.76e-11  |ddm|= 2.73e-11
HOMO (B1u) = -0.441354065566127  LUMO (Ag) = -0.0881971875011734
cycle= 22 E= -75.1284521931909  delta_E=    0  |g|= 4.25e-11  |ddm|= 1.22e-11
HOMO (B1u) = -0.441354065556895  LUMO (Ag) = -0.0881971874848981
Extra cycle  E= -75.1284521931911  delta_E= -1.14e-13  |g|= 1.24e-11  |ddm|= 8.47e-11
converged SCF energy = -75.1284521931911

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpy4rzq5i3
max_memory 4000 MB (current use 178 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.2773851266858  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.2921612576815  dE = -0.014776131  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3054533419341  dE = -0.013292084  S^2 = 0.0000000
               |grad[o]|=0.122  |ddm|=0.0317  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3171665946903  dE = -0.011713253  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|=0.022  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3257563504335  dE = -0.0085897557  S^2 = 0.0000000
               |grad[o]|=0.0806  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3312100963275  dE = -0.0054537459  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.00664  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3353808863929  dE = -0.0041707901  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3388115105675  dE = -0.0034306242  S^2 = 0.0000000
               |grad[o]|=0.0423  |ddm|=0.00197  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3416937937429  dE = -0.0028822832  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.00139  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.3441068786142  dE = -0.0024130849  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.00119  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.3460868967695  dE = -0.0019800182  S^2 = 0.0000000
               |grad[o]|=0.023  |ddm|=0.00138  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.3476533594332  dE = -0.0015664627  S^2 = 0.0000000
               |grad[o]|=0.0181  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.348820750429  dE = -0.001167391  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00222  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.3496021920211  dE = -0.00078144159  S^2 = 0.0000000
               |grad[o]|=0.00962  |ddm|=0.00269  |maxRot[o]|=0.0799
macro iter 14 (6 JK  0 micro), CASSCF E = -75.350007602129  dE = -0.00040541011  S^2 = 0.0000000
               |grad[o]|=0.00596  |ddm|=0.00323  |maxRot[o]|=0.0799
macro iter 15 (4 JK  0 micro), CASSCF E = -75.3500690559526  dE = -6.1453824e-05  S^2 = 0.0000000
               |grad[o]|=0.00259  |ddm|=0.004  |maxRot[o]|=0.0356
macro iter 16 (3 JK  0 micro), CASSCF E = -75.3500711296793  dE = -2.0737268e-06  S^2 = 0.0000000
               |grad[o]|=0.000771  |ddm|=0.00302  |maxRot[o]|=0.0056
macro iter 17 (3 JK  0 micro), CASSCF E = -75.3500712273195  dE = -9.7640182e-08  S^2 = 0.0000000
               |grad[o]|=0.000204  |ddm|=0.00102  |maxRot[o]|=0.00111
macro iter 18 (3 JK  0 micro), CASSCF E = -75.3500712324682  dE = -5.1486779e-09  S^2 = 0.0000000
               |grad[o]|=5.3e-05  |ddm|=0.000289  |maxRot[o]|=0.000238
macro iter 19 (3 JK  0 micro), CASSCF E = -75.350071232753  dE = -2.8479974e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=6.97e-05  |maxRot[o]|=5.33e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.3500712327691  dE = -1.6143531e-11  S^2 = 0.0000000
               |grad[o]|=3.36e-06  |ddm|=1.72e-05  |maxRot[o]|=1.23e-05
2-step CASSCF converged in 20 macro (102 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99117055 1.9483733  1.94837323 1.38207917 0.61632491 0.05352421
 0.05352413 0.0066305 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00026   0.00000   0.00000   0.00156  -0.00335
  0 C 2s       0.56540   0.00000  -0.00000   0.40871  -0.42139
  0 C 3s      -0.05874   0.00000  -0.00000   0.01072  -0.04347
  0 C 2px     -0.00000  -0.00000   0.70297  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70297  -0.00000  -0.00000  -0.00000
  0 C 2pz      0.41246   0.00000  -0.00000  -0.57668   0.56528
  0 C 3px      0.00000   0.00000  -0.06368  -0.00000   0.00000
  0 C 3py     -0.00000  -0.06368   0.00000  -0.00000  -0.00000
  0 C 3pz     -0.06271   0.00000  -0.00000  -0.01322  -0.02762
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.04218   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.05310   0.00000  -0.00000   0.01011   0.01522
  0 C 3dxz    -0.00000   0.00000   0.04218  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s      -0.00026   0.00000   0.00000  -0.00156  -0.00335
  1 C 2s       0.56540  -0.00000   0.00000  -0.40871  -0.42139
  1 C 3s      -0.05874  -0.00000   0.00000  -0.01072  -0.04347
  1 C 2px      0.00000  -0.00000   0.70297   0.00000  -0.00000
  1 C 2py      0.00000   0.70297  -0.00000   0.00000   0.00000
  1 C 2pz     -0.41246   0.00000   0.00000  -0.57668  -0.56528
  1 C 3px      0.00000  -0.00000  -0.06368   0.00000   0.00000
  1 C 3py      0.00000  -0.06368   0.00000   0.00000   0.00000
  1 C 3pz      0.06271   0.00000  -0.00000  -0.01322   0.02762
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.04218  -0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.05310  -0.00000   0.00000  -0.01011   0.01522
  1 C 3dxz    -0.00000   0.00000  -0.04218  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00117
  0 C 2s      -0.00000   0.00000   0.57006
  0 C 3s      -0.00000   0.00000  -0.05590
  0 C 2px      0.70510  -0.00000  -0.00000
  0 C 2py      0.00000   0.70510   0.00000
  0 C 2pz     -0.00000   0.00000   0.40146
  0 C 3px     -0.04754  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04754   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01218
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02390   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.10289
  0 C 3dxz    -0.02390  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00117
  1 C 2s       0.00000  -0.00000  -0.57006
  1 C 3s       0.00000  -0.00000   0.05590
  1 C 2px     -0.70510   0.00000   0.00000
  1 C 2py      0.00000  -0.70510  -0.00000
  1 C 2pz     -0.00000   0.00000   0.40146
  1 C 3px      0.04754   0.00000   0.00000
  1 C 3py      0.00000   0.04754  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01218
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02390   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.10289
  1 C 3dxz    -0.02390  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99656097
<CAS-nat-orb|mo-hf>  4  4    0.99984847
<CAS-nat-orb|mo-hf>  5  5    0.99984847
<CAS-nat-orb|mo-hf>  6  6    0.99856152
<CAS-nat-orb|mo-hf>  7  7    0.98495368
<CAS-nat-orb|mo-hf>  8  8    0.83784467
<CAS-nat-orb|mo-hf>  8  15   -0.54092854
<CAS-nat-orb|mo-hf>  9  9    0.83784453
<CAS-nat-orb|mo-hf>  9  16   -0.54092872
<CAS-nat-orb|mo-hf>  10  20   -0.80017035
CASSCF energy = -75.3500712327691
CASCI E = -75.3500712327691  E(CI) = -19.5186694186725  S^2 = 0.0000000
......production of RDMs took      43.52 sec
......reading the RDM took          0.46 sec
......production of RDMs took      90.44 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.81 sec

E(WickICMRREPT2-ijrs) =    -0.00068200757488
E(WickICMRREPT2- rsi) =    -0.00163507200638
E(WickICMRREPT2- ijr) =    -0.00057473225241
E(WickICMRREPT2-  rs) =    -0.05772319602789
E(WickICMRREPT2-  ij) =    -0.00015969377807
E(WickICMRREPT2-  ir) =    -0.00165551624238
E(WickICMRREPT2-   r) =    -0.04273036986046
E(WickICMRREPT2-   i) =    -0.00038425012950
E(WickICMRREPT2) = -75.45561607064109  E_corr_pt = -0.1055448378719629
Timings = pdms =  144.21 | eris =    0.18 | ijrs =    1.26 | rsi =   38.91 | ijr =    0.42 | rs =  766.07 | ij =    1.28 | ir =   28.87 | r =  152.18 | i =    2.55 | total = 1136.01
Time cost =   1794.672
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:35:42 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.978977840202 AA    0.000000000000   0.000000000000   1.850000000000 Bohr   0.0

nuclear repulsion = 19.4594594594595
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     17894.93


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpskm7fw3r
max_memory 4000 MB (current use 439 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.0853308429702

WARN: Singularity detected in overlap matrix (condition number = 1.7e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.413580977369316  LUMO (Ag) = -0.227598981995081
cycle= 1 E= -75.172693617241  delta_E= 0.913  |g|= 0.173  |ddm|= 1.63
HOMO (B1u) = -0.471112350140235  LUMO (Ag) = -0.104670423689866
cycle= 2 E= -75.183500823803  delta_E= -0.0108  |g|= 0.0557  |ddm|= 0.215
HOMO (B1u) = -0.44520960987339  LUMO (Ag) = -0.0826198965911273
cycle= 3 E= -75.1846477232623  delta_E= -0.00115  |g|= 0.0156  |ddm|= 0.166
HOMO (B1u) = -0.447439744130487  LUMO (Ag) = -0.0899048584713145
cycle= 4 E= -75.1847993820882  delta_E= -0.000152  |g|= 0.00222  |ddm|= 0.0841
HOMO (B1u) = -0.44798498189054  LUMO (Ag) = -0.0913127106239845
cycle= 5 E= -75.1848027365252  delta_E= -3.35e-06  |g|= 0.00041  |ddm|= 0.016
HOMO (B1u) = -0.447956467884104  LUMO (Ag) = -0.0912347091259279
cycle= 6 E= -75.1848028483201  delta_E= -1.12e-07  |g|= 2.74e-05  |ddm|= 0.00219
HOMO (B1u) = -0.447959917478172  LUMO (Ag) = -0.0912398214370537
cycle= 7 E= -75.184802848724  delta_E= -4.04e-10  |g|= 1.64e-06  |ddm|= 0.00057
HOMO (B1u) = -0.447959903825146  LUMO (Ag) = -0.0912392511183108
cycle= 8 E= -75.184802848725  delta_E= -9.95e-13  |g|= 1.46e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.44795989940642  LUMO (Ag) = -0.0912392910110385
cycle= 9 E= -75.184802848725  delta_E=    0  |g|= 1.12e-08  |ddm|= 1.31e-06
HOMO (B1u) = -0.447959898993814  LUMO (Ag) = -0.0912392858216832
cycle= 10 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 5.76e-09  |ddm|= 8.39e-08
HOMO (B1u) = -0.447959899021927  LUMO (Ag) = -0.0912392855932005
cycle= 11 E= -75.184802848725  delta_E= -1.14e-13  |g|= 6.47e-10  |ddm|= 4.13e-08
HOMO (B1u) = -0.447959899083249  LUMO (Ag) = -0.0912392856766099
cycle= 12 E= -75.184802848725  delta_E= 5.68e-14  |g|= 4.28e-10  |ddm|= 2.03e-09
HOMO (B1u) = -0.447959899095205  LUMO (Ag) = -0.0912392857450856
cycle= 13 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 3.44e-10  |ddm|= 1.02e-09
HOMO (B1u) = -0.447959899058544  LUMO (Ag) = -0.0912392856781638
cycle= 14 E= -75.1848028487251  delta_E= -1.42e-13  |g|= 3.33e-10  |ddm|= 1.77e-09
HOMO (B1u) = -0.447959899026874  LUMO (Ag) = -0.0912392856307714
cycle= 15 E= -75.184802848725  delta_E= 8.53e-14  |g|= 3.79e-10  |ddm|= 4.34e-09
HOMO (B1u) = -0.44795989901964  LUMO (Ag) = -0.0912392856908909
cycle= 16 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 4.14e-10  |ddm|= 8.86e-09
HOMO (B1u) = -0.447959899082588  LUMO (Ag) = -0.0912392857468329
cycle= 17 E= -75.184802848725  delta_E= -8.53e-14  |g|= 4.4e-10  |ddm|= 7.32e-10
HOMO (B1u) = -0.44795989914608  LUMO (Ag) = -0.0912392857760519
cycle= 18 E= -75.1848028487249  delta_E= 8.53e-14  |g|= 1.99e-10  |ddm|= 3.46e-09
HOMO (B1u) = -0.447959899128313  LUMO (Ag) = -0.0912392857552865
cycle= 19 E= -75.184802848725  delta_E= -8.53e-14  |g|= 6.58e-11  |ddm|= 1.01e-09
HOMO (B1u) = -0.447959899122039  LUMO (Ag) = -0.0912392857491914
cycle= 20 E= -75.184802848725  delta_E= 5.68e-14  |g|= 5.37e-11  |ddm|= 6.72e-11
HOMO (B1u) = -0.447959899118453  LUMO (Ag) = -0.0912392857460846
cycle= 21 E= -75.184802848725  delta_E=    0  |g|= 4.77e-11  |ddm|= 2.83e-11
HOMO (B1u) = -0.447959899106806  LUMO (Ag) = -0.091239285726031
Extra cycle  E= -75.184802848725  delta_E=    0  |g|= 1.34e-11  |ddm|= 1.48e-10
converged SCF energy = -75.184802848725

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpskm7fw3r
max_memory 4000 MB (current use 440 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3350875235243  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3504688257659  dE = -0.015381302  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3642209415696  dE = -0.013752116  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0334  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3762543887676  dE = -0.012033447  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|=0.0229  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3841494399193  dE = -0.0078950512  S^2 = 0.0000000
               |grad[o]|=0.0782  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3894371369694  dE = -0.0052876971  S^2 = 0.0000000
               |grad[o]|=0.0619  |ddm|=0.00584  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3935806154479  dE = -0.0041434785  S^2 = 0.0000000
               |grad[o]|=0.0506  |ddm|=0.0029  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3970259711923  dE = -0.0034453557  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.00187  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3999303987038  dE = -0.0029044275  S^2 = 0.0000000
               |grad[o]|=0.0343  |ddm|=0.00135  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4023575425763  dE = -0.0024271439  S^2 = 0.0000000
               |grad[o]|=0.0279  |ddm|=0.00128  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4043337729432  dE = -0.0019762304  S^2 = 0.0000000
               |grad[o]|=0.0223  |ddm|=0.00152  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4058726065067  dE = -0.0015388336  S^2 = 0.0000000
               |grad[o]|=0.0173  |ddm|=0.00192  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4069843919814  dE = -0.0011117855  S^2 = 0.0000000
               |grad[o]|=0.0127  |ddm|=0.00237  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4076787725493  dE = -0.00069438057  S^2 = 0.0000000
               |grad[o]|=0.00858  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 14 (5 JK  0 micro), CASSCF E = -75.4079303578331  dE = -0.00025158528  S^2 = 0.0000000
               |grad[o]|=0.00476  |ddm|=0.00338  |maxRot[o]|=0.0599
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4079625114613  dE = -3.2153628e-05  S^2 = 0.0000000
               |grad[o]|=0.00199  |ddm|=0.0033  |maxRot[o]|= 0.02
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4079663374753  dE = -3.826014e-06  S^2 = 0.0000000
               |grad[o]|=0.000823  |ddm|=0.00183  |maxRot[o]|=0.00719
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4079664742542  dE = -1.3677897e-07  S^2 = 0.0000000
               |grad[o]|=0.000218  |ddm|=0.00105  |maxRot[o]|=0.00136
macro iter 18 (3 JK  0 micro), CASSCF E = -75.407966480525  dE = -6.2707528e-09  S^2 = 0.0000000
               |grad[o]|=5.52e-05  |ddm|=0.000306  |maxRot[o]|=0.000269
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4079664808389  dE = -3.1387515e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.59e-05  |maxRot[o]|=5.69e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.407966480855  dE = -1.6143531e-11  S^2 = 0.0000000
               |grad[o]|=3.35e-06  |ddm|=1.8e-05  |maxRot[o]|=1.26e-05
2-step CASSCF converged in 20 macro (100 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99071502 1.94427775 1.94427796 1.40690755 0.59110188 0.05781808
 0.05781831 0.00708345]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00011   0.00000   0.00000   0.00165  -0.00303
  0 C 2s       0.56693  -0.00000   0.00000   0.41981  -0.41934
  0 C 3s      -0.05883   0.00000   0.00000   0.01056  -0.04125
  0 C 2px      0.00000  -0.00000   0.70357  -0.00000  -0.00000
  0 C 2py      0.00000   0.70357  -0.00000   0.00000   0.00000
  0 C 2pz      0.41060   0.00000   0.00000  -0.56869   0.56692
  0 C 3px      0.00000  -0.00000  -0.05731  -0.00000  -0.00000
  0 C 3py      0.00000  -0.05731  -0.00000  -0.00000   0.00000
  0 C 3pz     -0.06180   0.00000   0.00000  -0.01234  -0.02899
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.04122  -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.05218   0.00000   0.00000   0.00930   0.01419
  0 C 3dxz     0.00000  -0.00000   0.04122  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s      -0.00011   0.00000   0.00000  -0.00165  -0.00303
  1 C 2s       0.56693  -0.00000  -0.00000  -0.41981  -0.41934
  1 C 3s      -0.05883  -0.00000  -0.00000  -0.01056  -0.04125
  1 C 2px     -0.00000  -0.00000   0.70357   0.00000   0.00000
  1 C 2py     -0.00000   0.70357   0.00000   0.00000  -0.00000
  1 C 2pz     -0.41060  -0.00000   0.00000  -0.56869  -0.56692
  1 C 3px     -0.00000   0.00000  -0.05731   0.00000   0.00000
  1 C 3py     -0.00000  -0.05731   0.00000   0.00000  -0.00000
  1 C 3pz      0.06180   0.00000   0.00000  -0.01234   0.02899
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.04122  -0.00000  -0.00000   0.00000
  1 C 3dz^2    0.05218   0.00000  -0.00000  -0.00930   0.01419
  1 C 3dxz     0.00000  -0.00000  -0.04122  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00113
  0 C 2s       0.00000  -0.00000   0.56365
  0 C 3s       0.00000  -0.00000  -0.05372
  0 C 2px      0.70531   0.00000   0.00000
  0 C 2py      0.00000   0.70531   0.00000
  0 C 2pz      0.00000   0.00000   0.41389
  0 C 3px     -0.04437   0.00000   0.00000
  0 C 3py      0.00000  -0.04437   0.00000
  0 C 3pz      0.00000  -0.00000  -0.01152
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02384   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.08932
  0 C 3dxz    -0.02384   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00113
  1 C 2s      -0.00000  -0.00000  -0.56365
  1 C 3s      -0.00000   0.00000   0.05372
  1 C 2px     -0.70531  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70531  -0.00000
  1 C 2pz      0.00000  -0.00000   0.41389
  1 C 3px      0.04437  -0.00000  -0.00000
  1 C 3py     -0.00000   0.04437  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.01152
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02384   0.00000
  1 C 3dz^2   -0.00000   0.00000   0.08932
  1 C 3dxz    -0.02384   0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99647819
<CAS-nat-orb|mo-hf>  4  4    0.99985488
<CAS-nat-orb|mo-hf>  5  5    0.99985488
<CAS-nat-orb|mo-hf>  6  6    0.99860559
<CAS-nat-orb|mo-hf>  7  7    0.98449183
<CAS-nat-orb|mo-hf>  8  8    0.85083670
<CAS-nat-orb|mo-hf>  8  15   -0.52116437
<CAS-nat-orb|mo-hf>  9  9    0.85083700
<CAS-nat-orb|mo-hf>  9  16   -0.52116393
<CAS-nat-orb|mo-hf>  10  20   -0.78474240
CASSCF energy = -75.407966480855
CASCI E = -75.407966480855  E(CI) = -19.3366965246025  S^2 = 0.0000000
......production of RDMs took       5.18 sec
......reading the RDM took          0.45 sec
......production of RDMs took      44.91 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.98 sec

E(WickICMRREPT2-ijrs) =    -0.00061299732883
E(WickICMRREPT2- rsi) =    -0.00156045265788
E(WickICMRREPT2- ijr) =    -0.00055440571284
E(WickICMRREPT2-  rs) =    -0.05767915997778
E(WickICMRREPT2-  ij) =    -0.00016462724319
E(WickICMRREPT2-  ir) =    -0.00162428823528
E(WickICMRREPT2-   r) =    -0.04344788896831
E(WickICMRREPT2-   i) =    -0.00037879992224
E(WickICMRREPT2) = -75.51398910090137  E_corr_pt = -0.1060226200463558
Timings = pdms =   60.62 | eris =    0.18 | ijrs =    1.19 | rsi =   35.40 | ijr =    0.42 | rs =  790.95 | ij =    1.59 | ir =   33.33 | r =  160.95 | i =    2.30 | total = 1087.06
Time cost =   1524.348
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:01:07 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.005436700748 AA    0.000000000000   0.000000000000   1.900000000000 Bohr   0.0

nuclear repulsion = 18.9473684210526
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   0.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     36303.34


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp84j4gt3l
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.031041178399

WARN: Singularity detected in overlap matrix (condition number = 1.52e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.394985537155229  LUMO (Ag) = -0.222680456230756
cycle= 1 E= -75.2198455234798  delta_E= 0.811  |g|= 0.173  |ddm|= 1.61
HOMO (B1u) = -0.479415237903266  LUMO (Ag) = -0.109973136342065
cycle= 2 E= -75.2305447304663  delta_E= -0.0107  |g|= 0.0546  |ddm|= 0.201
HOMO (B1u) = -0.45253596463535  LUMO (Ag) = -0.0860888408725832
cycle= 3 E= -75.2315902210701  delta_E= -0.00105  |g|= 0.0153  |ddm|= 0.145
HOMO (B1u) = -0.454103263824989  LUMO (Ag) = -0.0925462170063896
cycle= 4 E= -75.2317373690303  delta_E= -0.000147  |g|= 0.00222  |ddm|= 0.0805
HOMO (B1u) = -0.454675048897531  LUMO (Ag) = -0.0940058731975908
cycle= 5 E= -75.2317407777114  delta_E= -3.41e-06  |g|= 0.0004  |ddm|= 0.0162
HOMO (B1u) = -0.454646635749827  LUMO (Ag) = -0.093935742736116
cycle= 6 E= -75.231740884219  delta_E= -1.07e-07  |g|= 2.7e-05  |ddm|= 0.00191
HOMO (B1u) = -0.454651041484013  LUMO (Ag) = -0.093941357568931
cycle= 7 E= -75.2317408846096  delta_E= -3.91e-10  |g|= 1.59e-06  |ddm|= 0.000529
HOMO (B1u) = -0.454650997156097  LUMO (Ag) = -0.0939408954914064
cycle= 8 E= -75.2317408846106  delta_E= -9.52e-13  |g|= 1.33e-07  |ddm|= 2.94e-05
HOMO (B1u) = -0.454650997886313  LUMO (Ag) = -0.0939409273873791
cycle= 9 E= -75.2317408846106  delta_E= -4.26e-14  |g|= 9.79e-09  |ddm|= 1.1e-06
HOMO (B1u) = -0.454650996883593  LUMO (Ag) = -0.0939409222271537
cycle= 10 E= -75.2317408846106  delta_E= 4.26e-14  |g|= 6.07e-09  |ddm|= 5.23e-08
HOMO (B1u) = -0.454650997030528  LUMO (Ag) = -0.0939409223312134
cycle= 11 E= -75.2317408846107  delta_E= -9.95e-14  |g|= 6.17e-10  |ddm|= 4.13e-08
HOMO (B1u) = -0.454650997089346  LUMO (Ag) = -0.0939409224042785
cycle= 12 E= -75.2317408846106  delta_E= 8.53e-14  |g|= 4.23e-10  |ddm|= 1.29e-09
HOMO (B1u) = -0.454650997135475  LUMO (Ag) = -0.0939409225105569
cycle= 13 E= -75.2317408846107  delta_E= -1.14e-13  |g|= 3.33e-10  |ddm|= 1.12e-09
HOMO (B1u) = -0.454650997067337  LUMO (Ag) = -0.0939409224303402
cycle= 14 E= -75.2317408846106  delta_E= 8.53e-14  |g|= 3.48e-10  |ddm|= 4.65e-10
HOMO (B1u) = -0.454650997042505  LUMO (Ag) = -0.0939409223985498
cycle= 15 E= -75.2317408846107  delta_E= -5.68e-14  |g|= 3.63e-10  |ddm|= 3.53e-09
HOMO (B1u) = -0.454650997048244  LUMO (Ag) = -0.0939409224489634
cycle= 16 E= -75.2317408846106  delta_E= 8.53e-14  |g|= 3.74e-10  |ddm|= 5.21e-09
HOMO (B1u) = -0.45465099712357  LUMO (Ag) = -0.0939409225146619
cycle= 17 E= -75.2317408846107  delta_E= -5.68e-14  |g|= 4.25e-10  |ddm|= 9.93e-10
HOMO (B1u) = -0.454650997190541  LUMO (Ag) = -0.0939409225488345
cycle= 18 E= -75.2317408846106  delta_E= 9.95e-14  |g|= 2.26e-10  |ddm|= 2.6e-09
HOMO (B1u) = -0.454650997164081  LUMO (Ag) = -0.0939409225223626
cycle= 19 E= -75.2317408846107  delta_E= -9.95e-14  |g|= 6.98e-11  |ddm|= 9.44e-10
HOMO (B1u) = -0.454650997157641  LUMO (Ag) = -0.0939409225160359
cycle= 20 E= -75.2317408846106  delta_E= 4.26e-14  |g|= 5.76e-11  |ddm|= 5.69e-11
HOMO (B1u) = -0.454650997153327  LUMO (Ag) = -0.0939409225122697
cycle= 21 E= -75.2317408846107  delta_E= -4.26e-14  |g|= 5.14e-11  |ddm|= 3.28e-11
HOMO (B1u) = -0.45465099715214  LUMO (Ag) = -0.0939409225100117
cycle= 22 E= -75.2317408846107  delta_E= -5.68e-14  |g|= 4.59e-11  |ddm|= 2.69e-11
HOMO (B1u) = -0.454650997150701  LUMO (Ag) = -0.0939409225076636
cycle= 23 E= -75.2317408846106  delta_E= 1.14e-13  |g|= 4.38e-11  |ddm|= 5.16e-11
HOMO (B1u) = -0.454650997147292  LUMO (Ag) = -0.0939409225024927
cycle= 24 E= -75.2317408846106  delta_E=    0  |g|= 3.76e-11  |ddm|= 6.59e-11
HOMO (B1u) = -0.454650997143533  LUMO (Ag) = -0.0939409224930359
Extra cycle  E= -75.2317408846106  delta_E= -2.84e-14  |g|= 1.12e-11  |ddm|= 2.03e-10
converged SCF energy = -75.2317408846106

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp84j4gt3l
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3834026666706  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3993895848539  dE = -0.015986918  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4135906582445  dE = -0.014201073  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0352  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4257782864185  dE = -0.012187628  S^2 = 0.0000000
               |grad[o]|=0.0987  |ddm|=0.0239  |maxRot[o]|=0.0787
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4331189769229  dE = -0.0073406905  S^2 = 0.0000000
               |grad[o]|=0.0761  |ddm|=0.0138  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4382735035141  dE = -0.0051545266  S^2 = 0.0000000
               |grad[o]|=0.0608  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4423993057216  dE = -0.0041258022  S^2 = 0.0000000
               |grad[o]|=0.0498  |ddm|=0.00272  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.445859171641  dE = -0.0034598659  S^2 = 0.0000000
               |grad[o]|=0.041  |ddm|=0.00177  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4487792714711  dE = -0.0029200998  S^2 = 0.0000000
               |grad[o]|=0.0336  |ddm|=0.00136  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4512079271185  dE = -0.0024286556  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.0014  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4531618944728  dE = -0.0019539674  S^2 = 0.0000000
               |grad[o]|=0.0215  |ddm|=0.00171  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.454648633247  dE = -0.0014867388  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4556742881749  dE = -0.0010256549  S^2 = 0.0000000
               |grad[o]|=0.0116  |ddm|=0.00257  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4562441920423  dE = -0.00056990387  S^2 = 0.0000000
               |grad[o]|=0.00729  |ddm|=0.00302  |maxRot[o]|=0.0799
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4563598636574  dE = -0.00011567162  S^2 = 0.0000000
               |grad[o]|=0.00332  |ddm|=0.00358  |maxRot[o]|= 0.04
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4563704248438  dE = -1.0561186e-05  S^2 = 0.0000000
               |grad[o]|=0.00121  |ddm|=0.00264  |maxRot[o]|=0.0119
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4563707480076  dE = -3.2316379e-07  S^2 = 0.0000000
               |grad[o]|=0.000318  |ddm|=0.00143  |maxRot[o]|=0.0021
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4563707613041  dE = -1.3296514e-08  S^2 = 0.0000000
               |grad[o]|=7.84e-05  |ddm|=0.000437  |maxRot[o]|=0.000394
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4563707619119  dE = -6.0778405e-10  S^2 = 0.0000000
               |grad[o]|=1.84e-05  |ddm|=0.000103  |maxRot[o]|=7.85e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.4563707619436  dE = -3.1675995e-11  S^2 = 0.0000000
               |grad[o]|=4.3e-06  |ddm|=2.69e-05  |maxRot[o]|=1.7e-05
2-step CASSCF converged in 19 macro (96 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99022072 1.93998158 1.93998139 1.43110666 0.56650847 0.06231568
 0.06231547 0.00757003]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00012   0.00000   0.00000   0.00176  -0.00276
  0 C 2s       0.56879   0.00000   0.00000   0.43063  -0.41683
  0 C 3s      -0.05868   0.00000   0.00000   0.01038  -0.03881
  0 C 2px     -0.00000   0.00000   0.70409  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70409   0.00000   0.00000   0.00000
  0 C 2pz      0.40833   0.00000   0.00000  -0.56057   0.56889
  0 C 3px     -0.00000   0.00000  -0.05130  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.05130  -0.00000   0.00000  -0.00000
  0 C 3pz     -0.06076   0.00000  -0.00000  -0.01148  -0.03034
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.04026  -0.00000   0.00000  -0.00000
  0 C 3dz^2    0.05111   0.00000   0.00000   0.00848   0.01325
  0 C 3dxz    -0.00000   0.00000   0.04026  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00012   0.00000   0.00000  -0.00176  -0.00276
  1 C 2s       0.56879  -0.00000  -0.00000  -0.43063  -0.41683
  1 C 3s      -0.05868  -0.00000  -0.00000  -0.01038  -0.03881
  1 C 2px      0.00000  -0.00000   0.70409   0.00000   0.00000
  1 C 2py      0.00000   0.70409   0.00000   0.00000   0.00000
  1 C 2pz     -0.40833  -0.00000   0.00000  -0.56057  -0.56889
  1 C 3px      0.00000  -0.00000  -0.05130   0.00000   0.00000
  1 C 3py      0.00000  -0.05130   0.00000  -0.00000   0.00000
  1 C 3pz      0.06076   0.00000   0.00000  -0.01148   0.03034
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.04026  -0.00000   0.00000  -0.00000
  1 C 3dz^2    0.05111  -0.00000  -0.00000  -0.00848   0.01325
  1 C 3dxz    -0.00000   0.00000  -0.04026  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00109
  0 C 2s       0.00000   0.00000   0.55672
  0 C 3s      -0.00000   0.00000  -0.05173
  0 C 2px      0.70549  -0.00000   0.00000
  0 C 2py      0.00000   0.70549   0.00000
  0 C 2pz      0.00000  -0.00000   0.42574
  0 C 3px     -0.04149  -0.00000   0.00000
  0 C 3py     -0.00000  -0.04149   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01023
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02382   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.07763
  0 C 3dxz    -0.02382  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00109
  1 C 2s      -0.00000  -0.00000  -0.55672
  1 C 3s       0.00000  -0.00000   0.05173
  1 C 2px     -0.70549  -0.00000  -0.00000
  1 C 2py      0.00000  -0.70549   0.00000
  1 C 2pz      0.00000   0.00000   0.42574
  1 C 3px      0.04149   0.00000  -0.00000
  1 C 3py     -0.00000   0.04149  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01023
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.07763
  1 C 3dxz    -0.02382  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99637510
<CAS-nat-orb|mo-hf>  4  4    0.99985872
<CAS-nat-orb|mo-hf>  5  5    0.99985872
<CAS-nat-orb|mo-hf>  6  6    0.99864216
<CAS-nat-orb|mo-hf>  7  7    0.98400069
<CAS-nat-orb|mo-hf>  8  8    0.86287874
<CAS-nat-orb|mo-hf>  8  15   -0.50178852
<CAS-nat-orb|mo-hf>  9  9    0.86287859
<CAS-nat-orb|mo-hf>  9  16   -0.50178877
<CAS-nat-orb|mo-hf>  10  20   -0.76833543
CASSCF energy = -75.4563707619436
CASCI E = -75.4563707619436  E(CI) = -19.1577865200117  S^2 = 0.0000000
......production of RDMs took       6.90 sec
......reading the RDM took          0.42 sec
......production of RDMs took      23.11 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.19 sec

E(WickICMRREPT2-ijrs) =    -0.00055462196943
E(WickICMRREPT2- rsi) =    -0.00149135854795
E(WickICMRREPT2- ijr) =    -0.00053482321880
E(WickICMRREPT2-  rs) =    -0.05757334941151
E(WickICMRREPT2-  ij) =    -0.00016829242086
E(WickICMRREPT2-  ir) =    -0.00159443757922
E(WickICMRREPT2-   r) =    -0.04417794611878
E(WickICMRREPT2-   i) =    -0.00037285938258
E(WickICMRREPT2) = -75.56283845059274  E_corr_pt = -0.1064676886491326
Timings = pdms =   41.74 | eris =    0.05 | ijrs =    1.19 | rsi =   31.89 | ijr =    0.42 | rs =  602.88 | ij =    1.24 | ir =   23.69 | r =  138.92 | i =    3.13 | total =  845.22
Time cost =    934.783
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:16:41 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.031895561294 AA    0.000000000000   0.000000000000   1.950000000000 Bohr   0.0

nuclear repulsion = 18.4615384615385
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     49610.09


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpyfwt1sep
max_memory 4000 MB (current use 398 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9746920535549

WARN: Singularity detected in overlap matrix (condition number = 1.36e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.376946372482714  LUMO (Ag) = -0.217906597905048
cycle= 1 E= -75.2586399523511  delta_E= 0.716  |g|= 0.174  |ddm|=  1.6
HOMO (B1u) = -0.487753910327477  LUMO (Ag) = -0.114938505564517
cycle= 2 E= -75.2693410539255  delta_E= -0.0107  |g|= 0.0537  |ddm|= 0.193
HOMO (B1u) = -0.459920537702704  LUMO (Ag) = -0.0893203899470904
cycle= 3 E= -75.2703049843485  delta_E= -0.000964  |g|= 0.0148  |ddm|= 0.127
HOMO (B1u) = -0.460845458131851  LUMO (Ag) = -0.0948990398153122
cycle= 4 E= -75.2704430756293  delta_E= -0.000138  |g|= 0.00223  |ddm|= 0.0758
HOMO (B1u) = -0.461426494056181  LUMO (Ag) = -0.0963896216507956
cycle= 5 E= -75.2704465290254  delta_E= -3.45e-06  |g|= 0.00039  |ddm|= 0.0164
HOMO (B1u) = -0.461398372411749  LUMO (Ag) = -0.0963285783601079
cycle= 6 E= -75.2704466300319  delta_E= -1.01e-07  |g|= 2.67e-05  |ddm|= 0.00163
HOMO (B1u) = -0.461403601387679  LUMO (Ag) = -0.096334626636981
cycle= 7 E= -75.2704466304108  delta_E= -3.79e-10  |g|= 1.62e-06  |ddm|= 0.000491
HOMO (B1u) = -0.461403547807351  LUMO (Ag) = -0.0963342779054471
cycle= 8 E= -75.2704466304119  delta_E= -1.02e-12  |g|= 1.22e-07  |ddm|= 2.97e-05
HOMO (B1u) = -0.461403551923741  LUMO (Ag) = -0.0963343022395622
cycle= 9 E= -75.2704466304118  delta_E= 8.53e-14  |g|= 8.39e-09  |ddm|= 9.29e-07
HOMO (B1u) = -0.461403550344776  LUMO (Ag) = -0.0963342976554561
cycle= 10 E= -75.2704466304118  delta_E= -5.68e-14  |g|= 6.38e-09  |ddm|= 2.39e-08
HOMO (B1u) = -0.461403550622183  LUMO (Ag) = -0.0963342981012678
cycle= 11 E= -75.2704466304118  delta_E= 5.68e-14  |g|= 6.04e-10  |ddm|= 3.93e-08
HOMO (B1u) = -0.461403550608748  LUMO (Ag) = -0.0963342980684494
cycle= 12 E= -75.2704466304118  delta_E= -4.26e-14  |g|= 4.09e-10  |ddm|= 1.16e-09
HOMO (B1u) = -0.461403550672676  LUMO (Ag) = -0.0963342982116019
cycle= 13 E= -75.2704466304119  delta_E= -5.68e-14  |g|= 3.34e-10  |ddm|= 5.96e-10
HOMO (B1u) = -0.461403550607781  LUMO (Ag) = -0.0963342981381795
cycle= 14 E= -75.2704466304118  delta_E= 7.11e-14  |g|= 3.69e-10  |ddm|= 5.04e-10
HOMO (B1u) = -0.461403550577526  LUMO (Ag) = -0.096334298120936
cycle= 15 E= -75.2704466304118  delta_E= -1.42e-14  |g|= 3.74e-10  |ddm|= 1.66e-09
HOMO (B1u) = -0.461403550633847  LUMO (Ag) = -0.0963342981802203
cycle= 16 E= -75.2704466304119  delta_E= -7.11e-14  |g|= 3.35e-10  |ddm|= 1.69e-09
HOMO (B1u) = -0.46140355069893  LUMO (Ag) = -0.0963342982350755
cycle= 17 E= -75.2704466304119  delta_E= -4.26e-14  |g|= 4.08e-10  |ddm|= 8.56e-10
HOMO (B1u) = -0.461403550758258  LUMO (Ag) = -0.0963342982660345
cycle= 18 E= -75.2704466304118  delta_E= 1.14e-13  |g|= 2.45e-10  |ddm|= 1.74e-09
HOMO (B1u) = -0.461403550724113  LUMO (Ag) = -0.0963342982347805
cycle= 19 E= -75.2704466304119  delta_E= -1.28e-13  |g|= 7.11e-11  |ddm|= 8.42e-10
HOMO (B1u) = -0.461403550718942  LUMO (Ag) = -0.096334298229342
cycle= 20 E= -75.2704466304119  delta_E= 2.84e-14  |g|= 5.91e-11  |ddm|= 5.18e-11
HOMO (B1u) = -0.461403550714118  LUMO (Ag) = -0.0963342982249798
cycle= 21 E= -75.2704466304119  delta_E= -1.42e-14  |g|= 5.47e-11  |ddm|= 2.72e-11
HOMO (B1u) = -0.461403550713054  LUMO (Ag) = -0.0963342982221087
cycle= 22 E= -75.2704466304119  delta_E= 1.42e-14  |g|= 4.88e-11  |ddm|= 4.06e-11
HOMO (B1u) = -0.461403550711577  LUMO (Ag) = -0.0963342982187762
cycle= 23 E= -75.2704466304119  delta_E= 4.26e-14  |g|= 4.48e-11  |ddm|= 7.71e-11
HOMO (B1u) = -0.461403550708685  LUMO (Ag) = -0.0963342982122574
cycle= 24 E= -75.2704466304118  delta_E= 4.26e-14  |g|= 3.74e-11  |ddm|= 2.65e-11
HOMO (B1u) = -0.461403550706573  LUMO (Ag) = -0.0963342982069582
cycle= 25 E= -75.2704466304118  delta_E= 1.42e-14  |g|= 2.86e-11  |ddm|= 6.29e-11
HOMO (B1u) = -0.461403550704868  LUMO (Ag) = -0.09633429820319
cycle= 26 E= -75.2704466304118  delta_E= -2.84e-14  |g|= 1.73e-11  |ddm|= 7.25e-11
HOMO (B1u) = -0.461403550705189  LUMO (Ag) = -0.0963342982037879
cycle= 27 E= -75.2704466304119  delta_E= -7.11e-14  |g|= 1.26e-11  |ddm|= 2.4e-11
HOMO (B1u) = -0.461403550705775  LUMO (Ag) = -0.0963342982041579
cycle= 28 E= -75.2704466304119  delta_E= 5.68e-14  |g|= 1.1e-11  |ddm|= 1.11e-11
HOMO (B1u) = -0.461403550706259  LUMO (Ag) = -0.0963342982043392
cycle= 29 E= -75.2704466304118  delta_E= 2.84e-14  |g|= 9.45e-12  |ddm|= 1.09e-11
HOMO (B1u) = -0.461403550706635  LUMO (Ag) = -0.0963342982042931
cycle= 30 E= -75.2704466304118  delta_E= 2.84e-14  |g|= 7.86e-12  |ddm|= 1.15e-11
HOMO (B1u) = -0.461403550706949  LUMO (Ag) = -0.096334298204219
cycle= 31 E= -75.2704466304118  delta_E= -1.42e-14  |g|= 6.45e-12  |ddm|= 1.04e-11
HOMO (B1u) = -0.461403550707134  LUMO (Ag) = -0.0963342982040209
cycle= 32 E= -75.2704466304119  delta_E= -7.11e-14  |g|= 5e-12  |ddm|= 7.62e-12
HOMO (B1u) = -0.461403550707166  LUMO (Ag) = -0.0963342982037569
cycle= 33 E= -75.2704466304119  delta_E=    0  |g|= 3.85e-12  |ddm|= 6.37e-12
HOMO (B1u) = -0.461403550706964  LUMO (Ag) = -0.0963342982028157
Extra cycle  E= -75.2704466304119  delta_E=    0  |g|= 1.44e-12  |ddm|= 1.37e-11
converged SCF energy = -75.2704466304119

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpyfwt1sep
max_memory 4000 MB (current use 407 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4235309438955  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4401210587432  dE = -0.016590115  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4547605537284  dE = -0.014639495  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0372  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4667277364413  dE = -0.011967183  S^2 = 0.0000000
               |grad[o]|=0.0972  |ddm|=0.0249  |maxRot[o]|=0.0768
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4737200303929  dE = -0.006992294  S^2 = 0.0000000
               |grad[o]|=0.0746  |ddm|=0.0134  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4788108825606  dE = -0.0050908522  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.00488  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4829510186755  dE = -0.0041401361  S^2 = 0.0000000
               |grad[o]|=0.0492  |ddm|=0.00261  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4864411680227  dE = -0.0034901493  S^2 = 0.0000000
               |grad[o]|=0.0404  |ddm|=0.00172  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4893827145162  dE = -0.0029415465  S^2 = 0.0000000
               |grad[o]|=0.0329  |ddm|=0.00144  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4918101615275  dE = -0.002427447  S^2 = 0.0000000
               |grad[o]|=0.0264  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4937310871256  dE = -0.0019209256  S^2 = 0.0000000
               |grad[o]|=0.0205  |ddm|=0.00194  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4951471168331  dE = -0.0014160297  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00236  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4960600252717  dE = -0.00091290844  S^2 = 0.0000000
               |grad[o]|=0.0103  |ddm|=0.00278  |maxRot[o]|=0.0799
macro iter 13 (5 JK  0 micro), CASSCF E = -75.4964166725572  dE = -0.00035664729  S^2 = 0.0000000
               |grad[o]|=0.00583  |ddm|=0.00322  |maxRot[o]|=0.0599
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4964898899758  dE = -7.3217419e-05  S^2 = 0.0000000
               |grad[o]|=0.0026  |ddm|=0.00297  |maxRot[o]|=0.0347
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4964915888358  dE = -1.69886e-06  S^2 = 0.0000000
               |grad[o]|=0.000643  |ddm|=0.00246  |maxRot[o]|=0.00494
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4964916480309  dE = -5.9195088e-08  S^2 = 0.0000000
               |grad[o]|=0.000153  |ddm|=0.000803  |maxRot[o]|=0.000856
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4964916504786  dE = -2.4477202e-09  S^2 = 0.0000000
               |grad[o]|=3.6e-05  |ddm|=0.000218  |maxRot[o]|=0.000159
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4964916505853  dE = -1.0676615e-10  S^2 = 0.0000000
               |grad[o]|=8.02e-06  |ddm|=4.83e-05  |maxRot[o]|=3.2e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.4964916505898  dE = -4.4337867e-12  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=1.09e-05  |maxRot[o]|=6.69e-06
2-step CASSCF converged in 19 macro (95 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98968842 1.93548132 1.93548121 1.45436124 0.54286927 0.0670143
 0.06701424 0.00808999]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00041   0.00000   0.00000   0.00186  -0.00251
  0 C 2s       0.57092   0.00000   0.00000   0.44116  -0.41394
  0 C 3s      -0.05831   0.00000  -0.00000   0.01019  -0.03618
  0 C 2px      0.00000   0.00000   0.70454  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70454   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40572  -0.00000  -0.00000  -0.55236   0.57112
  0 C 3px      0.00000  -0.00000  -0.04561  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04561  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05958   0.00000  -0.00000  -0.01065  -0.03168
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.03931  -0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04991   0.00000  -0.00000   0.00767   0.01244
  0 C 3dxz     0.00000  -0.00000   0.03931  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00041   0.00000   0.00000  -0.00186  -0.00251
  1 C 2s       0.57092  -0.00000   0.00000  -0.44116  -0.41394
  1 C 3s      -0.05831  -0.00000   0.00000  -0.01019  -0.03618
  1 C 2px     -0.00000   0.00000   0.70454  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70454   0.00000   0.00000   0.00000
  1 C 2pz     -0.40572  -0.00000   0.00000  -0.55236  -0.57112
  1 C 3px     -0.00000  -0.00000  -0.04561   0.00000   0.00000
  1 C 3py      0.00000  -0.04561  -0.00000   0.00000   0.00000
  1 C 3pz      0.05958   0.00000   0.00000  -0.01065   0.03168
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03931   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04991  -0.00000  -0.00000  -0.00767   0.01244
  1 C 3dxz     0.00000   0.00000  -0.03931  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00105
  0 C 2s       0.00000   0.00000   0.54938
  0 C 3s      -0.00000  -0.00000  -0.04995
  0 C 2px      0.70564  -0.00000   0.00000
  0 C 2py     -0.00000   0.70564   0.00000
  0 C 2pz      0.00000  -0.00000   0.43709
  0 C 3px     -0.03887  -0.00000   0.00000
  0 C 3py     -0.00000  -0.03887  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.00850
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02381   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.06762
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00105
  1 C 2s       0.00000   0.00000  -0.54938
  1 C 3s      -0.00000   0.00000   0.04995
  1 C 2px     -0.70564   0.00000  -0.00000
  1 C 2py      0.00000  -0.70564  -0.00000
  1 C 2pz     -0.00000   0.00000   0.43709
  1 C 3px      0.03887   0.00000  -0.00000
  1 C 3py      0.00000   0.03887  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.00850
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02381   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.06762
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99625189
<CAS-nat-orb|mo-hf>  4  4    0.99986004
<CAS-nat-orb|mo-hf>  5  5    0.99986004
<CAS-nat-orb|mo-hf>  6  6    0.99867026
<CAS-nat-orb|mo-hf>  7  7    0.98348638
<CAS-nat-orb|mo-hf>  8  8    0.87399692
<CAS-nat-orb|mo-hf>  8  15   -0.48288163
<CAS-nat-orb|mo-hf>  9  9    0.87399683
<CAS-nat-orb|mo-hf>  9  16   -0.48288177
<CAS-nat-orb|mo-hf>  10  17    0.40709983
<CAS-nat-orb|mo-hf>  10  20   -0.75070510
CASSCF energy = -75.4964916505898
CASCI E = -75.4964916505898  E(CI) = -18.982189390355  S^2 = 0.0000000
......production of RDMs took       2.42 sec
......reading the RDM took          0.42 sec
......production of RDMs took      28.69 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.70 sec

E(WickICMRREPT2-ijrs) =    -0.00050532897990
E(WickICMRREPT2- rsi) =    -0.00142780656536
E(WickICMRREPT2- ijr) =    -0.00051637245641
E(WickICMRREPT2-  rs) =    -0.05741199838269
E(WickICMRREPT2-  ij) =    -0.00017066713924
E(WickICMRREPT2-  ir) =    -0.00156588013714
E(WickICMRREPT2-   r) =    -0.04491973403456
E(WickICMRREPT2-   i) =    -0.00036657337967
E(WickICMRREPT2) = -75.60337601166475  E_corr_pt = -0.1068843610749729
Timings = pdms =   41.25 | eris =    0.18 | ijrs =    1.15 | rsi =   32.95 | ijr =    0.42 | rs =  597.16 | ij =    1.27 | ir =   24.32 | r =  141.07 | i =    2.29 | total =  842.13
Time cost =    962.387
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:32:44 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.058354421840 AA    0.000000000000   0.000000000000   2.000000000000 Bohr   0.0

nuclear repulsion = 18
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 1.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     62998.15


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpfr_ijcld
max_memory 4000 MB (current use 455 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9170535172816

WARN: Singularity detected in overlap matrix (condition number = 1.22e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.359902883841541  LUMO (Ag) = -0.213307043039729
cycle= 1 E= -75.2901241201449  delta_E= 0.627  |g|= 0.175  |ddm|= 1.58
HOMO (B1u) = -0.496094054564503  LUMO (Ag) = -0.119573071329234
cycle= 2 E= -75.3009349666094  delta_E= -0.0108  |g|= 0.0531  |ddm|= 0.188
HOMO (B1u) = -0.467321073254815  LUMO (Ag) = -0.0923011554436205
cycle= 3 E= -75.3018357121932  delta_E= -0.000901  |g|= 0.0141  |ddm|= 0.113
HOMO (B1u) = -0.467647600574112  LUMO (Ag) = -0.096988977910651
cycle= 4 E= -75.3019617797126  delta_E= -0.000126  |g|= 0.00222  |ddm|= 0.0704
HOMO (B1u) = -0.468220968325748  LUMO (Ag) = -0.0984869419679134
cycle= 5 E= -75.3019652459276  delta_E= -3.47e-06  |g|= 0.000378  |ddm|= 0.0164
HOMO (B1u) = -0.46819349031278  LUMO (Ag) = -0.098436674232338
cycle= 6 E= -75.3019653408537  delta_E= -9.49e-08  |g|= 2.64e-05  |ddm|= 0.00134
HOMO (B1u) = -0.468199393066112  LUMO (Ag) = -0.0984431261473151
cycle= 7 E= -75.3019653412215  delta_E= -3.68e-10  |g|= 1.72e-06  |ddm|= 0.000455
HOMO (B1u) = -0.468199353870886  LUMO (Ag) = -0.0984428907847606
cycle= 8 E= -75.3019653412226  delta_E= -1.11e-12  |g|= 1.15e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.468199359870019  LUMO (Ag) = -0.0984429094351387
cycle= 9 E= -75.3019653412226  delta_E= -7.11e-14  |g|= 7.49e-09  |ddm|= 7.76e-07
HOMO (B1u) = -0.468199357848098  LUMO (Ag) = -0.0984429054924176
cycle= 10 E= -75.3019653412226  delta_E=    0  |g|= 6.66e-09  |ddm|= 7.71e-09
HOMO (B1u) = -0.468199358185264  LUMO (Ag) = -0.0984429061618571
cycle= 11 E= -75.3019653412226  delta_E=    0  |g|= 5.93e-10  |ddm|= 3.47e-08
HOMO (B1u) = -0.468199358208925  LUMO (Ag) = -0.0984429061872587
cycle= 12 E= -75.3019653412226  delta_E= 1.42e-14  |g|= 3.97e-10  |ddm|= 1.41e-09
HOMO (B1u) = -0.468199358242183  LUMO (Ag) = -0.0984429062764268
cycle= 13 E= -75.3019653412226  delta_E=    0  |g|= 3.48e-10  |ddm|= 2.7e-10
HOMO (B1u) = -0.468199358197204  LUMO (Ag) = -0.0984429062219766
cycle= 14 E= -75.3019653412227  delta_E= -4.26e-14  |g|= 3.53e-10  |ddm|= 6.19e-10
HOMO (B1u) = -0.468199358148399  LUMO (Ag) = -0.098442906202913
cycle= 15 E= -75.3019653412227  delta_E= -7.11e-14  |g|= 3.78e-10  |ddm|= 3.66e-10
HOMO (B1u) = -0.468199358196697  LUMO (Ag) = -0.0984429062287342
cycle= 16 E= -75.3019653412226  delta_E= 1.14e-13  |g|= 2.94e-10  |ddm|= 1.11e-09
HOMO (B1u) = -0.46819935828486  LUMO (Ag) = -0.0984429063012017
cycle= 17 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 4.07e-10  |ddm|= 1.24e-09
HOMO (B1u) = -0.46819935833217  LUMO (Ag) = -0.0984429063252388
cycle= 18 E= -75.3019653412227  delta_E= -8.53e-14  |g|= 2.62e-10  |ddm|= 1.08e-09
HOMO (B1u) = -0.468199358291611  LUMO (Ag) = -0.0984429062904595
cycle= 19 E= -75.3019653412228  delta_E= -1.14e-13  |g|= 7.3e-11  |ddm|= 7.02e-10
HOMO (B1u) = -0.468199358286787  LUMO (Ag) = -0.0984429062851549
cycle= 20 E= -75.3019653412226  delta_E= 1.99e-13  |g|= 6.2e-11  |ddm|= 5.13e-11
HOMO (B1u) = -0.468199358283501  LUMO (Ag) = -0.0984429062817096
cycle= 21 E= -75.3019653412227  delta_E= -1.14e-13  |g|= 5.63e-11  |ddm|= 2.34e-11
HOMO (B1u) = -0.468199358282758  LUMO (Ag) = -0.0984429062789515
cycle= 22 E= -75.3019653412227  delta_E= 5.68e-14  |g|= 4.94e-11  |ddm|= 4.29e-11
HOMO (B1u) = -0.468199358281406  LUMO (Ag) = -0.0984429062756431
cycle= 23 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 4.3e-11  |ddm|= 7.55e-11
HOMO (B1u) = -0.46819935827964  LUMO (Ag) = -0.0984429062694732
cycle= 24 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 3.56e-11  |ddm|= 7.57e-11
HOMO (B1u) = -0.468199358278177  LUMO (Ag) = -0.0984429062650219
cycle= 25 E= -75.3019653412226  delta_E= 1.14e-13  |g|= 2.94e-11  |ddm|= 3.72e-11
HOMO (B1u) = -0.468199358276789  LUMO (Ag) = -0.0984429062621321
cycle= 26 E= -75.3019653412226  delta_E= 1.42e-14  |g|= 1.8e-11  |ddm|= 4.88e-11
HOMO (B1u) = -0.468199358277021  LUMO (Ag) = -0.0984429062627073
cycle= 27 E= -75.3019653412226  delta_E=    0  |g|= 1.3e-11  |ddm|= 1.96e-11
HOMO (B1u) = -0.468199358278731  LUMO (Ag) = -0.098442906262382
Extra cycle  E= -75.3019653412226  delta_E= -4.26e-14  |g|= 4.39e-12  |ddm|= 5.23e-11
converged SCF energy = -75.3019653412226

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpfr_ijcld
max_memory 4000 MB (current use 455 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4565254955846  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4737144570946  dE = -0.017188962  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4887834484652  dE = -0.015068991  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0393  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5003060217245  dE = -0.011522573  S^2 = 0.0000000
               |grad[o]|=0.0957  |ddm|=0.0259  |maxRot[o]|=0.0796
macro iter 4 (6 JK  0 micro), CASSCF E = -75.507081998183  dE = -0.0067759765  S^2 = 0.0000000
               |grad[o]|=0.0736  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5121575579456  dE = -0.0050755598  S^2 = 0.0000000
               |grad[o]|=0.0594  |ddm|=0.00472  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5163346570723  dE = -0.0041770991  S^2 = 0.0000000
               |grad[o]|=0.0486  |ddm|=0.00258  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5198644587883  dE = -0.0035298017  S^2 = 0.0000000
               |grad[o]|=0.0398  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5228265644904  dE = -0.0029621057  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5252425480813  dE = -0.0024159836  S^2 = 0.0000000
               |grad[o]|=0.0255  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5271105830051  dE = -0.0018680349  S^2 = 0.0000000
               |grad[o]|=0.0195  |ddm|=0.0022  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5284265138566  dE = -0.0013159309  S^2 = 0.0000000
               |grad[o]|=0.0139  |ddm|=0.00263  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5291872115169  dE = -0.00076069766  S^2 = 0.0000000
               |grad[o]|=0.00884  |ddm|=0.00303  |maxRot[o]|=0.0798
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5293600926688  dE = -0.00017288115  S^2 = 0.0000000
               |grad[o]|=0.00412  |ddm|=0.00349  |maxRot[o]|= 0.04
macro iter 14 (3 JK  0 micro), CASSCF E = -75.52938940292  dE = -2.9310251e-05  S^2 = 0.0000000
               |grad[o]|=0.00174  |ddm|=0.00233  |maxRot[o]|=0.0197
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5293900629004  dE = -6.599804e-07  S^2 = 0.0000000
               |grad[o]|=0.000421  |ddm|=0.00168  |maxRot[o]|=0.00302
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5293900845571  dE = -2.1656632e-08  S^2 = 0.0000000
               |grad[o]|=9.61e-05  |ddm|=0.000516  |maxRot[o]|=0.000499
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5293900854118  dE = -8.5474028e-10  S^2 = 0.0000000
               |grad[o]|=2.13e-05  |ddm|=0.000131  |maxRot[o]|=9.08e-05
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5293900854452  dE = -3.3352876e-11  S^2 = 0.0000000
               |grad[o]|=4.17e-06  |ddm|=2.58e-05  |maxRot[o]|=1.78e-05
2-step CASSCF converged in 18 macro (91 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98911928 1.93077483 1.93077463 1.47651509 0.52034969 0.07191178
 0.07191156 0.00864315]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00076   0.00000   0.00000   0.00197  -0.00230
  0 C 2s       0.57327  -0.00000  -0.00000   0.45141  -0.41073
  0 C 3s      -0.05772  -0.00000   0.00000   0.00999  -0.03341
  0 C 2px     -0.00000   0.00000   0.70492   0.00000   0.00000
  0 C 2py     -0.00000   0.70492   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40282  -0.00000   0.00000  -0.54404   0.57355
  0 C 3px     -0.00000   0.00000  -0.04022   0.00000  -0.00000
  0 C 3py      0.00000  -0.04022  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05831  -0.00000   0.00000  -0.00984  -0.03298
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.03836   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04862  -0.00000   0.00000   0.00687   0.01178
  0 C 3dxz    -0.00000   0.00000   0.03836   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00076   0.00000   0.00000  -0.00197  -0.00230
  1 C 2s       0.57327   0.00000  -0.00000  -0.45141  -0.41073
  1 C 3s      -0.05772   0.00000  -0.00000  -0.00999  -0.03341
  1 C 2px      0.00000  -0.00000   0.70492  -0.00000   0.00000
  1 C 2py      0.00000   0.70492   0.00000   0.00000  -0.00000
  1 C 2pz     -0.40282   0.00000   0.00000  -0.54404  -0.57355
  1 C 3px      0.00000  -0.00000  -0.04022  -0.00000  -0.00000
  1 C 3py      0.00000  -0.04022  -0.00000   0.00000   0.00000
  1 C 3pz      0.05831  -0.00000   0.00000  -0.00984   0.03298
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03836   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04862   0.00000  -0.00000  -0.00687   0.01178
  1 C 3dxz    -0.00000   0.00000  -0.03836   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00101
  0 C 2s      -0.00000  -0.00000   0.54172
  0 C 3s       0.00000  -0.00000  -0.04839
  0 C 2px      0.70576   0.00000   0.00000
  0 C 2py      0.00000   0.70576  -0.00000
  0 C 2pz     -0.00000   0.00000   0.44796
  0 C 3px     -0.03649  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03649  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00649
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02381  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.05909
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00101
  1 C 2s      -0.00000   0.00000  -0.54172
  1 C 3s      -0.00000   0.00000   0.04839
  1 C 2px     -0.70576   0.00000   0.00000
  1 C 2py      0.00000  -0.70576  -0.00000
  1 C 2pz      0.00000   0.00000   0.44796
  1 C 3px      0.03649   0.00000  -0.00000
  1 C 3py     -0.00000   0.03649   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00649
  1 C 3dxy    -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02381  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.05909
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99610894
<CAS-nat-orb|mo-hf>  4  4    0.99985893
<CAS-nat-orb|mo-hf>  5  5    0.99985893
<CAS-nat-orb|mo-hf>  6  6    0.99868925
<CAS-nat-orb|mo-hf>  7  7    0.98295349
<CAS-nat-orb|mo-hf>  8  8    0.88422779
<CAS-nat-orb|mo-hf>  8  15   -0.46451022
<CAS-nat-orb|mo-hf>  9  9    0.88422763
<CAS-nat-orb|mo-hf>  9  16   -0.46451050
<CAS-nat-orb|mo-hf>  10  17    0.44059927
<CAS-nat-orb|mo-hf>  10  20   -0.73158934
CASSCF energy = -75.5293900854452
CASCI E = -75.5293900854452  E(CI) = -18.8101054540093  S^2 = 0.0000000
......production of RDMs took       2.01 sec
......reading the RDM took          0.42 sec
......production of RDMs took      22.43 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickICMRREPT2-ijrs) =    -0.00046377964854
E(WickICMRREPT2- rsi) =    -0.00136969577623
E(WickICMRREPT2- ijr) =    -0.00049931328143
E(WickICMRREPT2-  rs) =    -0.05720017221575
E(WickICMRREPT2-  ij) =    -0.00017179627420
E(WickICMRREPT2-  ir) =    -0.00153853611534
E(WickICMRREPT2-   r) =    -0.04567084076444
E(WickICMRREPT2-   i) =    -0.00036006410681
E(WickICMRREPT2) = -75.63666428362791  E_corr_pt = -0.1072741981827551
Timings = pdms =   34.58 | eris =    0.16 | ijrs =    1.17 | rsi =   31.79 | ijr =    0.42 | rs =  605.18 | ij =    1.27 | ir =   23.53 | r =  139.98 | i =    2.28 | total =  840.43
Time cost =    988.296
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:49:12 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.084813282386 AA    0.000000000000   0.000000000000   2.050000000000 Bohr   0.0

nuclear repulsion = 17.5609756097561
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     76495.55


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpn5jm_4bo
max_memory 4000 MB (current use 399 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8587717717965

WARN: Singularity detected in overlap matrix (condition number = 1.1e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.343801090949932  LUMO (Ag) = -0.208899636382795
cycle= 1 E= -75.3152287127074  delta_E= 0.544  |g|= 0.177  |ddm|= 1.56
HOMO (B1u) = -0.504407518465328  LUMO (Ag) = -0.123879990102773
cycle= 2 E= -75.3262515819531  delta_E= -0.011  |g|= 0.0526  |ddm|= 0.188
HOMO (B1u) = -0.474708360691123  LUMO (Ag) = -0.0950218080877913
cycle= 3 E= -75.3271055696138  delta_E= -0.000854  |g|= 0.0134  |ddm|= 0.101
HOMO (B1u) = -0.474494822450147  LUMO (Ag) = -0.0988363835418897
cycle= 4 E= -75.3272181663453  delta_E= -0.000113  |g|= 0.00221  |ddm|= 0.0646
HOMO (B1u) = -0.475044448091172  LUMO (Ag) = -0.100314895198609
cycle= 5 E= -75.3272215916787  delta_E= -3.43e-06  |g|= 0.000363  |ddm|= 0.0164
HOMO (B1u) = -0.475018098728986  LUMO (Ag) = -0.100277615221354
cycle= 6 E= -75.3272216794876  delta_E= -8.78e-08  |g|= 2.61e-05  |ddm|= 0.00103
HOMO (B1u) = -0.475024517384054  LUMO (Ag) = -0.100284470661351
cycle= 7 E= -75.3272216798442  delta_E= -3.57e-10  |g|= 1.87e-06  |ddm|= 0.000419
HOMO (B1u) = -0.47502451200041  LUMO (Ag) = -0.100284344431208
cycle= 8 E= -75.3272216798456  delta_E= -1.36e-12  |g|= 1.12e-07  |ddm|= 3.22e-05
HOMO (B1u) = -0.47502451873384  LUMO (Ag) = -0.100284359326981
cycle= 9 E= -75.3272216798457  delta_E= -1.28e-13  |g|= 7.12e-09  |ddm|= 6.36e-07
HOMO (B1u) = -0.475024516367287  LUMO (Ag) = -0.100284355794239
cycle= 10 E= -75.3272216798456  delta_E= 8.53e-14  |g|= 6.87e-09  |ddm|= 8.5e-09
HOMO (B1u) = -0.475024518412011  LUMO (Ag) = -0.100284358873463
cycle= 11 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 5.88e-09  |ddm|= 2.95e-08
HOMO (B1u) = -0.475024516775712  LUMO (Ag) = -0.100284356679239
cycle= 12 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 5.31e-10  |ddm|= 7.36e-09
HOMO (B1u) = -0.475024516799123  LUMO (Ag) = -0.100284356802882
cycle= 13 E= -75.3272216798456  delta_E= 4.26e-14  |g|= 5.07e-10  |ddm|= 1.04e-09
HOMO (B1u) = -0.475024516708679  LUMO (Ag) = -0.100284356707176
cycle= 14 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 5.54e-10  |ddm|= 1.35e-09
HOMO (B1u) = -0.475024516687475  LUMO (Ag) = -0.100284356712653
cycle= 15 E= -75.3272216798456  delta_E= -1.42e-14  |g|= 5.39e-10  |ddm|= 7.04e-10
HOMO (B1u) = -0.475024516758574  LUMO (Ag) = -0.100284356724985
cycle= 16 E= -75.3272216798456  delta_E= -1.42e-14  |g|= 4.21e-10  |ddm|= 3.69e-09
HOMO (B1u) = -0.475024516863865  LUMO (Ag) = -0.100284356807423
cycle= 17 E= -75.3272216798456  delta_E=    0  |g|= 5.73e-10  |ddm|= 1.26e-09
HOMO (B1u) = -0.475024516901211  LUMO (Ag) = -0.100284356826658
cycle= 18 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 4.2e-10  |ddm|= 6.16e-10
HOMO (B1u) = -0.475024516856496  LUMO (Ag) = -0.100284356792103
cycle= 19 E= -75.3272216798455  delta_E= 8.53e-14  |g|= 2.38e-10  |ddm|= 5.21e-10
HOMO (B1u) = -0.475024516881488  LUMO (Ag) = -0.100284356813003
cycle= 20 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 1.01e-10  |ddm|= 2.27e-10
HOMO (B1u) = -0.475024516877117  LUMO (Ag) = -0.100284356808578
cycle= 21 E= -75.3272216798457  delta_E= -9.95e-14  |g|= 9.38e-11  |ddm|= 3.27e-11
HOMO (B1u) = -0.475024516876432  LUMO (Ag) = -0.100284356803946
cycle= 22 E= -75.3272216798457  delta_E= -4.26e-14  |g|= 8.32e-11  |ddm|= 9.41e-11
HOMO (B1u) = -0.475024516874563  LUMO (Ag) = -0.100284356797427
cycle= 23 E= -75.3272216798456  delta_E= 9.95e-14  |g|= 7.3e-11  |ddm|= 1.57e-10
HOMO (B1u) = -0.475024516872738  LUMO (Ag) = -0.100284356788823
cycle= 24 E= -75.3272216798456  delta_E= -4.26e-14  |g|= 6.27e-11  |ddm|= 1.43e-10
HOMO (B1u) = -0.475024516870379  LUMO (Ag) = -0.100284356782737
cycle= 25 E= -75.3272216798456  delta_E=    0  |g|= 5.28e-11  |ddm|= 2.71e-11
HOMO (B1u) = -0.475024516868374  LUMO (Ag) = -0.100284356774759
Extra cycle  E= -75.3272216798457  delta_E= -5.68e-14  |g|= 1.56e-11  |ddm|= 1.16e-10
converged SCF energy = -75.3272216798457

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpn5jm_4bo
max_memory 4000 MB (current use 408 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4833111059065  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5010935166738  dE = -0.017782411  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5165854056278  dE = -0.015491889  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0415  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5274438859295  dE = -0.01085848  S^2 = 0.0000000
               |grad[o]|=0.0941  |ddm|=0.0269  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5341204754661  dE = -0.0066765895  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0121  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5392309343333  dE = -0.0051104589  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00475  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5434695377003  dE = -0.0042386034  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.00267  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5470496061462  dE = -0.0035800684  S^2 = 0.0000000
               |grad[o]|=0.0393  |ddm|=0.00189  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5500313213292  dE = -0.0029817152  S^2 = 0.0000000
               |grad[o]|=0.0315  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5524229991838  dE = -0.0023916779  S^2 = 0.0000000
               |grad[o]|=0.0245  |ddm|=0.0021  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5542142116978  dE = -0.0017912125  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.555394327271  dE = -0.0011801156  S^2 = 0.0000000
               |grad[o]|=0.0125  |ddm|=0.00293  |maxRot[o]|=0.0798
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5559531754055  dE = -0.00055884813  S^2 = 0.0000000
               |grad[o]|=0.0071  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5559945763548  dE = -4.1400949e-05  S^2 = 0.0000000
               |grad[o]|=0.00221  |ddm|=0.00383  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5559984928642  dE = -3.9165094e-06  S^2 = 0.0000000
               |grad[o]|=0.000816  |ddm|=0.00164  |maxRot[o]|=0.00745
macro iter 15 (3 JK  0 micro), CASSCF E = -75.555998589026  dE = -9.6161813e-08  S^2 = 0.0000000
               |grad[o]|=0.00018  |ddm|=0.000849  |maxRot[o]|=0.00111
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5559985922085  dE = -3.1825067e-09  S^2 = 0.0000000
               |grad[o]|=3.82e-05  |ddm|=0.000222  |maxRot[o]|=0.000183
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5559985923271  dE = -1.18618e-10  S^2 = 0.0000000
               |grad[o]|=8.07e-06  |ddm|=5.39e-05  |maxRot[o]|=3.39e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5559985923254  dE = 1.7905677e-12  S^2 = 0.0000000
               |grad[o]|=1.4e-06  |ddm|=5.57e-06  |maxRot[o]|=6.6e-06
2-step CASSCF converged in 18 macro (89 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98851474 1.9258584  1.92585834 1.49745706 0.49907021 0.07700636
 0.07700623 0.00922867]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00113   0.00000   0.00000   0.00208  -0.00211
  0 C 2s       0.57579   0.00000  -0.00000   0.46137  -0.40723
  0 C 3s      -0.05693  -0.00000  -0.00000   0.00979  -0.03053
  0 C 2px     -0.00000   0.00000   0.70524  -0.00000   0.00000
  0 C 2py      0.00000   0.70524   0.00000  -0.00000  -0.00000
  0 C 2pz      0.39967   0.00000   0.00000  -0.53564   0.57613
  0 C 3px     -0.00000   0.00000  -0.03513  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03513   0.00000   0.00000  -0.00000
  0 C 3pz     -0.05695  -0.00000   0.00000  -0.00906  -0.03424
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.03742   0.00000   0.00000  -0.00000
  0 C 3dz^2    0.04728  -0.00000   0.00000   0.00608   0.01129
  0 C 3dxz    -0.00000   0.00000   0.03742  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00113   0.00000   0.00000  -0.00208  -0.00211
  1 C 2s       0.57579   0.00000  -0.00000  -0.46137  -0.40723
  1 C 3s      -0.05693   0.00000   0.00000  -0.00979  -0.03053
  1 C 2px      0.00000  -0.00000   0.70524   0.00000   0.00000
  1 C 2py      0.00000   0.70524  -0.00000  -0.00000   0.00000
  1 C 2pz     -0.39967   0.00000  -0.00000  -0.53564  -0.57613
  1 C 3px      0.00000  -0.00000  -0.03513   0.00000  -0.00000
  1 C 3py      0.00000  -0.03513  -0.00000   0.00000   0.00000
  1 C 3pz      0.05695  -0.00000  -0.00000  -0.00906   0.03424
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.03742   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04728  -0.00000   0.00000  -0.00608   0.01129
  1 C 3dxz    -0.00000   0.00000  -0.03742  -0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00097
  0 C 2s      -0.00000   0.00000   0.53380
  0 C 3s      -0.00000   0.00000  -0.04704
  0 C 2px      0.70587   0.00000  -0.00000
  0 C 2py      0.00000   0.70587   0.00000
  0 C 2pz     -0.00000  -0.00000   0.45840
  0 C 3px     -0.03434   0.00000  -0.00000
  0 C 3py      0.00000  -0.03434  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.00431
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.05187
  0 C 3dxz    -0.02382  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00097
  1 C 2s       0.00000  -0.00000  -0.53380
  1 C 3s       0.00000  -0.00000   0.04704
  1 C 2px     -0.70587   0.00000   0.00000
  1 C 2py     -0.00000  -0.70587   0.00000
  1 C 2pz      0.00000   0.00000   0.45840
  1 C 3px      0.03434  -0.00000   0.00000
  1 C 3py     -0.00000   0.03434   0.00000
  1 C 3pz     -0.00000   0.00000  -0.00431
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.05187
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99594657
<CAS-nat-orb|mo-hf>  4  4    0.99985545
<CAS-nat-orb|mo-hf>  5  5    0.99985545
<CAS-nat-orb|mo-hf>  6  6    0.99869865
<CAS-nat-orb|mo-hf>  7  7    0.98240657
<CAS-nat-orb|mo-hf>  8  8    0.89361613
<CAS-nat-orb|mo-hf>  8  15   -0.44672576
<CAS-nat-orb|mo-hf>  9  9    0.89361609
<CAS-nat-orb|mo-hf>  9  16   -0.44672584
<CAS-nat-orb|mo-hf>  10  17    0.47419755
<CAS-nat-orb|mo-hf>  10  20   -0.71074878
CASSCF energy = -75.5559985923254
CASCI E = -75.5559985923254  E(CI) = -18.6416908978609  S^2 = 0.0000000
......production of RDMs took       2.05 sec
......reading the RDM took          0.43 sec
......production of RDMs took      29.49 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICMRREPT2-ijrs) =    -0.00042881535251
E(WickICMRREPT2- rsi) =    -0.00131682964711
E(WickICMRREPT2- ijr) =    -0.00048378033846
E(WickICMRREPT2-  rs) =    -0.05694246858678
E(WickICMRREPT2-  ij) =    -0.00017174553495
E(WickICMRREPT2-  ir) =    -0.00151233431158
E(WickICMRREPT2-   r) =    -0.04643195904672
E(WickICMRREPT2-   i) =    -0.00035342841316
E(WickICMRREPT2) = -75.66363995355661  E_corr_pt = -0.1076413612312559
Timings = pdms =   41.70 | eris =    0.04 | ijrs =    1.16 | rsi =   34.29 | ijr =    0.42 | rs =  614.67 | ij =    1.27 | ir =   22.64 | r =  141.97 | i =    2.27 | total =  860.50
Time cost =    961.530
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:05:14 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.111272142932 AA    0.000000000000   0.000000000000   2.100000000000 Bohr   0.0

nuclear repulsion = 17.1428571428571
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     90256.45


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpx_k1_9gp
max_memory 4000 MB (current use 455 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8003866027882

WARN: Singularity detected in overlap matrix (condition number =  999). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.328588944868891  LUMO (Ag) = -0.204693729619156
cycle= 1 E= -75.334780023076  delta_E= 0.466  |g|= 0.18  |ddm|= 1.55
HOMO (B1u) = -0.512671455628693  LUMO (Ag) = -0.127860887413401
cycle= 2 E= -75.3461091126339  delta_E= -0.0113  |g|= 0.0522  |ddm|= 0.19
HOMO (B1u) = -0.482062537885923  LUMO (Ag) = -0.0974769445191804
cycle= 3 E= -75.3469306677088  delta_E= -0.000822  |g|= 0.0126  |ddm|= 0.0913
HOMO (B1u) = -0.481374466024951  LUMO (Ag) = -0.100457341704974
cycle= 4 E= -75.3470296424032  delta_E= -9.9e-05  |g|= 0.00217  |ddm|= 0.0587
HOMO (B1u) = -0.481886259872505  LUMO (Ag) = -0.101886818572118
cycle= 5 E= -75.3470329570725  delta_E= -3.31e-06  |g|= 0.000344  |ddm|= 0.0161
HOMO (B1u) = -0.48186158361658  LUMO (Ag) = -0.101865081893001
cycle= 6 E= -75.3470330362213  delta_E= -7.91e-08  |g|= 2.58e-05  |ddm|= 0.000729
HOMO (B1u) = -0.481868355987191  LUMO (Ag) = -0.101872367771481
cycle= 7 E= -75.3470330365669  delta_E= -3.46e-10  |g|= 2.05e-06  |ddm|= 0.000385
HOMO (B1u) = -0.481868395860481  LUMO (Ag) = -0.101872342919466
cycle= 8 E= -75.3470330365686  delta_E= -1.69e-12  |g|= 1.14e-07  |ddm|= 3.34e-05
HOMO (B1u) = -0.481868402323088  LUMO (Ag) = -0.101872355526947
cycle= 9 E= -75.3470330365686  delta_E= 4.26e-14  |g|= 7.18e-09  |ddm|= 5.08e-07
HOMO (B1u) = -0.481868399647088  LUMO (Ag) = -0.101872352077138
cycle= 10 E= -75.3470330365686  delta_E= -5.68e-14  |g|= 7.12e-09  |ddm|= 1.1e-08
HOMO (B1u) = -0.481868400180351  LUMO (Ag) = -0.101872353252892
cycle= 11 E= -75.3470330365686  delta_E= 7.11e-14  |g|= 6.77e-10  |ddm|= 1.91e-08
HOMO (B1u) = -0.481868400158284  LUMO (Ag) = -0.101872353227169
cycle= 12 E= -75.3470330365686  delta_E=    0  |g|= 4.23e-10  |ddm|= 1.79e-09
HOMO (B1u) = -0.481868400193827  LUMO (Ag) = -0.101872353313001
cycle= 13 E= -75.3470330365687  delta_E= -1.28e-13  |g|= 4.16e-10  |ddm|= 8.45e-10
HOMO (B1u) = -0.481868400173717  LUMO (Ag) = -0.10187235327619
cycle= 14 E= -75.3470330365686  delta_E= 9.95e-14  |g|= 3.65e-10  |ddm|= 1.28e-10
HOMO (B1u) = -0.481868400169896  LUMO (Ag) = -0.101872353281382
cycle= 15 E= -75.3470330365685  delta_E= 4.26e-14  |g|= 3.31e-10  |ddm|= 1.97e-10
HOMO (B1u) = -0.48186840019739  LUMO (Ag) = -0.101872353279555
cycle= 16 E= -75.3470330365686  delta_E= -7.11e-14  |g|= 2.84e-10  |ddm|= 1.64e-09
HOMO (B1u) = -0.481868400273477  LUMO (Ag) = -0.101872353333577
cycle= 17 E= -75.3470330365685  delta_E= 9.95e-14  |g|= 4.37e-10  |ddm|= 7.97e-10
HOMO (B1u) = -0.481868400301402  LUMO (Ag) = -0.101872353344171
cycle= 18 E= -75.3470330365686  delta_E= -5.68e-14  |g|= 2.89e-10  |ddm|= 3.38e-10
HOMO (B1u) = -0.481868400250073  LUMO (Ag) = -0.101872353305419
cycle= 19 E= -75.3470330365686  delta_E= -5.68e-14  |g|= 7.87e-11  |ddm|= 4.09e-10
HOMO (B1u) = -0.481868400246934  LUMO (Ag) = -0.101872353300947
cycle= 20 E= -75.3470330365686  delta_E= 5.68e-14  |g|= 6.54e-11  |ddm|= 4.58e-11
HOMO (B1u) = -0.481868400245589  LUMO (Ag) = -0.101872353298301
cycle= 21 E= -75.3470330365686  delta_E= 1.42e-14  |g|= 5.91e-11  |ddm|= 1.56e-11
HOMO (B1u) = -0.481868400245992  LUMO (Ag) = -0.101872353295538
cycle= 22 E= -75.3470330365687  delta_E= -9.95e-14  |g|= 5e-11  |ddm|= 5.26e-11
HOMO (B1u) = -0.481868400245872  LUMO (Ag) = -0.101872353292676
cycle= 23 E= -75.3470330365686  delta_E= 5.68e-14  |g|= 4.27e-11  |ddm|= 5.72e-11
HOMO (B1u) = -0.48186840024609  LUMO (Ag) = -0.10187235328947
cycle= 24 E= -75.3470330365685  delta_E= 5.68e-14  |g|= 3.74e-11  |ddm|= 6.53e-11
HOMO (B1u) = -0.481868400245678  LUMO (Ag) = -0.101872353286954
cycle= 25 E= -75.3470330365686  delta_E= -2.84e-14  |g|= 3.16e-11  |ddm|= 1.5e-11
HOMO (B1u) = -0.481868400244606  LUMO (Ag) = -0.101872353285227
cycle= 26 E= -75.3470330365686  delta_E= -4.26e-14  |g|= 1.92e-11  |ddm|= 2.04e-11
HOMO (B1u) = -0.481868400244603  LUMO (Ag) = -0.101872353285777
cycle= 27 E= -75.3470330365686  delta_E= 2.84e-14  |g|= 1.3e-11  |ddm|= 1.35e-11
HOMO (B1u) = -0.48186840024495  LUMO (Ag) = -0.101872353285627
cycle= 28 E= -75.3470330365686  delta_E= -1.42e-14  |g|= 1.1e-11  |ddm|= 8.88e-12
HOMO (B1u) = -0.481868400245233  LUMO (Ag) = -0.101872353285396
cycle= 29 E= -75.3470330365686  delta_E=    0  |g|= 9.17e-12  |ddm|= 8.51e-12
HOMO (B1u) = -0.481868400245437  LUMO (Ag) = -0.101872353284098
Extra cycle  E= -75.3470330365686  delta_E= -1.42e-14  |g|= 2.99e-12  |ddm|= 2.11e-11
converged SCF energy = -75.3470330365686

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpx_k1_9gp
max_memory 4000 MB (current use 455 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5047007388539  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5230707816026  dE = -0.018370043  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5389823177183  dE = -0.015911536  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5492400907519  dE = -0.010257773  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0279  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5558470442068  dE = -0.0066069535  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5609995608474  dE = -0.0051525166  S^2 = 0.0000000
               |grad[o]|=0.0585  |ddm|=0.00486  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5652985944597  dE = -0.0042990336  S^2 = 0.0000000
               |grad[o]|=0.0476  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.568916465881  dE = -0.0036178714  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5718931659994  dE = -0.0029767001  S^2 = 0.0000000
               |grad[o]|=0.0304  |ddm|=0.00212  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5742225159328  dE = -0.0023293499  S^2 = 0.0000000
               |grad[o]|=0.0232  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.575884368727  dE = -0.0016618528  S^2 = 0.0000000
               |grad[o]|=0.0166  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5768610787165  dE = -0.00097670999  S^2 = 0.0000000
               |grad[o]|=0.0106  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 12 (5 JK  0 micro), CASSCF E = -75.5771323611594  dE = -0.00027128244  S^2 = 0.0000000
               |grad[o]|=0.00491  |ddm|=0.00368  |maxRot[o]|=0.0599
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5771370942203  dE = -4.7330609e-06  S^2 = 0.0000000
               |grad[o]|=0.00106  |ddm|=0.0034  |maxRot[o]|=0.00809
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5771372193369  dE = -1.2511661e-07  S^2 = 0.0000000
               |grad[o]|=0.000227  |ddm|=0.00107  |maxRot[o]|=0.00121
macro iter 15 (3 JK  0 micro), CASSCF E = -75.577137223395  dE = -4.0581227e-09  S^2 = 0.0000000
               |grad[o]|=4.47e-05  |ddm|=0.000274  |maxRot[o]|=0.000204
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5771372235463  dE = -1.5128876e-10  S^2 = 0.0000000
               |grad[o]|=8.73e-06  |ddm|=5.85e-05  |maxRot[o]|=3.68e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5771372235523  dE = -6.0538241e-12  S^2 = 0.0000000
               |grad[o]|=1.69e-06  |ddm|=1.21e-05  |maxRot[o]|=7.24e-06
2-step CASSCF converged in 17 macro (85 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98787579 1.9207281  1.92072834 1.51715844 0.47907021 0.08229648
 0.08229651 0.00984614]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00153   0.00000   0.00000   0.00220  -0.00194
  0 C 2s       0.57846  -0.00000  -0.00000   0.47106  -0.40350
  0 C 3s      -0.05596  -0.00000  -0.00000   0.00960  -0.02757
  0 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  0 C 2py      0.00000   0.70551  -0.00000  -0.00000   0.00000
  0 C 2pz      0.39631   0.00000  -0.00000  -0.52717   0.57883
  0 C 3px     -0.00000   0.00000  -0.03031   0.00000  -0.00000
  0 C 3py      0.00000  -0.03031  -0.00000   0.00000   0.00000
  0 C 3pz     -0.05553  -0.00000  -0.00000  -0.00832  -0.03544
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.03648  -0.00000   0.00000   0.00000
  0 C 3dz^2    0.04590  -0.00000  -0.00000   0.00531   0.01098
  0 C 3dxz     0.00000   0.00000   0.03648   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00153   0.00000   0.00000  -0.00220  -0.00194
  1 C 2s       0.57846   0.00000   0.00000  -0.47106  -0.40350
  1 C 3s      -0.05596   0.00000   0.00000  -0.00960  -0.02757
  1 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70551  -0.00000  -0.00000  -0.00000
  1 C 2pz     -0.39631   0.00000   0.00000  -0.52717  -0.57883
  1 C 3px     -0.00000   0.00000  -0.03031  -0.00000   0.00000
  1 C 3py     -0.00000  -0.03031   0.00000  -0.00000  -0.00000
  1 C 3pz      0.05553  -0.00000  -0.00000  -0.00832   0.03544
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.03648  -0.00000   0.00000   0.00000
  1 C 3dz^2    0.04590   0.00000   0.00000  -0.00531   0.01098
  1 C 3dxz     0.00000  -0.00000  -0.03648   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00092
  0 C 2s       0.00000  -0.00000   0.52568
  0 C 3s      -0.00000   0.00000  -0.04590
  0 C 2px      0.70596  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70596  -0.00000
  0 C 2pz     -0.00000   0.00000   0.46846
  0 C 3px     -0.03238  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03238   0.00000
  0 C 3pz     -0.00000   0.00000  -0.00204
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02383   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.04579
  0 C 3dxz    -0.02383  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00092
  1 C 2s       0.00000  -0.00000  -0.52568
  1 C 3s       0.00000  -0.00000   0.04590
  1 C 2px     -0.70596   0.00000   0.00000
  1 C 2py      0.00000  -0.70596  -0.00000
  1 C 2pz     -0.00000  -0.00000   0.46846
  1 C 3px      0.03238   0.00000   0.00000
  1 C 3py      0.00000   0.03238   0.00000
  1 C 3pz      0.00000   0.00000  -0.00204
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02383  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04579
  1 C 3dxz    -0.02383  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99576518
<CAS-nat-orb|mo-hf>  4  4    0.99984965
<CAS-nat-orb|mo-hf>  5  5    0.99984965
<CAS-nat-orb|mo-hf>  6  6    0.99869802
<CAS-nat-orb|mo-hf>  7  7    0.98184923
<CAS-nat-orb|mo-hf>  8  8    0.90221125
<CAS-nat-orb|mo-hf>  8  15   -0.42956745
<CAS-nat-orb|mo-hf>  9  9    0.90221129
<CAS-nat-orb|mo-hf>  9  16   -0.42956739
<CAS-nat-orb|mo-hf>  10  10    0.40783706
<CAS-nat-orb|mo-hf>  10  17    0.50741106
<CAS-nat-orb|mo-hf>  10  20   -0.68802314
CASSCF energy = -75.5771372235523
CASCI E = -75.5771372235523  E(CI) = -18.4770626177157  S^2 = 0.0000000
......production of RDMs took       2.74 sec
......reading the RDM took          0.41 sec
......production of RDMs took      26.57 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICMRREPT2-ijrs) =    -0.00039944761728
E(WickICMRREPT2- rsi) =    -0.00126895215049
E(WickICMRREPT2- ijr) =    -0.00046979191958
E(WickICMRREPT2-  rs) =    -0.05664300542263
E(WickICMRREPT2-  ij) =    -0.00017063016633
E(WickICMRREPT2-  ir) =    -0.00148719338721
E(WickICMRREPT2-   r) =    -0.04720421896737
E(WickICMRREPT2-   i) =    -0.00034674170206
E(WickICMRREPT2) = -75.68512720488529  E_corr_pt = -0.1079899813329499
Timings = pdms =   39.46 | eris =    0.19 | ijrs =    1.15 | rsi =   34.57 | ijr =    0.42 | rs =  646.87 | ij =    1.31 | ir =   28.15 | r =  143.18 | i =    2.28 | total =  897.64
Time cost =   1007.998
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:22:02 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.137731003478 AA    0.000000000000   0.000000000000   2.150000000000 Bohr   0.0

nuclear repulsion = 16.7441860465116
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    104834.37


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpygh50w7k
max_memory 4000 MB (current use 399 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.742346402077

WARN: Singularity detected in overlap matrix (condition number =  905). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.314216447683401  LUMO (Ag) = -0.20069252752058
cycle= 1 E= -75.349511035823  delta_E= 0.393  |g|= 0.183  |ddm|= 1.54
HOMO (B3u) = -0.511968787672977  LUMO (Ag) = -0.131517049931569
cycle= 2 E= -75.361230819294  delta_E= -0.0117  |g|= 0.052  |ddm|= 0.195
HOMO (B3u) = -0.477859245905663  LUMO (Ag) = -0.0996643076325113
cycle= 3 E= -75.3620321930707  delta_E= -0.000801  |g|= 0.0118  |ddm|= 0.0834
HOMO (B3u) = -0.480852254510821  LUMO (Ag) = -0.101863987618504
cycle= 4 E= -75.3621184017555  delta_E= -8.62e-05  |g|= 0.00212  |ddm|= 0.0529
HOMO (B3u) = -0.481684500444459  LUMO (Ag) = -0.103214149326985
cycle= 5 E= -75.3621215318461  delta_E= -3.13e-06  |g|= 0.000318  |ddm|= 0.0156
HOMO (B2u) = -0.481600836313237  LUMO (Ag) = -0.103210190493489
cycle= 6 E= -75.3621216003492  delta_E= -6.85e-08  |g|= 2.54e-05  |ddm|= 0.000515
HOMO (B2u) = -0.481601754909294  LUMO (Ag) = -0.103217967965926
cycle= 7 E= -75.3621216006849  delta_E= -3.36e-10  |g|= 2.23e-06  |ddm|= 0.00035
HOMO (B3u) = -0.481601987406631  LUMO (Ag) = -0.103218034520502
cycle= 8 E= -75.362121600687  delta_E= -2.06e-12  |g|= 1.23e-07  |ddm|= 3.4e-05
HOMO (B2u) = -0.481601999518237  LUMO (Ag) = -0.103218045660379
cycle= 9 E= -75.3621216006869  delta_E= 5.68e-14  |g|= 7.62e-09  |ddm|= 3.86e-07
HOMO (B2u) = -0.481601998065023  LUMO (Ag) = -0.103218041943851
cycle= 10 E= -75.362121600687  delta_E= -4.26e-14  |g|= 7.43e-09  |ddm|= 1.11e-08
HOMO (B2u) = -0.481601999779848  LUMO (Ag) = -0.103218043433837
cycle= 11 E= -75.3621216006869  delta_E= 1.42e-14  |g|= 7.26e-10  |ddm|= 1.25e-08
HOMO (B2u) = -0.481601999835438  LUMO (Ag) = -0.103218043443864
cycle= 12 E= -75.362121600687  delta_E= -2.84e-14  |g|= 4.93e-10  |ddm|= 1.74e-09
HOMO (B2u) = -0.481601999864944  LUMO (Ag) = -0.10321804348839
cycle= 13 E= -75.3621216006869  delta_E= 9.95e-14  |g|= 4.74e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.481601999856279  LUMO (Ag) = -0.103218043467574
cycle= 14 E= -75.3621216006869  delta_E= -4.26e-14  |g|= 3.96e-10  |ddm|= 4.29e-10
HOMO (B2u) = -0.48160199986718  LUMO (Ag) = -0.103218043467274
cycle= 15 E= -75.3621216006869  delta_E= -2.84e-14  |g|= 3.59e-10  |ddm|= 4.08e-10
HOMO (B2u) = -0.481601999837376  LUMO (Ag) = -0.103218043447011
cycle= 16 E= -75.362121600687  delta_E= -2.84e-14  |g|= 3.13e-10  |ddm|= 1.67e-09
HOMO (B2u) = -0.481601999853406  LUMO (Ag) = -0.103218043504916
cycle= 17 E= -75.3621216006869  delta_E= 5.68e-14  |g|= 4.63e-10  |ddm|= 8.32e-10
HOMO (B2u) = -0.48160199990188  LUMO (Ag) = -0.103218043509744
cycle= 18 E= -75.3621216006869  delta_E= -2.84e-14  |g|= 3.01e-10  |ddm|= 2.68e-10
HOMO (B2u) = -0.481601999878786  LUMO (Ag) = -0.10321804346877
cycle= 19 E= -75.3621216006869  delta_E=    0  |g|= 8.54e-11  |ddm|= 4.6e-10
HOMO (B3u) = -0.481601999870826  LUMO (Ag) = -0.103218043453301
Extra cycle  E= -75.362121600687  delta_E= -2.84e-14  |g|= 2.29e-11  |ddm|= 1.68e-10
converged SCF energy = -75.362121600687

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpygh50w7k
max_memory 4000 MB (current use 408 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5214099234426  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5403620704933  dE = -0.018952147  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5566943744707  dE = -0.016332304  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0461  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5664483853599  dE = -0.0097540109  S^2 = 0.0000000
               |grad[o]|=0.091  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5730073472907  dE = -0.0065589619  S^2 = 0.0000000
               |grad[o]|=0.0715  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5782102167534  dE = -0.0052028695  S^2 = 0.0000000
               |grad[o]|=0.0576  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5825630264574  dE = -0.0043528097  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.586197785325  dE = -0.0036347589  S^2 = 0.0000000
               |grad[o]|=0.0372  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5891324546782  dE = -0.0029346694  S^2 = 0.0000000
               |grad[o]|=0.0289  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5913444168696  dE = -0.0022119622  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5928029606045  dE = -0.0014585437  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5934808669138  dE = -0.00067790631  S^2 = 0.0000000
               |grad[o]|=0.00812  |ddm|=0.00368  |maxRot[o]|=0.0798
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5935226639146  dE = -4.1797001e-05  S^2 = 0.0000000
               |grad[o]|=0.00228  |ddm|=0.00417  |maxRot[o]|= 0.02
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5935273590429  dE = -4.6951284e-06  S^2 = 0.0000000
               |grad[o]|=0.000868  |ddm|=0.00146  |maxRot[o]|=0.00829
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5935274566682  dE = -9.7625275e-08  S^2 = 0.0000000
               |grad[o]|=0.000175  |ddm|=0.000804  |maxRot[o]|=0.00112
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5935274594337  dE = -2.7655176e-09  S^2 = 0.0000000
               |grad[o]|=3.37e-05  |ddm|=0.000201  |maxRot[o]|=0.000174
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5935274595312  dE = -9.7443831e-11  S^2 = 0.0000000
               |grad[o]|=6.88e-06  |ddm|=4.95e-05  |maxRot[o]|=3.08e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5935274595374  dE = -6.2243544e-12  S^2 = 0.0000000
               |grad[o]|=1.17e-06  |ddm|=9.29e-06  |maxRot[o]|=5.86e-06
2-step CASSCF converged in 17 macro (83 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98720383 1.53562464 1.91537959 1.91537976 0.46035405 0.08778176
 0.0877818  0.01049457]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00194   0.00231   0.00000   0.00000  -0.00179
  0 C 2s       0.58123   0.48048  -0.00000  -0.00000  -0.39956
  0 C 3s      -0.05483   0.00943  -0.00000  -0.00000  -0.02456
  0 C 2px      0.00000   0.00000   0.00000   0.70574   0.00000
  0 C 2py      0.00000  -0.00000   0.70574   0.00000   0.00000
  0 C 2pz      0.39276  -0.51862   0.00000  -0.00000   0.58162
  0 C 3px      0.00000   0.00000  -0.00000  -0.02575   0.00000
  0 C 3py     -0.00000   0.00000  -0.02575  -0.00000   0.00000
  0 C 3pz     -0.05404  -0.00761  -0.00000  -0.00000  -0.03659
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.03555  -0.00000   0.00000
  0 C 3dz^2    0.04451   0.00457  -0.00000  -0.00000   0.01083
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03555   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00194  -0.00231   0.00000   0.00000  -0.00179
  1 C 2s       0.58123  -0.48048   0.00000   0.00000  -0.39956
  1 C 3s      -0.05483  -0.00943   0.00000   0.00000  -0.02456
  1 C 2px      0.00000  -0.00000   0.00000   0.70574  -0.00000
  1 C 2py      0.00000  -0.00000   0.70574   0.00000  -0.00000
  1 C 2pz     -0.39276  -0.51862  -0.00000  -0.00000  -0.58162
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.02575  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02575  -0.00000  -0.00000
  1 C 3pz      0.05404  -0.00761  -0.00000  -0.00000   0.03659
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03555   0.00000   0.00000
  1 C 3dz^2    0.04451  -0.00457   0.00000   0.00000   0.01083
  1 C 3dxz     0.00000   0.00000   0.00000  -0.03555   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00088
  0 C 2s      -0.00000  -0.00000   0.51738
  0 C 3s      -0.00000  -0.00000  -0.04498
  0 C 2px      0.70604   0.00000  -0.00000
  0 C 2py      0.00000   0.70604  -0.00000
  0 C 2pz     -0.00000   0.00000   0.47816
  0 C 3px     -0.03061   0.00000  -0.00000
  0 C 3py      0.00000  -0.03061  -0.00000
  0 C 3pz     -0.00000   0.00000   0.00024
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.04072
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00088
  1 C 2s       0.00000  -0.00000  -0.51738
  1 C 3s       0.00000   0.00000   0.04498
  1 C 2px     -0.70604  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70604   0.00000
  1 C 2pz     -0.00000  -0.00000   0.47816
  1 C 3px      0.03061  -0.00000   0.00000
  1 C 3py     -0.00000   0.03061   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00024
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04072
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99556548
<CAS-nat-orb|mo-hf>  4  4    0.99868710
<CAS-nat-orb|mo-hf>  5  5    0.99984158
<CAS-nat-orb|mo-hf>  6  6    0.99984158
<CAS-nat-orb|mo-hf>  7  7    0.98128500
<CAS-nat-orb|mo-hf>  8  8    0.91006597
<CAS-nat-orb|mo-hf>  8  15   -0.41306115
<CAS-nat-orb|mo-hf>  9  9    0.91006596
<CAS-nat-orb|mo-hf>  9  16   -0.41306116
<CAS-nat-orb|mo-hf>  10  10    0.41868595
<CAS-nat-orb|mo-hf>  10  17    0.53963882
<CAS-nat-orb|mo-hf>  10  20   -0.66337400
CASSCF energy = -75.5935274595374
CASCI E = -75.5935274595374  E(CI) = -18.3163035802703  S^2 = 0.0000000
......production of RDMs took       2.01 sec
......reading the RDM took          0.45 sec
......production of RDMs took      26.18 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.70 sec

E(WickICMRREPT2-ijrs) =    -0.00037482647492
E(WickICMRREPT2- rsi) =    -0.00122575339492
E(WickICMRREPT2- ijr) =    -0.00045727570693
E(WickICMRREPT2-  rs) =    -0.05630571555079
E(WickICMRREPT2-  ij) =    -0.00016857477685
E(WickICMRREPT2-  ir) =    -0.00146304117961
E(WickICMRREPT2-   r) =    -0.04798917326555
E(WickICMRREPT2-   i) =    -0.00034006432026
E(WickICMRREPT2) = -75.70185188420723  E_corr_pt = -0.1083244246698333
Timings = pdms =   38.34 | eris =    0.05 | ijrs =    1.15 | rsi =   32.13 | ijr =    0.41 | rs =  593.22 | ij =    1.26 | ir =   24.11 | r =  153.77 | i =    2.38 | total =  846.87
Time cost =    938.577
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:37:40 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.164189864024 AA    0.000000000000   0.000000000000   2.200000000000 Bohr   0.0

nuclear repulsion = 16.3636363636364
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.1]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    118164.86


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp6rs8lty7
max_memory 4000 MB (current use 456 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6850211082767

WARN: Singularity detected in overlap matrix (condition number =  823). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.300635738182938  LUMO (Ag) = -0.196894745039133
cycle= 1 E= -75.3600714434764  delta_E= 0.325  |g|= 0.186  |ddm|= 1.52
HOMO (B2u) = -0.505767689307349  LUMO (Ag) = -0.134850139116738
cycle= 2 E= -75.3722557388853  delta_E= -0.0122  |g|= 0.0519  |ddm|= 0.201
HOMO (B2u) = -0.47104268602542  LUMO (Ag) = -0.101583923798027
cycle= 3 E= -75.3730472275436  delta_E= -0.000791  |g|= 0.011  |ddm|= 0.0769
HOMO (B2u) = -0.473583831878466  LUMO (Ag) = -0.103064436209409
cycle= 4 E= -75.3731222408077  delta_E= -7.5e-05  |g|= 0.00204  |ddm|= 0.0475
HOMO (B3u) = -0.474409949766168  LUMO (Ag) = -0.10430815949841
cycle= 5 E= -75.3731251255  delta_E= -2.88e-06  |g|= 0.000283  |ddm|= 0.0148
HOMO (B3u) = -0.474348151042958  LUMO (Ag) = -0.104322379442281
cycle= 6 E= -75.3731251811964  delta_E= -5.57e-08  |g|= 2.51e-05  |ddm|= 0.000586
HOMO (B3u) = -0.47434938826869  LUMO (Ag) = -0.104330764317111
cycle= 7 E= -75.3731251815251  delta_E= -3.29e-10  |g|= 2.41e-06  |ddm|= 0.000311
HOMO (B3u) = -0.474349685667023  LUMO (Ag) = -0.104330912577453
cycle= 8 E= -75.3731251815275  delta_E= -2.47e-12  |g|= 1.4e-07  |ddm|= 3.41e-05
HOMO (B2u) = -0.474349699392715  LUMO (Ag) = -0.104330922330293
cycle= 9 E= -75.3731251815274  delta_E= 1.14e-13  |g|= 8.38e-09  |ddm|= 2.86e-07
HOMO (B2u) = -0.474349697423584  LUMO (Ag) = -0.104330918012646
cycle= 10 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 7.65e-09  |ddm|= 1.04e-08
HOMO (B2u) = -0.474349699480334  LUMO (Ag) = -0.104330919900911
cycle= 11 E= -75.3731251815274  delta_E= -4.26e-14  |g|= 7.68e-10  |ddm|= 1.39e-08
HOMO (B2u) = -0.474349699600123  LUMO (Ag) = -0.104330919997358
cycle= 12 E= -75.3731251815274  delta_E= 7.11e-14  |g|= 5.98e-10  |ddm|= 2.64e-09
HOMO (B2u) = -0.474349699605339  LUMO (Ag) = -0.104330920002648
cycle= 13 E= -75.3731251815274  delta_E=    0  |g|= 5.31e-10  |ddm|= 1.22e-09
HOMO (B2u) = -0.47434969960567  LUMO (Ag) = -0.104330919990584
cycle= 14 E= -75.3731251815274  delta_E= -8.53e-14  |g|= 4.48e-10  |ddm|= 1.43e-10
HOMO (B2u) = -0.474349699620671  LUMO (Ag) = -0.104330919983889
cycle= 15 E= -75.3731251815274  delta_E=    0  |g|= 4.07e-10  |ddm|= 4.6e-10
HOMO (B2u) = -0.47434969958482  LUMO (Ag) = -0.104330919966253
cycle= 16 E= -75.3731251815274  delta_E= 8.53e-14  |g|= 3.47e-10  |ddm|= 1.43e-09
HOMO (B2u) = -0.474349699580318  LUMO (Ag) = -0.104330920005766
cycle= 17 E= -75.3731251815274  delta_E= -4.26e-14  |g|= 4.94e-10  |ddm|= 7.94e-10
HOMO (B2u) = -0.474349699624333  LUMO (Ag) = -0.104330920004025
cycle= 18 E= -75.3731251815273  delta_E= 5.68e-14  |g|= 3.14e-10  |ddm|= 3.54e-10
HOMO (B2u) = -0.474349699596337  LUMO (Ag) = -0.104330919959531
cycle= 19 E= -75.3731251815274  delta_E= -7.11e-14  |g|= 9.51e-11  |ddm|= 6.37e-10
HOMO (B3u) = -0.474349699591931  LUMO (Ag) = -0.104330919954845
cycle= 20 E= -75.3731251815274  delta_E=    0  |g|= 8.23e-11  |ddm|= 4.9e-11
HOMO (B3u) = -0.474349699594789  LUMO (Ag) = -0.104330919948528
Extra cycle  E= -75.3731251815274  delta_E=    0  |g|= 2.27e-11  |ddm|= 1.11e-10
converged SCF energy = -75.3731251815274

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp6rs8lty7
max_memory 4000 MB (current use 456 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5340692264402  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5535986408699  dE = -0.019529414  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5700765822616  dE = -0.016477941  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0484  |maxRot[o]|=0.0784
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5795456785777  dE = -0.0094690963  S^2 = 0.0000000
               |grad[o]|=0.0899  |ddm|=0.0297  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5861247361235  dE = -0.0065790575  S^2 = 0.0000000
               |grad[o]|=0.0707  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5914072638838  dE = -0.0052825278  S^2 = 0.0000000
               |grad[o]|=0.0568  |ddm|=0.00536  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5958190892018  dE = -0.0044118253  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5994552531679  dE = -0.003636164  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6023109144025  dE = -0.0028556612  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.00296  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043454280638  dE = -0.0020345137  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6054821882676  dE = -0.0011367602  S^2 = 0.0000000
               |grad[o]|=0.012  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 11 (5 JK  0 micro), CASSCF E = -75.6057915430669  dE = -0.0003093548  S^2 = 0.0000000
               |grad[o]|=0.00551  |ddm|=0.00398  |maxRot[o]|=0.0599
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6058040753454  dE = -1.2532278e-05  S^2 = 0.0000000
               |grad[o]|=0.00133  |ddm|=0.00326  |maxRot[o]|=0.0137
macro iter 13 (3 JK  0 micro), CASSCF E = -75.605804318559  dE = -2.4321356e-07  S^2 = 0.0000000
               |grad[o]|=0.000278  |ddm|=0.00116  |maxRot[o]|=0.00175
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6058043249415  dE = -6.382578e-09  S^2 = 0.0000000
               |grad[o]|=5.08e-05  |ddm|=0.000301  |maxRot[o]|=0.000267
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6058043251434  dE = -2.0182256e-10  S^2 = 0.0000000
               |grad[o]|=9.36e-06  |ddm|=6.66e-05  |maxRot[o]|=4.53e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.60580432515  dE = -6.5938366e-12  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=1.38e-05  |maxRot[o]|=8.56e-06
2-step CASSCF converged in 16 macro (79 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98650073 1.55290079 1.90980644 1.90980676 0.44288816 0.09346214
 0.09346204 0.01117293]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00235   0.00241   0.00000   0.00000  -0.00166
  0 C 2s       0.58410   0.48964  -0.00000  -0.00000  -0.39544
  0 C 3s      -0.05356   0.00927  -0.00000  -0.00000  -0.02152
  0 C 2px     -0.00000   0.00000   0.00000   0.70593   0.00000
  0 C 2py      0.00000  -0.00000   0.70593  -0.00000  -0.00000
  0 C 2pz      0.38903  -0.51000   0.00000  -0.00000   0.58448
  0 C 3px     -0.00000   0.00000   0.00000  -0.02144   0.00000
  0 C 3py      0.00000  -0.00000  -0.02144  -0.00000  -0.00000
  0 C 3pz     -0.05250  -0.00695  -0.00000  -0.00000  -0.03768
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03464  -0.00000  -0.00000
  0 C 3dz^2    0.04312   0.00386  -0.00000  -0.00000   0.01086
  0 C 3dxz    -0.00000   0.00000   0.00000   0.03464   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00235  -0.00241   0.00000   0.00000  -0.00166
  1 C 2s       0.58410  -0.48964   0.00000   0.00000  -0.39544
  1 C 3s      -0.05356  -0.00927   0.00000   0.00000  -0.02152
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70593  -0.00000
  1 C 2py      0.00000   0.00000   0.70593   0.00000   0.00000
  1 C 2pz     -0.38903  -0.51000   0.00000  -0.00000  -0.58448
  1 C 3px      0.00000  -0.00000  -0.00000  -0.02144  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02144   0.00000   0.00000
  1 C 3pz      0.05250  -0.00695  -0.00000  -0.00000   0.03768
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03464  -0.00000  -0.00000
  1 C 3dz^2    0.04312  -0.00386   0.00000   0.00000   0.01086
  1 C 3dxz    -0.00000   0.00000   0.00000  -0.03464   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00084
  0 C 2s      -0.00000  -0.00000   0.50895
  0 C 3s      -0.00000  -0.00000  -0.04424
  0 C 2px      0.70611   0.00000  -0.00000
  0 C 2py      0.00000   0.70611  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.48752
  0 C 3px     -0.02900   0.00000  -0.00000
  0 C 3py      0.00000  -0.02900  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00249
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03651
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00084
  1 C 2s       0.00000   0.00000  -0.50895
  1 C 3s       0.00000   0.00000   0.04424
  1 C 2px     -0.70611  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70611   0.00000
  1 C 2pz     -0.00000   0.00000   0.48752
  1 C 3px      0.02900  -0.00000   0.00000
  1 C 3py     -0.00000   0.02900   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00249
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.03651
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99534814
<CAS-nat-orb|mo-hf>  4  4    0.99866563
<CAS-nat-orb|mo-hf>  5  5    0.99983126
<CAS-nat-orb|mo-hf>  6  6    0.99983126
<CAS-nat-orb|mo-hf>  7  7    0.98071661
<CAS-nat-orb|mo-hf>  8  8    0.91723376
<CAS-nat-orb|mo-hf>  9  9    0.91723382
<CAS-nat-orb|mo-hf>  10  10    0.43078504
<CAS-nat-orb|mo-hf>  10  17    0.57019754
<CAS-nat-orb|mo-hf>  10  20   -0.63691916
CASSCF energy = -75.60580432515
CASCI E = -75.60580432515  E(CI) = -18.1594673295386  S^2 = 0.0000000
......production of RDMs took       2.66 sec
......reading the RDM took          0.42 sec
......production of RDMs took      28.27 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickICMRREPT2-ijrs) =    -0.00035422552920
E(WickICMRREPT2- rsi) =    -0.00118689605177
E(WickICMRREPT2- ijr) =    -0.00044609328470
E(WickICMRREPT2-  rs) =    -0.05593437579431
E(WickICMRREPT2-  ij) =    -0.00016570872346
E(WickICMRREPT2-  ir) =    -0.00143980681084
E(WickICMRREPT2-   r) =    -0.04878569677255
E(WickICMRREPT2-   i) =    -0.00033340299833
E(WickICMRREPT2) = -75.71445053111511  E_corr_pt = -0.1086462059651456
Timings = pdms =   41.09 | eris =    0.09 | ijrs =    1.20 | rsi =   31.22 | ijr =    0.42 | rs =  636.43 | ij =    1.42 | ir =   25.51 | r =  146.60 | i =    2.32 | total =  886.36
Time cost =    956.905
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:53:37 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.190648724570 AA    0.000000000000   0.000000000000   2.250000000000 Bohr   0.0

nuclear repulsion = 16
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.125]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    132423.46


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpsd47c3eh
max_memory 4000 MB (current use 399 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6287133444179

WARN: Singularity detected in overlap matrix (condition number =  749). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.287801147291401  LUMO (Ag) = -0.193295779361719
cycle= 1 E= -75.3670366286219  delta_E= 0.262  |g|= 0.19  |ddm|= 1.51
HOMO (B3u) = -0.499807889396643  LUMO (Ag) = -0.137862572577771
cycle= 2 E= -75.379748235821  delta_E= -0.0127  |g|= 0.0519  |ddm|= 0.208
HOMO (B3u) = -0.464540226195213  LUMO (Ag) = -0.103237375699655
cycle= 3 E= -75.3805383397254  delta_E= -0.00079  |g|= 0.0104  |ddm|= 0.0716
HOMO (B3u) = -0.466699997579166  LUMO (Ag) = -0.104062742035944
cycle= 4 E= -75.3806041774367  delta_E= -6.58e-05  |g|= 0.00196  |ddm|= 0.0425
HOMO (B2u) = -0.467507612863155  LUMO (Ag) = -0.105181483870829
cycle= 5 E= -75.3806067875641  delta_E= -2.61e-06  |g|= 0.00024  |ddm|= 0.0138
HOMO (B2u) = -0.467469009904278  LUMO (Ag) = -0.105209990979466
cycle= 6 E= -75.3806068286268  delta_E= -4.11e-08  |g|= 2.47e-05  |ddm|= 0.000855
HOMO (B3u) = -0.467470595918396  LUMO (Ag) = -0.105219180794834
cycle= 7 E= -75.3806068289548  delta_E= -3.28e-10  |g|= 2.6e-06  |ddm|= 0.000264
HOMO (B3u) = -0.467470958374962  LUMO (Ag) = -0.105219406231805
cycle= 8 E= -75.3806068289574  delta_E= -2.6e-12  |g|= 1.64e-07  |ddm|= 3.35e-05
HOMO (B3u) = -0.467470973641555  LUMO (Ag) = -0.105219414001705
cycle= 9 E= -75.3806068289574  delta_E= -5.68e-14  |g|= 9.4e-09  |ddm|= 3.15e-07
HOMO (B3u) = -0.46747097106147  LUMO (Ag) = -0.105219408954151
cycle= 10 E= -75.3806068289574  delta_E= -1.42e-14  |g|= 7.61e-09  |ddm|= 1.06e-08
HOMO (B3u) = -0.467470973485545  LUMO (Ag) = -0.105219411332164
cycle= 11 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 8.69e-10  |ddm|= 1.89e-08
HOMO (B3u) = -0.467470973605026  LUMO (Ag) = -0.105219411405516
cycle= 12 E= -75.3806068289574  delta_E= 1.42e-14  |g|= 6.74e-10  |ddm|= 2.36e-09
HOMO (B3u) = -0.467470973592959  LUMO (Ag) = -0.105219411392733
cycle= 13 E= -75.3806068289575  delta_E= -7.11e-14  |g|= 5.81e-10  |ddm|= 1.04e-09
HOMO (B3u) = -0.467470973609087  LUMO (Ag) = -0.105219411406843
cycle= 14 E= -75.3806068289574  delta_E= 8.53e-14  |g|= 5.17e-10  |ddm|= 1.16e-10
HOMO (B3u) = -0.467470973617608  LUMO (Ag) = -0.105219411398038
cycle= 15 E= -75.3806068289574  delta_E= -4.26e-14  |g|= 4.53e-10  |ddm|= 4.7e-10
HOMO (B3u) = -0.467470973584954  LUMO (Ag) = -0.105219411382067
cycle= 16 E= -75.3806068289575  delta_E= -8.53e-14  |g|= 4e-10  |ddm|= 9.32e-10
HOMO (B3u) = -0.467470973563562  LUMO (Ag) = -0.105219411401324
cycle= 17 E= -75.3806068289574  delta_E= 1.28e-13  |g|= 5.25e-10  |ddm|= 8.93e-10
HOMO (B3u) = -0.467470973603036  LUMO (Ag) = -0.105219411391186
cycle= 18 E= -75.3806068289574  delta_E= -2.84e-14  |g|= 3.19e-10  |ddm|= 4.58e-10
HOMO (B3u) = -0.467470973566689  LUMO (Ag) = -0.105219411341701
cycle= 19 E= -75.3806068289574  delta_E=    0  |g|= 1.09e-10  |ddm|= 7.7e-10
HOMO (B3u) = -0.467470973563696  LUMO (Ag) = -0.105219411337517
cycle= 20 E= -75.3806068289575  delta_E= -7.11e-14  |g|= 9.36e-11  |ddm|= 4.2e-11
HOMO (B2u) = -0.467470973565249  LUMO (Ag) = -0.105219411337263
cycle= 21 E= -75.3806068289574  delta_E= 9.95e-14  |g|= 7.98e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.467470973565407  LUMO (Ag) = -0.105219411335838
cycle= 22 E= -75.3806068289575  delta_E= -8.53e-14  |g|= 6.65e-11  |ddm|= 3.67e-11
HOMO (B3u) = -0.467470973566037  LUMO (Ag) = -0.105219411334768
cycle= 23 E= -75.3806068289574  delta_E= 8.53e-14  |g|= 5.48e-11  |ddm|= 3.56e-11
HOMO (B3u) = -0.467470973566309  LUMO (Ag) = -0.105219411333954
cycle= 24 E= -75.3806068289574  delta_E= -4.26e-14  |g|= 4.62e-11  |ddm|= 4.63e-11
HOMO (B3u) = -0.46747097356667  LUMO (Ag) = -0.105219411332852
cycle= 25 E= -75.3806068289575  delta_E= -7.11e-14  |g|= 3.79e-11  |ddm|= 2.04e-11
HOMO (B2u) = -0.467470973568361  LUMO (Ag) = -0.105219411331706
cycle= 26 E= -75.3806068289575  delta_E= 4.26e-14  |g|= 2.35e-11  |ddm|= 3.37e-11
HOMO (B2u) = -0.467470973570472  LUMO (Ag) = -0.105219411332579
cycle= 27 E= -75.3806068289575  delta_E= -1.42e-14  |g|= 1.73e-11  |ddm|= 2.6e-11
HOMO (B2u) = -0.467470973570326  LUMO (Ag) = -0.105219411331905
cycle= 28 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 1.43e-11  |ddm|= 8.09e-12
HOMO (B2u) = -0.467470973570101  LUMO (Ag) = -0.105219411331207
cycle= 29 E= -75.3806068289575  delta_E= -9.95e-14  |g|= 1.17e-11  |ddm|= 7.09e-12
HOMO (B2u) = -0.46747097356993  LUMO (Ag) = -0.105219411330605
cycle= 30 E= -75.3806068289575  delta_E= 1.42e-14  |g|= 9.4e-12  |ddm|= 6.69e-12
HOMO (B2u) = -0.467470973569802  LUMO (Ag) = -0.105219411330098
cycle= 31 E= -75.3806068289575  delta_E= 7.11e-14  |g|= 7.48e-12  |ddm|= 5.1e-12
HOMO (B2u) = -0.467470973569727  LUMO (Ag) = -0.105219411329697
cycle= 32 E= -75.3806068289574  delta_E= 4.26e-14  |g|= 5.89e-12  |ddm|= 3.65e-12
HOMO (B2u) = -0.467470973569717  LUMO (Ag) = -0.105219411329395
cycle= 33 E= -75.3806068289574  delta_E=    0  |g|= 4.58e-12  |ddm|= 2.06e-12
HOMO (B3u) = -0.467470973569827  LUMO (Ag) = -0.105219411328729
Extra cycle  E= -75.3806068289574  delta_E= 1.42e-14  |g|= 1.51e-12  |ddm|= 6.95e-12
converged SCF energy = -75.3806068289574

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpsd47c3eh
max_memory 4000 MB (current use 408 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5432350451997  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5633378815474  dE = -0.020102836  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5798666745088  dE = -0.016528793  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0508  |maxRot[o]|=0.0765
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5891764418753  dE = -0.0093097674  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0302  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5958196610627  dE = -0.0066432192  S^2 = 0.0000000
               |grad[o]|=0.0699  |ddm|=0.0111  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6011966185216  dE = -0.0053769575  S^2 = 0.0000000
               |grad[o]|=0.0557  |ddm|=0.00578  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6056569831812  dE = -0.0044603647  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00393  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6092561924972  dE = -0.0035992093  S^2 = 0.0000000
               |grad[o]|=0.034  |ddm|=0.00337  |maxRot[o]|=0.0797
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6118597709633  dE = -0.0026035785  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6135439050932  dE = -0.0016841341  S^2 = 0.0000000
               |grad[o]|=0.0171  |ddm|=0.00365  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6143871912949  dE = -0.0008432862  S^2 = 0.0000000
               |grad[o]|= 0.01  |ddm|=0.00384  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6145205407692  dE = -0.00013334947  S^2 = 0.0000000
               |grad[o]|=0.00374  |ddm|=0.00405  |maxRot[o]|= 0.04
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6145268325249  dE = -6.2917557e-06  S^2 = 0.0000000
               |grad[o]|=0.000953  |ddm|=0.0023  |maxRot[o]|=0.00978
macro iter 13 (3 JK  0 micro), CASSCF E = -75.614526949808  dE = -1.1728309e-07  S^2 = 0.0000000
               |grad[o]|=0.000186  |ddm|=0.000824  |maxRot[o]|=0.00121
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6145269527588  dE = -2.9507845e-09  S^2 = 0.0000000
               |grad[o]|=3.32e-05  |ddm|=0.000205  |maxRot[o]|=0.000182
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6145269528459  dE = -8.7069907e-11  S^2 = 0.0000000
               |grad[o]|=6.05e-06  |ddm|=4.46e-05  |maxRot[o]|=3.08e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6145269528482  dE = -2.3021585e-12  S^2 = 0.0000000
               |grad[o]|=1.08e-06  |ddm|=9.17e-06  |maxRot[o]|=5.64e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98576842 1.56903903 1.90400163 1.90400116 0.42663284 0.0993386
 0.0993385  0.01187982]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00276   0.00252   0.00000   0.00000  -0.00155
  0 C 2s       0.58703   0.49855   0.00000   0.00000  -0.39116
  0 C 3s      -0.05216   0.00914   0.00000   0.00000  -0.01848
  0 C 2px      0.00000   0.00000  -0.00000   0.70609   0.00000
  0 C 2py     -0.00000  -0.00000   0.70609   0.00000  -0.00000
  0 C 2pz      0.38514  -0.50131   0.00000  -0.00000   0.58739
  0 C 3px      0.00000  -0.00000  -0.00000  -0.01737  -0.00000
  0 C 3py      0.00000  -0.00000  -0.01737   0.00000  -0.00000
  0 C 3pz     -0.05093  -0.00632   0.00000   0.00000  -0.03868
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03373   0.00000  -0.00000
  0 C 3dz^2    0.04175   0.00318   0.00000   0.00000   0.01107
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03373  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00276  -0.00252   0.00000   0.00000  -0.00155
  1 C 2s       0.58703  -0.49855  -0.00000  -0.00000  -0.39116
  1 C 3s      -0.05216  -0.00914  -0.00000  -0.00000  -0.01848
  1 C 2px     -0.00000   0.00000   0.00000   0.70609   0.00000
  1 C 2py     -0.00000   0.00000   0.70609  -0.00000   0.00000
  1 C 2pz     -0.38514  -0.50131   0.00000  -0.00000  -0.58739
  1 C 3px     -0.00000  -0.00000   0.00000  -0.01737   0.00000
  1 C 3py      0.00000   0.00000  -0.01737  -0.00000   0.00000
  1 C 3pz      0.05093  -0.00632   0.00000   0.00000   0.03868
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.03373   0.00000  -0.00000
  1 C 3dz^2    0.04175  -0.00318  -0.00000   0.00000   0.01107
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03373  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00080
  0 C 2s       0.00000   0.00000   0.50039
  0 C 3s      -0.00000  -0.00000  -0.04369
  0 C 2px      0.70617   0.00000  -0.00000
  0 C 2py      0.00000   0.70617   0.00000
  0 C 2pz     -0.00000  -0.00000   0.49657
  0 C 3px     -0.02753   0.00000  -0.00000
  0 C 3py      0.00000  -0.02753  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00467
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03305
  0 C 3dxz    -0.02382   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00080
  1 C 2s       0.00000   0.00000  -0.50039
  1 C 3s       0.00000   0.00000   0.04369
  1 C 2px     -0.70617  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70617   0.00000
  1 C 2pz     -0.00000   0.00000   0.49657
  1 C 3px      0.02753  -0.00000   0.00000
  1 C 3py     -0.00000   0.02753  -0.00000
  1 C 3pz     -0.00000  -0.00000   0.00467
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03305
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99511402
<CAS-nat-orb|mo-hf>  4  4    0.99863346
<CAS-nat-orb|mo-hf>  5  5    0.99981869
<CAS-nat-orb|mo-hf>  6  6    0.99981869
<CAS-nat-orb|mo-hf>  7  7    0.98014678
<CAS-nat-orb|mo-hf>  8  8    0.92376839
<CAS-nat-orb|mo-hf>  9  9    0.92376829
<CAS-nat-orb|mo-hf>  10  10    0.44416418
<CAS-nat-orb|mo-hf>  10  17    0.59838638
<CAS-nat-orb|mo-hf>  10  20   -0.60893960
CASSCF energy = -75.6145269528482
CASCI E = -75.6145269528482  E(CI) = -18.0065822075092  S^2 = 0.0000000
......production of RDMs took       1.99 sec
......reading the RDM took          0.42 sec
......production of RDMs took      22.46 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.79 sec

E(WickICMRREPT2-ijrs) =    -0.00033702184544
E(WickICMRREPT2- rsi) =    -0.00115202897791
E(WickICMRREPT2- ijr) =    -0.00043606570865
E(WickICMRREPT2-  rs) =    -0.05553343084346
E(WickICMRREPT2-  ij) =    -0.00016216274974
E(WickICMRREPT2-  ir) =    -0.00141742488415
E(WickICMRREPT2-   r) =    -0.04959783089327
E(WickICMRREPT2-   i) =    -0.00032679190516
E(WickICMRREPT2) = -75.723489710656  E_corr_pt = -0.1089627578077993
Timings = pdms =   34.66 | eris =    0.06 | ijrs =    1.17 | rsi =   41.52 | ijr =    0.57 | rs =  644.89 | ij =    1.28 | ir =   24.67 | r =  166.18 | i =    2.27 | total =  917.33
Time cost =    979.860
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:09:57 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.217107585116 AA    0.000000000000   0.000000000000   2.300000000000 Bohr   0.0

nuclear repulsion = 15.6521739130435
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.15]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    147528.46


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp93vm89l7
max_memory 4000 MB (current use 457 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.5736679955661

WARN: Singularity detected in overlap matrix (condition number =  684). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.275669226345096  LUMO (Ag) = -0.189888551192396
cycle= 1 E= -75.3709156762751  delta_E= 0.203  |g|= 0.194  |ddm|=  1.5
HOMO (B3u) = -0.494059555931339  LUMO (Ag) = -0.140557688111631
cycle= 2 E= -75.3842064529923  delta_E= -0.0133  |g|= 0.0519  |ddm|= 0.217
HOMO (B3u) = -0.458318448325722  LUMO (Ag) = -0.104627267109314
cycle= 3 E= -75.3850020490567  delta_E= -0.000796  |g|= 0.00987  |ddm|= 0.0675
HOMO (B2u) = -0.460162695295052  LUMO (Ag) = -0.104859312382323
cycle= 4 E= -75.3850609582636  delta_E= -5.89e-05  |g|= 0.00188  |ddm|= 0.038
HOMO (B2u) = -0.460946264390439  LUMO (Ag) = -0.105848218108887
cycle= 5 E= -75.3850633096871  delta_E= -2.35e-06  |g|= 0.000188  |ddm|= 0.0127
HOMO (B2u) = -0.46092763633222  LUMO (Ag) = -0.105880739343783
cycle= 6 E= -75.3850633353857  delta_E= -2.57e-08  |g|= 2.43e-05  |ddm|= 0.00106
HOMO (B3u) = -0.460929625185357  LUMO (Ag) = -0.105890953720648
cycle= 7 E= -75.3850633357241  delta_E= -3.38e-10  |g|= 2.81e-06  |ddm|= 0.000195
HOMO (B3u) = -0.460930055066098  LUMO (Ag) = -0.105891268417327
cycle= 8 E= -75.3850633357272  delta_E= -3.07e-12  |g|= 1.94e-07  |ddm|= 3.21e-05
HOMO (B3u) = -0.460930071211137  LUMO (Ag) = -0.105891273497177
cycle= 9 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 1.06e-08  |ddm|= 5.6e-07
HOMO (B3u) = -0.460930068173302  LUMO (Ag) = -0.105891267986908
cycle= 10 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 7.06e-09  |ddm|= 1.11e-08
HOMO (B3u) = -0.460930070738045  LUMO (Ag) = -0.105891270631445
cycle= 11 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 1.05e-09  |ddm|= 1.8e-08
HOMO (B3u) = -0.460930070835053  LUMO (Ag) = -0.105891270667105
cycle= 12 E= -75.3850633357273  delta_E= -5.68e-14  |g|= 8e-10  |ddm|= 1.2e-09
HOMO (B3u) = -0.460930070806987  LUMO (Ag) = -0.105891270628952
cycle= 13 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 6.47e-10  |ddm|= 8.19e-10
HOMO (B2u) = -0.46093007082573  LUMO (Ag) = -0.105891270646067
cycle= 14 E= -75.3850633357273  delta_E= -9.95e-14  |g|= 6.07e-10  |ddm|= 7.75e-10
HOMO (B3u) = -0.460930070826707  LUMO (Ag) = -0.105891270639142
cycle= 15 E= -75.3850633357272  delta_E= 1.14e-13  |g|= 5.29e-10  |ddm|= 5.34e-10
HOMO (B2u) = -0.460930070799583  LUMO (Ag) = -0.105891270618944
cycle= 16 E= -75.3850633357272  delta_E=    0  |g|= 4.69e-10  |ddm|= 5.32e-10
HOMO (B2u) = -0.460930070759971  LUMO (Ag) = -0.105891270621217
cycle= 17 E= -75.3850633357272  delta_E=    0  |g|= 5.54e-10  |ddm|= 1.23e-09
HOMO (B3u) = -0.460930070793274  LUMO (Ag) = -0.105891270600627
cycle= 18 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 3.11e-10  |ddm|= 5.56e-10
HOMO (B2u) = -0.460930070747824  LUMO (Ag) = -0.105891270546361
cycle= 19 E= -75.3850633357271  delta_E= 5.68e-14  |g|= 1.33e-10  |ddm|= 7.21e-10
HOMO (B2u) = -0.460930070748227  LUMO (Ag) = -0.105891270543878
cycle= 20 E= -75.3850633357272  delta_E= -8.53e-14  |g|= 1.11e-10  |ddm|= 3.73e-11
HOMO (B2u) = -0.460930070751439  LUMO (Ag) = -0.105891270544599
cycle= 21 E= -75.3850633357273  delta_E= -1.14e-13  |g|= 9.41e-11  |ddm|= 4.04e-11
HOMO (B2u) = -0.460930070753037  LUMO (Ag) = -0.105891270544411
cycle= 22 E= -75.3850633357272  delta_E= 1.56e-13  |g|= 7.95e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.460930070754375  LUMO (Ag) = -0.105891270543822
cycle= 23 E= -75.3850633357273  delta_E= -1.14e-13  |g|= 6.47e-11  |ddm|= 3.83e-11
HOMO (B3u) = -0.460930070755402  LUMO (Ag) = -0.105891270543108
cycle= 24 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 5.25e-11  |ddm|= 4.74e-11
HOMO (B2u) = -0.460930070756163  LUMO (Ag) = -0.105891270542046
cycle= 25 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 4.18e-11  |ddm|= 3.25e-11
HOMO (B2u) = -0.460930070757871  LUMO (Ag) = -0.105891270540734
cycle= 26 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 2.7e-11  |ddm|= 3.25e-11
HOMO (B3u) = -0.460930070759811  LUMO (Ag) = -0.105891270541468
cycle= 27 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 2.12e-11  |ddm|= 2.29e-11
HOMO (B2u) = -0.460930070759449  LUMO (Ag) = -0.105891270540478
cycle= 28 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 1.76e-11  |ddm|= 8.29e-12
HOMO (B2u) = -0.46093007075908  LUMO (Ag) = -0.105891270539565
cycle= 29 E= -75.3850633357272  delta_E=    0  |g|= 1.44e-11  |ddm|= 7.95e-12
HOMO (B2u) = -0.460930070758439  LUMO (Ag) = -0.105891270536999
Extra cycle  E= -75.3850633357272  delta_E= 1.42e-14  |g|= 4.81e-12  |ddm|= 2.29e-11
converged SCF energy = -75.3850633357272

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp93vm89l7
max_memory 4000 MB (current use 457 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.549398930765  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5700723750477  dE = -0.020673444  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5865706340662  dE = -0.016498259  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0532  |maxRot[o]|=0.0764
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5958320260421  dE = -0.009261392  S^2 = 0.0000000
               |grad[o]|=0.0881  |ddm|=0.0308  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6025808201931  dE = -0.0067487942  S^2 = 0.0000000
               |grad[o]|=0.069  |ddm|=0.0115  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6080431028801  dE = -0.0054622827  S^2 = 0.0000000
               |grad[o]|=0.0545  |ddm|=0.00631  |maxRot[o]|=0.0795
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6123313014546  dE = -0.0042881986  S^2 = 0.0000000
               |grad[o]|=0.0425  |ddm|=0.00445  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6155976436716  dE = -0.0032663422  S^2 = 0.0000000
               |grad[o]|=0.0324  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6179396574963  dE = -0.0023420138  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00362  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194238166327  dE = -0.0014841591  S^2 = 0.0000000
               |grad[o]|=0.016  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6201144309324  dE = -0.0006906143  S^2 = 0.0000000
               |grad[o]|=0.00899  |ddm|=0.0039  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201867175846  dE = -7.2286652e-05  S^2 = 0.0000000
               |grad[o]|=0.00281  |ddm|=0.00412  |maxRot[o]|=0.0333
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201877724459  dE = -1.0548613e-06  S^2 = 0.0000000
               |grad[o]|=0.00052  |ddm|=0.00202  |maxRot[o]|=0.00369
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201877958082  dE = -2.3362347e-08  S^2 = 0.0000000
               |grad[o]|=9.05e-05  |ddm|=0.000481  |maxRot[o]|=0.00051
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6201877964403  dE = -6.3212724e-10  S^2 = 0.0000000
               |grad[o]|=1.57e-05  |ddm|=0.000108  |maxRot[o]|=8.3e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6201877964596  dE = -1.928413e-11  S^2 = 0.0000000
               |grad[o]|=2.92e-06  |ddm|=2.26e-05  |maxRot[o]|=1.42e-05
2-step CASSCF converged in 15 macro (76 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98500898 1.58412136 1.89795623 1.89795655 0.41151926 0.10541182
 0.10541195 0.01261384]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00317   0.00262   0.00000   0.00000  -0.00145
  0 C 2s       0.59002   0.50721   0.00000  -0.00000  -0.38673
  0 C 3s      -0.05064   0.00902   0.00000  -0.00000  -0.01545
  0 C 2px      0.00000  -0.00000  -0.00000   0.70621  -0.00000
  0 C 2py      0.00000   0.00000   0.70621  -0.00000  -0.00000
  0 C 2pz      0.38111  -0.49255   0.00000  -0.00000   0.59034
  0 C 3px      0.00000  -0.00000   0.00000  -0.01351   0.00000
  0 C 3py     -0.00000   0.00000  -0.01351   0.00000  -0.00000
  0 C 3pz     -0.04932  -0.00573   0.00000  -0.00000  -0.03961
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.03283   0.00000  -0.00000
  0 C 3dz^2    0.04041   0.00253   0.00000  -0.00000   0.01144
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03283   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00317  -0.00262   0.00000   0.00000  -0.00145
  1 C 2s       0.59002  -0.50721   0.00000   0.00000  -0.38673
  1 C 3s      -0.05064  -0.00902  -0.00000   0.00000  -0.01545
  1 C 2px     -0.00000   0.00000  -0.00000   0.70621  -0.00000
  1 C 2py      0.00000  -0.00000   0.70621  -0.00000   0.00000
  1 C 2pz     -0.38111  -0.49255   0.00000  -0.00000  -0.59034
  1 C 3px     -0.00000   0.00000   0.00000  -0.01351   0.00000
  1 C 3py     -0.00000  -0.00000  -0.01351   0.00000   0.00000
  1 C 3pz      0.04932  -0.00573   0.00000  -0.00000   0.03961
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03283  -0.00000  -0.00000
  1 C 3dz^2    0.04041  -0.00253  -0.00000   0.00000   0.01144
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03283  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00075
  0 C 2s      -0.00000   0.00000   0.49173
  0 C 3s      -0.00000   0.00000  -0.04330
  0 C 2px      0.70622  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70622   0.00000
  0 C 2pz     -0.00000  -0.00000   0.50534
  0 C 3px     -0.02618  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.02618   0.00000
  0 C 3pz     -0.00000   0.00000   0.00676
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02379   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.03024
  0 C 3dxz    -0.02379  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00075
  1 C 2s       0.00000  -0.00000  -0.49173
  1 C 3s       0.00000  -0.00000   0.04330
  1 C 2px     -0.70622   0.00000   0.00000
  1 C 2py      0.00000  -0.70622   0.00000
  1 C 2pz     -0.00000   0.00000   0.50534
  1 C 3px      0.02618   0.00000   0.00000
  1 C 3py      0.00000   0.02618  -0.00000
  1 C 3pz     -0.00000   0.00000   0.00676
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02379   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03024
  1 C 3dxz    -0.02379  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99486434
<CAS-nat-orb|mo-hf>  4  4    0.99859054
<CAS-nat-orb|mo-hf>  5  5    0.99980387
<CAS-nat-orb|mo-hf>  6  6    0.99980387
<CAS-nat-orb|mo-hf>  7  7    0.97957781
<CAS-nat-orb|mo-hf>  8  8    0.92972102
<CAS-nat-orb|mo-hf>  9  9    0.92972112
<CAS-nat-orb|mo-hf>  10  10    0.45886323
<CAS-nat-orb|mo-hf>  10  17    0.62354822
<CAS-nat-orb|mo-hf>  10  20   -0.57985787
CASSCF energy = -75.6201877964596
CASCI E = -75.6201877964596  E(CI) = -17.8576549918628  S^2 = 0.0000000
......production of RDMs took       1.88 sec
......reading the RDM took          0.43 sec
......production of RDMs took      23.44 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICMRREPT2-ijrs) =    -0.00032268238175
E(WickICMRREPT2- rsi) =    -0.00112079636716
E(WickICMRREPT2- ijr) =    -0.00042699565362
E(WickICMRREPT2-  rs) =    -0.05510556590810
E(WickICMRREPT2-  ij) =    -0.00015806026643
E(WickICMRREPT2-  ir) =    -0.00139583896350
E(WickICMRREPT2-   r) =    -0.05042335601051
E(WickICMRREPT2-   i) =    -0.00032024352693
E(WickICMRREPT2) = -75.72946133553762  E_corr_pt = -0.1092735390779988
Timings = pdms =   35.52 | eris =    0.16 | ijrs =    1.18 | rsi =   31.44 | ijr =    0.42 | rs =  660.56 | ij =    1.32 | ir =   26.32 | r =  160.16 | i =    2.33 | total =  919.49
Time cost =    985.385
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:26:22 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.243566445662 AA    0.000000000000   0.000000000000   2.350000000000 Bohr   0.0

nuclear repulsion = 15.3191489361702
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.175]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    162384.81


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmphilr8tus
max_memory 4000 MB (current use 399 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.520080440469

WARN: Singularity detected in overlap matrix (condition number =  625). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.264198750943282  LUMO (Ag) = -0.186664127921807
cycle= 1 E= -75.372158499346  delta_E= 0.148  |g|= 0.198  |ddm|= 1.49
HOMO (B2u) = -0.488497893717002  LUMO (Ag) = -0.142939777698247
cycle= 2 E= -75.3860697595072  delta_E= -0.0139  |g|= 0.052  |ddm|= 0.225
HOMO (B2u) = -0.452348284546127  LUMO (Ag) = -0.105756871897141
cycle= 3 E= -75.3868762726882  delta_E= -0.000807  |g|= 0.00951  |ddm|= 0.0641
HOMO (B2u) = -0.453936921014673  LUMO (Ag) = -0.105452022681083
cycle= 4 E= -75.3869305550891  delta_E= -5.43e-05  |g|= 0.00182  |ddm|= 0.034
HOMO (B3u) = -0.4546996704121  LUMO (Ag) = -0.10632074835353
cycle= 5 E= -75.3869327103432  delta_E= -2.16e-06  |g|= 0.00013  |ddm|= 0.0115
HOMO (B3u) = -0.454692197268589  LUMO (Ag) = -0.106342680679352
cycle= 6 E= -75.3869327222536  delta_E= -1.19e-08  |g|= 2.27e-05  |ddm|= 0.00104
HOMO (B2u) = -0.454694399587791  LUMO (Ag) = -0.106353370939722
cycle= 7 E= -75.3869327225934  delta_E= -3.4e-10  |g|= 3.04e-06  |ddm|= 8.49e-05
HOMO (B3u) = -0.45469490764485  LUMO (Ag) = -0.106353839610049
cycle= 8 E= -75.386932722597  delta_E= -3.61e-12  |g|= 2.27e-07  |ddm|= 2.93e-05
HOMO (B2u) = -0.454694923997893  LUMO (Ag) = -0.106353843315761
cycle= 9 E= -75.386932722597  delta_E= -4.26e-14  |g|= 1.18e-08  |ddm|= 9.54e-07
HOMO (B3u) = -0.454694921260237  LUMO (Ag) = -0.106353838499014
cycle= 10 E= -75.3869327225971  delta_E= -4.26e-14  |g|= 6.13e-09  |ddm|= 1.63e-08
HOMO (B3u) = -0.454694923039541  LUMO (Ag) = -0.106353840238577
cycle= 11 E= -75.3869327225971  delta_E=    0  |g|= 1.1e-09  |ddm|= 1.36e-08
HOMO (B3u) = -0.454694923184759  LUMO (Ag) = -0.10635384033695
cycle= 12 E= -75.3869327225971  delta_E= -1.42e-14  |g|= 9.26e-10  |ddm|= 2.29e-09
HOMO (B2u) = -0.45469492315195  LUMO (Ag) = -0.106353840281292
cycle= 13 E= -75.3869327225971  delta_E= -1.42e-14  |g|= 7.1e-10  |ddm|= 1.07e-09
HOMO (B3u) = -0.454694923168094  LUMO (Ag) = -0.106353840290974
cycle= 14 E= -75.3869327225971  delta_E= 2.84e-14  |g|= 6.98e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.454694923166875  LUMO (Ag) = -0.106353840308883
cycle= 15 E= -75.3869327225971  delta_E=    0  |g|= 6.16e-10  |ddm|= 9.5e-10
HOMO (B2u) = -0.454694923138682  LUMO (Ag) = -0.106353840281422
cycle= 16 E= -75.386932722597  delta_E= 2.84e-14  |g|= 5.54e-10  |ddm|= 4.62e-10
HOMO (B2u) = -0.454694923091426  LUMO (Ag) = -0.106353840262996
cycle= 17 E= -75.3869327225969  delta_E= 8.53e-14  |g|= 5.8e-10  |ddm|= 1.39e-09
HOMO (B3u) = -0.454694923115829  LUMO (Ag) = -0.106353840230396
cycle= 18 E= -75.3869327225971  delta_E= -1.42e-13  |g|= 2.9e-10  |ddm|= 6.61e-10
HOMO (B2u) = -0.454694923075199  LUMO (Ag) = -0.106353840179754
cycle= 19 E= -75.386932722597  delta_E= 4.26e-14  |g|= 1.54e-10  |ddm|= 4.77e-10
HOMO (B2u) = -0.454694923074519  LUMO (Ag) = -0.106353840176582
cycle= 20 E= -75.386932722597  delta_E= 7.11e-14  |g|= 1.33e-10  |ddm|= 3.7e-11
HOMO (B2u) = -0.454694923078894  LUMO (Ag) = -0.10635384017799
cycle= 21 E= -75.386932722597  delta_E= -1.42e-14  |g|= 1.13e-10  |ddm|= 5.87e-11
HOMO (B2u) = -0.454694923081399  LUMO (Ag) = -0.106353840178644
cycle= 22 E= -75.3869327225971  delta_E= -9.95e-14  |g|= 9.75e-11  |ddm|= 3.64e-11
HOMO (B3u) = -0.454694923082725  LUMO (Ag) = -0.106353840178343
cycle= 23 E= -75.386932722597  delta_E= 4.26e-14  |g|= 8.04e-11  |ddm|= 4.13e-11
HOMO (B2u) = -0.454694923084202  LUMO (Ag) = -0.106353840176998
cycle= 24 E= -75.3869327225971  delta_E= -2.84e-14  |g|= 6.36e-11  |ddm|= 5.79e-11
HOMO (B2u) = -0.454694923085164  LUMO (Ag) = -0.106353840175216
cycle= 25 E= -75.386932722597  delta_E= 4.26e-14  |g|= 4.85e-11  |ddm|= 4.68e-11
HOMO (B2u) = -0.454694923086554  LUMO (Ag) = -0.10635384017329
cycle= 26 E= -75.3869327225971  delta_E= -2.84e-14  |g|= 3.32e-11  |ddm|= 2.73e-11
HOMO (B3u) = -0.454694923087934  LUMO (Ag) = -0.106353840173333
cycle= 27 E= -75.386932722597  delta_E= 5.68e-14  |g|= 2.7e-11  |ddm|= 1.35e-11
HOMO (B3u) = -0.454694923087527  LUMO (Ag) = -0.106353840172176
cycle= 28 E= -75.386932722597  delta_E=    0  |g|= 2.27e-11  |ddm|= 1.02e-11
HOMO (B2u) = -0.454694923086274  LUMO (Ag) = -0.106353840167997
Extra cycle  E= -75.3869327225971  delta_E= -5.68e-14  |g|= 8e-12  |ddm|= 4.04e-11
converged SCF energy = -75.3869327225971

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmphilr8tus
max_memory 4000 MB (current use 408 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5529956225487  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5742379004887  dE = -0.021242278  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5907013338546  dE = -0.016463433  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0556  |maxRot[o]|=0.078
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5999891087186  dE = -0.0092877749  S^2 = 0.0000000
               |grad[o]|=0.0873  |ddm|=0.0313  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066426342076  dE = -0.0066535255  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.012  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6117776285498  dE = -0.0051349943  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.00672  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.615821392692  dE = -0.0040437641  S^2 = 0.0000000
               |grad[o]|=0.042  |ddm|=0.00468  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6189156562421  dE = -0.0030942636  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00394  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6211353675473  dE = -0.0022197113  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00375  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6225338703793  dE = -0.0013985028  S^2 = 0.0000000
               |grad[o]|=0.0158  |ddm|=0.0038  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.623166045714  dE = -0.00063217533  S^2 = 0.0000000
               |grad[o]|=0.00875  |ddm|=0.00396  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6232125140773  dE = -4.6468363e-05  S^2 = 0.0000000
               |grad[o]|=0.00249  |ddm|=0.00421  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6232205425115  dE = -8.0284342e-06  S^2 = 0.0000000
               |grad[o]|=0.00104  |ddm|=0.00126  |maxRot[o]|=0.0112
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6232206703333  dE = -1.2782186e-07  S^2 = 0.0000000
               |grad[o]|=0.000189  |ddm|=0.000799  |maxRot[o]|=0.00125
macro iter 14 (3 JK  0 micro), CASSCF E = -75.623220673206  dE = -2.8726959e-09  S^2 = 0.0000000
               |grad[o]|=3.19e-05  |ddm|=0.00018  |maxRot[o]|=0.000176
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6232206732839  dE = -7.7847062e-11  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=3.89e-05  |maxRot[o]|=2.9e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.623220673286  dE = -2.1742608e-12  S^2 = 0.0000000
               |grad[o]|=9.71e-07  |ddm|=7.82e-06  |maxRot[o]|=5.02e-06
2-step CASSCF converged in 16 macro (77 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98422464 1.59821723 1.89166097 1.89166128 0.39749232 0.11168503
 0.1116852  0.01337334]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00356   0.00273   0.00000   0.00000  -0.00136
  0 C 2s       0.59304   0.51564   0.00000   0.00000  -0.38216
  0 C 3s      -0.04903   0.00893   0.00000   0.00000  -0.01244
  0 C 2px      0.00000   0.00000  -0.00000   0.70632  -0.00000
  0 C 2py      0.00000  -0.00000   0.70632   0.00000  -0.00000
  0 C 2pz      0.37694  -0.48373   0.00000   0.00000   0.59331
  0 C 3px      0.00000   0.00000  -0.00000  -0.00987  -0.00000
  0 C 3py      0.00000  -0.00000  -0.00987  -0.00000   0.00000
  0 C 3pz     -0.04768  -0.00519   0.00000   0.00000  -0.04045
  0 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03194  -0.00000   0.00000
  0 C 3dz^2    0.03910   0.00193   0.00000   0.00000   0.01197
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03194  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00356  -0.00273   0.00000   0.00000  -0.00136
  1 C 2s       0.59304  -0.51564   0.00000   0.00000  -0.38216
  1 C 3s      -0.04903  -0.00893  -0.00000  -0.00000  -0.01244
  1 C 2px     -0.00000  -0.00000   0.00000   0.70632   0.00000
  1 C 2py     -0.00000   0.00000   0.70632   0.00000  -0.00000
  1 C 2pz     -0.37694  -0.48373   0.00000  -0.00000  -0.59331
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00987   0.00000
  1 C 3py     -0.00000   0.00000  -0.00987   0.00000  -0.00000
  1 C 3pz      0.04768  -0.00519   0.00000   0.00000   0.04045
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03194  -0.00000   0.00000
  1 C 3dz^2    0.03910  -0.00193  -0.00000  -0.00000   0.01197
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03194  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00071
  0 C 2s       0.00000   0.00000   0.48298
  0 C 3s       0.00000   0.00000  -0.04305
  0 C 2px      0.70627   0.00000  -0.00000
  0 C 2py     -0.00000   0.70627   0.00000
  0 C 2pz      0.00000   0.00000   0.51383
  0 C 3px     -0.02494   0.00000  -0.00000
  0 C 3py      0.00000  -0.02494   0.00000
  0 C 3pz     -0.00000   0.00000   0.00873
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02373   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02798
  0 C 3dxz    -0.02373   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00071
  1 C 2s       0.00000  -0.00000  -0.48298
  1 C 3s      -0.00000  -0.00000   0.04305
  1 C 2px     -0.70627  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70627  -0.00000
  1 C 2pz     -0.00000   0.00000   0.51383
  1 C 3px      0.02494  -0.00000   0.00000
  1 C 3py     -0.00000   0.02494  -0.00000
  1 C 3pz      0.00000   0.00000   0.00873
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02373   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02798
  1 C 3dxz    -0.02373   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99460039
<CAS-nat-orb|mo-hf>  4  4    0.99853697
<CAS-nat-orb|mo-hf>  5  5    0.99978677
<CAS-nat-orb|mo-hf>  6  6    0.99978677
<CAS-nat-orb|mo-hf>  7  7    0.97901221
<CAS-nat-orb|mo-hf>  8  8    0.93514178
<CAS-nat-orb|mo-hf>  9  9    0.93514186
<CAS-nat-orb|mo-hf>  10  10    0.47490967
<CAS-nat-orb|mo-hf>  10  17    0.64513932
<CAS-nat-orb|mo-hf>  10  20   -0.55018486
CASSCF energy = -75.623220673286
CASCI E = -75.623220673286  E(CI) = -17.7126744337439  S^2 = 0.0000000
......production of RDMs took       1.92 sec
......reading the RDM took          0.42 sec
......production of RDMs took      25.26 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickICMRREPT2-ijrs) =    -0.00031074852730
E(WickICMRREPT2- rsi) =    -0.00109285036188
E(WickICMRREPT2- ijr) =    -0.00041868696895
E(WickICMRREPT2-  rs) =    -0.05465517175890
E(WickICMRREPT2-  ij) =    -0.00015351967040
E(WickICMRREPT2-  ir) =    -0.00137500111226
E(WickICMRREPT2-   r) =    -0.05126186347440
E(WickICMRREPT2-   i) =    -0.00031375087412
E(WickICMRREPT2) = -75.73280226603427  E_corr_pt = -0.1095815927482221
Timings = pdms =   37.38 | eris =    0.18 | ijrs =    1.15 | rsi =   31.40 | ijr =    0.41 | rs =  648.83 | ij =    1.32 | ir =   24.64 | r =  156.23 | i =    2.30 | total =  903.90
Time cost =    966.878
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:42:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.270025306208 AA    0.000000000000   0.000000000000   2.400000000000 Bohr   0.0

nuclear repulsion = 15
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.2]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    177098.12


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp7wctv384
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4681036266052

WARN: Singularity detected in overlap matrix (condition number =  573). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.253350702957072  LUMO (Ag) = -0.183612207324935
cycle= 1 E= -75.3711621684052  delta_E= 0.0969  |g|= 0.203  |ddm|= 1.48
HOMO (B2u) = -0.483102395155573  LUMO (Ag) = -0.145014054403864
cycle= 2 E= -75.3857253013103  delta_E= -0.0146  |g|= 0.052  |ddm|= 0.234
HOMO (B2u) = -0.446604227160943  LUMO (Ag) = -0.10662994003031
cycle= 3 E= -75.3865468682808  delta_E= -0.000822  |g|= 0.00932  |ddm|= 0.0615
HOMO (B2u) = -0.44799076917457  LUMO (Ag) = -0.105837943292175
cycle= 4 E= -75.3865987559146  delta_E= -5.19e-05  |g|= 0.00179  |ddm|= 0.0304
HOMO (B2u) = -0.448742110750614  LUMO (Ag) = -0.106605000995198
cycle= 5 E= -75.386600812118  delta_E= -2.06e-06  |g|= 7.74e-05  |ddm|= 0.0104
HOMO (B3u) = -0.448735377102865  LUMO (Ag) = -0.106607023368656
cycle= 6 E= -75.3866008154598  delta_E= -3.34e-09  |g|= 1.47e-05  |ddm|= 0.000795
HOMO (B3u) = -0.448736161720339  LUMO (Ag) = -0.106613403607819
cycle= 7 E= -75.3866008156198  delta_E= -1.6e-10  |g|= 2.92e-06  |ddm|= 4.96e-05
HOMO (B2u) = -0.448736721595851  LUMO (Ag) = -0.106614233435023
cycle= 8 E= -75.3866008156237  delta_E= -3.89e-12  |g|= 2.59e-07  |ddm|= 1.95e-05
HOMO (B3u) = -0.448736741737415  LUMO (Ag) = -0.10661425211867
cycle= 9 E= -75.3866008156238  delta_E= -1.14e-13  |g|= 1.3e-08  |ddm|= 1.45e-06
HOMO (B2u) = -0.448736740752162  LUMO (Ag) = -0.106614250133368
cycle= 10 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 5.8e-09  |ddm|= 2.11e-08
HOMO (B2u) = -0.448736740304092  LUMO (Ag) = -0.106614249135214
cycle= 11 E= -75.3866008156238  delta_E= 8.53e-14  |g|= 1.21e-09  |ddm|= 1.3e-08
HOMO (B2u) = -0.448736740435465  LUMO (Ag) = -0.106614249218838
cycle= 12 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 9.84e-10  |ddm|= 1.63e-09
HOMO (B2u) = -0.448736740409308  LUMO (Ag) = -0.106614249167835
cycle= 13 E= -75.3866008156238  delta_E= 2.84e-14  |g|= 7.58e-10  |ddm|= 9.96e-10
HOMO (B3u) = -0.448736740433806  LUMO (Ag) = -0.106614249170944
cycle= 14 E= -75.3866008156238  delta_E= 2.84e-14  |g|= 7.64e-10  |ddm|= 1.68e-09
HOMO (B2u) = -0.448736740438479  LUMO (Ag) = -0.106614249220395
cycle= 15 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 6.88e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.448736740361203  LUMO (Ag) = -0.10661424917269
cycle= 16 E= -75.3866008156239  delta_E= -8.53e-14  |g|= 6.74e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.448736740337479  LUMO (Ag) = -0.106614249142675
cycle= 17 E= -75.3866008156237  delta_E= 1.85e-13  |g|= 6.32e-10  |ddm|= 1.06e-09
HOMO (B3u) = -0.448736740348855  LUMO (Ag) = -0.106614249099557
cycle= 18 E= -75.3866008156238  delta_E= -9.95e-14  |g|= 3.11e-10  |ddm|= 8.02e-10
HOMO (B3u) = -0.448736740350792  LUMO (Ag) = -0.106614249079109
cycle= 19 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 1.75e-10  |ddm|= 3.33e-10
HOMO (B3u) = -0.448736740350265  LUMO (Ag) = -0.106614249075804
cycle= 20 E= -75.3866008156237  delta_E= 1.42e-13  |g|= 1.52e-10  |ddm|= 4.68e-11
HOMO (B3u) = -0.448736740353912  LUMO (Ag) = -0.106614249076718
cycle= 21 E= -75.3866008156237  delta_E= -4.26e-14  |g|= 1.31e-10  |ddm|= 6.32e-11
HOMO (B3u) = -0.448736740356003  LUMO (Ag) = -0.106614249077125
cycle= 22 E= -75.3866008156238  delta_E= -9.95e-14  |g|= 1.16e-10  |ddm|= 4.15e-11
HOMO (B3u) = -0.44873674035629  LUMO (Ag) = -0.106614249076654
cycle= 23 E= -75.3866008156238  delta_E= 5.68e-14  |g|= 9.82e-11  |ddm|= 4.69e-11
HOMO (B2u) = -0.448736740357477  LUMO (Ag) = -0.106614249074742
cycle= 24 E= -75.3866008156237  delta_E= 5.68e-14  |g|= 7.92e-11  |ddm|= 6.69e-11
HOMO (B3u) = -0.448736740357523  LUMO (Ag) = -0.106614249070596
cycle= 25 E= -75.3866008156239  delta_E= -1.28e-13  |g|= 5.88e-11  |ddm|= 4.87e-11
HOMO (B3u) = -0.448736740357767  LUMO (Ag) = -0.106614249067289
cycle= 26 E= -75.3866008156238  delta_E= 9.95e-14  |g|= 4.15e-11  |ddm|= 2.91e-11
HOMO (B3u) = -0.448736740357716  LUMO (Ag) = -0.10661424906556
cycle= 27 E= -75.3866008156238  delta_E= -8.53e-14  |g|= 3.29e-11  |ddm|= 1.53e-11
HOMO (B3u) = -0.448736740357472  LUMO (Ag) = -0.106614249064431
cycle= 28 E= -75.3866008156238  delta_E= 4.26e-14  |g|= 2.8e-11  |ddm|= 1.16e-11
HOMO (B3u) = -0.448736740357186  LUMO (Ag) = -0.106614249063344
cycle= 29 E= -75.3866008156238  delta_E= 1.42e-14  |g|= 2.36e-11  |ddm|= 1.14e-11
HOMO (B3u) = -0.448736740356987  LUMO (Ag) = -0.106614249062392
cycle= 30 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 1.97e-11  |ddm|= 1.17e-11
HOMO (B2u) = -0.448736740356851  LUMO (Ag) = -0.106614249061523
cycle= 31 E= -75.3866008156238  delta_E=    0  |g|= 1.6e-11  |ddm|= 1.2e-11
HOMO (B3u) = -0.448736740356934  LUMO (Ag) = -0.106614249059204
Extra cycle  E= -75.3866008156238  delta_E= 2.84e-14  |g|= 5.89e-12  |ddm|= 3.16e-11
converged SCF energy = -75.3866008156238

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp7wctv384
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5544099472176  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5762198089566  dE = -0.021809862  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5926046135306  dE = -0.016384805  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0582  |maxRot[o]|=0.0788
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6014950261379  dE = -0.0088904126  S^2 = 0.0000000
               |grad[o]|=0.0866  |ddm|=0.0318  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6078328304616  dE = -0.0063378043  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.0122  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6127996763944  dE = -0.0049668459  S^2 = 0.0000000
               |grad[o]|=0.054  |ddm|=0.00702  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6167369243497  dE = -0.003937248  S^2 = 0.0000000
               |grad[o]|=0.0426  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6197643644019  dE = -0.0030274401  S^2 = 0.0000000
               |grad[o]|=0.0328  |ddm|=0.00419  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6219453386467  dE = -0.0021809742  S^2 = 0.0000000
               |grad[o]|=0.0241  |ddm|=0.0039  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6233253048377  dE = -0.0013799662  S^2 = 0.0000000
               |grad[o]|=0.0162  |ddm|=0.00389  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6239527364932  dE = -0.00062743166  S^2 = 0.0000000
               |grad[o]|=0.00898  |ddm|=0.00404  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6239994402992  dE = -4.6703806e-05  S^2 = 0.0000000
               |grad[o]|=0.00254  |ddm|=0.00433  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6240076588571  dE = -8.2185579e-06  S^2 = 0.0000000
               |grad[o]|=0.00105  |ddm|=0.00126  |maxRot[o]|=0.0113
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6240077853572  dE = -1.2650004e-07  S^2 = 0.0000000
               |grad[o]|=0.000189  |ddm|=0.000798  |maxRot[o]|=0.00123
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6240077881096  dE = -2.7524152e-09  S^2 = 0.0000000
               |grad[o]|=3.14e-05  |ddm|=0.000172  |maxRot[o]|=0.00017
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6240077881799  dE = -7.0343731e-11  S^2 = 0.0000000
               |grad[o]|=5.07e-06  |ddm|=3.62e-05  |maxRot[o]|=2.77e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6240077881816  dE = -1.6200374e-12  S^2 = 0.0000000
               |grad[o]|=9.39e-07  |ddm|=7.18e-06  |maxRot[o]|=4.69e-06
2-step CASSCF converged in 16 macro (77 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98341796 1.61142014 1.88510467 1.88510523 0.38447467 0.11816044
 0.11816041 0.01415649]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00394   0.00282   0.00000   0.00000  -0.00128
  0 C 2s       0.59610   0.52384   0.00000  -0.00000  -0.37748
  0 C 3s      -0.04733   0.00887   0.00000  -0.00000  -0.00946
  0 C 2px      0.00000  -0.00000  -0.00000   0.70639  -0.00000
  0 C 2py     -0.00000   0.00000   0.70639  -0.00000  -0.00000
  0 C 2pz      0.37264  -0.47485  -0.00000  -0.00000   0.59629
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00643  -0.00000
  0 C 3py     -0.00000   0.00000  -0.00643  -0.00000  -0.00000
  0 C 3pz     -0.04603  -0.00469   0.00000  -0.00000  -0.04119
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.03106  -0.00000  -0.00000
  0 C 3dz^2    0.03783   0.00135   0.00000  -0.00000   0.01265
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03106  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00394  -0.00282   0.00000   0.00000  -0.00128
  1 C 2s       0.59610  -0.52384  -0.00000   0.00000  -0.37748
  1 C 3s      -0.04733  -0.00887  -0.00000   0.00000  -0.00946
  1 C 2px      0.00000   0.00000   0.00000   0.70639   0.00000
  1 C 2py      0.00000  -0.00000   0.70639   0.00000   0.00000
  1 C 2pz     -0.37264  -0.47485  -0.00000  -0.00000  -0.59629
  1 C 3px     -0.00000   0.00000   0.00000  -0.00643   0.00000
  1 C 3py      0.00000  -0.00000  -0.00643   0.00000   0.00000
  1 C 3pz      0.04603  -0.00469   0.00000  -0.00000   0.04119
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.03106  -0.00000  -0.00000
  1 C 3dz^2    0.03783  -0.00135  -0.00000   0.00000   0.01265
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03106  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00067
  0 C 2s       0.00000   0.00000   0.47414
  0 C 3s      -0.00000   0.00000  -0.04292
  0 C 2px      0.70631  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70631  -0.00000
  0 C 2pz      0.00000  -0.00000   0.52207
  0 C 3px     -0.02380   0.00000   0.00000
  0 C 3py      0.00000  -0.02380  -0.00000
  0 C 3pz     -0.00000   0.00000   0.01059
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02366   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02618
  0 C 3dxz    -0.02366   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00067
  1 C 2s       0.00000  -0.00000  -0.47414
  1 C 3s       0.00000  -0.00000   0.04292
  1 C 2px     -0.70631  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70631   0.00000
  1 C 2pz     -0.00000  -0.00000   0.52207
  1 C 3px      0.02380   0.00000   0.00000
  1 C 3py      0.00000   0.02380   0.00000
  1 C 3pz     -0.00000   0.00000   0.01059
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02366  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02618
  1 C 3dxz    -0.02366  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99432403
<CAS-nat-orb|mo-hf>  4  4    0.99847304
<CAS-nat-orb|mo-hf>  5  5    0.99976738
<CAS-nat-orb|mo-hf>  6  6    0.99976738
<CAS-nat-orb|mo-hf>  7  7    0.97845223
<CAS-nat-orb|mo-hf>  8  8    0.94007723
<CAS-nat-orb|mo-hf>  9  9    0.94007729
<CAS-nat-orb|mo-hf>  10  10    0.49233326
<CAS-nat-orb|mo-hf>  10  17    0.66275081
<CAS-nat-orb|mo-hf>  10  20   -0.52046340
CASSCF energy = -75.6240077881816
CASCI E = -75.6240077881816  E(CI) = -17.5716139906854  S^2 = 0.0000000
......production of RDMs took       1.94 sec
......reading the RDM took          0.45 sec
......production of RDMs took      22.64 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICMRREPT2-ijrs) =    -0.00030083006592
E(WickICMRREPT2- rsi) =    -0.00106786384422
E(WickICMRREPT2- ijr) =    -0.00041095820550
E(WickICMRREPT2-  rs) =    -0.05418592458700
E(WickICMRREPT2-  ij) =    -0.00014864620266
E(WickICMRREPT2-  ir) =    -0.00135487142788
E(WickICMRREPT2-   r) =    -0.05211497808120
E(WickICMRREPT2-   i) =    -0.00030732246540
E(WickICMRREPT2) = -75.73389918306135  E_corr_pt = -0.1098913948797942
Timings = pdms =   34.81 | eris =    0.18 | ijrs =    1.17 | rsi =   31.85 | ijr =    0.41 | rs =  624.36 | ij =    1.29 | ir =   24.46 | r =  154.42 | i =    2.28 | total =  875.32
Time cost =    929.446
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:57:59 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.296484166754 AA    0.000000000000   0.000000000000   2.450000000000 Bohr   0.0

nuclear repulsion = 14.6938775510204
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.225]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    191073.07


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp1siok27p
max_memory 4000 MB (current use 400 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4178541557328

WARN: Singularity detected in overlap matrix (condition number =  525). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.243088233296001  LUMO (Ag) = -0.180721513540293
cycle= 1 E= -75.3682765376263  delta_E= 0.0496  |g|= 0.207  |ddm|= 1.47
HOMO (B2u) = -0.477856195390324  LUMO (Ag) = -0.146786594446601
cycle= 2 E= -75.3835137621145  delta_E= -0.0152  |g|= 0.0521  |ddm|= 0.243
HOMO (B2u) = -0.441063789154573  LUMO (Ag) = -0.107250630527328
cycle= 3 E= -75.3843533836984  delta_E= -0.00084  |g|= 0.00929  |ddm|= 0.0595
HOMO (B2u) = -0.442295646912938  LUMO (Ag) = -0.106015245128836
cycle= 4 E= -75.3844049545557  delta_E= -5.16e-05  |g|= 0.0018  |ddm|= 0.0274
HOMO (B3u) = -0.443045442143858  LUMO (Ag) = -0.106700546721386
cycle= 5 E= -75.3844070231975  delta_E= -2.07e-06  |g|= 7.54e-05  |ddm|= 0.0094
HOMO (B3u) = -0.443032060379304  LUMO (Ag) = -0.106682393250683
cycle= 6 E= -75.3844070255161  delta_E= -2.32e-09  |g|= 1.3e-05  |ddm|= 0.00058
HOMO (B3u) = -0.443029779172061  LUMO (Ag) = -0.106680098001415
cycle= 7 E= -75.3844070256076  delta_E= -9.15e-11  |g|= 1.64e-06  |ddm|= 2.88e-05
HOMO (B2u) = -0.443029714305102  LUMO (Ag) = -0.106679671912331
cycle= 8 E= -75.3844070256093  delta_E= -1.72e-12  |g|= 2.42e-07  |ddm|= 1.68e-05
HOMO (B2u) = -0.443029690448481  LUMO (Ag) = -0.106679577825463
cycle= 9 E= -75.3844070256093  delta_E= -5.68e-14  |g|= 1.45e-08  |ddm|= 6.37e-07
HOMO (B3u) = -0.443029691481574  LUMO (Ag) = -0.106679578763212
cycle= 10 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 7.82e-09  |ddm|= 1.24e-08
HOMO (B3u) = -0.443029688079595  LUMO (Ag) = -0.106679573943312
cycle= 11 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 1.32e-09  |ddm|= 2.42e-08
HOMO (B3u) = -0.443029688174662  LUMO (Ag) = -0.106679573995944
cycle= 12 E= -75.3844070256093  delta_E= 8.53e-14  |g|= 1.02e-09  |ddm|= 8.37e-10
HOMO (B2u) = -0.443029688162665  LUMO (Ag) = -0.106679573950343
cycle= 13 E= -75.3844070256093  delta_E= -1.42e-14  |g|= 7.95e-10  |ddm|= 7.04e-10
HOMO (B3u) = -0.443029688192742  LUMO (Ag) = -0.106679573942998
cycle= 14 E= -75.3844070256093  delta_E= 2.84e-14  |g|= 7.69e-10  |ddm|= 1.59e-09
HOMO (B3u) = -0.443029688177982  LUMO (Ag) = -0.106679573918646
cycle= 15 E= -75.3844070256094  delta_E= -1.28e-13  |g|= 6.84e-10  |ddm|= 1.78e-10
HOMO (B3u) = -0.443029688164629  LUMO (Ag) = -0.106679573895699
cycle= 16 E= -75.3844070256094  delta_E= 7.11e-14  |g|= 6.05e-10  |ddm|= 4.07e-10
HOMO (B2u) = -0.443029688050276  LUMO (Ag) = -0.106679573933457
cycle= 17 E= -75.3844070256093  delta_E= 8.53e-14  |g|= 7.85e-10  |ddm|= 6.1e-10
HOMO (B2u) = -0.443029688062634  LUMO (Ag) = -0.106679573857332
cycle= 18 E= -75.3844070256094  delta_E= -8.53e-14  |g|= 4.06e-10  |ddm|= 7.25e-10
HOMO (B2u) = -0.443029688139944  LUMO (Ag) = -0.106679573881783
cycle= 19 E= -75.3844070256093  delta_E= 7.11e-14  |g|= 1.83e-10  |ddm|= 5.25e-10
HOMO (B2u) = -0.443029688139664  LUMO (Ag) = -0.106679573877843
cycle= 20 E= -75.3844070256093  delta_E= -1.42e-14  |g|= 1.56e-10  |ddm|= 5.94e-11
HOMO (B2u) = -0.443029688142156  LUMO (Ag) = -0.106679573877066
cycle= 21 E= -75.3844070256094  delta_E= -1.14e-13  |g|= 1.35e-10  |ddm|= 6.19e-11
HOMO (B2u) = -0.443029688143596  LUMO (Ag) = -0.106679573876521
cycle= 22 E= -75.3844070256094  delta_E= 5.68e-14  |g|= 1.19e-10  |ddm|= 4.62e-11
HOMO (B2u) = -0.443029688143223  LUMO (Ag) = -0.106679573875776
cycle= 23 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 1.01e-10  |ddm|= 3.88e-11
HOMO (B2u) = -0.443029688142323  LUMO (Ag) = -0.10667957387482
cycle= 24 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 8.52e-11  |ddm|= 3.83e-11
HOMO (B2u) = -0.443029688141298  LUMO (Ag) = -0.106679573874284
cycle= 25 E= -75.3844070256093  delta_E= 2.84e-14  |g|= 7.29e-11  |ddm|= 2.96e-11
HOMO (B2u) = -0.443029688139666  LUMO (Ag) = -0.106679573866599
cycle= 26 E= -75.3844070256093  delta_E=    0  |g|= 4.75e-11  |ddm|= 4.72e-11
HOMO (B3u) = -0.443029688137385  LUMO (Ag) = -0.106679573858902
Extra cycle  E= -75.3844070256093  delta_E= -2.84e-14  |g|= 1.67e-11  |ddm|= 7.11e-11
converged SCF energy = -75.3844070256093

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp1siok27p
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5539827086618  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5763588373792  dE = -0.022376129  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5917604119778  dE = -0.015401575  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0607  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6003940119297  dE = -0.0086336  S^2 = 0.0000000
               |grad[o]|=0.0877  |ddm|=0.031  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066572787239  dE = -0.0062632668  S^2 = 0.0000000
               |grad[o]|=0.0695  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6115944226797  dE = -0.004937144  S^2 = 0.0000000
               |grad[o]|=0.0556  |ddm|=0.00767  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.615523357595  dE = -0.0039289349  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00552  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6185579794731  dE = -0.0030346219  S^2 = 0.0000000
               |grad[o]|=0.0341  |ddm|=0.00451  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.62075737496  dE = -0.0021993955  S^2 = 0.0000000
               |grad[o]|=0.0252  |ddm|=0.00408  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6221629715031  dE = -0.0014055965  S^2 = 0.0000000
               |grad[o]|=0.017  |ddm|=0.00399  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6228190649018  dE = -0.0006560934  S^2 = 0.0000000
               |grad[o]|=0.00956  |ddm|=0.00414  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6228849775873  dE = -6.5912686e-05  S^2 = 0.0000000
               |grad[o]|=0.00284  |ddm|=0.00447  |maxRot[o]|=0.0322
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6228858553638  dE = -8.777765e-07  S^2 = 0.0000000
               |grad[o]|=0.000486  |ddm|=0.00205  |maxRot[o]|=0.00324
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6228858734362  dE = -1.807237e-08  S^2 = 0.0000000
               |grad[o]|=7.86e-05  |ddm|=0.000399  |maxRot[o]|=0.000423
macro iter 14 (3 JK  0 micro), CASSCF E = -75.622885873879  dE = -4.4282444e-10  S^2 = 0.0000000
               |grad[o]|=1.27e-05  |ddm|=8.07e-05  |maxRot[o]|=6.85e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6228858738904  dE = -1.1354473e-11  S^2 = 0.0000000
               |grad[o]|=2.51e-06  |ddm|=1.82e-05  |maxRot[o]|=1.16e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98259212 1.6238229  1.87827428 1.87827435 0.37239279 0.12484127
 0.12484106 0.01496124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00430   0.00292   0.00000   0.00000  -0.00121
  0 C 2s       0.59918   0.53182   0.00000  -0.00000  -0.37268
  0 C 3s      -0.04557   0.00882   0.00000  -0.00000  -0.00652
  0 C 2px      0.00000  -0.00000  -0.00000   0.70645   0.00000
  0 C 2py      0.00000   0.00000   0.70645  -0.00000  -0.00000
  0 C 2pz      0.36821  -0.46590  -0.00000   0.00000   0.59928
  0 C 3px      0.00000  -0.00000   0.00000  -0.00317  -0.00000
  0 C 3py      0.00000   0.00000  -0.00317  -0.00000  -0.00000
  0 C 3pz     -0.04436  -0.00424   0.00000  -0.00000  -0.04182
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.03019  -0.00000  -0.00000
  0 C 3dz^2    0.03661   0.00082   0.00000  -0.00000   0.01349
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03019  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00430  -0.00292   0.00000   0.00000  -0.00121
  1 C 2s       0.59918  -0.53182   0.00000   0.00000  -0.37268
  1 C 3s      -0.04557  -0.00882  -0.00000   0.00000  -0.00652
  1 C 2px     -0.00000   0.00000  -0.00000   0.70645   0.00000
  1 C 2py     -0.00000  -0.00000   0.70645  -0.00000  -0.00000
  1 C 2pz     -0.36821  -0.46590   0.00000  -0.00000  -0.59928
  1 C 3px     -0.00000   0.00000   0.00000  -0.00317  -0.00000
  1 C 3py     -0.00000  -0.00000  -0.00317   0.00000   0.00000
  1 C 3pz      0.04436  -0.00424   0.00000  -0.00000   0.04182
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03019  -0.00000  -0.00000
  1 C 3dz^2    0.03661  -0.00082  -0.00000   0.00000   0.01349
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.03019   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00063
  0 C 2s      -0.00000   0.00000   0.46522
  0 C 3s      -0.00000   0.00000  -0.04289
  0 C 2px      0.70635  -0.00000  -0.00000
  0 C 2py      0.00000   0.70635   0.00000
  0 C 2pz     -0.00000  -0.00000   0.53006
  0 C 3px     -0.02272   0.00000  -0.00000
  0 C 3py      0.00000  -0.02272   0.00000
  0 C 3pz     -0.00000   0.00000   0.01231
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02357   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02477
  0 C 3dxz    -0.02357   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00063
  1 C 2s       0.00000  -0.00000  -0.46522
  1 C 3s       0.00000  -0.00000   0.04289
  1 C 2px     -0.70635  -0.00000   0.00000
  1 C 2py      0.00000  -0.70635  -0.00000
  1 C 2pz     -0.00000   0.00000   0.53006
  1 C 3px      0.02272  -0.00000   0.00000
  1 C 3py     -0.00000   0.02272  -0.00000
  1 C 3pz     -0.00000   0.00000   0.01231
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02357   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02477
  1 C 3dxz    -0.02357   0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99403735
<CAS-nat-orb|mo-hf>  4  4    0.99839928
<CAS-nat-orb|mo-hf>  5  5    0.99974564
<CAS-nat-orb|mo-hf>  6  6    0.99974564
<CAS-nat-orb|mo-hf>  7  7    0.97790009
<CAS-nat-orb|mo-hf>  8  8    0.94457117
<CAS-nat-orb|mo-hf>  9  9    0.94457115
<CAS-nat-orb|mo-hf>  10  10    0.51114031
<CAS-nat-orb|mo-hf>  10  17    0.67613315
<CAS-nat-orb|mo-hf>  10  18   -0.49120162
CASSCF energy = -75.6228858738904
CASCI E = -75.6228858738904  E(CI) = -17.4344345074021  S^2 = 0.0000000
......production of RDMs took       2.49 sec
......reading the RDM took          0.42 sec
......production of RDMs took      25.42 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickICMRREPT2-ijrs) =    -0.00029259271055
E(WickICMRREPT2- rsi) =    -0.00104552937789
E(WickICMRREPT2- ijr) =    -0.00040365209345
E(WickICMRREPT2-  rs) =    -0.05370157474690
E(WickICMRREPT2-  ij) =    -0.00014353608760
E(WickICMRREPT2-  ir) =    -0.00133542107111
E(WickICMRREPT2-   r) =    -0.05298665014528
E(WickICMRREPT2-   i) =    -0.00030094294832
E(WickICMRREPT2) = -75.73309577307145  E_corr_pt = -0.1102098991810874
Timings = pdms =   38.14 | eris =    0.18 | ijrs =    1.26 | rsi =   31.67 | ijr =    0.42 | rs =  691.76 | ij =    1.31 | ir =   33.00 | r =  165.88 | i =    2.47 | total =  966.16
Time cost =   1020.677
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:14:59 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.322943027300 AA    0.000000000000   0.000000000000   2.500000000000 Bohr   0.0

nuclear repulsion = 14.4
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.25]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    206938.76


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpwpxj5ecy
max_memory 4000 MB (current use 406 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.3694175262293

WARN: Singularity detected in overlap matrix (condition number =  483). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.23337660812262  LUMO (Ag) = -0.177980136770164
cycle= 1 E= -75.3638092539421  delta_E= 0.00561  |g|= 0.211  |ddm|= 1.47
HOMO (B3u) = -0.472745514482946  LUMO (Ag) = -0.148264279814743
cycle= 2 E= -75.3797344374882  delta_E= -0.0159  |g|= 0.0521  |ddm|= 0.252
HOMO (B3u) = -0.435707130637767  LUMO (Ag) = -0.107623543297931
cycle= 3 E= -75.3805941182358  delta_E= -0.00086  |g|= 0.00941  |ddm|= 0.058
HOMO (B3u) = -0.436826447423379  LUMO (Ag) = -0.105984728580028
cycle= 4 E= -75.3806472395887  delta_E= -5.31e-05  |g|= 0.00184  |ddm|= 0.0247
HOMO (B2u) = -0.437581210136122  LUMO (Ag) = -0.106606422286033
cycle= 5 E= -75.3806494262655  delta_E= -2.19e-06  |g|= 0.000123  |ddm|= 0.0084
HOMO (B3u) = -0.437555273305045  LUMO (Ag) = -0.10656539372915
cycle= 6 E= -75.3806494342396  delta_E= -7.97e-09  |g|= 2.47e-05  |ddm|= 0.000449
HOMO (B3u) = -0.437550531930268  LUMO (Ag) = -0.106557643143777
cycle= 7 E= -75.3806494346657  delta_E= -4.26e-10  |g|= 3.1e-06  |ddm|= 0.000106
HOMO (B2u) = -0.437550642586866  LUMO (Ag) = -0.106557057009241
cycle= 8 E= -75.380649434671  delta_E= -5.27e-12  |g|= 3.13e-07  |ddm|= 2.83e-05
HOMO (B2u) = -0.437550627656793  LUMO (Ag) = -0.106556986158697
cycle= 9 E= -75.380649434671  delta_E= -4.26e-14  |g|= 1.55e-08  |ddm|= 1.79e-06
HOMO (B3u) = -0.4375506246514  LUMO (Ag) = -0.106556982907058
cycle= 10 E= -75.380649434671  delta_E= -2.84e-14  |g|= 1.93e-09  |ddm|= 3.86e-08
HOMO (B3u) = -0.437550624840447  LUMO (Ag) = -0.106556983052112
cycle= 11 E= -75.3806494346709  delta_E= 1.14e-13  |g|= 1.16e-09  |ddm|= 1.35e-09
HOMO (B2u) = -0.43755062501801  LUMO (Ag) = -0.106556983191352
cycle= 12 E= -75.380649434671  delta_E= -8.53e-14  |g|= 9.85e-10  |ddm|= 6.47e-10
HOMO (B3u) = -0.437550624988796  LUMO (Ag) = -0.106556983147044
cycle= 13 E= -75.380649434671  delta_E= -2.84e-14  |g|= 7.68e-10  |ddm|= 7.52e-10
HOMO (B3u) = -0.437550624985823  LUMO (Ag) = -0.106556983114127
cycle= 14 E= -75.380649434671  delta_E= 2.84e-14  |g|= 6.87e-10  |ddm|= 1.08e-09
HOMO (B3u) = -0.437550624978589  LUMO (Ag) = -0.106556983103347
cycle= 15 E= -75.3806494346709  delta_E= 7.11e-14  |g|= 6e-10  |ddm|= 5.84e-10
HOMO (B3u) = -0.437550624975672  LUMO (Ag) = -0.10655698313039
cycle= 16 E= -75.3806494346711  delta_E= -1.28e-13  |g|= 5.59e-10  |ddm|= 9.15e-10
HOMO (B3u) = -0.437550624901701  LUMO (Ag) = -0.106556983103943
cycle= 17 E= -75.3806494346711  delta_E= -2.84e-14  |g|= 6.12e-10  |ddm|= 8.53e-10
HOMO (B3u) = -0.437550624887877  LUMO (Ag) = -0.106556983015185
cycle= 18 E= -75.380649434671  delta_E= 8.53e-14  |g|= 2.05e-10  |ddm|= 9.05e-10
HOMO (B3u) = -0.437550624885897  LUMO (Ag) = -0.106556983008111
cycle= 19 E= -75.3806494346709  delta_E= 5.68e-14  |g|= 1.63e-10  |ddm|= 1.04e-10
HOMO (B3u) = -0.437550624886919  LUMO (Ag) = -0.106556983005937
cycle= 20 E= -75.3806494346709  delta_E= 2.84e-14  |g|= 1.38e-10  |ddm|= 7.49e-11
HOMO (B3u) = -0.437550624892209  LUMO (Ag) = -0.106556983008104
cycle= 21 E= -75.380649434671  delta_E= -9.95e-14  |g|= 1.15e-10  |ddm|= 7.47e-11
HOMO (B2u) = -0.437550624896348  LUMO (Ag) = -0.106556983009837
cycle= 22 E= -75.380649434671  delta_E= 2.84e-14  |g|= 9.81e-11  |ddm|= 6.13e-11
HOMO (B2u) = -0.437550624898562  LUMO (Ag) = -0.106556983011157
cycle= 23 E= -75.380649434671  delta_E= -5.68e-14  |g|= 8.23e-11  |ddm|= 3.86e-11
HOMO (B2u) = -0.437550624900173  LUMO (Ag) = -0.106556983011909
cycle= 24 E= -75.3806494346709  delta_E= 1.42e-13  |g|= 6.8e-11  |ddm|= 3.11e-11
HOMO (B2u) = -0.437550624901783  LUMO (Ag) = -0.106556983011187
cycle= 25 E= -75.380649434671  delta_E= -9.95e-14  |g|= 5.24e-11  |ddm|= 3.54e-11
HOMO (B2u) = -0.43755062490255  LUMO (Ag) = -0.106556983007958
cycle= 26 E= -75.380649434671  delta_E=    0  |g|= 3.38e-11  |ddm|= 3.23e-11
HOMO (B3u) = -0.43755062490041  LUMO (Ag) = -0.106556983002201
Extra cycle  E= -75.380649434671  delta_E= 1.42e-14  |g|= 1.14e-11  |ddm|= 4.34e-11
converged SCF energy = -75.380649434671

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpwpxj5ecy
max_memory 4000 MB (current use 407 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5520156742898  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5749557691933  dE = -0.022940095  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5893075599885  dE = -0.014351791  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0633  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5977719040475  dE = -0.0084643441  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0299  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6039893910607  dE = -0.006217487  S^2 = 0.0000000
               |grad[o]|=0.071  |ddm|=0.0135  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6089055501039  dE = -0.004916159  S^2 = 0.0000000
               |grad[o]|=0.0571  |ddm|=0.00833  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6128209543771  dE = -0.0039154043  S^2 = 0.0000000
               |grad[o]|=0.0454  |ddm|=0.00602  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6158466050391  dE = -0.0030256507  S^2 = 0.0000000
               |grad[o]|=0.0352  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6180396311161  dE = -0.0021930261  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194395133813  dE = -0.0013998823  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00412  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6200886537404  dE = -0.00064914036  S^2 = 0.0000000
               |grad[o]|=0.00981  |ddm|=0.00428  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201507320497  dE = -6.2078309e-05  S^2 = 0.0000000
               |grad[o]|=0.00282  |ddm|=0.00468  |maxRot[o]|=0.0311
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201515477166  dE = -8.1566691e-07  S^2 = 0.0000000
               |grad[o]|=0.000473  |ddm|=0.00207  |maxRot[o]|=0.00307
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201515643291  dE = -1.6612489e-08  S^2 = 0.0000000
               |grad[o]|=7.49e-05  |ddm|=0.000374  |maxRot[o]|=0.000396
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6201515647232  dE = -3.94067e-10  S^2 = 0.0000000
               |grad[o]|=1.22e-05  |ddm|=7.4e-05  |maxRot[o]|=6.42e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6201515647411  dE = -1.7863044e-11  S^2 = 0.0000000
               |grad[o]|=2.58e-06  |ddm|=1.82e-05  |maxRot[o]|=1.12e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98175021 1.63550775 1.8711556  1.87115624 0.3611846  0.13173008
 0.1317302  0.01578531]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00465   0.00301   0.00000   0.00000  -0.00114
  0 C 2s       0.60227   0.53958  -0.00000  -0.00000  -0.36778
  0 C 3s      -0.04374   0.00880  -0.00000  -0.00000  -0.00363
  0 C 2px      0.00000  -0.00000  -0.00000   0.70650  -0.00000
  0 C 2py      0.00000   0.00000   0.70650  -0.00000   0.00000
  0 C 2pz      0.36367  -0.45689  -0.00000  -0.00000   0.60227
  0 C 3px      0.00000  -0.00000   0.00000  -0.00009   0.00000
  0 C 3py     -0.00000   0.00000  -0.00009  -0.00000   0.00000
  0 C 3pz     -0.04268  -0.00383  -0.00000  -0.00000  -0.04233
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.02932  -0.00000   0.00000
  0 C 3dz^2    0.03544   0.00032  -0.00000  -0.00000   0.01448
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02932   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00465  -0.00301   0.00000   0.00000  -0.00114
  1 C 2s       0.60227  -0.53958   0.00000   0.00000  -0.36778
  1 C 3s      -0.04374  -0.00880   0.00000   0.00000  -0.00363
  1 C 2px     -0.00000   0.00000  -0.00000   0.70650  -0.00000
  1 C 2py      0.00000  -0.00000   0.70650   0.00000  -0.00000
  1 C 2pz     -0.36367  -0.45689  -0.00000   0.00000  -0.60227
  1 C 3px     -0.00000   0.00000   0.00000  -0.00009   0.00000
  1 C 3py     -0.00000  -0.00000  -0.00009   0.00000  -0.00000
  1 C 3pz      0.04268  -0.00383  -0.00000  -0.00000   0.04233
  1 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000  -0.02932  -0.00000   0.00000
  1 C 3dz^2    0.03544  -0.00032   0.00000   0.00000   0.01448
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02932  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s      -0.00000  -0.00000   0.45623
  0 C 3s      -0.00000  -0.00000  -0.04293
  0 C 2px      0.70638   0.00000  -0.00000
  0 C 2py      0.00000   0.70638  -0.00000
  0 C 2pz      0.00000  -0.00000   0.53783
  0 C 3px     -0.02172   0.00000  -0.00000
  0 C 3py      0.00000  -0.02172  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01389
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02345  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02369
  0 C 3dxz    -0.02345   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s       0.00000   0.00000  -0.45623
  1 C 3s       0.00000   0.00000   0.04293
  1 C 2px     -0.70638  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70638   0.00000
  1 C 2pz      0.00000  -0.00000   0.53783
  1 C 3px      0.02172  -0.00000   0.00000
  1 C 3py     -0.00000   0.02172   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01389
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02345  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02369
  1 C 3dxz    -0.02345   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99374273
<CAS-nat-orb|mo-hf>  4  4    0.99831642
<CAS-nat-orb|mo-hf>  5  5    0.99972153
<CAS-nat-orb|mo-hf>  6  6    0.99972153
<CAS-nat-orb|mo-hf>  7  7    0.97735853
<CAS-nat-orb|mo-hf>  8  8    0.94866393
<CAS-nat-orb|mo-hf>  9  9    0.94866398
<CAS-nat-orb|mo-hf>  10  10    0.53130849
<CAS-nat-orb|mo-hf>  10  17    0.68518248
<CAS-nat-orb|mo-hf>  10  18   -0.46282807
CASSCF energy = -75.6201515647411
CASCI E = -75.6201515647411  E(CI) = -17.3010863052877  S^2 = 0.0000000
......production of RDMs took       1.99 sec
......reading the RDM took          0.41 sec
......production of RDMs took      22.44 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.80 sec

E(WickICMRREPT2-ijrs) =    -0.00028575369941
E(WickICMRREPT2- rsi) =    -0.00102556902106
E(WickICMRREPT2- ijr) =    -0.00039664113998
E(WickICMRREPT2-  rs) =    -0.05320589284886
E(WickICMRREPT2-  ij) =    -0.00013827426932
E(WickICMRREPT2-  ir) =    -0.00131662631115
E(WickICMRREPT2-   r) =    -0.05387173939066
E(WickICMRREPT2-   i) =    -0.00029461054659
E(WickICMRREPT2) = -75.73068667196809  E_corr_pt = -0.1105351072270316
Timings = pdms =   34.66 | eris =    0.10 | ijrs =    1.16 | rsi =   34.66 | ijr =    0.43 | rs =  683.31 | ij =    1.34 | ir =   25.38 | r =  171.64 | i =    2.42 | total =  955.16
Time cost =   1016.480
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:31:56 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.349401887846 AA    0.000000000000   0.000000000000   2.550000000000 Bohr   0.0

nuclear repulsion = 14.1176470588235
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.275]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    222775.72


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpx7pzyais
max_memory 4000 MB (current use 404 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.322852658808

WARN: Singularity detected in overlap matrix (condition number =  444). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.224183141291851  LUMO (Ag) = -0.175375833613538
cycle= 1 E= -75.3580302281756  delta_E= -0.0352  |g|= 0.215  |ddm|= 1.46
HOMO (B3u) = -0.467759172708486  LUMO (Ag) = -0.149454753798778
cycle= 2 E= -75.3746497165004  delta_E= -0.0166  |g|= 0.0521  |ddm|= 0.26
HOMO (B2u) = -0.430516793980389  LUMO (Ag) = -0.107753824209472
cycle= 3 E= -75.3755305907904  delta_E= -0.000881  |g|= 0.00966  |ddm|= 0.0568
HOMO (B3u) = -0.431561534231317  LUMO (Ag) = -0.105750596270454
cycle= 4 E= -75.3755868789759  delta_E= -5.63e-05  |g|= 0.00191  |ddm|= 0.0225
HOMO (B2u) = -0.432324246357023  LUMO (Ag) = -0.106325540767303
cycle= 5 E= -75.3755892675814  delta_E= -2.39e-06  |g|= 0.000174  |ddm|= 0.00743
HOMO (B3u) = -0.432284401985624  LUMO (Ag) = -0.106263967776658
cycle= 6 E= -75.3755892854562  delta_E= -1.79e-08  |g|= 3.01e-05  |ddm|= 0.000369
HOMO (B2u) = -0.432278729183659  LUMO (Ag) = -0.106254488809744
cycle= 7 E= -75.3755892860986  delta_E= -6.42e-10  |g|= 3.64e-06  |ddm|= 0.000169
HOMO (B3u) = -0.432278901425316  LUMO (Ag) = -0.106253945307343
cycle= 8 E= -75.3755892861055  delta_E= -6.86e-12  |g|= 3.45e-07  |ddm|= 2.86e-05
HOMO (B3u) = -0.43227888334402  LUMO (Ag) = -0.106253871171903
cycle= 9 E= -75.3755892861055  delta_E= -2.84e-14  |g|= 1.65e-08  |ddm|= 2.14e-06
HOMO (B3u) = -0.432278879789837  LUMO (Ag) = -0.106253868646633
cycle= 10 E= -75.3755892861055  delta_E=    0  |g|= 2.15e-09  |ddm|= 4.37e-08
HOMO (B2u) = -0.432278879879025  LUMO (Ag) = -0.106253868644967
cycle= 11 E= -75.3755892861056  delta_E= -8.53e-14  |g|= 1.25e-09  |ddm|= 1.97e-09
HOMO (B2u) = -0.432278880147105  LUMO (Ag) = -0.106253868888645
cycle= 12 E= -75.3755892861055  delta_E= 1.28e-13  |g|= 1.12e-09  |ddm|= 7.81e-10
HOMO (B2u) = -0.432278880103143  LUMO (Ag) = -0.106253868831182
cycle= 13 E= -75.3755892861056  delta_E= -8.53e-14  |g|= 8.77e-10  |ddm|= 8.34e-10
HOMO (B2u) = -0.432278880095398  LUMO (Ag) = -0.106253868793957
cycle= 14 E= -75.3755892861055  delta_E= 2.84e-14  |g|= 7.51e-10  |ddm|= 1.07e-09
HOMO (B2u) = -0.432278880082018  LUMO (Ag) = -0.106253868781045
cycle= 15 E= -75.3755892861055  delta_E= 1.42e-14  |g|= 6.69e-10  |ddm|= 7.69e-10
HOMO (B2u) = -0.432278880084762  LUMO (Ag) = -0.106253868820464
cycle= 16 E= -75.3755892861056  delta_E= -4.26e-14  |g|= 6.26e-10  |ddm|= 1.16e-09
HOMO (B2u) = -0.432278880012604  LUMO (Ag) = -0.106253868780537
cycle= 17 E= -75.3755892861056  delta_E= -1.42e-14  |g|= 6.64e-10  |ddm|= 8.18e-10
HOMO (B2u) = -0.432278879978669  LUMO (Ag) = -0.106253868675703
cycle= 18 E= -75.3755892861056  delta_E= 1.42e-14  |g|= 2.3e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.432278879978225  LUMO (Ag) = -0.106253868669066
cycle= 19 E= -75.3755892861056  delta_E= -2.84e-14  |g|= 1.82e-10  |ddm|= 1.32e-10
HOMO (B2u) = -0.432278879978719  LUMO (Ag) = -0.106253868666427
cycle= 20 E= -75.3755892861056  delta_E=    0  |g|= 1.56e-10  |ddm|= 8.94e-11
HOMO (B2u) = -0.432278879985325  LUMO (Ag) = -0.10625386866965
cycle= 21 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 1.29e-10  |ddm|= 9.02e-11
HOMO (B2u) = -0.432278879990324  LUMO (Ag) = -0.106253868672056
cycle= 22 E= -75.3755892861056  delta_E= -1.42e-14  |g|= 1.09e-10  |ddm|= 7.54e-11
HOMO (B2u) = -0.432278879993528  LUMO (Ag) = -0.106253868674141
cycle= 23 E= -75.3755892861056  delta_E= -5.68e-14  |g|= 9.22e-11  |ddm|= 5.24e-11
HOMO (B2u) = -0.432278879995727  LUMO (Ag) = -0.106253868675061
cycle= 24 E= -75.3755892861057  delta_E= -4.26e-14  |g|= 7.6e-11  |ddm|= 3.89e-11
HOMO (B2u) = -0.432278879998036  LUMO (Ag) = -0.106253868674347
cycle= 25 E= -75.3755892861055  delta_E= 1.28e-13  |g|= 5.8e-11  |ddm|= 3.65e-11
HOMO (B2u) = -0.432278879999228  LUMO (Ag) = -0.106253868671492
cycle= 26 E= -75.3755892861055  delta_E= -1.42e-14  |g|= 3.79e-11  |ddm|= 3.59e-11
HOMO (B3u) = -0.432278879998795  LUMO (Ag) = -0.106253868670044
cycle= 27 E= -75.3755892861055  delta_E= 2.84e-14  |g|= 3.16e-11  |ddm|= 1.15e-11
HOMO (B2u) = -0.432278879998263  LUMO (Ag) = -0.106253868668729
cycle= 28 E= -75.3755892861056  delta_E= -5.68e-14  |g|= 2.65e-11  |ddm|= 9.1e-12
HOMO (B3u) = -0.432278879997694  LUMO (Ag) = -0.106253868667471
cycle= 29 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 2.2e-11  |ddm|= 8.27e-12
HOMO (B3u) = -0.432278879997303  LUMO (Ag) = -0.106253868666467
cycle= 30 E= -75.3755892861056  delta_E= -5.68e-14  |g|= 1.82e-11  |ddm|= 7.41e-12
HOMO (B3u) = -0.432278879997036  LUMO (Ag) = -0.106253868665642
cycle= 31 E= -75.3755892861054  delta_E= 1.42e-13  |g|= 1.49e-11  |ddm|= 7.21e-12
HOMO (B2u) = -0.432278879996887  LUMO (Ag) = -0.106253868664932
cycle= 32 E= -75.3755892861056  delta_E= -1.42e-13  |g|= 1.2e-11  |ddm|= 6.94e-12
HOMO (B3u) = -0.432278879996836  LUMO (Ag) = -0.10625386866434
cycle= 33 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 9.44e-12  |ddm|= 6.12e-12
HOMO (B2u) = -0.432278879996874  LUMO (Ag) = -0.10625386866394
cycle= 34 E= -75.3755892861055  delta_E=    0  |g|= 7.51e-12  |ddm|= 4.63e-12
HOMO (B3u) = -0.432278879997003  LUMO (Ag) = -0.106253868662991
Extra cycle  E= -75.3755892861055  delta_E= -2.84e-14  |g|= 2.79e-12  |ddm|= 1.34e-11
converged SCF energy = -75.3755892861055

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpx7pzyais
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5487757489253  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5722752896034  dE = -0.023499541  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5857503370596  dE = -0.013475047  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0659  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5940452784949  dE = -0.0082949414  S^2 = 0.0000000
               |grad[o]|=0.0897  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6002049422473  dE = -0.0061596638  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0141  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.60508199247  dE = -0.0048770502  S^2 = 0.0000000
               |grad[o]|=0.0582  |ddm|=0.00893  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6089574830213  dE = -0.0038754906  S^2 = 0.0000000
               |grad[o]|=0.0463  |ddm|=0.00649  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6119399769377  dE = -0.0029824939  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00515  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6140852968683  dE = -0.0021453199  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00446  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6154329692987  dE = -0.0013476724  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6160256604574  dE = -0.00059269116  S^2 = 0.0000000
               |grad[o]|=0.00954  |ddm|=0.00447  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6160629694776  dE = -3.730902e-05  S^2 = 0.0000000
               |grad[o]|=0.00234  |ddm|=0.00498  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6160660554412  dE = -3.0859635e-06  S^2 = 0.0000000
               |grad[o]|=0.000716  |ddm|=0.00145  |maxRot[o]|=0.00665
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6160661048488  dE = -4.9407674e-08  S^2 = 0.0000000
               |grad[o]|=0.000124  |ddm|=0.000549  |maxRot[o]|=0.000717
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6160661059014  dE = -1.0525696e-09  S^2 = 0.0000000
               |grad[o]|=2.01e-05  |ddm|=0.000101  |maxRot[o]|=9.9e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6160661059281  dE = -2.6645353e-11  S^2 = 0.0000000
               |grad[o]|=3.08e-06  |ddm|=1.97e-05  |maxRot[o]|=1.59e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98089624 1.64657025 1.86373136 1.86373183 0.35078066 0.13883179
 0.13883164 0.01662622]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00498   0.00310   0.00000   0.00000  -0.00109
  0 C 2s       0.60537   0.54713  -0.00000   0.00000  -0.36277
  0 C 3s      -0.04187   0.00880  -0.00000  -0.00000  -0.00080
  0 C 2px      0.00000  -0.00000   0.00000   0.70653  -0.00000
  0 C 2py      0.00000  -0.00000   0.70653  -0.00000   0.00000
  0 C 2pz      0.35902  -0.44783   0.00000   0.00000   0.60525
  0 C 3px     -0.00000   0.00000   0.00000   0.00282   0.00000
  0 C 3py     -0.00000   0.00000   0.00282   0.00000   0.00000
  0 C 3pz     -0.04100  -0.00346  -0.00000  -0.00000  -0.04273
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.02846  -0.00000   0.00000
  0 C 3dz^2    0.03432  -0.00016  -0.00000  -0.00000   0.01561
  0 C 3dxz    -0.00000   0.00000   0.00000   0.02846   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00498  -0.00310   0.00000   0.00000  -0.00109
  1 C 2s       0.60537  -0.54713   0.00000   0.00000  -0.36277
  1 C 3s      -0.04187  -0.00880   0.00000   0.00000  -0.00080
  1 C 2px      0.00000  -0.00000  -0.00000   0.70653  -0.00000
  1 C 2py      0.00000  -0.00000   0.70653  -0.00000  -0.00000
  1 C 2pz     -0.35902  -0.44783   0.00000   0.00000  -0.60525
  1 C 3px     -0.00000   0.00000  -0.00000   0.00282   0.00000
  1 C 3py     -0.00000   0.00000   0.00282   0.00000  -0.00000
  1 C 3pz      0.04100  -0.00346  -0.00000  -0.00000   0.04273
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02846  -0.00000   0.00000
  1 C 3dz^2    0.03432   0.00016   0.00000  -0.00000   0.01561
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.02846  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s       0.00000  -0.00000   0.44717
  0 C 3s       0.00000   0.00000  -0.04302
  0 C 2px      0.70642  -0.00000   0.00000
  0 C 2py      0.00000   0.70642   0.00000
  0 C 2pz      0.00000   0.00000   0.54537
  0 C 3px     -0.02076  -0.00000   0.00000
  0 C 3py     -0.00000  -0.02076   0.00000
  0 C 3pz      0.00000   0.00000   0.01534
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02331   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02287
  0 C 3dxz    -0.02331  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000  -0.00000  -0.44717
  1 C 3s      -0.00000  -0.00000   0.04302
  1 C 2px     -0.70642   0.00000  -0.00000
  1 C 2py      0.00000  -0.70642   0.00000
  1 C 2pz      0.00000  -0.00000   0.54537
  1 C 3px      0.02076   0.00000  -0.00000
  1 C 3py     -0.00000   0.02076  -0.00000
  1 C 3pz      0.00000  -0.00000   0.01534
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02331   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02287
  1 C 3dxz    -0.02331  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99344302
<CAS-nat-orb|mo-hf>  4  4    0.99822556
<CAS-nat-orb|mo-hf>  5  5    0.99969500
<CAS-nat-orb|mo-hf>  6  6    0.99969500
<CAS-nat-orb|mo-hf>  7  7    0.97683028
<CAS-nat-orb|mo-hf>  8  8    0.95239324
<CAS-nat-orb|mo-hf>  9  9    0.95239327
<CAS-nat-orb|mo-hf>  10  10    0.55278430
<CAS-nat-orb|mo-hf>  10  17    0.68990824
<CAS-nat-orb|mo-hf>  10  18   -0.43567179
CASSCF energy = -75.6160661059281
CASCI E = -75.6160661059281  E(CI) = -17.1715111507163  S^2 = 0.0000000
......production of RDMs took       1.83 sec
......reading the RDM took          0.42 sec
......production of RDMs took      23.82 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.87 sec

E(WickICMRREPT2-ijrs) =    -0.00028007675194
E(WickICMRREPT2- rsi) =    -0.00100773439209
E(WickICMRREPT2- ijr) =    -0.00038982807978
E(WickICMRREPT2-  rs) =    -0.05270251862798
E(WickICMRREPT2-  ij) =    -0.00013293368256
E(WickICMRREPT2-  ir) =    -0.00129847323157
E(WickICMRREPT2-   r) =    -0.05477915867729
E(WickICMRREPT2-   i) =    -0.00028831958689
E(WickICMRREPT2) = -75.72694514895815  E_corr_pt = -0.1108790430300942
Timings = pdms =   35.96 | eris =    0.03 | ijrs =    1.17 | rsi =   32.66 | ijr =    0.42 | rs =  710.24 | ij =    1.39 | ir =   25.85 | r =  174.11 | i =    2.30 | total =  984.20
Time cost =   1052.974
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:49:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.375860748392 AA    0.000000000000   0.000000000000   2.600000000000 Bohr   0.0

nuclear repulsion = 13.8461538461538
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.3]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    239239.79


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpd_4ha6gq
max_memory 4000 MB (current use 406 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.278195813693

WARN: Singularity detected in overlap matrix (condition number =  409). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.215477115824915  LUMO (Ag) = -0.172896295276614
cycle= 1 E= -75.3511756370243  delta_E= -0.073  |g|= 0.218  |ddm|= 1.45
HOMO (B3u) = -0.462888168119373  LUMO (Ag) = -0.150366392380423
cycle= 2 E= -75.3684890547635  delta_E= -0.0173  |g|= 0.0521  |ddm|= 0.268
HOMO (B3u) = -0.425477509345155  LUMO (Ag) = -0.107647319512262
cycle= 3 E= -75.3693914994859  delta_E= -0.000902  |g|= 0.00999  |ddm|= 0.056
HOMO (B3u) = -0.426482502338426  LUMO (Ag) = -0.105320428216434
cycle= 4 E= -75.3694522894417  delta_E= -6.08e-05  |g|= 0.002  |ddm|= 0.0206
HOMO (B3u) = -0.427253849930312  LUMO (Ag) = -0.105864709294583
cycle= 5 E= -75.3694549331517  delta_E= -2.64e-06  |g|= 0.000217  |ddm|= 0.00651
HOMO (B3u) = -0.427202128961971  LUMO (Ag) = -0.105788865113736
cycle= 6 E= -75.3694549621127  delta_E= -2.9e-08  |g|= 3.29e-05  |ddm|= 0.000392
HOMO (B3u) = -0.427195922281597  LUMO (Ag) = -0.105778621503353
cycle= 7 E= -75.3694549628765  delta_E= -7.64e-10  |g|= 4.04e-06  |ddm|= 0.000193
HOMO (B3u) = -0.427196084833628  LUMO (Ag) = -0.105778048731884
cycle= 8 E= -75.3694549628847  delta_E= -8.14e-12  |g|= 3.71e-07  |ddm|= 2.79e-05
HOMO (B3u) = -0.427196062616083  LUMO (Ag) = -0.105777966013368
cycle= 9 E= -75.3694549628848  delta_E= -1.42e-13  |g|= 1.75e-08  |ddm|= 2.3e-06
HOMO (B3u) = -0.427196058477426  LUMO (Ag) = -0.105777964390644
cycle= 10 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 2.34e-09  |ddm|= 4.88e-08
HOMO (B3u) = -0.427196058540048  LUMO (Ag) = -0.105777964319719
cycle= 11 E= -75.3694549628848  delta_E=    0  |g|= 1.38e-09  |ddm|= 2.22e-09
HOMO (B3u) = -0.427196058853204  LUMO (Ag) = -0.105777964634842
cycle= 12 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 1.26e-09  |ddm|= 6.43e-10
HOMO (B3u) = -0.427196058813178  LUMO (Ag) = -0.105777964580159
cycle= 13 E= -75.3694549628848  delta_E= -1.42e-14  |g|= 9.72e-10  |ddm|= 1.24e-09
HOMO (B3u) = -0.427196058786745  LUMO (Ag) = -0.105777964525543
cycle= 14 E= -75.3694549628847  delta_E= 9.95e-14  |g|= 8.27e-10  |ddm|= 8.56e-10
HOMO (B3u) = -0.42719605877429  LUMO (Ag) = -0.105777964513247
cycle= 15 E= -75.3694549628848  delta_E= -4.26e-14  |g|= 7.31e-10  |ddm|= 9.13e-10
HOMO (B2u) = -0.427196058775775  LUMO (Ag) = -0.105777964556291
cycle= 16 E= -75.3694549628848  delta_E= -4.26e-14  |g|= 6.89e-10  |ddm|= 1.23e-09
HOMO (B3u) = -0.427196058708854  LUMO (Ag) = -0.105777964510998
cycle= 17 E= -75.3694549628848  delta_E= 5.68e-14  |g|= 7.12e-10  |ddm|= 6.42e-10
HOMO (B2u) = -0.427196058654539  LUMO (Ag) = -0.105777964390979
cycle= 18 E= -75.3694549628848  delta_E=    0  |g|= 2.57e-10  |ddm|= 1.18e-09
HOMO (B2u) = -0.427196058655084  LUMO (Ag) = -0.105777964384665
cycle= 19 E= -75.3694549628848  delta_E= -8.53e-14  |g|= 2.03e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.427196058656324  LUMO (Ag) = -0.105777964382567
cycle= 20 E= -75.3694549628848  delta_E= 8.53e-14  |g|= 1.73e-10  |ddm|= 1.11e-10
HOMO (B2u) = -0.427196058664099  LUMO (Ag) = -0.105777964386711
cycle= 21 E= -75.3694549628848  delta_E= -5.68e-14  |g|= 1.43e-10  |ddm|= 1.08e-10
HOMO (B2u) = -0.427196058670204  LUMO (Ag) = -0.105777964389918
cycle= 22 E= -75.3694549628848  delta_E=    0  |g|= 1.2e-10  |ddm|= 8.42e-11
HOMO (B2u) = -0.427196058674202  LUMO (Ag) = -0.105777964392569
cycle= 23 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 1.01e-10  |ddm|= 6.62e-11
HOMO (B2u) = -0.427196058677073  LUMO (Ag) = -0.105777964393948
cycle= 24 E= -75.3694549628848  delta_E= 4.26e-14  |g|= 8.3e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.427196058679971  LUMO (Ag) = -0.10577796439347
cycle= 25 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 6.32e-11  |ddm|= 3.74e-11
HOMO (B2u) = -0.427196058681584  LUMO (Ag) = -0.105777964391059
cycle= 26 E= -75.3694549628848  delta_E= 4.26e-14  |g|= 4.18e-11  |ddm|= 4.02e-11
HOMO (B2u) = -0.427196058681015  LUMO (Ag) = -0.105777964389396
cycle= 27 E= -75.3694549628848  delta_E= -5.68e-14  |g|= 3.47e-11  |ddm|= 1.34e-11
HOMO (B2u) = -0.427196058680361  LUMO (Ag) = -0.105777964387899
cycle= 28 E= -75.3694549628848  delta_E= 8.53e-14  |g|= 2.9e-11  |ddm|= 1.04e-11
HOMO (B2u) = -0.42719605867969  LUMO (Ag) = -0.10577796438648
cycle= 29 E= -75.3694549628848  delta_E=    0  |g|= 2.4e-11  |ddm|= 9.06e-12
HOMO (B2u) = -0.427196058678767  LUMO (Ag) = -0.105777964382727
Extra cycle  E= -75.3694549628847  delta_E= 2.84e-14  |g|= 8.35e-12  |ddm|= 3.12e-11
converged SCF energy = -75.3694549628847

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpd_4ha6gq
max_memory 4000 MB (current use 407 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5444984241908  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5681594686599  dE = -0.023661044  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0785
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5810819888407  dE = -0.01292252  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0676  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5892771745197  dE = -0.0081951857  S^2 = 0.0000000
               |grad[o]|=0.0906  |ddm|=0.0288  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5954033818021  dE = -0.0061262073  S^2 = 0.0000000
               |grad[o]|=0.0731  |ddm|=0.0147  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6002475134277  dE = -0.0048441316  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00955  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6040772495958  dE = -0.0038297362  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.00694  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.607001010558  dE = -0.002923761  S^2 = 0.0000000
               |grad[o]|=0.0361  |ddm|=0.00545  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6090752010612  dE = -0.0020741905  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00466  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6103412339133  dE = -0.0012660329  S^2 = 0.0000000
               |grad[o]|=0.0172  |ddm|=0.00445  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6107871863662  dE = -0.00044595245  S^2 = 0.0000000
               |grad[o]|=0.00888  |ddm|=0.00474  |maxRot[o]|= 0.06
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6108585911986  dE = -7.1404832e-05  S^2 = 0.0000000
               |grad[o]|=0.00316  |ddm|=0.00398  |maxRot[o]|=0.0329
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6108594685962  dE = -8.773976e-07  S^2 = 0.0000000
               |grad[o]|=0.0005  |ddm|=0.00241  |maxRot[o]|=0.00309
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6108594862078  dE = -1.7611654e-08  S^2 = 0.0000000
               |grad[o]|=7.67e-05  |ddm|=0.000367  |maxRot[o]|=0.000384
macro iter 14 (3 JK  0 micro), CASSCF E = -75.610859486608  dE = -4.0016346e-10  S^2 = 0.0000000
               |grad[o]|=1.26e-05  |ddm|=6.64e-05  |maxRot[o]|=6.02e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6108594866191  dE = -1.1112888e-11  S^2 = 0.0000000
               |grad[o]|=2.08e-06  |ddm|=1.32e-05  |maxRot[o]|=1.01e-05
2-step CASSCF converged in 15 macro (74 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98003344 1.65708287 1.85598555 1.85598498 0.341134   0.14614893
 0.14614874 0.01748149]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00530   0.00319   0.00000   0.00000  -0.00104
  0 C 2s       0.60847   0.55448  -0.00000  -0.00000  -0.35767
  0 C 3s      -0.03996   0.00882  -0.00000  -0.00000   0.00198
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655  -0.00000
  0 C 2py     -0.00000   0.00000   0.70655  -0.00000   0.00000
  0 C 2pz      0.35425  -0.43870  -0.00000  -0.00000   0.60822
  0 C 3px     -0.00000  -0.00000   0.00000   0.00558  -0.00000
  0 C 3py     -0.00000   0.00000   0.00558   0.00000   0.00000
  0 C 3pz     -0.03931  -0.00314  -0.00000  -0.00000  -0.04299
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02761   0.00000   0.00000
  0 C 3dz^2    0.03326  -0.00060  -0.00000  -0.00000   0.01688
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02761  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00530  -0.00319   0.00000   0.00000  -0.00104
  1 C 2s       0.60847  -0.55448   0.00000  -0.00000  -0.35767
  1 C 3s      -0.03996  -0.00882   0.00000   0.00000   0.00198
  1 C 2px     -0.00000   0.00000  -0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000  -0.00000
  1 C 2pz     -0.35425  -0.43870  -0.00000   0.00000  -0.60822
  1 C 3px      0.00000   0.00000   0.00000   0.00558   0.00000
  1 C 3py      0.00000  -0.00000   0.00558   0.00000  -0.00000
  1 C 3pz      0.03931  -0.00314  -0.00000  -0.00000   0.04299
  1 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02761  -0.00000   0.00000
  1 C 3dz^2    0.03326   0.00060   0.00000   0.00000   0.01688
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02761  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00051
  0 C 2s      -0.00000  -0.00000   0.43805
  0 C 3s      -0.00000  -0.00000  -0.04314
  0 C 2px      0.70645   0.00000   0.00000
  0 C 2py      0.00000   0.70645  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55270
  0 C 3px     -0.01985   0.00000   0.00000
  0 C 3py      0.00000  -0.01985  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01664
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02315  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02225
  0 C 3dxz    -0.02315   0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00051
  1 C 2s      -0.00000   0.00000  -0.43805
  1 C 3s       0.00000   0.00000   0.04314
  1 C 2px     -0.70645  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70645   0.00000
  1 C 2pz      0.00000  -0.00000   0.55270
  1 C 3px      0.01985  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01985   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01664
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02315  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02225
  1 C 3dxz    -0.02315   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99314132
<CAS-nat-orb|mo-hf>  4  4    0.99812795
<CAS-nat-orb|mo-hf>  5  5    0.99966602
<CAS-nat-orb|mo-hf>  6  6    0.99966602
<CAS-nat-orb|mo-hf>  7  7    0.97631889
<CAS-nat-orb|mo-hf>  8  8    0.95579308
<CAS-nat-orb|mo-hf>  9  9    0.95579302
<CAS-nat-orb|mo-hf>  10  10    0.57545984
<CAS-nat-orb|mo-hf>  10  17    0.69042018
<CAS-nat-orb|mo-hf>  10  18   -0.40995044
CASSCF energy = -75.6108594866191
CASCI E = -75.6108594866191  E(CI) = -17.0456439489624  S^2 = 0.0000000
......production of RDMs took       2.94 sec
......reading the RDM took          0.45 sec
......production of RDMs took      27.34 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickICMRREPT2-ijrs) =    -0.00027536537583
E(WickICMRREPT2- rsi) =    -0.00099180724065
E(WickICMRREPT2- ijr) =    -0.00038314544677
E(WickICMRREPT2-  rs) =    -0.05219505563355
E(WickICMRREPT2-  ij) =    -0.00012757698265
E(WickICMRREPT2-  ir) =    -0.00128095426298
E(WickICMRREPT2-   r) =    -0.05569625196325
E(WickICMRREPT2-   i) =    -0.00028206366951
E(WickICMRREPT2) = -75.72209170719428  E_corr_pt = -0.1112322205751875
Timings = pdms =   40.49 | eris =    0.09 | ijrs =    1.18 | rsi =   34.52 | ijr =    0.43 | rs =  652.41 | ij =    1.25 | ir =   24.15 | r =  153.47 | i =    2.31 | total =  910.45
Time cost =   1011.778
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:06:21 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.402319608938 AA    0.000000000000   0.000000000000   2.650000000000 Bohr   0.0

nuclear repulsion = 13.5849056603774
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.325]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    254045.46


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpa87zrbaq
max_memory 4000 MB (current use 404 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.2354639903452

WARN: Singularity detected in overlap matrix (condition number =  377). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.207229697178327  LUMO (Ag) = -0.170529385107338
cycle= 1 E= -75.3434515147689  delta_E= -0.108  |g|= 0.222  |ddm|= 1.45
HOMO (B2u) = -0.458125308046683  LUMO (Ag) = -0.151008288235491
cycle= 2 E= -75.3614525114845  delta_E= -0.018  |g|= 0.052  |ddm|= 0.276
HOMO (B2u) = -0.420576044882482  LUMO (Ag) = -0.107310756967328
cycle= 3 E= -75.3623762459038  delta_E= -0.000924  |g|= 0.0104  |ddm|= 0.0554
HOMO (B2u) = -0.42157377861368  LUMO (Ag) = -0.104704594692275
cycle= 4 E= -75.3624425687673  delta_E= -6.63e-05  |g|= 0.00208  |ddm|= 0.019
HOMO (B3u) = -0.422353066342064  LUMO (Ag) = -0.10523294916925
cycle= 5 E= -75.3624454885392  delta_E= -2.92e-06  |g|= 0.000251  |ddm|= 0.00568
HOMO (B3u) = -0.422292447876754  LUMO (Ag) = -0.105149049472674
cycle= 6 E= -75.3624455277622  delta_E= -3.92e-08  |g|= 3.5e-05  |ddm|= 0.000464
HOMO (B3u) = -0.42228577869618  LUMO (Ag) = -0.105138173661525
cycle= 7 E= -75.362445528617  delta_E= -8.55e-10  |g|= 4.37e-06  |ddm|= 0.0002
HOMO (B3u) = -0.422285894464512  LUMO (Ag) = -0.105137535804987
cycle= 8 E= -75.3624455286266  delta_E= -9.66e-12  |g|= 3.96e-07  |ddm|= 2.7e-05
HOMO (B2u) = -0.422285868761311  LUMO (Ag) = -0.1051374425232
cycle= 9 E= -75.3624455286268  delta_E= -1.85e-13  |g|= 1.83e-08  |ddm|= 2.34e-06
HOMO (B3u) = -0.422285864047108  LUMO (Ag) = -0.105137442034633
cycle= 10 E= -75.3624455286268  delta_E= 2.84e-14  |g|= 2.5e-09  |ddm|= 5.4e-08
HOMO (B3u) = -0.422285864208526  LUMO (Ag) = -0.105137442035489
cycle= 11 E= -75.3624455286268  delta_E= 2.84e-14  |g|= 1.63e-09  |ddm|= 2.05e-09
HOMO (B3u) = -0.422285864471728  LUMO (Ag) = -0.105137442316616
cycle= 12 E= -75.3624455286268  delta_E= 1.42e-14  |g|= 1.38e-09  |ddm|= 8.32e-10
HOMO (B3u) = -0.42228586441273  LUMO (Ag) = -0.105137442239541
cycle= 13 E= -75.3624455286267  delta_E= 4.26e-14  |g|= 1.08e-09  |ddm|= 1.18e-09
HOMO (B3u) = -0.422285864387667  LUMO (Ag) = -0.105137442189747
cycle= 14 E= -75.3624455286267  delta_E= -1.42e-14  |g|= 9.02e-10  |ddm|= 9.99e-10
HOMO (B3u) = -0.422285864372424  LUMO (Ag) = -0.105137442174053
cycle= 15 E= -75.3624455286268  delta_E= -2.84e-14  |g|= 7.9e-10  |ddm|= 8.85e-10
HOMO (B3u) = -0.42228586437712  LUMO (Ag) = -0.105137442219368
cycle= 16 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 7.37e-10  |ddm|= 1.3e-09
HOMO (B3u) = -0.422285864307827  LUMO (Ag) = -0.105137442168195
cycle= 17 E= -75.3624455286268  delta_E= 4.26e-14  |g|= 7.58e-10  |ddm|= 5.5e-10
HOMO (B3u) = -0.42228586423334  LUMO (Ag) = -0.105137442035445
cycle= 18 E= -75.3624455286268  delta_E= -7.11e-14  |g|= 2.86e-10  |ddm|= 1.32e-09
HOMO (B3u) = -0.422285864234578  LUMO (Ag) = -0.105137442029407
cycle= 19 E= -75.3624455286267  delta_E= 1.14e-13  |g|= 2.28e-10  |ddm|= 1.9e-10
HOMO (B3u) = -0.422285864239152  LUMO (Ag) = -0.105137442029794
cycle= 20 E= -75.3624455286268  delta_E= -4.26e-14  |g|= 1.9e-10  |ddm|= 1.38e-10
HOMO (B3u) = -0.42228586424811  LUMO (Ag) = -0.105137442034874
cycle= 21 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 1.56e-10  |ddm|= 1.19e-10
HOMO (B3u) = -0.422285864254739  LUMO (Ag) = -0.105137442038668
cycle= 22 E= -75.3624455286267  delta_E= 1.14e-13  |g|= 1.3e-10  |ddm|= 9.57e-11
HOMO (B2u) = -0.422285864259433  LUMO (Ag) = -0.105137442041882
cycle= 23 E= -75.3624455286267  delta_E= -7.11e-14  |g|= 1.08e-10  |ddm|= 7.54e-11
HOMO (B2u) = -0.422285864262955  LUMO (Ag) = -0.105137442043871
cycle= 24 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 8.91e-11  |ddm|= 5.69e-11
HOMO (B2u) = -0.422285864266433  LUMO (Ag) = -0.105137442044012
cycle= 25 E= -75.3624455286268  delta_E=    0  |g|= 6.83e-11  |ddm|= 4.04e-11
HOMO (B3u) = -0.422285864264767  LUMO (Ag) = -0.105137442035472
Extra cycle  E= -75.3624455286267  delta_E= 1.42e-14  |g|= 2.19e-11  |ddm|= 8.97e-11
converged SCF energy = -75.3624455286267

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpa87zrbaq
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5393906023646  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5630104601603  dE = -0.023619858  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0764
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5755661726232  dE = -0.012555712  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0687  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5837036694584  dE = -0.0081374968  S^2 = 0.0000000
               |grad[o]|=0.0914  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5898080852835  dE = -0.0061044158  S^2 = 0.0000000
               |grad[o]|=0.0739  |ddm|=0.0154  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5946166481765  dE = -0.0048085629  S^2 = 0.0000000
               |grad[o]|=0.0596  |ddm|=0.0101  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5983876151658  dE = -0.003770967  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00736  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6012309234083  dE = -0.0028433082  S^2 = 0.0000000
               |grad[o]|=0.036  |ddm|=0.00571  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6032054515099  dE = -0.0019745281  S^2 = 0.0000000
               |grad[o]|=0.0259  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043561327487  dE = -0.0011506812  S^2 = 0.0000000
               |grad[o]|=0.0165  |ddm|=0.00467  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6047080782067  dE = -0.00035194546  S^2 = 0.0000000
               |grad[o]|=0.00777  |ddm|=0.00509  |maxRot[o]|= 0.06
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6047337091184  dE = -2.5630912e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00437  |maxRot[o]|=0.0194
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6047340656798  dE = -3.5656133e-07  S^2 = 0.0000000
               |grad[o]|=0.000329  |ddm|=0.0016  |maxRot[o]|=0.00185
macro iter 13 (3 JK  0 micro), CASSCF E = -75.604734072753  dE = -7.0731829e-09  S^2 = 0.0000000
               |grad[o]|=5.38e-05  |ddm|=0.000237  |maxRot[o]|=0.00024
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6047340729174  dE = -1.6441959e-10  S^2 = 0.0000000
               |grad[o]|=7.44e-06  |ddm|=3.84e-05  |maxRot[o]|=3.68e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6047340729273  dE = -9.8907549e-12  S^2 = 0.0000000
               |grad[o]|=2.27e-06  |ddm|=1.32e-05  |maxRot[o]|=6.59e-06
2-step CASSCF converged in 15 macro (74 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97916617 1.66712586 1.84789575 1.84789479 0.33219718 0.15368596
 0.15368589 0.01834841]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00560   0.00327   0.00000   0.00000  -0.00099
  0 C 2s       0.61156   0.56162   0.00000  -0.00000  -0.35247
  0 C 3s      -0.03803   0.00886   0.00000  -0.00000   0.00469
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py     -0.00000   0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34937  -0.42951  -0.00000  -0.00000   0.61119
  0 C 3px     -0.00000   0.00000  -0.00000   0.00818   0.00000
  0 C 3py     -0.00000   0.00000   0.00818  -0.00000  -0.00000
  0 C 3pz     -0.03762  -0.00286   0.00000  -0.00000  -0.04310
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.02675  -0.00000  -0.00000
  0 C 3dz^2    0.03225  -0.00101   0.00000  -0.00000   0.01829
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02675   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00560  -0.00327   0.00000   0.00000  -0.00099
  1 C 2s       0.61156  -0.56162  -0.00000   0.00000  -0.35247
  1 C 3s      -0.03803  -0.00886  -0.00000   0.00000   0.00469
  1 C 2px      0.00000  -0.00000   0.00000   0.70655  -0.00000
  1 C 2py     -0.00000  -0.00000   0.70655   0.00000   0.00000
  1 C 2pz     -0.34937  -0.42951  -0.00000  -0.00000  -0.61119
  1 C 3px      0.00000   0.00000   0.00000   0.00818  -0.00000
  1 C 3py      0.00000  -0.00000   0.00818  -0.00000   0.00000
  1 C 3pz      0.03762  -0.00286   0.00000  -0.00000   0.04310
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02675  -0.00000  -0.00000
  1 C 3dz^2    0.03225   0.00101   0.00000   0.00000   0.01829
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02675   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00047
  0 C 2s      -0.00000   0.00000   0.42887
  0 C 3s       0.00000   0.00000  -0.04326
  0 C 2px      0.70648   0.00000  -0.00000
  0 C 2py     -0.00000   0.70648  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55983
  0 C 3px     -0.01896   0.00000   0.00000
  0 C 3py      0.00000  -0.01896  -0.00000
  0 C 3pz      0.00000   0.00000   0.01780
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02297  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02181
  0 C 3dxz    -0.02297   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00047
  1 C 2s      -0.00000  -0.00000  -0.42887
  1 C 3s      -0.00000  -0.00000   0.04326
  1 C 2px     -0.70648  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70648   0.00000
  1 C 2pz      0.00000  -0.00000   0.55983
  1 C 3px      0.01896  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01896   0.00000
  1 C 3pz     -0.00000   0.00000   0.01780
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02297  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02181
  1 C 3dxz    -0.02297   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99284124
<CAS-nat-orb|mo-hf>  4  4    0.99802529
<CAS-nat-orb|mo-hf>  5  5    0.99963455
<CAS-nat-orb|mo-hf>  6  6    0.99963455
<CAS-nat-orb|mo-hf>  7  7    0.97582852
<CAS-nat-orb|mo-hf>  8  8    0.95889494
<CAS-nat-orb|mo-hf>  9  9    0.95889489
<CAS-nat-orb|mo-hf>  10  10    0.59917818
<CAS-nat-orb|mo-hf>  10  17    0.68689328
CASSCF energy = -75.6047340729273
CASCI E = -75.6047340729273  E(CI) = -16.9234139258864  S^2 = 0.0000000
......production of RDMs took       1.89 sec
......reading the RDM took          0.42 sec
......production of RDMs took      26.16 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.81 sec

E(WickICMRREPT2-ijrs) =    -0.00027146184207
E(WickICMRREPT2- rsi) =    -0.00097760309121
E(WickICMRREPT2- ijr) =    -0.00037655297817
E(WickICMRREPT2-  rs) =    -0.05168708103320
E(WickICMRREPT2-  ij) =    -0.00012225553500
E(WickICMRREPT2-  ir) =    -0.00126406721908
E(WickICMRREPT2-   r) =    -0.05663005186438
E(WickICMRREPT2-   i) =    -0.00027584311468
E(WickICMRREPT2) = -75.71633898960505  E_corr_pt = -0.1116049166777841
Timings = pdms =   38.40 | eris =    0.19 | ijrs =    1.30 | rsi =   44.51 | ijr =    0.44 | rs =  724.67 | ij =    1.35 | ir =   26.83 | r =  166.74 | i =    2.41 | total = 1006.89
Time cost =   1096.863
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:24:38 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.428778469484 AA    0.000000000000   0.000000000000   2.700000000000 Bohr   0.0

nuclear repulsion = 13.3333333333333
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.35]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    270911.35


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpltyxh_y3
max_memory 4000 MB (current use 407 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1946578857085

WARN: Singularity detected in overlap matrix (condition number =  348). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.199413840928996  LUMO (Ag) = -0.168263344015825
cycle= 1 E= -75.3350369843806  delta_E= -0.14  |g|= 0.225  |ddm|= 1.44
HOMO (B2u) = -0.453464888109062  LUMO (Ag) = -0.15139024066393
cycle= 2 E= -75.3537139122306  delta_E= -0.0187  |g|= 0.0519  |ddm|= 0.284
HOMO (B3u) = -0.415801083744366  LUMO (Ag) = -0.106751931948701
cycle= 3 E= -75.3546580860939  delta_E= -0.000944  |g|= 0.0108  |ddm|= 0.0549
HOMO (B2u) = -0.416822160762625  LUMO (Ag) = -0.103915433790313
cycle= 4 E= -75.3547306562047  delta_E= -7.26e-05  |g|= 0.00215  |ddm|= 0.0177
HOMO (B3u) = -0.4176076758227  LUMO (Ag) = -0.104440258456576
cycle= 5 E= -75.3547338450163  delta_E= -3.19e-06  |g|= 0.000277  |ddm|= 0.00497
HOMO (B2u) = -0.417541021758633  LUMO (Ag) = -0.10435329370321
cycle= 6 E= -75.3547338927567  delta_E= -4.77e-08  |g|= 3.68e-05  |ddm|= 0.000534
HOMO (B2u) = -0.417533919980038  LUMO (Ag) = -0.104341804406655
cycle= 7 E= -75.3547338936913  delta_E= -9.35e-10  |g|= 4.65e-06  |ddm|= 0.000197
HOMO (B3u) = -0.417533963921612  LUMO (Ag) = -0.104341084871143
cycle= 8 E= -75.3547338937025  delta_E= -1.12e-11  |g|= 4.19e-07  |ddm|= 2.62e-05
HOMO (B3u) = -0.417533935669339  LUMO (Ag) = -0.104340979663685
cycle= 9 E= -75.3547338937025  delta_E= -1.42e-14  |g|= 1.9e-08  |ddm|= 2.29e-06
HOMO (B3u) = -0.417533930414547  LUMO (Ag) = -0.104340980550987
cycle= 10 E= -75.3547338937026  delta_E= -9.95e-14  |g|= 2.65e-09  |ddm|= 5.91e-08
HOMO (B3u) = -0.417533930805341  LUMO (Ag) = -0.104340980789893
cycle= 11 E= -75.3547338937027  delta_E= -2.84e-14  |g|= 1.96e-09  |ddm|= 1.85e-09
HOMO (B3u) = -0.41753393088636  LUMO (Ag) = -0.104340980879389
cycle= 12 E= -75.3547338937026  delta_E= 5.68e-14  |g|= 1.5e-09  |ddm|= 1.71e-09
HOMO (B3u) = -0.417533930830688  LUMO (Ag) = -0.104340980797573
cycle= 13 E= -75.3547338937026  delta_E= -4.26e-14  |g|= 1.18e-09  |ddm|= 1.39e-09
HOMO (B3u) = -0.417533930794764  LUMO (Ag) = -0.104340980739552
cycle= 14 E= -75.3547338937025  delta_E= 1.28e-13  |g|= 9.83e-10  |ddm|= 9.3e-10
HOMO (B2u) = -0.417533930774851  LUMO (Ag) = -0.104340980717668
cycle= 15 E= -75.3547338937026  delta_E= -8.53e-14  |g|= 8.53e-10  |ddm|= 7.72e-10
HOMO (B3u) = -0.417533930785001  LUMO (Ag) = -0.104340980767866
cycle= 16 E= -75.3547338937026  delta_E=    0  |g|= 7.87e-10  |ddm|= 1.38e-09
HOMO (B3u) = -0.417533930718249  LUMO (Ag) = -0.104340980715769
cycle= 17 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 8.01e-10  |ddm|= 3.93e-10
HOMO (B3u) = -0.41753393062435  LUMO (Ag) = -0.104340980573547
cycle= 18 E= -75.3547338937026  delta_E= 1.42e-14  |g|= 3.16e-10  |ddm|= 1.48e-09
HOMO (B3u) = -0.41753393062603  LUMO (Ag) = -0.104340980567754
cycle= 19 E= -75.3547338937026  delta_E= 2.84e-14  |g|= 2.56e-10  |ddm|= 2.19e-10
HOMO (B3u) = -0.4175339306361  LUMO (Ag) = -0.1043409805724
cycle= 20 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 2.06e-10  |ddm|= 1.67e-10
HOMO (B3u) = -0.417533930645865  LUMO (Ag) = -0.104340980578077
cycle= 21 E= -75.3547338937025  delta_E= -2.84e-14  |g|= 1.68e-10  |ddm|= 1.31e-10
HOMO (B3u) = -0.417533930653069  LUMO (Ag) = -0.104340980582482
cycle= 22 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 1.39e-10  |ddm|= 1.03e-10
HOMO (B3u) = -0.417533930658195  LUMO (Ag) = -0.104340980586117
cycle= 23 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 1.16e-10  |ddm|= 8.48e-11
HOMO (B2u) = -0.417533930662154  LUMO (Ag) = -0.104340980588686
cycle= 24 E= -75.3547338937026  delta_E=    0  |g|= 9.51e-11  |ddm|= 6.86e-11
HOMO (B2u) = -0.417533930665035  LUMO (Ag) = -0.104340980582828
Extra cycle  E= -75.3547338937026  delta_E=    0  |g|= 2.98e-11  |ddm|= 1.39e-10
converged SCF energy = -75.3547338937026

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpltyxh_y3
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5336329215199  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5570298593034  dE = -0.023396938  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0768
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5693666525347  dE = -0.012336793  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0694  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5774849618825  dE = -0.0081183093  S^2 = 0.0000000
               |grad[o]|=0.0922  |ddm|=0.0294  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5835779169583  dE = -0.0060929551  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0162  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5883468964339  dE = -0.0047689795  S^2 = 0.0000000
               |grad[o]|=0.0599  |ddm|=0.0107  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5920450999601  dE = -0.0036982035  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00775  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5947857838571  dE = -0.0027406839  S^2 = 0.0000000
               |grad[o]|=0.0356  |ddm|=0.00594  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5966321676866  dE = -0.0018463838  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00502  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5976345635028  dE = -0.0010023958  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00495  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.59783670865  dE = -0.00020214515  S^2 = 0.0000000
               |grad[o]|=0.00622  |ddm|=0.00558  |maxRot[o]|= 0.04
macro iter 11 (3 JK  0 micro), CASSCF E = -75.597867096195  dE = -3.0387545e-05  S^2 = 0.0000000
               |grad[o]|=0.00217  |ddm|=0.00321  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5978677929632  dE = -6.9676818e-07  S^2 = 0.0000000
               |grad[o]|=0.000398  |ddm|=0.00173  |maxRot[o]|=0.00283
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5978678057742  dE = -1.2811086e-08  S^2 = 0.0000000
               |grad[o]|=6.59e-05  |ddm|=0.000311  |maxRot[o]|=0.000323
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5978678060433  dE = -2.6905411e-10  S^2 = 0.0000000
               |grad[o]|=1.02e-05  |ddm|=4.86e-05  |maxRot[o]|=4.75e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5978678060504  dE = -7.0770056e-12  S^2 = 0.0000000
               |grad[o]|=1.58e-06  |ddm|=8.75e-06  |maxRot[o]|=7.7e-06
2-step CASSCF converged in 15 macro (72 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97829963 1.67678201 1.83943619 1.83943573 0.32392972 0.16144639
 0.16144632 0.01922401]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00588   0.00336   0.00000   0.00000  -0.00095
  0 C 2s       0.61465   0.56857  -0.00000  -0.00000  -0.34718
  0 C 3s      -0.03607   0.00891  -0.00000   0.00000   0.00734
  0 C 2px      0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py      0.00000  -0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34438  -0.42027   0.00000   0.00000   0.61414
  0 C 3px      0.00000   0.00000  -0.00000   0.01064   0.00000
  0 C 3py      0.00000  -0.00000   0.01064   0.00000  -0.00000
  0 C 3pz     -0.03594  -0.00262  -0.00000   0.00000  -0.04307
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.02590   0.00000  -0.00000
  0 C 3dz^2    0.03130  -0.00139  -0.00000   0.00000   0.01982
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02590   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00588  -0.00336   0.00000   0.00000  -0.00095
  1 C 2s       0.61465  -0.56857   0.00000  -0.00000  -0.34718
  1 C 3s      -0.03607  -0.00891   0.00000  -0.00000   0.00734
  1 C 2px      0.00000  -0.00000   0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000   0.00000
  1 C 2pz     -0.34438  -0.42027   0.00000   0.00000  -0.61414
  1 C 3px     -0.00000   0.00000   0.00000   0.01064  -0.00000
  1 C 3py     -0.00000   0.00000   0.01064  -0.00000   0.00000
  1 C 3pz      0.03594  -0.00262  -0.00000   0.00000   0.04307
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02590   0.00000  -0.00000
  1 C 3dz^2    0.03130   0.00139   0.00000  -0.00000   0.01982
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02590   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00044
  0 C 2s      -0.00000  -0.00000   0.41964
  0 C 3s       0.00000  -0.00000  -0.04337
  0 C 2px      0.70651  -0.00000   0.00000
  0 C 2py     -0.00000   0.70651  -0.00000
  0 C 2pz      0.00000  -0.00000   0.56675
  0 C 3px     -0.01810  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01810  -0.00000
  0 C 3pz      0.00000  -0.00000   0.01881
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02276  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02148
  0 C 3dxz    -0.02276  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00044
  1 C 2s      -0.00000   0.00000  -0.41964
  1 C 3s      -0.00000   0.00000   0.04337
  1 C 2px     -0.70651   0.00000   0.00000
  1 C 2py      0.00000  -0.70651   0.00000
  1 C 2pz     -0.00000   0.00000   0.56675
  1 C 3px      0.01810   0.00000  -0.00000
  1 C 3py      0.00000   0.01810   0.00000
  1 C 3pz      0.00000  -0.00000   0.01881
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02276  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02148
  1 C 3dxz    -0.02276  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99254642
<CAS-nat-orb|mo-hf>  4  4    0.99791955
<CAS-nat-orb|mo-hf>  5  5    0.99960057
<CAS-nat-orb|mo-hf>  6  6    0.99960057
<CAS-nat-orb|mo-hf>  7  7    0.97536358
<CAS-nat-orb|mo-hf>  8  8    0.96172750
<CAS-nat-orb|mo-hf>  9  9    0.96172748
<CAS-nat-orb|mo-hf>  10  10    0.62371856
<CAS-nat-orb|mo-hf>  10  17    0.67956522
CASSCF energy = -75.5978678060504
CASCI E = -75.5978678060504  E(CI) = -16.8047461472219  S^2 = 0.0000000
......production of RDMs took       1.95 sec
......reading the RDM took          0.45 sec
......production of RDMs took      22.67 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.82 sec

E(WickICMRREPT2-ijrs) =    -0.00026823913909
E(WickICMRREPT2- rsi) =    -0.00096496311247
E(WickICMRREPT2- ijr) =    -0.00037003185609
E(WickICMRREPT2-  rs) =    -0.05118203217375
E(WickICMRREPT2-  ij) =    -0.00011701197156
E(WickICMRREPT2-  ir) =    -0.00124781492385
E(WickICMRREPT2-   r) =    -0.05758117670784
E(WickICMRREPT2-   i) =    -0.00026963693632
E(WickICMRREPT2) = -75.70986871287134  E_corr_pt = -0.1120009068209642
Timings = pdms =   34.89 | eris =    0.06 | ijrs =    1.16 | rsi =   49.86 | ijr =    0.46 | rs =  692.14 | ij =    1.47 | ir =   26.38 | r =  168.52 | i =    2.34 | total =  977.35
Time cost =   1030.379
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:41:48 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.455237330030 AA    0.000000000000   0.000000000000   2.750000000000 Bohr   0.0

nuclear repulsion = 13.0909090909091
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.375]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    287284.68


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpdqccufhq
max_memory 4000 MB (current use 404 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1557644738047

WARN: Singularity detected in overlap matrix (condition number =  321). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.19200419727189  LUMO (Ag) = -0.16608696150487
cycle= 1 E= -75.3260871697503  delta_E= -0.17  |g|= 0.228  |ddm|= 1.44
HOMO (B2u) = -0.448902413635202  LUMO (Ag) = -0.151522743525044
cycle= 2 E= -75.3454236890815  delta_E= -0.0193  |g|= 0.0517  |ddm|= 0.291
HOMO (B3u) = -0.411143114796125  LUMO (Ag) = -0.105979877749067
cycle= 3 E= -75.3463869604458  delta_E= -0.000963  |g|= 0.0112  |ddm|= 0.0546
HOMO (B3u) = -0.412216378156834  LUMO (Ag) = -0.102966454342321
cycle= 4 E= -75.3464661736963  delta_E= -7.92e-05  |g|= 0.00221  |ddm|= 0.0168
HOMO (B2u) = -0.413005500150537  LUMO (Ag) = -0.10349708111997
cycle= 5 E= -75.3464696035283  delta_E= -3.43e-06  |g|= 0.000295  |ddm|= 0.00439
HOMO (B3u) = -0.412935226123342  LUMO (Ag) = -0.103410770619272
cycle= 6 E= -75.3464696577874  delta_E= -5.43e-08  |g|= 3.83e-05  |ddm|= 0.000585
HOMO (B3u) = -0.4129277426732  LUMO (Ag) = -0.103398722647748
cycle= 7 E= -75.346469658793  delta_E= -1.01e-09  |g|= 4.88e-06  |ddm|= 0.00019
HOMO (B2u) = -0.412927696344284  LUMO (Ag) = -0.103397915940679
cycle= 8 E= -75.3464696588055  delta_E= -1.25e-11  |g|= 4.41e-07  |ddm|= 2.55e-05
HOMO (B3u) = -0.412927666372052  LUMO (Ag) = -0.103397797537147
cycle= 9 E= -75.3464696588056  delta_E= -4.26e-14  |g|= 1.96e-08  |ddm|= 2.16e-06
HOMO (B2u) = -0.412927660626365  LUMO (Ag) = -0.103397800029288
cycle= 10 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 2.79e-09  |ddm|= 6.4e-08
HOMO (B3u) = -0.412927661256435  LUMO (Ag) = -0.103397800544619
cycle= 11 E= -75.3464696588055  delta_E= 4.26e-14  |g|= 2.25e-09  |ddm|= 1.98e-09
HOMO (B3u) = -0.412927661157419  LUMO (Ag) = -0.103397800421416
cycle= 12 E= -75.3464696588056  delta_E= -5.68e-14  |g|= 1.61e-09  |ddm|= 2.51e-09
HOMO (B3u) = -0.412927661093994  LUMO (Ag) = -0.103397800318799
cycle= 13 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 1.29e-09  |ddm|= 1.34e-09
HOMO (B3u) = -0.412927661060355  LUMO (Ag) = -0.103397800268375
cycle= 14 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 1.06e-09  |ddm|= 1.06e-09
HOMO (B3u) = -0.412927661039468  LUMO (Ag) = -0.103397800244973
cycle= 15 E= -75.3464696588055  delta_E= 1.14e-13  |g|= 9.1e-10  |ddm|= 7.01e-10
HOMO (B3u) = -0.412927661045499  LUMO (Ag) = -0.103397800288502
cycle= 16 E= -75.3464696588055  delta_E=    0  |g|= 8.36e-10  |ddm|= 1.29e-09
HOMO (B3u) = -0.412927660984892  LUMO (Ag) = -0.103397800239553
cycle= 17 E= -75.3464696588054  delta_E= 5.68e-14  |g|= 8.37e-10  |ddm|= 2.13e-10
HOMO (B3u) = -0.412927660873002  LUMO (Ag) = -0.103397800091605
cycle= 18 E= -75.3464696588055  delta_E= -8.53e-14  |g|= 3.44e-10  |ddm|= 1.65e-09
HOMO (B3u) = -0.412927660874862  LUMO (Ag) = -0.103397800085942
cycle= 19 E= -75.3464696588056  delta_E= -7.11e-14  |g|= 2.8e-10  |ddm|= 2.47e-10
HOMO (B3u) = -0.412927660889655  LUMO (Ag) = -0.103397800094486
cycle= 20 E= -75.3464696588055  delta_E= 9.95e-14  |g|= 2.21e-10  |ddm|= 1.92e-10
HOMO (B2u) = -0.41292766090014  LUMO (Ag) = -0.103397800100678
cycle= 21 E= -75.3464696588056  delta_E= -1.14e-13  |g|= 1.81e-10  |ddm|= 1.41e-10
HOMO (B3u) = -0.412927660907534  LUMO (Ag) = -0.103397800105596
cycle= 22 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 1.48e-10  |ddm|= 1.13e-10
HOMO (B2u) = -0.412927660913014  LUMO (Ag) = -0.103397800109664
cycle= 23 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 1.22e-10  |ddm|= 9.18e-11
HOMO (B2u) = -0.412927660917538  LUMO (Ag) = -0.103397800113001
cycle= 24 E= -75.3464696588055  delta_E= -1.42e-14  |g|= 1e-10  |ddm|= 7.81e-11
HOMO (B2u) = -0.412927660921779  LUMO (Ag) = -0.103397800114477
cycle= 25 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 7.74e-11  |ddm|= 5.4e-11
HOMO (B2u) = -0.412927660924361  LUMO (Ag) = -0.103397800113948
cycle= 26 E= -75.3464696588055  delta_E= -1.42e-14  |g|= 5.33e-11  |ddm|= 5.65e-11
HOMO (B2u) = -0.412927660923126  LUMO (Ag) = -0.103397800111541
cycle= 27 E= -75.3464696588056  delta_E= -1.14e-13  |g|= 4.35e-11  |ddm|= 2.04e-11
HOMO (B3u) = -0.412927660921778  LUMO (Ag) = -0.103397800109292
cycle= 28 E= -75.3464696588056  delta_E= 5.68e-14  |g|= 3.53e-11  |ddm|= 1.58e-11
HOMO (B2u) = -0.412927660920843  LUMO (Ag) = -0.103397800107648
cycle= 29 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 2.88e-11  |ddm|= 1.23e-11
HOMO (B2u) = -0.412927660920186  LUMO (Ag) = -0.103397800106412
cycle= 30 E= -75.3464696588056  delta_E= -8.53e-14  |g|= 2.34e-11  |ddm|= 9.89e-12
HOMO (B3u) = -0.412927660919745  LUMO (Ag) = -0.103397800105451
cycle= 31 E= -75.3464696588055  delta_E= 1.71e-13  |g|= 1.89e-11  |ddm|= 8.1e-12
HOMO (B3u) = -0.412927660919474  LUMO (Ag) = -0.103397800104681
cycle= 32 E= -75.3464696588055  delta_E= -8.53e-14  |g|= 1.52e-11  |ddm|= 6.82e-12
HOMO (B3u) = -0.412927660919344  LUMO (Ag) = -0.103397800104066
cycle= 33 E= -75.3464696588056  delta_E= -5.68e-14  |g|= 1.19e-11  |ddm|= 5.93e-12
HOMO (B3u) = -0.412927660919345  LUMO (Ag) = -0.103397800103668
cycle= 34 E= -75.3464696588055  delta_E= 8.53e-14  |g|= 9.44e-12  |ddm|= 4.81e-12
HOMO (B2u) = -0.412927660919424  LUMO (Ag) = -0.103397800103461
cycle= 35 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 7.72e-12  |ddm|= 3.54e-12
HOMO (B2u) = -0.412927660919466  LUMO (Ag) = -0.103397800103269
cycle= 36 E= -75.3464696588057  delta_E= -1.71e-13  |g|= 6.3e-12  |ddm|= 3.05e-12
HOMO (B2u) = -0.412927660919476  LUMO (Ag) = -0.103397800103085
cycle= 37 E= -75.3464696588055  delta_E= 1.85e-13  |g|= 5.14e-12  |ddm|= 2.58e-12
HOMO (B3u) = -0.412927660919465  LUMO (Ag) = -0.103397800102912
cycle= 38 E= -75.3464696588056  delta_E= -9.95e-14  |g|= 4.18e-12  |ddm|= 2.2e-12
HOMO (B3u) = -0.412927660919443  LUMO (Ag) = -0.103397800102751
cycle= 39 E= -75.3464696588056  delta_E=    0  |g|= 3.4e-12  |ddm|= 1.9e-12
HOMO (B3u) = -0.412927660919322  LUMO (Ag) = -0.103397800102222
Extra cycle  E= -75.3464696588056  delta_E= -2.84e-14  |g|= 1.22e-12  |ddm|= 5.83e-12
converged SCF energy = -75.3464696588056

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpdqccufhq
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5273817495036  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5505812895233  dE = -0.02319954  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0789
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5627423957474  dE = -0.012161106  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.570841678926  dE = -0.0080992832  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0298  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5769114255557  dE = -0.0060697466  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0169  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5816202918546  dE = -0.0047088663  S^2 = 0.0000000
               |grad[o]|=0.0598  |ddm|=0.0112  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5852180142701  dE = -0.0035977224  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.00806  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5878220969  dE = -0.0026040826  S^2 = 0.0000000
               |grad[o]|=0.0347  |ddm|=0.00612  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5895016097381  dE = -0.0016795128  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5903141997755  dE = -0.00081259004  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.00535  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5904157790265  dE = -0.00010157925  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.00625  |maxRot[o]|=0.0374
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5904169954666  dE = -1.2164401e-06  S^2 = 0.0000000
               |grad[o]|=0.000611  |ddm|=0.00344  |maxRot[o]|=0.00344
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5904170207647  dE = -2.5298036e-08  S^2 = 0.0000000
               |grad[o]|=9.15e-05  |ddm|=0.000453  |maxRot[o]|=0.000415
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5904170213119  dE = -5.4728844e-10  S^2 = 0.0000000
               |grad[o]|=1.51e-05  |ddm|=6.86e-05  |maxRot[o]|=6.34e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5904170213272  dE = -1.5234036e-11  S^2 = 0.0000000
               |grad[o]|=2.37e-06  |ddm|=1.28e-05  |maxRot[o]|=1.1e-05
2-step CASSCF converged in 14 macro (69 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97743796 1.68610721 1.83058041 1.83058145 0.31631683 0.16943537
 0.16943524 0.02010553]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00615   0.00344   0.00000   0.00000  -0.00091
  0 C 2s       0.61773   0.57533   0.00000  -0.00000  -0.34180
  0 C 3s      -0.03411   0.00898  -0.00000  -0.00000   0.00990
  0 C 2px      0.00000  -0.00000  -0.00000   0.70654  -0.00000
  0 C 2py     -0.00000   0.00000   0.70654  -0.00000  -0.00000
  0 C 2pz      0.33928  -0.41097  -0.00000  -0.00000   0.61707
  0 C 3px     -0.00000  -0.00000   0.00000   0.01297  -0.00000
  0 C 3py      0.00000  -0.00000   0.01297   0.00000  -0.00000
  0 C 3pz     -0.03426  -0.00242  -0.00000  -0.00000  -0.04286
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02505   0.00000  -0.00000
  0 C 3dz^2    0.03040  -0.00175  -0.00000  -0.00000   0.02149
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02505  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00615  -0.00344   0.00000   0.00000  -0.00091
  1 C 2s       0.61773  -0.57533  -0.00000   0.00000  -0.34180
  1 C 3s      -0.03411  -0.00898   0.00000   0.00000   0.00990
  1 C 2px      0.00000   0.00000  -0.00000   0.70654  -0.00000
  1 C 2py      0.00000   0.00000   0.70654  -0.00000   0.00000
  1 C 2pz     -0.33928  -0.41097  -0.00000   0.00000  -0.61707
  1 C 3px     -0.00000   0.00000   0.00000   0.01297   0.00000
  1 C 3py      0.00000  -0.00000   0.01297  -0.00000   0.00000
  1 C 3pz      0.03426  -0.00242  -0.00000  -0.00000   0.04286
  1 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02505   0.00000  -0.00000
  1 C 3dz^2    0.03040   0.00175   0.00000   0.00000   0.02149
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02505  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s      -0.00000   0.00000   0.41035
  0 C 3s      -0.00000  -0.00000  -0.04345
  0 C 2px      0.70654   0.00000  -0.00000
  0 C 2py     -0.00000   0.70654  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.57349
  0 C 3px     -0.01725  -0.00000   0.00000
  0 C 3py     -0.00000  -0.01725  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01967
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02253  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02125
  0 C 3dxz    -0.02253  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.41035
  1 C 3s       0.00000   0.00000   0.04345
  1 C 2px     -0.70654   0.00000  -0.00000
  1 C 2py      0.00000  -0.70654   0.00000
  1 C 2pz      0.00000   0.00000   0.57349
  1 C 3px      0.01725  -0.00000   0.00000
  1 C 3py      0.00000   0.01725   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01967
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02253  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02125
  1 C 3dxz    -0.02253   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99226092
<CAS-nat-orb|mo-hf>  4  4    0.99781292
<CAS-nat-orb|mo-hf>  5  5    0.99956408
<CAS-nat-orb|mo-hf>  6  6    0.99956408
<CAS-nat-orb|mo-hf>  7  7    0.97493010
<CAS-nat-orb|mo-hf>  8  8    0.96431697
<CAS-nat-orb|mo-hf>  9  9    0.96431698
<CAS-nat-orb|mo-hf>  10  10    0.64879987
<CAS-nat-orb|mo-hf>  10  17    0.66873221
CASSCF energy = -75.5904170213272
CASCI E = -75.5904170213272  E(CI) = -16.6895622816502  S^2 = 0.0000000
......production of RDMs took       2.24 sec
......reading the RDM took          0.41 sec
......production of RDMs took      22.94 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICMRREPT2-ijrs) =    -0.00026559949800
E(WickICMRREPT2- rsi) =    -0.00095375845439
E(WickICMRREPT2- ijr) =    -0.00036358148868
E(WickICMRREPT2-  rs) =    -0.05068338030663
E(WickICMRREPT2-  ij) =    -0.00011188002748
E(WickICMRREPT2-  ir) =    -0.00123220381864
E(WickICMRREPT2-   r) =    -0.05854692795555
E(WickICMRREPT2-   i) =    -0.00026344533307
E(WickICMRREPT2) = -75.70283779820963  E_corr_pt = -0.1124207768824462
Timings = pdms =   35.36 | eris =    0.08 | ijrs =    1.16 | rsi =   38.03 | ijr =    1.08 | rs =  682.63 | ij =    1.36 | ir =   25.24 | r =  165.87 | i =    2.33 | total =  953.23
Time cost =   1007.651
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:58:36 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.481696190576 AA    0.000000000000   0.000000000000   2.800000000000 Bohr   0.0

nuclear repulsion = 12.8571428571429
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.4]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    302805.28


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpdlt4y70q
max_memory 4000 MB (current use 406 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1187592585641

WARN: Singularity detected in overlap matrix (condition number =  297). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.184977014444633  LUMO (Ag) = -0.163989710542375
cycle= 1 E= -75.3167358242475  delta_E= -0.198  |g|= 0.231  |ddm|= 1.44
HOMO (B2u) = -0.444434359277166  LUMO (Ag) = -0.151416963696341
cycle= 2 E= -75.3367114409982  delta_E= -0.02  |g|= 0.0515  |ddm|= 0.298
HOMO (B2u) = -0.406594326641876  LUMO (Ag) = -0.105005000614388
cycle= 3 E= -75.3376920455643  delta_E= -0.000981  |g|= 0.0117  |ddm|= 0.0545
HOMO (B3u) = -0.407746719644285  LUMO (Ag) = -0.101871698894466
cycle= 4 E= -75.3377779901322  delta_E= -8.59e-05  |g|= 0.00225  |ddm|= 0.0162
HOMO (B3u) = -0.408536003811462  LUMO (Ag) = -0.102414153547261
cycle= 5 E= -75.3377816192104  delta_E= -3.63e-06  |g|= 0.000309  |ddm|= 0.00396
HOMO (B2u) = -0.408464040126318  LUMO (Ag) = -0.102331174534052
cycle= 6 E= -75.3377816780684  delta_E= -5.89e-08  |g|= 3.95e-05  |ddm|= 0.000618
HOMO (B2u) = -0.408456256018869  LUMO (Ag) = -0.102318677176298
cycle= 7 E= -75.3377816791323  delta_E= -1.06e-09  |g|= 5.06e-06  |ddm|= 0.00018
HOMO (B3u) = -0.408456106236037  LUMO (Ag) = -0.102317785563316
cycle= 8 E= -75.337781679146  delta_E= -1.37e-11  |g|= 4.62e-07  |ddm|= 2.48e-05
HOMO (B2u) = -0.408456075143843  LUMO (Ag) = -0.102317652725367
cycle= 9 E= -75.337781679146  delta_E=    0  |g|= 2.02e-08  |ddm|= 1.99e-06
HOMO (B3u) = -0.408456068963824  LUMO (Ag) = -0.102317657025672
cycle= 10 E= -75.3377816791461  delta_E= -5.68e-14  |g|= 2.92e-09  |ddm|= 6.88e-08
HOMO (B3u) = -0.408456069762554  LUMO (Ag) = -0.102317657747795
cycle= 11 E= -75.3377816791461  delta_E= 4.26e-14  |g|= 2.42e-09  |ddm|= 2.47e-09
HOMO (B3u) = -0.408456069541917  LUMO (Ag) = -0.102317657475916
cycle= 12 E= -75.3377816791461  delta_E= -7.11e-14  |g|= 1.71e-09  |ddm|= 2.62e-09
HOMO (B3u) = -0.408456069497235  LUMO (Ag) = -0.10231765737432
cycle= 13 E= -75.3377816791461  delta_E= 5.68e-14  |g|= 1.39e-09  |ddm|= 1.56e-09
HOMO (B2u) = -0.408456069460695  LUMO (Ag) = -0.102317657325753
cycle= 14 E= -75.3377816791461  delta_E= -5.68e-14  |g|= 1.14e-09  |ddm|= 1.09e-09
HOMO (B3u) = -0.408456069437038  LUMO (Ag) = -0.10231765730027
cycle= 15 E= -75.337781679146  delta_E= 8.53e-14  |g|= 9.7e-10  |ddm|= 6.22e-10
HOMO (B3u) = -0.408456069434349  LUMO (Ag) = -0.102317657333222
cycle= 16 E= -75.3377816791461  delta_E= -5.68e-14  |g|= 8.96e-10  |ddm|= 1.15e-09
HOMO (B3u) = -0.408456069387437  LUMO (Ag) = -0.10231765729355
cycle= 17 E= -75.3377816791461  delta_E= 4.26e-14  |g|= 8.67e-10  |ddm|= 9.07e-11
HOMO (B3u) = -0.408456069259609  LUMO (Ag) = -0.102317657143956
cycle= 18 E= -75.3377816791461  delta_E= -1.42e-14  |g|= 3.66e-10  |ddm|= 1.82e-09
HOMO (B3u) = -0.408456069261372  LUMO (Ag) = -0.10231765713826
cycle= 19 E= -75.3377816791461  delta_E= -7.11e-14  |g|= 3e-10  |ddm|= 2.73e-10
HOMO (B3u) = -0.408456069278698  LUMO (Ag) = -0.102317657149115
cycle= 20 E= -75.337781679146  delta_E= 1.14e-13  |g|= 2.36e-10  |ddm|= 2.07e-10
HOMO (B3u) = -0.408456069289465  LUMO (Ag) = -0.102317657155501
cycle= 21 E= -75.3377816791461  delta_E= -4.26e-14  |g|= 1.93e-10  |ddm|= 1.53e-10
HOMO (B3u) = -0.408456069297027  LUMO (Ag) = -0.102317657160994
cycle= 22 E= -75.337781679146  delta_E= 2.84e-14  |g|= 1.57e-10  |ddm|= 1.19e-10
HOMO (B3u) = -0.408456069302726  LUMO (Ag) = -0.102317657165506
cycle= 23 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 1.28e-10  |ddm|= 9.79e-11
HOMO (B3u) = -0.408456069307766  LUMO (Ag) = -0.102317657169691
cycle= 24 E= -75.3377816791461  delta_E= 2.84e-14  |g|= 1.05e-10  |ddm|= 8.81e-11
HOMO (B3u) = -0.408456069312194  LUMO (Ag) = -0.102317657171835
cycle= 25 E= -75.337781679146  delta_E= 5.68e-14  |g|= 8.08e-11  |ddm|= 6.46e-11
HOMO (B2u) = -0.408456069315164  LUMO (Ag) = -0.102317657172308
cycle= 26 E= -75.3377816791462  delta_E= -1.14e-13  |g|= 5.64e-11  |ddm|= 6.32e-11
HOMO (B2u) = -0.408456069313831  LUMO (Ag) = -0.102317657169861
cycle= 27 E= -75.3377816791462  delta_E= -1.42e-14  |g|= 4.58e-11  |ddm|= 2.27e-11
HOMO (B2u) = -0.408456069312356  LUMO (Ag) = -0.102317657167541
cycle= 28 E= -75.3377816791462  delta_E= 1.42e-14  |g|= 3.7e-11  |ddm|= 1.74e-11
HOMO (B2u) = -0.408456069311358  LUMO (Ag) = -0.102317657165919
cycle= 29 E= -75.3377816791461  delta_E= 7.11e-14  |g|= 3e-11  |ddm|= 1.35e-11
HOMO (B3u) = -0.408456069310632  LUMO (Ag) = -0.102317657164713
cycle= 30 E= -75.3377816791461  delta_E= -4.26e-14  |g|= 2.43e-11  |ddm|= 1.08e-11
HOMO (B3u) = -0.40845606931014  LUMO (Ag) = -0.102317657163794
cycle= 31 E= -75.3377816791462  delta_E= -2.84e-14  |g|= 1.95e-11  |ddm|= 8.67e-12
HOMO (B2u) = -0.408456069309833  LUMO (Ag) = -0.102317657163081
cycle= 32 E= -75.3377816791461  delta_E= 8.53e-14  |g|= 1.56e-11  |ddm|= 7.03e-12
HOMO (B3u) = -0.408456069309678  LUMO (Ag) = -0.10231765716252
cycle= 33 E= -75.3377816791462  delta_E= -9.95e-14  |g|= 1.23e-11  |ddm|= 5.86e-12
HOMO (B3u) = -0.408456069309657  LUMO (Ag) = -0.102317657162162
cycle= 34 E= -75.337781679146  delta_E= 1.56e-13  |g|= 9.67e-12  |ddm|= 4.68e-12
HOMO (B3u) = -0.40845606930973  LUMO (Ag) = -0.102317657161982
cycle= 35 E= -75.3377816791461  delta_E= -9.95e-14  |g|= 7.87e-12  |ddm|= 3.48e-12
HOMO (B3u) = -0.408456069309764  LUMO (Ag) = -0.102317657161813
cycle= 36 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 6.39e-12  |ddm|= 2.95e-12
HOMO (B3u) = -0.408456069309765  LUMO (Ag) = -0.102317657161651
cycle= 37 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 5.19e-12  |ddm|= 2.45e-12
HOMO (B3u) = -0.408456069309746  LUMO (Ag) = -0.102317657161497
cycle= 38 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 4.2e-12  |ddm|= 2.08e-12
HOMO (B3u) = -0.408456069309717  LUMO (Ag) = -0.102317657161352
cycle= 39 E= -75.3377816791461  delta_E=    0  |g|= 3.4e-12  |ddm|= 1.75e-12
HOMO (B3u) = -0.408456069309571  LUMO (Ag) = -0.102317657160865
Extra cycle  E= -75.3377816791461  delta_E= 2.84e-14  |g|= 1.19e-12  |ddm|= 5.23e-12
converged SCF energy = -75.3377816791461

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpdlt4y70q
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5207710561399  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.543585817872  dE = -0.022814762  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5556863536552  dE = -0.012100536  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5638012283059  dE = -0.0081148747  S^2 = 0.0000000
               |grad[o]|=0.0929  |ddm|=0.0305  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5698554857274  dE = -0.0060542574  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0176  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5744974578831  dE = -0.0046419722  S^2 = 0.0000000
               |grad[o]|=0.0595  |ddm|=0.0117  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5779785033143  dE = -0.0034810454  S^2 = 0.0000000
               |grad[o]|=0.0458  |ddm|=0.00833  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5804227194741  dE = -0.0024442162  S^2 = 0.0000000
               |grad[o]|=0.0334  |ddm|=0.00629  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5819072097381  dE = -0.0014844903  S^2 = 0.0000000
               |grad[o]|=0.0219  |ddm|=0.00549  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5824311518786  dE = -0.00052394214  S^2 = 0.0000000
               |grad[o]|=0.0112  |ddm|=0.00592  |maxRot[o]|= 0.06
macro iter 10 (4 JK  0 micro), CASSCF E = -75.582517888629  dE = -8.673675e-05  S^2 = 0.0000000
               |grad[o]|=0.00395  |ddm|=0.00526  |maxRot[o]|=0.0339
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5825189143668  dE = -1.0257378e-06  S^2 = 0.0000000
               |grad[o]|=0.00057  |ddm|=0.00341  |maxRot[o]|=0.00308
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5825189359807  dE = -2.1613886e-08  S^2 = 0.0000000
               |grad[o]|=8.53e-05  |ddm|=0.000437  |maxRot[o]|=0.000367
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5825189364279  dE = -4.4717297e-10  S^2 = 0.0000000
               |grad[o]|=1.4e-05  |ddm|=6.12e-05  |maxRot[o]|=5.56e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5825189364314  dE = -3.4958703e-12  S^2 = 0.0000000
               |grad[o]|=1.99e-06  |ddm|=1.03e-05  |maxRot[o]|=9.54e-06
2-step CASSCF converged in 14 macro (68 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97658606 1.69515621 1.82129801 1.82129742 0.3093552  0.17765866
 0.17765826 0.02099018]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00641   0.00352   0.00000   0.00000  -0.00088
  0 C 2s       0.62079   0.58190   0.00000  -0.00000  -0.33633
  0 C 3s      -0.03214   0.00906   0.00000  -0.00000   0.01238
  0 C 2px     -0.00000   0.00000  -0.00000   0.70653   0.00000
  0 C 2py      0.00000  -0.00000   0.70653   0.00000  -0.00000
  0 C 2pz      0.33407  -0.40161   0.00000   0.00000   0.61999
  0 C 3px     -0.00000  -0.00000  -0.00000   0.01517  -0.00000
  0 C 3py      0.00000  -0.00000   0.01517   0.00000  -0.00000
  0 C 3pz     -0.03258  -0.00225   0.00000   0.00000  -0.04249
  0 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02420   0.00000  -0.00000
  0 C 3dz^2    0.02955  -0.00209   0.00000  -0.00000   0.02326
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.02420  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00641  -0.00352   0.00000   0.00000  -0.00088
  1 C 2s       0.62079  -0.58190  -0.00000  -0.00000  -0.33633
  1 C 3s      -0.03214  -0.00906  -0.00000   0.00000   0.01238
  1 C 2px      0.00000   0.00000   0.00000   0.70653   0.00000
  1 C 2py     -0.00000   0.00000   0.70653   0.00000  -0.00000
  1 C 2pz     -0.33407  -0.40161   0.00000  -0.00000  -0.61999
  1 C 3px      0.00000  -0.00000   0.00000   0.01517  -0.00000
  1 C 3py     -0.00000   0.00000   0.01517  -0.00000   0.00000
  1 C 3pz      0.03258  -0.00225   0.00000  -0.00000   0.04249
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02420   0.00000  -0.00000
  1 C 3dz^2    0.02955   0.00209  -0.00000   0.00000   0.02326
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02420   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000   0.00000   0.40101
  0 C 3s      -0.00000  -0.00000  -0.04346
  0 C 2px      0.70657  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70657   0.00000
  0 C 2pz     -0.00000   0.00000   0.58004
  0 C 3px     -0.01641  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01641  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02037
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02228  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02106
  0 C 3dxz    -0.02228  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s       0.00000   0.00000  -0.40101
  1 C 3s       0.00000  -0.00000   0.04346
  1 C 2px     -0.70657   0.00000   0.00000
  1 C 2py      0.00000  -0.70657   0.00000
  1 C 2pz     -0.00000   0.00000   0.58004
  1 C 3px      0.01641   0.00000   0.00000
  1 C 3py      0.00000   0.01641  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02037
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02228   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02106
  1 C 3dxz    -0.02228  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99198874
<CAS-nat-orb|mo-hf>  4  4    0.99770782
<CAS-nat-orb|mo-hf>  5  5    0.99952508
<CAS-nat-orb|mo-hf>  6  6    0.99952508
<CAS-nat-orb|mo-hf>  7  7    0.97453484
<CAS-nat-orb|mo-hf>  8  8    0.96668736
<CAS-nat-orb|mo-hf>  9  9    0.96668730
<CAS-nat-orb|mo-hf>  10  10    0.67408746
<CAS-nat-orb|mo-hf>  10  17    0.65475223
CASSCF energy = -75.5825189364314
CASCI E = -75.5825189364314  E(CI) = -16.5777815975582  S^2 = 0.0000000
......production of RDMs took       2.03 sec
......reading the RDM took          0.45 sec
......production of RDMs took      24.63 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickICMRREPT2-ijrs) =    -0.00026346876924
E(WickICMRREPT2- rsi) =    -0.00094388314566
E(WickICMRREPT2- ijr) =    -0.00035721330915
E(WickICMRREPT2-  rs) =    -0.05019450236556
E(WickICMRREPT2-  ij) =    -0.00010688589425
E(WickICMRREPT2-  ir) =    -0.00121724648811
E(WickICMRREPT2-   r) =    -0.05953080046511
E(WickICMRREPT2-   i) =    -0.00025726264334
E(WickICMRREPT2) = -75.69539019951179  E_corr_pt = -0.1128712630804261
Timings = pdms =   36.84 | eris =    0.16 | ijrs =    1.15 | rsi =   35.64 | ijr =    0.42 | rs =  659.32 | ij =    1.36 | ir =   27.40 | r =  172.48 | i =    2.36 | total =  937.19
Time cost =    997.551
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 21:15:13 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.508155051122 AA    0.000000000000   0.000000000000   2.850000000000 Bohr   0.0

nuclear repulsion = 12.6315789473684
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.425]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    318140.11


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpysylmn3c
max_memory 4000 MB (current use 404 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0836082427711

WARN: Singularity detected in overlap matrix (condition number =  275). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.178310042866846  LUMO (Ag) = -0.161961845746925
cycle= 1 E= -75.3070977055452  delta_E= -0.223  |g|= 0.234  |ddm|= 1.43
HOMO (B2u) = -0.4400579631129  LUMO (Ag) = -0.151084704136083
cycle= 2 E= -75.3276882495978  delta_E= -0.0206  |g|= 0.0513  |ddm|= 0.304
HOMO (B3u) = -0.402148496278865  LUMO (Ag) = -0.103839161942737
cycle= 3 E= -75.3286840635262  delta_E= -0.000996  |g|= 0.0121  |ddm|= 0.0544
HOMO (B2u) = -0.403404739232162  LUMO (Ag) = -0.10064529467541
cycle= 4 E= -75.3287765426504  delta_E= -9.25e-05  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.404190054526263  LUMO (Ag) = -0.101202470957946
cycle= 5 E= -75.3287803215958  delta_E= -3.78e-06  |g|= 0.000318  |ddm|= 0.00364
HOMO (B2u) = -0.404117903551405  LUMO (Ag) = -0.101124705066538
cycle= 6 E= -75.3287803833538  delta_E= -6.18e-08  |g|= 4.04e-05  |ddm|= 0.000637
HOMO (B3u) = -0.404109925173549  LUMO (Ag) = -0.10111191062226
cycle= 7 E= -75.3287803844586  delta_E= -1.1e-09  |g|= 5.18e-06  |ddm|= 0.000169
HOMO (B2u) = -0.404109663968691  LUMO (Ag) = -0.101110942652313
cycle= 8 E= -75.3287803844733  delta_E= -1.47e-11  |g|= 4.83e-07  |ddm|= 2.4e-05
HOMO (B3u) = -0.404109632109945  LUMO (Ag) = -0.101110794248159
cycle= 9 E= -75.3287803844733  delta_E=    0  |g|= 2.07e-08  |ddm|= 1.8e-06
HOMO (B2u) = -0.404109625552917  LUMO (Ag) = -0.101110800522627
cycle= 10 E= -75.3287803844733  delta_E= -5.68e-14  |g|= 3.06e-09  |ddm|= 7.31e-08
HOMO (B3u) = -0.404109626456309  LUMO (Ag) = -0.101110801382239
cycle= 11 E= -75.3287803844734  delta_E= -8.53e-14  |g|= 2.52e-09  |ddm|= 2.96e-09
HOMO (B3u) = -0.404109626197446  LUMO (Ag) = -0.10111080105429
cycle= 12 E= -75.3287803844734  delta_E= 5.68e-14  |g|= 1.8e-09  |ddm|= 2.82e-09
HOMO (B3u) = -0.404109626163528  LUMO (Ag) = -0.101110800945227
cycle= 13 E= -75.3287803844734  delta_E=    0  |g|= 1.48e-09  |ddm|= 1.64e-09
HOMO (B3u) = -0.404109626116564  LUMO (Ag) = -0.101110800889421
cycle= 14 E= -75.3287803844734  delta_E= 1.42e-14  |g|= 1.23e-09  |ddm|= 1.01e-09
HOMO (B3u) = -0.404109626090127  LUMO (Ag) = -0.1011108008627
cycle= 15 E= -75.3287803844733  delta_E= 1.42e-14  |g|= 1.04e-09  |ddm|= 6.13e-10
HOMO (B3u) = -0.404109626091085  LUMO (Ag) = -0.101110800892247
cycle= 16 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 9.36e-10  |ddm|= 1.12e-09
HOMO (B3u) = -0.404109626047672  LUMO (Ag) = -0.101110800856135
cycle= 17 E= -75.3287803844733  delta_E= 4.26e-14  |g|= 8.95e-10  |ddm|= 1.81e-10
HOMO (B3u) = -0.404109625906638  LUMO (Ag) = -0.101110800709252
cycle= 18 E= -75.3287803844734  delta_E= -8.53e-14  |g|= 3.85e-10  |ddm|= 1.99e-09
HOMO (B3u) = -0.404109625908117  LUMO (Ag) = -0.101110800703429
cycle= 19 E= -75.3287803844734  delta_E= 5.68e-14  |g|= 3.15e-10  |ddm|= 2.96e-10
HOMO (B3u) = -0.404109625926379  LUMO (Ag) = -0.101110800715434
cycle= 20 E= -75.3287803844734  delta_E= -2.84e-14  |g|= 2.49e-10  |ddm|= 2.2e-10
HOMO (B3u) = -0.404109625937588  LUMO (Ag) = -0.101110800722108
cycle= 21 E= -75.3287803844733  delta_E= 5.68e-14  |g|= 2.04e-10  |ddm|= 1.6e-10
HOMO (B3u) = -0.404109625945311  LUMO (Ag) = -0.101110800728189
cycle= 22 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 1.65e-10  |ddm|= 1.24e-10
HOMO (B2u) = -0.404109625951061  LUMO (Ag) = -0.101110800733095
cycle= 23 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 1.34e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.40410962595649  LUMO (Ag) = -0.101110800738096
cycle= 24 E= -75.3287803844733  delta_E= -2.84e-14  |g|= 1.08e-10  |ddm|= 9.78e-11
HOMO (B2u) = -0.404109625961302  LUMO (Ag) = -0.101110800741377
cycle= 25 E= -75.3287803844734  delta_E= -7.11e-14  |g|= 8.37e-11  |ddm|= 7.4e-11
HOMO (B2u) = -0.40410962596465  LUMO (Ag) = -0.101110800742978
cycle= 26 E= -75.3287803844733  delta_E= 8.53e-14  |g|= 5.9e-11  |ddm|= 7.02e-11
HOMO (B3u) = -0.404109625963269  LUMO (Ag) = -0.101110800740587
cycle= 27 E= -75.3287803844733  delta_E= -1.42e-14  |g|= 4.79e-11  |ddm|= 2.48e-11
HOMO (B3u) = -0.404109625961709  LUMO (Ag) = -0.101110800738284
cycle= 28 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 3.86e-11  |ddm|= 1.89e-11
HOMO (B3u) = -0.404109625960632  LUMO (Ag) = -0.101110800736698
cycle= 29 E= -75.3287803844733  delta_E= -4.26e-14  |g|= 3.12e-11  |ddm|= 1.47e-11
HOMO (B2u) = -0.404109625959828  LUMO (Ag) = -0.101110800735552
cycle= 30 E= -75.3287803844733  delta_E= -2.84e-14  |g|= 2.51e-11  |ddm|= 1.18e-11
HOMO (B3u) = -0.404109625959282  LUMO (Ag) = -0.101110800734708
cycle= 31 E= -75.3287803844733  delta_E=    0  |g|= 2.01e-11  |ddm|= 9.4e-12
HOMO (B2u) = -0.40410962595886  LUMO (Ag) = -0.101110800733108
Extra cycle  E= -75.3287803844733  delta_E=    0  |g|= 6.51e-12  |ddm|= 2.36e-11
converged SCF energy = -75.3287803844733

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpysylmn3c
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5139143945433  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5362301908141  dE = -0.022315796  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.548339880982  dE = -0.01210969  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0695  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5564887719868  dE = -0.008148891  S^2 = 0.0000000
               |grad[o]|=0.0932  |ddm|=0.0312  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5625262374719  dE = -0.0060374655  S^2 = 0.0000000
               |grad[o]|=0.0747  |ddm|=0.0183  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5670881352977  dE = -0.0045618978  S^2 = 0.0000000
               |grad[o]|=0.0588  |ddm|=0.0122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5704313549284  dE = -0.0033432196  S^2 = 0.0000000
               |grad[o]|=0.0446  |ddm|=0.00858  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5726887962906  dE = -0.0022574414  S^2 = 0.0000000
               |grad[o]|=0.0317  |ddm|=0.00647  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5739475221515  dE = -0.0012587259  S^2 = 0.0000000
               |grad[o]|=0.0197  |ddm|=0.00591  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.574284085705  dE = -0.00033656355  S^2 = 0.0000000
               |grad[o]|=0.00857  |ddm|=0.00674  |maxRot[o]|= 0.06
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5742936841767  dE = -9.5984717e-06  S^2 = 0.0000000
               |grad[o]|=0.00138  |ddm|=0.00615  |maxRot[o]|=0.0106
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5742938473244  dE = -1.6314769e-07  S^2 = 0.0000000
               |grad[o]|=0.00024  |ddm|=0.00135  |maxRot[o]|=0.00105
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5742938504639  dE = -3.1395189e-09  S^2 = 0.0000000
               |grad[o]|=3.74e-05  |ddm|=0.000171  |maxRot[o]|=0.00015
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5742938505333  dE = -6.9348971e-11  S^2 = 0.0000000
               |grad[o]|=4.73e-06  |ddm|=2.25e-05  |maxRot[o]|=2.25e-05
2-step CASSCF converged in 13 macro (65 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97574992 1.70399847 1.81154522 1.81154426 0.30304426 0.18612138
 0.1861214  0.02187509]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00665   0.00360   0.00000   0.00000  -0.00085
  0 C 2s       0.62384   0.58827  -0.00000   0.00000  -0.33076
  0 C 3s      -0.03017   0.00916   0.00000   0.00000   0.01475
  0 C 2px      0.00000  -0.00000  -0.00000   0.70651  -0.00000
  0 C 2py      0.00000  -0.00000   0.70651  -0.00000   0.00000
  0 C 2pz      0.32876  -0.39221   0.00000  -0.00000   0.62289
  0 C 3px      0.00000  -0.00000   0.00000   0.01725  -0.00000
  0 C 3py      0.00000  -0.00000   0.01725   0.00000   0.00000
  0 C 3pz     -0.03092  -0.00212   0.00000   0.00000  -0.04192
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02335   0.00000   0.00000
  0 C 3dz^2    0.02875  -0.00240   0.00000   0.00000   0.02515
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02335  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00665  -0.00360   0.00000   0.00000  -0.00085
  1 C 2s       0.62384  -0.58827  -0.00000  -0.00000  -0.33076
  1 C 3s      -0.03017  -0.00916  -0.00000  -0.00000   0.01475
  1 C 2px     -0.00000   0.00000  -0.00000   0.70651   0.00000
  1 C 2py     -0.00000   0.00000   0.70651  -0.00000  -0.00000
  1 C 2pz     -0.32876  -0.39221  -0.00000   0.00000  -0.62289
  1 C 3px     -0.00000   0.00000   0.00000   0.01725   0.00000
  1 C 3py     -0.00000   0.00000   0.01725   0.00000  -0.00000
  1 C 3pz      0.03092  -0.00212   0.00000   0.00000   0.04192
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02335  -0.00000   0.00000
  1 C 3dz^2    0.02875   0.00240  -0.00000  -0.00000   0.02515
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02335  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00033
  0 C 2s       0.00000  -0.00000   0.39163
  0 C 3s       0.00000   0.00000  -0.04339
  0 C 2px      0.70659   0.00000   0.00000
  0 C 2py      0.00000   0.70659   0.00000
  0 C 2pz      0.00000   0.00000   0.58640
  0 C 3px     -0.01557   0.00000   0.00000
  0 C 3py      0.00000  -0.01557   0.00000
  0 C 3pz      0.00000  -0.00000   0.02090
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02201   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02090
  0 C 3dxz    -0.02201   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00033
  1 C 2s       0.00000   0.00000  -0.39163
  1 C 3s      -0.00000  -0.00000   0.04339
  1 C 2px     -0.70659  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70659  -0.00000
  1 C 2pz      0.00000   0.00000   0.58640
  1 C 3px      0.01557  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01557  -0.00000
  1 C 3pz      0.00000   0.00000   0.02090
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02201   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02090
  1 C 3dxz    -0.02201   0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99173412
<CAS-nat-orb|mo-hf>  4  4    0.99760703
<CAS-nat-orb|mo-hf>  5  5    0.99948360
<CAS-nat-orb|mo-hf>  6  6    0.99948359
<CAS-nat-orb|mo-hf>  7  7    0.97418543
<CAS-nat-orb|mo-hf>  8  8    0.96886035
<CAS-nat-orb|mo-hf>  9  9    0.96886034
<CAS-nat-orb|mo-hf>  10  10    0.69921469
<CAS-nat-orb|mo-hf>  10  15   -0.63804094
CASSCF energy = -75.5742938505333
CASCI E = -75.5742938505333  E(CI) = -16.4693217945525  S^2 = 0.0000000
......production of RDMs took       3.90 sec
......reading the RDM took          0.46 sec
......production of RDMs took      28.52 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICMRREPT2-ijrs) =    -0.00026179269295
E(WickICMRREPT2- rsi) =    -0.00093525164432
E(WickICMRREPT2- ijr) =    -0.00035094622150
E(WickICMRREPT2-  rs) =    -0.04971866086276
E(WickICMRREPT2-  ij) =    -0.00010204873341
E(WickICMRREPT2-  ir) =    -0.00120295539117
E(WickICMRREPT2-   r) =    -0.06052854335164
E(WickICMRREPT2-   i) =    -0.00025108041837
E(WickICMRREPT2) = -75.68764512984941  E_corr_pt = -0.1133512793161314
Timings = pdms =   42.65 | eris =    0.18 | ijrs =    1.25 | rsi =   43.02 | ijr =    0.50 | rs =  704.58 | ij =    1.34 | ir =   28.32 | r =  173.18 | i =    2.35 | total =  997.46
Time cost =   1057.080
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 21:32:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.534613911668 AA    0.000000000000   0.000000000000   2.900000000000 Bohr   0.0

nuclear repulsion = 12.4137931034483
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.45]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    334549.58


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpthvto1et
max_memory 4000 MB (current use 406 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0502696488693

WARN: Singularity detected in overlap matrix (condition number =  255). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.171982441441623  LUMO (Ag) = -0.159994465911487
cycle= 1 E= -75.2972707224471  delta_E= -0.247  |g|= 0.236  |ddm|= 1.43
HOMO (B3u) = -0.435771051837408  LUMO (Ag) = -0.150538347855669
cycle= 2 E= -75.3184487790456  delta_E= -0.0212  |g|= 0.051  |ddm|= 0.31
HOMO (B3u) = -0.397800865131721  LUMO (Ag) = -0.102495692949928
cycle= 3 E= -75.3194573772646  delta_E= -0.00101  |g|= 0.0124  |ddm|= 0.0544
HOMO (B3u) = -0.399183030564796  LUMO (Ag) = -0.0993011615665468
cycle= 4 E= -75.3195559425282  delta_E= -9.86e-05  |g|= 0.00229  |ddm|= 0.0157
HOMO (B2u) = -0.399959753294006  LUMO (Ag) = -0.0998732578136669
cycle= 5 E= -75.3195598190019  delta_E= -3.88e-06  |g|= 0.000323  |ddm|= 0.00343
HOMO (B2u) = -0.399888567456494  LUMO (Ag) = -0.099801991693929
cycle= 6 E= -75.3195598822274  delta_E= -6.32e-08  |g|= 4.09e-05  |ddm|= 0.000646
HOMO (B3u) = -0.399880517827682  LUMO (Ag) = -0.0997890778930981
cycle= 7 E= -75.3195598833514  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000156
HOMO (B3u) = -0.399880142870902  LUMO (Ag) = -0.0997880477227867
cycle= 8 E= -75.3195598833671  delta_E= -1.57e-11  |g|= 5.02e-07  |ddm|= 2.32e-05
HOMO (B3u) = -0.399880110369028  LUMO (Ag) = -0.0997878828349443
cycle= 9 E= -75.3195598833671  delta_E=    0  |g|= 2.12e-08  |ddm|= 1.59e-06
HOMO (B2u) = -0.39988010348895  LUMO (Ag) = -0.0997878912045858
cycle= 10 E= -75.319559883367  delta_E= 8.53e-14  |g|= 3.19e-09  |ddm|= 7.71e-08
HOMO (B2u) = -0.399880104501725  LUMO (Ag) = -0.0997878922045956
cycle= 11 E= -75.319559883367  delta_E= -5.68e-14  |g|= 2.56e-09  |ddm|= 3.76e-09
HOMO (B2u) = -0.399880104201896  LUMO (Ag) = -0.09978789182413
cycle= 12 E= -75.319559883367  delta_E= 2.84e-14  |g|= 1.87e-09  |ddm|= 2.62e-09
HOMO (B2u) = -0.399880104169498  LUMO (Ag) = -0.0997878916913064
cycle= 13 E= -75.319559883367  delta_E= -2.84e-14  |g|= 1.58e-09  |ddm|= 1.58e-09
HOMO (B2u) = -0.399880104126446  LUMO (Ag) = -0.099787891646717
cycle= 14 E= -75.3195598833671  delta_E= -2.84e-14  |g|= 1.31e-09  |ddm|= 1.08e-09
HOMO (B2u) = -0.399880104099342  LUMO (Ag) = -0.0997878916237382
cycle= 15 E= -75.319559883367  delta_E= 2.84e-14  |g|= 1.11e-09  |ddm|= 6.95e-10
HOMO (B2u) = -0.399880104083561  LUMO (Ag) = -0.0997878916328547
cycle= 16 E= -75.319559883367  delta_E= 5.68e-14  |g|= 1.01e-09  |ddm|= 8.86e-10
HOMO (B2u) = -0.399880104057939  LUMO (Ag) = -0.0997878916092449
cycle= 17 E= -75.319559883367  delta_E= -2.84e-14  |g|= 9.25e-10  |ddm|= 3.58e-10
HOMO (B2u) = -0.399880103906904  LUMO (Ag) = -0.099787891469439
cycle= 18 E= -75.319559883367  delta_E= 5.68e-14  |g|= 4.03e-10  |ddm|= 2.15e-09
HOMO (B2u) = -0.399880103907974  LUMO (Ag) = -0.0997878914634604
cycle= 19 E= -75.319559883367  delta_E=    0  |g|= 3.3e-10  |ddm|= 3.17e-10
HOMO (B2u) = -0.399880103927034  LUMO (Ag) = -0.0997878914764484
cycle= 20 E= -75.3195598833671  delta_E= -1.14e-13  |g|= 2.64e-10  |ddm|= 2.22e-10
HOMO (B3u) = -0.399880103938571  LUMO (Ag) = -0.0997878914833051
cycle= 21 E= -75.319559883367  delta_E= 1.14e-13  |g|= 2.17e-10  |ddm|= 1.64e-10
HOMO (B2u) = -0.399880103945996  LUMO (Ag) = -0.0997878914898853
cycle= 22 E= -75.319559883367  delta_E= -5.68e-14  |g|= 1.76e-10  |ddm|= 1.3e-10
HOMO (B3u) = -0.399880103951711  LUMO (Ag) = -0.0997878914952168
cycle= 23 E= -75.3195598833671  delta_E= -8.53e-14  |g|= 1.42e-10  |ddm|= 1.08e-10
HOMO (B3u) = -0.399880103957515  LUMO (Ag) = -0.0997878915010249
cycle= 24 E= -75.319559883367  delta_E= 1.14e-13  |g|= 1.15e-10  |ddm|= 1.04e-10
HOMO (B3u) = -0.399880103962225  LUMO (Ag) = -0.099787891504838
cycle= 25 E= -75.319559883367  delta_E=    0  |g|= 8.76e-11  |ddm|= 8.46e-11
HOMO (B3u) = -0.399880103960229  LUMO (Ag) = -0.0997878915001841
Extra cycle  E= -75.319559883367  delta_E= 2.84e-14  |g|= 2.66e-11  |ddm|= 1.53e-10
converged SCF energy = -75.319559883367

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpthvto1et
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5069071999533  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.528794262368  dE = -0.021887062  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.72  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5408991693876  dE = -0.012104907  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0689  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5490639029587  dE = -0.0081647336  S^2 = 0.0000000
               |grad[o]|=0.093  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5550610059985  dE = -0.005997103  S^2 = 0.0000000
               |grad[o]|=0.0741  |ddm|=0.0189  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5595129978683  dE = -0.0044519919  S^2 = 0.0000000
               |grad[o]|=0.0577  |ddm|=0.0126  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5626837707515  dE = -0.0031707729  S^2 = 0.0000000
               |grad[o]|=0.043  |ddm|=0.00882  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5647161334121  dE = -0.0020323627  S^2 = 0.0000000
               |grad[o]|=0.0294  |ddm|=0.00676  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5657087101252  dE = -0.00099257671  S^2 = 0.0000000
               |grad[o]|=0.0169  |ddm|=0.00658  |maxRot[o]|=0.0799
macro iter 9 (4 JK  0 micro), CASSCF E = -75.565845329849  dE = -0.00013661972  S^2 = 0.0000000
               |grad[o]|=0.00539  |ddm|=0.00791  |maxRot[o]|= 0.04
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5658470539864  dE = -1.7241375e-06  S^2 = 0.0000000
               |grad[o]|=0.000739  |ddm|=0.00486  |maxRot[o]|=0.00387
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5658470909476  dE = -3.6961211e-08  S^2 = 0.0000000
               |grad[o]|=0.000114  |ddm|=0.000648  |maxRot[o]|=0.000437
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5658470916857  dE = -7.3802653e-10  S^2 = 0.0000000
               |grad[o]|=1.91e-05  |ddm|=8.13e-05  |maxRot[o]|=6.69e-05
macro iter 13 (3 JK  0 micro), CASSCF E = -75.565847091702  dE = -1.6356694e-11  S^2 = 0.0000000
               |grad[o]|=2.73e-06  |ddm|=1.31e-05  |maxRot[o]|=1.18e-05
2-step CASSCF converged in 13 macro (64 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97493415 1.71266198 1.80128063 1.80127968 0.29742509 0.19483039
 0.1948301  0.02275797]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00688   0.00368   0.00000   0.00000  -0.00082
  0 C 2s       0.62688   0.59446  -0.00000  -0.00000  -0.32511
  0 C 3s      -0.02821   0.00928  -0.00000  -0.00000   0.01701
  0 C 2px      0.00000  -0.00000  -0.00000   0.70649   0.00000
  0 C 2py     -0.00000  -0.00000   0.70649  -0.00000   0.00000
  0 C 2pz      0.32333  -0.38275   0.00000  -0.00000   0.62577
  0 C 3px      0.00000  -0.00000   0.00000   0.01921   0.00000
  0 C 3py     -0.00000   0.00000   0.01921   0.00000  -0.00000
  0 C 3pz     -0.02927  -0.00203  -0.00000  -0.00000  -0.04115
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02251   0.00000  -0.00000
  0 C 3dz^2    0.02800  -0.00269  -0.00000  -0.00000   0.02714
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02251   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00688  -0.00368   0.00000   0.00000  -0.00082
  1 C 2s       0.62688  -0.59446   0.00000   0.00000  -0.32511
  1 C 3s      -0.02821  -0.00928   0.00000   0.00000   0.01701
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70649  -0.00000
  1 C 2py      0.00000  -0.00000   0.70649  -0.00000   0.00000
  1 C 2pz     -0.32333  -0.38275  -0.00000  -0.00000  -0.62577
  1 C 3px     -0.00000   0.00000   0.00000   0.01921  -0.00000
  1 C 3py      0.00000  -0.00000   0.01921   0.00000  -0.00000
  1 C 3pz      0.02927  -0.00203  -0.00000  -0.00000   0.04115
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02251  -0.00000  -0.00000
  1 C 3dz^2    0.02800   0.00269  -0.00000   0.00000   0.02714
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02251   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.38221
  0 C 3s      -0.00000  -0.00000  -0.04321
  0 C 2px      0.70662  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70662  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.59260
  0 C 3px     -0.01471  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01471  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02126
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02171  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02074
  0 C 3dxz    -0.02171  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.38221
  1 C 3s       0.00000   0.00000   0.04321
  1 C 2px     -0.70662   0.00000   0.00000
  1 C 2py      0.00000  -0.70662   0.00000
  1 C 2pz     -0.00000  -0.00000   0.59260
  1 C 3px      0.01471   0.00000   0.00000
  1 C 3py      0.00000   0.01471   0.00000
  1 C 3pz     -0.00000  -0.00000   0.02126
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02171  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02074
  1 C 3dxz    -0.02171  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99150096
<CAS-nat-orb|mo-hf>  4  4    0.99751312
<CAS-nat-orb|mo-hf>  5  5    0.99943968
<CAS-nat-orb|mo-hf>  6  6    0.99943968
<CAS-nat-orb|mo-hf>  7  7    0.97389130
<CAS-nat-orb|mo-hf>  8  8    0.97085580
<CAS-nat-orb|mo-hf>  9  9    0.97085576
<CAS-nat-orb|mo-hf>  10  10    0.72379474
<CAS-nat-orb|mo-hf>  10  14   -0.61908421
CASSCF energy = -75.565847091702
CASCI E = -75.565847091702  E(CI) = -16.3640995525045  S^2 = 0.0000000
......production of RDMs took       1.99 sec
......reading the RDM took          0.42 sec
......production of RDMs took      34.02 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.81 sec

E(WickICMRREPT2-ijrs) =    -0.00026053205599
E(WickICMRREPT2- rsi) =    -0.00092779404661
E(WickICMRREPT2- ijr) =    -0.00034480250020
E(WickICMRREPT2-  rs) =    -0.04925927392845
E(WickICMRREPT2-  ij) =    -0.00009738349804
E(WickICMRREPT2-  ir) =    -0.00118934574629
E(WickICMRREPT2-   r) =    -0.06154198955837
E(WickICMRREPT2-   i) =    -0.00024489323088
E(WickICMRREPT2) = -75.67971310626686  E_corr_pt = -0.113866014564831
Timings = pdms =   46.24 | eris =    0.18 | ijrs =    1.25 | rsi =   45.26 | ijr =    0.44 | rs =  673.36 | ij =    1.64 | ir =   27.58 | r =  156.70 | i =    2.35 | total =  955.06
Time cost =   1014.109
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 21:49:44 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.561072772214 AA    0.000000000000   0.000000000000   2.950000000000 Bohr   0.0

nuclear repulsion = 12.2033898305085
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.475]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    350110.12


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp6v5sp274
max_memory 4000 MB (current use 404 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0186954217207

WARN: Singularity detected in overlap matrix (condition number =  236). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.165974687131635  LUMO (Ag) = -0.158079543422895
cycle= 1 E= -75.2873378760354  delta_E= -0.269  |g|= 0.239  |ddm|= 1.43
HOMO (B3u) = -0.431571893819985  LUMO (Ag) = -0.149790781563184
cycle= 2 E= -75.3090731833374  delta_E= -0.0217  |g|= 0.0507  |ddm|= 0.316
HOMO (B2u) = -0.393547996937858  LUMO (Ag) = -0.100989331184849
cycle= 3 E= -75.3100918952135  delta_E= -0.00102  |g|= 0.0127  |ddm|= 0.0544
HOMO (B2u) = -0.39507505412911  LUMO (Ag) = -0.0978528282721957
cycle= 4 E= -75.3101958879618  delta_E= -0.000104  |g|= 0.00229  |ddm|= 0.0157
HOMO (B2u) = -0.395838291352907  LUMO (Ag) = -0.0984379062399662
cycle= 5 E= -75.3101998099164  delta_E= -3.92e-06  |g|= 0.000326  |ddm|= 0.00328
HOMO (B2u) = -0.3957689454445  LUMO (Ag) = -0.0983739814936204
cycle= 6 E= -75.3101998734464  delta_E= -6.35e-08  |g|= 4.1e-05  |ddm|= 0.000649
HOMO (B3u) = -0.395760954503398  LUMO (Ag) = -0.0983611341563393
cycle= 7 E= -75.3101998745662  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000143
HOMO (B3u) = -0.395760469633685  LUMO (Ag) = -0.0983600611975541
cycle= 8 E= -75.310199874582  delta_E= -1.59e-11  |g|= 5.2e-07  |ddm|= 2.23e-05
HOMO (B3u) = -0.395760436404804  LUMO (Ag) = -0.0983598792411125
cycle= 9 E= -75.3101998745822  delta_E= -1.28e-13  |g|= 2.17e-08  |ddm|= 1.39e-06
HOMO (B3u) = -0.395760429248385  LUMO (Ag) = -0.0983598897706433
cycle= 10 E= -75.3101998745822  delta_E= 1.42e-14  |g|= 3.33e-09  |ddm|= 8.05e-08
HOMO (B3u) = -0.395760430322182  LUMO (Ag) = -0.0983598908574985
cycle= 11 E= -75.3101998745822  delta_E=    0  |g|= 2.59e-09  |ddm|= 4.24e-09
HOMO (B2u) = -0.395760430022653  LUMO (Ag) = -0.0983598904737524
cycle= 12 E= -75.3101998745823  delta_E= -1.14e-13  |g|= 1.93e-09  |ddm|= 2.57e-09
HOMO (B2u) = -0.395760430007127  LUMO (Ag) = -0.0983598903343588
cycle= 13 E= -75.3101998745822  delta_E= 1.14e-13  |g|= 1.67e-09  |ddm|= 1.68e-09
HOMO (B3u) = -0.395760429956606  LUMO (Ag) = -0.0983598902851704
cycle= 14 E= -75.3101998745821  delta_E= 1.42e-14  |g|= 1.39e-09  |ddm|= 9.97e-10
HOMO (B2u) = -0.395760429928273  LUMO (Ag) = -0.0983598902663916
cycle= 15 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 1.19e-09  |ddm|= 7.99e-10
HOMO (B3u) = -0.395760429915581  LUMO (Ag) = -0.0983598902691673
cycle= 16 E= -75.3101998745823  delta_E= -1.14e-13  |g|= 1.06e-09  |ddm|= 8.14e-10
HOMO (B2u) = -0.39576042989186  LUMO (Ag) = -0.0983598902483033
cycle= 17 E= -75.3101998745822  delta_E= 8.53e-14  |g|= 9.59e-10  |ddm|= 4.1e-10
HOMO (B3u) = -0.395760429734388  LUMO (Ag) = -0.0983598901196731
cycle= 18 E= -75.3101998745822  delta_E= 5.68e-14  |g|= 4.21e-10  |ddm|= 2.31e-09
HOMO (B3u) = -0.395760429734927  LUMO (Ag) = -0.098359890113453
cycle= 19 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 3.44e-10  |ddm|= 3.34e-10
HOMO (B3u) = -0.395760429753803  LUMO (Ag) = -0.0983598901267473
cycle= 20 E= -75.3101998745822  delta_E=    0  |g|= 2.78e-10  |ddm|= 2.27e-10
HOMO (B3u) = -0.395760429765456  LUMO (Ag) = -0.0983598901336492
cycle= 21 E= -75.3101998745822  delta_E= -2.84e-14  |g|= 2.31e-10  |ddm|= 1.7e-10
HOMO (B3u) = -0.395760429772663  LUMO (Ag) = -0.0983598901407184
cycle= 22 E= -75.3101998745821  delta_E= 9.95e-14  |g|= 1.87e-10  |ddm|= 1.34e-10
HOMO (B2u) = -0.395760429778156  LUMO (Ag) = -0.0983598901464076
cycle= 23 E= -75.3101998745823  delta_E= -1.56e-13  |g|= 1.5e-10  |ddm|= 1.13e-10
HOMO (B3u) = -0.395760429784107  LUMO (Ag) = -0.0983598901528697
cycle= 24 E= -75.3101998745822  delta_E= 1.42e-13  |g|= 1.2e-10  |ddm|= 1.11e-10
HOMO (B3u) = -0.395760429789085  LUMO (Ag) = -0.0983598901578786
cycle= 25 E= -75.3101998745823  delta_E= -1.14e-13  |g|= 9.17e-11  |ddm|= 9.31e-11
HOMO (B2u) = -0.39576042979306  LUMO (Ag) = -0.0983598901618817
cycle= 26 E= -75.3101998745823  delta_E=    0  |g|= 6.59e-11  |ddm|= 8.49e-11
HOMO (B2u) = -0.395760429786212  LUMO (Ag) = -0.0983598901540784
Extra cycle  E= -75.3101998745822  delta_E= 5.68e-14  |g|= 2.02e-11  |ddm|= 1e-10
converged SCF energy = -75.3101998745822

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp6v5sp274
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.499829537802  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5213335335791  dE = -0.021503996  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5334161382026  dE = -0.012082605  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0682  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5415789229082  dE = -0.0081627847  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0323  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5475124010121  dE = -0.0059334781  S^2 = 0.0000000
               |grad[o]|=0.0732  |ddm|=0.0196  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5518257257346  dE = -0.0043133247  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0131  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5547913705211  dE = -0.0029656448  S^2 = 0.0000000
               |grad[o]|=0.0409  |ddm|=0.00918  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5565626349569  dE = -0.0017712644  S^2 = 0.0000000
               |grad[o]|=0.0267  |ddm|=0.00732  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5571750232565  dE = -0.0006123883  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00767  |maxRot[o]|= 0.06
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5572696087177  dE = -9.4585461e-05  S^2 = 0.0000000
               |grad[o]|=0.00458  |ddm|=0.00702  |maxRot[o]|=0.0325
macro iter 10 (3 JK  0 micro), CASSCF E = -75.55727072122  dE = -1.1125023e-06  S^2 = 0.0000000
               |grad[o]|=0.000629  |ddm|=0.00451  |maxRot[o]|=0.00289
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5572707457967  dE = -2.4576678e-08  S^2 = 0.0000000
               |grad[o]|=9.69e-05  |ddm|=0.000585  |maxRot[o]|=0.000339
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5572707462856  dE = -4.8892446e-10  S^2 = 0.0000000
               |grad[o]|=1.64e-05  |ddm|=7.43e-05  |maxRot[o]|=4.96e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5572707462967  dE = -1.1098678e-11  S^2 = 0.0000000
               |grad[o]|=2.45e-06  |ddm|=1.14e-05  |maxRot[o]|=8.68e-06
2-step CASSCF converged in 13 macro (62 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97414482 1.72120466 1.79044094 1.79044226 0.29254404 0.20379325
 0.20379322 0.02363682]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00710   0.00377   0.00000   0.00000  -0.00079
  0 C 2s       0.62989   0.60047   0.00000   0.00000  -0.31937
  0 C 3s      -0.02627   0.00941  -0.00000   0.00000   0.01911
  0 C 2px     -0.00000   0.00000   0.00000   0.70646  -0.00000
  0 C 2py      0.00000  -0.00000   0.70646   0.00000  -0.00000
  0 C 2pz      0.31779  -0.37325   0.00000   0.00000   0.62862
  0 C 3px     -0.00000   0.00000  -0.00000   0.02107  -0.00000
  0 C 3py      0.00000  -0.00000   0.02107  -0.00000  -0.00000
  0 C 3pz     -0.02764  -0.00196  -0.00000   0.00000  -0.04016
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02166  -0.00000  -0.00000
  0 C 3dz^2    0.02729  -0.00296  -0.00000   0.00000   0.02921
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02166  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00710  -0.00377   0.00000   0.00000  -0.00079
  1 C 2s       0.62989  -0.60047   0.00000  -0.00000  -0.31937
  1 C 3s      -0.02627  -0.00941  -0.00000  -0.00000   0.01911
  1 C 2px      0.00000   0.00000   0.00000   0.70646   0.00000
  1 C 2py      0.00000   0.00000   0.70646   0.00000   0.00000
  1 C 2pz     -0.31779  -0.37325   0.00000   0.00000  -0.62862
  1 C 3px      0.00000  -0.00000  -0.00000   0.02107   0.00000
  1 C 3py     -0.00000   0.00000   0.02107   0.00000   0.00000
  1 C 3pz      0.02764  -0.00196   0.00000   0.00000   0.04016
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02166  -0.00000  -0.00000
  1 C 3dz^2    0.02729   0.00296  -0.00000  -0.00000   0.02921
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02166  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00027
  0 C 2s       0.00000   0.00000   0.37274
  0 C 3s       0.00000  -0.00000  -0.04290
  0 C 2px      0.70665  -0.00000   0.00000
  0 C 2py     -0.00000   0.70665   0.00000
  0 C 2pz      0.00000  -0.00000   0.59862
  0 C 3px     -0.01384   0.00000   0.00000
  0 C 3py      0.00000  -0.01384  -0.00000
  0 C 3pz      0.00000  -0.00000   0.02142
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02139  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02055
  0 C 3dxz    -0.02139   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00027
  1 C 2s      -0.00000   0.00000  -0.37274
  1 C 3s      -0.00000   0.00000   0.04290
  1 C 2px     -0.70665   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70665   0.00000
  1 C 2pz      0.00000   0.00000   0.59862
  1 C 3px      0.01384   0.00000  -0.00000
  1 C 3py      0.00000   0.01384   0.00000
  1 C 3pz      0.00000  -0.00000   0.02142
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02139  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02055
  1 C 3dxz    -0.02139  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99129326
<CAS-nat-orb|mo-hf>  4  4    0.99742902
<CAS-nat-orb|mo-hf>  5  5    0.99939339
<CAS-nat-orb|mo-hf>  6  6    0.99939339
<CAS-nat-orb|mo-hf>  7  7    0.97366309
<CAS-nat-orb|mo-hf>  8  8    0.97269185
<CAS-nat-orb|mo-hf>  9  9    0.97269186
<CAS-nat-orb|mo-hf>  10  10    0.74746745
<CAS-nat-orb|mo-hf>  10  14   -0.59840371
CASSCF energy = -75.5572707462967
CASCI E = -75.5572707462967  E(CI) = -16.2620310686451  S^2 = 0.0000000
......production of RDMs took       1.90 sec
......reading the RDM took          0.41 sec
......production of RDMs took      22.28 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickICMRREPT2-ijrs) =    -0.00025966188811
E(WickICMRREPT2- rsi) =    -0.00092145857030
E(WickICMRREPT2- ijr) =    -0.00033880397962
E(WickICMRREPT2-  rs) =    -0.04881958650357
E(WickICMRREPT2-  ij) =    -0.00009289850894
E(WickICMRREPT2-  ir) =    -0.00117643292078
E(WickICMRREPT2-   r) =    -0.06257124881796
E(WickICMRREPT2-   i) =    -0.00023869299017
E(WickICMRREPT2) = -75.67168953047613  E_corr_pt = -0.114418784179451
Timings = pdms =   34.38 | eris =    0.04 | ijrs =    1.16 | rsi =   37.57 | ijr =    0.43 | rs =  645.11 | ij =    1.37 | ir =   27.81 | r =  198.34 | i =    2.37 | total =  948.65
Time cost =   1015.160
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:06:39 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.587531632760 AA    0.000000000000   0.000000000000   3.000000000000 Bohr   0.0

nuclear repulsion = 12
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.5]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    365848.11


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpqmc28fcs
max_memory 4000 MB (current use 406 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9888325390205

WARN: Singularity detected in overlap matrix (condition number =  219). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.16026848860678  LUMO (Ag) = -0.156209924431072
cycle= 1 E= -75.2773690146387  delta_E= -0.289  |g|= 0.241  |ddm|= 1.43
HOMO (B3u) = -0.427459076932467  LUMO (Ag) = -0.148855300078026
cycle= 2 E= -75.2996288397617  delta_E= -0.0223  |g|= 0.0503  |ddm|= 0.321
HOMO (B2u) = -0.389387614274558  LUMO (Ag) = -0.0993360736972413
cycle= 3 E= -75.3006548036907  delta_E= -0.00103  |g|= 0.013  |ddm|= 0.0545
HOMO (B3u) = -0.391075001807692  LUMO (Ag) = -0.096313313287664
cycle= 4 E= -75.300763401749  delta_E= -0.000109  |g|= 0.00228  |ddm|= 0.0159
HOMO (B2u) = -0.391819817512152  LUMO (Ag) = -0.0969078799501798
cycle= 5 E= -75.3007673195955  delta_E= -3.92e-06  |g|= 0.000327  |ddm|= 0.00318
HOMO (B3u) = -0.391752968347542  LUMO (Ag) = -0.096851802087954
cycle= 6 E= -75.3007673825198  delta_E= -6.29e-08  |g|= 4.07e-05  |ddm|= 0.000647
HOMO (B3u) = -0.391745163678227  LUMO (Ag) = -0.0968392001457659
cycle= 7 E= -75.3007673836116  delta_E= -1.09e-09  |g|= 5.16e-06  |ddm|= 0.00013
HOMO (B3u) = -0.391744579298909  LUMO (Ag) = -0.0968381087429955
cycle= 8 E= -75.3007673836275  delta_E= -1.59e-11  |g|= 5.37e-07  |ddm|= 2.12e-05
HOMO (B2u) = -0.391744545069352  LUMO (Ag) = -0.0968379095778767
cycle= 9 E= -75.3007673836275  delta_E= -4.26e-14  |g|= 2.23e-08  |ddm|= 1.2e-06
HOMO (B3u) = -0.391744537674299  LUMO (Ag) = -0.0968379222718583
cycle= 10 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 3.48e-09  |ddm|= 8.33e-08
HOMO (B3u) = -0.391744538783398  LUMO (Ag) = -0.0968379234149896
cycle= 11 E= -75.3007673836276  delta_E= 1.42e-14  |g|= 2.63e-09  |ddm|= 4.53e-09
HOMO (B3u) = -0.391744538505574  LUMO (Ag) = -0.0968379230556907
cycle= 12 E= -75.3007673836276  delta_E= -4.26e-14  |g|= 2e-09  |ddm|= 2.59e-09
HOMO (B3u) = -0.391744538510615  LUMO (Ag) = -0.0968379229129838
cycle= 13 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 1.76e-09  |ddm|= 1.81e-09
HOMO (B3u) = -0.391744538456186  LUMO (Ag) = -0.0968379228641024
cycle= 14 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 1.47e-09  |ddm|= 9.42e-10
HOMO (B3u) = -0.391744538422892  LUMO (Ag) = -0.0968379228452676
cycle= 15 E= -75.3007673836275  delta_E= 1.28e-13  |g|= 1.27e-09  |ddm|= 8.89e-10
HOMO (B2u) = -0.391744538403729  LUMO (Ag) = -0.0968379228367225
cycle= 16 E= -75.3007673836276  delta_E= -8.53e-14  |g|= 1.14e-09  |ddm|= 6.92e-10
HOMO (B3u) = -0.391744538390087  LUMO (Ag) = -0.0968379228224124
cycle= 17 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 1e-09  |ddm|= 4.87e-10
HOMO (B2u) = -0.391744538229882  LUMO (Ag) = -0.0968379227085943
cycle= 18 E= -75.3007673836275  delta_E= 1.14e-13  |g|= 4.41e-10  |ddm|= 2.45e-09
HOMO (B3u) = -0.391744538229819  LUMO (Ag) = -0.096837922702096
cycle= 19 E= -75.3007673836275  delta_E= -2.84e-14  |g|= 3.6e-10  |ddm|= 3.48e-10
HOMO (B3u) = -0.391744538248043  LUMO (Ag) = -0.0968379227153246
cycle= 20 E= -75.3007673836277  delta_E= -1.14e-13  |g|= 2.95e-10  |ddm|= 2.34e-10
HOMO (B2u) = -0.39174453825967  LUMO (Ag) = -0.096837922722212
cycle= 21 E= -75.3007673836276  delta_E= 2.84e-14  |g|= 2.47e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.39174453826654  LUMO (Ag) = -0.0968379227297556
cycle= 22 E= -75.3007673836277  delta_E= -5.68e-14  |g|= 2e-10  |ddm|= 1.37e-10
HOMO (B2u) = -0.391744538271795  LUMO (Ag) = -0.0968379227358049
cycle= 23 E= -75.3007673836276  delta_E= 1.14e-13  |g|= 1.62e-10  |ddm|= 1.17e-10
HOMO (B3u) = -0.391744538277748  LUMO (Ag) = -0.0968379227428062
cycle= 24 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 1.28e-10  |ddm|= 1.16e-10
HOMO (B3u) = -0.39174453828262  LUMO (Ag) = -0.0968379227484705
cycle= 25 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 9.73e-11  |ddm|= 1.01e-10
HOMO (B3u) = -0.391744538286831  LUMO (Ag) = -0.0968379227536594
cycle= 26 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 7.05e-11  |ddm|= 9.22e-11
HOMO (B2u) = -0.391744538285512  LUMO (Ag) = -0.0968379227518176
cycle= 27 E= -75.3007673836276  delta_E=    0  |g|= 5.79e-11  |ddm|= 3.08e-11
HOMO (B3u) = -0.391744538280082  LUMO (Ag) = -0.0968379227467376
Extra cycle  E= -75.3007673836276  delta_E= 1.42e-14  |g|= 1.81e-11  |ddm|= 8.37e-11
converged SCF energy = -75.3007673836276

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpqmc28fcs
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4927493145095  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5138848570108  dE = -0.021135543  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5259228809374  dE = -0.012038024  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.534067314612  dE = -0.0081444337  S^2 = 0.0000000
               |grad[o]|=0.0918  |ddm|=0.0329  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5399163567103  dE = -0.0058490421  S^2 = 0.0000000
               |grad[o]|=0.0719  |ddm|=0.0206  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5440667830806  dE = -0.0041504264  S^2 = 0.0000000
               |grad[o]|=0.0544  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5467996670462  dE = -0.002732884  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00993  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5482783207095  dE = -0.0014786537  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00842  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5486404656314  dE = -0.00036214492  S^2 = 0.0000000
               |grad[o]|=0.00986  |ddm|=0.00938  |maxRot[o]|= 0.06
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5486450984632  dE = -4.6328319e-06  S^2 = 0.0000000
               |grad[o]|=0.00124  |ddm|=0.0088  |maxRot[o]|=0.00593
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5486452003136  dE = -1.0185035e-07  S^2 = 0.0000000
               |grad[o]|=0.000216  |ddm|=0.00137  |maxRot[o]|=0.00062
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5486452023076  dE = -1.9939961e-09  S^2 = 0.0000000
               |grad[o]|=3.57e-05  |ddm|=0.000184  |maxRot[o]|=8.97e-05
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5486452023529  dE = -4.5332627e-11  S^2 = 0.0000000
               |grad[o]|=5.19e-06  |ddm|=2.78e-05  |maxRot[o]|=1.6e-05
2-step CASSCF converged in 12 macro (59 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97338733 1.72966171 1.77895233 1.77895355 0.28849582 0.21301931
 0.21301943 0.02451051]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00731   0.00385   0.00000   0.00000  -0.00077
  0 C 2s       0.63288   0.60630   0.00000  -0.00000  -0.31355
  0 C 3s      -0.02435   0.00955  -0.00000  -0.00000   0.02103
  0 C 2px      0.00000  -0.00000  -0.00000   0.70643  -0.00000
  0 C 2py     -0.00000   0.00000   0.70643   0.00000  -0.00000
  0 C 2pz      0.31214  -0.36370  -0.00000  -0.00000   0.63146
  0 C 3px      0.00000  -0.00000  -0.00000   0.02283  -0.00000
  0 C 3py      0.00000  -0.00000   0.02283   0.00000  -0.00000
  0 C 3pz     -0.02602  -0.00192  -0.00000  -0.00000  -0.03894
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02081   0.00000  -0.00000
  0 C 3dz^2    0.02662  -0.00320  -0.00000  -0.00000   0.03135
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02081  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00731  -0.00385   0.00000   0.00000  -0.00077
  1 C 2s       0.63288  -0.60630   0.00000   0.00000  -0.31355
  1 C 3s      -0.02435  -0.00955   0.00000   0.00000   0.02103
  1 C 2px     -0.00000   0.00000   0.00000   0.70643   0.00000
  1 C 2py      0.00000   0.00000   0.70643  -0.00000   0.00000
  1 C 2pz     -0.31214  -0.36370   0.00000   0.00000  -0.63146
  1 C 3px     -0.00000   0.00000   0.00000   0.02283   0.00000
  1 C 3py      0.00000  -0.00000   0.02283  -0.00000   0.00000
  1 C 3pz      0.02602  -0.00192  -0.00000  -0.00000   0.03894
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02081   0.00000  -0.00000
  1 C 3dz^2    0.02662   0.00320   0.00000   0.00000   0.03135
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02081  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s       0.00000   0.00000   0.36324
  0 C 3s      -0.00000   0.00000  -0.04243
  0 C 2px      0.70668   0.00000  -0.00000
  0 C 2py     -0.00000   0.70668  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.60447
  0 C 3px     -0.01294  -0.00000   0.00000
  0 C 3py      0.00000  -0.01294   0.00000
  0 C 3pz     -0.00000   0.00000   0.02137
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02104   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02031
  0 C 3dxz    -0.02104  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000  -0.00000  -0.36324
  1 C 3s       0.00000  -0.00000   0.04243
  1 C 2px     -0.70668   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70668  -0.00000
  1 C 2pz      0.00000   0.00000   0.60447
  1 C 3px      0.01294  -0.00000   0.00000
  1 C 3py      0.00000   0.01294  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02137
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02104   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02031
  1 C 3dxz    -0.02104   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99111461
<CAS-nat-orb|mo-hf>  4  4    0.99735746
<CAS-nat-orb|mo-hf>  5  5    0.99934482
<CAS-nat-orb|mo-hf>  6  6    0.99934482
<CAS-nat-orb|mo-hf>  7  7    0.97351400
<CAS-nat-orb|mo-hf>  8  8    0.97438516
<CAS-nat-orb|mo-hf>  9  9    0.97438519
<CAS-nat-orb|mo-hf>  10  10    0.76990744
<CAS-nat-orb|mo-hf>  10  14   -0.57655943
CASSCF energy = -75.5486452023529
CASCI E = -75.5486452023529  E(CI) = -16.1630327259087  S^2 = 0.0000000
......production of RDMs took       1.94 sec
......reading the RDM took          0.44 sec
......production of RDMs took      36.96 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.81 sec

E(WickICMRREPT2-ijrs) =    -0.00025916631377
E(WickICMRREPT2- rsi) =    -0.00091620324602
E(WickICMRREPT2- ijr) =    -0.00033296835758
E(WickICMRREPT2-  rs) =    -0.04840295089728
E(WickICMRREPT2-  ij) =    -0.00008859912765
E(WickICMRREPT2-  ir) =    -0.00116423483297
E(WickICMRREPT2-   r) =    -0.06361855157062
E(WickICMRREPT2-   i) =    -0.00023247067374
E(WickICMRREPT2) = -75.66366034737253  E_corr_pt = -0.1150151450196182
Timings = pdms =   49.19 | eris =    0.18 | ijrs =    1.41 | rsi =   49.54 | ijr =    0.96 | rs =  703.97 | ij =    1.33 | ir =   24.50 | r =  186.10 | i =    2.37 | total = 1019.63
Time cost =   1072.139
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:24:32 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.613990493306 AA    0.000000000000   0.000000000000   3.050000000000 Bohr   0.0

nuclear repulsion = 11.8032786885246
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.525]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    382583.67


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpuucjg88f
max_memory 4000 MB (current use 404 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9606241516019

WARN: Singularity detected in overlap matrix (condition number =  203). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.154846704479716  LUMO (Ag) = -0.154379304561516

WARN: Ag LUMO -0.154379304561516 < system HOMO -0.154846704479716


WARN: B2u HOMO -0.154846704479716 > system LUMO -0.154379304561516


WARN: B3u HOMO -0.154846704479716 > system LUMO -0.154379304561516

cycle= 1 E= -75.2674224197194  delta_E= -0.307  |g|= 0.242  |ddm|= 1.42
HOMO (B3u) = -0.423431408188683  LUMO (Ag) = -0.147745494594372
cycle= 2 E= -75.2901719236938  delta_E= -0.0227  |g|= 0.0499  |ddm|= 0.326
HOMO (B3u) = -0.385318413495458  LUMO (Ag) = -0.09755294830331
cycle= 3 E= -75.2912021417109  delta_E= -0.00103  |g|= 0.0132  |ddm|= 0.0546
HOMO (B3u) = -0.387177687087386  LUMO (Ag) = -0.0946950408357166
cycle= 4 E= -75.291314408399  delta_E= -0.000112  |g|= 0.00225  |ddm|= 0.0161
HOMO (B2u) = -0.387899311052259  LUMO (Ag) = -0.095294592888328
cycle= 5 E= -75.291318276406  delta_E= -3.87e-06  |g|= 0.000326  |ddm|= 0.00311
HOMO (B3u) = -0.387835444387873  LUMO (Ag) = -0.0952466102829198
cycle= 6 E= -75.2913183380417  delta_E= -6.16e-08  |g|= 4.01e-05  |ddm|= 0.000644
HOMO (B3u) = -0.387827943274181  LUMO (Ag) = -0.095234414042332
cycle= 7 E= -75.2913183390841  delta_E= -1.04e-09  |g|= 5.01e-06  |ddm|= 0.000118
HOMO (B2u) = -0.387827276401265  LUMO (Ag) = -0.0952333329362358
cycle= 8 E= -75.2913183390997  delta_E= -1.56e-11  |g|= 5.51e-07  |ddm|= 1.99e-05
HOMO (B2u) = -0.38782724072484  LUMO (Ag) = -0.0952331169889239
cycle= 9 E= -75.2913183390998  delta_E= -8.53e-14  |g|= 2.29e-08  |ddm|= 1.04e-06
HOMO (B3u) = -0.387827233118366  LUMO (Ag) = -0.0952331317889694
cycle= 10 E= -75.2913183390997  delta_E= 5.68e-14  |g|= 3.63e-09  |ddm|= 8.55e-08
HOMO (B3u) = -0.38782723428266  LUMO (Ag) = -0.0952331330113322
cycle= 11 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 2.64e-09  |ddm|= 4.98e-09
HOMO (B3u) = -0.387827234016246  LUMO (Ag) = -0.095233132665868
cycle= 12 E= -75.2913183390998  delta_E= -9.95e-14  |g|= 2.05e-09  |ddm|= 2.5e-09
HOMO (B3u) = -0.387827234017311  LUMO (Ag) = -0.0952331324925034
cycle= 13 E= -75.2913183390997  delta_E= 9.95e-14  |g|= 1.85e-09  |ddm|= 1.72e-09
HOMO (B3u) = -0.38782723397097  LUMO (Ag) = -0.09523313245707
cycle= 14 E= -75.2913183390997  delta_E= -2.84e-14  |g|= 1.55e-09  |ddm|= 9.88e-10
HOMO (B3u) = -0.38782723394879  LUMO (Ag) = -0.095233132459766
cycle= 15 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 1.35e-09  |ddm|= 1.05e-09
HOMO (B3u) = -0.387827233907061  LUMO (Ag) = -0.0952331324191507
cycle= 16 E= -75.2913183390997  delta_E= 5.68e-14  |g|= 1.21e-09  |ddm|= 4.04e-10
HOMO (B3u) = -0.387827233900513  LUMO (Ag) = -0.0952331324085036
cycle= 17 E= -75.2913183390997  delta_E=    0  |g|= 1.05e-09  |ddm|= 5.32e-10
HOMO (B2u) = -0.387827233741228  LUMO (Ag) = -0.0952331323124177
cycle= 18 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 4.61e-10  |ddm|= 2.57e-09
HOMO (B2u) = -0.387827233740561  LUMO (Ag) = -0.0952331323056516
cycle= 19 E= -75.2913183390997  delta_E= -1.42e-14  |g|= 3.76e-10  |ddm|= 3.58e-10
HOMO (B2u) = -0.387827233758459  LUMO (Ag) = -0.0952331323190513
cycle= 20 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 3.11e-10  |ddm|= 2.33e-10
HOMO (B2u) = -0.387827233770219  LUMO (Ag) = -0.0952331323259923
cycle= 21 E= -75.2913183390998  delta_E= -9.95e-14  |g|= 2.63e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.387827233776464  LUMO (Ag) = -0.0952331323338357
cycle= 22 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 2.14e-10  |ddm|= 1.41e-10
HOMO (B2u) = -0.387827233781417  LUMO (Ag) = -0.0952331323402153
cycle= 23 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 1.74e-10  |ddm|= 1.2e-10
HOMO (B2u) = -0.387827233787547  LUMO (Ag) = -0.0952331323477253
cycle= 24 E= -75.2913183390997  delta_E=    0  |g|= 1.37e-10  |ddm|= 1.15e-10
HOMO (B2u) = -0.387827233792208  LUMO (Ag) = -0.0952331323538979
cycle= 25 E= -75.2913183390998  delta_E= -4.26e-14  |g|= 1.04e-10  |ddm|= 1.07e-10
HOMO (B2u) = -0.387827233796535  LUMO (Ag) = -0.0952331323601213
cycle= 26 E= -75.2913183390998  delta_E= -1.42e-14  |g|= 7.54e-11  |ddm|= 9.84e-11
HOMO (B2u) = -0.387827233795257  LUMO (Ag) = -0.0952331323584976
cycle= 27 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 6.23e-11  |ddm|= 3.22e-11
HOMO (B2u) = -0.387827233793631  LUMO (Ag) = -0.09523313235675
cycle= 28 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 5.13e-11  |ddm|= 2.43e-11
HOMO (B3u) = -0.387827233792375  LUMO (Ag) = -0.0952331323556185
cycle= 29 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 4.18e-11  |ddm|= 1.96e-11
HOMO (B2u) = -0.387827233791343  LUMO (Ag) = -0.0952331323549515
cycle= 30 E= -75.2913183390998  delta_E= -1.42e-14  |g|= 3.35e-11  |ddm|= 1.63e-11
HOMO (B2u) = -0.387827233790614  LUMO (Ag) = -0.0952331323545433
cycle= 31 E= -75.2913183390998  delta_E= -4.26e-14  |g|= 2.66e-11  |ddm|= 1.34e-11
HOMO (B2u) = -0.387827233790129  LUMO (Ag) = -0.0952331323543431
cycle= 32 E= -75.2913183390998  delta_E= 1.42e-14  |g|= 2.1e-11  |ddm|= 1.1e-11
HOMO (B2u) = -0.387827233789836  LUMO (Ag) = -0.0952331323542656
cycle= 33 E= -75.2913183390998  delta_E= -4.26e-14  |g|= 1.66e-11  |ddm|= 8.36e-12
HOMO (B3u) = -0.387827233789693  LUMO (Ag) = -0.0952331323542633
cycle= 34 E= -75.2913183390998  delta_E= 7.11e-14  |g|= 1.32e-11  |ddm|= 5.92e-12
HOMO (B3u) = -0.387827233789681  LUMO (Ag) = -0.0952331323542955
cycle= 35 E= -75.2913183390998  delta_E= -4.26e-14  |g|= 1.09e-11  |ddm|= 3.81e-12
HOMO (B3u) = -0.387827233789643  LUMO (Ag) = -0.0952331323543226
cycle= 36 E= -75.2913183390998  delta_E=    0  |g|= 8.88e-12  |ddm|= 3.1e-12
HOMO (B2u) = -0.387827233789307  LUMO (Ag) = -0.0952331323542836
Extra cycle  E= -75.2913183390998  delta_E= 2.84e-14  |g|= 3.08e-12  |ddm|= 8.44e-12
converged SCF energy = -75.2913183390998

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpuucjg88f
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4857258490082  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.506467635752  dE = -0.020741787  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.68  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5184322415254  dE = -0.011964606  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0656  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5265434925132  dE = -0.008111251  S^2 = 0.0000000
               |grad[o]|=0.0908  |ddm|=0.0339  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5322928409508  dE = -0.0057493484  S^2 = 0.0000000
               |grad[o]|=0.0705  |ddm|=0.0223  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.53626574765  dE = -0.0039729067  S^2 = 0.0000000
               |grad[o]|=0.0523  |ddm|=0.0155  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5387478318613  dE = -0.0024820842  S^2 = 0.0000000
               |grad[o]|=0.0357  |ddm|=0.0116  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5399094906495  dE = -0.0011616588  S^2 = 0.0000000
               |grad[o]|=0.0201  |ddm|=0.0105  |maxRot[o]|=0.0799
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5400388138307  dE = -0.00012932318  S^2 = 0.0000000
               |grad[o]|=0.00582  |ddm|=0.0121  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5400404965116  dE = -1.6826808e-06  S^2 = 0.0000000
               |grad[o]|=0.000811  |ddm|=0.00672  |maxRot[o]|=0.00294
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5400405390613  dE = -4.2549743e-08  S^2 = 0.0000000
               |grad[o]|=0.000142  |ddm|=0.00102  |maxRot[o]|=0.000305
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5400405400836  dE = -1.022272e-09  S^2 = 0.0000000
               |grad[o]|=2.6e-05  |ddm|=0.000166  |maxRot[o]|=3.43e-05
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5400405401293  dE = -4.5702109e-11  S^2 = 0.0000000
               |grad[o]|=4.9e-06  |ddm|=3.05e-05  |maxRot[o]|=5.56e-06
macro iter 13 (14 JK  0 micro), CASSCF E = -75.5400405401292  dE = 1.1368684e-13  S^2 = 0.0000000
               |grad[o]|=1.1e-06  |ddm|=6.57e-06  |maxRot[o]|=6.87e-07
2-step CASSCF converged in 13 macro (72 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97266773 1.73807335 1.76672097 1.76672195 0.28541652 0.22250992
 0.22251043 0.02537913]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00752   0.00393   0.00000   0.00000  -0.00075
  0 C 2s       0.63584   0.61195  -0.00000  -0.00000  -0.30764
  0 C 3s      -0.02245   0.00972   0.00000   0.00000   0.02272
  0 C 2px     -0.00000   0.00000  -0.00000   0.70640   0.00000
  0 C 2py     -0.00000   0.00000   0.70640  -0.00000   0.00000
  0 C 2pz      0.30639  -0.35411   0.00000   0.00000   0.63428
  0 C 3px     -0.00000  -0.00000  -0.00000   0.02449   0.00000
  0 C 3py     -0.00000   0.00000   0.02449  -0.00000   0.00000
  0 C 3pz     -0.02442  -0.00191   0.00000   0.00000  -0.03747
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.01996  -0.00000   0.00000
  0 C 3dz^2    0.02599  -0.00343   0.00000   0.00000   0.03354
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.01996   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00752  -0.00393   0.00000   0.00000  -0.00075
  1 C 2s       0.63584  -0.61195  -0.00000  -0.00000  -0.30764
  1 C 3s      -0.02245  -0.00972  -0.00000  -0.00000   0.02272
  1 C 2px     -0.00000   0.00000   0.00000   0.70640  -0.00000
  1 C 2py      0.00000  -0.00000   0.70640   0.00000   0.00000
  1 C 2pz     -0.30639  -0.35411  -0.00000   0.00000  -0.63428
  1 C 3px      0.00000  -0.00000   0.00000   0.02449  -0.00000
  1 C 3py      0.00000  -0.00000   0.02449   0.00000  -0.00000
  1 C 3pz      0.02442  -0.00191   0.00000   0.00000   0.03747
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.01996  -0.00000   0.00000
  1 C 3dz^2    0.02599   0.00343  -0.00000  -0.00000   0.03354
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.01996   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.35370
  0 C 3s       0.00000   0.00000  -0.04177
  0 C 2px      0.70670  -0.00000   0.00000
  0 C 2py     -0.00000   0.70670  -0.00000
  0 C 2pz      0.00000  -0.00000   0.61017
  0 C 3px     -0.01201   0.00000   0.00000
  0 C 3py      0.00000  -0.01201  -0.00000
  0 C 3pz      0.00000   0.00000   0.02109
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02067  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01998
  0 C 3dxz    -0.02067   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s      -0.00000  -0.00000  -0.35370
  1 C 3s      -0.00000  -0.00000   0.04177
  1 C 2px     -0.70670  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70670   0.00000
  1 C 2pz      0.00000  -0.00000   0.61017
  1 C 3px      0.01201   0.00000  -0.00000
  1 C 3py      0.00000   0.01201   0.00000
  1 C 3pz      0.00000   0.00000   0.02109
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02067  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.01998
  1 C 3dxz    -0.02067  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99096823
<CAS-nat-orb|mo-hf>  4  4    0.99730112
<CAS-nat-orb|mo-hf>  5  5    0.99929408
<CAS-nat-orb|mo-hf>  6  6    0.99929409
<CAS-nat-orb|mo-hf>  7  7    0.97345963
<CAS-nat-orb|mo-hf>  8  8    0.97595052
<CAS-nat-orb|mo-hf>  9  9    0.97595056
<CAS-nat-orb|mo-hf>  10  10    0.79085139
<CAS-nat-orb|mo-hf>  10  14   -0.55412065
CASSCF energy = -75.5400405401292
CASCI E = -75.5400405401292  E(CI) = -16.0670213812339  S^2 = 0.0000000
......production of RDMs took       2.00 sec
......reading the RDM took          0.41 sec
......production of RDMs took      24.57 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.79 sec

E(WickICMRREPT2-ijrs) =    -0.00025903580696
E(WickICMRREPT2- rsi) =    -0.00091199120772
E(WickICMRREPT2- ijr) =    -0.00032730626911
E(WickICMRREPT2-  rs) =    -0.04801279381405
E(WickICMRREPT2-  ij) =    -0.00008448857704
E(WickICMRREPT2-  ir) =    -0.00115277283128
E(WickICMRREPT2-   r) =    -0.06468196964642
E(WickICMRREPT2-   i) =    -0.00022621941546
E(WickICMRREPT2) = -75.65569711769719  E_corr_pt = -0.1156565775680262
Timings = pdms =   36.81 | eris =    0.18 | ijrs =    1.29 | rsi =   41.90 | ijr =    0.53 | rs =  642.00 | ij =    1.37 | ir =   23.59 | r =  159.74 | i =    2.68 | total =  910.15
Time cost =   1044.422
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:41:56 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.640449353852 AA    0.000000000000   0.000000000000   3.100000000000 Bohr   0.0

nuclear repulsion = 11.6129032258065
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.55]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    397269.29


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpovc0bndl
max_memory 4000 MB (current use 406 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9340105731017

WARN: Singularity detected in overlap matrix (condition number =  188). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.14969326640479  LUMO (B3u) = -0.14969326640479

WARN: B2u HOMO -0.14969326640479 > system LUMO -0.14969326640479

cycle= 1 E= -75.3573845713053  delta_E= -0.423  |g|= 0.265  |ddm|= 1.55
HOMO (B2u) = -0.413310367291844  LUMO (B3u) = -0.0846696262312542
cycle= 2 E= -75.3843760014416  delta_E= -0.027  |g|= 0.0539  |ddm|= 0.354
HOMO (B2u) = -0.373182146511253  LUMO (B3u) = -0.0395668514335574
cycle= 3 E= -75.3858456567449  delta_E= -0.00147  |g|= 0.018  |ddm|= 0.0717
HOMO (B2u) = -0.377721327859484  LUMO (B3u) = -0.044084167931055
cycle= 4 E= -75.3860530258635  delta_E= -0.000207  |g|= 0.000721  |ddm|= 0.0382
HOMO (B2u) = -0.377699771169468  LUMO (B3u) = -0.044200843227667
cycle= 5 E= -75.3860532373451  delta_E= -2.11e-07  |g|= 8.07e-05  |ddm|= 0.00144
HOMO (B2u) = -0.377674560909566  LUMO (B3u) = -0.0441740446286808
cycle= 6 E= -75.3860532409994  delta_E= -3.65e-09  |g|= 1.32e-05  |ddm|= 0.000134
HOMO (B2u) = -0.377672848926074  LUMO (B3u) = -0.0441758015090405
cycle= 7 E= -75.3860532411127  delta_E= -1.13e-10  |g|= 1.86e-06  |ddm|= 3.43e-05
HOMO (B2u) = -0.377672100443092  LUMO (B3u) = -0.0441752784119687
cycle= 8 E= -75.3860532411148  delta_E= -2.13e-12  |g|= 1.02e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.377672134542448  LUMO (B3u) = -0.0441753126346239
cycle= 9 E= -75.3860532411149  delta_E= -1.14e-13  |g|= 9.15e-09  |ddm|= 2.08e-07
HOMO (B2u) = -0.377672135434478  LUMO (B3u) = -0.044175315095156
cycle= 10 E= -75.3860532411148  delta_E= 8.53e-14  |g|= 5.27e-09  |ddm|= 8.77e-09
HOMO (B2u) = -0.377672135491377  LUMO (B3u) = -0.0441753151311669
cycle= 11 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 4.98e-09  |ddm|= 4.3e-09
HOMO (B2u) = -0.377672134119727  LUMO (B3u) = -0.0441753136889315
cycle= 12 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 4.6e-09  |ddm|= 2.32e-09
HOMO (B2u) = -0.377672133903676  LUMO (B3u) = -0.0441753133840714
cycle= 13 E= -75.3860532411148  delta_E= 2.84e-14  |g|= 8.94e-10  |ddm|= 7.69e-09
HOMO (B2u) = -0.377672133973412  LUMO (B3u) = -0.0441753134345918
cycle= 14 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 7.9e-10  |ddm|= 4.35e-10
HOMO (B2u) = -0.377672134141427  LUMO (B3u) = -0.0441753135503463
cycle= 15 E= -75.3860532411149  delta_E=    0  |g|= 6.66e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.377672134091599  LUMO (B3u) = -0.0441753135957334
cycle= 16 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 7.8e-10  |ddm|= 1.27e-09
HOMO (B2u) = -0.377672134148707  LUMO (B3u) = -0.0441753136135781
cycle= 17 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 8.38e-10  |ddm|= 7.46e-10
HOMO (B2u) = -0.377672134162161  LUMO (B3u) = -0.0441753136099875
cycle= 18 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 5.7e-10  |ddm|= 5.55e-10
HOMO (B2u) = -0.377672134187488  LUMO (B3u) = -0.0441753136341297
cycle= 19 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 4.43e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.377672134218897  LUMO (B3u) = -0.044175313663043
cycle= 20 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 3.13e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.377672134234258  LUMO (B3u) = -0.0441753136727124
cycle= 21 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 1.86e-10  |ddm|= 2.77e-10
HOMO (B2u) = -0.37767213423428  LUMO (B3u) = -0.044175313670412
cycle= 22 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 1.61e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.377672134234111  LUMO (B3u) = -0.044175313668732
cycle= 23 E= -75.386053241115  delta_E= -9.95e-14  |g|= 1.43e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.377672134231426  LUMO (B3u) = -0.0441753136670063
cycle= 24 E= -75.3860532411149  delta_E= 1.14e-13  |g|= 1.29e-10  |ddm|= 5.92e-11
HOMO (B2u) = -0.377672134234392  LUMO (B3u) = -0.0441753136670456
cycle= 25 E= -75.3860532411148  delta_E= 2.84e-14  |g|= 1.06e-10  |ddm|= 6.7e-11
HOMO (B2u) = -0.377672134236845  LUMO (B3u) = -0.0441753136680682
cycle= 26 E= -75.3860532411148  delta_E= 4.26e-14  |g|= 7.84e-11  |ddm|= 6.23e-11
HOMO (B2u) = -0.377672134238142  LUMO (B3u) = -0.0441753136685428
cycle= 27 E= -75.3860532411149  delta_E= -1.56e-13  |g|= 6.03e-11  |ddm|= 4.29e-11
HOMO (B2u) = -0.377672134239266  LUMO (B3u) = -0.0441753136689003
cycle= 28 E= -75.3860532411149  delta_E= 5.68e-14  |g|= 4.57e-11  |ddm|= 3.43e-11
HOMO (B2u) = -0.377672134240333  LUMO (B3u) = -0.0441753136693646
cycle= 29 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 3.54e-11  |ddm|= 2.51e-11
HOMO (B2u) = -0.377672134241047  LUMO (B3u) = -0.0441753136697344
cycle= 30 E= -75.3860532411149  delta_E= -2.84e-14  |g|= 2.98e-11  |ddm|= 1.54e-11
HOMO (B2u) = -0.377672134241605  LUMO (B3u) = -0.044175313670012
cycle= 31 E= -75.3860532411148  delta_E= 1.14e-13  |g|= 2.48e-11  |ddm|= 1.35e-11
HOMO (B2u) = -0.377672134242049  LUMO (B3u) = -0.0441753136702106
cycle= 32 E= -75.3860532411149  delta_E= -8.53e-14  |g|= 2.02e-11  |ddm|= 1.19e-11
HOMO (B2u) = -0.377672134242535  LUMO (B3u) = -0.0441753136703888
cycle= 33 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 1.59e-11  |ddm|= 1.08e-11
HOMO (B2u) = -0.377672134242881  LUMO (B3u) = -0.044175313670532
cycle= 34 E= -75.3860532411149  delta_E= 4.26e-14  |g|= 1.24e-11  |ddm|= 8.64e-12
HOMO (B2u) = -0.377672134243135  LUMO (B3u) = -0.0441753136706356
cycle= 35 E= -75.3860532411149  delta_E= -8.53e-14  |g|= 9.77e-12  |ddm|= 6.46e-12
HOMO (B2u) = -0.37767213424333  LUMO (B3u) = -0.044175313670707
cycle= 36 E= -75.3860532411149  delta_E= 5.68e-14  |g|= 7.76e-12  |ddm|= 5.03e-12
HOMO (B2u) = -0.377672134243479  LUMO (B3u) = -0.0441753136707589
cycle= 37 E= -75.3860532411148  delta_E= 4.26e-14  |g|= 6.25e-12  |ddm|= 3.83e-12
HOMO (B2u) = -0.377672134243594  LUMO (B3u) = -0.0441753136708002
cycle= 38 E= -75.3860532411149  delta_E= -7.11e-14  |g|= 5.1e-12  |ddm|= 2.96e-12
HOMO (B2u) = -0.377672134243691  LUMO (B3u) = -0.0441753136708343
cycle= 39 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 4.12e-12  |ddm|= 2.5e-12
HOMO (B2u) = -0.377672134243774  LUMO (B3u) = -0.0441753136708633
cycle= 40 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 3.29e-12  |ddm|= 2.08e-12
HOMO (B2u) = -0.377672134243844  LUMO (B3u) = -0.0441753136708873
cycle= 41 E= -75.386053241115  delta_E= -8.53e-14  |g|= 2.61e-12  |ddm|= 1.7e-12
HOMO (B2u) = -0.377672134243897  LUMO (B3u) = -0.0441753136709061
cycle= 42 E= -75.3860532411149  delta_E= 7.11e-14  |g|= 2.08e-12  |ddm|= 1.33e-12
HOMO (B2u) = -0.377672134243939  LUMO (B3u) = -0.0441753136709208
cycle= 43 E= -75.3860532411149  delta_E= -2.84e-14  |g|= 1.67e-12  |ddm|= 1.02e-12
HOMO (B2u) = -0.377672134243973  LUMO (B3u) = -0.0441753136709329
cycle= 44 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 1.34e-12  |ddm|= 8.12e-13
HOMO (B2u) = -0.377672134244001  LUMO (B3u) = -0.0441753136709424
cycle= 45 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 1.08e-12  |ddm|= 6.49e-13
HOMO (B2u) = -0.377672134244023  LUMO (B3u) = -0.0441753136709497
cycle= 46 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 8.72e-13  |ddm|= 5.28e-13
HOMO (B2u) = -0.37767213424404  LUMO (B3u) = -0.0441753136709557
cycle= 47 E= -75.3860532411149  delta_E= -2.84e-14  |g|= 7e-13  |ddm|= 4.22e-13
HOMO (B2u) = -0.377672134244055  LUMO (B3u) = -0.0441753136709602
cycle= 48 E= -75.3860532411149  delta_E= 4.26e-14  |g|= 5.64e-13  |ddm|= 3.39e-13
HOMO (B2u) = -0.377672134244067  LUMO (B3u) = -0.0441753136709637
cycle= 49 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 4.51e-13  |ddm|= 2.75e-13
HOMO (B2u) = -0.377672134244076  LUMO (B3u) = -0.0441753136709668
cycle= 50 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 3.64e-13  |ddm|= 2.22e-13
SCF not converged.
SCF energy = -75.3860532411149

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpovc0bndl
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4764159496085  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4872396096411  dE = -0.01082366  S^2 = 0.0000000
               |grad[o]|=0.0774  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4972270887874  dE = -0.0099874791  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0605  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5063987161824  dE = -0.0091716274  S^2 = 0.0000000
               |grad[o]|=0.0682  |ddm|=0.0991  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5143818192346  dE = -0.0079831031  S^2 = 0.0000000
               |grad[o]|=0.0667  |ddm|=0.194  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5204922499764  dE = -0.0061104307  S^2 = 0.0000000
               |grad[o]|=0.0614  |ddm|=0.222  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5243786184112  dE = -0.0038863684  S^2 = 0.0000000
               |grad[o]|=0.048  |ddm|=0.157  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.525753421204  dE = -0.0013748028  S^2 = 0.0000000
               |grad[o]|=0.0286  |ddm|=  0.1  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5259733307063  dE = -0.0002199095  S^2 = 0.0000000
               |grad[o]|=0.0122  |ddm|=0.0931  |maxRot[o]|=0.0188
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5262794790377  dE = -0.00030614833  S^2 = 0.0000000
               |grad[o]|=0.0118  |ddm|=0.171  |maxRot[o]|=0.00855
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5272581189024  dE = -0.00097863986  S^2 = 0.0000000
               |grad[o]|=0.022  |ddm|=0.309  |maxRot[o]|=0.019
macro iter 11 (4 JK  0 micro), CASSCF E = -75.5294134821606  dE = -0.0021553633  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.465  |maxRot[o]|=0.0329
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5311332612887  dE = -0.0017197791  S^2 = 0.0000000
               |grad[o]|=0.0308  |ddm|=0.348  |maxRot[o]|= 0.04
macro iter 13 (3 JK  0 micro), CASSCF E = -75.531466739905  dE = -0.00033347862  S^2 = 0.0000000
               |grad[o]|=0.0126  |ddm|=0.107  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5315144591186  dE = -4.7719214e-05  S^2 = 0.0000000
               |grad[o]|=0.00437  |ddm|=0.0224  |maxRot[o]|=0.00856
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5315175887209  dE = -3.1296023e-06  S^2 = 0.0000000
               |grad[o]|=0.00109  |ddm|=0.00794  |maxRot[o]|=0.00211
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5315177947158  dE = -2.0599494e-07  S^2 = 0.0000000
               |grad[o]|=0.000288  |ddm|=0.00204  |maxRot[o]|=0.000518
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5315178084868  dE = -1.3770972e-08  S^2 = 0.0000000
               |grad[o]|=7.68e-05  |ddm|=0.000533  |maxRot[o]|=0.000129
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5315178094244  dE = -9.376464e-10  S^2 = 0.0000000
               |grad[o]|=2.05e-05  |ddm|=0.00014  |maxRot[o]|=3.33e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.5315178094871  dE = -6.2627237e-11  S^2 = 0.0000000
               |grad[o]|=5.47e-06  |ddm|=3.78e-05  |maxRot[o]|=8.79e-06
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5315178094907  dE = -3.623768e-12  S^2 = 0.0000000
               |grad[o]|=1.41e-06  |ddm|=9.82e-06  |maxRot[o]|=2.34e-06
2-step CASSCF converged in 20 macro (80 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97199268 1.74648642 0.28354296 1.75359769 1.75359611 0.2322697
 0.23226976 0.02624468]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00771   0.00402  -0.00073   0.00000   0.00000
  0 C 2s       0.63877   0.61742  -0.30165   0.00000   0.00000
  0 C 3s      -0.02059   0.00990   0.02411   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.70637
  0 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  0 C 2pz      0.30053  -0.34447   0.63708  -0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000   0.02607
  0 C 3py      0.00000  -0.00000   0.00000   0.02607  -0.00000
  0 C 3pz     -0.02284  -0.00193  -0.03571   0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000   0.01911  -0.00000
  0 C 3dz^2    0.02539  -0.00363   0.03576   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000   0.01911
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00771  -0.00402  -0.00073   0.00000   0.00000
  1 C 2s       0.63877  -0.61742  -0.30165  -0.00000  -0.00000
  1 C 3s      -0.02059  -0.00990   0.02411  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000   0.00000   0.70637
  1 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  1 C 2pz     -0.30053  -0.34447  -0.63708  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000   0.02607
  1 C 3py      0.00000  -0.00000  -0.00000   0.02607  -0.00000
  1 C 3pz      0.02284  -0.00193   0.03571   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01911   0.00000
  1 C 3dz^2    0.02539   0.00363   0.03576  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000  -0.01911
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s       0.00000   0.00000   0.34413
  0 C 3s       0.00000   0.00000  -0.04088
  0 C 2px      0.00000   0.70673   0.00000
  0 C 2py      0.70673   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.61571
  0 C 3px      0.00000  -0.01104   0.00000
  0 C 3py     -0.01104   0.00000   0.00000
  0 C 3pz      0.00000   0.00000   0.02055
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.02028   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01955
  0 C 3dxz     0.00000  -0.02028   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.34413
  1 C 3s      -0.00000  -0.00000   0.04088
  1 C 2px     -0.00000  -0.70673  -0.00000
  1 C 2py     -0.70673  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.61571
  1 C 3px     -0.00000   0.01104  -0.00000
  1 C 3py      0.01104  -0.00000  -0.00000
  1 C 3pz      0.00000   0.00000   0.02055
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.02028   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.01955
  1 C 3dxz     0.00000  -0.02028   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99970732
<CAS-nat-orb|mo-hf>  4  4    0.99969115
<CAS-nat-orb|mo-hf>  5  5    0.99206275
<CAS-nat-orb|mo-hf>  6  6    0.99749856
<CAS-nat-orb|mo-hf>  7  7    0.98939317
<CAS-nat-orb|mo-hf>  8  8    0.97289816
<CAS-nat-orb|mo-hf>  9  9    0.95779871
<CAS-nat-orb|mo-hf>  10  10    0.87337001
<CAS-nat-orb|mo-hf>  10  12   -0.42886300
CASSCF energy = -75.5315178094907
CASCI E = -75.5315178094907  E(CI) = -15.9739146588992  S^2 = 0.0000000
......production of RDMs took       3.35 sec
......reading the RDM took          0.43 sec
......production of RDMs took      23.49 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickICMRREPT2-ijrs) =    -0.00025927000487
E(WickICMRREPT2- rsi) =    -0.00090880010240
E(WickICMRREPT2- ijr) =    -0.00032181897915
E(WickICMRREPT2-  rs) =    -0.04765275485269
E(WickICMRREPT2-  ij) =    -0.00008056615623
E(WickICMRREPT2-  ir) =    -0.00114207326005
E(WickICMRREPT2-   r) =    -0.06576420839012
E(WickICMRREPT2-   i) =    -0.00021992800869
E(WickICMRREPT2) = -75.64786722924487  E_corr_pt = -0.1163494197541899
Timings = pdms =   37.02 | eris =    0.06 | ijrs =    1.18 | rsi =   33.96 | ijr =    0.43 | rs =  603.51 | ij =    1.23 | ir =   24.70 | r =  167.73 | i =    2.82 | total =  872.70
Time cost =    966.611
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:58:03 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.666908214398 AA    0.000000000000   0.000000000000   3.150000000000 Bohr   0.0

nuclear repulsion = 11.4285714285714
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.575]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    411233.24


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpopd601pb
max_memory 4000 MB (current use 404 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9089301361996

WARN: Singularity detected in overlap matrix (condition number =  175). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.144793107119776  LUMO (B3u) = -0.144793107119776

WARN: B2u HOMO -0.144793107119776 > system LUMO -0.144793107119776

cycle= 1 E= -75.3499635205346  delta_E= -0.441  |g|= 0.262  |ddm|= 1.54
HOMO (B2u) = -0.407994029365033  LUMO (B3u) = -0.0815659278261151
cycle= 2 E= -75.3765746590879  delta_E= -0.0266  |g|= 0.0534  |ddm|= 0.353
HOMO (B2u) = -0.368435737958923  LUMO (B3u) = -0.0370562210896314
cycle= 3 E= -75.3780458200465  delta_E= -0.00147  |g|= 0.0181  |ddm|= 0.0711
HOMO (B2u) = -0.372975542135577  LUMO (B3u) = -0.041556201776843
cycle= 4 E= -75.3782577251018  delta_E= -0.000212  |g|= 0.000712  |ddm|= 0.0382
HOMO (B2u) = -0.372986320268992  LUMO (B3u) = -0.041707540910272
cycle= 5 E= -75.3782579293203  delta_E= -2.04e-07  |g|= 8.31e-05  |ddm|= 0.00134
HOMO (B2u) = -0.372958407634994  LUMO (B3u) = -0.041678267615037
cycle= 6 E= -75.3782579331955  delta_E= -3.88e-09  |g|= 1.36e-05  |ddm|= 0.000138
HOMO (B2u) = -0.372956778075027  LUMO (B3u) = -0.0416799724229875
cycle= 7 E= -75.3782579333153  delta_E= -1.2e-10  |g|= 1.9e-06  |ddm|= 3.4e-05
HOMO (B2u) = -0.372956024408939  LUMO (B3u) = -0.0416794932470641
cycle= 8 E= -75.3782579333176  delta_E= -2.3e-12  |g|= 1.05e-07  |ddm|= 4.17e-06
HOMO (B2u) = -0.372956052025203  LUMO (B3u) = -0.0416795190618736
cycle= 9 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 8.21e-09  |ddm|= 2.09e-07
HOMO (B2u) = -0.372956052953062  LUMO (B3u) = -0.041679521564667
cycle= 10 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 4.9e-09  |ddm|= 8.05e-09
HOMO (B2u) = -0.372956052901335  LUMO (B3u) = -0.0416795214865621
cycle= 11 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 4.53e-09  |ddm|= 4.17e-09
HOMO (B2u) = -0.372956051583787  LUMO (B3u) = -0.0416795201007451
cycle= 12 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 4.18e-09  |ddm|= 2.1e-09
HOMO (B2u) = -0.372956051455586  LUMO (B3u) = -0.0416795199045227
cycle= 13 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 7.45e-10  |ddm|= 6.42e-09
HOMO (B2u) = -0.372956051505568  LUMO (B3u) = -0.0416795199393702
cycle= 14 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 6.37e-10  |ddm|= 3.44e-10
HOMO (B2u) = -0.37295605168224  LUMO (B3u) = -0.0416795200611437
cycle= 15 E= -75.3782579333176  delta_E= 5.68e-14  |g|= 5.65e-10  |ddm|= 1.2e-09
HOMO (B2u) = -0.372956051619939  LUMO (B3u) = -0.0416795200925476
cycle= 16 E= -75.3782579333176  delta_E= -2.84e-14  |g|= 6.97e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.372956051666042  LUMO (B3u) = -0.0416795200994568
cycle= 17 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 7.14e-10  |ddm|= 6.65e-10
HOMO (B2u) = -0.372956051672808  LUMO (B3u) = -0.0416795200906272
cycle= 18 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 4.81e-10  |ddm|= 4.43e-10
HOMO (B2u) = -0.372956051694875  LUMO (B3u) = -0.0416795201120202
cycle= 19 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 3.77e-10  |ddm|= 2.62e-10
HOMO (B2u) = -0.372956051721223  LUMO (B3u) = -0.0416795201364629
cycle= 20 E= -75.3782579333177  delta_E= 4.26e-14  |g|= 2.65e-10  |ddm|= 2.01e-10
HOMO (B2u) = -0.372956051732293  LUMO (B3u) = -0.041679520142606
cycle= 21 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 1.52e-10  |ddm|= 2.27e-10
HOMO (B2u) = -0.372956051732458  LUMO (B3u) = -0.0416795201406791
cycle= 22 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 1.33e-10  |ddm|= 6e-11
HOMO (B2u) = -0.372956051732325  LUMO (B3u) = -0.0416795201390872
cycle= 23 E= -75.3782579333177  delta_E= -7.11e-14  |g|= 1.2e-10  |ddm|= 5.32e-11
HOMO (B2u) = -0.372956051729604  LUMO (B3u) = -0.0416795201375008
cycle= 24 E= -75.3782579333176  delta_E= 8.53e-14  |g|= 1.1e-10  |ddm|= 5.12e-11
HOMO (B2u) = -0.372956051732417  LUMO (B3u) = -0.0416795201375893
cycle= 25 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 8.81e-11  |ddm|= 5.79e-11
HOMO (B2u) = -0.372956051734319  LUMO (B3u) = -0.0416795201382429
cycle= 26 E= -75.3782579333176  delta_E= 5.68e-14  |g|= 6.55e-11  |ddm|= 4.83e-11
HOMO (B2u) = -0.372956051735261  LUMO (B3u) = -0.0416795201384833
cycle= 27 E= -75.3782579333177  delta_E= -8.53e-14  |g|= 5.08e-11  |ddm|= 3.26e-11
HOMO (B2u) = -0.372956051736096  LUMO (B3u) = -0.0416795201386583
cycle= 28 E= -75.3782579333176  delta_E= 5.68e-14  |g|= 3.85e-11  |ddm|= 2.72e-11
HOMO (B2u) = -0.372956051736936  LUMO (B3u) = -0.0416795201389721
cycle= 29 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 2.98e-11  |ddm|= 2.01e-11
HOMO (B2u) = -0.372956051737503  LUMO (B3u) = -0.0416795201392329
cycle= 30 E= -75.3782579333177  delta_E=    0  |g|= 2.52e-11  |ddm|= 1.22e-11
HOMO (B2u) = -0.372956051739137  LUMO (B3u) = -0.0416795201398101
Extra cycle  E= -75.3782579333177  delta_E= -5.68e-14  |g|= 8.26e-12  |ddm|= 4.15e-11
converged SCF energy = -75.3782579333177

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpopd601pb
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.472593489591  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4837385432461  dE = -0.011145054  S^2 = 0.0000000
               |grad[o]|=0.0791  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4938627006704  dE = -0.010124157  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0567  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5028935336977  dE = -0.009030833  S^2 = 0.0000000
               |grad[o]|=0.0659  |ddm|=0.0667  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5105630063509  dE = -0.0076694727  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5162482933863  dE = -0.005685287  S^2 = 0.0000000
               |grad[o]|=0.051  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5197013968071  dE = -0.0034531034  S^2 = 0.0000000
               |grad[o]|=0.0355  |ddm|=0.0366  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.5210733309512  dE = -0.0013719341  S^2 = 0.0000000
               |grad[o]|=0.0178  |ddm|=0.0634  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5215988184346  dE = -0.00052548748  S^2 = 0.0000000
               |grad[o]|=0.0113  |ddm|=0.115  |maxRot[o]|= 0.02
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5222374490426  dE = -0.00063863061  S^2 = 0.0000000
               |grad[o]|=0.0104  |ddm|=0.0771  |maxRot[o]|=0.033
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5226563533843  dE = -0.00041890434  S^2 = 0.0000000
               |grad[o]|=0.00749  |ddm|=0.064  |maxRot[o]|=0.0335
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5227995203844  dE = -0.000143167  S^2 = 0.0000000
               |grad[o]|=0.00438  |ddm|=0.0306  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5228528705788  dE = -5.3350194e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.0113  |maxRot[o]|=0.0144
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5228636275608  dE = -1.0756982e-05  S^2 = 0.0000000
               |grad[o]|=0.00112  |ddm|=0.00642  |maxRot[o]|=0.00668
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5228655523388  dE = -1.924778e-06  S^2 = 0.0000000
               |grad[o]|=0.000479  |ddm|=0.00263  |maxRot[o]|=0.00287
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5228658806957  dE = -3.283569e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.00108  |maxRot[o]|=0.00119
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5228659357624  dE = -5.506665e-08  S^2 = 0.0000000
               |grad[o]|=8.2e-05  |ddm|=0.000438  |maxRot[o]|=0.000488
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5228659449375  dE = -9.1750962e-09  S^2 = 0.0000000
               |grad[o]|=3.35e-05  |ddm|=0.000178  |maxRot[o]|=0.000199
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5228659464735  dE = -1.5360513e-09  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.23e-05  |maxRot[o]|=8.09e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.5228659467353  dE = -2.6177815e-10  S^2 = 0.0000000
               |grad[o]|=5.53e-06  |ddm|=2.94e-05  |maxRot[o]|=3.29e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5228659467819  dE = -4.6583182e-11  S^2 = 0.0000000
               |grad[o]|=2.25e-06  |ddm|=1.19e-05  |maxRot[o]|=1.33e-05
2-step CASSCF converged in 20 macro (77 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96757995 1.92636359 1.90257312 1.85304912 0.08669295 0.15330618
 0.05997838 0.05045671]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00942   0.00931  -0.00604   0.00000   0.00000
  0 C 2s       0.58733   0.63316  -0.39276   0.00000  -0.00000
  0 C 3s      -0.02996   0.01840  -0.05304   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69586
  0 C 2py      0.00000   0.00000   0.00000   0.70455   0.00000
  0 C 2pz      0.38981  -0.31366   0.58451   0.00000  -0.00000
  0 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05174
  0 C 3py      0.00000  -0.00000   0.00000   0.04283  -0.00000
  0 C 3pz     -0.02787  -0.00316  -0.00116   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.04212  -0.00000
  0 C 3dz^2    0.03630  -0.01553   0.03447   0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000  -0.11447
 0 C 3dx2-y2  -0.00196   0.00750  -0.00750   0.00000  -0.00000
  1 C 1s       0.00942  -0.00931  -0.00604   0.00000   0.00000
  1 C 2s       0.58733  -0.63316  -0.39276  -0.00000  -0.00000
  1 C 3s      -0.02996  -0.01840  -0.05304  -0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69586
  1 C 2py     -0.00000   0.00000  -0.00000   0.70455   0.00000
  1 C 2pz     -0.38981  -0.31366  -0.58451  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000   0.00000  -0.05174
  1 C 3py     -0.00000  -0.00000  -0.00000   0.04283  -0.00000
  1 C 3pz      0.02787  -0.00316   0.00116   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.04212   0.00000
  1 C 3dz^2    0.03630   0.01553   0.03447  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000   0.11447
 1 C 3dx2-y2  -0.00196  -0.00750  -0.00750   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s       0.00000  -0.00000   0.31126
  0 C 3s       0.00000   0.00000   0.04123
  0 C 2px     -0.00000   0.69686   0.00000
  0 C 2py      0.70644  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.62985
  0 C 3px     -0.00000   0.00767   0.00000
  0 C 3py     -0.02723  -0.00000   0.00000
  0 C 3pz      0.00000   0.00000  -0.05999
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.01434   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000   0.01543
  0 C 3dxz    -0.00000  -0.11967   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02938
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s      -0.00000  -0.00000  -0.31126
  1 C 3s      -0.00000  -0.00000  -0.04123
  1 C 2px     -0.00000  -0.69686  -0.00000
  1 C 2py     -0.70644   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.62985
  1 C 3px      0.00000  -0.00767  -0.00000
  1 C 3py      0.02723   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.05999
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01434  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.01543
  1 C 3dxz    -0.00000  -0.11967   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02938
<CAS-nat-orb|mo-hf>  3  3    0.98488177
<CAS-nat-orb|mo-hf>  4  4    0.99976478
<CAS-nat-orb|mo-hf>  5  5    0.98488756
<CAS-nat-orb|mo-hf>  6  6    0.99934351
<CAS-nat-orb|mo-hf>  7  7    0.94550984
<CAS-nat-orb|mo-hf>  8  8    0.96719800
<CAS-nat-orb|mo-hf>  9  9    0.95784087
<CAS-nat-orb|mo-hf>  10  10    0.82549313
<CAS-nat-orb|mo-hf>  10  11   -0.53364519
CASSCF energy = -75.5228659467819
CASCI E = -75.5228659467819  E(CI) = -15.884598166453  S^2 = 0.0000000
......production of RDMs took       2.06 sec
......reading the RDM took          0.45 sec
......production of RDMs took      28.35 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.19 sec

E(WickICMRREPT2-ijrs) =    -0.00026535905561
E(WickICMRREPT2- rsi) =    -0.00085984936320
E(WickICMRREPT2- ijr) =    -0.00027615717438
E(WickICMRREPT2-  rs) =    -0.05194090678574
E(WickICMRREPT2-  ij) =    -0.00008787696095
E(WickICMRREPT2-  ir) =    -0.00113402618594
E(WickICMRREPT2-   r) =    -0.06508407897498
E(WickICMRREPT2-   i) =    -0.00010399072347
E(WickICMRREPT2) = -75.64261819200617  E_corr_pt = -0.1197522452242676
Timings = pdms =   41.07 | eris =    0.18 | ijrs =    1.76 | rsi =   39.23 | ijr =    0.42 | rs =  698.43 | ij =    1.35 | ir =   25.21 | r =  178.17 | i =    2.81 | total =  988.70
Time cost =   1075.584
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:15:58 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.693367074944 AA    0.000000000000   0.000000000000   3.200000000000 Bohr   0.0

nuclear repulsion = 11.25
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.6]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    427684.43


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpz0d0773k
max_memory 4000 MB (current use 451 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8853199307072

WARN: Singularity detected in overlap matrix (condition number =  163). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.140132093357862  LUMO (B3u) = -0.140132093357862

WARN: B2u HOMO -0.140132093357862 > system LUMO -0.140132093357862

cycle= 1 E= -75.3423788059563  delta_E= -0.457  |g|= 0.259  |ddm|= 1.53
HOMO (B2u) = -0.402834374141251  LUMO (B3u) = -0.0785386739836414
cycle= 2 E= -75.3685959970364  delta_E= -0.0262  |g|= 0.053  |ddm|= 0.353
HOMO (B2u) = -0.363851731217672  LUMO (B3u) = -0.034630422436522
cycle= 3 E= -75.3700649559039  delta_E= -0.00147  |g|= 0.0182  |ddm|= 0.0704
HOMO (B2u) = -0.368389012587526  LUMO (B3u) = -0.039110810343645
cycle= 4 E= -75.3702805696256  delta_E= -0.000216  |g|= 0.000703  |ddm|= 0.0381
HOMO (B2u) = -0.368430097958785  LUMO (B3u) = -0.0392945410036858
cycle= 5 E= -75.3702807668801  delta_E= -1.97e-07  |g|= 8.62e-05  |ddm|= 0.00125
HOMO (B2u) = -0.368399790742494  LUMO (B3u) = -0.0392632961118444
cycle= 6 E= -75.3702807710482  delta_E= -4.17e-09  |g|= 1.41e-05  |ddm|= 0.000143
HOMO (B2u) = -0.368398140839551  LUMO (B3u) = -0.0392648663308051
cycle= 7 E= -75.3702807711757  delta_E= -1.27e-10  |g|= 1.92e-06  |ddm|= 3.39e-05
HOMO (B2u) = -0.368397398349208  LUMO (B3u) = -0.0392644368519653
cycle= 8 E= -75.3702807711782  delta_E= -2.47e-12  |g|= 1.08e-07  |ddm|= 4.2e-06
HOMO (B2u) = -0.36839742052192  LUMO (B3u) = -0.0392644560493151
cycle= 9 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 7.49e-09  |ddm|= 2.14e-07
HOMO (B2u) = -0.368397421399115  LUMO (B3u) = -0.0392644585006884
cycle= 10 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 4.7e-09  |ddm|= 7.63e-09
HOMO (B2u) = -0.368397421281669  LUMO (B3u) = -0.0392644583560078
cycle= 11 E= -75.3702807711782  delta_E= 5.68e-14  |g|= 4.19e-09  |ddm|= 4.07e-09
HOMO (B2u) = -0.368397419986408  LUMO (B3u) = -0.0392644569928971
cycle= 12 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 3.87e-09  |ddm|= 1.94e-09
HOMO (B2u) = -0.368397420308109  LUMO (B3u) = -0.0392644572886649
cycle= 13 E= -75.3702807711782  delta_E= 5.68e-14  |g|= 3.34e-09  |ddm|= 8.4e-10
HOMO (B2u) = -0.368397419921322  LUMO (B3u) = -0.0392644568735349
cycle= 14 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 5.28e-10  |ddm|= 5e-09
HOMO (B2u) = -0.368397420132817  LUMO (B3u) = -0.0392644570114684
cycle= 15 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 5.84e-10  |ddm|= 1.53e-09
HOMO (B2u) = -0.368397420046963  LUMO (B3u) = -0.0392644570359427
cycle= 16 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 7.21e-10  |ddm|= 1.54e-09
HOMO (B2u) = -0.36839742009361  LUMO (B3u) = -0.0392644570383646
cycle= 17 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 7.09e-10  |ddm|= 7.35e-10
HOMO (B2u) = -0.368397420093971  LUMO (B3u) = -0.0392644570252884
cycle= 18 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 5.03e-10  |ddm|= 3.46e-10
HOMO (B2u) = -0.368397420112665  LUMO (B3u) = -0.0392644570440597
cycle= 19 E= -75.3702807711782  delta_E=    0  |g|= 4.32e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.368397420134473  LUMO (B3u) = -0.0392644570647838
cycle= 20 E= -75.3702807711783  delta_E= -1.42e-14  |g|= 3.41e-10  |ddm|= 1.43e-10
HOMO (B2u) = -0.368397420141457  LUMO (B3u) = -0.0392644570677911
cycle= 21 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 2.32e-10  |ddm|= 1.8e-10
HOMO (B2u) = -0.368397420150084  LUMO (B3u) = -0.0392644570740865
cycle= 22 E= -75.3702807711781  delta_E= 1.28e-13  |g|= 1.37e-10  |ddm|= 1.65e-10
HOMO (B2u) = -0.368397420149812  LUMO (B3u) = -0.0392644570721862
cycle= 23 E= -75.3702807711782  delta_E= -4.26e-14  |g|= 1.32e-10  |ddm|= 4.11e-11
HOMO (B2u) = -0.368397420145921  LUMO (B3u) = -0.0392644570700964
cycle= 24 E= -75.3702807711782  delta_E=    0  |g|= 1.23e-10  |ddm|= 5.37e-11
HOMO (B2u) = -0.368397420148403  LUMO (B3u) = -0.0392644570698271
cycle= 25 E= -75.3702807711782  delta_E= -8.53e-14  |g|= 9.96e-11  |ddm|= 5.6e-11
HOMO (B2u) = -0.368397420149644  LUMO (B3u) = -0.0392644570699823
cycle= 26 E= -75.3702807711782  delta_E= 5.68e-14  |g|= 7.83e-11  |ddm|= 4.05e-11
HOMO (B2u) = -0.368397420150149  LUMO (B3u) = -0.03926445706986
cycle= 27 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 6.41e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.36839742015063  LUMO (B3u) = -0.039264457069726
cycle= 28 E= -75.3702807711781  delta_E= 1.14e-13  |g|= 5e-11  |ddm|= 2.76e-11
HOMO (B2u) = -0.368397420151194  LUMO (B3u) = -0.0392644570697676
cycle= 29 E= -75.3702807711781  delta_E= -4.26e-14  |g|= 3.85e-11  |ddm|= 2.34e-11
HOMO (B2u) = -0.368397420151571  LUMO (B3u) = -0.039264457069793
cycle= 30 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 3.06e-11  |ddm|= 1.66e-11
HOMO (B2u) = -0.36839742015187  LUMO (B3u) = -0.0392644570698677
cycle= 31 E= -75.3702807711781  delta_E= 5.68e-14  |g|= 2.64e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.368397420152064  LUMO (B3u) = -0.0392644570698815
cycle= 32 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 2.19e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.368397420152362  LUMO (B3u) = -0.039264457069908
cycle= 33 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 1.77e-11  |ddm|= 9.25e-12
HOMO (B2u) = -0.36839742015255  LUMO (B3u) = -0.0392644570699262
cycle= 34 E= -75.3702807711782  delta_E= -4.26e-14  |g|= 1.43e-11  |ddm|= 7.29e-12
HOMO (B2u) = -0.368397420152688  LUMO (B3u) = -0.0392644570699345
cycle= 35 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 1.16e-11  |ddm|= 5.87e-12
HOMO (B2u) = -0.368397420152793  LUMO (B3u) = -0.0392644570699304
cycle= 36 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 9.38e-12  |ddm|= 4.97e-12
HOMO (B2u) = -0.368397420152873  LUMO (B3u) = -0.0392644570699223
cycle= 37 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 7.6e-12  |ddm|= 3.94e-12
HOMO (B2u) = -0.368397420152934  LUMO (B3u) = -0.0392644570699161
cycle= 38 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 6.26e-12  |ddm|= 3.03e-12
HOMO (B2u) = -0.368397420152984  LUMO (B3u) = -0.0392644570699107
cycle= 39 E= -75.3702807711782  delta_E=    0  |g|= 5.18e-12  |ddm|= 2.43e-12
HOMO (B2u) = -0.368397420153132  LUMO (B3u) = -0.0392644570698932
Extra cycle  E= -75.3702807711782  delta_E= 2.84e-14  |g|= 1.9e-12  |ddm|= 7.33e-12
converged SCF energy = -75.3702807711782

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpz0d0773k
max_memory 4000 MB (current use 451 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4686639234795  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4801659097205  dE = -0.011501986  S^2 = 0.0000000
               |grad[o]|=0.0808  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4904755225424  dE = -0.010309613  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0571  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4994469984944  dE = -0.008971476  S^2 = 0.0000000
               |grad[o]|=0.0646  |ddm|=0.0512  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5069095409372  dE = -0.0074625424  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0778  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.512364058563  dE = -0.0054545176  S^2 = 0.0000000
               |grad[o]|=0.0456  |ddm|=0.0796  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5156468201366  dE = -0.0032827616  S^2 = 0.0000000
               |grad[o]|=0.0301  |ddm|=0.0211  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5168779321826  dE = -0.001231112  S^2 = 0.0000000
               |grad[o]|=0.015  |ddm|=0.0787  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5176271585474  dE = -0.00074922636  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0722  |maxRot[o]|= 0.04
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5179500779162  dE = -0.00032291937  S^2 = 0.0000000
               |grad[o]|=0.00624  |ddm|=0.0442  |maxRot[o]|=0.0327
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5180290722488  dE = -7.8994333e-05  S^2 = 0.0000000
               |grad[o]|=0.00298  |ddm|=0.0185  |maxRot[o]|=0.0178
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5180431645368  dE = -1.4092288e-05  S^2 = 0.0000000
               |grad[o]|=0.00127  |ddm|=0.00708  |maxRot[o]|=0.0078
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5180453677532  dE = -2.2032163e-06  S^2 = 0.0000000
               |grad[o]|=0.000512  |ddm|=0.00271  |maxRot[o]|=0.00313
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5180456955226  dE = -3.2776948e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.00104  |maxRot[o]|=0.00122
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5180457433191  dE = -4.7796505e-08  S^2 = 0.0000000
               |grad[o]|=7.71e-05  |ddm|=0.000395  |maxRot[o]|=0.000466
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5180457501981  dE = -6.8789916e-09  S^2 = 0.0000000
               |grad[o]|=2.95e-05  |ddm|=0.00015  |maxRot[o]|=0.000178
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5180457511752  dE = -9.7706732e-10  S^2 = 0.0000000
               |grad[o]|=1.12e-05  |ddm|=5.71e-05  |maxRot[o]|=6.77e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5180457513066  dE = -1.3139356e-10  S^2 = 0.0000000
               |grad[o]|=4.24e-06  |ddm|=2.16e-05  |maxRot[o]|=2.54e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.518045751323  dE = -1.6427748e-11  S^2 = 0.0000000
               |grad[o]|=1.61e-06  |ddm|=8.17e-06  |maxRot[o]|=9.68e-06
2-step CASSCF converged in 18 macro (71 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9663057  1.92713079 1.90282925 1.84406996 0.08365691 0.16227412
 0.0596417  0.05409157]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00972   0.00945  -0.00589   0.00000   0.00000
  0 C 2s       0.59726   0.63748  -0.37752  -0.00000   0.00000
  0 C 3s      -0.02696   0.01811  -0.05147  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000  -0.00000   0.00000   0.69538
  0 C 2py     -0.00000   0.00000   0.00000   0.70451   0.00000
  0 C 2pz      0.37495  -0.30481   0.59459   0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.05355
  0 C 3py     -0.00000   0.00000   0.00000   0.04456  -0.00000
  0 C 3pz     -0.02582  -0.00292  -0.00005  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.04098  -0.00000
  0 C 3dz^2    0.03462  -0.01515   0.03455  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11653
 0 C 3dx2-y2  -0.00172   0.00737  -0.00749  -0.00000   0.00000
  1 C 1s       0.00972  -0.00945  -0.00589   0.00000   0.00000
  1 C 2s       0.59726  -0.63748  -0.37752  -0.00000   0.00000
  1 C 3s      -0.02696  -0.01811  -0.05147   0.00000   0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69538
  1 C 2py      0.00000  -0.00000   0.00000   0.70451  -0.00000
  1 C 2pz     -0.37495  -0.30481  -0.59459  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00000  -0.05355
  1 C 3py      0.00000  -0.00000  -0.00000   0.04456  -0.00000
  1 C 3pz      0.02582  -0.00292   0.00005  -0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.04098   0.00000
  1 C 3dz^2    0.03462   0.01515   0.03455   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000  -0.00000   0.00000   0.11653
 1 C 3dx2-y2  -0.00172  -0.00737  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s      -0.00000   0.00000   0.30262
  0 C 3s      -0.00000   0.00000   0.04028
  0 C 2px      0.00000   0.69699  -0.00000
  0 C 2py      0.70653   0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.63446
  0 C 3px      0.00000   0.00537   0.00000
  0 C 3py     -0.02507   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05718
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01392   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01415
  0 C 3dxz     0.00000  -0.11904   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02809
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000   0.00000  -0.30262
  1 C 3s       0.00000  -0.00000  -0.04028
  1 C 2px     -0.00000  -0.69699  -0.00000
  1 C 2py     -0.70653  -0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.63446
  1 C 3px     -0.00000  -0.00537   0.00000
  1 C 3py      0.02507  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.05718
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.01392   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01415
  1 C 3dxz     0.00000  -0.11904  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02809
<CAS-nat-orb|mo-hf>  3  3    0.98713996
<CAS-nat-orb|mo-hf>  4  4    0.99975825
<CAS-nat-orb|mo-hf>  5  5    0.98714928
<CAS-nat-orb|mo-hf>  6  6    0.99929981
<CAS-nat-orb|mo-hf>  7  7    0.94370155
<CAS-nat-orb|mo-hf>  8  8    0.96917400
<CAS-nat-orb|mo-hf>  9  9    0.95823418
<CAS-nat-orb|mo-hf>  10  10    0.84381041
<CAS-nat-orb|mo-hf>  10  11   -0.50815317
CASSCF energy = -75.518045751323
CASCI E = -75.518045751323  E(CI) = -15.8005832192871  S^2 = 0.0000000
......production of RDMs took       1.98 sec
......reading the RDM took          0.45 sec
......production of RDMs took      30.00 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.43 sec

E(WickICMRREPT2-ijrs) =    -0.00026542719712
E(WickICMRREPT2- rsi) =    -0.00085708998425
E(WickICMRREPT2- ijr) =    -0.00027267294138
E(WickICMRREPT2-  rs) =    -0.05168241397661
E(WickICMRREPT2-  ij) =    -0.00008434058033
E(WickICMRREPT2-  ir) =    -0.00112232260191
E(WickICMRREPT2-   r) =    -0.06559941912182
E(WickICMRREPT2-   i) =    -0.00009863431143
E(WickICMRREPT2) = -75.63802807203788  E_corr_pt = -0.1199823207148573
Timings = pdms =   42.90 | eris =    0.19 | ijrs =    1.36 | rsi =   37.70 | ijr =    0.42 | rs =  738.33 | ij =    1.45 | ir =   31.88 | r =  159.28 | i =    3.70 | total = 1017.28
Time cost =   1086.008
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:34:04 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.719825935490 AA    0.000000000000   0.000000000000   3.250000000000 Bohr   0.0

nuclear repulsion = 11.0769230769231
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.625]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    444487.81


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpepqnbi_1
max_memory 4000 MB (current use 401 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8631164371269

WARN: Singularity detected in overlap matrix (condition number =  151). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.13569696344616  LUMO (B3u) = -0.135696963446161

WARN: B2u HOMO -0.13569696344616 > system LUMO -0.135696963446161

cycle= 1 E= -75.3346710578886  delta_E= -0.472  |g|= 0.257  |ddm|= 1.52
HOMO (B2u) = -0.397829563278945  LUMO (B3u) = -0.075589709354353
cycle= 2 E= -75.360485940034  delta_E= -0.0258  |g|= 0.0524  |ddm|= 0.352
HOMO (B2u) = -0.359424194210818  LUMO (B3u) = -0.0322866366973569
cycle= 3 E= -75.3619492644577  delta_E= -0.00146  |g|= 0.0182  |ddm|= 0.0697
HOMO (B2u) = -0.363955951245315  LUMO (B3u) = -0.0367454491314092
cycle= 4 E= -75.3621677667453  delta_E= -0.000219  |g|= 0.000695  |ddm|= 0.0379
HOMO (B2u) = -0.364024863853047  LUMO (B3u) = -0.036958821387873
cycle= 5 E= -75.3621679575039  delta_E= -1.91e-07  |g|= 8.98e-05  |ddm|= 0.00116
HOMO (B2u) = -0.363992517085411  LUMO (B3u) = -0.0369261206635494
cycle= 6 E= -75.3621679620312  delta_E= -4.53e-09  |g|= 1.46e-05  |ddm|= 0.000149
HOMO (B2u) = -0.363990782245929  LUMO (B3u) = -0.0369275152560894
cycle= 7 E= -75.3621679621672  delta_E= -1.36e-10  |g|= 1.94e-06  |ddm|= 3.41e-05
HOMO (B2u) = -0.363990060624705  LUMO (B3u) = -0.0369271360119671
cycle= 8 E= -75.3621679621697  delta_E= -2.44e-12  |g|= 1.11e-07  |ddm|= 4.19e-06
HOMO (B2u) = -0.363990078364994  LUMO (B3u) = -0.0369271500510417
cycle= 9 E= -75.3621679621697  delta_E=    0  |g|= 7.05e-09  |ddm|= 2.21e-07
HOMO (B2u) = -0.363990079143498  LUMO (B3u) = -0.0369271524130821
cycle= 10 E= -75.3621679621697  delta_E=    0  |g|= 4.67e-09  |ddm|= 7.46e-09
HOMO (B2u) = -0.363990078973077  LUMO (B3u) = -0.0369271522128167
cycle= 11 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 4e-09  |ddm|= 4e-09
HOMO (B2u) = -0.363990077683365  LUMO (B3u) = -0.0369271508566985
cycle= 12 E= -75.3621679621697  delta_E=    0  |g|= 3.68e-09  |ddm|= 1.86e-09
HOMO (B2u) = -0.36399007803898  LUMO (B3u) = -0.0369271511895281
cycle= 13 E= -75.3621679621696  delta_E= 7.11e-14  |g|= 3.23e-09  |ddm|= 8.39e-10
HOMO (B2u) = -0.36399007765751  LUMO (B3u) = -0.0369271508035301
cycle= 14 E= -75.3621679621697  delta_E= -1.14e-13  |g|= 4.12e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.36399007785154  LUMO (B3u) = -0.0369271509287168
cycle= 15 E= -75.3621679621697  delta_E= 4.26e-14  |g|= 5.36e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.363990077764564  LUMO (B3u) = -0.0369271509413741
cycle= 16 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 6.62e-10  |ddm|= 1.35e-09
HOMO (B2u) = -0.363990077806086  LUMO (B3u) = -0.0369271509397321
cycle= 17 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 6.48e-10  |ddm|= 7.17e-10
HOMO (B2u) = -0.363990077800257  LUMO (B3u) = -0.0369271509229781
cycle= 18 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 4.6e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.36399007781568  LUMO (B3u) = -0.036927150939242
cycle= 19 E= -75.3621679621697  delta_E= 4.26e-14  |g|= 3.99e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.363990077833269  LUMO (B3u) = -0.0369271509566618
cycle= 20 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 3.18e-10  |ddm|= 1.18e-10
HOMO (B2u) = -0.363990077836382  LUMO (B3u) = -0.0369271509567455
cycle= 21 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 2.16e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.363990077841874  LUMO (B3u) = -0.0369271509608745
cycle= 22 E= -75.3621679621697  delta_E= -4.26e-14  |g|= 1.24e-10  |ddm|= 1.53e-10
HOMO (B2u) = -0.363990077841471  LUMO (B3u) = -0.0369271509589886
cycle= 23 E= -75.3621679621697  delta_E= -4.26e-14  |g|= 1.23e-10  |ddm|= 2.67e-11
HOMO (B2u) = -0.363990077837804  LUMO (B3u) = -0.0369271509570194
cycle= 24 E= -75.3621679621697  delta_E=    0  |g|= 1.12e-10  |ddm|= 4.75e-11
HOMO (B2u) = -0.363990077839657  LUMO (B3u) = -0.036927150956446
cycle= 25 E= -75.3621679621697  delta_E= 5.68e-14  |g|= 9.1e-11  |ddm|= 4.86e-11
HOMO (B2u) = -0.363990077840176  LUMO (B3u) = -0.0369271509561582
cycle= 26 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 7.23e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.36399007784019  LUMO (B3u) = -0.0369271509557312
cycle= 27 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 6.01e-11  |ddm|= 2.12e-11
HOMO (B2u) = -0.363990077840264  LUMO (B3u) = -0.0369271509553523
cycle= 28 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 4.73e-11  |ddm|= 2.38e-11
HOMO (B2u) = -0.363990077840499  LUMO (B3u) = -0.0369271509551901
cycle= 29 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 3.66e-11  |ddm|= 2.09e-11
HOMO (B2u) = -0.363990077840629  LUMO (B3u) = -0.036927150955053
cycle= 30 E= -75.3621679621697  delta_E= 5.68e-14  |g|= 2.92e-11  |ddm|= 1.48e-11
HOMO (B2u) = -0.36399007784077  LUMO (B3u) = -0.0369271509550144
cycle= 31 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 2.52e-11  |ddm|= 8.62e-12
HOMO (B2u) = -0.363990077840825  LUMO (B3u) = -0.0369271509549322
cycle= 32 E= -75.3621679621698  delta_E= -9.95e-14  |g|= 2.1e-11  |ddm|= 9.08e-12
HOMO (B2u) = -0.363990077840989  LUMO (B3u) = -0.0369271509548758
cycle= 33 E= -75.3621679621696  delta_E= 1.28e-13  |g|= 1.71e-11  |ddm|= 8.16e-12
HOMO (B2u) = -0.363990077841069  LUMO (B3u) = -0.0369271509548259
cycle= 34 E= -75.3621679621697  delta_E= -8.53e-14  |g|= 1.4e-11  |ddm|= 6.41e-12
HOMO (B2u) = -0.363990077841124  LUMO (B3u) = -0.0369271509547817
cycle= 35 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 1.15e-11  |ddm|= 5.27e-12
HOMO (B2u) = -0.363990077841163  LUMO (B3u) = -0.0369271509547361
cycle= 36 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 9.3e-12  |ddm|= 4.58e-12
HOMO (B2u) = -0.363990077841193  LUMO (B3u) = -0.0369271509546966
cycle= 37 E= -75.3621679621697  delta_E=    0  |g|= 7.58e-12  |ddm|= 3.66e-12
HOMO (B2u) = -0.36399007784128  LUMO (B3u) = -0.0369271509545889
Extra cycle  E= -75.3621679621697  delta_E=    0  |g|= 2.86e-12  |ddm|= 1.02e-11
converged SCF energy = -75.3621679621697

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpepqnbi_1
max_memory 4000 MB (current use 410 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4646530045348  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4765356118781  dE = -0.011882607  S^2 = 0.0000000
               |grad[o]|=0.0827  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4870504127981  dE = -0.010514801  S^2 = 0.0000000
               |grad[o]|=0.0737  |ddm|=0.0595  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4959877419099  dE = -0.0089373291  S^2 = 0.0000000
               |grad[o]|=0.0638  |ddm|=0.044  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5032500656337  dE = -0.0072623237  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.0592  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5084942261022  dE = -0.0052441605  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.0625  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5116033004285  dE = -0.0031090743  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5125684622172  dE = -0.00096516179  S^2 = 0.0000000
               |grad[o]|=0.0119  |ddm|=0.0749  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5130317828046  dE = -0.00046332059  S^2 = 0.0000000
               |grad[o]|=0.00731  |ddm|=0.0414  |maxRot[o]|=0.0388
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5131334897645  dE = -0.00010170696  S^2 = 0.0000000
               |grad[o]|=0.00337  |ddm|=0.0207  |maxRot[o]|= 0.02
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5131512581338  dE = -1.7768369e-05  S^2 = 0.0000000
               |grad[o]|=0.00142  |ddm|=0.00715  |maxRot[o]|=0.00888
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5131537359663  dE = -2.4778324e-06  S^2 = 0.0000000
               |grad[o]|=0.000543  |ddm|=0.00276  |maxRot[o]|=0.00337
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5131540649679  dE = -3.2900159e-07  S^2 = 0.0000000
               |grad[o]|=0.000202  |ddm|=0.000999  |maxRot[o]|=0.00124
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5131541079163  dE = -4.2948486e-08  S^2 = 0.0000000
               |grad[o]|=7.36e-05  |ddm|=0.000361  |maxRot[o]|=0.000449
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5131541134676  dE = -5.5512146e-09  S^2 = 0.0000000
               |grad[o]|=2.66e-05  |ddm|=0.00013  |maxRot[o]|=0.000162
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5131541141773  dE = -7.0974693e-10  S^2 = 0.0000000
               |grad[o]|=9.58e-06  |ddm|=4.67e-05  |maxRot[o]|=5.83e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5131541142659  dE = -8.8576257e-11  S^2 = 0.0000000
               |grad[o]|=3.46e-06  |ddm|=1.68e-05  |maxRot[o]|=2.1e-05
2-step CASSCF converged in 16 macro (65 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96506513 1.92787018 1.90242015 1.83461648 0.08106132 0.17170008
 0.05932555 0.0579411 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01001   0.00958  -0.00569   0.00000   0.00000
  0 C 2s       0.60769   0.64161  -0.36054  -0.00000   0.00000
  0 C 3s      -0.02394   0.01781  -0.04989  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69498
  0 C 2py     -0.00000   0.00000  -0.00000   0.70448  -0.00000
  0 C 2pz      0.35831  -0.29606   0.60517  -0.00000  -0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.05520
  0 C 3py     -0.00000   0.00000   0.00000   0.04615   0.00000
  0 C 3pz     -0.02386  -0.00271   0.00109  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03981  -0.00000
  0 C 3dz^2    0.03287  -0.01476   0.03469  -0.00000  -0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.11816
 0 C 3dx2-y2  -0.00145   0.00725  -0.00749   0.00000  -0.00000
  1 C 1s       0.01001  -0.00958  -0.00569   0.00000   0.00000
  1 C 2s       0.60769  -0.64161  -0.36054   0.00000   0.00000
  1 C 3s      -0.02394  -0.01781  -0.04989   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69498
  1 C 2py      0.00000  -0.00000   0.00000   0.70448   0.00000
  1 C 2pz     -0.35831  -0.29606  -0.60517  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05520
  1 C 3py      0.00000  -0.00000  -0.00000   0.04615   0.00000
  1 C 3pz      0.02386  -0.00271  -0.00109  -0.00000   0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03981  -0.00000
  1 C 3dz^2    0.03287   0.01476   0.03469   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11816
 1 C 3dx2-y2  -0.00145  -0.00725  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00052
  0 C 2s      -0.00000   0.00000   0.29408
  0 C 3s      -0.00000  -0.00000   0.03931
  0 C 2px      0.00000   0.69713  -0.00000
  0 C 2py      0.70661   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.63885
  0 C 3px      0.00000   0.00311  -0.00000
  0 C 3py     -0.02293   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05440
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01349   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.01292
  0 C 3dxz     0.00000  -0.11834  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02684
  1 C 1s       0.00000   0.00000   0.00052
  1 C 2s       0.00000   0.00000  -0.29408
  1 C 3s       0.00000   0.00000  -0.03931
  1 C 2px     -0.00000  -0.69713   0.00000
  1 C 2py     -0.70661  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.63885
  1 C 3px     -0.00000  -0.00311   0.00000
  1 C 3py      0.02293  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.05440
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01349   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.01292
  1 C 3dxz     0.00000  -0.11834  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02684
<CAS-nat-orb|mo-hf>  3  3    0.98958162
<CAS-nat-orb|mo-hf>  4  4    0.99975150
<CAS-nat-orb|mo-hf>  5  5    0.98959416
<CAS-nat-orb|mo-hf>  6  6    0.99925428
<CAS-nat-orb|mo-hf>  7  7    0.94209804
<CAS-nat-orb|mo-hf>  8  8    0.97102424
<CAS-nat-orb|mo-hf>  9  9    0.95858985
<CAS-nat-orb|mo-hf>  10  10    0.86001483
<CAS-nat-orb|mo-hf>  10  11   -0.48380369
CASSCF energy = -75.5131541142659
CASCI E = -75.5131541142659  E(CI) = -15.7189305753107  S^2 = 0.0000000
......production of RDMs took       1.92 sec
......reading the RDM took          0.42 sec
......production of RDMs took      25.65 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.34 sec

E(WickICMRREPT2-ijrs) =    -0.00026569338101
E(WickICMRREPT2- rsi) =    -0.00085514113341
E(WickICMRREPT2- ijr) =    -0.00026946199681
E(WickICMRREPT2-  rs) =    -0.05142477574880
E(WickICMRREPT2-  ij) =    -0.00008102785384
E(WickICMRREPT2-  ir) =    -0.00111144044367
E(WickICMRREPT2-   r) =    -0.06613091277205
E(WickICMRREPT2-   i) =    -0.00009367335326
E(WickICMRREPT2) = -75.63338624094874  E_corr_pt = -0.1202321266828459
Timings = pdms =   38.35 | eris =    0.14 | ijrs =    1.16 | rsi =   34.27 | ijr =    0.43 | rs =  642.38 | ij =    5.07 | ir =   28.15 | r =  147.11 | i =    2.29 | total =  899.44
Time cost =    962.917
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:50:07 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.746284796036 AA    0.000000000000   0.000000000000   3.300000000000 Bohr   0.0

nuclear repulsion = 10.9090909090909
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.65]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    458779.79


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp7e3m5k29
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.842256067793

WARN: Singularity detected in overlap matrix (condition number =  141). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.131475269334874  LUMO (B3u) = -0.131475269334874

WARN: B2u HOMO -0.131475269334874 > system LUMO -0.131475269334874

cycle= 1 E= -75.3268751185369  delta_E= -0.485  |g|= 0.254  |ddm|= 1.52
HOMO (B2u) = -0.392977692990132  LUMO (B3u) = -0.0727206501017177
cycle= 2 E= -75.3522841088372  delta_E= -0.0254  |g|= 0.0519  |ddm|= 0.352
HOMO (B2u) = -0.355147584178279  LUMO (B3u) = -0.0300222920891312
cycle= 3 E= -75.3537386656221  delta_E= -0.00145  |g|= 0.0182  |ddm|= 0.0689
HOMO (B2u) = -0.359671017046594  LUMO (B3u) = -0.0344578300630383
cycle= 4 E= -75.3539592586542  delta_E= -0.000221  |g|= 0.000688  |ddm|= 0.0377
HOMO (B2u) = -0.359764894042612  LUMO (B3u) = -0.0346976899212341
cycle= 5 E= -75.3539594435199  delta_E= -1.85e-07  |g|= 9.37e-05  |ddm|= 0.00109
HOMO (B2u) = -0.3597308801256  LUMO (B3u) = -0.0346640305640347
cycle= 6 E= -75.3539594484633  delta_E= -4.94e-09  |g|= 1.51e-05  |ddm|= 0.000157
HOMO (B2u) = -0.35972902657833  LUMO (B3u) = -0.0346652386509448
cycle= 7 E= -75.3539594486084  delta_E= -1.45e-10  |g|= 1.94e-06  |ddm|= 3.44e-05
HOMO (B2u) = -0.359728331016986  LUMO (B3u) = -0.0346649076943878
cycle= 8 E= -75.3539594486108  delta_E= -2.37e-12  |g|= 1.14e-07  |ddm|= 4.16e-06
HOMO (B2u) = -0.359728345183665  LUMO (B3u) = -0.0346649176995349
cycle= 9 E= -75.3539594486109  delta_E= -1.14e-13  |g|= 6.91e-09  |ddm|= 2.29e-07
HOMO (B2u) = -0.359728345815558  LUMO (B3u) = -0.0346649199338421
cycle= 10 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 4.83e-09  |ddm|= 7.44e-09
HOMO (B2u) = -0.359728345624323  LUMO (B3u) = -0.0346649197162572
cycle= 11 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 3.95e-09  |ddm|= 4.03e-09
HOMO (B2u) = -0.359728344324685  LUMO (B3u) = -0.0346649183507484
cycle= 12 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 3.62e-09  |ddm|= 1.85e-09
HOMO (B2u) = -0.359728344700753  LUMO (B3u) = -0.034664918708032
cycle= 13 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 3.21e-09  |ddm|= 9.33e-10
HOMO (B2u) = -0.359728344323101  LUMO (B3u) = -0.0346649183510964
cycle= 14 E= -75.3539594486107  delta_E= 8.53e-14  |g|= 3.93e-10  |ddm|= 4.6e-09
HOMO (B2u) = -0.359728344496134  LUMO (B3u) = -0.0346649184552015
cycle= 15 E= -75.3539594486109  delta_E= -1.28e-13  |g|= 5.5e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.359728344402566  LUMO (B3u) = -0.0346649184610044
cycle= 16 E= -75.3539594486109  delta_E= 1.42e-14  |g|= 6.5e-10  |ddm|= 1.26e-09
HOMO (B2u) = -0.359728344445261  LUMO (B3u) = -0.0346649184557925
cycle= 17 E= -75.3539594486109  delta_E=    0  |g|= 6.39e-10  |ddm|= 8.11e-10
HOMO (B2u) = -0.359728344433454  LUMO (B3u) = -0.034664918435945
cycle= 18 E= -75.3539594486108  delta_E= 8.53e-14  |g|= 4.57e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.359728344445413  LUMO (B3u) = -0.0346649184497752
cycle= 19 E= -75.3539594486108  delta_E= -5.68e-14  |g|= 3.95e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.359728344459174  LUMO (B3u) = -0.0346649184644527
cycle= 20 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 3.17e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.359728344458603  LUMO (B3u) = -0.0346649184619501
cycle= 21 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 2.19e-10  |ddm|= 1.63e-10
HOMO (B2u) = -0.359728344461005  LUMO (B3u) = -0.0346649184640442
cycle= 22 E= -75.3539594486108  delta_E=    0  |g|= 1.27e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.359728344460421  LUMO (B3u) = -0.0346649184621525
cycle= 23 E= -75.3539594486108  delta_E=    0  |g|= 1.24e-10  |ddm|= 1.77e-11
HOMO (B2u) = -0.359728344456521  LUMO (B3u) = -0.0346649184600734
cycle= 24 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 1.11e-10  |ddm|= 4.67e-11
HOMO (B2u) = -0.359728344457847  LUMO (B3u) = -0.0346649184591173
cycle= 25 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 9.04e-11  |ddm|= 4.75e-11
HOMO (B2u) = -0.359728344457605  LUMO (B3u) = -0.0346649184583887
cycle= 26 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 7.25e-11  |ddm|= 3.21e-11
HOMO (B2u) = -0.359728344457096  LUMO (B3u) = -0.0346649184576536
cycle= 27 E= -75.3539594486109  delta_E= -1.14e-13  |g|= 6.09e-11  |ddm|= 2.13e-11
HOMO (B2u) = -0.35972834445674  LUMO (B3u) = -0.0346649184570274
cycle= 28 E= -75.3539594486108  delta_E= 9.95e-14  |g|= 4.84e-11  |ddm|= 2.38e-11
HOMO (B2u) = -0.35972834445663  LUMO (B3u) = -0.0346649184566607
cycle= 29 E= -75.3539594486108  delta_E= -4.26e-14  |g|= 3.76e-11  |ddm|= 2.11e-11
HOMO (B2u) = -0.3597283444565  LUMO (B3u) = -0.0346649184563606
cycle= 30 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 3.01e-11  |ddm|= 1.52e-11
HOMO (B2u) = -0.359728344456471  LUMO (B3u) = -0.0346649184562057
cycle= 31 E= -75.3539594486108  delta_E=    0  |g|= 2.59e-11  |ddm|= 8.77e-12
HOMO (B2u) = -0.359728344456307  LUMO (B3u) = -0.0346649184555831
Extra cycle  E= -75.3539594486108  delta_E= 4.26e-14  |g|= 9.81e-12  |ddm|= 3.36e-11
converged SCF energy = -75.3539594486108

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp7e3m5k29
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4605852262835  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4728649095988  dE = -0.012279683  S^2 = 0.0000000
               |grad[o]|=0.0845  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4835908921791  dE = -0.010725983  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0629  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4924933536959  dE = -0.0089024615  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.0412  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4995415975415  dE = -0.0070482438  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0503  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5045613523341  dE = -0.0050197548  S^2 = 0.0000000
               |grad[o]|=0.0383  |ddm|=0.0585  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5070403288436  dE = -0.0024789765  S^2 = 0.0000000
               |grad[o]|=0.0222  |ddm|=0.0398  |maxRot[o]|= 0.06
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5078465774027  dE = -0.00080624856  S^2 = 0.0000000
               |grad[o]|=0.0105  |ddm|=0.0554  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.508167099406  dE = -0.000320522  S^2 = 0.0000000
               |grad[o]|=0.00584  |ddm|=0.0262  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5082201129815  dE = -5.3013575e-05  S^2 = 0.0000000
               |grad[o]|=0.0024  |ddm|=0.0133  |maxRot[o]|=0.0153
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5082271260863  dE = -7.0131047e-06  S^2 = 0.0000000
               |grad[o]|=0.000905  |ddm|=0.00451  |maxRot[o]|=0.00572
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5082279839393  dE = -8.5785308e-07  S^2 = 0.0000000
               |grad[o]|=0.000325  |ddm|=0.00156  |maxRot[o]|=0.00202
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5082280860405  dE = -1.0210121e-07  S^2 = 0.0000000
               |grad[o]|=0.000114  |ddm|=0.000538  |maxRot[o]|=0.0007
macro iter 13 (2 JK  0 micro), CASSCF E = -75.508228098037  dE = -1.1996462e-08  S^2 = 0.0000000
               |grad[o]|=3.95e-05  |ddm|=0.000185  |maxRot[o]|=0.000241
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5082280994326  dE = -1.3956054e-09  S^2 = 0.0000000
               |grad[o]|=1.37e-05  |ddm|=6.4e-05  |maxRot[o]|=8.32e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5082280995928  dE = -1.6019897e-10  S^2 = 0.0000000
               |grad[o]|=4.71e-06  |ddm|=2.19e-05  |maxRot[o]|=2.86e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.508228099607  dE = -1.4225066e-11  S^2 = 0.0000000
               |grad[o]|=1.56e-06  |ddm|=7e-06  |maxRot[o]|=9.46e-06
2-step CASSCF converged in 16 macro (63 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96387359 1.92858695 1.90144122 1.82466897 0.07878278 0.18160432
 0.05902031 0.06202185]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01031   0.00970  -0.00544   0.00000   0.00000
  0 C 2s       0.61830   0.64554  -0.34208   0.00000  -0.00000
  0 C 3s      -0.02094   0.01752  -0.04828   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69463
  0 C 2py      0.00000  -0.00000   0.00000   0.70445   0.00000
  0 C 2pz      0.34017  -0.28744   0.61591   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.05672
  0 C 3py     -0.00000   0.00000   0.00000   0.04759  -0.00000
  0 C 3pz     -0.02200  -0.00251   0.00227   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.03863  -0.00000
  0 C 3dz^2    0.03108  -0.01437   0.03487   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.11945
 0 C 3dx2-y2  -0.00117   0.00712  -0.00747   0.00000  -0.00000
  1 C 1s       0.01031  -0.00970  -0.00544   0.00000   0.00000
  1 C 2s       0.61830  -0.64554  -0.34208   0.00000   0.00000
  1 C 3s      -0.02094  -0.01752  -0.04828  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69463
  1 C 2py      0.00000  -0.00000  -0.00000   0.70445   0.00000
  1 C 2pz     -0.34017  -0.28744  -0.61591   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.05672
  1 C 3py     -0.00000   0.00000  -0.00000   0.04759  -0.00000
  1 C 3pz      0.02200  -0.00251  -0.00227   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.03863   0.00000
  1 C 3dz^2    0.03108   0.01437   0.03487  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.11945
 1 C 3dx2-y2  -0.00117  -0.00712  -0.00747   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00049
  0 C 2s       0.00000  -0.00000   0.28563
  0 C 3s       0.00000  -0.00000   0.03833
  0 C 2px     -0.00000   0.69726  -0.00000
  0 C 2py      0.70668  -0.00000   0.00000
  0 C 2pz      0.00000  -0.00000   0.64303
  0 C 3px     -0.00000   0.00091  -0.00000
  0 C 3py     -0.02081  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.05165
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.01306  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.01176
  0 C 3dxz    -0.00000  -0.11759  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02562
  1 C 1s       0.00000   0.00000   0.00049
  1 C 2s      -0.00000   0.00000  -0.28563
  1 C 3s      -0.00000   0.00000  -0.03833
  1 C 2px      0.00000  -0.69726  -0.00000
  1 C 2py     -0.70668   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.64303
  1 C 3px      0.00000  -0.00091   0.00000
  1 C 3py      0.02081   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.05165
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01306  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.01176
  1 C 3dxz    -0.00000  -0.11759  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.02562
<CAS-nat-orb|mo-hf>  3  3    0.99201756
<CAS-nat-orb|mo-hf>  4  4    0.99974451
<CAS-nat-orb|mo-hf>  5  5    0.99203281
<CAS-nat-orb|mo-hf>  6  6    0.99920694
<CAS-nat-orb|mo-hf>  7  7    0.94066257
<CAS-nat-orb|mo-hf>  8  8    0.97275729
<CAS-nat-orb|mo-hf>  9  9    0.95891046
<CAS-nat-orb|mo-hf>  10  10    0.87431676
<CAS-nat-orb|mo-hf>  10  11   -0.46069473
CASSCF energy = -75.508228099607
CASCI E = -75.508228099607  E(CI) = -15.6395663675254  S^2 = 0.0000000
......production of RDMs took       2.82 sec
......reading the RDM took          0.42 sec
......production of RDMs took      29.76 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.36 sec

E(WickICMRREPT2-ijrs) =    -0.00026614827311
E(WickICMRREPT2- rsi) =    -0.00085395606689
E(WickICMRREPT2- ijr) =    -0.00026651427729
E(WickICMRREPT2-  rs) =    -0.05117061752652
E(WickICMRREPT2-  ij) =    -0.00007793081517
E(WickICMRREPT2-  ir) =    -0.00110133948196
E(WickICMRREPT2-   r) =    -0.06666933201380
E(WickICMRREPT2-   i) =    -0.00008904861204
E(WickICMRREPT2) = -75.62872298667384  E_corr_pt = -0.120494887066795
Timings = pdms =   43.38 | eris =    0.05 | ijrs =    1.19 | rsi =   47.43 | ijr =    0.74 | rs =  663.55 | ij =    1.25 | ir =   26.57 | r =  159.84 | i =    2.34 | total =  946.52
Time cost =   1045.070
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 00:07:32 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.772743656582 AA    0.000000000000   0.000000000000   3.350000000000 Bohr   0.0

nuclear repulsion = 10.7462686567164
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.675]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    474323.12


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpb5sv0kaj
max_memory 4000 MB (current use 401 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8226756263582

WARN: Singularity detected in overlap matrix (condition number =  131). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.127455322759628  LUMO (B3u) = -0.127455322759627

WARN: B2u HOMO -0.127455322759628 > system LUMO -0.127455322759627

cycle= 1 E= -75.3190207821596  delta_E= -0.496  |g|= 0.252  |ddm|= 1.51
HOMO (B2u) = -0.388276779674663  LUMO (B3u) = -0.0699328749080293
cycle= 2 E= -75.3440245529482  delta_E= -0.025  |g|= 0.0513  |ddm|= 0.351
HOMO (B2u) = -0.351016713810032  LUMO (B3u) = -0.0278350417390006
cycle= 3 E= -75.3454675220221  delta_E= -0.00144  |g|= 0.0181  |ddm|= 0.0681
HOMO (B2u) = -0.355529260677999  LUMO (B3u) = -0.0322458808802162
cycle= 4 E= -75.3456894433557  delta_E= -0.000222  |g|= 0.000681  |ddm|= 0.0375
HOMO (B2u) = -0.355644927845468  LUMO (B3u) = -0.0325087452095936
cycle= 5 E= -75.3456896230235  delta_E= -1.8e-07  |g|= 9.78e-05  |ddm|= 0.00103
HOMO (B2u) = -0.355609613190056  LUMO (B3u) = -0.0324745833916023
cycle= 6 E= -75.3456896284285  delta_E= -5.41e-09  |g|= 1.56e-05  |ddm|= 0.000165
HOMO (B2u) = -0.35560762848265  LUMO (B3u) = -0.0324756124305536
cycle= 7 E= -75.345689628583  delta_E= -1.54e-10  |g|= 1.94e-06  |ddm|= 3.47e-05
HOMO (B2u) = -0.355606961354803  LUMO (B3u) = -0.0324753268420965
cycle= 8 E= -75.3456896285853  delta_E= -2.36e-12  |g|= 1.17e-07  |ddm|= 4.13e-06
HOMO (B2u) = -0.355606972649758  LUMO (B3u) = -0.0324753336780561
cycle= 9 E= -75.3456896285854  delta_E= -5.68e-14  |g|= 7.02e-09  |ddm|= 2.39e-07
HOMO (B2u) = -0.355606973127069  LUMO (B3u) = -0.0324753357914143
cycle= 10 E= -75.3456896285855  delta_E= -5.68e-14  |g|= 5.11e-09  |ddm|= 7.54e-09
HOMO (B2u) = -0.355606972914011  LUMO (B3u) = -0.0324753355551274
cycle= 11 E= -75.3456896285855  delta_E=    0  |g|= 4.03e-09  |ddm|= 4.12e-09
HOMO (B2u) = -0.355606971600165  LUMO (B3u) = -0.0324753341774324
cycle= 12 E= -75.3456896285854  delta_E= 8.53e-14  |g|= 3.67e-09  |ddm|= 1.92e-09
HOMO (B2u) = -0.355606971984196  LUMO (B3u) = -0.032475334546023
cycle= 13 E= -75.3456896285854  delta_E= -5.68e-14  |g|= 3.28e-09  |ddm|= 1.05e-09
HOMO (B2u) = -0.355606971978639  LUMO (B3u) = -0.0324753345653429
cycle= 14 E= -75.3456896285853  delta_E= 8.53e-14  |g|= 3.08e-09  |ddm|= 7.32e-10
HOMO (B2u) = -0.355606971764263  LUMO (B3u) = -0.0324753342957932
cycle= 15 E= -75.3456896285853  delta_E=    0  |g|= 7.17e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.355606971668462  LUMO (B3u) = -0.0324753342957696
cycle= 16 E= -75.3456896285853  delta_E= 2.84e-14  |g|= 7.7e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.355606971704456  LUMO (B3u) = -0.0324753342895888
cycle= 17 E= -75.3456896285854  delta_E= -8.53e-14  |g|= 7.69e-10  |ddm|= 7.32e-10
HOMO (B2u) = -0.355606971687248  LUMO (B3u) = -0.032475334267457
cycle= 18 E= -75.3456896285854  delta_E=    0  |g|= 5.86e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.355606971696194  LUMO (B3u) = -0.0324753342794445
cycle= 19 E= -75.3456896285853  delta_E= 5.68e-14  |g|= 5.26e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.355606971706705  LUMO (B3u) = -0.032475334292085
cycle= 20 E= -75.3456896285855  delta_E= -1.14e-13  |g|= 4.52e-10  |ddm|= 1.62e-10
HOMO (B2u) = -0.355606971702998  LUMO (B3u) = -0.0324753342876065
cycle= 21 E= -75.3456896285855  delta_E= -2.84e-14  |g|= 3.59e-10  |ddm|= 1.75e-10
HOMO (B2u) = -0.355606971702686  LUMO (B3u) = -0.0324753342881002
cycle= 22 E= -75.3456896285855  delta_E=    0  |g|= 2.68e-10  |ddm|= 1.69e-10
HOMO (B2u) = -0.355606971702983  LUMO (B3u) = -0.0324753342883443
cycle= 23 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 1.73e-10  |ddm|= 1.82e-10
HOMO (B2u) = -0.355606971698119  LUMO (B3u) = -0.0324753342857487
cycle= 24 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 1.55e-10  |ddm|= 5.83e-11
HOMO (B2u) = -0.355606971698312  LUMO (B3u) = -0.0324753342842459
cycle= 25 E= -75.3456896285855  delta_E= -5.68e-14  |g|= 1.3e-10  |ddm|= 5.28e-11
HOMO (B2u) = -0.355606971697105  LUMO (B3u) = -0.0324753342829329
cycle= 26 E= -75.3456896285854  delta_E= 8.53e-14  |g|= 1.09e-10  |ddm|= 4.42e-11
HOMO (B2u) = -0.355606971695857  LUMO (B3u) = -0.0324753342817242
cycle= 27 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 9.31e-11  |ddm|= 3.29e-11
HOMO (B2u) = -0.355606971694844  LUMO (B3u) = -0.0324753342806706
cycle= 28 E= -75.3456896285854  delta_E=    0  |g|= 7.65e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.355606971692555  LUMO (B3u) = -0.0324753342781797
Extra cycle  E= -75.3456896285854  delta_E= -2.84e-14  |g|= 2.88e-11  |ddm|= 9.98e-11
converged SCF energy = -75.3456896285854

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpb5sv0kaj
max_memory 4000 MB (current use 410 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4564838553943  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4691733729363  dE = -0.012689518  S^2 = 0.0000000
               |grad[o]|=0.0865  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.480108382105  dE = -0.010935009  S^2 = 0.0000000
               |grad[o]|=0.0752  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4889631035541  dE = -0.0088547214  S^2 = 0.0000000
               |grad[o]|=0.0624  |ddm|=0.0406  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4957789712864  dE = -0.0068158677  S^2 = 0.0000000
               |grad[o]|=0.0491  |ddm|=0.0471  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.500560511847  dE = -0.0047815406  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.0609  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5027257962524  dE = -0.0021652844  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.0448  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5031948312492  dE = -0.000469035  S^2 = 0.0000000
               |grad[o]|=0.00722  |ddm|=0.0469  |maxRot[o]|= 0.04
macro iter 8 (3 JK  0 micro), CASSCF E = -75.503286577888  dE = -9.1746639e-05  S^2 = 0.0000000
               |grad[o]|=0.00309  |ddm|=0.0149  |maxRot[o]|= 0.02
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5032982747812  dE = -1.1696893e-05  S^2 = 0.0000000
               |grad[o]|=0.00115  |ddm|=0.00551  |maxRot[o]|=0.00744
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5032995997978  dE = -1.3250165e-06  S^2 = 0.0000000
               |grad[o]|=0.000405  |ddm|=0.00187  |maxRot[o]|=0.00253
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5032997456183  dE = -1.4582049e-07  S^2 = 0.0000000
               |grad[o]|=0.000138  |ddm|=0.000621  |maxRot[o]|=0.000845
macro iter 12 (2 JK  0 micro), CASSCF E = -75.5032997614883  dE = -1.5869986e-08  S^2 = 0.0000000
               |grad[o]|=4.59e-05  |ddm|=0.000206  |maxRot[o]|=0.000279
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5032997632075  dE = -1.7192008e-09  S^2 = 0.0000000
               |grad[o]|=1.52e-05  |ddm|=6.73e-05  |maxRot[o]|=9.2e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5032997633895  dE = -1.8204105e-10  S^2 = 0.0000000
               |grad[o]|=5.06e-06  |ddm|=2.27e-05  |maxRot[o]|=3.05e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5032997634144  dE = -2.4911628e-11  S^2 = 0.0000000
               |grad[o]|=1.69e-06  |ddm|=7.63e-06  |maxRot[o]|=1.01e-05
2-step CASSCF converged in 15 macro (59 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96274301 1.92928247 1.89992238 1.8142028  0.07676462 0.19201084
 0.05872205 0.06635183]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01059   0.00982  -0.00515   0.00000   0.00000
  0 C 2s       0.62877   0.64927  -0.32247   0.00000   0.00000
  0 C 3s      -0.01802   0.01723  -0.04662  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69435
  0 C 2py     -0.00000   0.00000  -0.00000   0.70442   0.00000
  0 C 2pz      0.32084  -0.27893   0.62651  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000  -0.05813
  0 C 3py     -0.00000   0.00000  -0.00000   0.04890  -0.00000
  0 C 3pz     -0.02026  -0.00235   0.00351  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03743  -0.00000
  0 C 3dz^2    0.02926  -0.01397   0.03504  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000  -0.12042
 0 C 3dx2-y2  -0.00088   0.00700  -0.00745  -0.00000   0.00000
  1 C 1s       0.01059  -0.00982  -0.00515   0.00000   0.00000
  1 C 2s       0.62877  -0.64927  -0.32247   0.00000  -0.00000
  1 C 3s      -0.01802  -0.01723  -0.04662   0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70442   0.00000
  1 C 2pz     -0.32084  -0.27893  -0.62651  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.05813
  1 C 3py      0.00000  -0.00000   0.00000   0.04890  -0.00000
  1 C 3pz      0.02026  -0.00235  -0.00351  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.03743   0.00000
  1 C 3dz^2    0.02926   0.01397   0.03504   0.00000  -0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12042
 1 C 3dx2-y2  -0.00088  -0.00700  -0.00745   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00046
  0 C 2s      -0.00000   0.00000   0.27729
  0 C 3s      -0.00000   0.00000   0.03734
  0 C 2px     -0.00000   0.69739   0.00000
  0 C 2py      0.70675   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.64700
  0 C 3px     -0.00000  -0.00124   0.00000
  0 C 3py     -0.01872   0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.04893
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01263  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01067
  0 C 3dxz     0.00000  -0.11680   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.02442
  1 C 1s       0.00000   0.00000   0.00046
  1 C 2s      -0.00000  -0.00000  -0.27729
  1 C 3s       0.00000  -0.00000  -0.03734
  1 C 2px     -0.00000  -0.69739  -0.00000
  1 C 2py     -0.70675   0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.64700
  1 C 3px      0.00000   0.00124  -0.00000
  1 C 3py      0.01872  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04893
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01263  -0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01067
  1 C 3dxz    -0.00000  -0.11680   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02442
<CAS-nat-orb|mo-hf>  3  3    0.99427993
<CAS-nat-orb|mo-hf>  4  4    0.99973720
<CAS-nat-orb|mo-hf>  5  5    0.99429720
<CAS-nat-orb|mo-hf>  6  6    0.99915774
<CAS-nat-orb|mo-hf>  7  7    0.93938547
<CAS-nat-orb|mo-hf>  8  8    0.97438152
<CAS-nat-orb|mo-hf>  9  9    0.95919913
<CAS-nat-orb|mo-hf>  10  10    0.88692941
<CAS-nat-orb|mo-hf>  10  11   -0.43885970
CASSCF energy = -75.5032997634144
CASCI E = -75.5032997634144  E(CI) = -15.5624178249736  S^2 = 0.0000000
......production of RDMs took       1.98 sec
......reading the RDM took          0.44 sec
......production of RDMs took      22.97 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.81 sec

E(WickICMRREPT2-ijrs) =    -0.00026678549171
E(WickICMRREPT2- rsi) =    -0.00085349655588
E(WickICMRREPT2- ijr) =    -0.00026381557637
E(WickICMRREPT2-  rs) =    -0.05092193968739
E(WickICMRREPT2-  ij) =    -0.00007503703438
E(WickICMRREPT2-  ir) =    -0.00109198822391
E(WickICMRREPT2-   r) =    -0.06721138566937
E(WickICMRREPT2-   i) =    -0.00008472030018
E(WickICMRREPT2) = -75.6240689319536  E_corr_pt = -0.1207691685391912
Timings = pdms =   35.20 | eris =    0.05 | ijrs =    1.19 | rsi =   33.21 | ijr =    0.43 | rs =  680.49 | ij =    1.27 | ir =   26.57 | r =  158.82 | i =    2.36 | total =  939.64
Time cost =   1046.791
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 00:24:59 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.799202517128 AA    0.000000000000   0.000000000000   3.400000000000 Bohr   0.0

nuclear repulsion = 10.5882352941176
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.7]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    489912.81


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpd8tyl57m
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8043126951475

WARN: Singularity detected in overlap matrix (condition number =  122). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.123626145223849  LUMO (B3u) = -0.123626145223849

WARN: B2u HOMO -0.123626145223849 > system LUMO -0.123626145223849

cycle= 1 E= -75.3111334513161  delta_E= -0.507  |g|= 0.249  |ddm|=  1.5
HOMO (B2u) = -0.383724747851053  LUMO (B3u) = -0.067227518857359
cycle= 2 E= -75.3357364104634  delta_E= -0.0246  |g|= 0.0507  |ddm|= 0.351
HOMO (B2u) = -0.347026718276072  LUMO (B3u) = -0.0257227421999463
cycle= 3 E= -75.337165289928  delta_E= -0.00143  |g|= 0.0181  |ddm|= 0.0673
HOMO (B2u) = -0.351526070447291  LUMO (B3u) = -0.0301077062023741
cycle= 4 E= -75.3373878233178  delta_E= -0.000223  |g|= 0.000675  |ddm|= 0.0372
HOMO (B2u) = -0.351660112314435  LUMO (B3u) = -0.0303898359337078
cycle= 5 E= -75.3373879985294  delta_E= -1.75e-07  |g|= 0.000102  |ddm|= 0.000975
HOMO (B2u) = -0.351623840121639  LUMO (B3u) = -0.0303555719623981
cycle= 6 E= -75.3373880044287  delta_E= -5.9e-09  |g|= 1.61e-05  |ddm|= 0.000173
HOMO (B2u) = -0.351621725064421  LUMO (B3u) = -0.0303564386936791
cycle= 7 E= -75.3373880045927  delta_E= -1.64e-10  |g|= 1.94e-06  |ddm|= 3.52e-05
HOMO (B2u) = -0.351621087023881  LUMO (B3u) = -0.0303561953012279
cycle= 8 E= -75.3373880045952  delta_E= -2.53e-12  |g|= 1.2e-07  |ddm|= 4.09e-06
HOMO (B2u) = -0.351621096027807  LUMO (B3u) = -0.030356199652214
cycle= 9 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 7.3e-09  |ddm|= 2.5e-07
HOMO (B2u) = -0.351621096338593  LUMO (B3u) = -0.0303562016425016
cycle= 10 E= -75.3373880045951  delta_E= 7.11e-14  |g|= 5.48e-09  |ddm|= 7.67e-09
HOMO (B2u) = -0.351621096127891  LUMO (B3u) = -0.0303562014177533
cycle= 11 E= -75.3373880045952  delta_E= -4.26e-14  |g|= 4.19e-09  |ddm|= 4.34e-09
HOMO (B2u) = -0.351621094785798  LUMO (B3u) = -0.03035620001099
cycle= 12 E= -75.3373880045951  delta_E= 2.84e-14  |g|= 3.79e-09  |ddm|= 2e-09
HOMO (B2u) = -0.351621095168576  LUMO (B3u) = -0.0303562003840066
cycle= 13 E= -75.3373880045952  delta_E= -5.68e-14  |g|= 3.4e-09  |ddm|= 1.22e-09
HOMO (B2u) = -0.351621095129747  LUMO (B3u) = -0.0303562003622074
cycle= 14 E= -75.3373880045952  delta_E= 1.42e-14  |g|= 3.04e-09  |ddm|= 6.93e-10
HOMO (B2u) = -0.35162109493199  LUMO (B3u) = -0.0303562001382397
cycle= 15 E= -75.3373880045952  delta_E=    0  |g|= 7.9e-10  |ddm|= 4.8e-09
HOMO (B2u) = -0.351621094828816  LUMO (B3u) = -0.0303562001338223
cycle= 16 E= -75.3373880045952  delta_E= -4.26e-14  |g|= 8.05e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.351621094865882  LUMO (B3u) = -0.0303562001249448
cycle= 17 E= -75.3373880045952  delta_E=    0  |g|= 8.23e-10  |ddm|= 8.23e-10
HOMO (B2u) = -0.351621094843539  LUMO (B3u) = -0.0303562001008966
cycle= 18 E= -75.3373880045952  delta_E= 5.68e-14  |g|= 6.29e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.351621094849327  LUMO (B3u) = -0.03035620011106
cycle= 19 E= -75.3373880045952  delta_E= 1.42e-14  |g|= 5.5e-10  |ddm|= 3.07e-10
HOMO (B2u) = -0.351621094856914  LUMO (B3u) = -0.0303562001220187
cycle= 20 E= -75.3373880045952  delta_E= -8.53e-14  |g|= 4.68e-10  |ddm|= 2.06e-10
HOMO (B2u) = -0.351621094850131  LUMO (B3u) = -0.0303562001157027
cycle= 21 E= -75.3373880045952  delta_E= 7.11e-14  |g|= 3.7e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.351621094847086  LUMO (B3u) = -0.0303562001145443
cycle= 22 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 2.74e-10  |ddm|= 1.96e-10
HOMO (B2u) = -0.351621094844433  LUMO (B3u) = -0.0303562001131822
cycle= 23 E= -75.3373880045952  delta_E= -1.42e-14  |g|= 1.83e-10  |ddm|= 1.88e-10
HOMO (B2u) = -0.351621094838944  LUMO (B3u) = -0.030356200110353
cycle= 24 E= -75.3373880045953  delta_E= -7.11e-14  |g|= 1.61e-10  |ddm|= 6.43e-11
HOMO (B2u) = -0.351621094838498  LUMO (B3u) = -0.0303562001084873
cycle= 25 E= -75.3373880045951  delta_E= 1.42e-13  |g|= 1.36e-10  |ddm|= 5.73e-11
HOMO (B2u) = -0.351621094836491  LUMO (B3u) = -0.0303562001067934
cycle= 26 E= -75.3373880045953  delta_E= -1.14e-13  |g|= 1.12e-10  |ddm|= 5.33e-11
HOMO (B2u) = -0.351621094834666  LUMO (B3u) = -0.0303562001053159
cycle= 27 E= -75.3373880045952  delta_E= 7.11e-14  |g|= 9.57e-11  |ddm|= 4.01e-11
HOMO (B2u) = -0.35162109483317  LUMO (B3u) = -0.030356200104048
cycle= 28 E= -75.3373880045952  delta_E= -4.26e-14  |g|= 7.84e-11  |ddm|= 3.82e-11
HOMO (B2u) = -0.351621094832069  LUMO (B3u) = -0.0303562001031023
cycle= 29 E= -75.3373880045952  delta_E=    0  |g|= 6.26e-11  |ddm|= 3.43e-11
HOMO (B2u) = -0.351621094829196  LUMO (B3u) = -0.030356200100629
Extra cycle  E= -75.3373880045951  delta_E= 8.53e-14  |g|= 2.36e-11  |ddm|= 8.58e-11
converged SCF energy = -75.3373880045951

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpd8tyl57m
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4523708352865  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4654802673703  dE = -0.013109432  S^2 = 0.0000000
               |grad[o]|=0.0884  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4766184169952  dE = -0.01113815  S^2 = 0.0000000
               |grad[o]|=0.0759  |ddm|=0.0715  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4854060650799  dE = -0.0087876481  S^2 = 0.0000000
               |grad[o]|=0.0617  |ddm|=0.0413  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4919732081452  dE = -0.0065671431  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.048  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4965052075505  dE = -0.0045319994  S^2 = 0.0000000
               |grad[o]|=0.0318  |ddm|=0.0653  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4980364476492  dE = -0.0015312401  S^2 = 0.0000000
               |grad[o]|=0.0142  |ddm|=0.0476  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4983508478317  dE = -0.00031440018  S^2 = 0.0000000
               |grad[o]|=0.00565  |ddm|=0.0316  |maxRot[o]|=0.0358
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4983917552916  dE = -4.090746e-05  S^2 = 0.0000000
               |grad[o]|=0.0021  |ddm|=0.0103  |maxRot[o]|=0.0138
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4983962080756  dE = -4.4527839e-06  S^2 = 0.0000000
               |grad[o]|=0.000736  |ddm|=0.0033  |maxRot[o]|=0.00467
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4983966685693  dE = -4.6049375e-07  S^2 = 0.0000000
               |grad[o]|=0.000246  |ddm|=0.00107  |maxRot[o]|=0.00151
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4983967154179  dE = -4.6848612e-08  S^2 = 0.0000000
               |grad[o]|=7.99e-05  |ddm|=0.000342  |maxRot[o]|=0.000483
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4983967201882  dE = -4.7702429e-09  S^2 = 0.0000000
               |grad[o]|=2.57e-05  |ddm|=0.000109  |maxRot[o]|=0.000155
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4983967206664  dE = -4.7818105e-10  S^2 = 0.0000000
               |grad[o]|=8.2e-06  |ddm|=3.47e-05  |maxRot[o]|=4.91e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4983967207138  dE = -4.73932e-11  S^2 = 0.0000000
               |grad[o]|=2.59e-06  |ddm|=1.1e-05  |maxRot[o]|=1.54e-05
2-step CASSCF converged in 14 macro (57 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96168427 1.92995961 1.89788677 1.80319402 0.07495279 0.20294448
 0.05842681 0.07095125]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01086   0.00993  -0.00483   0.00000   0.00000
  0 C 2s       0.63886   0.65282  -0.30204  -0.00000  -0.00000
  0 C 3s      -0.01519   0.01695  -0.04490  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69411
  0 C 2py      0.00000  -0.00000  -0.00000   0.70440   0.00000
  0 C 2pz      0.30069  -0.27056   0.63672  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.05943
  0 C 3py      0.00000  -0.00000  -0.00000   0.05007   0.00000
  0 C 3pz     -0.01863  -0.00220   0.00482  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03622   0.00000
  0 C 3dz^2    0.02743  -0.01357   0.03519  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.12113
 0 C 3dx2-y2  -0.00059   0.00688  -0.00742  -0.00000  -0.00000
  1 C 1s       0.01086  -0.00993  -0.00483   0.00000   0.00000
  1 C 2s       0.63886  -0.65282  -0.30204   0.00000  -0.00000
  1 C 3s      -0.01519  -0.01695  -0.04490   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69411
  1 C 2py     -0.00000   0.00000   0.00000   0.70440  -0.00000
  1 C 2pz     -0.30069  -0.27056  -0.63672  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.05943
  1 C 3py     -0.00000   0.00000   0.00000   0.05007  -0.00000
  1 C 3pz      0.01863  -0.00220  -0.00482  -0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03622   0.00000
  1 C 3dz^2    0.02743   0.01357   0.03519   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12113
 1 C 3dx2-y2  -0.00059  -0.00688  -0.00742   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00043
  0 C 2s      -0.00000  -0.00000   0.26907
  0 C 3s      -0.00000  -0.00000   0.03634
  0 C 2px      0.00000   0.69753  -0.00000
  0 C 2py      0.70681   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.65078
  0 C 3px      0.00000  -0.00334  -0.00000
  0 C 3py     -0.01665   0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04624
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01219   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00964
  0 C 3dxz     0.00000  -0.11596  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02324
  1 C 1s       0.00000   0.00000   0.00043
  1 C 2s       0.00000  -0.00000  -0.26907
  1 C 3s       0.00000   0.00000  -0.03634
  1 C 2px      0.00000  -0.69753   0.00000
  1 C 2py     -0.70681  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.65078
  1 C 3px     -0.00000   0.00334   0.00000
  1 C 3py      0.01665  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04624
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.01219   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00964
  1 C 3dxz     0.00000  -0.11596  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02324
<CAS-nat-orb|mo-hf>  3  3    0.99623595
<CAS-nat-orb|mo-hf>  4  4    0.99972951
<CAS-nat-orb|mo-hf>  5  5    0.99625438
<CAS-nat-orb|mo-hf>  6  6    0.99910667
<CAS-nat-orb|mo-hf>  7  7    0.93825029
<CAS-nat-orb|mo-hf>  8  8    0.97590449
<CAS-nat-orb|mo-hf>  9  9    0.95945853
<CAS-nat-orb|mo-hf>  10  10    0.89805646
<CAS-nat-orb|mo-hf>  10  11   -0.41828627
CASSCF energy = -75.4983967207138
CASCI E = -75.4983967207138  E(CI) = -15.4874144112172  S^2 = 0.0000000
......production of RDMs took       2.06 sec
......reading the RDM took          0.41 sec
......production of RDMs took      22.80 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickICMRREPT2-ijrs) =    -0.00026759609215
E(WickICMRREPT2- rsi) =    -0.00085371795363
E(WickICMRREPT2- ijr) =    -0.00026134735487
E(WickICMRREPT2-  rs) =    -0.05068064560239
E(WickICMRREPT2-  ij) =    -0.00007233494726
E(WickICMRREPT2-  ir) =    -0.00108335310280
E(WickICMRREPT2-   r) =    -0.06775204661817
E(WickICMRREPT2-   i) =    -0.00008065521738
E(WickICMRREPT2) = -75.61944841760241  E_corr_pt = -0.1210516968886577
Timings = pdms =   35.04 | eris =    0.17 | ijrs =    1.24 | rsi =   40.35 | ijr =    0.71 | rs =  622.21 | ij =    1.31 | ir =   31.59 | r =  143.57 | i =    2.29 | total =  878.55
Time cost =    932.287
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 00:40:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.825661377674 AA    0.000000000000   0.000000000000   3.450000000000 Bohr   0.0

nuclear repulsion = 10.4347826086957
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.725]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    503890.55


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpoz80a8kp
max_memory 4000 MB (current use 401 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7871059587891

WARN: Singularity detected in overlap matrix (condition number =  114). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.119977421491999  LUMO (B3u) = -0.119977421491999

WARN: B2u HOMO -0.119977421491999 > system LUMO -0.119977421491999

cycle= 1 E= -75.3032347208422  delta_E= -0.516  |g|= 0.247  |ddm|=  1.5
HOMO (B2u) = -0.379319419622633  LUMO (B3u) = -0.0646054692258399
cycle= 2 E= -75.327444504769  delta_E= -0.0242  |g|= 0.0501  |ddm|= 0.35
HOMO (B2u) = -0.343173022356373  LUMO (B3u) = -0.0236834315639867
cycle= 3 E= -75.3288571081841  delta_E= -0.00141  |g|= 0.018  |ddm|= 0.0664
HOMO (B2u) = -0.347657119428849  LUMO (B3u) = -0.0280415501187839
cycle= 4 E= -75.3290795920014  delta_E= -0.000222  |g|= 0.00067  |ddm|= 0.0369
HOMO (B2u) = -0.347805946692312  LUMO (B3u) = -0.0283390207305987
cycle= 5 E= -75.3290797635007  delta_E= -1.71e-07  |g|= 0.000106  |ddm|= 0.000935
HOMO (B2u) = -0.347769025805503  LUMO (B3u) = -0.0283049912511369
cycle= 6 E= -75.3290797699135  delta_E= -6.41e-09  |g|= 1.65e-05  |ddm|= 0.000181
HOMO (B2u) = -0.347766788756665  LUMO (B3u) = -0.0283057158319158
cycle= 7 E= -75.3290797700874  delta_E= -1.74e-10  |g|= 1.94e-06  |ddm|= 3.58e-05
HOMO (B2u) = -0.34776617940693  LUMO (B3u) = -0.028305511520523
cycle= 8 E= -75.3290797700899  delta_E= -2.42e-12  |g|= 1.22e-07  |ddm|= 4.05e-06
HOMO (B2u) = -0.347766186617924  LUMO (B3u) = -0.0283055139495655
cycle= 9 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 7.66e-09  |ddm|= 2.61e-07
HOMO (B2u) = -0.34776618675538  LUMO (B3u) = -0.0283055158163402
cycle= 10 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 5.89e-09  |ddm|= 7.8e-09
HOMO (B2u) = -0.347766186551778  LUMO (B3u) = -0.0283055156111084
cycle= 11 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 4.4e-09  |ddm|= 4.61e-09
HOMO (B2u) = -0.347766185193077  LUMO (B3u) = -0.0283055141901285
cycle= 12 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 3.94e-09  |ddm|= 2.13e-09
HOMO (B2u) = -0.347766185565811  LUMO (B3u) = -0.028305514556836
cycle= 13 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 3.55e-09  |ddm|= 1.35e-09
HOMO (B2u) = -0.347766185498201  LUMO (B3u) = -0.0283055145012043
cycle= 14 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 3.06e-09  |ddm|= 9.45e-10
HOMO (B2u) = -0.347766185312396  LUMO (B3u) = -0.0283055143169219
cycle= 15 E= -75.3290797700899  delta_E= -8.53e-14  |g|= 8.69e-10  |ddm|= 5.07e-09
HOMO (B2u) = -0.347766185215031  LUMO (B3u) = -0.0283055143062289
cycle= 16 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 8.64e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.347766185241436  LUMO (B3u) = -0.0283055142975004
cycle= 17 E= -75.3290797700899  delta_E= -2.84e-14  |g|= 8.92e-10  |ddm|= 6.41e-10
HOMO (B2u) = -0.347766185214594  LUMO (B3u) = -0.0283055142721273
cycle= 18 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 6.84e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.347766185217298  LUMO (B3u) = -0.0283055142807008
cycle= 19 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 5.83e-10  |ddm|= 3.65e-10
HOMO (B2u) = -0.347766185222217  LUMO (B3u) = -0.0283055142902905
cycle= 20 E= -75.3290797700898  delta_E= 4.26e-14  |g|= 4.91e-10  |ddm|= 2.5e-10
HOMO (B2u) = -0.347766185212765  LUMO (B3u) = -0.0283055142825381
cycle= 21 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 3.87e-10  |ddm|= 2.35e-10
HOMO (B2u) = -0.347766185207211  LUMO (B3u) = -0.0283055142799899
cycle= 22 E= -75.3290797700898  delta_E=    0  |g|= 2.84e-10  |ddm|= 2.23e-10
HOMO (B2u) = -0.347766185201985  LUMO (B3u) = -0.0283055142773424
cycle= 23 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 1.94e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.347766185195907  LUMO (B3u) = -0.028305514274299
cycle= 24 E= -75.3290797700898  delta_E= -1.42e-14  |g|= 1.7e-10  |ddm|= 7.07e-11
HOMO (B2u) = -0.347766185194315  LUMO (B3u) = -0.0283055142721255
cycle= 25 E= -75.3290797700899  delta_E= -1.42e-14  |g|= 1.43e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.347766185191542  LUMO (B3u) = -0.0283055142701079
cycle= 26 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 1.17e-10  |ddm|= 6.3e-11
HOMO (B2u) = -0.347766185189158  LUMO (B3u) = -0.0283055142684061
cycle= 27 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 9.89e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.347766185187195  LUMO (B3u) = -0.0283055142669598
cycle= 28 E= -75.3290797700899  delta_E= -7.11e-14  |g|= 8.06e-11  |ddm|= 4.27e-11
HOMO (B2u) = -0.347766185185697  LUMO (B3u) = -0.0283055142658655
cycle= 29 E= -75.3290797700899  delta_E= 1.42e-14  |g|= 6.42e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.347766185184401  LUMO (B3u) = -0.0283055142649287
cycle= 30 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 5.09e-11  |ddm|= 3.01e-11
HOMO (B2u) = -0.34776618518342  LUMO (B3u) = -0.0283055142642296
cycle= 31 E= -75.3290797700898  delta_E=    0  |g|= 4.1e-11  |ddm|= 2.24e-11
HOMO (B2u) = -0.347766185181001  LUMO (B3u) = -0.0283055142624356
Extra cycle  E= -75.3290797700899  delta_E= -5.68e-14  |g|= 1.54e-11  |ddm|= 5.87e-11
converged SCF energy = -75.3290797700899

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpoz80a8kp
max_memory 4000 MB (current use 410 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4482666492426  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4618049986756  dE = -0.013538349  S^2 = 0.0000000
               |grad[o]|=0.0903  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4731372408998  dE = -0.011332242  S^2 = 0.0000000
               |grad[o]|=0.0766  |ddm|=0.0762  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4818347664716  dE = -0.0086975256  S^2 = 0.0000000
               |grad[o]|=0.0609  |ddm|=0.0424  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4881398056716  dE = -0.0063050392  S^2 = 0.0000000
               |grad[o]|=0.0447  |ddm|=0.0518  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4917456919723  dE = -0.0036058863  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.0696  |maxRot[o]|= 0.06
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4932311762278  dE = -0.0014854843  S^2 = 0.0000000
               |grad[o]|=0.014  |ddm|=0.0391  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4935071628879  dE = -0.00027598666  S^2 = 0.0000000
               |grad[o]|=0.00522  |ddm|=0.0263  |maxRot[o]|=0.034
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4935391201178  dE = -3.195723e-05  S^2 = 0.0000000
               |grad[o]|=0.00188  |ddm|=0.00869  |maxRot[o]|=0.0124
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4935423354117  dE = -3.2152939e-06  S^2 = 0.0000000
               |grad[o]|=0.000641  |ddm|=0.00271  |maxRot[o]|=0.004
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4935426466093  dE = -3.1119752e-07  S^2 = 0.0000000
               |grad[o]|=0.000207  |ddm|=0.000854  |maxRot[o]|=0.00125
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4935426764193  dE = -2.9809996e-08  S^2 = 0.0000000
               |grad[o]|=6.54e-05  |ddm|=0.000266  |maxRot[o]|=0.000388
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4935426792613  dE = -2.8420146e-09  S^2 = 0.0000000
               |grad[o]|=2.04e-05  |ddm|=8.28e-05  |maxRot[o]|=0.00012
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4935426795292  dE = -2.6790303e-10  S^2 = 0.0000000
               |grad[o]|=6.32e-06  |ddm|=2.56e-05  |maxRot[o]|=3.72e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4935426795536  dE = -2.4385827e-11  S^2 = 0.0000000
               |grad[o]|=1.96e-06  |ddm|=7.9e-06  |maxRot[o]|=1.15e-05
2-step CASSCF converged in 14 macro (56 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96070609 1.93062246 1.89534328 1.79161505 0.07330624 0.21443249
 0.05813181 0.07584257]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01111   0.01003  -0.00449   0.00000   0.00000
  0 C 2s       0.64834   0.65619  -0.28117   0.00000   0.00000
  0 C 3s      -0.01251   0.01666  -0.04312  -0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69393
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439   0.00000
  0 C 2pz      0.28005  -0.26233   0.64632  -0.00000   0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06065
  0 C 3py      0.00000  -0.00000   0.00000   0.05111   0.00000
  0 C 3pz     -0.01714  -0.00207   0.00620  -0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.03500   0.00000
  0 C 3dz^2    0.02561  -0.01317   0.03529  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.12160
 0 C 3dx2-y2  -0.00030   0.00676  -0.00739   0.00000   0.00000
  1 C 1s       0.01111  -0.01003  -0.00449   0.00000   0.00000
  1 C 2s       0.64834  -0.65619  -0.28117   0.00000   0.00000
  1 C 3s      -0.01251  -0.01666  -0.04312   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69393
  1 C 2py     -0.00000   0.00000  -0.00000   0.70439  -0.00000
  1 C 2pz     -0.28005  -0.26233  -0.64632   0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000  -0.06065
  1 C 3py     -0.00000   0.00000   0.00000   0.05111  -0.00000
  1 C 3pz      0.01714  -0.00207  -0.00620  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03500   0.00000
  1 C 3dz^2    0.02561   0.01317   0.03529   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12160
 1 C 3dx2-y2  -0.00030  -0.00676  -0.00739  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s       0.00000   0.00000   0.26097
  0 C 3s      -0.00000   0.00000   0.03534
  0 C 2px     -0.00000   0.69766   0.00000
  0 C 2py      0.70686  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.65436
  0 C 3px     -0.00000  -0.00539  -0.00000
  0 C 3py     -0.01459  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04356
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01176  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00868
  0 C 3dxz    -0.00000  -0.11509   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02209
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.26097
  1 C 3s       0.00000  -0.00000  -0.03534
  1 C 2px      0.00000  -0.69766   0.00000
  1 C 2py     -0.70686   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.65436
  1 C 3px      0.00000   0.00539  -0.00000
  1 C 3py      0.01459   0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04356
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01176  -0.00000   0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00868
  1 C 3dxz    -0.00000  -0.11509   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02209
<CAS-nat-orb|mo-hf>  3  3    0.99779512
<CAS-nat-orb|mo-hf>  4  4    0.99972139
<CAS-nat-orb|mo-hf>  5  5    0.99781371
<CAS-nat-orb|mo-hf>  6  6    0.99905368
<CAS-nat-orb|mo-hf>  7  7    0.93724395
<CAS-nat-orb|mo-hf>  8  8    0.97733329
<CAS-nat-orb|mo-hf>  9  9    0.95969121
<CAS-nat-orb|mo-hf>  10  10    0.90788563
CASSCF energy = -75.4935426795536
CASCI E = -75.4935426795536  E(CI) = -15.4144875345159  S^2 = 0.0000000
......production of RDMs took       2.01 sec
......reading the RDM took          0.43 sec
......production of RDMs took      27.44 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.69 sec

E(WickICMRREPT2-ijrs) =    -0.00026857007579
E(WickICMRREPT2- rsi) =    -0.00085457407092
E(WickICMRREPT2- ijr) =    -0.00025908828376
E(WickICMRREPT2-  rs) =    -0.05044841214500
E(WickICMRREPT2-  ij) =    -0.00006981256269
E(WickICMRREPT2-  ir) =    -0.00107540054692
E(WickICMRREPT2-   r) =    -0.06828717711788
E(WickICMRREPT2-   i) =    -0.00007682378892
E(WickICMRREPT2) = -75.61488253814542  E_corr_pt = -0.1213398585918664
Timings = pdms =   39.56 | eris =    0.07 | ijrs =    1.15 | rsi =   35.06 | ijr =    0.43 | rs =  725.51 | ij =    1.25 | ir =   25.83 | r =  170.53 | i =    2.92 | total = 1002.38
Time cost =   1101.533
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 00:58:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.852120238220 AA    0.000000000000   0.000000000000   3.500000000000 Bohr   0.0

nuclear repulsion = 10.2857142857143
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.75]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    520431.93


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmptnuk3oy2
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.770995471526

WARN: Singularity detected in overlap matrix (condition number =  106). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.116499456302711  LUMO (B3u) = -0.116499456302711

WARN: B2u HOMO -0.116499456302711 > system LUMO -0.116499456302711

cycle= 1 E= -75.2953428985397  delta_E= -0.524  |g|= 0.245  |ddm|= 1.49
HOMO (B2u) = -0.37505850535551  LUMO (B3u) = -0.0620673626538274
cycle= 2 E= -75.3191698853078  delta_E= -0.0238  |g|= 0.0495  |ddm|= 0.35
HOMO (B2u) = -0.339451307241011  LUMO (B3u) = -0.0217153065240375
cycle= 3 E= -75.3205643325183  delta_E= -0.00139  |g|= 0.0179  |ddm|= 0.0655
HOMO (B2u) = -0.343918314413037  LUMO (B3u) = -0.0260457604373102
cycle= 4 E= -75.320786165773  delta_E= -0.000222  |g|= 0.000666  |ddm|= 0.0365
HOMO (B2u) = -0.3440782287532  LUMO (B3u) = -0.0263545301612738
cycle= 5 E= -75.3207863342661  delta_E= -1.68e-07  |g|= 0.00011  |ddm|= 0.000905
HOMO (B2u) = -0.344040928123837  LUMO (B3u) = -0.0263210064987883
cycle= 6 E= -75.3207863411989  delta_E= -6.93e-09  |g|= 1.7e-05  |ddm|= 0.000188
HOMO (B2u) = -0.344038581299418  LUMO (B3u) = -0.0263216091209601
cycle= 7 E= -75.3207863413827  delta_E= -1.84e-10  |g|= 1.93e-06  |ddm|= 3.63e-05
HOMO (B2u) = -0.344037999604799  LUMO (B3u) = -0.0263214409572645
cycle= 8 E= -75.3207863413851  delta_E= -2.39e-12  |g|= 1.24e-07  |ddm|= 4.02e-06
HOMO (B2u) = -0.344038005467488  LUMO (B3u) = -0.0263214419458977
cycle= 9 E= -75.3207863413851  delta_E= -2.84e-14  |g|= 8.04e-09  |ddm|= 2.72e-07
HOMO (B2u) = -0.344038005446366  LUMO (B3u) = -0.0263214437127052
cycle= 10 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 6.27e-09  |ddm|= 7.9e-09
HOMO (B2u) = -0.344038005261108  LUMO (B3u) = -0.0263214435395075
cycle= 11 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 4.62e-09  |ddm|= 4.93e-09
HOMO (B2u) = -0.344038003880574  LUMO (B3u) = -0.0263214420965279
cycle= 12 E= -75.3207863413852  delta_E= -8.53e-14  |g|= 4.1e-09  |ddm|= 2.25e-09
HOMO (B2u) = -0.344038004235195  LUMO (B3u) = -0.0263214424504238
cycle= 13 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 3.69e-09  |ddm|= 1.48e-09
HOMO (B2u) = -0.344038004143394  LUMO (B3u) = -0.0263214423662423
cycle= 14 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 3.11e-09  |ddm|= 1.26e-09
HOMO (B2u) = -0.344038003955596  LUMO (B3u) = -0.0263214422137597
cycle= 15 E= -75.3207863413852  delta_E=    0  |g|= 9.32e-10  |ddm|= 5.21e-09
HOMO (B2u) = -0.344038003857385  LUMO (B3u) = -0.0263214422031295
cycle= 16 E= -75.3207863413852  delta_E=    0  |g|= 9.06e-10  |ddm|= 1.22e-09
HOMO (B2u) = -0.344038003889554  LUMO (B3u) = -0.0263214421914238
cycle= 17 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 9.62e-10  |ddm|= 8.35e-10
HOMO (B2u) = -0.344038003858838  LUMO (B3u) = -0.0263214421653457
cycle= 18 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 7.38e-10  |ddm|= 5.28e-10
HOMO (B2u) = -0.344038003858858  LUMO (B3u) = -0.0263214421727715
cycle= 19 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 6.18e-10  |ddm|= 4.2e-10
HOMO (B2u) = -0.344038003861638  LUMO (B3u) = -0.0263214421815383
cycle= 20 E= -75.3207863413852  delta_E=    0  |g|= 5.16e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.344038003849861  LUMO (B3u) = -0.0263214421727818
cycle= 21 E= -75.3207863413852  delta_E=    0  |g|= 4.05e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.34403800384207  LUMO (B3u) = -0.0263214421691247
cycle= 22 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 2.96e-10  |ddm|= 2.48e-10
HOMO (B2u) = -0.344038003834593  LUMO (B3u) = -0.026321442165508
cycle= 23 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 2.07e-10  |ddm|= 2.11e-10
HOMO (B2u) = -0.344038003828344  LUMO (B3u) = -0.0263214421623578
cycle= 24 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 1.8e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.344038003826413  LUMO (B3u) = -0.0263214421599146
cycle= 25 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 1.51e-10  |ddm|= 6.72e-11
HOMO (B2u) = -0.344038003822987  LUMO (B3u) = -0.0263214421576404
cycle= 26 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 1.23e-10  |ddm|= 7.21e-11
HOMO (B2u) = -0.344038003820139  LUMO (B3u) = -0.0263214421557627
cycle= 27 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 1.03e-10  |ddm|= 5.5e-11
HOMO (B2u) = -0.344038003817796  LUMO (B3u) = -0.026321442154178
cycle= 28 E= -75.3207863413851  delta_E=    0  |g|= 8.35e-11  |ddm|= 4.72e-11
HOMO (B2u) = -0.344038003811892  LUMO (B3u) = -0.0263214421502361
Extra cycle  E= -75.3207863413851  delta_E= -2.84e-14  |g|= 3.04e-11  |ddm|= 1.26e-10
converged SCF energy = -75.3207863413851

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmptnuk3oy2
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4441902032779  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.458166401881  dE = -0.013976199  S^2 = 0.0000000
               |grad[o]|=0.0923  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.469681920907  dE = -0.011515519  S^2 = 0.0000000
               |grad[o]|=0.0772  |ddm|=0.0811  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4782645461794  dE = -0.0085826253  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.0433  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4842992499734  dE = -0.0060347038  S^2 = 0.0000000
               |grad[o]|=0.0424  |ddm|=0.0579  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4876547162062  dE = -0.0033554662  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.0727  |maxRot[o]|=0.0598
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4884265086878  dE = -0.00077179248  S^2 = 0.0000000
               |grad[o]|=0.0102  |ddm|=0.0385  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4887230889616  dE = -0.00029658027  S^2 = 0.0000000
               |grad[o]|=0.00537  |ddm|=0.0131  |maxRot[o]|=0.0351
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4887546373467  dE = -3.1548385e-05  S^2 = 0.0000000
               |grad[o]|=0.00189  |ddm|=0.0083  |maxRot[o]|=0.0124
macro iter 9 (3 JK  0 micro), CASSCF E = -75.488757631922  dE = -2.9945753e-06  S^2 = 0.0000000
               |grad[o]|=0.000634  |ddm|=0.00254  |maxRot[o]|=0.00388
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4887579066453  dE = -2.7472328e-07  S^2 = 0.0000000
               |grad[o]|=0.000199  |ddm|=0.000782  |maxRot[o]|=0.00118
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4887579316397  dE = -2.4994421e-08  S^2 = 0.0000000
               |grad[o]|=6.16e-05  |ddm|=0.000238  |maxRot[o]|=0.000357
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4887579338977  dE = -2.2579911e-09  S^2 = 0.0000000
               |grad[o]|=1.87e-05  |ddm|=7.12e-05  |maxRot[o]|=0.000108
macro iter 13 (2 JK  0 micro), CASSCF E = -75.488757934101  dE = -2.0327207e-10  S^2 = 0.0000000
               |grad[o]|=5.64e-06  |ddm|=2.16e-05  |maxRot[o]|=3.22e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4887579341157  dE = -1.4750867e-11  S^2 = 0.0000000
               |grad[o]|=1.72e-06  |ddm|=6.52e-06  |maxRot[o]|=9.79e-06
2-step CASSCF converged in 14 macro (55 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95981388 1.93127285 1.8922826  1.77943942 0.07180263 0.22650183
 0.05783615 0.08105064]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01133   0.01013  -0.00414   0.00000   0.00000
  0 C 2s       0.65705   0.65938  -0.26022  -0.00000  -0.00000
  0 C 3s      -0.00998   0.01639  -0.04128   0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69378
  0 C 2py     -0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.25932  -0.25424   0.65514  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06179
  0 C 3py     -0.00000   0.00000   0.00000   0.05203   0.00000
  0 C 3pz     -0.01577  -0.00197   0.00765   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.03378   0.00000
  0 C 3dz^2    0.02382  -0.01278   0.03532  -0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000  -0.12186
 0 C 3dx2-y2  -0.00000   0.00665  -0.00734  -0.00000   0.00000
  1 C 1s       0.01133  -0.01013  -0.00414   0.00000   0.00000
  1 C 2s       0.65705  -0.65938  -0.26022  -0.00000  -0.00000
  1 C 3s      -0.00998  -0.01639  -0.04128   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69378
  1 C 2py     -0.00000   0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.25932  -0.25424  -0.65514  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06179
  1 C 3py      0.00000  -0.00000  -0.00000   0.05203  -0.00000
  1 C 3pz      0.01577  -0.00197  -0.00765  -0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03378   0.00000
  1 C 3dz^2    0.02382   0.01278   0.03532   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12186
 1 C 3dx2-y2  -0.00000  -0.00665  -0.00734  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000  -0.00000   0.25300
  0 C 3s      -0.00000   0.00000   0.03435
  0 C 2px     -0.00000   0.69779  -0.00000
  0 C 2py      0.70690   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.65775
  0 C 3px     -0.00000  -0.00738  -0.00000
  0 C 3py     -0.01256  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.04088
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01132  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00778
  0 C 3dxz    -0.00000  -0.11419   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02095
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s      -0.00000  -0.00000  -0.25300
  1 C 3s       0.00000   0.00000  -0.03435
  1 C 2px      0.00000  -0.69779  -0.00000
  1 C 2py     -0.70690   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.65775
  1 C 3px      0.00000   0.00738   0.00000
  1 C 3py      0.01256   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04088
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01132  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00778
  1 C 3dxz    -0.00000  -0.11419  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02095
<CAS-nat-orb|mo-hf>  3  3    0.99891158
<CAS-nat-orb|mo-hf>  4  4    0.99971276
<CAS-nat-orb|mo-hf>  5  5    0.99892917
<CAS-nat-orb|mo-hf>  6  6    0.99899872
<CAS-nat-orb|mo-hf>  7  7    0.93636098
<CAS-nat-orb|mo-hf>  8  8    0.97867429
<CAS-nat-orb|mo-hf>  9  9    0.95989986
<CAS-nat-orb|mo-hf>  10  10    0.91658565
CASSCF energy = -75.4887579341157
CASCI E = -75.4887579341157  E(CI) = -15.3435702378968  S^2 = 0.0000000
......production of RDMs took       1.93 sec
......reading the RDM took          0.45 sec
......production of RDMs took      31.76 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.81 sec

E(WickICMRREPT2-ijrs) =    -0.00026969703010
E(WickICMRREPT2- rsi) =    -0.00085601936053
E(WickICMRREPT2- ijr) =    -0.00025701566649
E(WickICMRREPT2-  rs) =    -0.05022661922774
E(WickICMRREPT2-  ij) =    -0.00006745707499
E(WickICMRREPT2-  ir) =    -0.00106809917304
E(WickICMRREPT2-   r) =    -0.06881357735795
E(WickICMRREPT2-   i) =    -0.00007320206061
E(WickICMRREPT2) = -75.61038962106716  E_corr_pt = -0.1216316869514451
Timings = pdms =   43.97 | eris =    0.04 | ijrs =    1.19 | rsi =   33.57 | ijr =    0.42 | rs =  677.72 | ij =    1.29 | ir =   36.55 | r =  167.31 | i =    2.35 | total =  964.49
Time cost =   1058.085
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 01:16:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.878579098766 AA    0.000000000000   0.000000000000   3.550000000000 Bohr   0.0

nuclear repulsion = 10.1408450704225
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.775]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    536374.47


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpao4i3kb3
max_memory 4000 MB (current use 401 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.755922874727

WARN: Singularity detected in overlap matrix (condition number = 98.8). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.113183134036076  LUMO (B3u) = -0.113183134036075

WARN: B2u HOMO -0.113183134036076 > system LUMO -0.113183134036075

cycle= 1 E= -75.287473469352  delta_E= -0.532  |g|= 0.242  |ddm|= 1.48
HOMO (B2u) = -0.370939595595207  LUMO (B3u) = -0.0596135835397187
cycle= 2 E= -75.3109303175842  delta_E= -0.0235  |g|= 0.0489  |ddm|= 0.349
HOMO (B2u) = -0.335857476925405  LUMO (B3u) = -0.0198166980956904
cycle= 3 E= -75.3123050204643  delta_E= -0.00137  |g|= 0.0178  |ddm|= 0.0646
HOMO (B2u) = -0.340305747412606  LUMO (B3u) = -0.0241187549333937
cycle= 4 E= -75.3125256665475  delta_E= -0.000221  |g|= 0.000662  |ddm|= 0.0362
HOMO (B2u) = -0.340473004463873  LUMO (B3u) = -0.0244347316795399
cycle= 5 E= -75.3125258326696  delta_E= -1.66e-07  |g|= 0.000114  |ddm|= 0.000883
HOMO (B2u) = -0.340435552234751  LUMO (B3u) = -0.0244019229355921
cycle= 6 E= -75.3125258401168  delta_E= -7.45e-09  |g|= 1.75e-05  |ddm|= 0.000196
HOMO (B2u) = -0.340433109443013  LUMO (B3u) = -0.0244024220699444
cycle= 7 E= -75.3125258403105  delta_E= -1.94e-10  |g|= 1.93e-06  |ddm|= 3.69e-05
HOMO (B2u) = -0.340432553987216  LUMO (B3u) = -0.0244022873481666
cycle= 8 E= -75.3125258403129  delta_E= -2.44e-12  |g|= 1.26e-07  |ddm|= 4e-06
HOMO (B2u) = -0.340432558916786  LUMO (B3u) = -0.0244022873229547
cycle= 9 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 8.38e-09  |ddm|= 2.82e-07
HOMO (B2u) = -0.340432558754945  LUMO (B3u) = -0.0244022890121925
cycle= 10 E= -75.3125258403128  delta_E= 2.84e-14  |g|= 6.6e-09  |ddm|= 7.96e-09
HOMO (B2u) = -0.340432558582021  LUMO (B3u) = -0.0244022888648122
cycle= 11 E= -75.3125258403129  delta_E= -1.14e-13  |g|= 4.82e-09  |ddm|= 5.21e-09
HOMO (B2u) = -0.340432557195551  LUMO (B3u) = -0.02440228741712
cycle= 12 E= -75.3125258403129  delta_E=    0  |g|= 4.25e-09  |ddm|= 2.38e-09
HOMO (B2u) = -0.340432557527021  LUMO (B3u) = -0.0244022877526882
cycle= 13 E= -75.312525840313  delta_E= -8.53e-14  |g|= 3.83e-09  |ddm|= 1.59e-09
HOMO (B2u) = -0.340432557414992  LUMO (B3u) = -0.0244022876441112
cycle= 14 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 3.17e-09  |ddm|= 1.55e-09
HOMO (B2u) = -0.340432557231907  LUMO (B3u) = -0.0244022875215116
cycle= 15 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 9.91e-10  |ddm|= 5.61e-09
HOMO (B2u) = -0.340432557132539  LUMO (B3u) = -0.0244022875080368
cycle= 16 E= -75.312525840313  delta_E= -5.68e-14  |g|= 9.51e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.340432557163293  LUMO (B3u) = -0.024402287495129
cycle= 17 E= -75.3125258403128  delta_E= 1.42e-13  |g|= 1.02e-09  |ddm|= 8.58e-10
HOMO (B2u) = -0.340432557129552  LUMO (B3u) = -0.0244022874689471
cycle= 18 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 7.86e-10  |ddm|= 5.81e-10
HOMO (B2u) = -0.34043255712739  LUMO (B3u) = -0.0244022874756534
cycle= 19 E= -75.3125258403129  delta_E=    0  |g|= 6.48e-10  |ddm|= 4.67e-10
HOMO (B2u) = -0.340432557128446  LUMO (B3u) = -0.0244022874838993
cycle= 20 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 5.37e-10  |ddm|= 3.24e-10
HOMO (B2u) = -0.340432557114878  LUMO (B3u) = -0.0244022874745659
cycle= 21 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 4.2e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.340432557105277  LUMO (B3u) = -0.0244022874701176
cycle= 22 E= -75.3125258403128  delta_E= 1.14e-13  |g|= 3.06e-10  |ddm|= 2.69e-10
HOMO (B2u) = -0.340432557096  LUMO (B3u) = -0.024402287465868
cycle= 23 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 2.17e-10  |ddm|= 2.24e-10
HOMO (B2u) = -0.340432557089278  LUMO (B3u) = -0.024402287462572
cycle= 24 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 1.88e-10  |ddm|= 7.9e-11
HOMO (B2u) = -0.340432557086758  LUMO (B3u) = -0.0244022874599265
cycle= 25 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 1.58e-10  |ddm|= 7.17e-11
HOMO (B2u) = -0.340432557082766  LUMO (B3u) = -0.0244022874574716
cycle= 26 E= -75.3125258403128  delta_E= 2.84e-14  |g|= 1.28e-10  |ddm|= 7.98e-11
HOMO (B2u) = -0.340432557079512  LUMO (B3u) = -0.0244022874554752
cycle= 27 E= -75.3125258403128  delta_E=    0  |g|= 1.06e-10  |ddm|= 6.11e-11
HOMO (B2u) = -0.340432557076832  LUMO (B3u) = -0.0244022874537969
cycle= 28 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 8.57e-11  |ddm|= 5.1e-11
HOMO (B2u) = -0.340432557074738  LUMO (B3u) = -0.0244022874525118
cycle= 29 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 6.8e-11  |ddm|= 4.3e-11
HOMO (B2u) = -0.340432557072979  LUMO (B3u) = -0.02440228745143
cycle= 30 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 5.37e-11  |ddm|= 3.41e-11
HOMO (B2u) = -0.340432557071651  LUMO (B3u) = -0.0244022874506276
cycle= 31 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 4.34e-11  |ddm|= 2.5e-11
HOMO (B2u) = -0.340432557070706  LUMO (B3u) = -0.024402287450046
cycle= 32 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 3.61e-11  |ddm|= 1.76e-11
HOMO (B2u) = -0.340432557069981  LUMO (B3u) = -0.0244022874495549
cycle= 33 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 2.98e-11  |ddm|= 1.53e-11
HOMO (B2u) = -0.340432557069319  LUMO (B3u) = -0.0244022874491422
cycle= 34 E= -75.3125258403129  delta_E=    0  |g|= 2.45e-11  |ddm|= 1.3e-11
HOMO (B2u) = -0.340432557067487  LUMO (B3u) = -0.024402287447961
Extra cycle  E= -75.3125258403129  delta_E= -5.68e-14  |g|= 9.16e-12  |ddm|= 3.62e-11
converged SCF energy = -75.3125258403129

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpao4i3kb3
max_memory 4000 MB (current use 410 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4401587585064  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4545821847277  dE = -0.014423426  S^2 = 0.0000000
               |grad[o]|=0.0942  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4662692480556  dE = -0.011687063  S^2 = 0.0000000
               |grad[o]|=0.0778  |ddm|=0.0861  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4747099542616  dE = -0.0084407062  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.0439  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4804719532827  dE = -0.005761999  S^2 = 0.0000000
               |grad[o]|= 0.04  |ddm|=0.0658  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4831435204833  dE = -0.0026715672  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.0737  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4838239796157  dE = -0.00068045913  S^2 = 0.0000000
               |grad[o]|=0.00925  |ddm|=0.0308  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4840371160353  dE = -0.00021313642  S^2 = 0.0000000
               |grad[o]|=0.00453  |ddm|=0.0109  |maxRot[o]|=0.0304
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4840577811658  dE = -2.0665131e-05  S^2 = 0.0000000
               |grad[o]|=0.00158  |ddm|=0.00643  |maxRot[o]|=0.0101
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4840596355541  dE = -1.8543883e-06  S^2 = 0.0000000
               |grad[o]|=0.000517  |ddm|=0.00195  |maxRot[o]|=0.00307
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4840597983764  dE = -1.6282236e-07  S^2 = 0.0000000
               |grad[o]|=0.000159  |ddm|=0.000592  |maxRot[o]|=0.000913
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4840598125418  dE = -1.4165394e-08  S^2 = 0.0000000
               |grad[o]|=4.79e-05  |ddm|=0.000176  |maxRot[o]|=0.00027
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4840598137744  dE = -1.2326211e-09  S^2 = 0.0000000
               |grad[o]|=1.43e-05  |ddm|=5.21e-05  |maxRot[o]|=7.95e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4840598138813  dE = -1.0689405e-10  S^2 = 0.0000000
               |grad[o]|=4.23e-06  |ddm|=1.54e-05  |maxRot[o]|=2.35e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4840598138906  dE = -9.2370556e-12  S^2 = 0.0000000
               |grad[o]|=1.25e-06  |ddm|=4.55e-06  |maxRot[o]|=6.92e-06
2-step CASSCF converged in 14 macro (55 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95901066 1.93191387 1.88869909 1.76663822 0.07041579 0.23918108
 0.05753793 0.08660336]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01153   0.01022  -0.00378   0.00000   0.00000
  0 C 2s       0.66488   0.66240  -0.23954  -0.00000  -0.00000
  0 C 3s      -0.00763   0.01613  -0.03939  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69368
  0 C 2py      0.00000  -0.00000  -0.00000   0.70438  -0.00000
  0 C 2pz      0.23883  -0.24630   0.66308  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06285
  0 C 3py     -0.00000  -0.00000  -0.00000   0.05282  -0.00000
  0 C 3pz     -0.01454  -0.00188   0.00916  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.00000  -0.00000   0.03256  -0.00000
  0 C 3dz^2    0.02207  -0.01238   0.03528  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.12191
 0 C 3dx2-y2   0.00028   0.00654  -0.00728   0.00000  -0.00000
  1 C 1s       0.01153  -0.01022  -0.00378   0.00000   0.00000
  1 C 2s       0.66488  -0.66240  -0.23954   0.00000   0.00000
  1 C 3s      -0.00763  -0.01613  -0.03939   0.00000   0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69368
  1 C 2py      0.00000  -0.00000   0.00000   0.70438   0.00000
  1 C 2pz     -0.23883  -0.24630  -0.66308   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06285
  1 C 3py     -0.00000   0.00000   0.00000   0.05282   0.00000
  1 C 3pz      0.01454  -0.00188  -0.00916  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03256  -0.00000
  1 C 3dz^2    0.02207   0.01238   0.03528   0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12191
 1 C 3dx2-y2   0.00028  -0.00654  -0.00728   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00035
  0 C 2s      -0.00000  -0.00000   0.24517
  0 C 3s      -0.00000  -0.00000   0.03335
  0 C 2px     -0.00000   0.69791  -0.00000
  0 C 2py      0.70694   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.66096
  0 C 3px      0.00000  -0.00931  -0.00000
  0 C 3py     -0.01055  -0.00000   0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03822
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.01090  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00694
  0 C 3dxz     0.00000  -0.11326  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01984
  1 C 1s       0.00000   0.00000   0.00035
  1 C 2s       0.00000   0.00000  -0.24517
  1 C 3s       0.00000   0.00000  -0.03335
  1 C 2px     -0.00000  -0.69791  -0.00000
  1 C 2py     -0.70694   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.66096
  1 C 3px      0.00000   0.00931   0.00000
  1 C 3py      0.01055  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03822
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01090   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00694
  1 C 3dxz    -0.00000  -0.11326  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01984
<CAS-nat-orb|mo-hf>  3  3    0.99958549
<CAS-nat-orb|mo-hf>  4  4    0.99970353
<CAS-nat-orb|mo-hf>  5  5    0.99960080
<CAS-nat-orb|mo-hf>  6  6    0.99894173
<CAS-nat-orb|mo-hf>  7  7    0.93559187
<CAS-nat-orb|mo-hf>  8  8    0.97993346
<CAS-nat-orb|mo-hf>  9  9    0.96008674
<CAS-nat-orb|mo-hf>  10  10    0.92430540
CASSCF energy = -75.4840598138906
CASCI E = -75.4840598138906  E(CI) = -15.2745978907237  S^2 = 0.0000000
......production of RDMs took       3.44 sec
......reading the RDM took          0.45 sec
......production of RDMs took      23.43 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.67 sec

E(WickICMRREPT2-ijrs) =    -0.00027096410688
E(WickICMRREPT2- rsi) =    -0.00085800384347
E(WickICMRREPT2- ijr) =    -0.00025510582084
E(WickICMRREPT2-  rs) =    -0.05001657305903
E(WickICMRREPT2-  ij) =    -0.00006525709527
E(WickICMRREPT2-  ir) =    -0.00106141445438
E(WickICMRREPT2-   r) =    -0.06932891725519
E(WickICMRREPT2-   i) =    -0.00006977894686
E(WickICMRREPT2) = -75.60598582847248  E_corr_pt = -0.121926014581916
Timings = pdms =   37.01 | eris =    0.09 | ijrs =    1.16 | rsi =   36.31 | ijr =    0.42 | rs =  612.69 | ij =    1.31 | ir =   26.91 | r =  156.18 | i =    2.33 | total =  874.46
Time cost =    936.426
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 01:32:07 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.905037959312 AA    0.000000000000   0.000000000000   3.600000000000 Bohr   0.0

nuclear repulsion = 10
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.8]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    550353.58


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpn7lybgky
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7418315703506

WARN: Singularity detected in overlap matrix (condition number = 92.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.110019881100111  LUMO (B3u) = -0.110019881100111

WARN: B2u HOMO -0.110019881100111 > system LUMO -0.110019881100111

cycle= 1 E= -75.2796395081188  delta_E= -0.538  |g|= 0.24  |ddm|= 1.48
HOMO (B2u) = -0.366960154497  LUMO (B3u) = -0.0572442637655628
cycle= 2 E= -75.3027407260662  delta_E= -0.0231  |g|= 0.0483  |ddm|= 0.349
HOMO (B2u) = -0.332387624443796  LUMO (B3u) = -0.0179860460523913
cycle= 3 E= -75.3040943705399  delta_E= -0.00135  |g|= 0.0177  |ddm|= 0.0637
HOMO (B2u) = -0.336815650622686  LUMO (B3u) = -0.0222589901147906
cycle= 4 E= -75.3043133588737  delta_E= -0.000219  |g|= 0.000659  |ddm|= 0.0358
HOMO (B2u) = -0.336986521904539  LUMO (B3u) = -0.0225780980112816
cycle= 5 E= -75.3043135231658  delta_E= -1.64e-07  |g|= 0.000118  |ddm|= 0.000867
HOMO (B2u) = -0.336949107818829  LUMO (B3u) = -0.0225461573189927
cycle= 6 E= -75.304313531111  delta_E= -7.95e-09  |g|= 1.79e-05  |ddm|= 0.000202
HOMO (B2u) = -0.33694658310042  LUMO (B3u) = -0.0225465689188807
cycle= 7 E= -75.3043135313142  delta_E= -2.03e-10  |g|= 1.93e-06  |ddm|= 3.75e-05
HOMO (B2u) = -0.336946052255895  LUMO (B3u) = -0.0225464651749646
cycle= 8 E= -75.3043135313167  delta_E= -2.44e-12  |g|= 1.28e-07  |ddm|= 3.99e-06
HOMO (B2u) = -0.336946056653755  LUMO (B3u) = -0.0225464645227577
cycle= 9 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 8.63e-09  |ddm|= 2.92e-07
HOMO (B2u) = -0.336946056357138  LUMO (B3u) = -0.022546466142343
cycle= 10 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 6.89e-09  |ddm|= 7.94e-09
HOMO (B2u) = -0.336946056203955  LUMO (B3u) = -0.0225464660272788
cycle= 11 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 5e-09  |ddm|= 5.44e-09
HOMO (B2u) = -0.336946054829913  LUMO (B3u) = -0.0225464645958644
cycle= 12 E= -75.3043135313167  delta_E= 5.68e-14  |g|= 4.37e-09  |ddm|= 2.53e-09
HOMO (B2u) = -0.336946055133865  LUMO (B3u) = -0.022546464907654
cycle= 13 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 3.93e-09  |ddm|= 1.66e-09
HOMO (B2u) = -0.336946055006295  LUMO (B3u) = -0.0225464647808606
cycle= 14 E= -75.3043135313167  delta_E= -7.11e-14  |g|= 3.23e-09  |ddm|= 1.79e-09
HOMO (B2u) = -0.336946054816761  LUMO (B3u) = -0.0225464646819369
cycle= 15 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 1.03e-09  |ddm|= 5.76e-09
HOMO (B2u) = -0.336946054727847  LUMO (B3u) = -0.0225464646683422
cycle= 16 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 9.9e-10  |ddm|= 1.12e-09
HOMO (B2u) = -0.336946054755901  LUMO (B3u) = -0.0225464646547457
cycle= 17 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 1.07e-09  |ddm|= 8.43e-10
HOMO (B2u) = -0.336946054720006  LUMO (B3u) = -0.0225464646290247
cycle= 18 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 8.26e-10  |ddm|= 6.21e-10
HOMO (B2u) = -0.336946054716036  LUMO (B3u) = -0.0225464646352933
cycle= 19 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 6.74e-10  |ddm|= 5.07e-10
HOMO (B2u) = -0.336946054715675  LUMO (B3u) = -0.0225464646432703
cycle= 20 E= -75.3043135313166  delta_E= 9.95e-14  |g|= 5.54e-10  |ddm|= 3.53e-10
HOMO (B2u) = -0.336946054700834  LUMO (B3u) = -0.0225464646338036
cycle= 21 E= -75.3043135313167  delta_E= -7.11e-14  |g|= 4.33e-10  |ddm|= 3.09e-10
HOMO (B2u) = -0.336946054689826  LUMO (B3u) = -0.0225464646289128
cycle= 22 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 3.15e-10  |ddm|= 2.86e-10
HOMO (B2u) = -0.336946054679181  LUMO (B3u) = -0.0225464646243623
cycle= 23 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 2.25e-10  |ddm|= 2.36e-10
HOMO (B2u) = -0.336946054672471  LUMO (B3u) = -0.022546464621034
cycle= 24 E= -75.3043135313167  delta_E= -8.53e-14  |g|= 1.94e-10  |ddm|= 8.13e-11
HOMO (B2u) = -0.336946054669419  LUMO (B3u) = -0.0225464646182627
cycle= 25 E= -75.3043135313167  delta_E= 4.26e-14  |g|= 1.63e-10  |ddm|= 7.56e-11
HOMO (B2u) = -0.336946054664997  LUMO (B3u) = -0.0225464646157145
cycle= 26 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 1.31e-10  |ddm|= 8.6e-11
HOMO (B2u) = -0.336946054661441  LUMO (B3u) = -0.0225464646136675
cycle= 27 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 1.08e-10  |ddm|= 6.61e-11
HOMO (B2u) = -0.336946054658512  LUMO (B3u) = -0.0225464646119496
cycle= 28 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 8.69e-11  |ddm|= 5.41e-11
HOMO (B2u) = -0.336946054656208  LUMO (B3u) = -0.0225464646106273
cycle= 29 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 6.87e-11  |ddm|= 4.51e-11
HOMO (B2u) = -0.336946054654289  LUMO (B3u) = -0.0225464646095219
cycle= 30 E= -75.3043135313166  delta_E= 5.68e-14  |g|= 5.43e-11  |ddm|= 3.56e-11
HOMO (B2u) = -0.336946054652844  LUMO (B3u) = -0.0225464646087044
cycle= 31 E= -75.3043135313167  delta_E= -7.11e-14  |g|= 4.38e-11  |ddm|= 2.6e-11
HOMO (B2u) = -0.336946054651816  LUMO (B3u) = -0.022546464608102
cycle= 32 E= -75.3043135313166  delta_E= 7.11e-14  |g|= 3.63e-11  |ddm|= 1.84e-11
HOMO (B2u) = -0.336946054651005  LUMO (B3u) = -0.0225464646075923
cycle= 33 E= -75.3043135313167  delta_E= -7.11e-14  |g|= 2.98e-11  |ddm|= 1.59e-11
HOMO (B2u) = -0.336946054650274  LUMO (B3u) = -0.0225464646071654
cycle= 34 E= -75.3043135313168  delta_E= -5.68e-14  |g|= 2.45e-11  |ddm|= 1.35e-11
HOMO (B2u) = -0.336946054649686  LUMO (B3u) = -0.0225464646068178
cycle= 35 E= -75.3043135313167  delta_E= 7.11e-14  |g|= 2.01e-11  |ddm|= 1.09e-11
HOMO (B2u) = -0.336946054649202  LUMO (B3u) = -0.0225464646065255
cycle= 36 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 1.63e-11  |ddm|= 8.96e-12
HOMO (B2u) = -0.336946054648812  LUMO (B3u) = -0.0225464646062867
cycle= 37 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 1.33e-11  |ddm|= 7.23e-12
HOMO (B2u) = -0.336946054648503  LUMO (B3u) = -0.0225464646060965
cycle= 38 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 1.08e-11  |ddm|= 5.7e-12
HOMO (B2u) = -0.33694605464826  LUMO (B3u) = -0.0225464646059458
cycle= 39 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 8.91e-12  |ddm|= 4.48e-12
HOMO (B2u) = -0.336946054648067  LUMO (B3u) = -0.0225464646058245
cycle= 40 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 7.37e-12  |ddm|= 3.61e-12
HOMO (B2u) = -0.33694605464791  LUMO (B3u) = -0.0225464646057249
cycle= 41 E= -75.3043135313166  delta_E= 8.53e-14  |g|= 6.08e-12  |ddm|= 2.99e-12
HOMO (B2u) = -0.336946054647781  LUMO (B3u) = -0.0225464646056437
cycle= 42 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 5.01e-12  |ddm|= 2.46e-12
HOMO (B2u) = -0.336946054647677  LUMO (B3u) = -0.0225464646055781
cycle= 43 E= -75.3043135313167  delta_E= -4.26e-14  |g|= 4.13e-12  |ddm|= 2.01e-12
HOMO (B2u) = -0.336946054647593  LUMO (B3u) = -0.0225464646055239
cycle= 44 E= -75.3043135313167  delta_E=    0  |g|= 3.39e-12  |ddm|= 1.65e-12
HOMO (B2u) = -0.336946054647364  LUMO (B3u) = -0.0225464646053748
Extra cycle  E= -75.3043135313167  delta_E= 4.26e-14  |g|= 1.31e-12  |ddm|= 4.63e-12
converged SCF energy = -75.3043135313167

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpn7lybgky
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4361879187432  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4510691607451  dE = -0.014881242  S^2 = 0.0000000
               |grad[o]|=0.0962  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4629145321981  dE = -0.011845371  S^2 = 0.0000000
               |grad[o]|=0.0783  |ddm|=0.0912  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4711866391299  dE = -0.0082721069  S^2 = 0.0000000
               |grad[o]|=0.0578  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4766787942596  dE = -0.0054921551  S^2 = 0.0000000
               |grad[o]|=0.0375  |ddm|=0.075  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4787632077846  dE = -0.0020844135  S^2 = 0.0000000
               |grad[o]|=0.0178  |ddm|=0.0723  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4793231918252  dE = -0.00055998404  S^2 = 0.0000000
               |grad[o]|=0.00799  |ddm|=0.0239  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4794386335787  dE = -0.00011544175  S^2 = 0.0000000
               |grad[o]|=0.00353  |ddm|=0.00914  |maxRot[o]|= 0.02
macro iter 8 (3 JK  0 micro), CASSCF E = -75.479460980122  dE = -2.2346543e-05  S^2 = 0.0000000
               |grad[o]|=0.00158  |ddm|=0.00384  |maxRot[o]|=0.0105
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4794629087142  dE = -1.9285922e-06  S^2 = 0.0000000
               |grad[o]|=0.000536  |ddm|=0.00194  |maxRot[o]|=0.00314
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4794630725591  dE = -1.638449e-07  S^2 = 0.0000000
               |grad[o]|=0.000164  |ddm|=0.000582  |maxRot[o]|=0.000918
macro iter 11 (3 JK  0 micro), CASSCF E = -75.479463086382  dE = -1.3822913e-08  S^2 = 0.0000000
               |grad[o]|=4.88e-05  |ddm|=0.000171  |maxRot[o]|=0.000267
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4794630875463  dE = -1.1642811e-09  S^2 = 0.0000000
               |grad[o]|=1.44e-05  |ddm|=5.01e-05  |maxRot[o]|=7.74e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4794630876436  dE = -9.7315933e-11  S^2 = 0.0000000
               |grad[o]|=4.2e-06  |ddm|=1.46e-05  |maxRot[o]|=2.25e-05
2-step CASSCF converged in 13 macro (52 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95829684 1.93254559 1.88457143 1.75318656 0.06913527 0.2524963
 0.05723697 0.09253104]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01171   0.01031  -0.00343   0.00000   0.00000
  0 C 2s       0.67180   0.66526  -0.21945   0.00000  -0.00000
  0 C 3s      -0.00547   0.01587  -0.03746   0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69361
  0 C 2py      0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.21892  -0.23851   0.67009   0.00000  -0.00000
  0 C 3px      0.00000   0.00000   0.00000   0.00000  -0.06384
  0 C 3py      0.00000   0.00000   0.00000   0.05350  -0.00000
  0 C 3pz     -0.01342  -0.00181   0.01074   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000   0.03134   0.00000
  0 C 3dz^2    0.02038  -0.01199   0.03514   0.00000   0.00000
  0 C 3dxz     0.00000   0.00000   0.00000  -0.00000  -0.12178
 0 C 3dx2-y2   0.00055   0.00643  -0.00721  -0.00000  -0.00000
  1 C 1s       0.01171  -0.01031  -0.00343   0.00000   0.00000
  1 C 2s       0.67180  -0.66526  -0.21945  -0.00000  -0.00000
  1 C 3s      -0.00547  -0.01587  -0.03746  -0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69361
  1 C 2py     -0.00000  -0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.21892  -0.23851  -0.67009   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06384
  1 C 3py     -0.00000  -0.00000  -0.00000   0.05350  -0.00000
  1 C 3pz      0.01342  -0.00181  -0.01074   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.03134   0.00000
  1 C 3dz^2    0.02038   0.01199   0.03514  -0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12178
 1 C 3dx2-y2   0.00055  -0.00643  -0.00721   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00032
  0 C 2s       0.00000  -0.00000   0.23748
  0 C 3s      -0.00000  -0.00000   0.03235
  0 C 2px      0.00000   0.69804  -0.00000
  0 C 2py      0.70698  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.66400
  0 C 3px     -0.00000  -0.01120  -0.00000
  0 C 3py     -0.00856  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03555
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01047  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00616
  0 C 3dxz    -0.00000  -0.11230  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01875
  1 C 1s       0.00000   0.00000   0.00032
  1 C 2s       0.00000  -0.00000  -0.23748
  1 C 3s       0.00000   0.00000  -0.03235
  1 C 2px      0.00000  -0.69804   0.00000
  1 C 2py     -0.70698   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66400
  1 C 3px     -0.00000   0.01120   0.00000
  1 C 3py      0.00856   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03555
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01047  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00616
  1 C 3dxz     0.00000  -0.11230  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01875
<CAS-nat-orb|mo-hf>  3  3    0.99985292
<CAS-nat-orb|mo-hf>  4  4    0.99969360
<CAS-nat-orb|mo-hf>  5  5    0.99986456
<CAS-nat-orb|mo-hf>  6  6    0.99888267
<CAS-nat-orb|mo-hf>  7  7    0.93493366
<CAS-nat-orb|mo-hf>  8  8    0.98111604
<CAS-nat-orb|mo-hf>  9  9    0.96025422
<CAS-nat-orb|mo-hf>  10  10    0.93117477
CASSCF energy = -75.4794630876436
CASCI E = -75.4794630876436  E(CI) = -15.207507530585  S^2 = 0.0000000
......production of RDMs took       1.97 sec
......reading the RDM took          0.42 sec
......production of RDMs took      23.74 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICMRREPT2-ijrs) =    -0.00027235846406
E(WickICMRREPT2- rsi) =    -0.00086047991033
E(WickICMRREPT2- ijr) =    -0.00025333569724
E(WickICMRREPT2-  rs) =    -0.04981930616346
E(WickICMRREPT2-  ij) =    -0.00006320060919
E(WickICMRREPT2-  ir) =    -0.00105531423866
E(WickICMRREPT2-   r) =    -0.06983066515074
E(WickICMRREPT2-   i) =    -0.00006653385675
E(WickICMRREPT2) = -75.60168428173404  E_corr_pt = -0.1222211940904179
Timings = pdms =   35.90 | eris =    0.17 | ijrs =    1.19 | rsi =   34.04 | ijr =    0.41 | rs =  647.91 | ij =    1.39 | ir =   45.85 | r =  180.54 | i =    2.37 | total =  949.83
Time cost =    996.931
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 01:48:44 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.931496819858 AA    0.000000000000   0.000000000000   3.650000000000 Bohr   0.0

nuclear repulsion = 9.86301369863014
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.825]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    566024.65


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpl7kw8bx3
max_memory 4000 MB (current use 401 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7286668554631

WARN: Singularity detected in overlap matrix (condition number = 86.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.107001630831573  LUMO (B3u) = -0.107001630831573

WARN: B2u HOMO -0.107001630831573 > system LUMO -0.107001630831573

cycle= 1 E= -75.2718520447977  delta_E= -0.543  |g|= 0.238  |ddm|= 1.48
HOMO (B2u) = -0.363117515186496  LUMO (B3u) = -0.0549592840356626
cycle= 2 E= -75.2946135925964  delta_E= -0.0228  |g|= 0.0477  |ddm|= 0.349
HOMO (B2u) = -0.329037998444986  LUMO (B3u) = -0.016221872430451
cycle= 3 E= -75.2959451182035  delta_E= -0.00133  |g|= 0.0175  |ddm|= 0.0628
HOMO (B2u) = -0.333444355785578  LUMO (B3u) = -0.020464933129925
cycle= 4 E= -75.296162044047  delta_E= -0.000217  |g|= 0.000656  |ddm|= 0.0354
HOMO (B2u) = -0.333615190019283  LUMO (B3u) = -0.0207831790531189
cycle= 5 E= -75.2961622069416  delta_E= -1.63e-07  |g|= 0.000121  |ddm|= 0.000855
HOMO (B2u) = -0.333577969876329  LUMO (B3u) = -0.0207522115134127
cycle= 6 E= -75.2961622153582  delta_E= -8.42e-09  |g|= 1.83e-05  |ddm|= 0.000208
HOMO (B2u) = -0.3335753766925  LUMO (B3u) = -0.0207525487418157
cycle= 7 E= -75.2961622155709  delta_E= -2.13e-10  |g|= 1.93e-06  |ddm|= 3.81e-05
HOMO (B2u) = -0.333574868730908  LUMO (B3u) = -0.0207524737519036
cycle= 8 E= -75.2961622155733  delta_E= -2.34e-12  |g|= 1.29e-07  |ddm|= 4e-06
HOMO (B2u) = -0.333574872987247  LUMO (B3u) = -0.0207524728268622
cycle= 9 E= -75.2961622155733  delta_E=    0  |g|= 8.8e-09  |ddm|= 3e-07
HOMO (B2u) = -0.333574872568335  LUMO (B3u) = -0.0207524743866529
cycle= 10 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 7.11e-09  |ddm|= 7.85e-09
HOMO (B2u) = -0.333574872451046  LUMO (B3u) = -0.0207524743254219
cycle= 11 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 5.12e-09  |ddm|= 5.7e-09
HOMO (B2u) = -0.333574871096706  LUMO (B3u) = -0.020752472916285
cycle= 12 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 4.45e-09  |ddm|= 2.68e-09
HOMO (B2u) = -0.333574871371749  LUMO (B3u) = -0.0207524732020015
cycle= 13 E= -75.2961622155733  delta_E= -5.68e-14  |g|= 4e-09  |ddm|= 1.69e-09
HOMO (B2u) = -0.333574871232359  LUMO (B3u) = -0.0207524730611061
cycle= 14 E= -75.2961622155733  delta_E= 4.26e-14  |g|= 3.27e-09  |ddm|= 2e-09
HOMO (B2u) = -0.333574871044462  LUMO (B3u) = -0.0207524729850067
cycle= 15 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 1.05e-09  |ddm|= 6.09e-09
HOMO (B2u) = -0.333574870948685  LUMO (B3u) = -0.0207524729725786
cycle= 16 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 9.82e-10  |ddm|= 1.12e-09
HOMO (B2u) = -0.333574870983883  LUMO (B3u) = -0.0207524729552927
cycle= 17 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 1.1e-09  |ddm|= 1.11e-09
HOMO (B2u) = -0.333574870946758  LUMO (B3u) = -0.0207524729305774
cycle= 18 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 8.5e-10  |ddm|= 6.47e-10
HOMO (B2u) = -0.333574870941365  LUMO (B3u) = -0.0207524729367105
cycle= 19 E= -75.2961622155733  delta_E=    0  |g|= 6.86e-10  |ddm|= 5.4e-10
HOMO (B2u) = -0.333574870940209  LUMO (B3u) = -0.0207524729448201
cycle= 20 E= -75.2961622155734  delta_E= -1.14e-13  |g|= 5.62e-10  |ddm|= 3.75e-10
HOMO (B2u) = -0.333574870924661  LUMO (B3u) = -0.0207524729356211
cycle= 21 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 4.37e-10  |ddm|= 3.23e-10
HOMO (B2u) = -0.333574870912732  LUMO (B3u) = -0.0207524729306298
cycle= 22 E= -75.2961622155733  delta_E=    0  |g|= 3.18e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.333574870901197  LUMO (B3u) = -0.0207524729260979
cycle= 23 E= -75.2961622155733  delta_E= 7.11e-14  |g|= 2.27e-10  |ddm|= 2.46e-10
HOMO (B2u) = -0.333574870894277  LUMO (B3u) = -0.0207524729227365
cycle= 24 E= -75.2961622155733  delta_E=    0  |g|= 1.96e-10  |ddm|= 8.28e-11
HOMO (B2u) = -0.333574870891268  LUMO (B3u) = -0.020752472919888
cycle= 25 E= -75.2961622155733  delta_E= -4.26e-14  |g|= 1.66e-10  |ddm|= 7.51e-11
HOMO (B2u) = -0.333574870886563  LUMO (B3u) = -0.0207524729173325
cycle= 26 E= -75.2961622155734  delta_E= -8.53e-14  |g|= 1.33e-10  |ddm|= 9e-11
HOMO (B2u) = -0.333574870882816  LUMO (B3u) = -0.0207524729152988
cycle= 27 E= -75.2961622155733  delta_E= 1.28e-13  |g|= 1.08e-10  |ddm|= 6.94e-11
HOMO (B2u) = -0.333574870879732  LUMO (B3u) = -0.0207524729135887
cycle= 28 E= -75.2961622155732  delta_E= 1.42e-14  |g|= 8.71e-11  |ddm|= 5.59e-11
HOMO (B2u) = -0.333574870877295  LUMO (B3u) = -0.0207524729122685
cycle= 29 E= -75.2961622155732  delta_E= 2.84e-14  |g|= 6.88e-11  |ddm|= 4.62e-11
HOMO (B2u) = -0.333574870875279  LUMO (B3u) = -0.0207524729111696
cycle= 30 E= -75.2961622155733  delta_E= -7.11e-14  |g|= 5.43e-11  |ddm|= 3.62e-11
HOMO (B2u) = -0.333574870873766  LUMO (B3u) = -0.0207524729103588
cycle= 31 E= -75.2961622155733  delta_E= -1.42e-14  |g|= 4.38e-11  |ddm|= 2.64e-11
HOMO (B2u) = -0.333574870872691  LUMO (B3u) = -0.0207524729097506
cycle= 32 E= -75.2961622155733  delta_E= -1.42e-14  |g|= 3.62e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.33357487087184  LUMO (B3u) = -0.020752472909236
cycle= 33 E= -75.2961622155733  delta_E=    0  |g|= 2.97e-11  |ddm|= 1.62e-11
HOMO (B2u) = -0.333574870869207  LUMO (B3u) = -0.0207524729077353
Extra cycle  E= -75.2961622155732  delta_E= 7.11e-14  |g|= 1.07e-11  |ddm|= 4.67e-11
converged SCF energy = -75.2961622155732

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpl7kw8bx3
max_memory 4000 MB (current use 409 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.432291665502  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4476417851214  dE = -0.01535012  S^2 = 0.0000000
               |grad[o]|=0.0982  |ddm|= 3.79  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4596313154451  dE = -0.01198953  S^2 = 0.0000000
               |grad[o]|=0.0787  |ddm|=0.0963  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4677080360234  dE = -0.0080767206  S^2 = 0.0000000
               |grad[o]|=0.0566  |ddm|=0.0425  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4729323362304  dE = -0.0052243002  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.0846  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4745134386277  dE = -0.0015811024  S^2 = 0.0000000
               |grad[o]|=0.0141  |ddm|=0.069  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4749250270398  dE = -0.00041158841  S^2 = 0.0000000
               |grad[o]|=0.00645  |ddm|=0.0178  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4749755961068  dE = -5.0569067e-05  S^2 = 0.0000000
               |grad[o]|=0.00239  |ddm|=0.00767  |maxRot[o]|=0.0157
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4749799280372  dE = -4.3319304e-06  S^2 = 0.0000000
               |grad[o]|=0.00081  |ddm|=0.00276  |maxRot[o]|=0.00471
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4749802891726  dE = -3.6113539e-07  S^2 = 0.0000000
               |grad[o]|=0.000249  |ddm|=0.00084  |maxRot[o]|=0.00136
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4749803190999  dE = -2.9927349e-08  S^2 = 0.0000000
               |grad[o]|=7.39e-05  |ddm|=0.000248  |maxRot[o]|=0.000392
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4749803215772  dE = -2.4772504e-09  S^2 = 0.0000000
               |grad[o]|=2.16e-05  |ddm|=7.21e-05  |maxRot[o]|=0.000112
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4749803217821  dE = -2.0497737e-10  S^2 = 0.0000000
               |grad[o]|=6.26e-06  |ddm|=2.09e-05  |maxRot[o]|=3.23e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4749803217991  dE = -1.6939339e-11  S^2 = 0.0000000
               |grad[o]|=1.81e-06  |ddm|=6.02e-06  |maxRot[o]|=9.28e-06
2-step CASSCF converged in 13 macro (51 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95767231 1.93317369 1.87988783 1.73905658 0.0679361  0.26647505
 0.056932   0.09886644]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01187   0.01040  -0.00309   0.00000   0.00000
  0 C 2s       0.67780   0.66796  -0.20019  -0.00000  -0.00000
  0 C 3s      -0.00350   0.01562  -0.03551  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69358
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439  -0.00000
  0 C 2pz      0.19981  -0.23087   0.67619  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06476
  0 C 3py      0.00000  -0.00000  -0.00000   0.05406  -0.00000
  0 C 3pz     -0.01243  -0.00176   0.01236  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03012  -0.00000
  0 C 3dz^2    0.01877  -0.01161   0.03492  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.12148
 0 C 3dx2-y2   0.00081   0.00633  -0.00713   0.00000   0.00000
  1 C 1s       0.01187  -0.01040  -0.00309   0.00000   0.00000
  1 C 2s       0.67780  -0.66796  -0.20019   0.00000   0.00000
  1 C 3s      -0.00350  -0.01562  -0.03551   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69358
  1 C 2py     -0.00000   0.00000   0.00000   0.70439   0.00000
  1 C 2pz     -0.19981  -0.23087  -0.67619  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06476
  1 C 3py     -0.00000   0.00000   0.00000   0.05406   0.00000
  1 C 3pz      0.01243  -0.00176  -0.01236  -0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03012  -0.00000
  1 C 3dz^2    0.01877   0.01161   0.03492   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12148
 1 C 3dx2-y2   0.00081  -0.00633  -0.00713  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.22994
  0 C 3s      -0.00000  -0.00000   0.03135
  0 C 2px     -0.00000   0.69817  -0.00000
  0 C 2py      0.70700  -0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.66687
  0 C 3px      0.00000  -0.01303  -0.00000
  0 C 3py     -0.00659   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03288
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01006   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00544
  0 C 3dxz     0.00000  -0.11131  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01768
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.22994
  1 C 3s       0.00000   0.00000  -0.03135
  1 C 2px     -0.00000  -0.69817   0.00000
  1 C 2py     -0.70700  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66687
  1 C 3px     -0.00000   0.01303   0.00000
  1 C 3py      0.00659   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03288
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01006   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00544
  1 C 3dxz     0.00000  -0.11131  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01768
<CAS-nat-orb|mo-hf>  3  3    0.99977693
<CAS-nat-orb|mo-hf>  4  4    0.99968291
<CAS-nat-orb|mo-hf>  5  5    0.99978338
<CAS-nat-orb|mo-hf>  6  6    0.99882147
<CAS-nat-orb|mo-hf>  7  7    0.93437311
<CAS-nat-orb|mo-hf>  8  8    0.98222688
<CAS-nat-orb|mo-hf>  9  9    0.96040421
<CAS-nat-orb|mo-hf>  10  10    0.93730552
CASSCF energy = -75.4749803217991
CASCI E = -75.4749803217991  E(CI) = -15.1422389244406  S^2 = 0.0000000
......production of RDMs took       1.94 sec
......reading the RDM took          0.42 sec
......production of RDMs took      28.56 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickICMRREPT2-ijrs) =    -0.00027386460117
E(WickICMRREPT2- rsi) =    -0.00086339503502
E(WickICMRREPT2- ijr) =    -0.00025168230440
E(WickICMRREPT2-  rs) =    -0.04963580353452
E(WickICMRREPT2-  ij) =    -0.00006127790065
E(WickICMRREPT2-  ir) =    -0.00104976310901
E(WickICMRREPT2-   r) =    -0.07031530712354
E(WickICMRREPT2-   i) =    -0.00006345983982
E(WickICMRREPT2) = -75.59749487524721  E_corr_pt = -0.1225145534481279
Timings = pdms =   40.70 | eris =    0.12 | ijrs =    1.17 | rsi =   32.75 | ijr =    0.44 | rs =  704.09 | ij =    1.26 | ir =   24.65 | r =  149.55 | i =    2.32 | total =  957.13
Time cost =   1026.925
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 02:05:51 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.957955680404 AA    0.000000000000   0.000000000000   3.700000000000 Bohr   0.0

nuclear repulsion = 9.72972972972973
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.85]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    581631.48


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp5m9iy3_b
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7163760223708

WARN: Singularity detected in overlap matrix (condition number = 80.7). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.104120790735629  LUMO (B3u) = -0.104120790735629

WARN: B2u HOMO -0.104120790735629 > system LUMO -0.104120790735629

cycle= 1 E= -75.2641203852923  delta_E= -0.548  |g|= 0.236  |ddm|= 1.47
HOMO (B2u) = -0.359408877513719  LUMO (B3u) = -0.0527582771899437
cycle= 2 E= -75.2865593123333  delta_E= -0.0224  |g|= 0.0471  |ddm|= 0.348
HOMO (B2u) = -0.325804970810901  LUMO (B3u) = -0.0145227547118898
cycle= 3 E= -75.2878678904738  delta_E= -0.00131  |g|= 0.0174  |ddm|= 0.0619
HOMO (B2u) = -0.330188258882716  LUMO (B3u) = -0.0187350374972996
cycle= 4 E= -75.2880824131579  delta_E= -0.000215  |g|= 0.000653  |ddm|= 0.035
HOMO (B2u) = -0.330355542534973  LUMO (B3u) = -0.0190485772808895
cycle= 5 E= -75.288082574972  delta_E= -1.62e-07  |g|= 0.000124  |ddm|= 0.000847
HOMO (B2u) = -0.330318643630839  LUMO (B3u) = -0.019018648417483
cycle= 6 E= -75.2880825838255  delta_E= -8.85e-09  |g|= 1.86e-05  |ddm|= 0.000214
HOMO (B2u) = -0.330315994378328  LUMO (B3u) = -0.0190189216398496
cycle= 7 E= -75.288082584047  delta_E= -2.21e-10  |g|= 1.93e-06  |ddm|= 3.86e-05
HOMO (B2u) = -0.33031550753924  LUMO (B3u) = -0.0190188734083709
cycle= 8 E= -75.2880825840493  delta_E= -2.39e-12  |g|= 1.29e-07  |ddm|= 4.01e-06
HOMO (B2u) = -0.33031551203674  LUMO (B3u) = -0.019018872535355
cycle= 9 E= -75.2880825840494  delta_E= -1.42e-14  |g|= 8.84e-09  |ddm|= 3.07e-07
HOMO (B2u) = -0.330315511517282  LUMO (B3u) = -0.0190188740640479
cycle= 10 E= -75.2880825840494  delta_E= -1.42e-14  |g|= 7.23e-09  |ddm|= 7.7e-09
HOMO (B2u) = -0.330315511431913  LUMO (B3u) = -0.0190188740456658
cycle= 11 E= -75.2880825840494  delta_E= -2.84e-14  |g|= 5.19e-09  |ddm|= 5.82e-09
HOMO (B2u) = -0.330315510117373  LUMO (B3u) = -0.0190188726788549
cycle= 12 E= -75.2880825840493  delta_E= 1.14e-13  |g|= 4.48e-09  |ddm|= 2.79e-09
HOMO (B2u) = -0.330315510361504  LUMO (B3u) = -0.019018872936388
cycle= 13 E= -75.2880825840493  delta_E= -5.68e-14  |g|= 4.02e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.330315510214232  LUMO (B3u) = -0.019018872785555
cycle= 14 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 3.28e-09  |ddm|= 2.15e-09
HOMO (B2u) = -0.330315510028992  LUMO (B3u) = -0.0190188727302591
cycle= 15 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 1.06e-09  |ddm|= 6.34e-09
HOMO (B2u) = -0.330315509934713  LUMO (B3u) = -0.0190188727176647
cycle= 16 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 9.75e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.330315509969786  LUMO (B3u) = -0.0190188726986106
cycle= 17 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 1.11e-09  |ddm|= 1.18e-09
HOMO (B2u) = -0.330315509932404  LUMO (B3u) = -0.0190188726753689
cycle= 18 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 8.59e-10  |ddm|= 6.58e-10
HOMO (B2u) = -0.330315509926469  LUMO (B3u) = -0.0190188726818233
cycle= 19 E= -75.2880825840494  delta_E= -9.95e-14  |g|= 6.89e-10  |ddm|= 5.6e-10
HOMO (B2u) = -0.330315509924997  LUMO (B3u) = -0.0190188726903037
cycle= 20 E= -75.2880825840493  delta_E= 7.11e-14  |g|= 5.61e-10  |ddm|= 3.89e-10
HOMO (B2u) = -0.330315509909344  LUMO (B3u) = -0.0190188726818002
cycle= 21 E= -75.2880825840493  delta_E=    0  |g|= 4.36e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.330315509897028  LUMO (B3u) = -0.0190188726770559
cycle= 22 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 3.16e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.33031550988511  LUMO (B3u) = -0.0190188726728564
cycle= 23 E= -75.2880825840493  delta_E= 4.26e-14  |g|= 2.26e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.330315509878137  LUMO (B3u) = -0.019018872669522
cycle= 24 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 1.95e-10  |ddm|= 8.26e-11
HOMO (B2u) = -0.330315509874982  LUMO (B3u) = -0.0190188726666771
cycle= 25 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 1.65e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.33031550987015  LUMO (B3u) = -0.0190188726642076
cycle= 26 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 1.32e-10  |ddm|= 9.19e-11
HOMO (B2u) = -0.33031550986633  LUMO (B3u) = -0.0190188726622576
cycle= 27 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 1.07e-10  |ddm|= 7.11e-11
HOMO (B2u) = -0.330315509863178  LUMO (B3u) = -0.0190188726606104
cycle= 28 E= -75.2880825840493  delta_E= -1.42e-14  |g|= 8.58e-11  |ddm|= 5.67e-11
HOMO (B2u) = -0.330315509860673  LUMO (B3u) = -0.0190188726593347
cycle= 29 E= -75.2880825840494  delta_E= -7.11e-14  |g|= 6.76e-11  |ddm|= 4.64e-11
HOMO (B2u) = -0.330315509858611  LUMO (B3u) = -0.0190188726582754
cycle= 30 E= -75.2880825840494  delta_E= 1.42e-14  |g|= 5.33e-11  |ddm|= 3.63e-11
HOMO (B2u) = -0.330315509857065  LUMO (B3u) = -0.0190188726574964
cycle= 31 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 4.3e-11  |ddm|= 2.64e-11
HOMO (B2u) = -0.330315509855965  LUMO (B3u) = -0.0190188726569025
cycle= 32 E= -75.2880825840493  delta_E= -4.26e-14  |g|= 3.54e-11  |ddm|= 1.86e-11
HOMO (B2u) = -0.33031550985509  LUMO (B3u) = -0.0190188726564012
cycle= 33 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 2.9e-11  |ddm|= 1.62e-11
HOMO (B2u) = -0.330315509854297  LUMO (B3u) = -0.0190188726559857
cycle= 34 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 2.36e-11  |ddm|= 1.39e-11
HOMO (B2u) = -0.33031550985366  LUMO (B3u) = -0.0190188726556475
cycle= 35 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 1.93e-11  |ddm|= 1.1e-11
HOMO (B2u) = -0.330315509853137  LUMO (B3u) = -0.0190188726553623
cycle= 36 E= -75.2880825840494  delta_E=    0  |g|= 1.56e-11  |ddm|= 8.95e-12
HOMO (B2u) = -0.330315509851733  LUMO (B3u) = -0.0190188726545745
Extra cycle  E= -75.2880825840494  delta_E= -2.84e-14  |g|= 5.72e-12  |ddm|= 2.38e-11
converged SCF energy = -75.2880825840494

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp5m9iy3_b
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4284824270337  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.444313354192  dE = -0.015830927  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|= 3.78  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.456431200527  dE = -0.012117846  S^2 = 0.0000000
               |grad[o]|=0.079  |ddm|=0.101  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4642866715326  dE = -0.007855471  S^2 = 0.0000000
               |grad[o]|=0.0552  |ddm|=0.0402  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4683743861278  dE = -0.0040877146  S^2 = 0.0000000
               |grad[o]|=0.032  |ddm|=0.0939  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.470144849048  dE = -0.0017704629  S^2 = 0.0000000
               |grad[o]|=0.0156  |ddm|=0.0559  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.470567712854  dE = -0.00042286381  S^2 = 0.0000000
               |grad[o]|=0.00657  |ddm|=0.0184  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4706176210692  dE = -4.9908215e-05  S^2 = 0.0000000
               |grad[o]|=0.00242  |ddm|=0.00761  |maxRot[o]|=0.0156
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4706218171141  dE = -4.1960449e-06  S^2 = 0.0000000
               |grad[o]|=0.000823  |ddm|=0.00269  |maxRot[o]|=0.00463
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4706221621623  dE = -3.4504821e-07  S^2 = 0.0000000
               |grad[o]|=0.000251  |ddm|=0.000815  |maxRot[o]|=0.00133
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4706221904069  dE = -2.8244585e-08  S^2 = 0.0000000
               |grad[o]|=7.44e-05  |ddm|=0.00024  |maxRot[o]|=0.000379
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4706221927127  dE = -2.3058249e-09  S^2 = 0.0000000
               |grad[o]|=2.17e-05  |ddm|=6.94e-05  |maxRot[o]|=0.000108
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4706221929015  dE = -1.8884805e-10  S^2 = 0.0000000
               |grad[o]|=6.23e-06  |ddm|=2.01e-05  |maxRot[o]|=3.08e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.470622192917  dE = -1.5447199e-11  S^2 = 0.0000000
               |grad[o]|=1.79e-06  |ddm|=5.75e-06  |maxRot[o]|=8.82e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95713289 1.93379643 1.87461992 1.72422801 0.06681526 0.28113864
 0.05662336 0.10564549]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01200   0.01047  -0.00276   0.00000   0.00000
  0 C 2s       0.68293   0.67051  -0.18198   0.00000  -0.00000
  0 C 3s      -0.00172   0.01539  -0.03356   0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69358
  0 C 2py     -0.00000   0.00000  -0.00000   0.70441   0.00000
  0 C 2pz      0.18173  -0.22338   0.68140   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06561
  0 C 3py     -0.00000   0.00000  -0.00000   0.05451   0.00000
  0 C 3pz     -0.01154  -0.00172   0.01401   0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02892  -0.00000
  0 C 3dz^2    0.01723  -0.01123   0.03460   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.12102
 0 C 3dx2-y2   0.00106   0.00623  -0.00705   0.00000   0.00000
  1 C 1s       0.01200  -0.01047  -0.00276   0.00000   0.00000
  1 C 2s       0.68293  -0.67051  -0.18198   0.00000  -0.00000
  1 C 3s      -0.00172  -0.01539  -0.03356  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69358
  1 C 2py      0.00000  -0.00000  -0.00000   0.70441   0.00000
  1 C 2pz     -0.18173  -0.22338  -0.68140   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06561
  1 C 3py      0.00000  -0.00000   0.00000   0.05451  -0.00000
  1 C 3pz      0.01154  -0.00172  -0.01401   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02892   0.00000
  1 C 3dz^2    0.01723   0.01123   0.03460  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12102
 1 C 3dx2-y2   0.00106  -0.00623  -0.00705   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00028
  0 C 2s       0.00000  -0.00000   0.22254
  0 C 3s       0.00000  -0.00000   0.03036
  0 C 2px     -0.00000   0.69830  -0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.66959
  0 C 3px     -0.00000  -0.01481   0.00000
  0 C 3py     -0.00465   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.03021
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00965   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00477
  0 C 3dxz    -0.00000  -0.11029  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01664
  1 C 1s       0.00000   0.00000   0.00028
  1 C 2s      -0.00000   0.00000  -0.22254
  1 C 3s      -0.00000   0.00000  -0.03036
  1 C 2px      0.00000  -0.69830  -0.00000
  1 C 2py     -0.70703  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66959
  1 C 3px      0.00000   0.01481   0.00000
  1 C 3py      0.00465   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.03021
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00965  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00477
  1 C 3dxz    -0.00000  -0.11029  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01664
<CAS-nat-orb|mo-hf>  3  3    0.99943449
<CAS-nat-orb|mo-hf>  4  4    0.99967130
<CAS-nat-orb|mo-hf>  5  5    0.99943415
<CAS-nat-orb|mo-hf>  6  6    0.99875809
<CAS-nat-orb|mo-hf>  7  7    0.93391056
<CAS-nat-orb|mo-hf>  8  8    0.98327030
<CAS-nat-orb|mo-hf>  9  9    0.96053902
<CAS-nat-orb|mo-hf>  10  10    0.94279395
CASSCF energy = -75.470622192917
CASCI E = -75.470622192917  E(CI) = -15.078733235137  S^2 = 0.0000000
......production of RDMs took       1.96 sec
......reading the RDM took          0.45 sec
......production of RDMs took      22.03 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickICMRREPT2-ijrs) =    -0.00027546784275
E(WickICMRREPT2- rsi) =    -0.00086670157718
E(WickICMRREPT2- ijr) =    -0.00025012494055
E(WickICMRREPT2-  rs) =    -0.04946671381172
E(WickICMRREPT2-  ij) =    -0.00005947828611
E(WickICMRREPT2-  ir) =    -0.00104472974826
E(WickICMRREPT2-   r) =    -0.07078276054694
E(WickICMRREPT2-   i) =    -0.00006054366241
E(WickICMRREPT2) = -75.59342871333291  E_corr_pt = -0.1228065204159203
Timings = pdms =   34.23 | eris =    0.07 | ijrs =    1.19 | rsi =   41.51 | ijr =    0.50 | rs =  646.82 | ij =    1.29 | ir =   25.37 | r =  153.84 | i =    2.60 | total =  907.49
Time cost =    964.233
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 02:21:55 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.984414540950 AA    0.000000000000   0.000000000000   3.750000000000 Bohr   0.0

nuclear repulsion = 9.6
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.875]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    596392.45


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp9ob94jt_
max_memory 4000 MB (current use 401 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7049084284725

WARN: Singularity detected in overlap matrix (condition number = 75.6). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.101370211913451  LUMO (B3u) = -0.101370211913452

WARN: B2u HOMO -0.101370211913451 > system LUMO -0.101370211913452

cycle= 1 E= -75.2564523906343  delta_E= -0.552  |g|= 0.234  |ddm|= 1.47
HOMO (B2u) = -0.355831308623932  LUMO (B3u) = -0.0506406338501552
cycle= 2 E= -75.2785865089974  delta_E= -0.0221  |g|= 0.0465  |ddm|= 0.348
HOMO (B2u) = -0.322685006141469  LUMO (B3u) = -0.0128872994795384
cycle= 3 E= -75.2798715208091  delta_E= -0.00129  |g|= 0.0172  |ddm|= 0.061
HOMO (B2u) = -0.327043790963023  LUMO (B3u) = -0.0170677233110575
cycle= 4 E= -75.2800833606865  delta_E= -0.000212  |g|= 0.000651  |ddm|= 0.0346
HOMO (B2u) = -0.32720420724387  LUMO (B3u) = -0.0173729266447982
cycle= 5 E= -75.280083521623  delta_E= -1.61e-07  |g|= 0.000127  |ddm|= 0.00084
HOMO (B2u) = -0.327167734029073  LUMO (B3u) = -0.0173440705847776
cycle= 6 E= -75.2800835308717  delta_E= -9.25e-09  |g|= 1.89e-05  |ddm|= 0.000218
HOMO (B2u) = -0.327165039753329  LUMO (B3u) = -0.0173442874866631
cycle= 7 E= -75.2800835311012  delta_E= -2.3e-10  |g|= 1.94e-06  |ddm|= 3.91e-05
HOMO (B2u) = -0.327164572283954  LUMO (B3u) = -0.0173442642259077
cycle= 8 E= -75.2800835311035  delta_E= -2.3e-12  |g|= 1.3e-07  |ddm|= 4.03e-06
HOMO (B2u) = -0.327164577390936  LUMO (B3u) = -0.0173442637008983
cycle= 9 E= -75.2800835311036  delta_E= -8.53e-14  |g|= 8.76e-09  |ddm|= 3.12e-07
HOMO (B2u) = -0.327164576780155  LUMO (B3u) = -0.0173442652037962
cycle= 10 E= -75.2800835311036  delta_E=    0  |g|= 7.28e-09  |ddm|= 7.49e-09
HOMO (B2u) = -0.327164576738398  LUMO (B3u) = -0.0173442652421252
cycle= 11 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 5.2e-09  |ddm|= 5.92e-09
HOMO (B2u) = -0.327164575481187  LUMO (B3u) = -0.0173442639353493
cycle= 12 E= -75.2800835311036  delta_E= 5.68e-14  |g|= 4.47e-09  |ddm|= 2.88e-09
HOMO (B2u) = -0.327164575694589  LUMO (B3u) = -0.0173442641639052
cycle= 13 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 4e-09  |ddm|= 1.7e-09
HOMO (B2u) = -0.327164575241097  LUMO (B3u) = -0.0173442639315037
cycle= 14 E= -75.2800835311036  delta_E= -1.14e-13  |g|= 9.56e-10  |ddm|= 7.35e-09
HOMO (B2u) = -0.327164575348919  LUMO (B3u) = -0.0173442639680502
cycle= 15 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 9.67e-10  |ddm|= 1.36e-09
HOMO (B2u) = -0.327164575274748  LUMO (B3u) = -0.017344263951249
cycle= 16 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 9.33e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.327164575295755  LUMO (B3u) = -0.0173442639367864
cycle= 17 E= -75.2800835311036  delta_E=    0  |g|= 1.03e-09  |ddm|= 7.82e-10
HOMO (B2u) = -0.327164575258603  LUMO (B3u) = -0.0173442639153029
cycle= 18 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 7.77e-10  |ddm|= 6.59e-10
HOMO (B2u) = -0.327164575252091  LUMO (B3u) = -0.017344263922176
cycle= 19 E= -75.2800835311035  delta_E= 1.14e-13  |g|= 6.02e-10  |ddm|= 5.76e-10
HOMO (B2u) = -0.327164575250301  LUMO (B3u) = -0.0173442639311176
cycle= 20 E= -75.2800835311035  delta_E=    0  |g|= 4.74e-10  |ddm|= 4.02e-10
HOMO (B2u) = -0.327164575234631  LUMO (B3u) = -0.017344263923548
cycle= 21 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 3.48e-10  |ddm|= 3.39e-10
HOMO (B2u) = -0.327164575221925  LUMO (B3u) = -0.0173442639192379
cycle= 22 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 2.28e-10  |ddm|= 3.1e-10
HOMO (B2u) = -0.327164575218976  LUMO (B3u) = -0.0173442639164651
cycle= 23 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 2.02e-10  |ddm|= 7.25e-11
HOMO (B2u) = -0.327164575212578  LUMO (B3u) = -0.0173442639133723
cycle= 24 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 1.73e-10  |ddm|= 7.56e-11
HOMO (B2u) = -0.327164575209114  LUMO (B3u) = -0.017344263910815
cycle= 25 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 1.44e-10  |ddm|= 7.32e-11
HOMO (B2u) = -0.327164575204634  LUMO (B3u) = -0.0173442639086116
cycle= 26 E= -75.2800835311035  delta_E=    0  |g|= 1.13e-10  |ddm|= 8.65e-11
HOMO (B2u) = -0.327164575201212  LUMO (B3u) = -0.017344263906914
cycle= 27 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 9.08e-11  |ddm|= 6.55e-11
HOMO (B2u) = -0.32716457519847  LUMO (B3u) = -0.0173442639054916
cycle= 28 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 7.21e-11  |ddm|= 5.03e-11
HOMO (B2u) = -0.327164575196394  LUMO (B3u) = -0.0173442639044207
cycle= 29 E= -75.2800835311036  delta_E=    0  |g|= 5.65e-11  |ddm|= 3.95e-11
HOMO (B2u) = -0.327164575191226  LUMO (B3u) = -0.0173442639016588
Extra cycle  E= -75.2800835311035  delta_E= 2.84e-14  |g|= 1.98e-11  |ddm|= 9.29e-11
converged SCF energy = -75.2800835311035

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp9ob94jt_
max_memory 4000 MB (current use 410 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.42477116677  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4410961607657  dE = -0.016324994  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4533243763479  dE = -0.012228216  S^2 = 0.0000000
               |grad[o]|=0.0793  |ddm|=0.107  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4609348681505  dE = -0.0076104918  S^2 = 0.0000000
               |grad[o]|=0.0537  |ddm|=0.0363  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4644374668708  dE = -0.0035025987  S^2 = 0.0000000
               |grad[o]|=0.029  |ddm|=0.102  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4660330713119  dE = -0.0015956044  S^2 = 0.0000000
               |grad[o]|=0.0144  |ddm|=0.0465  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4663655365162  dE = -0.0003324652  S^2 = 0.0000000
               |grad[o]|=0.00576  |ddm|=0.0163  |maxRot[o]|=0.0375
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4663950794204  dE = -2.9542904e-05  S^2 = 0.0000000
               |grad[o]|=0.00202  |ddm|=0.00671  |maxRot[o]|=0.0121
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4663975357625  dE = -2.4563421e-06  S^2 = 0.0000000
               |grad[o]|=0.000663  |ddm|=0.00206  |maxRot[o]|=0.00353
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4663977370563  dE = -2.0129374e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.000624  |maxRot[o]|=0.00101
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4663977534853  dE = -1.642907e-08  S^2 = 0.0000000
               |grad[o]|=5.9e-05  |ddm|=0.000183  |maxRot[o]|=0.000287
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4663977548323  dE = -1.346919e-09  S^2 = 0.0000000
               |grad[o]|=1.71e-05  |ddm|=5.31e-05  |maxRot[o]|=8.13e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4663977549444  dE = -1.1213785e-10  S^2 = 0.0000000
               |grad[o]|=4.95e-06  |ddm|=1.52e-05  |maxRot[o]|=2.35e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4663977549536  dE = -9.1802121e-12  S^2 = 0.0000000
               |grad[o]|=1.43e-06  |ddm|=4.49e-06  |maxRot[o]|=6.65e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95667457 1.9344164  1.86874334 1.70868175 0.06576131 0.29650692
 0.0563102  0.1129055 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01211   0.01055  -0.00246   0.00000   0.00000
  0 C 2s       0.68726   0.67292  -0.16495  -0.00000  -0.00000
  0 C 3s      -0.00012   0.01517  -0.03163  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69361
  0 C 2py      0.00000  -0.00000  -0.00000   0.70443  -0.00000
  0 C 2pz      0.16481  -0.21605   0.68580   0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06639
  0 C 3py      0.00000  -0.00000  -0.00000   0.05485  -0.00000
  0 C 3pz     -0.01075  -0.00170   0.01569  -0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02772  -0.00000
  0 C 3dz^2    0.01579  -0.01087   0.03419  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.12041
 0 C 3dx2-y2   0.00128   0.00613  -0.00696   0.00000  -0.00000
  1 C 1s       0.01211  -0.01055  -0.00246   0.00000   0.00000
  1 C 2s       0.68726  -0.67292  -0.16495   0.00000   0.00000
  1 C 3s      -0.00012  -0.01517  -0.03163   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69361
  1 C 2py      0.00000  -0.00000  -0.00000   0.70443   0.00000
  1 C 2pz     -0.16481  -0.21605  -0.68580   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.06639
  1 C 3py     -0.00000   0.00000   0.00000   0.05485   0.00000
  1 C 3pz      0.01075  -0.00170  -0.01569  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02772  -0.00000
  1 C 3dz^2    0.01579   0.01087   0.03419   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.12041
 1 C 3dx2-y2   0.00128  -0.00613  -0.00696   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00026
  0 C 2s      -0.00000  -0.00000   0.21528
  0 C 3s      -0.00000  -0.00000   0.02936
  0 C 2px     -0.00000   0.69842   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67214
  0 C 3px      0.00000  -0.01654  -0.00000
  0 C 3py     -0.00273  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02753
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00925   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00414
  0 C 3dxz     0.00000  -0.10923   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01562
  1 C 1s       0.00000   0.00000   0.00026
  1 C 2s       0.00000   0.00000  -0.21528
  1 C 3s       0.00000   0.00000  -0.02936
  1 C 2px     -0.00000  -0.69842   0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.67214
  1 C 3px      0.00000   0.01654  -0.00000
  1 C 3py      0.00273  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02753
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00925   0.00000   0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00414
  1 C 3dxz    -0.00000  -0.10923   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01562
<CAS-nat-orb|mo-hf>  3  3    0.99890662
<CAS-nat-orb|mo-hf>  4  4    0.99965866
<CAS-nat-orb|mo-hf>  5  5    0.99889779
<CAS-nat-orb|mo-hf>  6  6    0.99869247
<CAS-nat-orb|mo-hf>  7  7    0.93353913
<CAS-nat-orb|mo-hf>  8  8    0.98425021
<CAS-nat-orb|mo-hf>  9  9    0.96066028
<CAS-nat-orb|mo-hf>  10  10    0.94772193
CASSCF energy = -75.4663977549536
CASCI E = -75.4663977549536  E(CI) = -15.0169341303923  S^2 = 0.0000000
......production of RDMs took       2.58 sec
......reading the RDM took          0.42 sec
......production of RDMs took      24.67 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICMRREPT2-ijrs) =    -0.00027715204223
E(WickICMRREPT2- rsi) =    -0.00087034975883
E(WickICMRREPT2- ijr) =    -0.00024864431722
E(WickICMRREPT2-  rs) =    -0.04931264490921
E(WickICMRREPT2-  ij) =    -0.00005779291264
E(WickICMRREPT2-  ir) =    -0.00104018027256
E(WickICMRREPT2-   r) =    -0.07123024954587
E(WickICMRREPT2-   i) =    -0.00005777419526
E(WickICMRREPT2) = -75.58949254290739  E_corr_pt = -0.1230947879538238
Timings = pdms =   37.44 | eris =    0.16 | ijrs =    1.17 | rsi =   32.07 | ijr =    0.42 | rs =  586.91 | ij =    1.23 | ir =   24.43 | r =  147.56 | i =    2.33 | total =  833.78
Time cost =    886.628
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 02:36:42 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.010873401496 AA    0.000000000000   0.000000000000   3.800000000000 Bohr   0.0

nuclear repulsion = 9.47368421052632
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    609508.74


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp_f8dbs4o
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6942155395781

WARN: Singularity detected in overlap matrix (condition number = 70.9). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0987431605477891  LUMO (B3u) = -0.0987431605477892

WARN: B2u HOMO -0.0987431605477891 > system LUMO -0.0987431605477892

cycle= 1 E= -75.2488547171613  delta_E= -0.555  |g|= 0.232  |ddm|= 1.46
HOMO (B2u) = -0.352381746665135  LUMO (B3u) = -0.0486055106897032
cycle= 2 E= -75.2707023112209  delta_E= -0.0218  |g|= 0.046  |ddm|= 0.348
HOMO (B2u) = -0.319674633980572  LUMO (B3u) = -0.0113141174561864
cycle= 3 E= -75.2719633258624  delta_E= -0.00126  |g|= 0.0171  |ddm|= 0.0602
HOMO (B2u) = -0.324007395733246  LUMO (B3u) = -0.0154613624878801
cycle= 4 E= -75.2721722602516  delta_E= -0.000209  |g|= 0.000648  |ddm|= 0.0343
HOMO (B2u) = -0.324157880743131  LUMO (B3u) = -0.0157548749526152
cycle= 5 E= -75.2721724204055  delta_E= -1.6e-07  |g|= 0.000129  |ddm|= 0.000835
HOMO (B2u) = -0.324121920212103  LUMO (B3u) = -0.0157271018699646
cycle= 6 E= -75.2721724300014  delta_E= -9.6e-09  |g|= 1.92e-05  |ddm|= 0.000222
HOMO (B2u) = -0.324119190447214  LUMO (B3u) = -0.0157272676284086
cycle= 7 E= -75.2721724302383  delta_E= -2.37e-10  |g|= 1.95e-06  |ddm|= 3.95e-05
HOMO (B2u) = -0.32411874062012  LUMO (B3u) = -0.0157272677303707
cycle= 8 E= -75.2721724302408  delta_E= -2.5e-12  |g|= 1.3e-07  |ddm|= 4.06e-06
HOMO (B2u) = -0.324118746685599  LUMO (B3u) = -0.0157272678197246
cycle= 9 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 8.55e-09  |ddm|= 3.15e-07
HOMO (B2u) = -0.324118745999671  LUMO (B3u) = -0.015727269316734
cycle= 10 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 7.23e-09  |ddm|= 7.25e-09
HOMO (B2u) = -0.324118746006035  LUMO (B3u) = -0.0157272694118121
cycle= 11 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 5.15e-09  |ddm|= 5.91e-09
HOMO (B2u) = -0.324118744821844  LUMO (B3u) = -0.0157272681802577
cycle= 12 E= -75.2721724302407  delta_E=    0  |g|= 4.41e-09  |ddm|= 2.93e-09
HOMO (B2u) = -0.324118745005715  LUMO (B3u) = -0.0157272683816846
cycle= 13 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 3.94e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.324118744560513  LUMO (B3u) = -0.015727268165468
cycle= 14 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 9.13e-10  |ddm|= 7.35e-09
HOMO (B2u) = -0.324118744667913  LUMO (B3u) = -0.0157272682019146
cycle= 15 E= -75.2721724302408  delta_E=    0  |g|= 9.35e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.324118744596425  LUMO (B3u) = -0.0157272681846878
cycle= 16 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 8.94e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.324118744616636  LUMO (B3u) = -0.0157272681691183
cycle= 17 E= -75.2721724302408  delta_E= -4.26e-14  |g|= 9.99e-10  |ddm|= 8.13e-10
HOMO (B2u) = -0.324118744581065  LUMO (B3u) = -0.0157272681498911
cycle= 18 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 7.56e-10  |ddm|= 6.36e-10
HOMO (B2u) = -0.324118744575208  LUMO (B3u) = -0.015727268157698
cycle= 19 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 5.83e-10  |ddm|= 5.73e-10
HOMO (B2u) = -0.3241187445741  LUMO (B3u) = -0.0157272681675061
cycle= 20 E= -75.2721724302408  delta_E= -2.84e-14  |g|= 4.58e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.324118744559507  LUMO (B3u) = -0.0157272681614126
cycle= 21 E= -75.2721724302407  delta_E= 1.42e-14  |g|= 3.35e-10  |ddm|= 3.32e-10
HOMO (B2u) = -0.324118744547496  LUMO (B3u) = -0.0157272681580271
cycle= 22 E= -75.2721724302408  delta_E= -1.42e-14  |g|= 2.19e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.324118744544734  LUMO (B3u) = -0.0157272681553808
cycle= 23 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 1.94e-10  |ddm|= 6.87e-11
HOMO (B2u) = -0.324118744538546  LUMO (B3u) = -0.0157272681524143
cycle= 24 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 1.66e-10  |ddm|= 7.25e-11
HOMO (B2u) = -0.324118744535208  LUMO (B3u) = -0.0157272681500246
cycle= 25 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 1.38e-10  |ddm|= 6.96e-11
HOMO (B2u) = -0.32411874453092  LUMO (B3u) = -0.015727268148066
cycle= 26 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 1.08e-10  |ddm|= 8.38e-11
HOMO (B2u) = -0.324118744527662  LUMO (B3u) = -0.0157272681465647
cycle= 27 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 8.7e-11  |ddm|= 6.37e-11
HOMO (B2u) = -0.324118744525038  LUMO (B3u) = -0.0157272681452835
cycle= 28 E= -75.2721724302407  delta_E= -5.68e-14  |g|= 6.91e-11  |ddm|= 4.85e-11
HOMO (B2u) = -0.324118744523037  LUMO (B3u) = -0.0157272681443079
cycle= 29 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 5.41e-11  |ddm|= 3.79e-11
HOMO (B2u) = -0.324118744521509  LUMO (B3u) = -0.015727268143523
cycle= 30 E= -75.2721724302408  delta_E= -7.11e-14  |g|= 4.29e-11  |ddm|= 2.78e-11
HOMO (B2u) = -0.324118744520514  LUMO (B3u) = -0.0157272681429857
cycle= 31 E= -75.2721724302408  delta_E= 1.42e-14  |g|= 3.57e-11  |ddm|= 1.78e-11
HOMO (B2u) = -0.324118744519564  LUMO (B3u) = -0.0157272681425062
cycle= 32 E= -75.2721724302407  delta_E= 8.53e-14  |g|= 2.92e-11  |ddm|= 1.59e-11
HOMO (B2u) = -0.324118744518813  LUMO (B3u) = -0.0157272681421096
cycle= 33 E= -75.2721724302407  delta_E=    0  |g|= 2.37e-11  |ddm|= 1.38e-11
HOMO (B2u) = -0.324118744516642  LUMO (B3u) = -0.0157272681409763
Extra cycle  E= -75.2721724302407  delta_E= -4.26e-14  |g|= 8.47e-12  |ddm|= 3.76e-11
converged SCF energy = -75.2721724302407

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp_f8dbs4o
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4211674784895  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4380007566043  dE = -0.016833278  S^2 = 0.0000000
               |grad[o]|=0.104  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4503194901036  dE = -0.012318733  S^2 = 0.0000000
               |grad[o]|=0.0795  |ddm|=0.112  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4576628758681  dE = -0.0073433858  S^2 = 0.0000000
               |grad[o]|=0.052  |ddm|=0.0313  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4606478981281  dE = -0.0029850223  S^2 = 0.0000000
               |grad[o]|=0.0258  |ddm|=0.108  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4620547102484  dE = -0.0014068121  S^2 = 0.0000000
               |grad[o]|=0.0131  |ddm|=0.0375  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4622921063046  dE = -0.00023739606  S^2 = 0.0000000
               |grad[o]|=0.00495  |ddm|=0.0145  |maxRot[o]|=0.0323
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4623127843091  dE = -2.0678004e-05  S^2 = 0.0000000
               |grad[o]|=0.00178  |ddm|=0.00552  |maxRot[o]|=0.0101
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4623145068647  dE = -1.7225557e-06  S^2 = 0.0000000
               |grad[o]|=0.000579  |ddm|=0.00172  |maxRot[o]|=0.00294
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4623146489297  dE = -1.4206498e-07  S^2 = 0.0000000
               |grad[o]|=0.000174  |ddm|=0.000526  |maxRot[o]|=0.000839
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4623146606368  dE = -1.1707087e-08  S^2 = 0.0000000
               |grad[o]|=5.14e-05  |ddm|=0.000155  |maxRot[o]|=0.000239
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4623146616044  dE = -9.6763131e-10  S^2 = 0.0000000
               |grad[o]|=1.5e-05  |ddm|=4.51e-05  |maxRot[o]|=6.85e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4623146616921  dE = -8.7638341e-11  S^2 = 0.0000000
               |grad[o]|=4.32e-06  |ddm|=1.31e-05  |maxRot[o]|=1.93e-05
2-step CASSCF converged in 12 macro (48 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9562916  1.9350335  1.86223013 1.69240306 0.06476757 0.31259499
 0.05599298 0.12068616]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01220   0.01062  -0.00217   0.00000   0.00000
  0 C 2s       0.69087   0.67520  -0.14918  -0.00000   0.00000
  0 C 3s       0.00130   0.01496  -0.02972  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69367
  0 C 2py      0.00000  -0.00000  -0.00000   0.70446   0.00000
  0 C 2pz      0.14914  -0.20886   0.68947  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06711
  0 C 3py      0.00000  -0.00000  -0.00000   0.05509  -0.00000
  0 C 3pz     -0.01004  -0.00168   0.01737  -0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02654   0.00000
  0 C 3dz^2    0.01444  -0.01051   0.03370  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.11966
 0 C 3dx2-y2   0.00150   0.00603  -0.00686  -0.00000  -0.00000
  1 C 1s       0.01220  -0.01062  -0.00217   0.00000   0.00000
  1 C 2s       0.69087  -0.67520  -0.14918   0.00000  -0.00000
  1 C 3s       0.00130  -0.01496  -0.02972   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69367
  1 C 2py     -0.00000   0.00000   0.00000   0.70446  -0.00000
  1 C 2pz     -0.14914  -0.20886  -0.68947   0.00000   0.00000
  1 C 3px     -0.00000  -0.00000   0.00000   0.00000  -0.06711
  1 C 3py     -0.00000   0.00000   0.00000   0.05509  -0.00000
  1 C 3pz      0.01004  -0.00168  -0.01737  -0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02654   0.00000
  1 C 3dz^2    0.01444   0.01051   0.03370   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11966
 1 C 3dx2-y2   0.00150  -0.00603  -0.00686  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s      -0.00000   0.00000   0.20816
  0 C 3s      -0.00000   0.00000   0.02837
  0 C 2px     -0.00000   0.69855   0.00000
  0 C 2py      0.70705  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67455
  0 C 3px     -0.00000  -0.01822   0.00000
  0 C 3py     -0.00084  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.02485
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00885  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00357
  0 C 3dxz    -0.00000  -0.10813  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01462
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000   0.00000  -0.20816
  1 C 3s       0.00000  -0.00000  -0.02837
  1 C 2px      0.00000  -0.69855  -0.00000
  1 C 2py     -0.70705   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.67455
  1 C 3px      0.00000   0.01822  -0.00000
  1 C 3py      0.00084   0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.02485
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00885  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00357
  1 C 3dxz    -0.00000  -0.10813   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01462
<CAS-nat-orb|mo-hf>  3  3    0.99826978
<CAS-nat-orb|mo-hf>  4  4    0.99964484
<CAS-nat-orb|mo-hf>  5  5    0.99825063
<CAS-nat-orb|mo-hf>  6  6    0.99862457
<CAS-nat-orb|mo-hf>  7  7    0.93325604
<CAS-nat-orb|mo-hf>  8  8    0.98517025
<CAS-nat-orb|mo-hf>  9  9    0.96077010
<CAS-nat-orb|mo-hf>  10  10    0.95215926
CASSCF energy = -75.4623146616921
CASCI E = -75.4623146616921  E(CI) = -14.9567871966306  S^2 = 0.0000000
......production of RDMs took       1.93 sec
......reading the RDM took          0.46 sec
......production of RDMs took      25.37 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.79 sec

E(WickICMRREPT2-ijrs) =    -0.00027890096986
E(WickICMRREPT2- rsi) =    -0.00087429209207
E(WickICMRREPT2- ijr) =    -0.00024722330239
E(WickICMRREPT2-  rs) =    -0.04917391938879
E(WickICMRREPT2-  ij) =    -0.00005621332396
E(WickICMRREPT2-  ir) =    -0.00103608396223
E(WickICMRREPT2-   r) =    -0.07165615398891
E(WickICMRREPT2-   i) =    -0.00005514271124
E(WickICMRREPT2) = -75.58569259143151  E_corr_pt = -0.123377929739439
Timings = pdms =   37.55 | eris =    0.03 | ijrs =    1.23 | rsi =   31.94 | ijr =    0.42 | rs =  644.06 | ij =    1.44 | ir =   24.80 | r =  156.53 | i =    2.29 | total =  900.36
Time cost =    953.693
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 02:52:36 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.037332262042 AA    0.000000000000   0.000000000000   3.850000000000 Bohr   0.0

nuclear repulsion = 9.35064935064935
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    623911.66


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmply3ywsrv
max_memory 4000 MB (current use 401 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6842509501291

WARN: Singularity detected in overlap matrix (condition number = 66.5). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0962332913313834  LUMO (B3u) = -0.0962332913313834

WARN: B2u HOMO -0.0962332913313834 > system LUMO -0.0962332913313834

cycle= 1 E= -75.241333020414  delta_E= -0.557  |g|= 0.231  |ddm|= 1.46
HOMO (B2u) = -0.349057007799766  LUMO (B3u) = -0.0466518414985263
cycle= 2 E= -75.2629125920112  delta_E= -0.0216  |g|= 0.0454  |ddm|= 0.348
HOMO (B2u) = -0.316770424633127  LUMO (B3u) = -0.00980180087757394
cycle= 3 E= -75.2641493459228  delta_E= -0.00124  |g|= 0.0169  |ddm|= 0.0593
HOMO (B2u) = -0.321075514288454  LUMO (B3u) = -0.0139142694602821
cycle= 4 E= -75.2643552043107  delta_E= -0.000206  |g|= 0.000645  |ddm|= 0.0339
HOMO (B2u) = -0.321213308623815  LUMO (B3u) = -0.0141930697532581
cycle= 5 E= -75.2643553636796  delta_E= -1.59e-07  |g|= 0.000131  |ddm|= 0.00083
HOMO (B2u) = -0.321177935176443  LUMO (B3u) = -0.0141663723644067
cycle= 6 E= -75.2643553735705  delta_E= -9.89e-09  |g|= 1.94e-05  |ddm|= 0.000225
HOMO (B2u) = -0.321175177873363  LUMO (B3u) = -0.0141664898415933
cycle= 7 E= -75.2643553738138  delta_E= -2.43e-10  |g|= 1.96e-06  |ddm|= 3.98e-05
HOMO (B2u) = -0.321174743989191  LUMO (B3u) = -0.014166511843515
cycle= 8 E= -75.2643553738163  delta_E= -2.44e-12  |g|= 1.29e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.32117475133412  LUMO (B3u) = -0.0141665127831104
cycle= 9 E= -75.2643553738163  delta_E= -4.26e-14  |g|= 8.24e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.321174750586576  LUMO (B3u) = -0.0141665142924598
cycle= 10 E= -75.2643553738163  delta_E= 5.68e-14  |g|= 7.1e-09  |ddm|= 7e-09
HOMO (B2u) = -0.321174750649576  LUMO (B3u) = -0.0141665144489159
cycle= 11 E= -75.2643553738164  delta_E= -1.42e-13  |g|= 5.04e-09  |ddm|= 5.8e-09
HOMO (B2u) = -0.321174749547482  LUMO (B3u) = -0.0141665133016376
cycle= 12 E= -75.2643553738163  delta_E= 8.53e-14  |g|= 4.3e-09  |ddm|= 2.95e-09
HOMO (B2u) = -0.321174749705706  LUMO (B3u) = -0.0141665134762732
cycle= 13 E= -75.2643553738163  delta_E= 1.42e-14  |g|= 3.84e-09  |ddm|= 1.62e-09
HOMO (B2u) = -0.32117474927602  LUMO (B3u) = -0.0141665132806608
cycle= 14 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 8.46e-10  |ddm|= 7.27e-09
HOMO (B2u) = -0.321174749384366  LUMO (B3u) = -0.014166513317539
cycle= 15 E= -75.2643553738163  delta_E= -2.84e-14  |g|= 8.86e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.321174749309239  LUMO (B3u) = -0.0141665133032495
cycle= 16 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 8.1e-10  |ddm|= 1.02e-09
HOMO (B2u) = -0.321174749333789  LUMO (B3u) = -0.0141665132831036
cycle= 17 E= -75.2643553738164  delta_E= -8.53e-14  |g|= 9.48e-10  |ddm|= 1.05e-09
HOMO (B2u) = -0.321174749300585  LUMO (B3u) = -0.014166513266392
cycle= 18 E= -75.2643553738163  delta_E= 5.68e-14  |g|= 7.17e-10  |ddm|= 5.96e-10
HOMO (B2u) = -0.321174749296104  LUMO (B3u) = -0.0141665132754294
cycle= 19 E= -75.2643553738163  delta_E=    0  |g|= 5.51e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.321174749296214  LUMO (B3u) = -0.0141665132863445
cycle= 20 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 4.33e-10  |ddm|= 3.85e-10
HOMO (B2u) = -0.321174749283247  LUMO (B3u) = -0.0141665132819945
cycle= 21 E= -75.2643553738162  delta_E= 4.26e-14  |g|= 3.15e-10  |ddm|= 3.17e-10
HOMO (B2u) = -0.321174749272402  LUMO (B3u) = -0.0141665132798458
cycle= 22 E= -75.2643553738164  delta_E= -1.42e-13  |g|= 2.04e-10  |ddm|= 2.88e-10
HOMO (B2u) = -0.321174749269935  LUMO (B3u) = -0.0141665132773765
cycle= 23 E= -75.2643553738164  delta_E= -2.84e-14  |g|= 1.8e-10  |ddm|= 6.27e-11
HOMO (B2u) = -0.321174749264033  LUMO (B3u) = -0.0141665132745881
cycle= 24 E= -75.2643553738163  delta_E= 8.53e-14  |g|= 1.54e-10  |ddm|= 6.81e-11
HOMO (B2u) = -0.32117474926119  LUMO (B3u) = -0.0141665132723446
cycle= 25 E= -75.2643553738162  delta_E= 5.68e-14  |g|= 1.29e-10  |ddm|= 6.16e-11
HOMO (B2u) = -0.321174749257254  LUMO (B3u) = -0.0141665132707069
cycle= 26 E= -75.2643553738163  delta_E= -8.53e-14  |g|= 1.01e-10  |ddm|= 7.86e-11
HOMO (B2u) = -0.321174749254283  LUMO (B3u) = -0.0141665132694585
cycle= 27 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 8.15e-11  |ddm|= 5.99e-11
HOMO (B2u) = -0.32117474925187  LUMO (B3u) = -0.0141665132683588
cycle= 28 E= -75.2643553738163  delta_E= -2.84e-14  |g|= 6.48e-11  |ddm|= 4.52e-11
HOMO (B2u) = -0.32117474925002  LUMO (B3u) = -0.0141665132675095
cycle= 29 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 5.07e-11  |ddm|= 3.53e-11
HOMO (B2u) = -0.321174749248613  LUMO (B3u) = -0.0141665132668177
cycle= 30 E= -75.2643553738163  delta_E= 1.42e-14  |g|= 4.02e-11  |ddm|= 2.57e-11
HOMO (B2u) = -0.321174749247702  LUMO (B3u) = -0.0141665132663356
cycle= 31 E= -75.2643553738163  delta_E=    0  |g|= 3.34e-11  |ddm|= 1.64e-11
HOMO (B2u) = -0.321174749244674  LUMO (B3u) = -0.014166513264835
Extra cycle  E= -75.2643553738163  delta_E=    0  |g|= 1.18e-11  |ddm|= 5.32e-11
converged SCF energy = -75.2643553738163

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmply3ywsrv
max_memory 4000 MB (current use 410 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4176796778919  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4350360693864  dE = -0.017356391  S^2 = 0.0000000
               |grad[o]|=0.106  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4474226989436  dE = -0.01238663  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.117  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.454478806152  dE = -0.0070561072  S^2 = 0.0000000
               |grad[o]|=0.0502  |ddm|=0.0257  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4570100432575  dE = -0.0025312371  S^2 = 0.0000000
               |grad[o]|=0.0225  |ddm|= 0.11  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4582120425419  dE = -0.0012019993  S^2 = 0.0000000
               |grad[o]|=0.0117  |ddm|=0.0293  |maxRot[o]|=0.0599
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4583431399516  dE = -0.00013109741  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.013  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4583762943623  dE = -3.3154411e-05  S^2 = 0.0000000
               |grad[o]|=0.00212  |ddm|=0.00331  |maxRot[o]|=0.0127
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4583790907347  dE = -2.7963724e-06  S^2 = 0.0000000
               |grad[o]|=0.000733  |ddm|=0.00214  |maxRot[o]|=0.00372
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4583793249554  dE = -2.3422064e-07  S^2 = 0.0000000
               |grad[o]|=0.000228  |ddm|=0.000666  |maxRot[o]|=0.00107
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4583793444848  dE = -1.9529438e-08  S^2 = 0.0000000
               |grad[o]|=6.8e-05  |ddm|=0.0002  |maxRot[o]|=0.000307
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4583793461193  dE = -1.6344615e-09  S^2 = 0.0000000
               |grad[o]|=2e-05  |ddm|=5.91e-05  |maxRot[o]|=8.82e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4583793462596  dE = -1.4038903e-10  S^2 = 0.0000000
               |grad[o]|=5.87e-06  |ddm|=1.72e-05  |maxRot[o]|=2.55e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4583793462633  dE = -3.6806114e-12  S^2 = 0.0000000
               |grad[o]|=1.7e-06  |ddm|=4.77e-06  |maxRot[o]|=7.43e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95597942 1.93565101 1.85505357 1.67538719 0.06382152 0.32940982
 0.05567107 0.12902641]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01228   0.01069  -0.00190   0.00000   0.00000
  0 C 2s       0.69385   0.67734  -0.13470  -0.00000  -0.00000
  0 C 3s       0.00257   0.01477  -0.02786  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69376
  0 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  0 C 2pz      0.13475  -0.20184   0.69251   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06778
  0 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  0 C 3pz     -0.00941  -0.00168   0.01906  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02538  -0.00000
  0 C 3dz^2    0.01317  -0.01016   0.03314  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.11878
 0 C 3dx2-y2   0.00169   0.00594  -0.00676   0.00000  -0.00000
  1 C 1s       0.01228  -0.01069  -0.00190   0.00000   0.00000
  1 C 2s       0.69385  -0.67734  -0.13470   0.00000  -0.00000
  1 C 3s       0.00257  -0.01477  -0.02786  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69376
  1 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  1 C 2pz     -0.13475  -0.20184  -0.69251  -0.00000  -0.00000
  1 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06778
  1 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  1 C 3pz      0.00941  -0.00168  -0.01906   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.02538   0.00000
  1 C 3dz^2    0.01317   0.01016   0.03314  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11878
 1 C 3dx2-y2   0.00169  -0.00594  -0.00676  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.20120
  0 C 3s      -0.00000  -0.00000   0.02738
  0 C 2px     -0.00000   0.69868  -0.00000
  0 C 2py      0.70706  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.67682
  0 C 3px     -0.00000  -0.01985  -0.00000
  0 C 3py      0.00101  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02216
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00847   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00304
  0 C 3dxz    -0.00000  -0.10700  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01365
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s       0.00000   0.00000  -0.20120
  1 C 3s       0.00000   0.00000  -0.02738
  1 C 2px      0.00000  -0.69868   0.00000
  1 C 2py     -0.70706   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67682
  1 C 3px      0.00000   0.01985   0.00000
  1 C 3py     -0.00101   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02216
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00847  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00304
  1 C 3dxz    -0.00000  -0.10700  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01365
<CAS-nat-orb|mo-hf>  3  3    0.99758995
<CAS-nat-orb|mo-hf>  4  4    0.99962978
<CAS-nat-orb|mo-hf>  5  5    0.99755853
<CAS-nat-orb|mo-hf>  6  6    0.99855438
<CAS-nat-orb|mo-hf>  7  7    0.93305005
<CAS-nat-orb|mo-hf>  8  8    0.98603349
<CAS-nat-orb|mo-hf>  9  9    0.96086979
<CAS-nat-orb|mo-hf>  10  10    0.95616481
CASSCF energy = -75.4583793462633
CASCI E = -75.4583793462633  E(CI) = -14.8982403377175  S^2 = 0.0000000
......production of RDMs took       2.18 sec
......reading the RDM took          0.42 sec
......production of RDMs took      22.43 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.74 sec

E(WickICMRREPT2-ijrs) =    -0.00028069758066
E(WickICMRREPT2- rsi) =    -0.00087847990331
E(WickICMRREPT2- ijr) =    -0.00024584697947
E(WickICMRREPT2-  rs) =    -0.04905084397640
E(WickICMRREPT2-  ij) =    -0.00005473278645
E(WickICMRREPT2-  ir) =    -0.00103240796017
E(WickICMRREPT2-   r) =    -0.07205884773911
E(WickICMRREPT2-   i) =    -0.00005264022479
E(WickICMRREPT2) = -75.5820338434137  E_corr_pt = -0.1236544971503697
Timings = pdms =   34.78 | eris =    0.15 | ijrs =    1.17 | rsi =   32.39 | ijr =    0.43 | rs =  607.37 | ij =    1.22 | ir =   25.33 | r =  148.77 | i =    2.32 | total =  853.99
Time cost =    902.295
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 03:07:38 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.063791122588 AA    0.000000000000   0.000000000000   3.900000000000 Bohr   0.0

nuclear repulsion = 9.23076923076923
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    637490.01


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmptkb_pmiw
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6749703835052

WARN: Singularity detected in overlap matrix (condition number = 62.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0938346227346638  LUMO (B3u) = -0.0938346227346642

WARN: B2u HOMO -0.0938346227346638 > system LUMO -0.0938346227346642

cycle= 1 E= -75.2338921256662  delta_E= -0.559  |g|= 0.229  |ddm|= 1.46
HOMO (B2u) = -0.345853796512397  LUMO (B3u) = -0.0447783510681939
cycle= 2 E= -75.2552221736388  delta_E= -0.0213  |g|= 0.0449  |ddm|= 0.347
HOMO (B2u) = -0.31396896933006  LUMO (B3u) = -0.0083489041112017
cycle= 3 E= -75.2564345511741  delta_E= -0.00121  |g|= 0.0167  |ddm|= 0.0585
HOMO (B2u) = -0.318244577067679  LUMO (B3u) = -0.0124246975036454
cycle= 4 E= -75.256637209921  delta_E= -0.000203  |g|= 0.000641  |ddm|= 0.0335
HOMO (B2u) = -0.318367270990406  LUMO (B3u) = -0.0126861477138947
cycle= 5 E= -75.2566373684186  delta_E= -1.58e-07  |g|= 0.000132  |ddm|= 0.000824
HOMO (B2u) = -0.318332550664859  LUMO (B3u) = -0.0126605067829989
cycle= 6 E= -75.2566373785487  delta_E= -1.01e-08  |g|= 1.96e-05  |ddm|= 0.000227
HOMO (B2u) = -0.318329772186377  LUMO (B3u) = -0.0126605767315275
cycle= 7 E= -75.2566373787974  delta_E= -2.49e-10  |g|= 1.98e-06  |ddm|= 4.01e-05
HOMO (B2u) = -0.318329352566663  LUMO (B3u) = -0.0126606192769603
cycle= 8 E= -75.2566373788  delta_E= -2.61e-12  |g|= 1.29e-07  |ddm|= 4.15e-06
HOMO (B2u) = -0.318329361478883  LUMO (B3u) = -0.0126606212717472
cycle= 9 E= -75.2566373788  delta_E= 2.84e-14  |g|= 7.84e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.318329360676044  LUMO (B3u) = -0.0126606228038002
cycle= 10 E= -75.2566373788  delta_E= 2.84e-14  |g|= 6.9e-09  |ddm|= 6.79e-09
HOMO (B2u) = -0.318329360806367  LUMO (B3u) = -0.0126606230300551
cycle= 11 E= -75.2566373788  delta_E= -8.53e-14  |g|= 4.88e-09  |ddm|= 5.61e-09
HOMO (B2u) = -0.318329359796204  LUMO (B3u) = -0.0126606219766817
cycle= 12 E= -75.2566373787999  delta_E= 1.14e-13  |g|= 4.15e-09  |ddm|= 2.94e-09
HOMO (B2u) = -0.318329359932234  LUMO (B3u) = -0.012660622127556
cycle= 13 E= -75.2566373788  delta_E= -1.14e-13  |g|= 3.71e-09  |ddm|= 1.52e-09
HOMO (B2u) = -0.318329359524999  LUMO (B3u) = -0.0126606219552359
cycle= 14 E= -75.2566373788  delta_E= 5.68e-14  |g|= 7.6e-10  |ddm|= 7.09e-09
HOMO (B2u) = -0.318329359627905  LUMO (B3u) = -0.0126606219882067
cycle= 15 E= -75.2566373788  delta_E= 2.84e-14  |g|= 8.15e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.318329359564301  LUMO (B3u) = -0.0126606219758709
cycle= 16 E= -75.2566373788  delta_E= -2.84e-14  |g|= 7.5e-10  |ddm|= 8.56e-10
HOMO (B2u) = -0.318329359584675  LUMO (B3u) = -0.0126606219559464
cycle= 17 E= -75.2566373788  delta_E= -2.84e-14  |g|= 8.84e-10  |ddm|= 9.64e-10
HOMO (B2u) = -0.318329359554537  LUMO (B3u) = -0.0126606219418847
cycle= 18 E= -75.2566373788  delta_E= 2.84e-14  |g|= 6.71e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.318329359551986  LUMO (B3u) = -0.0126606219523459
cycle= 19 E= -75.2566373788  delta_E= -5.68e-14  |g|= 5.13e-10  |ddm|= 5.27e-10
HOMO (B2u) = -0.31832935955377  LUMO (B3u) = -0.0126606219645456
cycle= 20 E= -75.2566373788  delta_E= 2.84e-14  |g|= 4.03e-10  |ddm|= 3.62e-10
HOMO (B2u) = -0.318329359542913  LUMO (B3u) = -0.0126606219621725
cycle= 21 E= -75.2566373787999  delta_E= 8.53e-14  |g|= 2.92e-10  |ddm|= 2.94e-10
HOMO (B2u) = -0.318329359533704  LUMO (B3u) = -0.0126606219614883
cycle= 22 E= -75.2566373788  delta_E= -5.68e-14  |g|= 1.87e-10  |ddm|= 2.67e-10
HOMO (B2u) = -0.31832935953164  LUMO (B3u) = -0.0126606219592133
cycle= 23 E= -75.2566373788  delta_E=    0  |g|= 1.66e-10  |ddm|= 5.47e-11
HOMO (B2u) = -0.318329359526417  LUMO (B3u) = -0.0126606219567693
cycle= 24 E= -75.2566373788  delta_E= -2.84e-14  |g|= 1.41e-10  |ddm|= 6.17e-11
HOMO (B2u) = -0.31832935952383  LUMO (B3u) = -0.0126606219548533
cycle= 25 E= -75.2566373788  delta_E= 5.68e-14  |g|= 1.18e-10  |ddm|= 5.57e-11
HOMO (B2u) = -0.318329359520383  LUMO (B3u) = -0.0126606219536114
cycle= 26 E= -75.2566373788  delta_E= -2.84e-14  |g|= 9.25e-11  |ddm|= 7.12e-11
HOMO (B2u) = -0.318329359517801  LUMO (B3u) = -0.012660621952674
cycle= 27 E= -75.2566373788  delta_E=    0  |g|= 7.46e-11  |ddm|= 5.47e-11
HOMO (B2u) = -0.318329359511236  LUMO (B3u) = -0.0126606219498184
Extra cycle  E= -75.2566373788  delta_E= 2.84e-14  |g|= 2.55e-11  |ddm|= 1.24e-10
converged SCF energy = -75.2566373788

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmptkb_pmiw
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4143148843353  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4322089312408  dE = -0.017894047  S^2 = 0.0000000
               |grad[o]|=0.108  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4446390101756  dE = -0.012430079  S^2 = 0.0000000
               |grad[o]|=0.0797  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4513833169484  dE = -0.0067443068  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.0218  |maxRot[o]|=0.0798
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4535226182291  dE = -0.0021393013  S^2 = 0.0000000
               |grad[o]|=0.0191  |ddm|=0.109  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4543051838479  dE = -0.00078256562  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0227  |maxRot[o]|= 0.04
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4545713709203  dE = -0.00026618707  S^2 = 0.0000000
               |grad[o]|=0.00524  |ddm|=0.00808  |maxRot[o]|=0.0333
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4545949240895  dE = -2.3553169e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00574  |maxRot[o]|=0.0107
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4545969675312  dE = -2.0434417e-06  S^2 = 0.0000000
               |grad[o]|=0.000657  |ddm|=0.00185  |maxRot[o]|=0.00315
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4545971430737  dE = -1.7554251e-07  S^2 = 0.0000000
               |grad[o]|=0.000203  |ddm|=0.000583  |maxRot[o]|=0.000913
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4545971581105  dE = -1.5036804e-08  S^2 = 0.0000000
               |grad[o]|=6.12e-05  |ddm|=0.000176  |maxRot[o]|=0.000265
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4545971593834  dE = -1.2729089e-09  S^2 = 0.0000000
               |grad[o]|=1.82e-05  |ddm|=5.27e-05  |maxRot[o]|=7.71e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4545971594909  dE = -1.0753354e-10  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=1.57e-05  |maxRot[o]|=2.24e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4545971594996  dE = -8.6544105e-12  S^2 = 0.0000000
               |grad[o]|=1.57e-06  |ddm|=4.58e-06  |maxRot[o]|=6.58e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95573076 1.93626698 1.84718162 1.65763445 0.06292257 0.34695114
 0.05534507 0.13796741]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01234   0.01075  -0.00166   0.00000   0.00000
  0 C 2s       0.69629   0.67936  -0.12152  -0.00000  -0.00000
  0 C 3s       0.00370   0.01459  -0.02605   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69387
  0 C 2py     -0.00000   0.00000   0.00000   0.70453  -0.00000
  0 C 2pz      0.12164  -0.19495   0.69500  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06838
  0 C 3py     -0.00000   0.00000  -0.00000   0.05527   0.00000
  0 C 3pz     -0.00884  -0.00169   0.02073   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02424   0.00000
  0 C 3dz^2    0.01200  -0.00982   0.03250   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.11777
 0 C 3dx2-y2   0.00188   0.00585  -0.00666  -0.00000  -0.00000
  1 C 1s       0.01234  -0.01075  -0.00166   0.00000   0.00000
  1 C 2s       0.69629  -0.67936  -0.12152  -0.00000   0.00000
  1 C 3s       0.00370  -0.01459  -0.02605  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69387
  1 C 2py      0.00000  -0.00000   0.00000   0.70453  -0.00000
  1 C 2pz     -0.12164  -0.19495  -0.69500  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06838
  1 C 3py      0.00000  -0.00000  -0.00000   0.05527   0.00000
  1 C 3pz      0.00884  -0.00169  -0.02073   0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.02424  -0.00000
  1 C 3dz^2    0.01200   0.00982   0.03250  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.11777
 1 C 3dx2-y2   0.00188  -0.00585  -0.00666   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00021
  0 C 2s      -0.00000  -0.00000   0.19437
  0 C 3s       0.00000  -0.00000   0.02640
  0 C 2px     -0.00000   0.69881  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.67895
  0 C 3px      0.00000  -0.02144   0.00000
  0 C 3py      0.00283  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01949
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00809  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00255
  0 C 3dxz     0.00000  -0.10583   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01271
  1 C 1s       0.00000   0.00000   0.00021
  1 C 2s      -0.00000   0.00000  -0.19437
  1 C 3s       0.00000   0.00000  -0.02640
  1 C 2px     -0.00000  -0.69881  -0.00000
  1 C 2py     -0.70705   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67895
  1 C 3px      0.00000   0.02144   0.00000
  1 C 3py     -0.00283  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01949
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00809  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00255
  1 C 3dxz    -0.00000  -0.10583  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.01271
<CAS-nat-orb|mo-hf>  3  3    0.99692136
<CAS-nat-orb|mo-hf>  4  4    0.99961325
<CAS-nat-orb|mo-hf>  5  5    0.99687558
<CAS-nat-orb|mo-hf>  6  6    0.99848189
<CAS-nat-orb|mo-hf>  7  7    0.93292275
<CAS-nat-orb|mo-hf>  8  8    0.98684296
<CAS-nat-orb|mo-hf>  9  9    0.96096128
<CAS-nat-orb|mo-hf>  10  10    0.95978892
CASSCF energy = -75.4545971594996
CASCI E = -75.4545971594996  E(CI) = -14.8412429814276  S^2 = 0.0000000
......production of RDMs took       2.56 sec
......reading the RDM took          0.45 sec
......production of RDMs took      27.01 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.71 sec

E(WickICMRREPT2-ijrs) =    -0.00028252600027
E(WickICMRREPT2- rsi) =    -0.00088286922246
E(WickICMRREPT2- ijr) =    -0.00024450305214
E(WickICMRREPT2-  rs) =    -0.04894341025676
E(WickICMRREPT2-  ij) =    -0.00005334419195
E(WickICMRREPT2-  ir) =    -0.00102912331917
E(WickICMRREPT2-   r) =    -0.07243713938673
E(WickICMRREPT2-   i) =    -0.00005025970443
E(WickICMRREPT2) = -75.57852033463348  E_corr_pt = -0.1239231751339147
Timings = pdms =   39.73 | eris =    0.17 | ijrs =    1.18 | rsi =   34.03 | ijr =    0.43 | rs =  615.71 | ij =    1.27 | ir =   24.25 | r =  153.68 | i =    2.31 | total =  872.82
Time cost =    934.476
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 03:23:13 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.090249983134 AA    0.000000000000   0.000000000000   3.950000000000 Bohr   0.0

nuclear repulsion = 9.11392405063291
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    651464.80


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpa7q7l49e
max_memory 4000 MB (current use 399 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6663316753772

WARN: Singularity detected in overlap matrix (condition number = 58.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0915415140147806  LUMO (B3u) = -0.0915415140147811

WARN: B2u HOMO -0.0915415140147806 > system LUMO -0.0915415140147811

cycle= 1 E= -75.2265361682302  delta_E= -0.56  |g|= 0.228  |ddm|= 1.46
HOMO (B2u) = -0.342768719019987  LUMO (B3u) = -0.042983571759442
cycle= 2 E= -75.2476350005993  delta_E= -0.0211  |g|= 0.0444  |ddm|= 0.347
HOMO (B2u) = -0.311266865337973  LUMO (B3u) = -0.00695392831510836
cycle= 3 E= -75.2488230162567  delta_E= -0.00119  |g|= 0.0166  |ddm|= 0.0577
HOMO (B2u) = -0.315511002797547  LUMO (B3u) = -0.0109908406189053
cycle= 4 E= -75.24902239302  delta_E= -0.000199  |g|= 0.000637  |ddm|= 0.0332
HOMO (B2u) = -0.315616573066831  LUMO (B3u) = -0.0112327274277425
cycle= 5 E= -75.2490225504907  delta_E= -1.57e-07  |g|= 0.000134  |ddm|= 0.000817
HOMO (B2u) = -0.315582567140401  LUMO (B3u) = -0.0112081163367531
cycle= 6 E= -75.2490225608018  delta_E= -1.03e-08  |g|= 1.98e-05  |ddm|= 0.000228
HOMO (B2u) = -0.315579772310327  LUMO (B3u) = -0.0112081376157164
cycle= 7 E= -75.249022561055  delta_E= -2.53e-10  |g|= 2e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.315579365287541  LUMO (B3u) = -0.0112081994129467
cycle= 8 E= -75.2490225610576  delta_E= -2.61e-12  |g|= 1.29e-07  |ddm|= 4.21e-06
HOMO (B2u) = -0.315579376014243  LUMO (B3u) = -0.0112082026369772
cycle= 9 E= -75.2490225610575  delta_E= 8.53e-14  |g|= 7.39e-09  |ddm|= 3.13e-07
HOMO (B2u) = -0.315579375157587  LUMO (B3u) = -0.0112082041964936
cycle= 10 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 6.69e-09  |ddm|= 6.7e-09
HOMO (B2u) = -0.315579375371382  LUMO (B3u) = -0.0112082045101189
cycle= 11 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 4.7e-09  |ddm|= 5.41e-09
HOMO (B2u) = -0.315579374456197  LUMO (B3u) = -0.0112082035521318
cycle= 12 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 3.99e-09  |ddm|= 2.87e-09
HOMO (B2u) = -0.315579374574266  LUMO (B3u) = -0.0112082036830304
cycle= 13 E= -75.2490225610576  delta_E= -8.53e-14  |g|= 3.56e-09  |ddm|= 1.42e-09
HOMO (B2u) = -0.315579374205103  LUMO (B3u) = -0.011208203535021
cycle= 14 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 7.07e-10  |ddm|= 6.55e-09
HOMO (B2u) = -0.315579374303732  LUMO (B3u) = -0.0112082035701818
cycle= 15 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 7.47e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.315579374235871  LUMO (B3u) = -0.0112082035595249
cycle= 16 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 6.58e-10  |ddm|= 8.71e-10
HOMO (B2u) = -0.315579374257516  LUMO (B3u) = -0.0112082035348675
cycle= 17 E= -75.2490225610575  delta_E= 5.68e-14  |g|= 8.09e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.31557937423099  LUMO (B3u) = -0.0112082035235059
cycle= 18 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 6.15e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.315579374230776  LUMO (B3u) = -0.0112082035355429
cycle= 19 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 4.69e-10  |ddm|= 4.87e-10
HOMO (B2u) = -0.315579374234715  LUMO (B3u) = -0.011208203549235
cycle= 20 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 3.69e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.315579374226396  LUMO (B3u) = -0.0112082035490356
cycle= 21 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 2.66e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.31557937421922  LUMO (B3u) = -0.01120820355
cycle= 22 E= -75.2490225610577  delta_E= -5.68e-14  |g|= 1.68e-10  |ddm|= 2.4e-10
HOMO (B2u) = -0.315579374217421  LUMO (B3u) = -0.0112082035480982
cycle= 23 E= -75.2490225610576  delta_E= 8.53e-14  |g|= 1.48e-10  |ddm|= 4.95e-11
HOMO (B2u) = -0.31557937421255  LUMO (B3u) = -0.0112082035458914
cycle= 24 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 1.26e-10  |ddm|= 5.57e-11
HOMO (B2u) = -0.315579374210539  LUMO (B3u) = -0.011208203544201
cycle= 25 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 1.06e-10  |ddm|= 4.69e-11
HOMO (B2u) = -0.315579374207679  LUMO (B3u) = -0.0112082035434076
cycle= 26 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 8.31e-11  |ddm|= 6.17e-11
HOMO (B2u) = -0.315579374205554  LUMO (B3u) = -0.0112082035428182
cycle= 27 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 6.76e-11  |ddm|= 4.77e-11
HOMO (B2u) = -0.315579374203758  LUMO (B3u) = -0.0112082035421916
cycle= 28 E= -75.2490225610576  delta_E=    0  |g|= 5.41e-11  |ddm|= 3.54e-11
HOMO (B2u) = -0.315579374199408  LUMO (B3u) = -0.0112082035404652
Extra cycle  E= -75.2490225610576  delta_E= -2.84e-14  |g|= 1.92e-11  |ddm|= 8.23e-11
converged SCF energy = -75.2490225610576

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpa7q7l49e
max_memory 4000 MB (current use 404 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4110790881554  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.429526072551  dE = -0.018446984  S^2 = 0.0000000
               |grad[o]|= 0.11  |ddm|= 3.74  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4419549870787  dE = -0.012428915  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.127  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4482968221556  dE = -0.0063418351  S^2 = 0.0000000
               |grad[o]|=0.0462  |ddm|=0.0237  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4501430171592  dE = -0.001846195  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.104  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4507876396847  dE = -0.00064462253  S^2 = 0.0000000
               |grad[o]|=0.00867  |ddm|=0.0182  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4509297658619  dE = -0.00014212618  S^2 = 0.0000000
               |grad[o]|=0.00428  |ddm|=0.00737  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4509686911439  dE = -3.8925282e-05  S^2 = 0.0000000
               |grad[o]|=0.00227  |ddm|=0.00337  |maxRot[o]|=0.0135
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4509721356548  dE = -3.4445109e-06  S^2 = 0.0000000
               |grad[o]|=0.000835  |ddm|=0.00232  |maxRot[o]|=0.00406
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4509724412339  dE = -3.0557916e-07  S^2 = 0.0000000
               |grad[o]|=0.000269  |ddm|=0.000751  |maxRot[o]|=0.0012
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4509724682703  dE = -2.7036393e-08  S^2 = 0.0000000
               |grad[o]|=8.26e-05  |ddm|=0.000234  |maxRot[o]|=0.000351
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4509724706799  dE = -2.4095499e-09  S^2 = 0.0000000
               |grad[o]|=2.5e-05  |ddm|=7.12e-05  |maxRot[o]|=0.000104
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4509724708869  dE = -2.0699531e-10  S^2 = 0.0000000
               |grad[o]|=7.49e-06  |ddm|=2.18e-05  |maxRot[o]|=3.08e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4509724709117  dE = -2.4797941e-11  S^2 = 0.0000000
               |grad[o]|=2.29e-06  |ddm|=6.43e-06  |maxRot[o]|=8.97e-06
2-step CASSCF converged in 13 macro (48 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95553917 1.93688266 1.83858342 1.63915689 0.06206762 0.36520863
 0.05501491 0.1475467 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01239   0.01081  -0.00143   0.00000   0.00000
  0 C 2s       0.69827   0.68127  -0.10961  -0.00000   0.00000
  0 C 3s       0.00470   0.01443  -0.02431  -0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000   0.00000   0.69401
  0 C 2py     -0.00000  -0.00000  -0.00000   0.70457   0.00000
  0 C 2pz      0.10978  -0.18822   0.69702  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  0 C 3py     -0.00000   0.00000   0.00000   0.05523   0.00000
  0 C 3pz     -0.00833  -0.00170   0.02237  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02312   0.00000
  0 C 3dz^2    0.01091  -0.00949   0.03179  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000  -0.00000  -0.11663
 0 C 3dx2-y2   0.00204   0.00576  -0.00656   0.00000  -0.00000
  1 C 1s       0.01239  -0.01081  -0.00143   0.00000   0.00000
  1 C 2s       0.69827  -0.68127  -0.10961   0.00000  -0.00000
  1 C 3s       0.00470  -0.01443  -0.02431   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69401
  1 C 2py      0.00000  -0.00000   0.00000   0.70457  -0.00000
  1 C 2pz     -0.10978  -0.18822  -0.69702   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  1 C 3py      0.00000   0.00000   0.00000   0.05523   0.00000
  1 C 3pz      0.00833  -0.00170  -0.02237  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000  -0.02312  -0.00000
  1 C 3dz^2    0.01091   0.00949   0.03179   0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000   0.00000   0.11663
 1 C 3dx2-y2   0.00204  -0.00576  -0.00656   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s      -0.00000   0.00000   0.18769
  0 C 3s       0.00000  -0.00000   0.02542
  0 C 2px      0.00000   0.69895  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.68096
  0 C 3px      0.00000  -0.02298  -0.00000
  0 C 3py      0.00461   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01682
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00772   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00210
  0 C 3dxz     0.00000  -0.10461  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01180
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.18769
  1 C 3s       0.00000   0.00000  -0.02542
  1 C 2px     -0.00000  -0.69895   0.00000
  1 C 2py     -0.70705  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.68096
  1 C 3px     -0.00000   0.02298   0.00000
  1 C 3py     -0.00461  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01682
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00772  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00210
  1 C 3dxz     0.00000  -0.10461  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01180
<CAS-nat-orb|mo-hf>  3  3    0.99630523
<CAS-nat-orb|mo-hf>  4  4    0.99959512
<CAS-nat-orb|mo-hf>  5  5    0.99624282
<CAS-nat-orb|mo-hf>  6  6    0.99840712
<CAS-nat-orb|mo-hf>  7  7    0.93287017
<CAS-nat-orb|mo-hf>  8  8    0.98760133
<CAS-nat-orb|mo-hf>  9  9    0.96104580
<CAS-nat-orb|mo-hf>  10  10    0.96307389
CASSCF energy = -75.4509724709117
CASCI E = -75.4509724709117  E(CI) = -14.7857465824137  S^2 = 0.0000000
......production of RDMs took       2.36 sec
......reading the RDM took          0.45 sec
......production of RDMs took      25.44 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.69 sec

E(WickICMRREPT2-ijrs) =    -0.00028437036575
E(WickICMRREPT2- rsi) =    -0.00088741672795
E(WickICMRREPT2- ijr) =    -0.00024318159958
E(WickICMRREPT2-  rs) =    -0.04885153189116
E(WickICMRREPT2-  ij) =    -0.00005204158687
E(WickICMRREPT2-  ir) =    -0.00102620059318
E(WickICMRREPT2-   r) =    -0.07278994576700
E(WickICMRREPT2-   i) =    -0.00004799357886
E(WickICMRREPT2) = -75.57515515302202  E_corr_pt = -0.1241826821103498
Timings = pdms =   37.96 | eris =    0.09 | ijrs =    1.15 | rsi =   33.67 | ijr =    0.68 | rs =  603.98 | ij =    1.33 | ir =   23.89 | r =  141.97 | i =    2.30 | total =  847.11
Time cost =    926.904
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 03:38:39 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.116708843680 AA    0.000000000000   0.000000000000   4.000000000000 Bohr   0.0

nuclear repulsion = 9
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 2.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    664778.40


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmphsp8415x
max_memory 4000 MB (current use 457 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.65829474285

WARN: Singularity detected in overlap matrix (condition number = 55.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0893486438705831  LUMO (B3u) = -0.089348643870583

WARN: B2u HOMO -0.0893486438705831 > system LUMO -0.089348643870583

cycle= 1 E= -75.2192687068769  delta_E= -0.561  |g|= 0.226  |ddm|= 1.45
HOMO (B2u) = -0.339798299416297  LUMO (B3u) = -0.0412658624563732
cycle= 2 E= -75.240154283596  delta_E= -0.0209  |g|= 0.0439  |ddm|= 0.347
HOMO (B2u) = -0.308660706394017  LUMO (B3u) = -0.00561531074292594
cycle= 3 E= -75.2413180659383  delta_E= -0.00116  |g|= 0.0164  |ddm|= 0.0569
HOMO (B2u) = -0.312871203858108  LUMO (B3u) = -0.00961084060265091
cycle= 4 E= -75.2415141140048  delta_E= -0.000196  |g|= 0.000633  |ddm|= 0.0328
HOMO (B2u) = -0.312958040513248  LUMO (B3u) = -0.00983140550670288
cycle= 5 E= -75.2415142702404  delta_E= -1.56e-07  |g|= 0.000135  |ddm|= 0.00081
HOMO (B2u) = -0.312924808517805  LUMO (B3u) = -0.0098077939898597
cycle= 6 E= -75.2415142806734  delta_E= -1.04e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.312922000715267  LUMO (B3u) = -0.00980776379454729
cycle= 7 E= -75.2415142809298  delta_E= -2.56e-10  |g|= 2.02e-06  |ddm|= 4.04e-05
HOMO (B2u) = -0.312921604622301  LUMO (B3u) = -0.00980784357419288
cycle= 8 E= -75.2415142809325  delta_E= -2.7e-12  |g|= 1.28e-07  |ddm|= 4.27e-06
HOMO (B2u) = -0.312921617365365  LUMO (B3u) = -0.00980784817124689
cycle= 9 E= -75.2415142809324  delta_E= 5.68e-14  |g|= 6.97e-09  |ddm|= 3.09e-07
HOMO (B2u) = -0.312921616457898  LUMO (B3u) = -0.00980784977173238
cycle= 10 E= -75.2415142809325  delta_E= -4.26e-14  |g|= 6.48e-09  |ddm|= 6.77e-09
HOMO (B2u) = -0.312921616764895  LUMO (B3u) = -0.00980785017752405
cycle= 11 E= -75.2415142809324  delta_E= 7.11e-14  |g|= 4.52e-09  |ddm|= 5.1e-09
HOMO (B2u) = -0.312921615944448  LUMO (B3u) = -0.00980784931581449
cycle= 12 E= -75.2415142809324  delta_E= -2.84e-14  |g|= 3.83e-09  |ddm|= 2.8e-09
HOMO (B2u) = -0.312921616048626  LUMO (B3u) = -0.0098078494280144
cycle= 13 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 3.44e-09  |ddm|= 1.26e-09
HOMO (B2u) = -0.312921615711825  LUMO (B3u) = -0.00980784930689641
cycle= 14 E= -75.2415142809325  delta_E= -8.53e-14  |g|= 6.03e-10  |ddm|= 6.18e-09
HOMO (B2u) = -0.3129216158198  LUMO (B3u) = -0.00980784934704755
cycle= 15 E= -75.2415142809325  delta_E= 2.84e-14  |g|= 6.91e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615748247  LUMO (B3u) = -0.00980784933458488
cycle= 16 E= -75.2415142809325  delta_E=    0  |g|= 5.82e-10  |ddm|= 9.48e-10
HOMO (B2u) = -0.312921615768308  LUMO (B3u) = -0.00980784930669941
cycle= 17 E= -75.2415142809324  delta_E= 4.26e-14  |g|= 7.32e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615745719  LUMO (B3u) = -0.00980784929797579
cycle= 18 E= -75.2415142809325  delta_E= -7.11e-14  |g|= 5.57e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.312921615748312  LUMO (B3u) = -0.00980784931172766
cycle= 19 E= -75.2415142809324  delta_E= 7.11e-14  |g|= 4.24e-10  |ddm|= 4.38e-10
HOMO (B2u) = -0.312921615754728  LUMO (B3u) = -0.00980784932707214
cycle= 20 E= -75.2415142809325  delta_E= -4.26e-14  |g|= 3.34e-10  |ddm|= 2.92e-10
HOMO (B2u) = -0.312921615749237  LUMO (B3u) = -0.0098078493291206
cycle= 21 E= -75.2415142809325  delta_E=    0  |g|= 2.39e-10  |ddm|= 2.29e-10
HOMO (B2u) = -0.312921615744363  LUMO (B3u) = -0.00980784933188358
cycle= 22 E= -75.2415142809325  delta_E= -1.42e-14  |g|= 1.48e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.312921615743177  LUMO (B3u) = -0.0098078493302657
cycle= 23 E= -75.2415142809325  delta_E= 1.42e-14  |g|= 1.31e-10  |ddm|= 3.98e-11
HOMO (B2u) = -0.312921615738651  LUMO (B3u) = -0.00980784932825231
cycle= 24 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 1.11e-10  |ddm|= 5.14e-11
HOMO (B2u) = -0.312921615737189  LUMO (B3u) = -0.00980784932686139
cycle= 25 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 9.34e-11  |ddm|= 3.98e-11
HOMO (B2u) = -0.312921615735014  LUMO (B3u) = -0.00980784932655905
cycle= 26 E= -75.2415142809324  delta_E= -2.84e-14  |g|= 7.38e-11  |ddm|= 5.04e-11
HOMO (B2u) = -0.312921615733422  LUMO (B3u) = -0.00980784932634832
cycle= 27 E= -75.2415142809325  delta_E= -1.42e-14  |g|= 6.07e-11  |ddm|= 3.92e-11
HOMO (B2u) = -0.312921615732016  LUMO (B3u) = -0.00980784932599225
cycle= 28 E= -75.2415142809325  delta_E= -1.42e-14  |g|= 4.9e-11  |ddm|= 2.9e-11
HOMO (B2u) = -0.312921615730896  LUMO (B3u) = -0.00980784932567086
cycle= 29 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 3.84e-11  |ddm|= 2.31e-11
HOMO (B2u) = -0.312921615730033  LUMO (B3u) = -0.00980784932536469
cycle= 30 E= -75.2415142809325  delta_E=    0  |g|= 3.03e-11  |ddm|= 1.69e-11
HOMO (B2u) = -0.312921615727838  LUMO (B3u) = -0.00980784932454512
Extra cycle  E= -75.2415142809324  delta_E= 5.68e-14  |g|= 1.13e-11  |ddm|= 4.09e-11
converged SCF energy = -75.2415142809324

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmphsp8415x
max_memory 4000 MB (current use 457 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4079772031597  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4269928701509  dE = -0.019015667  S^2 = 0.0000000
               |grad[o]|=0.112  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4392401163901  dE = -0.012247246  S^2 = 0.0000000
               |grad[o]|=0.0794  |ddm|=0.133  |maxRot[o]|=0.079
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4451921759281  dE = -0.0059520595  S^2 = 0.0000000
               |grad[o]|=0.0445  |ddm|=0.0301  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4468428193049  dE = -0.0016506434  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.0981  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.447388881258  dE = -0.00054606195  S^2 = 0.0000000
               |grad[o]|=0.0077  |ddm|=0.0155  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4474923150795  dE = -0.00010343382  S^2 = 0.0000000
               |grad[o]|=0.00362  |ddm|=0.00704  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4475072129746  dE = -1.4897895e-05  S^2 = 0.0000000
               |grad[o]|=0.00159  |ddm|=0.00339  |maxRot[o]|=0.00836
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4475085952737  dE = -1.3822991e-06  S^2 = 0.0000000
               |grad[o]|=0.000559  |ddm|=0.00151  |maxRot[o]|=0.00253
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4475087228391  dE = -1.2756537e-07  S^2 = 0.0000000
               |grad[o]|=0.000179  |ddm|=0.000495  |maxRot[o]|=0.000757
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4475087345608  dE = -1.1721738e-08  S^2 = 0.0000000
               |grad[o]|=5.56e-05  |ddm|=0.000156  |maxRot[o]|=0.000227
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4475087356465  dE = -1.0856382e-09  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=4.8e-05  |maxRot[o]|=6.85e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4475087357395  dE = -9.3038466e-11  S^2 = 0.0000000
               |grad[o]|=5.27e-06  |ddm|=1.47e-05  |maxRot[o]|=2.04e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95539885 1.93749708 1.8292365  1.61997882 0.06124694 0.38415954
 0.05468074 0.15780153]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01243   0.01086  -0.00123   0.00000   0.00000
  0 C 2s       0.69987   0.68306  -0.09890  -0.00000   0.00000
  0 C 3s       0.00559   0.01429  -0.02264   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.69417
  0 C 2py      0.00000  -0.00000  -0.00000   0.70461   0.00000
  0 C 2pz      0.09912  -0.18163   0.69866   0.00000   0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.06942
  0 C 3py      0.00000  -0.00000  -0.00000   0.05510   0.00000
  0 C 3pz     -0.00787  -0.00173   0.02398   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02202   0.00000
  0 C 3dz^2    0.00990  -0.00917   0.03103   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.11537
 0 C 3dx2-y2   0.00220   0.00568  -0.00646   0.00000   0.00000
  1 C 1s       0.01243  -0.01086  -0.00123   0.00000   0.00000
  1 C 2s       0.69987  -0.68306  -0.09890  -0.00000   0.00000
  1 C 3s       0.00559  -0.01429  -0.02264  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000  -0.00000  -0.00000   0.69417
  1 C 2py     -0.00000   0.00000   0.00000   0.70461  -0.00000
  1 C 2pz     -0.09912  -0.18163  -0.69866   0.00000   0.00000
  1 C 3px      0.00000   0.00000  -0.00000  -0.00000  -0.06942
  1 C 3py     -0.00000   0.00000   0.00000   0.05510  -0.00000
  1 C 3pz      0.00787  -0.00173  -0.02398   0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02202  -0.00000
  1 C 3dz^2    0.00990   0.00917   0.03103  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000   0.11537
 1 C 3dx2-y2   0.00220  -0.00568  -0.00646  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00018
  0 C 2s      -0.00000  -0.00000   0.18114
  0 C 3s      -0.00000   0.00000   0.02444
  0 C 2px      0.00000   0.69909   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.68284
  0 C 3px     -0.00000  -0.02448   0.00000
  0 C 3py      0.00635  -0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.01417
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00736   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00169
  0 C 3dxz    -0.00000  -0.10334   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01092
  1 C 1s       0.00000   0.00000   0.00018
  1 C 2s       0.00000  -0.00000  -0.18114
  1 C 3s       0.00000  -0.00000  -0.02444
  1 C 2px      0.00000  -0.69909  -0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.68284
  1 C 3px     -0.00000   0.02448  -0.00000
  1 C 3py     -0.00635  -0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01417
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00736   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00169
  1 C 3dxz     0.00000  -0.10334   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01092
<CAS-nat-orb|mo-hf>  3  3    0.99576781
<CAS-nat-orb|mo-hf>  4  4    0.99957524
<CAS-nat-orb|mo-hf>  5  5    0.99568632
<CAS-nat-orb|mo-hf>  6  6    0.99833014
<CAS-nat-orb|mo-hf>  7  7    0.93288519
<CAS-nat-orb|mo-hf>  8  8    0.98831105
<CAS-nat-orb|mo-hf>  9  9    0.96112500
<CAS-nat-orb|mo-hf>  10  10    0.96605593
CASSCF energy = -75.4475087357395
CASCI E = -75.4475087357395  E(CI) = -14.731704557655  S^2 = 0.0000000
......production of RDMs took       2.76 sec
......reading the RDM took          0.41 sec
......production of RDMs took      24.27 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICMRREPT2-ijrs) =    -0.00028621416468
E(WickICMRREPT2- rsi) =    -0.00089207768077
E(WickICMRREPT2- ijr) =    -0.00024187466209
E(WickICMRREPT2-  rs) =    -0.04877496137999
E(WickICMRREPT2-  ij) =    -0.00005082078098
E(WickICMRREPT2-  ir) =    -0.00102361114045
E(WickICMRREPT2-   r) =    -0.07311621714753
E(WickICMRREPT2-   i) =    -0.00004583427743
E(WickICMRREPT2) = -75.57194034697345  E_corr_pt = -0.1244316112339316
Timings = pdms =   37.17 | eris =    0.09 | ijrs =    1.18 | rsi =   32.38 | ijr =    0.42 | rs =  605.48 | ij =    1.24 | ir =   24.81 | r =  149.66 | i =    2.29 | total =  854.79
Time cost =    923.691
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 03:54:03 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.143167704226 AA    0.000000000000   0.000000000000   4.050000000000 Bohr   0.0

nuclear repulsion = 8.88888888888889
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    678369.39


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmparspesl4
max_memory 4000 MB (current use 401 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.650821541947

WARN: Singularity detected in overlap matrix (condition number = 52.1). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0872509906487012  LUMO (B3u) = -0.0872509906487013

WARN: B2u HOMO -0.0872509906487012 > system LUMO -0.0872509906487013

cycle= 1 E= -75.2120928138537  delta_E= -0.561  |g|= 0.225  |ddm|= 1.45
HOMO (B2u) = -0.336938998033694  LUMO (B3u) = -0.039623429472366
cycle= 2 E= -75.2327826177341  delta_E= -0.0207  |g|= 0.0434  |ddm|= 0.347
HOMO (B2u) = -0.306147078592025  LUMO (B3u) = -0.00433141905845615
cycle= 3 E= -75.2339223949765  delta_E= -0.00114  |g|= 0.0162  |ddm|= 0.0561
HOMO (B2u) = -0.310321597199802  LUMO (B3u) = -0.00828279864970779
cycle= 4 E= -75.2341150976661  delta_E= -0.000193  |g|= 0.000629  |ddm|= 0.0325
HOMO (B2u) = -0.310388518956864  LUMO (B3u) = -0.00848075571953698
cycle= 5 E= -75.234115252423  delta_E= -1.55e-07  |g|= 0.000135  |ddm|= 0.000802
HOMO (B2u) = -0.310356121170237  LUMO (B3u) = -0.00845811286980654
cycle= 6 E= -75.2341152629183  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.310353302460648  LUMO (B3u) = -0.00845802697819558
cycle= 7 E= -75.2341152631768  delta_E= -2.58e-10  |g|= 2.04e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.31035291562213  LUMO (B3u) = -0.00845812345205348
cycle= 8 E= -75.2341152631794  delta_E= -2.56e-12  |g|= 1.28e-07  |ddm|= 4.34e-06
HOMO (B2u) = -0.310352930535472  LUMO (B3u) = -0.00845812953635656
cycle= 9 E= -75.2341152631794  delta_E= -2.84e-14  |g|= 6.66e-09  |ddm|= 3.04e-07
HOMO (B2u) = -0.310352929581329  LUMO (B3u) = -0.0084581311964563
cycle= 10 E= -75.2341152631795  delta_E= -7.11e-14  |g|= 6.3e-09  |ddm|= 7.02e-09
HOMO (B2u) = -0.310352929988323  LUMO (B3u) = -0.00845813169569619
cycle= 11 E= -75.2341152631795  delta_E= 1.42e-14  |g|= 4.39e-09  |ddm|= 4.7e-09
HOMO (B2u) = -0.3103529292581  LUMO (B3u) = -0.0084581309235004
cycle= 12 E= -75.2341152631795  delta_E=    0  |g|= 3.72e-09  |ddm|= 2.69e-09
HOMO (B2u) = -0.310352929350442  LUMO (B3u) = -0.0084581310189834
cycle= 13 E= -75.2341152631795  delta_E=    0  |g|= 3.35e-09  |ddm|= 1.1e-09
HOMO (B2u) = -0.310352929050718  LUMO (B3u) = -0.00845813092930559
cycle= 14 E= -75.2341152631795  delta_E=    0  |g|= 5.26e-10  |ddm|= 5.83e-09
HOMO (B2u) = -0.310352929162653  LUMO (B3u) = -0.00845813096843019
cycle= 15 E= -75.2341152631795  delta_E= -4.26e-14  |g|= 6.38e-10  |ddm|= 1.08e-09
HOMO (B2u) = -0.310352929093772  LUMO (B3u) = -0.00845813095605689
cycle= 16 E= -75.2341152631795  delta_E= 4.26e-14  |g|= 5.3e-10  |ddm|= 9.19e-10
HOMO (B2u) = -0.310352929110765  LUMO (B3u) = -0.0084581309266528
cycle= 17 E= -75.2341152631795  delta_E= -2.84e-14  |g|= 6.73e-10  |ddm|= 1.16e-09
HOMO (B2u) = -0.310352929092237  LUMO (B3u) = -0.00845813092040377
cycle= 18 E= -75.2341152631795  delta_E= 2.84e-14  |g|= 5.13e-10  |ddm|= 3e-10
HOMO (B2u) = -0.310352929098058  LUMO (B3u) = -0.00845813093596557
cycle= 19 E= -75.2341152631794  delta_E= 5.68e-14  |g|= 3.9e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.310352929107242  LUMO (B3u) = -0.00845813095310903
cycle= 20 E= -75.2341152631794  delta_E= -2.84e-14  |g|= 3.09e-10  |ddm|= 2.49e-10
HOMO (B2u) = -0.310352929104751  LUMO (B3u) = -0.00845813095747681
cycle= 21 E= -75.2341152631794  delta_E=    0  |g|= 2.2e-10  |ddm|= 1.93e-10
HOMO (B2u) = -0.310352929102355  LUMO (B3u) = -0.00845813096211343
cycle= 22 E= -75.2341152631795  delta_E= -5.68e-14  |g|= 1.33e-10  |ddm|= 1.79e-10
HOMO (B2u) = -0.310352929101776  LUMO (B3u) = -0.00845813096067433
cycle= 23 E= -75.2341152631795  delta_E= -2.84e-14  |g|= 1.19e-10  |ddm|= 3.46e-11
HOMO (B2u) = -0.310352929097861  LUMO (B3u) = -0.00845813095900033
cycle= 24 E= -75.2341152631794  delta_E= 8.53e-14  |g|= 1e-10  |ddm|= 4.73e-11
HOMO (B2u) = -0.310352929096954  LUMO (B3u) = -0.00845813095799178
cycle= 25 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 8.42e-11  |ddm|= 3.49e-11
HOMO (B2u) = -0.310352929095532  LUMO (B3u) = -0.00845813095820708
cycle= 26 E= -75.2341152631794  delta_E= -4.26e-14  |g|= 6.69e-11  |ddm|= 3.86e-11
HOMO (B2u) = -0.310352929094524  LUMO (B3u) = -0.00845813095839687
cycle= 27 E= -75.2341152631794  delta_E= -4.26e-14  |g|= 5.58e-11  |ddm|= 3.03e-11
HOMO (B2u) = -0.310352929093543  LUMO (B3u) = -0.00845813095832693
cycle= 28 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 4.54e-11  |ddm|= 2.25e-11
HOMO (B2u) = -0.310352929092737  LUMO (B3u) = -0.00845813095821224
cycle= 29 E= -75.2341152631795  delta_E= -9.95e-14  |g|= 3.56e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.310352929092108  LUMO (B3u) = -0.00845813095805567
cycle= 30 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 2.82e-11  |ddm|= 1.4e-11
HOMO (B2u) = -0.310352929091715  LUMO (B3u) = -0.0084581309579067
cycle= 31 E= -75.2341152631794  delta_E=    0  |g|= 2.35e-11  |ddm|= 8.86e-12
HOMO (B2u) = -0.310352929090363  LUMO (B3u) = -0.00845813095754086
Extra cycle  E= -75.2341152631795  delta_E= -5.68e-14  |g|= 8.93e-12  |ddm|= 2.77e-11
converged SCF energy = -75.2341152631795

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmparspesl4
max_memory 4000 MB (current use 410 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.405013104616  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4242837882401  dE = -0.019270684  S^2 = 0.0000000
               |grad[o]|=0.114  |ddm|= 3.72  |maxRot[o]|=0.0784
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4363857272499  dE = -0.012101939  S^2 = 0.0000000
               |grad[o]|=0.0799  |ddm|=0.135  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4421036045574  dE = -0.0057178773  S^2 = 0.0000000
               |grad[o]|=0.0439  |ddm|=0.0337  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4436293618145  dE = -0.0015257573  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.0939  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4441199083498  dE = -0.00049054654  S^2 = 0.0000000
               |grad[o]|=0.00716  |ddm|=0.0142  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4441997253217  dE = -7.9816972e-05  S^2 = 0.0000000
               |grad[o]|=0.00326  |ddm|=0.00696  |maxRot[o]|=0.019
macro iter 7 (3 JK  0 micro), CASSCF E = -75.444207674456  dE = -7.9491343e-06  S^2 = 0.0000000
               |grad[o]|=0.00128  |ddm|=0.0033  |maxRot[o]|=0.00603
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4442084507923  dE = -7.7633632e-07  S^2 = 0.0000000
               |grad[o]|=0.000435  |ddm|=0.00116  |maxRot[o]|=0.00186
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4442085256887  dE = -7.4896406e-08  S^2 = 0.0000000
               |grad[o]|=0.00014  |ddm|=0.000383  |maxRot[o]|=0.000569
macro iter 10 (3 JK  0 micro), CASSCF E = -75.444208532894  dE = -7.2053297e-09  S^2 = 0.0000000
               |grad[o]|=4.42e-05  |ddm|=0.000122  |maxRot[o]|=0.000175
macro iter 11 (2 JK  0 micro), CASSCF E = -75.444208533582  dE = -6.8794748e-10  S^2 = 0.0000000
               |grad[o]|=1.38e-05  |ddm|=3.84e-05  |maxRot[o]|=5.39e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4442085336481  dE = -6.6080474e-11  S^2 = 0.0000000
               |grad[o]|=4.29e-06  |ddm|=1.2e-05  |maxRot[o]|=1.66e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95530405 1.93811148 1.81911524 1.60013605 0.06045908 0.40376984
 0.05434302 0.16876124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01246   0.01091  -0.00105   0.00000   0.00000
  0 C 2s       0.70117   0.68475  -0.08932   0.00000   0.00000
  0 C 3s       0.00639   0.01416  -0.02106   0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69435
  0 C 2py      0.00000   0.00000  -0.00000   0.70466  -0.00000
  0 C 2pz      0.08959  -0.17518   0.69998   0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06986
  0 C 3py     -0.00000   0.00000   0.00000   0.05490   0.00000
  0 C 3pz     -0.00744  -0.00175   0.02554   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.02095   0.00000
  0 C 3dz^2    0.00897  -0.00886   0.03021   0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11401
 0 C 3dx2-y2   0.00234   0.00560  -0.00636   0.00000   0.00000
  1 C 1s       0.01246  -0.01091  -0.00105   0.00000   0.00000
  1 C 2s       0.70117  -0.68475  -0.08932   0.00000   0.00000
  1 C 3s       0.00639  -0.01416  -0.02106  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70466  -0.00000
  1 C 2pz     -0.08959  -0.17518  -0.69998   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000   0.00000  -0.06986
  1 C 3py      0.00000  -0.00000   0.00000   0.05490  -0.00000
  1 C 3pz      0.00744  -0.00175  -0.02554   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02095   0.00000
  1 C 3dz^2    0.00897   0.00886   0.03021  -0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11401
 1 C 3dx2-y2   0.00234  -0.00560  -0.00636  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00016
  0 C 2s       0.00000   0.00000   0.17473
  0 C 3s       0.00000   0.00000   0.02347
  0 C 2px     -0.00000   0.69923   0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68460
  0 C 3px     -0.00000  -0.02593  -0.00000
  0 C 3py      0.00804  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.01155
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00702  -0.00000  -0.00000
  0 C 3dz^2    0.00000   0.00000   0.00132
  0 C 3dxz    -0.00000  -0.10203   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01008
  1 C 1s       0.00000   0.00000   0.00016
  1 C 2s      -0.00000  -0.00000  -0.17473
  1 C 3s      -0.00000  -0.00000  -0.02347
  1 C 2px      0.00000  -0.69923   0.00000
  1 C 2py     -0.70703   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68460
  1 C 3px      0.00000   0.02593  -0.00000
  1 C 3py     -0.00804   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.01155
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00702   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00132
  1 C 3dxz    -0.00000  -0.10203   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01008
<CAS-nat-orb|mo-hf>  3  3    0.99532683
<CAS-nat-orb|mo-hf>  4  4    0.99955353
<CAS-nat-orb|mo-hf>  5  5    0.99522359
<CAS-nat-orb|mo-hf>  6  6    0.99825105
<CAS-nat-orb|mo-hf>  7  7    0.93296321
<CAS-nat-orb|mo-hf>  8  8    0.98897441
<CAS-nat-orb|mo-hf>  9  9    0.96119969
<CAS-nat-orb|mo-hf>  10  10    0.96876542
CASSCF energy = -75.4442085336481
CASCI E = -75.4442085336481  E(CI) = -14.6790716900876  S^2 = 0.0000000
......production of RDMs took       2.08 sec
......reading the RDM took          0.42 sec
......production of RDMs took      23.49 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.70 sec

E(WickICMRREPT2-ijrs) =    -0.00028804315343
E(WickICMRREPT2- rsi) =    -0.00089681296652
E(WickICMRREPT2- ijr) =    -0.00024057695514
E(WickICMRREPT2-  rs) =    -0.04871337724004
E(WickICMRREPT2-  ij) =    -0.00004967694903
E(WickICMRREPT2-  ir) =    -0.00102132687916
E(WickICMRREPT2-   r) =    -0.07341587832317
E(WickICMRREPT2-   i) =    -0.00004378434052
E(WickICMRREPT2) = -75.56887801045508  E_corr_pt = -0.1246694768070074
Timings = pdms =   35.69 | eris =    0.04 | ijrs =    1.21 | rsi =   31.85 | ijr =    0.42 | rs =  608.81 | ij =    3.60 | ir =   27.89 | r =  153.65 | i =    2.29 | total =  865.61
Time cost =    929.922
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 04:09:33 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.169626564772 AA    0.000000000000   0.000000000000   4.100000000000 Bohr   0.0

nuclear repulsion = 8.78048780487805
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   2.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    692150.63


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp68wtkfwr
max_memory 4000 MB (current use 459 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.643876015773

WARN: Singularity detected in overlap matrix (condition number = 49.2). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0852438140031956  LUMO (B3u) = -0.0852438140031949

WARN: B2u HOMO -0.0852438140031956 > system LUMO -0.0852438140031949

cycle= 1 E= -75.2050111450144  delta_E= -0.561  |g|= 0.224  |ddm|= 1.45
HOMO (B2u) = -0.334187231388072  LUMO (B3g) = -0.0398454588841035
cycle= 2 E= -75.2255220782413  delta_E= -0.0205  |g|= 0.043  |ddm|= 0.347
HOMO (B2u) = -0.303722561565158  LUMO (B3g) = -0.00486882385407366
cycle= 3 E= -75.2266381654048  delta_E= -0.00112  |g|= 0.0161  |ddm|= 0.0554
HOMO (B2u) = -0.307858619678187  LUMO (B3g) = -0.00776666805282985
cycle= 4 E= -75.226827530681  delta_E= -0.000189  |g|= 0.000623  |ddm|= 0.0321
HOMO (B2u) = -0.307904877132321  LUMO (B3g) = -0.0079120047359263
cycle= 5 E= -75.2268276836983  delta_E= -1.53e-07  |g|= 0.000135  |ddm|= 0.000792
HOMO (B2u) = -0.307873376598219  LUMO (B3g) = -0.00787181864145125
cycle= 6 E= -75.2268276941976  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000228
HOMO (B2u) = -0.30787054789191  LUMO (B3g) = -0.00786924076200523
cycle= 7 E= -75.2268276944567  delta_E= -2.59e-10  |g|= 2.07e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.307870168621834  LUMO (B3g) = -0.00786899944461153
cycle= 8 E= -75.2268276944595  delta_E= -2.76e-12  |g|= 1.28e-07  |ddm|= 4.42e-06
HOMO (B2u) = -0.30787018580879  LUMO (B3g) = -0.00786900390102131
cycle= 9 E= -75.2268276944595  delta_E=    0  |g|= 6.56e-09  |ddm|= 2.97e-07
HOMO (B2u) = -0.307870184797065  LUMO (B3g) = -0.00786900501615922
cycle= 10 E= -75.2268276944595  delta_E= 1.42e-14  |g|= 6.25e-09  |ddm|= 7.5e-09
HOMO (B2u) = -0.307870185326587  LUMO (B3g) = -0.00786900549409008
cycle= 11 E= -75.2268276944594  delta_E= 4.26e-14  |g|= 4.35e-09  |ddm|= 4.41e-09
HOMO (B2u) = -0.30787018467363  LUMO (B3g) = -0.0078690046898235
cycle= 12 E= -75.2268276944595  delta_E= -8.53e-14  |g|= 3.7e-09  |ddm|= 2.54e-09
HOMO (B2u) = -0.30787018475637  LUMO (B3g) = -0.00786900477070166
cycle= 13 E= -75.2268276944595  delta_E=    0  |g|= 3.33e-09  |ddm|= 9.83e-10
HOMO (B2u) = -0.307870184502782  LUMO (B3g) = -0.00786900460311456
cycle= 14 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 5.16e-10  |ddm|= 5.31e-09
HOMO (B2u) = -0.307870184616297  LUMO (B3g) = -0.00786900470661987
cycle= 15 E= -75.2268276944595  delta_E=    0  |g|= 6.33e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.307870184548704  LUMO (B3g) = -0.0078690046474555
cycle= 16 E= -75.2268276944595  delta_E= 1.42e-14  |g|= 5.3e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.307870184560397  LUMO (B3g) = -0.00786900465962311
cycle= 17 E= -75.2268276944595  delta_E= -8.53e-14  |g|= 6.57e-10  |ddm|= 9.07e-10
HOMO (B2u) = -0.307870184545889  LUMO (B3g) = -0.00786900465086292
cycle= 18 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 5.02e-10  |ddm|= 2.42e-10
HOMO (B2u) = -0.307870184554951  LUMO (B3g) = -0.00786900465784217
cycle= 19 E= -75.2268276944594  delta_E= 8.53e-14  |g|= 3.83e-10  |ddm|= 3.32e-10
HOMO (B2u) = -0.307870184567207  LUMO (B3g) = -0.00786900467031259
cycle= 20 E= -75.2268276944595  delta_E= -7.11e-14  |g|= 3.04e-10  |ddm|= 2.09e-10
HOMO (B2u) = -0.307870184567801  LUMO (B3g) = -0.00786900467436102
cycle= 21 E= -75.2268276944594  delta_E= 7.11e-14  |g|= 2.16e-10  |ddm|= 1.62e-10
HOMO (B2u) = -0.307870184567978  LUMO (B3g) = -0.00786900467914562
cycle= 22 E= -75.2268276944595  delta_E= -8.53e-14  |g|= 1.3e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.307870184567956  LUMO (B3g) = -0.00786900467999602
cycle= 23 E= -75.2268276944594  delta_E= 5.68e-14  |g|= 1.16e-10  |ddm|= 3.48e-11
HOMO (B2u) = -0.30787018456452  LUMO (B3g) = -0.00786900467809246
cycle= 24 E= -75.2268276944596  delta_E= -1.14e-13  |g|= 9.79e-11  |ddm|= 4.86e-11
HOMO (B2u) = -0.307870184564127  LUMO (B3g) = -0.00786900467869813
cycle= 25 E= -75.2268276944595  delta_E= 7.11e-14  |g|= 8.21e-11  |ddm|= 3.06e-11
HOMO (B2u) = -0.307870184563471  LUMO (B3g) = -0.00786900467877081
cycle= 26 E= -75.2268276944595  delta_E= 1.42e-14  |g|= 6.54e-11  |ddm|= 2.96e-11
HOMO (B2u) = -0.307870184563052  LUMO (B3g) = -0.00786900467873302
cycle= 27 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 5.47e-11  |ddm|= 2.31e-11
HOMO (B2u) = -0.307870184562498  LUMO (B3g) = -0.00786900467874209
cycle= 28 E= -75.2268276944595  delta_E=    0  |g|= 4.46e-11  |ddm|= 1.79e-11
HOMO (B2u) = -0.307870184560958  LUMO (B3g) = -0.00786900467909159
Extra cycle  E= -75.2268276944595  delta_E=    0  |g|= 1.67e-11  |ddm|= 4.72e-11
converged SCF energy = -75.2268276944595

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmp68wtkfwr
max_memory 4000 MB (current use 459 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4021896555602  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4214649606424  dE = -0.019275305  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4334658808349  dE = -0.01200092  S^2 = 0.0000000
               |grad[o]|=0.0809  |ddm|=0.135  |maxRot[o]|=0.0799
macro iter 3 (5 JK  0 micro), CASSCF E = -75.4382739601456  dE = -0.0048080793  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.0331  |maxRot[o]|= 0.06
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4401616771907  dE = -0.001887717  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.0842  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4408726065421  dE = -0.00071092935  S^2 = 0.0000000
               |grad[o]|=0.00949  |ddm|=0.0179  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4410249536797  dE = -0.00015234714  S^2 = 0.0000000
               |grad[o]|=0.0045  |ddm|=0.00833  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4410686424734  dE = -4.3688794e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.00376  |maxRot[o]|=0.0138
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4410730802276  dE = -4.4377542e-06  S^2 = 0.0000000
               |grad[o]|=0.000978  |ddm|=0.00262  |maxRot[o]|=0.00444
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4410735333522  dE = -4.5312454e-07  S^2 = 0.0000000
               |grad[o]|=0.000336  |ddm|=0.000902  |maxRot[o]|=0.00139
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4410735792916  dE = -4.5939473e-08  S^2 = 0.0000000
               |grad[o]|=0.00011  |ddm|=0.0003  |maxRot[o]|=0.000438
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4410735839378  dE = -4.6461963e-09  S^2 = 0.0000000
               |grad[o]|=3.55e-05  |ddm|=9.77e-05  |maxRot[o]|=0.000139
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4410735844028  dE = -4.6499338e-10  S^2 = 0.0000000
               |grad[o]|=1.14e-05  |ddm|=3.12e-05  |maxRot[o]|=4.36e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4410735844491  dE = -4.6313176e-11  S^2 = 0.0000000
               |grad[o]|=3.63e-06  |ddm|=1e-05  |maxRot[o]|=1.38e-05
2-step CASSCF converged in 13 macro (47 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95524813 1.93872441 1.80820228 1.57967996 0.42398994 0.05970186
 0.05400188 0.18045154]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01248   0.01096  -0.00089   0.00000   0.00000
  0 C 2s       0.70221   0.68634  -0.08081   0.00000   0.00000
  0 C 3s       0.00710   0.01405  -0.01955  -0.00000   0.00000
  0 C 2px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 2py      0.00000  -0.00000   0.00000   0.70471   0.70701
  0 C 2pz      0.08112  -0.16887   0.70104   0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3py      0.00000  -0.00000   0.00000   0.05462   0.00967
  0 C 3pz     -0.00705  -0.00178   0.02705  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.01990   0.00668
  0 C 3dz^2    0.00810  -0.00856   0.02935  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.00000
 0 C 3dx2-y2   0.00247   0.00552  -0.00626   0.00000  -0.00000
  1 C 1s       0.01248  -0.01096  -0.00089   0.00000   0.00000
  1 C 2s       0.70221  -0.68634  -0.08081   0.00000   0.00000
  1 C 3s       0.00710  -0.01405  -0.01955  -0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 2py     -0.00000   0.00000  -0.00000   0.70471  -0.70701
  1 C 2pz     -0.08112  -0.16887  -0.70104   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3py     -0.00000   0.00000  -0.00000   0.05462  -0.00967
  1 C 3pz      0.00705  -0.00178  -0.02705   0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.01990   0.00668
  1 C 3dz^2    0.00810   0.00856   0.02935  -0.00000  -0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
 1 C 3dx2-y2   0.00247  -0.00552  -0.00626  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00015
  0 C 2s       0.00000   0.00000   0.16846
  0 C 3s       0.00000  -0.00000   0.02250
  0 C 2px      0.69455   0.69937   0.00000
  0 C 2py      0.00000  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68626
  0 C 3px     -0.07025  -0.02735   0.00000
  0 C 3py     -0.00000   0.00000   0.00000
  0 C 3pz      0.00000  -0.00000  -0.00897
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00098
  0 C 3dxz    -0.11253  -0.10066   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00927
  1 C 1s       0.00000   0.00000   0.00015
  1 C 2s      -0.00000   0.00000  -0.16846
  1 C 3s      -0.00000  -0.00000  -0.02250
  1 C 2px      0.69455  -0.69937  -0.00000
  1 C 2py     -0.00000  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.68626
  1 C 3px     -0.07025   0.02735  -0.00000
  1 C 3py     -0.00000   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.00897
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00098
  1 C 3dxz     0.11253  -0.10066   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00927
<CAS-nat-orb|mo-hf>  3  3    0.99498963
<CAS-nat-orb|mo-hf>  4  4    0.99952982
<CAS-nat-orb|mo-hf>  5  5    0.99486173
<CAS-nat-orb|mo-hf>  6  6    0.99817000
<CAS-nat-orb|mo-hf>  7  7    0.98959359
<CAS-nat-orb|mo-hf>  8  8    0.93310195
<CAS-nat-orb|mo-hf>  9  9    0.96127102
<CAS-nat-orb|mo-hf>  10  10    0.97122875
CASSCF energy = -75.4410735844491
CASCI E = -75.4410735844491  E(CI) = -14.6278043064797  S^2 = 0.0000000
......production of RDMs took       1.98 sec
......reading the RDM took          0.44 sec
......production of RDMs took      23.74 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICMRREPT2-ijrs) =    -0.00028984307038
E(WickICMRREPT2- rsi) =    -0.00090158350964
E(WickICMRREPT2- ijr) =    -0.00023928502916
E(WickICMRREPT2-  rs) =    -0.04866622827279
E(WickICMRREPT2-  ij) =    -0.00004860642101
E(WickICMRREPT2-  ir) =    -0.00101932154512
E(WickICMRREPT2-   r) =    -0.07368831342048
E(WickICMRREPT2-   i) =    -0.00004183484955
E(WickICMRREPT2) = -75.56596860056726  E_corr_pt = -0.1248950161181296
Timings = pdms =   35.91 | eris =    0.07 | ijrs =    1.18 | rsi =   32.88 | ijr =    0.52 | rs =  622.72 | ij =    1.33 | ir =   24.11 | r =  142.93 | i =    2.33 | total =  864.17
Time cost =    919.956
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-24.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 04:24:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.196085425318 AA    0.000000000000   0.000000000000   4.150000000000 Bohr   0.0

nuclear repulsion = 8.67469879518072
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    705860.22


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpa9gs8fjp
max_memory 4000 MB (current use 399 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6374240354882

WARN: Singularity detected in overlap matrix (condition number = 46.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0833226379096661  LUMO (B3u) = -0.0833226379096663

WARN: B2u HOMO -0.0833226379096661 > system LUMO -0.0833226379096663

cycle= 1 E= -75.1980259935244  delta_E= -0.561  |g|= 0.223  |ddm|= 1.45
HOMO (B2u) = -0.331539393004464  LUMO (B3g) = -0.0424794268999012
cycle= 2 E= -75.218374297065  delta_E= -0.0203  |g|= 0.0426  |ddm|= 0.347
HOMO (B2u) = -0.301383734536961  LUMO (B3g) = -0.00782777517474619
cycle= 3 E= -75.2194670845425  delta_E= -0.00109  |g|= 0.0159  |ddm|= 0.0547
HOMO (B2u) = -0.305478746489495  LUMO (B3g) = -0.010733308875925
cycle= 4 E= -75.2196531399389  delta_E= -0.000186  |g|= 0.000618  |ddm|= 0.0318
HOMO (B2u) = -0.305504012954427  LUMO (B3g) = -0.010854019338537
cycle= 5 E= -75.2196532909579  delta_E= -1.51e-07  |g|= 0.000135  |ddm|= 0.000782
HOMO (B2u) = -0.305473477058598  LUMO (B3g) = -0.0108148524604079
cycle= 6 E= -75.219653301404  delta_E= -1.04e-08  |g|= 1.98e-05  |ddm|= 0.000227
HOMO (B2u) = -0.305470638287272  LUMO (B3g) = -0.0108121741027619
cycle= 7 E= -75.2196533016625  delta_E= -2.58e-10  |g|= 2.1e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.305470264892537  LUMO (B3g) = -0.0108119322511056
cycle= 8 E= -75.2196533016652  delta_E= -2.7e-12  |g|= 1.29e-07  |ddm|= 4.5e-06
HOMO (B2u) = -0.305470284406564  LUMO (B3g) = -0.0108119381627129
cycle= 9 E= -75.2196533016654  delta_E= -1.42e-13  |g|= 6.74e-09  |ddm|= 2.91e-07
HOMO (B2u) = -0.305470283330305  LUMO (B3g) = -0.0108119393092812
cycle= 10 E= -75.2196533016654  delta_E= -2.84e-14  |g|= 6.36e-09  |ddm|= 8.14e-09
HOMO (B2u) = -0.305470283985682  LUMO (B3g) = -0.0108119399151005
cycle= 11 E= -75.2196533016653  delta_E= 8.53e-14  |g|= 4.44e-09  |ddm|= 4.11e-09
HOMO (B2u) = -0.30547028340387  LUMO (B3g) = -0.0108119391826896
cycle= 12 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 3.78e-09  |ddm|= 2.47e-09
HOMO (B2u) = -0.305470283231197  LUMO (B3g) = -0.0108119391066509
cycle= 13 E= -75.2196533016654  delta_E= -8.53e-14  |g|= 3.38e-10  |ddm|= 5.64e-09
HOMO (B2u) = -0.305470283280525  LUMO (B3g) = -0.0108119391354659
cycle= 14 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 4.45e-10  |ddm|= 6.53e-10
HOMO (B2u) = -0.305470283380686  LUMO (B3g) = -0.0108119392267457
cycle= 15 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 5.45e-10  |ddm|= 9.32e-10
HOMO (B2u) = -0.305470283317259  LUMO (B3g) = -0.0108119391694234
cycle= 16 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 4.74e-10  |ddm|= 8.13e-10
HOMO (B2u) = -0.305470283328504  LUMO (B3g) = -0.0108119391821517
cycle= 17 E= -75.2196533016653  delta_E=    0  |g|= 5.84e-10  |ddm|= 1.12e-09
HOMO (B2u) = -0.30547028331754  LUMO (B3g) = -0.0108119391765679
cycle= 18 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 4.22e-10  |ddm|= 2.55e-10
HOMO (B2u) = -0.305470283329658  LUMO (B3g) = -0.0108119391863116
cycle= 19 E= -75.2196533016654  delta_E= -8.53e-14  |g|= 2.86e-10  |ddm|= 2.99e-10
HOMO (B2u) = -0.305470283344763  LUMO (B3g) = -0.0108119392015306
cycle= 20 E= -75.2196533016653  delta_E= 5.68e-14  |g|= 1.97e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.305470283348136  LUMO (B3g) = -0.010811939208307
cycle= 21 E= -75.2196533016653  delta_E= 4.26e-14  |g|= 1.04e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.305470283348701  LUMO (B3g) = -0.0108119392082388
cycle= 22 E= -75.2196533016653  delta_E= -7.11e-14  |g|= 1.02e-10  |ddm|= 1.96e-11
HOMO (B2u) = -0.305470283349327  LUMO (B3g) = -0.0108119392094638
cycle= 23 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 8.99e-11  |ddm|= 3.39e-11
HOMO (B2u) = -0.305470283346968  LUMO (B3g) = -0.0108119392082521
cycle= 24 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 7.52e-11  |ddm|= 4.36e-11
HOMO (B2u) = -0.305470283347406  LUMO (B3g) = -0.01081193920953
cycle= 25 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 6.17e-11  |ddm|= 3.8e-11
HOMO (B2u) = -0.305470283347661  LUMO (B3g) = -0.0108119392102789
cycle= 26 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 4.6e-11  |ddm|= 2.42e-11
HOMO (B2u) = -0.305470283347997  LUMO (B3g) = -0.0108119392107392
cycle= 27 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 3.71e-11  |ddm|= 1.75e-11
HOMO (B2u) = -0.305470283348047  LUMO (B3g) = -0.01081193921108
cycle= 28 E= -75.2196533016654  delta_E= -8.53e-14  |g|= 2.97e-11  |ddm|= 1.24e-11
HOMO (B2u) = -0.305470283348061  LUMO (B3g) = -0.0108119392114339
cycle= 29 E= -75.2196533016654  delta_E= -4.26e-14  |g|= 2.35e-11  |ddm|= 1.05e-11
HOMO (B2u) = -0.305470283348102  LUMO (B3g) = -0.0108119392116684
cycle= 30 E= -75.2196533016654  delta_E= 2.84e-14  |g|= 2e-11  |ddm|= 6.73e-12
HOMO (B2u) = -0.305470283348072  LUMO (B3g) = -0.0108119392118661
cycle= 31 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 1.64e-11  |ddm|= 6.99e-12
HOMO (B2u) = -0.305470283347997  LUMO (B3g) = -0.010811939211992
cycle= 32 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 1.32e-11  |ddm|= 5.96e-12
HOMO (B2u) = -0.305470283348007  LUMO (B3g) = -0.0108119392121494
cycle= 33 E= -75.2196533016653  delta_E=    0  |g|= 1.07e-11  |ddm|= 4.57e-12
HOMO (B2u) = -0.305470283347923  LUMO (B3g) = -0.0108119392124803
Extra cycle  E= -75.2196533016653  delta_E=    0  |g|= 4.01e-12  |ddm|= 1.2e-11
converged SCF energy = -75.2196533016653

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrrept2/tmpa9gs8fjp
max_memory 4000 MB (current use 404 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrrept2
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrrept2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrrept2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3995087253754  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.418511404175  dE = -0.019002679  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.430566843653  dE = -0.012055439  S^2 = 0.0000000
               |grad[o]|=0.0825  |ddm|=0.132  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4361439009716  dE = -0.0055770573  S^2 = 0.0000000
               |grad[o]|=0.0449  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4375519165527  dE = -0.0014080156  S^2 = 0.0000000
               |grad[o]|=0.013  |ddm|=0.0914  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4380256239098  dE = -0.00047370736  S^2 = 0.0000000
               |grad[o]|=0.00692  |ddm|=0.0133  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.438095843893  dE = -7.0219983e-05  S^2 = 0.0000000
               |grad[o]|=0.0032  |ddm|=0.00727  |maxRot[o]|=0.0175
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4381037763662  dE = -7.9324733e-06  S^2 = 0.0000000
               |grad[o]|=0.0013  |ddm|=0.00326  |maxRot[o]|=0.00586
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4381046435678  dE = -8.6720154e-07  S^2 = 0.0000000
               |grad[o]|=0.000463  |ddm|=0.00121  |maxRot[o]|=0.0019
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4381047367793  dE = -9.321154e-08  S^2 = 0.0000000
               |grad[o]|=0.000156  |ddm|=0.000418  |maxRot[o]|=0.000616
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4381047467063  dE = -9.927021e-09  S^2 = 0.0000000
               |grad[o]|=5.18e-05  |ddm|=0.00014  |maxRot[o]|=0.0002
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4381047477632  dE = -1.0569039e-09  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=4.62e-05  |maxRot[o]|=6.5e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4381047478749  dE = -1.116689e-10  S^2 = 0.0000000
               |grad[o]|=5.58e-06  |ddm|=1.52e-05  |maxRot[o]|=2.12e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4381047478866  dE = -1.1695533e-11  S^2 = 0.0000000
               |grad[o]|=1.82e-06  |ddm|=4.99e-06  |maxRot[o]|=6.9e-06
2-step CASSCF converged in 13 macro (48 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95522558 1.93933508 1.79648698 1.55867498 0.44475735 0.05897222
 0.05365785 0.19288996]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01249   0.01101  -0.00075   0.00000   0.00000
  0 C 2s       0.70304   0.68783  -0.07328   0.00000   0.00000
  0 C 3s       0.00773   0.01395  -0.01813   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 2py     -0.00000   0.00000  -0.00000   0.70477   0.70699
  0 C 2pz      0.07361  -0.16270   0.70188  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3py      0.00000   0.00000  -0.00000   0.05427   0.01126
  0 C 3pz     -0.00668  -0.00182   0.02850   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.01889   0.00635
  0 C 3dz^2    0.00731  -0.00827   0.02845   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 0 C 3dx2-y2   0.00258   0.00545  -0.00616  -0.00000  -0.00000
  1 C 1s       0.01249  -0.01101  -0.00075   0.00000   0.00000
  1 C 2s       0.70304  -0.68783  -0.07328  -0.00000  -0.00000
  1 C 3s       0.00773  -0.01395  -0.01813  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 2py     -0.00000   0.00000   0.00000   0.70477  -0.70699
  1 C 2pz     -0.07361  -0.16270  -0.70188  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3py      0.00000  -0.00000  -0.00000   0.05427  -0.01126
  1 C 3pz      0.00668  -0.00182  -0.02850   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01889   0.00635
  1 C 3dz^2    0.00731   0.00827   0.02845   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 1 C 3dx2-y2   0.00258  -0.00545  -0.00616   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00014
  0 C 2s      -0.00000   0.00000   0.16232
  0 C 3s       0.00000  -0.00000   0.02153
  0 C 2px      0.69477   0.69952  -0.00000
  0 C 2py      0.00000  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.68780
  0 C 3px     -0.07060  -0.02872  -0.00000
  0 C 3py      0.00000   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00644
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00067
  0 C 3dxz    -0.11095  -0.09923  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00851
  1 C 1s       0.00000   0.00000   0.00014
  1 C 2s       0.00000   0.00000  -0.16232
  1 C 3s      -0.00000   0.00000  -0.02153
  1 C 2px      0.69477  -0.69952   0.00000
  1 C 2py      0.00000  -0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68780
  1 C 3px     -0.07060   0.02872   0.00000
  1 C 3py     -0.00000   0.00000   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00644
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00067
  1 C 3dxz     0.11095  -0.09923  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00851
<CAS-nat-orb|mo-hf>  3  3    0.99475642
<CAS-nat-orb|mo-hf>  4  4    0.99950402
<CAS-nat-orb|mo-hf>  5  5    0.99460067
<CAS-nat-orb|mo-hf>  6  6    0.99808720
<CAS-nat-orb|mo-hf>  7  7    0.99017070
<CAS-nat-orb|mo-hf>  8  8    0.93329646
<CAS-nat-orb|mo-hf>  9  9    0.96133984
<CAS-nat-orb|mo-hf>  10  10    0.97346862
CASSCF energy = -75.4381047478866
CASCI E = -75.4381047478866  E(CI) = -14.5778600953521  S^2 = 0.0000000
......production of RDMs took       2.00 sec
......reading the RDM took          0.41 sec
......production of RDMs took      24.40 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICMRREPT2-ijrs) =    -0.00029160091724
E(WickICMRREPT2- rsi) =    -0.00090635252054
E(WickICMRREPT2- ijr) =    -0.00023799730555
E(WickICMRREPT2-  rs) =    -0.04863292860816
E(WickICMRREPT2-  ij) =    -0.00004760593386
E(WickICMRREPT2-  ir) =    -0.00101756829002
E(WickICMRREPT2-   r) =    -0.07393221982479
E(WickICMRREPT2-   i) =    -0.00003997383014
E(WickICMRREPT2) = -75.56321099511692  E_corr_pt = -0.1251062472303038
Timings = pdms =   36.57 | eris =    0.18 | ijrs =    1.31 | rsi =   33.56 | ijr =    0.42 | rs =  614.72 | ij =    1.51 | ir =   25.32 | r =  142.96 | i =    2.32 | total =  858.94
Time cost =    942.355
