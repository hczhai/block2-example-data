#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:01:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.952518979656 AA    0.000000000000   0.000000000000   1.800000000000 Bohr   0.0

nuclear repulsion = 20
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  0.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:        46.42


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp3ua8g0y_
max_memory 4000 MB (current use 145 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.1366469280558

WARN: Singularity detected in overlap matrix (condition number = 1.91e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.411563442743743  LUMO (Ag) = -0.232616164544877
cycle= 1 E= -75.1160073846339  delta_E= 1.02  |g|= 0.175  |ddm|= 1.65
HOMO (B1u) = -0.462886704875275  LUMO (Ag) = -0.0990177048643916
cycle= 2 E= -75.1270298311364  delta_E= -0.011  |g|= 0.057  |ddm|= 0.233
HOMO (B1u) = -0.438000780243469  LUMO (Ag) = -0.0789293202815921
cycle= 3 E= -75.1282984729017  delta_E= -0.00127  |g|= 0.0157  |ddm|= 0.191
HOMO (B1u) = -0.440879448397979  LUMO (Ag) = -0.0869420301347684
cycle= 4 E= -75.1284487654918  delta_E= -0.00015  |g|= 0.00222  |ddm|= 0.0862
HOMO (B1u) = -0.441380240119147  LUMO (Ag) = -0.0882782976431976
cycle= 5 E= -75.1284520756329  delta_E= -3.31e-06  |g|= 0.000419  |ddm|= 0.0158
HOMO (B1u) = -0.441351661772559  LUMO (Ag) = -0.0881933274529069
cycle= 6 E= -75.1284521927704  delta_E= -1.17e-07  |g|= 2.77e-05  |ddm|= 0.00246
HOMO (B1u) = -0.441354048137813  LUMO (Ag) = -0.0881978149646822
cycle= 7 E= -75.1284521931899  delta_E= -4.2e-10  |g|= 1.77e-06  |ddm|= 0.000613
HOMO (B1u) = -0.441354076509804  LUMO (Ag) = -0.0881971474462341
cycle= 8 E= -75.128452193191  delta_E= -1.14e-12  |g|= 1.61e-07  |ddm|= 3.45e-05
HOMO (B1u) = -0.441354065705052  LUMO (Ag) = -0.0881971923681859
cycle= 9 E= -75.128452193191  delta_E= 4.26e-14  |g|= 1.18e-08  |ddm|= 1.67e-06
HOMO (B1u) = -0.441354065627367  LUMO (Ag) = -0.0881971880051278
cycle= 10 E= -75.128452193191  delta_E= -2.84e-14  |g|= 5.48e-09  |ddm|= 1.02e-07
HOMO (B1u) = -0.441354065541728  LUMO (Ag) = -0.0881971874569622
cycle= 11 E= -75.128452193191  delta_E= -1.42e-14  |g|= 6.45e-10  |ddm|= 4.11e-08
HOMO (B1u) = -0.441354065565581  LUMO (Ag) = -0.0881971874925084
cycle= 12 E= -75.128452193191  delta_E= -1.42e-14  |g|= 4.42e-10  |ddm|= 1.98e-09
HOMO (B1u) = -0.441354065566815  LUMO (Ag) = -0.0881971875261963
cycle= 13 E= -75.128452193191  delta_E= -1.42e-14  |g|= 3.63e-10  |ddm|= 9.18e-10
HOMO (B1u) = -0.441354065532796  LUMO (Ag) = -0.0881971874629772
cycle= 14 E= -75.128452193191  delta_E= 1.42e-14  |g|= 3.29e-10  |ddm|= 2.09e-09
HOMO (B1u) = -0.441354065498819  LUMO (Ag) = -0.0881971874058851
cycle= 15 E= -75.128452193191  delta_E= -1.42e-14  |g|= 4.01e-10  |ddm|= 4.9e-09
HOMO (B1u) = -0.441354065493428  LUMO (Ag) = -0.0881971874725733
cycle= 16 E= -75.1284521931909  delta_E= 1.71e-13  |g|= 4.36e-10  |ddm|= 1.12e-08
HOMO (B1u) = -0.441354065533561  LUMO (Ag) = -0.0881971875086648
cycle= 17 E= -75.128452193191  delta_E= -1.14e-13  |g|= 4.39e-10  |ddm|= 3.7e-10
HOMO (B1u) = -0.441354065581646  LUMO (Ag) = -0.088197187524211
cycle= 18 E= -75.1284521931911  delta_E= -7.11e-14  |g|= 1.76e-10  |ddm|= 3.91e-09
HOMO (B1u) = -0.44135406557314  LUMO (Ag) = -0.0881971875094054
cycle= 19 E= -75.128452193191  delta_E= 4.26e-14  |g|= 6.4e-11  |ddm|= 1.06e-09
HOMO (B1u) = -0.44135406556903  LUMO (Ag) = -0.0881971875050849
cycle= 20 E= -75.128452193191  delta_E= 1.42e-14  |g|= 5.41e-11  |ddm|= 5.59e-11
HOMO (B1u) = -0.44135406556682  LUMO (Ag) = -0.0881971875028501
cycle= 21 E= -75.1284521931909  delta_E= 7.11e-14  |g|= 4.81e-11  |ddm|= 1.79e-11
HOMO (B1u) = -0.441354065566173  LUMO (Ag) = -0.0881971875009782
cycle= 22 E= -75.1284521931909  delta_E= 2.84e-14  |g|= 4.29e-11  |ddm|= 1.22e-11
HOMO (B1u) = -0.441354065565655  LUMO (Ag) = -0.0881971875005967
cycle= 23 E= -75.128452193191  delta_E= -8.53e-14  |g|= 4.3e-11  |ddm|= 3.26e-11
HOMO (B1u) = -0.441354065563172  LUMO (Ag) = -0.0881971874981472
cycle= 24 E= -75.1284521931911  delta_E= -9.95e-14  |g|= 3.98e-11  |ddm|= 1.91e-10
HOMO (B1u) = -0.441354065559948  LUMO (Ag) = -0.0881971874911885
cycle= 25 E= -75.128452193191  delta_E= 4.26e-14  |g|= 2.76e-11  |ddm|= 1.3e-10
HOMO (B1u) = -0.44135406555749  LUMO (Ag) = -0.088197187485739
cycle= 26 E= -75.128452193191  delta_E= 2.84e-14  |g|= 1.57e-11  |ddm|= 1.37e-10
HOMO (B1u) = -0.441354065557414  LUMO (Ag) = -0.0881971874852871
cycle= 27 E= -75.128452193191  delta_E= 4.26e-14  |g|= 1.18e-11  |ddm|= 2.88e-11
HOMO (B1u) = -0.441354065557754  LUMO (Ag) = -0.0881971874854967
cycle= 28 E= -75.128452193191  delta_E= -4.26e-14  |g|= 1.03e-11  |ddm|= 4.06e-12
HOMO (B1u) = -0.441354065558029  LUMO (Ag) = -0.088197187485577
cycle= 29 E= -75.128452193191  delta_E= 5.68e-14  |g|= 8.92e-12  |ddm|= 3.42e-12
HOMO (B1u) = -0.441354065558275  LUMO (Ag) = -0.088197187485582
cycle= 30 E= -75.128452193191  delta_E= -8.53e-14  |g|= 7.59e-12  |ddm|= 3.76e-12
HOMO (B1u) = -0.44135406555849  LUMO (Ag) = -0.0881971874855872
cycle= 31 E= -75.128452193191  delta_E= 2.84e-14  |g|= 6.44e-12  |ddm|= 3.25e-12
HOMO (B1u) = -0.441354065558658  LUMO (Ag) = -0.0881971874854938
cycle= 32 E= -75.128452193191  delta_E=    0  |g|= 5.12e-12  |ddm|= 3.99e-12
HOMO (B1u) = -0.441354065558634  LUMO (Ag) = -0.08819718748463
Extra cycle  E= -75.1284521931911  delta_E= -5.68e-14  |g|= 1.95e-12  |ddm|= 1.81e-11
converged SCF energy = -75.1284521931911

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp3ua8g0y_
max_memory 4000 MB (current use 159 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.2773851266818  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.292161251884  dE = -0.014776125  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3054533398902  dE = -0.013292088  S^2 = 0.0000000
               |grad[o]|=0.122  |ddm|=0.0317  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3171665941949  dE = -0.011713254  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|=0.022  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3257563364576  dE = -0.0085897423  S^2 = 0.0000000
               |grad[o]|=0.0806  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3312100881897  dE = -0.0054537517  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.00664  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3353808807215  dE = -0.0041707925  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3388115065122  dE = -0.0034306258  S^2 = 0.0000000
               |grad[o]|=0.0423  |ddm|=0.00197  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3416937901178  dE = -0.0028822836  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.00139  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.3441068763513  dE = -0.0024130862  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.00119  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.3460868950594  dE = -0.0019800187  S^2 = 0.0000000
               |grad[o]|=0.023  |ddm|=0.00138  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.3476533582555  dE = -0.0015664632  S^2 = 0.0000000
               |grad[o]|=0.0181  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.3488207496522  dE = -0.0011673914  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00222  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.3496021915744  dE = -0.00078144192  S^2 = 0.0000000
               |grad[o]|=0.00962  |ddm|=0.00269  |maxRot[o]|=0.0799
macro iter 14 (6 JK  0 micro), CASSCF E = -75.3500076019682  dE = -0.00040541039  S^2 = 0.0000000
               |grad[o]|=0.00596  |ddm|=0.00323  |maxRot[o]|=0.0799
macro iter 15 (4 JK  0 micro), CASSCF E = -75.3500690559482  dE = -6.145398e-05  S^2 = 0.0000000
               |grad[o]|=0.00259  |ddm|=0.004  |maxRot[o]|=0.0356
macro iter 16 (3 JK  0 micro), CASSCF E = -75.3500711296793  dE = -2.0737311e-06  S^2 = 0.0000000
               |grad[o]|=0.000771  |ddm|=0.00302  |maxRot[o]|=0.0056
macro iter 17 (3 JK  0 micro), CASSCF E = -75.3500712273196  dE = -9.764031e-08  S^2 = 0.0000000
               |grad[o]|=0.000204  |ddm|=0.00102  |maxRot[o]|=0.00111
macro iter 18 (3 JK  0 micro), CASSCF E = -75.3500712324682  dE = -5.1486637e-09  S^2 = 0.0000000
               |grad[o]|=5.3e-05  |ddm|=0.000289  |maxRot[o]|=0.000238
macro iter 19 (3 JK  0 micro), CASSCF E = -75.350071232753  dE = -2.8478553e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=6.97e-05  |maxRot[o]|=5.33e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.3500712327693  dE = -1.6257218e-11  S^2 = 0.0000000
               |grad[o]|=3.36e-06  |ddm|=1.72e-05  |maxRot[o]|=1.23e-05
2-step CASSCF converged in 20 macro (102 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99117055 1.9483733  1.94837323 1.38207917 0.61632491 0.05352421
 0.05352413 0.0066305 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00026   0.00000   0.00000   0.00156  -0.00335
  0 C 2s       0.56540   0.00000  -0.00000   0.40871  -0.42139
  0 C 3s      -0.05874   0.00000  -0.00000   0.01072  -0.04347
  0 C 2px     -0.00000  -0.00000   0.70297  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70297  -0.00000  -0.00000  -0.00000
  0 C 2pz      0.41246   0.00000  -0.00000  -0.57668   0.56528
  0 C 3px      0.00000   0.00000  -0.06368  -0.00000   0.00000
  0 C 3py     -0.00000  -0.06368   0.00000  -0.00000  -0.00000
  0 C 3pz     -0.06271   0.00000  -0.00000  -0.01322  -0.02762
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.04218   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.05310   0.00000  -0.00000   0.01011   0.01522
  0 C 3dxz    -0.00000   0.00000   0.04218  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s      -0.00026   0.00000   0.00000  -0.00156  -0.00335
  1 C 2s       0.56540  -0.00000   0.00000  -0.40871  -0.42139
  1 C 3s      -0.05874  -0.00000   0.00000  -0.01072  -0.04347
  1 C 2px      0.00000  -0.00000   0.70297   0.00000  -0.00000
  1 C 2py      0.00000   0.70297  -0.00000   0.00000   0.00000
  1 C 2pz     -0.41246   0.00000   0.00000  -0.57668  -0.56528
  1 C 3px      0.00000  -0.00000  -0.06368   0.00000   0.00000
  1 C 3py      0.00000  -0.06368   0.00000   0.00000   0.00000
  1 C 3pz      0.06271   0.00000  -0.00000  -0.01322   0.02762
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.04218  -0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.05310  -0.00000   0.00000  -0.01011   0.01522
  1 C 3dxz    -0.00000   0.00000  -0.04218  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00117
  0 C 2s      -0.00000   0.00000   0.57006
  0 C 3s      -0.00000   0.00000  -0.05590
  0 C 2px      0.70510  -0.00000  -0.00000
  0 C 2py      0.00000   0.70510   0.00000
  0 C 2pz     -0.00000   0.00000   0.40146
  0 C 3px     -0.04754  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04754   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01218
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02390   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.10289
  0 C 3dxz    -0.02390  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00117
  1 C 2s       0.00000  -0.00000  -0.57006
  1 C 3s       0.00000  -0.00000   0.05590
  1 C 2px     -0.70510   0.00000   0.00000
  1 C 2py      0.00000  -0.70510  -0.00000
  1 C 2pz     -0.00000   0.00000   0.40146
  1 C 3px      0.04754   0.00000   0.00000
  1 C 3py      0.00000   0.04754  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01218
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02390   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.10289
  1 C 3dxz    -0.02390  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99656097
<CAS-nat-orb|mo-hf>  4  4    0.99984847
<CAS-nat-orb|mo-hf>  5  5    0.99984847
<CAS-nat-orb|mo-hf>  6  6    0.99856152
<CAS-nat-orb|mo-hf>  7  7    0.98495368
<CAS-nat-orb|mo-hf>  8  8    0.83784467
<CAS-nat-orb|mo-hf>  8  15   -0.54092854
<CAS-nat-orb|mo-hf>  9  9    0.83784453
<CAS-nat-orb|mo-hf>  9  16   -0.54092872
<CAS-nat-orb|mo-hf>  10  20   -0.80017035
CASSCF energy = -75.3500712327693
CASCI E = -75.3500712327693  E(CI) = -19.5186694186715  S^2 = 0.0000000
Density matrix diagonal elements [1.99117066 1.94837313 1.94837326 1.38207967 0.61632433 0.05352419
 0.05352434 0.00663042]
i = 1  <i|F|i> = -11.23912324
i = 2  <i|F|i> = -11.21708111
i = 3  <i|F|i> =  -1.10017944
i = 4  <i|F|i> =  -0.49799767
i = 5  <i|F|i> =  -0.49799770
i = 6  <i|F|i> =  -0.32436134
i = 7  <i|F|i> =  -0.14576005
i = 8  <i|F|i> =   0.48070181
i = 9  <i|F|i> =   0.48070197
i = 10  <i|F|i> =   1.67683799
i = 11  <i|F|i> =   0.54376654
i = 12  <i|F|i> =   0.58270521
i = 13  <i|F|i> =   0.58270521
i = 14  <i|F|i> =   0.77633081
i = 15  <i|F|i> =   0.68252375
i = 16  <i|F|i> =   0.68252362
i = 17  <i|F|i> =   0.57253203
i = 18  <i|F|i> =   1.22203149
i = 19  <i|F|i> =   1.22203149
i = 20  <i|F|i> =   1.22938211
i = 21  <i|F|i> =   1.62765287
i = 22  <i|F|i> =   1.62765287
i = 23  <i|F|i> =   1.78900335
i = 24  <i|F|i> =   1.78900335
i = 25  <i|F|i> =   2.10319665
i = 26  <i|F|i> =   2.38513335
i = 27  <i|F|i> =   2.38513328
i = 28  <i|F|i> =   3.57170854
......production of RDMs took       2.17 sec
......reading the RDM took          0.42 sec
......production of RDMs took      65.49 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.71 sec

E(WickICNEVPT2-ijrs) =    -0.00070197852562
E(WickICNEVPT2- rsi) =    -0.00153390016493
E(WickICNEVPT2- ijr) =    -0.00059612372024
E(WickICNEVPT2-  rs) =    -0.04229203480344
E(WickICNEVPT2-  ij) =    -0.00016174063645
E(WickICNEVPT2-  ir) =    -0.00159277030643
E(WickICNEVPT2-   r) =    -0.03741296051119
E(WickICNEVPT2-   i) =    -0.00036419536329
E(WickICNEVPT2) = -75.43472693680087  E_corr_pt = -0.08465570403159686
Timings = pdms =   77.78 | eris =    0.01 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.74 | i =    0.69 | total =   80.73
Time cost =    168.925
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:04:18 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.978977840202 AA    0.000000000000   0.000000000000   1.850000000000 Bohr   0.0

nuclear repulsion = 19.4594594594595
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       127.41


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpkxjiokdd
max_memory 4000 MB (current use 309 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.0853308429702

WARN: Singularity detected in overlap matrix (condition number = 1.7e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.413580977369315  LUMO (Ag) = -0.227598981995081
cycle= 1 E= -75.172693617241  delta_E= 0.913  |g|= 0.173  |ddm|= 1.63
HOMO (B1u) = -0.471112350140235  LUMO (Ag) = -0.104670423689865
cycle= 2 E= -75.1835008238031  delta_E= -0.0108  |g|= 0.0557  |ddm|= 0.215
HOMO (B1u) = -0.445209609873388  LUMO (Ag) = -0.0826198965911253
cycle= 3 E= -75.1846477232622  delta_E= -0.00115  |g|= 0.0156  |ddm|= 0.166
HOMO (B1u) = -0.447439744130488  LUMO (Ag) = -0.0899048584713169
cycle= 4 E= -75.1847993820882  delta_E= -0.000152  |g|= 0.00222  |ddm|= 0.0841
HOMO (B1u) = -0.447984981890543  LUMO (Ag) = -0.0913127106239858
cycle= 5 E= -75.1848027365253  delta_E= -3.35e-06  |g|= 0.00041  |ddm|= 0.016
HOMO (B1u) = -0.447956467884099  LUMO (Ag) = -0.0912347091259183
cycle= 6 E= -75.1848028483201  delta_E= -1.12e-07  |g|= 2.74e-05  |ddm|= 0.00219
HOMO (B1u) = -0.447959917478179  LUMO (Ag) = -0.0912398214370631
cycle= 7 E= -75.1848028487239  delta_E= -4.04e-10  |g|= 1.64e-06  |ddm|= 0.00057
HOMO (B1u) = -0.447959903825146  LUMO (Ag) = -0.0912392511182643
cycle= 8 E= -75.184802848725  delta_E= -1.08e-12  |g|= 1.46e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.447959899406375  LUMO (Ag) = -0.0912392910115105
cycle= 9 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 1.12e-08  |ddm|= 1.31e-06
HOMO (B1u) = -0.447959898995037  LUMO (Ag) = -0.0912392858231876
cycle= 10 E= -75.184802848725  delta_E= -5.68e-14  |g|= 5.77e-09  |ddm|= 8.37e-08
HOMO (B1u) = -0.447959899019209  LUMO (Ag) = -0.0912392855887187
cycle= 11 E= -75.1848028487249  delta_E= 8.53e-14  |g|= 6.47e-10  |ddm|= 4.14e-08
HOMO (B1u) = -0.44795989911043  LUMO (Ag) = -0.0912392857228407
cycle= 12 E= -75.1848028487249  delta_E= -5.68e-14  |g|= 4.35e-10  |ddm|= 2.5e-09
HOMO (B1u) = -0.447959899104633  LUMO (Ag) = -0.0912392857501047
cycle= 13 E= -75.184802848725  delta_E= -2.84e-14  |g|= 3.41e-10  |ddm|= 7.65e-10
HOMO (B1u) = -0.447959899057732  LUMO (Ag) = -0.0912392856772698
cycle= 14 E= -75.1848028487249  delta_E= 8.53e-14  |g|= 3.36e-10  |ddm|= 1.56e-09
HOMO (B1u) = -0.447959899025763  LUMO (Ag) = -0.0912392856292389
cycle= 15 E= -75.184802848725  delta_E= -8.53e-14  |g|= 3.83e-10  |ddm|= 4.42e-09
HOMO (B1u) = -0.447959899018528  LUMO (Ag) = -0.091239285689734
cycle= 16 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 4.17e-10  |ddm|= 8.9e-09
HOMO (B1u) = -0.447959899081748  LUMO (Ag) = -0.0912392857459654
cycle= 17 E= -75.184802848725  delta_E= -5.68e-14  |g|= 4.42e-10  |ddm|= 7.36e-10
HOMO (B1u) = -0.447959899145287  LUMO (Ag) = -0.0912392857752449
cycle= 18 E= -75.1848028487249  delta_E= 8.53e-14  |g|= 2.01e-10  |ddm|= 3.46e-09
HOMO (B1u) = -0.447959899127507  LUMO (Ag) = -0.0912392857544636
cycle= 19 E= -75.184802848725  delta_E= -1.14e-13  |g|= 6.65e-11  |ddm|= 1.02e-09
HOMO (B1u) = -0.447959899121179  LUMO (Ag) = -0.0912392857483595
cycle= 20 E= -75.1848028487249  delta_E= 8.53e-14  |g|= 5.49e-11  |ddm|= 6.75e-11
HOMO (B1u) = -0.447959899118635  LUMO (Ag) = -0.0912392857459892
cycle= 21 E= -75.1848028487249  delta_E=    0  |g|= 4.82e-11  |ddm|= 2.24e-11
HOMO (B1u) = -0.447959899106865  LUMO (Ag) = -0.0912392857259716
Extra cycle  E= -75.1848028487249  delta_E=    0  |g|= 1.33e-11  |ddm|= 1.4e-10
converged SCF energy = -75.1848028487249

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpkxjiokdd
max_memory 4000 MB (current use 312 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3350875235242  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3504688257641  dE = -0.015381302  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3642209415682  dE = -0.013752116  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0334  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3762543887669  dE = -0.012033447  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|=0.0229  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3841494399211  dE = -0.0078950512  S^2 = 0.0000000
               |grad[o]|=0.0782  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3894371369716  dE = -0.0052876971  S^2 = 0.0000000
               |grad[o]|=0.0619  |ddm|=0.00584  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3935806154497  dE = -0.0041434785  S^2 = 0.0000000
               |grad[o]|=0.0506  |ddm|=0.0029  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3970259711942  dE = -0.0034453557  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.00187  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3999303987058  dE = -0.0029044275  S^2 = 0.0000000
               |grad[o]|=0.0343  |ddm|=0.00135  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4023575425775  dE = -0.0024271439  S^2 = 0.0000000
               |grad[o]|=0.0279  |ddm|=0.00128  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4043337729428  dE = -0.0019762304  S^2 = 0.0000000
               |grad[o]|=0.0223  |ddm|=0.00152  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4058726065076  dE = -0.0015388336  S^2 = 0.0000000
               |grad[o]|=0.0173  |ddm|=0.00192  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4069843919821  dE = -0.0011117855  S^2 = 0.0000000
               |grad[o]|=0.0127  |ddm|=0.00237  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4076787725496  dE = -0.00069438057  S^2 = 0.0000000
               |grad[o]|=0.00858  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 14 (5 JK  0 micro), CASSCF E = -75.4079303578331  dE = -0.00025158528  S^2 = 0.0000000
               |grad[o]|=0.00476  |ddm|=0.00338  |maxRot[o]|=0.0599
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4079625114612  dE = -3.2153628e-05  S^2 = 0.0000000
               |grad[o]|=0.00199  |ddm|=0.0033  |maxRot[o]|= 0.02
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4079663374752  dE = -3.826014e-06  S^2 = 0.0000000
               |grad[o]|=0.000823  |ddm|=0.00183  |maxRot[o]|=0.00719
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4079664742542  dE = -1.3677895e-07  S^2 = 0.0000000
               |grad[o]|=0.000218  |ddm|=0.00105  |maxRot[o]|=0.00136
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4079664805249  dE = -6.270767e-09  S^2 = 0.0000000
               |grad[o]|=5.52e-05  |ddm|=0.000306  |maxRot[o]|=0.000269
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4079664808388  dE = -3.1390357e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.59e-05  |maxRot[o]|=5.69e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.4079664808549  dE = -1.6115109e-11  S^2 = 0.0000000
               |grad[o]|=3.35e-06  |ddm|=1.8e-05  |maxRot[o]|=1.26e-05
2-step CASSCF converged in 20 macro (100 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99071502 1.94427775 1.94427796 1.40690755 0.59110188 0.05781808
 0.05781831 0.00708345]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00011   0.00000   0.00000   0.00165  -0.00303
  0 C 2s       0.56693  -0.00000   0.00000   0.41981  -0.41934
  0 C 3s      -0.05883   0.00000   0.00000   0.01056  -0.04125
  0 C 2px      0.00000  -0.00000   0.70357  -0.00000  -0.00000
  0 C 2py      0.00000   0.70357  -0.00000   0.00000   0.00000
  0 C 2pz      0.41060   0.00000   0.00000  -0.56869   0.56692
  0 C 3px      0.00000  -0.00000  -0.05731  -0.00000  -0.00000
  0 C 3py      0.00000  -0.05731  -0.00000  -0.00000   0.00000
  0 C 3pz     -0.06180   0.00000   0.00000  -0.01234  -0.02899
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.04122  -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.05218   0.00000   0.00000   0.00930   0.01419
  0 C 3dxz     0.00000  -0.00000   0.04122  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s      -0.00011   0.00000   0.00000  -0.00165  -0.00303
  1 C 2s       0.56693  -0.00000  -0.00000  -0.41981  -0.41934
  1 C 3s      -0.05883  -0.00000  -0.00000  -0.01056  -0.04125
  1 C 2px     -0.00000  -0.00000   0.70357   0.00000   0.00000
  1 C 2py     -0.00000   0.70357   0.00000   0.00000  -0.00000
  1 C 2pz     -0.41060  -0.00000   0.00000  -0.56869  -0.56692
  1 C 3px     -0.00000   0.00000  -0.05731   0.00000   0.00000
  1 C 3py     -0.00000  -0.05731   0.00000   0.00000  -0.00000
  1 C 3pz      0.06180   0.00000   0.00000  -0.01234   0.02899
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.04122  -0.00000  -0.00000   0.00000
  1 C 3dz^2    0.05218   0.00000  -0.00000  -0.00930   0.01419
  1 C 3dxz     0.00000  -0.00000  -0.04122  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00113
  0 C 2s       0.00000  -0.00000   0.56365
  0 C 3s       0.00000  -0.00000  -0.05372
  0 C 2px      0.70531   0.00000   0.00000
  0 C 2py      0.00000   0.70531   0.00000
  0 C 2pz      0.00000   0.00000   0.41389
  0 C 3px     -0.04437   0.00000   0.00000
  0 C 3py      0.00000  -0.04437   0.00000
  0 C 3pz      0.00000  -0.00000  -0.01152
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02384   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.08932
  0 C 3dxz    -0.02384   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00113
  1 C 2s      -0.00000  -0.00000  -0.56365
  1 C 3s      -0.00000   0.00000   0.05372
  1 C 2px     -0.70531  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70531  -0.00000
  1 C 2pz      0.00000  -0.00000   0.41389
  1 C 3px      0.04437  -0.00000  -0.00000
  1 C 3py     -0.00000   0.04437  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.01152
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02384   0.00000
  1 C 3dz^2   -0.00000   0.00000   0.08932
  1 C 3dxz    -0.02384   0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99647819
<CAS-nat-orb|mo-hf>  4  4    0.99985488
<CAS-nat-orb|mo-hf>  5  5    0.99985488
<CAS-nat-orb|mo-hf>  6  6    0.99860559
<CAS-nat-orb|mo-hf>  7  7    0.98449183
<CAS-nat-orb|mo-hf>  8  8    0.85083670
<CAS-nat-orb|mo-hf>  8  15   -0.52116436
<CAS-nat-orb|mo-hf>  9  9    0.85083700
<CAS-nat-orb|mo-hf>  9  16   -0.52116393
<CAS-nat-orb|mo-hf>  10  20   -0.78474240
CASSCF energy = -75.4079664808549
CASCI E = -75.4079664808549  E(CI) = -19.3366965246112  S^2 = 0.0000000
Density matrix diagonal elements [1.99071519 1.94427766 1.94427766 1.40690883 0.5911004  0.05781845
 0.05781844 0.00708337]
i = 1  <i|F|i> = -11.23945504
i = 2  <i|F|i> = -11.22172225
i = 3  <i|F|i> =  -1.09585929
i = 4  <i|F|i> =  -0.48709920
i = 5  <i|F|i> =  -0.48709920
i = 6  <i|F|i> =  -0.33455091
i = 7  <i|F|i> =  -0.14378594
i = 8  <i|F|i> =   0.45564506
i = 9  <i|F|i> =   0.45564467
i = 10  <i|F|i> =   1.61916538
i = 11  <i|F|i> =   0.54757787
i = 12  <i|F|i> =   0.58999439
i = 13  <i|F|i> =   0.58999439
i = 14  <i|F|i> =   0.77150818
i = 15  <i|F|i> =   0.68586555
i = 16  <i|F|i> =   0.68586583
i = 17  <i|F|i> =   0.56900930
i = 18  <i|F|i> =   1.22222608
i = 19  <i|F|i> =   1.22222608
i = 20  <i|F|i> =   1.21977327
i = 21  <i|F|i> =   1.60389718
i = 22  <i|F|i> =   1.60389719
i = 23  <i|F|i> =   1.77480317
i = 24  <i|F|i> =   1.77480317
i = 25  <i|F|i> =   2.10079334
i = 26  <i|F|i> =   2.34949072
i = 27  <i|F|i> =   2.34949082
i = 28  <i|F|i> =   3.36713408
......production of RDMs took       2.13 sec
......reading the RDM took          0.42 sec
......production of RDMs took      23.79 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.80 sec

E(WickICNEVPT2-ijrs) =    -0.00063268770470
E(WickICNEVPT2- rsi) =    -0.00146413633994
E(WickICNEVPT2- ijr) =    -0.00057560887061
E(WickICNEVPT2-  rs) =    -0.04219003880907
E(WickICNEVPT2-  ij) =    -0.00016663783113
E(WickICNEVPT2-  ir) =    -0.00156234621448
E(WickICNEVPT2-   r) =    -0.03804540794924
E(WickICNEVPT2-   i) =    -0.00035881992515
E(WickICNEVPT2) = -75.49296216449927  E_corr_pt = -0.08499568364434151
Timings = pdms =   36.12 | eris =    0.20 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.69 | i =    0.68 | total =   39.19
Time cost =    126.818
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:06:25 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.005436700748 AA    0.000000000000   0.000000000000   1.900000000000 Bohr   0.0

nuclear repulsion = 18.9473684210526
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   0.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       223.29


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp57df_oep
max_memory 4000 MB (current use 321 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.031041178399

WARN: Singularity detected in overlap matrix (condition number = 1.52e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.39498553715523  LUMO (Ag) = -0.222680456230757
cycle= 1 E= -75.2198455234797  delta_E= 0.811  |g|= 0.173  |ddm|= 1.61
HOMO (B1u) = -0.479415237903266  LUMO (Ag) = -0.109973136342066
cycle= 2 E= -75.2305447304663  delta_E= -0.0107  |g|= 0.0546  |ddm|= 0.201
HOMO (B1u) = -0.452535964635351  LUMO (Ag) = -0.086088840872585
cycle= 3 E= -75.23159022107  delta_E= -0.00105  |g|= 0.0153  |ddm|= 0.145
HOMO (B1u) = -0.454103263824989  LUMO (Ag) = -0.0925462170063895
cycle= 4 E= -75.2317373690303  delta_E= -0.000147  |g|= 0.00222  |ddm|= 0.0805
HOMO (B1u) = -0.454675048897528  LUMO (Ag) = -0.0940058731975936
cycle= 5 E= -75.2317407777114  delta_E= -3.41e-06  |g|= 0.0004  |ddm|= 0.0162
HOMO (B1u) = -0.454646635749831  LUMO (Ag) = -0.0939357427361166
cycle= 6 E= -75.2317408842189  delta_E= -1.07e-07  |g|= 2.7e-05  |ddm|= 0.00191
HOMO (B1u) = -0.454651041484006  LUMO (Ag) = -0.0939413575689253
cycle= 7 E= -75.2317408846096  delta_E= -3.91e-10  |g|= 1.59e-06  |ddm|= 0.000529
HOMO (B1u) = -0.454650997156085  LUMO (Ag) = -0.093940895491306
cycle= 8 E= -75.2317408846106  delta_E= -9.38e-13  |g|= 1.33e-07  |ddm|= 2.94e-05
HOMO (B1u) = -0.454650997886245  LUMO (Ag) = -0.0939409273846481
cycle= 9 E= -75.2317408846107  delta_E= -1.42e-13  |g|= 9.79e-09  |ddm|= 1.1e-06
HOMO (B1u) = -0.454650996887599  LUMO (Ag) = -0.0939409222320318
cycle= 10 E= -75.2317408846106  delta_E= 8.53e-14  |g|= 6.09e-09  |ddm|= 5.21e-08
HOMO (B1u) = -0.454650997049718  LUMO (Ag) = -0.0939409223611442
cycle= 11 E= -75.2317408846107  delta_E= -5.68e-14  |g|= 6.22e-10  |ddm|= 4.16e-08
HOMO (B1u) = -0.454650997122051  LUMO (Ag) = -0.0939409224561201
cycle= 12 E= -75.2317408846107  delta_E= 2.84e-14  |g|= 4.3e-10  |ddm|= 1.6e-09
HOMO (B1u) = -0.454650997110954  LUMO (Ag) = -0.093940922497711
cycle= 13 E= -75.2317408846107  delta_E= 1.42e-14  |g|= 3.41e-10  |ddm|= 6.59e-10
HOMO (B1u) = -0.45465099706285  LUMO (Ag) = -0.0939409224282977
cycle= 14 E= -75.2317408846106  delta_E= 5.68e-14  |g|= 3.57e-10  |ddm|= 5.64e-10
HOMO (B1u) = -0.454650997041433  LUMO (Ag) = -0.0939409223986929
cycle= 15 E= -75.2317408846107  delta_E= -7.11e-14  |g|= 3.68e-10  |ddm|= 3.6e-09
HOMO (B1u) = -0.454650997061544  LUMO (Ag) = -0.0939409224622528
cycle= 16 E= -75.2317408846106  delta_E= 5.68e-14  |g|= 3.87e-10  |ddm|= 5.56e-09
HOMO (B1u) = -0.454650997122167  LUMO (Ag) = -0.0939409225146652
cycle= 17 E= -75.2317408846107  delta_E= -8.53e-14  |g|= 4.29e-10  |ddm|= 7.03e-10
HOMO (B1u) = -0.454650997189052  LUMO (Ag) = -0.093940922548858
cycle= 18 E= -75.2317408846107  delta_E= 2.84e-14  |g|= 2.28e-10  |ddm|= 2.6e-09
HOMO (B1u) = -0.454650997162517  LUMO (Ag) = -0.0939409225223667
cycle= 19 E= -75.2317408846106  delta_E= 5.68e-14  |g|= 7.11e-11  |ddm|= 9.51e-10
HOMO (B1u) = -0.454650997156587  LUMO (Ag) = -0.0939409225164737
cycle= 20 E= -75.2317408846107  delta_E= -8.53e-14  |g|= 5.93e-11  |ddm|= 5.84e-11
HOMO (B1u) = -0.454650997153285  LUMO (Ag) = -0.0939409225135214
cycle= 21 E= -75.2317408846106  delta_E= 5.68e-14  |g|= 5.26e-11  |ddm|= 2.88e-11
HOMO (B1u) = -0.454650997152101  LUMO (Ag) = -0.093940922510456
cycle= 22 E= -75.2317408846107  delta_E= -8.53e-14  |g|= 4.75e-11  |ddm|= 4.09e-11
HOMO (B1u) = -0.454650997150694  LUMO (Ag) = -0.0939409225080147
cycle= 23 E= -75.2317408846106  delta_E= 8.53e-14  |g|= 4.56e-11  |ddm|= 5.41e-11
HOMO (B1u) = -0.454650997147283  LUMO (Ag) = -0.0939409225027899
cycle= 24 E= -75.2317408846106  delta_E=    0  |g|= 3.94e-11  |ddm|= 6.68e-11
HOMO (B1u) = -0.454650997143582  LUMO (Ag) = -0.0939409224932187
Extra cycle  E= -75.2317408846107  delta_E= -5.68e-14  |g|= 1.18e-11  |ddm|= 2.14e-10
converged SCF energy = -75.2317408846107

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp57df_oep
max_memory 4000 MB (current use 321 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3834026666721  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3993895798143  dE = -0.015986913  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4135906543425  dE = -0.014201075  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0352  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4257782821469  dE = -0.012187628  S^2 = 0.0000000
               |grad[o]|=0.0987  |ddm|=0.0239  |maxRot[o]|=0.0787
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4331189741357  dE = -0.007340692  S^2 = 0.0000000
               |grad[o]|=0.0761  |ddm|=0.0138  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.438273501215  dE = -0.0051545271  S^2 = 0.0000000
               |grad[o]|=0.0608  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4423993038402  dE = -0.0041258026  S^2 = 0.0000000
               |grad[o]|=0.0498  |ddm|=0.00272  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4458591691747  dE = -0.0034598653  S^2 = 0.0000000
               |grad[o]|=0.041  |ddm|=0.00177  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4487792698238  dE = -0.0029201006  S^2 = 0.0000000
               |grad[o]|=0.0336  |ddm|=0.00136  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.451207923816  dE = -0.002428654  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.0014  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4531618926673  dE = -0.0019539689  S^2 = 0.0000000
               |grad[o]|=0.0215  |ddm|=0.00171  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4546486324102  dE = -0.0014867397  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4556742879049  dE = -0.0010256555  S^2 = 0.0000000
               |grad[o]|=0.0116  |ddm|=0.00257  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4562441919931  dE = -0.00056990409  S^2 = 0.0000000
               |grad[o]|=0.00729  |ddm|=0.00302  |maxRot[o]|=0.0799
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4563598636412  dE = -0.00011567165  S^2 = 0.0000000
               |grad[o]|=0.00332  |ddm|=0.00358  |maxRot[o]|= 0.04
macro iter 15 (3 JK  0 micro), CASSCF E = -75.456370424844  dE = -1.0561203e-05  S^2 = 0.0000000
               |grad[o]|=0.00121  |ddm|=0.00264  |maxRot[o]|=0.0119
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4563707480076  dE = -3.2316363e-07  S^2 = 0.0000000
               |grad[o]|=0.000318  |ddm|=0.00143  |maxRot[o]|=0.0021
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4563707613041  dE = -1.3296514e-08  S^2 = 0.0000000
               |grad[o]|=7.84e-05  |ddm|=0.000437  |maxRot[o]|=0.000394
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4563707619119  dE = -6.0781247e-10  S^2 = 0.0000000
               |grad[o]|=1.84e-05  |ddm|=0.000103  |maxRot[o]|=7.85e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.4563707619436  dE = -3.1633363e-11  S^2 = 0.0000000
               |grad[o]|=4.3e-06  |ddm|=2.69e-05  |maxRot[o]|=1.7e-05
2-step CASSCF converged in 19 macro (96 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99022072 1.93998158 1.93998139 1.43110666 0.56650847 0.06231568
 0.06231547 0.00757003]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00012   0.00000   0.00000   0.00176  -0.00276
  0 C 2s       0.56879   0.00000   0.00000   0.43063  -0.41683
  0 C 3s      -0.05868   0.00000   0.00000   0.01038  -0.03881
  0 C 2px     -0.00000   0.00000   0.70409  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70409   0.00000   0.00000   0.00000
  0 C 2pz      0.40833   0.00000   0.00000  -0.56057   0.56889
  0 C 3px     -0.00000   0.00000  -0.05130  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.05130  -0.00000   0.00000  -0.00000
  0 C 3pz     -0.06076   0.00000  -0.00000  -0.01148  -0.03034
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.04026  -0.00000   0.00000  -0.00000
  0 C 3dz^2    0.05111   0.00000   0.00000   0.00848   0.01325
  0 C 3dxz    -0.00000   0.00000   0.04026  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00012   0.00000   0.00000  -0.00176  -0.00276
  1 C 2s       0.56879  -0.00000  -0.00000  -0.43063  -0.41683
  1 C 3s      -0.05868  -0.00000  -0.00000  -0.01038  -0.03881
  1 C 2px      0.00000  -0.00000   0.70409   0.00000   0.00000
  1 C 2py      0.00000   0.70409   0.00000   0.00000   0.00000
  1 C 2pz     -0.40833  -0.00000   0.00000  -0.56057  -0.56889
  1 C 3px      0.00000  -0.00000  -0.05130   0.00000   0.00000
  1 C 3py      0.00000  -0.05130   0.00000  -0.00000   0.00000
  1 C 3pz      0.06076   0.00000   0.00000  -0.01148   0.03034
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.04026  -0.00000   0.00000  -0.00000
  1 C 3dz^2    0.05111  -0.00000  -0.00000  -0.00848   0.01325
  1 C 3dxz    -0.00000   0.00000  -0.04026  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00109
  0 C 2s       0.00000   0.00000   0.55672
  0 C 3s      -0.00000   0.00000  -0.05173
  0 C 2px      0.70549  -0.00000   0.00000
  0 C 2py      0.00000   0.70549   0.00000
  0 C 2pz      0.00000  -0.00000   0.42574
  0 C 3px     -0.04149  -0.00000   0.00000
  0 C 3py     -0.00000  -0.04149   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01023
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02382   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.07763
  0 C 3dxz    -0.02382  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00109
  1 C 2s      -0.00000  -0.00000  -0.55672
  1 C 3s       0.00000  -0.00000   0.05173
  1 C 2px     -0.70549  -0.00000  -0.00000
  1 C 2py      0.00000  -0.70549   0.00000
  1 C 2pz      0.00000   0.00000   0.42574
  1 C 3px      0.04149   0.00000  -0.00000
  1 C 3py     -0.00000   0.04149  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01023
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.07763
  1 C 3dxz    -0.02382  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99637510
<CAS-nat-orb|mo-hf>  4  4    0.99985872
<CAS-nat-orb|mo-hf>  5  5    0.99985872
<CAS-nat-orb|mo-hf>  6  6    0.99864216
<CAS-nat-orb|mo-hf>  7  7    0.98400069
<CAS-nat-orb|mo-hf>  8  8    0.86287874
<CAS-nat-orb|mo-hf>  8  15   -0.50178852
<CAS-nat-orb|mo-hf>  9  9    0.86287859
<CAS-nat-orb|mo-hf>  9  16   -0.50178877
<CAS-nat-orb|mo-hf>  10  20   -0.76833543
CASSCF energy = -75.4563707619436
CASCI E = -75.4563707619436  E(CI) = -19.1577865200206  S^2 = 0.0000000
Density matrix diagonal elements [1.99022081 1.93998133 1.93998137 1.43110695 0.56650806 0.06231575
 0.06231579 0.00756994]
i = 1  <i|F|i> = -11.24126478
i = 2  <i|F|i> = -11.22696456
i = 3  <i|F|i> =  -1.09036236
i = 4  <i|F|i> =  -0.47679126
i = 5  <i|F|i> =  -0.47679126
i = 6  <i|F|i> =  -0.34453975
i = 7  <i|F|i> =  -0.14164126
i = 8  <i|F|i> =   0.43176038
i = 9  <i|F|i> =   0.43176054
i = 10  <i|F|i> =   1.55845536
i = 11  <i|F|i> =   0.55169742
i = 12  <i|F|i> =   0.59703885
i = 13  <i|F|i> =   0.59703885
i = 14  <i|F|i> =   0.76674334
i = 15  <i|F|i> =   0.68889825
i = 16  <i|F|i> =   0.68889810
i = 17  <i|F|i> =   0.56603232
i = 18  <i|F|i> =   1.22270326
i = 19  <i|F|i> =   1.22270326
i = 20  <i|F|i> =   1.21045788
i = 21  <i|F|i> =   1.58051679
i = 22  <i|F|i> =   1.58051679
i = 23  <i|F|i> =   1.76083034
i = 24  <i|F|i> =   1.76083034
i = 25  <i|F|i> =   2.09891258
i = 26  <i|F|i> =   2.31741658
i = 27  <i|F|i> =   2.31741657
i = 28  <i|F|i> =   3.19043016
......production of RDMs took       2.35 sec
......reading the RDM took          0.42 sec
......production of RDMs took      24.31 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00057395259784
E(WickICNEVPT2- rsi) =    -0.00139955048964
E(WickICNEVPT2- ijr) =    -0.00055584266004
E(WickICNEVPT2-  rs) =    -0.04204155352017
E(WickICNEVPT2-  ij) =    -0.00017027784892
E(WickICNEVPT2-  ir) =    -0.00153325669211
E(WickICNEVPT2-   r) =    -0.03868796157419
E(WickICNEVPT2-   i) =    -0.00035300958428
E(WickICNEVPT2) = -75.54168616691076  E_corr_pt = -0.08531540496718826
Timings = pdms =   36.78 | eris =    0.26 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.16 | r =    2.24 | i =    0.73 | total =   40.56
Time cost =    103.396
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:08:08 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.031895561294 AA    0.000000000000   0.000000000000   1.950000000000 Bohr   0.0

nuclear repulsion = 18.4615384615385
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       313.47


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpjhd1n4c4
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9746920535549

WARN: Singularity detected in overlap matrix (condition number = 1.36e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.376946372482714  LUMO (Ag) = -0.217906597905049
cycle= 1 E= -75.2586399523511  delta_E= 0.716  |g|= 0.174  |ddm|=  1.6
HOMO (B1u) = -0.487753910327477  LUMO (Ag) = -0.114938505564516
cycle= 2 E= -75.2693410539255  delta_E= -0.0107  |g|= 0.0537  |ddm|= 0.193
HOMO (B1u) = -0.459920537702705  LUMO (Ag) = -0.0893203899470914
cycle= 3 E= -75.2703049843485  delta_E= -0.000964  |g|= 0.0148  |ddm|= 0.127
HOMO (B1u) = -0.460845458131849  LUMO (Ag) = -0.0948990398153101
cycle= 4 E= -75.2704430756293  delta_E= -0.000138  |g|= 0.00223  |ddm|= 0.0758
HOMO (B1u) = -0.46142649405618  LUMO (Ag) = -0.0963896216507962
cycle= 5 E= -75.2704465290254  delta_E= -3.45e-06  |g|= 0.00039  |ddm|= 0.0164
HOMO (B1u) = -0.461398372411754  LUMO (Ag) = -0.0963285783601117
cycle= 6 E= -75.270446630032  delta_E= -1.01e-07  |g|= 2.67e-05  |ddm|= 0.00163
HOMO (B1u) = -0.461403601387679  LUMO (Ag) = -0.0963346266369763
cycle= 7 E= -75.2704466304108  delta_E= -3.79e-10  |g|= 1.62e-06  |ddm|= 0.000491
HOMO (B1u) = -0.461403547807356  LUMO (Ag) = -0.0963342779054559
cycle= 8 E= -75.2704466304119  delta_E= -1.12e-12  |g|= 1.22e-07  |ddm|= 2.97e-05
HOMO (B1u) = -0.461403551923871  LUMO (Ag) = -0.096334302240342
cycle= 9 E= -75.2704466304119  delta_E= 5.68e-14  |g|= 8.39e-09  |ddm|= 9.29e-07
HOMO (B1u) = -0.461403550351294  LUMO (Ag) = -0.0963342976635637
cycle= 10 E= -75.2704466304118  delta_E= 2.84e-14  |g|= 6.42e-09  |ddm|= 2.34e-08
HOMO (B1u) = -0.461403550571946  LUMO (Ag) = -0.09633429802551
cycle= 11 E= -75.2704466304119  delta_E= -4.26e-14  |g|= 5.98e-10  |ddm|= 3.95e-08
HOMO (B1u) = -0.461403550643165  LUMO (Ag) = -0.0963342981191546
cycle= 12 E= -75.2704466304119  delta_E= 1.42e-14  |g|= 3.99e-10  |ddm|= 1.65e-09
HOMO (B1u) = -0.461403550657117  LUMO (Ag) = -0.0963342982036877
cycle= 13 E= -75.2704466304119  delta_E= -2.84e-14  |g|= 3.45e-10  |ddm|= 3.92e-10
HOMO (B1u) = -0.461403550622852  LUMO (Ag) = -0.0963342981493533
cycle= 14 E= -75.2704466304119  delta_E= 2.84e-14  |g|= 3.5e-10  |ddm|= 2.47e-10
HOMO (B1u) = -0.46140355057826  LUMO (Ag) = -0.0963342981216587
cycle= 15 E= -75.2704466304119  delta_E= -2.84e-14  |g|= 3.72e-10  |ddm|= 1.6e-09
HOMO (B1u) = -0.461403550634396  LUMO (Ag) = -0.0963342981809134
cycle= 16 E= -75.2704466304119  delta_E=    0  |g|= 3.34e-10  |ddm|= 1.71e-09
HOMO (B1u) = -0.46140355069945  LUMO (Ag) = -0.0963342982357124
cycle= 17 E= -75.2704466304118  delta_E= 1.14e-13  |g|= 4.08e-10  |ddm|= 8.56e-10
HOMO (B1u) = -0.461403550758802  LUMO (Ag) = -0.0963342982666885
cycle= 18 E= -75.2704466304119  delta_E= -9.95e-14  |g|= 2.45e-10  |ddm|= 1.74e-09
HOMO (B1u) = -0.461403550724508  LUMO (Ag) = -0.0963342982352241
cycle= 19 E= -75.2704466304119  delta_E= -1.42e-14  |g|= 7.06e-11  |ddm|= 8.53e-10
HOMO (B1u) = -0.461403550717932  LUMO (Ag) = -0.0963342982287167
cycle= 20 E= -75.2704466304119  delta_E=    0  |g|= 6.02e-11  |ddm|= 5.51e-11
HOMO (B1u) = -0.461403550703455  LUMO (Ag) = -0.0963342982028548
Extra cycle  E= -75.270446630412  delta_E= -8.53e-14  |g|= 1.69e-11  |ddm|= 2.94e-10
converged SCF energy = -75.270446630412

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpjhd1n4c4
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4235309438938  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4401210614015  dE = -0.016590118  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4547605591071  dE = -0.014639498  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0372  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4667277338683  dE = -0.011967175  S^2 = 0.0000000
               |grad[o]|=0.0972  |ddm|=0.0249  |maxRot[o]|=0.0768
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4737200297694  dE = -0.0069922959  S^2 = 0.0000000
               |grad[o]|=0.0746  |ddm|=0.0134  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4788108829756  dE = -0.0050908532  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.00488  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4829510195844  dE = -0.0041401366  S^2 = 0.0000000
               |grad[o]|=0.0492  |ddm|=0.00261  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4864411691615  dE = -0.0034901496  S^2 = 0.0000000
               |grad[o]|=0.0404  |ddm|=0.00172  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4893827134821  dE = -0.0029415443  S^2 = 0.0000000
               |grad[o]|=0.0329  |ddm|=0.00143  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.491810161276  dE = -0.0024274478  S^2 = 0.0000000
               |grad[o]|=0.0264  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4937310873326  dE = -0.0019209261  S^2 = 0.0000000
               |grad[o]|=0.0205  |ddm|=0.00194  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4951471172247  dE = -0.0014160299  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00236  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4960600256167  dE = -0.00091290839  S^2 = 0.0000000
               |grad[o]|=0.0103  |ddm|=0.00278  |maxRot[o]|=0.0799
macro iter 13 (5 JK  0 micro), CASSCF E = -75.4964166727367  dE = -0.00035664712  S^2 = 0.0000000
               |grad[o]|=0.00583  |ddm|=0.00322  |maxRot[o]|=0.0599
macro iter 14 (4 JK  0 micro), CASSCF E = -75.496489889981  dE = -7.3217244e-05  S^2 = 0.0000000
               |grad[o]|=0.0026  |ddm|=0.00297  |maxRot[o]|=0.0347
macro iter 15 (3 JK  0 micro), CASSCF E = -75.496491588836  dE = -1.698855e-06  S^2 = 0.0000000
               |grad[o]|=0.000643  |ddm|=0.00246  |maxRot[o]|=0.00494
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4964916480309  dE = -5.9194861e-08  S^2 = 0.0000000
               |grad[o]|=0.000153  |ddm|=0.000803  |maxRot[o]|=0.000856
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4964916504785  dE = -2.4476492e-09  S^2 = 0.0000000
               |grad[o]|=3.6e-05  |ddm|=0.000218  |maxRot[o]|=0.000159
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4964916505853  dE = -1.0680878e-10  S^2 = 0.0000000
               |grad[o]|=8.02e-06  |ddm|=4.83e-05  |maxRot[o]|=3.2e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.4964916505898  dE = -4.4764192e-12  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=1.09e-05  |maxRot[o]|=6.69e-06
2-step CASSCF converged in 19 macro (95 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98968842 1.93548132 1.93548121 1.45436124 0.54286927 0.0670143
 0.06701424 0.00808999]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00041   0.00000   0.00000   0.00186  -0.00251
  0 C 2s       0.57092   0.00000   0.00000   0.44116  -0.41394
  0 C 3s      -0.05831   0.00000  -0.00000   0.01019  -0.03618
  0 C 2px      0.00000   0.00000   0.70454  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70454   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40572  -0.00000  -0.00000  -0.55236   0.57112
  0 C 3px      0.00000  -0.00000  -0.04561  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04561  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05958   0.00000  -0.00000  -0.01065  -0.03168
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.03931  -0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04991   0.00000  -0.00000   0.00767   0.01244
  0 C 3dxz     0.00000  -0.00000   0.03931  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00041   0.00000   0.00000  -0.00186  -0.00251
  1 C 2s       0.57092  -0.00000   0.00000  -0.44116  -0.41394
  1 C 3s      -0.05831  -0.00000   0.00000  -0.01019  -0.03618
  1 C 2px     -0.00000   0.00000   0.70454  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70454   0.00000   0.00000   0.00000
  1 C 2pz     -0.40572  -0.00000   0.00000  -0.55236  -0.57112
  1 C 3px     -0.00000  -0.00000  -0.04561   0.00000   0.00000
  1 C 3py      0.00000  -0.04561  -0.00000   0.00000   0.00000
  1 C 3pz      0.05958   0.00000   0.00000  -0.01065   0.03168
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03931   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04991  -0.00000  -0.00000  -0.00767   0.01244
  1 C 3dxz     0.00000   0.00000  -0.03931  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00105
  0 C 2s       0.00000   0.00000   0.54938
  0 C 3s      -0.00000  -0.00000  -0.04995
  0 C 2px      0.70564  -0.00000   0.00000
  0 C 2py     -0.00000   0.70564   0.00000
  0 C 2pz      0.00000  -0.00000   0.43709
  0 C 3px     -0.03887  -0.00000   0.00000
  0 C 3py     -0.00000  -0.03887  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.00850
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02381   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.06762
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00105
  1 C 2s       0.00000   0.00000  -0.54938
  1 C 3s      -0.00000   0.00000   0.04995
  1 C 2px     -0.70564   0.00000  -0.00000
  1 C 2py      0.00000  -0.70564  -0.00000
  1 C 2pz     -0.00000   0.00000   0.43709
  1 C 3px      0.03887   0.00000  -0.00000
  1 C 3py      0.00000   0.03887  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.00850
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02381   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.06762
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99625189
<CAS-nat-orb|mo-hf>  4  4    0.99986004
<CAS-nat-orb|mo-hf>  5  5    0.99986004
<CAS-nat-orb|mo-hf>  6  6    0.99867026
<CAS-nat-orb|mo-hf>  7  7    0.98348638
<CAS-nat-orb|mo-hf>  8  8    0.87399692
<CAS-nat-orb|mo-hf>  8  15   -0.48288163
<CAS-nat-orb|mo-hf>  9  9    0.87399683
<CAS-nat-orb|mo-hf>  9  16   -0.48288177
<CAS-nat-orb|mo-hf>  10  17    0.40709983
<CAS-nat-orb|mo-hf>  10  20   -0.75070510
CASSCF energy = -75.4964916505898
CASCI E = -75.4964916505898  E(CI) = -18.9821893903552  S^2 = 0.0000000
Density matrix diagonal elements [1.98968852 1.9354811  1.93548121 1.45436495 0.54286552 0.06701435
 0.06701441 0.00808995]
i = 1  <i|F|i> = -11.24421922
i = 2  <i|F|i> = -11.23265567
i = 3  <i|F|i> =  -1.08386176
i = 4  <i|F|i> =  -0.46700969
i = 5  <i|F|i> =  -0.46700971
i = 6  <i|F|i> =  -0.35428201
i = 7  <i|F|i> =  -0.13941060
i = 8  <i|F|i> =   0.40899524
i = 9  <i|F|i> =   0.40899535
i = 10  <i|F|i> =   1.49603170
i = 11  <i|F|i> =   0.55609537
i = 12  <i|F|i> =   0.60383875
i = 13  <i|F|i> =   0.60383876
i = 14  <i|F|i> =   0.76208869
i = 15  <i|F|i> =   0.69162148
i = 16  <i|F|i> =   0.69162139
i = 17  <i|F|i> =   0.56349142
i = 18  <i|F|i> =   1.22346967
i = 19  <i|F|i> =   1.22346967
i = 20  <i|F|i> =   1.20145830
i = 21  <i|F|i> =   1.55754992
i = 22  <i|F|i> =   1.55754992
i = 23  <i|F|i> =   1.74709873
i = 24  <i|F|i> =   1.74709873
i = 25  <i|F|i> =   2.09737678
i = 26  <i|F|i> =   2.28847825
i = 27  <i|F|i> =   2.28847822
i = 28  <i|F|i> =   3.03771861
......production of RDMs took       1.87 sec
......reading the RDM took          0.41 sec
......production of RDMs took      25.28 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00052426502181
E(WickICNEVPT2- rsi) =    -0.00134015300276
E(WickICNEVPT2- ijr) =    -0.00053722657406
E(WickICNEVPT2-  rs) =    -0.04185172847245
E(WickICNEVPT2-  ij) =    -0.00017264213956
E(WickICNEVPT2-  ir) =    -0.00150543152113
E(WickICNEVPT2-   r) =    -0.03933823975602
E(WickICNEVPT2-   i) =    -0.00034690035736
E(WickICNEVPT2) = -75.58210823743494  E_corr_pt = -0.08561658684514876
Timings = pdms =   37.29 | eris =    0.02 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.26 | ij =    0.07 | ir =    0.15 | r =    2.03 | i =    0.73 | total =   40.60
Time cost =    122.247
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:10:10 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.058354421840 AA    0.000000000000   0.000000000000   2.000000000000 Bohr   0.0

nuclear repulsion = 18
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 1.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       426.57


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpyr8y7f0x
max_memory 4000 MB (current use 314 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9170535172816

WARN: Singularity detected in overlap matrix (condition number = 1.22e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.359902883841541  LUMO (Ag) = -0.21330704303973
cycle= 1 E= -75.2901241201448  delta_E= 0.627  |g|= 0.175  |ddm|= 1.58
HOMO (B1u) = -0.496094054564508  LUMO (Ag) = -0.119573071329237
cycle= 2 E= -75.3009349666093  delta_E= -0.0108  |g|= 0.0531  |ddm|= 0.188
HOMO (B1u) = -0.467321073254815  LUMO (Ag) = -0.0923011554436186
cycle= 3 E= -75.3018357121932  delta_E= -0.000901  |g|= 0.0141  |ddm|= 0.113
HOMO (B1u) = -0.467647600574111  LUMO (Ag) = -0.0969889779106498
cycle= 4 E= -75.3019617797126  delta_E= -0.000126  |g|= 0.00222  |ddm|= 0.0704
HOMO (B1u) = -0.46822096832575  LUMO (Ag) = -0.0984869419679134
cycle= 5 E= -75.3019652459277  delta_E= -3.47e-06  |g|= 0.000378  |ddm|= 0.0164
HOMO (B1u) = -0.468193490312783  LUMO (Ag) = -0.0984366742323384
cycle= 6 E= -75.3019653408538  delta_E= -9.49e-08  |g|= 2.64e-05  |ddm|= 0.00134
HOMO (B1u) = -0.468199393066112  LUMO (Ag) = -0.0984431261473124
cycle= 7 E= -75.3019653412215  delta_E= -3.68e-10  |g|= 1.72e-06  |ddm|= 0.000455
HOMO (B1u) = -0.46819935387088  LUMO (Ag) = -0.0984428907847382
cycle= 8 E= -75.3019653412226  delta_E= -1.17e-12  |g|= 1.15e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.468199359870032  LUMO (Ag) = -0.0984429094351715
cycle= 9 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 7.49e-09  |ddm|= 7.76e-07
HOMO (B1u) = -0.468199357852271  LUMO (Ag) = -0.0984429054975916
cycle= 10 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 6.67e-09  |ddm|= 7.63e-09
HOMO (B1u) = -0.468199358218767  LUMO (Ag) = -0.0984429062086678
cycle= 11 E= -75.3019653412227  delta_E= -7.11e-14  |g|= 6.35e-10  |ddm|= 3.47e-08
HOMO (B1u) = -0.468199358203667  LUMO (Ag) = -0.0984429061800695
cycle= 12 E= -75.3019653412226  delta_E= 5.68e-14  |g|= 3.96e-10  |ddm|= 1.51e-09
HOMO (B1u) = -0.468199358247418  LUMO (Ag) = -0.0984429062800618
cycle= 13 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 3.52e-10  |ddm|= 2.33e-10
HOMO (B1u) = -0.468199358191708  LUMO (Ag) = -0.0984429062184144
cycle= 14 E= -75.3019653412227  delta_E= -9.95e-14  |g|= 3.59e-10  |ddm|= 6.76e-10
HOMO (B1u) = -0.468199358147063  LUMO (Ag) = -0.0984429062021845
cycle= 15 E= -75.3019653412227  delta_E= 2.84e-14  |g|= 3.81e-10  |ddm|= 3.97e-10
HOMO (B1u) = -0.468199358213062  LUMO (Ag) = -0.0984429062425414
cycle= 16 E= -75.3019653412227  delta_E= 1.42e-14  |g|= 3.02e-10  |ddm|= 9.09e-10
HOMO (B1u) = -0.468199358284588  LUMO (Ag) = -0.0984429063009089
cycle= 17 E= -75.3019653412227  delta_E= -4.26e-14  |g|= 4.12e-10  |ddm|= 9.65e-10
HOMO (B1u) = -0.468199358331946  LUMO (Ag) = -0.0984429063250047
cycle= 18 E= -75.3019653412225  delta_E= 1.71e-13  |g|= 2.67e-10  |ddm|= 1.08e-09
HOMO (B1u) = -0.468199358291394  LUMO (Ag) = -0.0984429062902202
cycle= 19 E= -75.3019653412227  delta_E= -1.28e-13  |g|= 7.64e-11  |ddm|= 7.06e-10
HOMO (B1u) = -0.468199358287211  LUMO (Ag) = -0.0984429062854039
cycle= 20 E= -75.3019653412227  delta_E= 1.42e-14  |g|= 6.35e-11  |ddm|= 5.5e-11
HOMO (B1u) = -0.468199358283821  LUMO (Ag) = -0.0984429062818599
cycle= 21 E= -75.3019653412226  delta_E= 5.68e-14  |g|= 5.77e-11  |ddm|= 2.37e-11
HOMO (B1u) = -0.468199358283044  LUMO (Ag) = -0.0984429062791843
cycle= 22 E= -75.3019653412227  delta_E= -7.11e-14  |g|= 5.07e-11  |ddm|= 4.19e-11
HOMO (B1u) = -0.468199358281704  LUMO (Ag) = -0.0984429062757411
cycle= 23 E= -75.3019653412227  delta_E= 1.42e-14  |g|= 4.46e-11  |ddm|= 7.88e-11
HOMO (B1u) = -0.468199358279923  LUMO (Ag) = -0.0984429062694969
cycle= 24 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 3.76e-11  |ddm|= 7.68e-11
HOMO (B1u) = -0.46819935827839  LUMO (Ag) = -0.0984429062652296
cycle= 25 E= -75.3019653412227  delta_E= -5.68e-14  |g|= 3.02e-11  |ddm|= 4e-11
HOMO (B1u) = -0.468199358276959  LUMO (Ag) = -0.0984429062622822
cycle= 26 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 1.86e-11  |ddm|= 4.93e-11
HOMO (B1u) = -0.468199358277146  LUMO (Ag) = -0.0984429062627989
cycle= 27 E= -75.3019653412226  delta_E= 8.53e-14  |g|= 1.33e-11  |ddm|= 1.98e-11
HOMO (B1u) = -0.468199358277617  LUMO (Ag) = -0.0984429062629267
cycle= 28 E= -75.3019653412227  delta_E= -5.68e-14  |g|= 1.14e-11  |ddm|= 1.15e-11
HOMO (B1u) = -0.468199358278019  LUMO (Ag) = -0.0984429062629281
cycle= 29 E= -75.3019653412227  delta_E=    0  |g|= 9.72e-12  |ddm|= 1.1e-11
HOMO (B1u) = -0.468199358278627  LUMO (Ag) = -0.0984429062618928
Extra cycle  E= -75.3019653412227  delta_E= 2.84e-14  |g|= 3.39e-12  |ddm|= 3.56e-11
converged SCF energy = -75.3019653412227

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpyr8y7f0x
max_memory 4000 MB (current use 315 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4565254955846  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4737144570865  dE = -0.017188962  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4887834484675  dE = -0.015068991  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0393  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5003060217232  dE = -0.011522573  S^2 = 0.0000000
               |grad[o]|=0.0957  |ddm|=0.0259  |maxRot[o]|=0.0796
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5070819981815  dE = -0.0067759765  S^2 = 0.0000000
               |grad[o]|=0.0736  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5121575579425  dE = -0.0050755598  S^2 = 0.0000000
               |grad[o]|=0.0594  |ddm|=0.00472  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.516334657071  dE = -0.0041770991  S^2 = 0.0000000
               |grad[o]|=0.0486  |ddm|=0.00258  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5198644587891  dE = -0.0035298017  S^2 = 0.0000000
               |grad[o]|=0.0398  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5228265644898  dE = -0.0029621057  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5252425480806  dE = -0.0024159836  S^2 = 0.0000000
               |grad[o]|=0.0255  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5271105830044  dE = -0.0018680349  S^2 = 0.0000000
               |grad[o]|=0.0195  |ddm|=0.0022  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.528426513856  dE = -0.0013159309  S^2 = 0.0000000
               |grad[o]|=0.0139  |ddm|=0.00263  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5291872115166  dE = -0.00076069766  S^2 = 0.0000000
               |grad[o]|=0.00884  |ddm|=0.00303  |maxRot[o]|=0.0798
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5293600926683  dE = -0.00017288115  S^2 = 0.0000000
               |grad[o]|=0.00412  |ddm|=0.00349  |maxRot[o]|= 0.04
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5293894029199  dE = -2.9310252e-05  S^2 = 0.0000000
               |grad[o]|=0.00174  |ddm|=0.00233  |maxRot[o]|=0.0197
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5293900629005  dE = -6.5998057e-07  S^2 = 0.0000000
               |grad[o]|=0.000421  |ddm|=0.00168  |maxRot[o]|=0.00302
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5293900845571  dE = -2.1656632e-08  S^2 = 0.0000000
               |grad[o]|=9.61e-05  |ddm|=0.000516  |maxRot[o]|=0.000499
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5293900854118  dE = -8.5468344e-10  S^2 = 0.0000000
               |grad[o]|=2.13e-05  |ddm|=0.000131  |maxRot[o]|=9.08e-05
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5293900854452  dE = -3.3438141e-11  S^2 = 0.0000000
               |grad[o]|=4.17e-06  |ddm|=2.58e-05  |maxRot[o]|=1.78e-05
2-step CASSCF converged in 18 macro (91 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98911928 1.93077483 1.93077463 1.47651509 0.52034969 0.07191178
 0.07191156 0.00864315]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00076   0.00000   0.00000   0.00197  -0.00230
  0 C 2s       0.57327  -0.00000  -0.00000   0.45141  -0.41073
  0 C 3s      -0.05772  -0.00000   0.00000   0.00999  -0.03341
  0 C 2px     -0.00000   0.00000   0.70492   0.00000   0.00000
  0 C 2py     -0.00000   0.70492   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40282  -0.00000   0.00000  -0.54404   0.57355
  0 C 3px     -0.00000   0.00000  -0.04022   0.00000  -0.00000
  0 C 3py      0.00000  -0.04022  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05831  -0.00000   0.00000  -0.00984  -0.03298
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.03836   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04862  -0.00000   0.00000   0.00687   0.01178
  0 C 3dxz    -0.00000   0.00000   0.03836   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00076   0.00000   0.00000  -0.00197  -0.00230
  1 C 2s       0.57327   0.00000  -0.00000  -0.45141  -0.41073
  1 C 3s      -0.05772   0.00000  -0.00000  -0.00999  -0.03341
  1 C 2px      0.00000  -0.00000   0.70492  -0.00000   0.00000
  1 C 2py      0.00000   0.70492   0.00000   0.00000  -0.00000
  1 C 2pz     -0.40282   0.00000   0.00000  -0.54404  -0.57355
  1 C 3px      0.00000  -0.00000  -0.04022  -0.00000  -0.00000
  1 C 3py      0.00000  -0.04022  -0.00000   0.00000   0.00000
  1 C 3pz      0.05831  -0.00000   0.00000  -0.00984   0.03298
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03836   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04862   0.00000  -0.00000  -0.00687   0.01178
  1 C 3dxz    -0.00000   0.00000  -0.03836   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00101
  0 C 2s      -0.00000  -0.00000   0.54172
  0 C 3s       0.00000  -0.00000  -0.04839
  0 C 2px      0.70576  -0.00000   0.00000
  0 C 2py      0.00000   0.70576  -0.00000
  0 C 2pz     -0.00000   0.00000   0.44796
  0 C 3px     -0.03649  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03649  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00649
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02381  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.05909
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00101
  1 C 2s      -0.00000   0.00000  -0.54172
  1 C 3s      -0.00000   0.00000   0.04839
  1 C 2px     -0.70576   0.00000   0.00000
  1 C 2py      0.00000  -0.70576  -0.00000
  1 C 2pz      0.00000   0.00000   0.44796
  1 C 3px      0.03649   0.00000  -0.00000
  1 C 3py     -0.00000   0.03649   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00649
  1 C 3dxy    -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02381  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.05909
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99610894
<CAS-nat-orb|mo-hf>  4  4    0.99985893
<CAS-nat-orb|mo-hf>  5  5    0.99985893
<CAS-nat-orb|mo-hf>  6  6    0.99868925
<CAS-nat-orb|mo-hf>  7  7    0.98295349
<CAS-nat-orb|mo-hf>  8  8    0.88422779
<CAS-nat-orb|mo-hf>  8  15   -0.46451022
<CAS-nat-orb|mo-hf>  9  9    0.88422763
<CAS-nat-orb|mo-hf>  9  16   -0.46451050
<CAS-nat-orb|mo-hf>  10  17    0.44059927
<CAS-nat-orb|mo-hf>  10  20   -0.73158934
CASSCF energy = -75.5293900854452
CASCI E = -75.5293900854452  E(CI) = -18.8101054540163  S^2 = 0.0000000
Density matrix diagonal elements [1.98911946 1.93077452 1.93077468 1.47651333 0.52035139 0.07191176
 0.07191183 0.00864304]
i = 1  <i|F|i> = -11.24804895
i = 2  <i|F|i> = -11.23867034
i = 3  <i|F|i> =  -1.07651820
i = 4  <i|F|i> =  -0.45770118
i = 5  <i|F|i> =  -0.45770121
i = 6  <i|F|i> =  -0.36375497
i = 7  <i|F|i> =  -0.13714565
i = 8  <i|F|i> =   0.38729507
i = 9  <i|F|i> =   0.38729524
i = 10  <i|F|i> =   1.43295504
i = 11  <i|F|i> =   0.56073938
i = 12  <i|F|i> =   0.61039306
i = 13  <i|F|i> =   0.61039305
i = 14  <i|F|i> =   0.75758673
i = 15  <i|F|i> =   0.69404178
i = 16  <i|F|i> =   0.69404162
i = 17  <i|F|i> =   0.56132238
i = 18  <i|F|i> =   1.22452804
i = 19  <i|F|i> =   1.22452804
i = 20  <i|F|i> =   1.19277663
i = 21  <i|F|i> =   1.53503310
i = 22  <i|F|i> =   1.53503310
i = 23  <i|F|i> =   1.73361993
i = 24  <i|F|i> =   1.73361993
i = 25  <i|F|i> =   2.09594176
i = 26  <i|F|i> =   2.26224259
i = 27  <i|F|i> =   2.26224257
i = 28  <i|F|i> =   2.90566126
......production of RDMs took       1.83 sec
......reading the RDM took          0.41 sec
......production of RDMs took      25.28 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00048231781815
E(WickICNEVPT2- rsi) =    -0.00128584357564
E(WickICNEVPT2- ijr) =    -0.00052002918694
E(WickICNEVPT2-  rs) =    -0.04162466423277
E(WickICNEVPT2-  ij) =    -0.00017376772962
E(WickICNEVPT2-  ir) =    -0.00147880077660
E(WickICNEVPT2-   r) =    -0.03999573970494
E(WickICNEVPT2-   i) =    -0.00034060725554
E(WickICNEVPT2) = -75.6152918557254  E_corr_pt = -0.08590177028018461
Timings = pdms =   37.23 | eris =    0.07 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.15 | r =    2.04 | i =    0.83 | total =   40.70
Time cost =    105.173
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:11:55 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.084813282386 AA    0.000000000000   0.000000000000   2.050000000000 Bohr   0.0

nuclear repulsion = 17.5609756097561
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       550.78


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpnivypf73
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8587717717965

WARN: Singularity detected in overlap matrix (condition number = 1.1e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.343801090949931  LUMO (Ag) = -0.208899636382795
cycle= 1 E= -75.3152287127073  delta_E= 0.544  |g|= 0.177  |ddm|= 1.56
HOMO (B1u) = -0.504407518465329  LUMO (Ag) = -0.123879990102771
cycle= 2 E= -75.3262515819531  delta_E= -0.011  |g|= 0.0526  |ddm|= 0.188
HOMO (B1u) = -0.474708360691124  LUMO (Ag) = -0.0950218080877912
cycle= 3 E= -75.3271055696139  delta_E= -0.000854  |g|= 0.0134  |ddm|= 0.101
HOMO (B1u) = -0.474494822450146  LUMO (Ag) = -0.0988363835418893
cycle= 4 E= -75.3272181663453  delta_E= -0.000113  |g|= 0.00221  |ddm|= 0.0646
HOMO (B1u) = -0.475044448091173  LUMO (Ag) = -0.10031489519861
cycle= 5 E= -75.3272215916786  delta_E= -3.43e-06  |g|= 0.000363  |ddm|= 0.0164
HOMO (B1u) = -0.475018098728985  LUMO (Ag) = -0.100277615221355
cycle= 6 E= -75.3272216794877  delta_E= -8.78e-08  |g|= 2.61e-05  |ddm|= 0.00103
HOMO (B1u) = -0.475024517384052  LUMO (Ag) = -0.10028447066135
cycle= 7 E= -75.3272216798441  delta_E= -3.56e-10  |g|= 1.87e-06  |ddm|= 0.000419
HOMO (B1u) = -0.475024512000401  LUMO (Ag) = -0.100284344431195
cycle= 8 E= -75.3272216798456  delta_E= -1.49e-12  |g|= 1.12e-07  |ddm|= 3.22e-05
HOMO (B1u) = -0.475024518733674  LUMO (Ag) = -0.100284359326613
cycle= 9 E= -75.3272216798456  delta_E= 4.26e-14  |g|= 7.12e-09  |ddm|= 6.36e-07
HOMO (B1u) = -0.475024516375512  LUMO (Ag) = -0.100284355804475
cycle= 10 E= -75.3272216798457  delta_E= -1.42e-13  |g|= 6.9e-09  |ddm|= 8.68e-09
HOMO (B1u) = -0.475024518411488  LUMO (Ag) = -0.100284358871397
cycle= 11 E= -75.3272216798457  delta_E= -2.84e-14  |g|= 5.89e-09  |ddm|= 2.95e-08
HOMO (B1u) = -0.475024516729176  LUMO (Ag) = -0.100284356621685
cycle= 12 E= -75.3272216798456  delta_E= 8.53e-14  |g|= 5e-10  |ddm|= 7.39e-09
HOMO (B1u) = -0.475024516795505  LUMO (Ag) = -0.100284356800395
cycle= 13 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 5.06e-10  |ddm|= 1.19e-09
HOMO (B1u) = -0.475024516714698  LUMO (Ag) = -0.1002843567086
cycle= 14 E= -75.3272216798455  delta_E= 8.53e-14  |g|= 5.43e-10  |ddm|= 1.14e-09
HOMO (B1u) = -0.475024516688892  LUMO (Ag) = -0.100284356713271
cycle= 15 E= -75.3272216798456  delta_E= -1.14e-13  |g|= 5.35e-10  |ddm|= 5.35e-10
HOMO (B1u) = -0.475024516741423  LUMO (Ag) = -0.100284356711371
cycle= 16 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 4.17e-10  |ddm|= 3.86e-09
HOMO (B1u) = -0.475024516864335  LUMO (Ag) = -0.10028435680796
cycle= 17 E= -75.3272216798456  delta_E=    0  |g|= 5.68e-10  |ddm|= 1.51e-09
HOMO (B1u) = -0.475024516901608  LUMO (Ag) = -0.100284356827113
cycle= 18 E= -75.3272216798456  delta_E=    0  |g|= 4.14e-10  |ddm|= 6.16e-10
HOMO (B1u) = -0.475024516856776  LUMO (Ag) = -0.100284356792384
cycle= 19 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 2.32e-10  |ddm|= 5.27e-10
HOMO (B1u) = -0.475024516881498  LUMO (Ag) = -0.100284356813014
cycle= 20 E= -75.3272216798456  delta_E=    0  |g|= 9.67e-11  |ddm|= 2.28e-10
HOMO (B1u) = -0.475024516861938  LUMO (Ag) = -0.100284356773051
Extra cycle  E= -75.3272216798456  delta_E= 5.68e-14  |g|= 2.95e-11  |ddm|= 4.08e-10
converged SCF energy = -75.3272216798456

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpnivypf73
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4833111059107  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.501093495336  dE = -0.017782389  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.51658539109  dE = -0.015491896  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0415  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5274438784233  dE = -0.010858487  S^2 = 0.0000000
               |grad[o]|=0.0941  |ddm|=0.0269  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5341204713815  dE = -0.006676593  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0121  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5392309320703  dE = -0.0051104607  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00475  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5434695365214  dE = -0.0042386045  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.00267  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5470496056344  dE = -0.0035800691  S^2 = 0.0000000
               |grad[o]|=0.0393  |ddm|=0.00189  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5500313212091  dE = -0.0029817156  S^2 = 0.0000000
               |grad[o]|=0.0315  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5524229992437  dE = -0.002391678  S^2 = 0.0000000
               |grad[o]|=0.0245  |ddm|=0.0021  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5542142099392  dE = -0.0017912107  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.555394326592  dE = -0.0011801167  S^2 = 0.0000000
               |grad[o]|=0.0125  |ddm|=0.00293  |maxRot[o]|=0.0798
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5559531753495  dE = -0.00055884876  S^2 = 0.0000000
               |grad[o]|=0.0071  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5559945763322  dE = -4.1400983e-05  S^2 = 0.0000000
               |grad[o]|=0.00221  |ddm|=0.00383  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5559984928636  dE = -3.9165314e-06  S^2 = 0.0000000
               |grad[o]|=0.000816  |ddm|=0.00164  |maxRot[o]|=0.00745
macro iter 15 (3 JK  0 micro), CASSCF E = -75.555998589026  dE = -9.6162339e-08  S^2 = 0.0000000
               |grad[o]|=0.00018  |ddm|=0.000849  |maxRot[o]|=0.00111
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5559985922085  dE = -3.1825778e-09  S^2 = 0.0000000
               |grad[o]|=3.82e-05  |ddm|=0.000222  |maxRot[o]|=0.000183
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5559985923272  dE = -1.1866064e-10  S^2 = 0.0000000
               |grad[o]|=8.07e-06  |ddm|=5.39e-05  |maxRot[o]|=3.39e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5559985923254  dE = 1.8474111e-12  S^2 = 0.0000000
               |grad[o]|=1.4e-06  |ddm|=5.57e-06  |maxRot[o]|=6.6e-06
2-step CASSCF converged in 18 macro (89 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98851474 1.9258584  1.92585834 1.49745706 0.49907021 0.07700636
 0.07700623 0.00922867]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00113   0.00000   0.00000   0.00208  -0.00211
  0 C 2s       0.57579   0.00000  -0.00000   0.46137  -0.40723
  0 C 3s      -0.05693  -0.00000  -0.00000   0.00979  -0.03053
  0 C 2px     -0.00000   0.00000   0.70524  -0.00000   0.00000
  0 C 2py      0.00000   0.70524   0.00000  -0.00000  -0.00000
  0 C 2pz      0.39967   0.00000   0.00000  -0.53564   0.57613
  0 C 3px     -0.00000   0.00000  -0.03513  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03513   0.00000   0.00000  -0.00000
  0 C 3pz     -0.05695  -0.00000   0.00000  -0.00906  -0.03424
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.03742   0.00000   0.00000  -0.00000
  0 C 3dz^2    0.04728  -0.00000   0.00000   0.00608   0.01129
  0 C 3dxz    -0.00000   0.00000   0.03742  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00113   0.00000   0.00000  -0.00208  -0.00211
  1 C 2s       0.57579   0.00000  -0.00000  -0.46137  -0.40723
  1 C 3s      -0.05693   0.00000   0.00000  -0.00979  -0.03053
  1 C 2px      0.00000  -0.00000   0.70524   0.00000   0.00000
  1 C 2py      0.00000   0.70524  -0.00000  -0.00000   0.00000
  1 C 2pz     -0.39967   0.00000  -0.00000  -0.53564  -0.57613
  1 C 3px      0.00000  -0.00000  -0.03513   0.00000  -0.00000
  1 C 3py      0.00000  -0.03513  -0.00000   0.00000   0.00000
  1 C 3pz      0.05695  -0.00000  -0.00000  -0.00906   0.03424
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.03742   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04728  -0.00000   0.00000  -0.00608   0.01129
  1 C 3dxz    -0.00000   0.00000  -0.03742  -0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00097
  0 C 2s      -0.00000   0.00000   0.53380
  0 C 3s      -0.00000   0.00000  -0.04704
  0 C 2px      0.70587   0.00000  -0.00000
  0 C 2py      0.00000   0.70587   0.00000
  0 C 2pz     -0.00000  -0.00000   0.45840
  0 C 3px     -0.03434   0.00000  -0.00000
  0 C 3py      0.00000  -0.03434  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.00431
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.05187
  0 C 3dxz    -0.02382  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00097
  1 C 2s       0.00000  -0.00000  -0.53380
  1 C 3s       0.00000  -0.00000   0.04704
  1 C 2px     -0.70587   0.00000   0.00000
  1 C 2py     -0.00000  -0.70587   0.00000
  1 C 2pz      0.00000   0.00000   0.45840
  1 C 3px      0.03434  -0.00000   0.00000
  1 C 3py     -0.00000   0.03434   0.00000
  1 C 3pz     -0.00000   0.00000  -0.00431
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.05187
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99594657
<CAS-nat-orb|mo-hf>  4  4    0.99985545
<CAS-nat-orb|mo-hf>  5  5    0.99985545
<CAS-nat-orb|mo-hf>  6  6    0.99869865
<CAS-nat-orb|mo-hf>  7  7    0.98240657
<CAS-nat-orb|mo-hf>  8  8    0.89361613
<CAS-nat-orb|mo-hf>  8  15   -0.44672576
<CAS-nat-orb|mo-hf>  9  9    0.89361609
<CAS-nat-orb|mo-hf>  9  16   -0.44672584
<CAS-nat-orb|mo-hf>  10  17    0.47419755
<CAS-nat-orb|mo-hf>  10  20   -0.71074878
CASSCF energy = -75.5559985923254
CASCI E = -75.5559985923254  E(CI) = -18.6416908978597  S^2 = 0.0000000
Density matrix diagonal elements [1.98851472 1.92585824 1.92585835 1.49745461 0.49907283 0.07700628
 0.0770063  0.00922866]
i = 1  <i|F|i> = -11.25253517
i = 2  <i|F|i> = -11.24490442
i = 3  <i|F|i> =  -1.06847792
i = 4  <i|F|i> =  -0.44882003
i = 5  <i|F|i> =  -0.44882005
i = 6  <i|F|i> =  -0.37294832
i = 7  <i|F|i> =  -0.13488194
i = 8  <i|F|i> =   0.36660422
i = 9  <i|F|i> =   0.36660426
i = 10  <i|F|i> =   1.37009446
i = 11  <i|F|i> =   0.56559469
i = 12  <i|F|i> =   0.61670023
i = 13  <i|F|i> =   0.61670023
i = 14  <i|F|i> =   0.75327470
i = 15  <i|F|i> =   0.69617261
i = 16  <i|F|i> =   0.69617256
i = 17  <i|F|i> =   0.55946719
i = 18  <i|F|i> =   1.22587783
i = 19  <i|F|i> =   1.22587783
i = 20  <i|F|i> =   1.18440816
i = 21  <i|F|i> =   1.51300118
i = 22  <i|F|i> =   1.51300118
i = 23  <i|F|i> =   1.72040350
i = 24  <i|F|i> =   1.72040350
i = 25  <i|F|i> =   2.09431070
i = 26  <i|F|i> =   2.23829348
i = 27  <i|F|i> =   2.23829347
i = 28  <i|F|i> =   2.79138010
......production of RDMs took      13.31 sec
......reading the RDM took          0.45 sec
......production of RDMs took      25.17 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickICNEVPT2-ijrs) =    -0.00044697414251
E(WickICNEVPT2- rsi) =    -0.00123643331581
E(WickICNEVPT2- ijr) =    -0.00050438893690
E(WickICNEVPT2-  rs) =    -0.04136398379917
E(WickICNEVPT2-  ij) =    -0.00017373767164
E(WickICNEVPT2-  ir) =    -0.00145329956702
E(WickICNEVPT2-   r) =    -0.04066008237548
E(WickICNEVPT2-   i) =    -0.00033421943190
E(WickICNEVPT2) = -75.64217171156579  E_corr_pt = -0.08617311924044535
Timings = pdms =   48.69 | eris =    0.09 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.15 | r =    1.79 | i =    0.70 | total =   51.79
Time cost =    104.295
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:13:40 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.111272142932 AA    0.000000000000   0.000000000000   2.100000000000 Bohr   0.0

nuclear repulsion = 17.1428571428571
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       690.22


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp0j2c76p9
max_memory 4000 MB (current use 322 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8003866027882

WARN: Singularity detected in overlap matrix (condition number =  999). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.328588944868891  LUMO (Ag) = -0.204693729619157
cycle= 1 E= -75.3347800230759  delta_E= 0.466  |g|= 0.18  |ddm|= 1.55
HOMO (B1u) = -0.512671455628693  LUMO (Ag) = -0.127860887413402
cycle= 2 E= -75.346109112634  delta_E= -0.0113  |g|= 0.0522  |ddm|= 0.19
HOMO (B1u) = -0.482062537885923  LUMO (Ag) = -0.0974769445191792
cycle= 3 E= -75.3469306677087  delta_E= -0.000822  |g|= 0.0126  |ddm|= 0.0913
HOMO (B1u) = -0.481374466024948  LUMO (Ag) = -0.100457341704971
cycle= 4 E= -75.3470296424033  delta_E= -9.9e-05  |g|= 0.00217  |ddm|= 0.0587
HOMO (B1u) = -0.481886259872508  LUMO (Ag) = -0.101886818572122
cycle= 5 E= -75.3470329570725  delta_E= -3.31e-06  |g|= 0.000344  |ddm|= 0.0161
HOMO (B1u) = -0.481861583616579  LUMO (Ag) = -0.101865081892997
cycle= 6 E= -75.3470330362213  delta_E= -7.91e-08  |g|= 2.58e-05  |ddm|= 0.000729
HOMO (B1u) = -0.481868355987195  LUMO (Ag) = -0.101872367771483
cycle= 7 E= -75.3470330365669  delta_E= -3.46e-10  |g|= 2.05e-06  |ddm|= 0.000385
HOMO (B1u) = -0.481868395860488  LUMO (Ag) = -0.101872342919467
cycle= 8 E= -75.3470330365686  delta_E= -1.68e-12  |g|= 1.14e-07  |ddm|= 3.34e-05
HOMO (B1u) = -0.481868402322906  LUMO (Ag) = -0.101872355526595
cycle= 9 E= -75.3470330365686  delta_E=    0  |g|= 7.19e-09  |ddm|= 5.08e-07
HOMO (B1u) = -0.481868399647994  LUMO (Ag) = -0.101872352078238
cycle= 10 E= -75.3470330365685  delta_E= 2.84e-14  |g|= 7.12e-09  |ddm|= 1.11e-08
HOMO (B1u) = -0.481868400192219  LUMO (Ag) = -0.101872353267707
cycle= 11 E= -75.3470330365687  delta_E= -1.85e-13  |g|= 6.96e-10  |ddm|= 1.91e-08
HOMO (B1u) = -0.481868400198242  LUMO (Ag) = -0.10187235327342
cycle= 12 E= -75.3470330365686  delta_E= 1.42e-13  |g|= 4.59e-10  |ddm|= 1.75e-09
HOMO (B1u) = -0.481868400178969  LUMO (Ag) = -0.10187235330595
cycle= 13 E= -75.3470330365686  delta_E= -1.42e-14  |g|= 4.28e-10  |ddm|= 1.14e-09
HOMO (B1u) = -0.481868400172447  LUMO (Ag) = -0.101872353275965
cycle= 14 E= -75.3470330365685  delta_E= 8.53e-14  |g|= 3.69e-10  |ddm|= 2.36e-10
HOMO (B1u) = -0.481868400168549  LUMO (Ag) = -0.101872353281202
cycle= 15 E= -75.3470330365686  delta_E= -1.28e-13  |g|= 3.34e-10  |ddm|= 1.82e-10
HOMO (B1u) = -0.481868400196144  LUMO (Ag) = -0.10187235327906
cycle= 16 E= -75.3470330365685  delta_E= 1.14e-13  |g|= 2.88e-10  |ddm|= 1.68e-09
HOMO (B1u) = -0.481868400273027  LUMO (Ag) = -0.101872353333656
cycle= 17 E= -75.3470330365686  delta_E= -8.53e-14  |g|= 4.41e-10  |ddm|= 8.03e-10
HOMO (B1u) = -0.481868400300955  LUMO (Ag) = -0.101872353344294
cycle= 18 E= -75.3470330365686  delta_E= -4.26e-14  |g|= 2.92e-10  |ddm|= 3.38e-10
HOMO (B1u) = -0.481868400249646  LUMO (Ag) = -0.101872353305595
cycle= 19 E= -75.3470330365686  delta_E= 7.11e-14  |g|= 8.22e-11  |ddm|= 4.09e-10
HOMO (B1u) = -0.481868400246671  LUMO (Ag) = -0.10187235330132
cycle= 20 E= -75.3470330365686  delta_E=    0  |g|= 6.83e-11  |ddm|= 4.47e-11
HOMO (B1u) = -0.481868400243241  LUMO (Ag) = -0.101872353286511
Extra cycle  E= -75.3470330365686  delta_E= 1.42e-14  |g|= 1.92e-11  |ddm|= 1.84e-10
converged SCF energy = -75.3470330365686

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp0j2c76p9
max_memory 4000 MB (current use 323 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5047007388545  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5230707816026  dE = -0.018370043  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5389823177201  dE = -0.015911536  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5492400907488  dE = -0.010257773  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0279  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5558470442052  dE = -0.0066069535  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5609995608457  dE = -0.0051525166  S^2 = 0.0000000
               |grad[o]|=0.0585  |ddm|=0.00486  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5652985944592  dE = -0.0042990336  S^2 = 0.0000000
               |grad[o]|=0.0476  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5689164658809  dE = -0.0036178714  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5718931659993  dE = -0.0029767001  S^2 = 0.0000000
               |grad[o]|=0.0304  |ddm|=0.00212  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.574222515933  dE = -0.0023293499  S^2 = 0.0000000
               |grad[o]|=0.0232  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.575884368727  dE = -0.0016618528  S^2 = 0.0000000
               |grad[o]|=0.0166  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5768610787162  dE = -0.00097670999  S^2 = 0.0000000
               |grad[o]|=0.0106  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 12 (5 JK  0 micro), CASSCF E = -75.5771323611592  dE = -0.00027128244  S^2 = 0.0000000
               |grad[o]|=0.00491  |ddm|=0.00368  |maxRot[o]|=0.0599
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5771370942202  dE = -4.733061e-06  S^2 = 0.0000000
               |grad[o]|=0.00106  |ddm|=0.0034  |maxRot[o]|=0.00809
macro iter 14 (3 JK  0 micro), CASSCF E = -75.577137219337  dE = -1.2511677e-07  S^2 = 0.0000000
               |grad[o]|=0.000227  |ddm|=0.00107  |maxRot[o]|=0.00121
macro iter 15 (3 JK  0 micro), CASSCF E = -75.577137223395  dE = -4.0579948e-09  S^2 = 0.0000000
               |grad[o]|=4.47e-05  |ddm|=0.000274  |maxRot[o]|=0.000204
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5771372235462  dE = -1.5126034e-10  S^2 = 0.0000000
               |grad[o]|=8.73e-06  |ddm|=5.85e-05  |maxRot[o]|=3.68e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5771372235523  dE = -6.1106675e-12  S^2 = 0.0000000
               |grad[o]|=1.69e-06  |ddm|=1.21e-05  |maxRot[o]|=7.24e-06
2-step CASSCF converged in 17 macro (85 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98787579 1.9207281  1.92072834 1.51715844 0.4790702  0.08229648
 0.08229651 0.00984614]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00153   0.00000   0.00000   0.00220  -0.00194
  0 C 2s       0.57846  -0.00000  -0.00000   0.47106  -0.40350
  0 C 3s      -0.05596  -0.00000  -0.00000   0.00960  -0.02757
  0 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  0 C 2py      0.00000   0.70551  -0.00000  -0.00000   0.00000
  0 C 2pz      0.39631   0.00000  -0.00000  -0.52717   0.57883
  0 C 3px     -0.00000   0.00000  -0.03031   0.00000  -0.00000
  0 C 3py      0.00000  -0.03031  -0.00000   0.00000   0.00000
  0 C 3pz     -0.05553  -0.00000  -0.00000  -0.00832  -0.03544
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.03648  -0.00000   0.00000   0.00000
  0 C 3dz^2    0.04590  -0.00000  -0.00000   0.00531   0.01098
  0 C 3dxz     0.00000   0.00000   0.03648   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00153   0.00000   0.00000  -0.00220  -0.00194
  1 C 2s       0.57846   0.00000   0.00000  -0.47106  -0.40350
  1 C 3s      -0.05596   0.00000   0.00000  -0.00960  -0.02757
  1 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70551  -0.00000  -0.00000  -0.00000
  1 C 2pz     -0.39631   0.00000   0.00000  -0.52717  -0.57883
  1 C 3px     -0.00000   0.00000  -0.03031  -0.00000   0.00000
  1 C 3py     -0.00000  -0.03031   0.00000  -0.00000  -0.00000
  1 C 3pz      0.05553  -0.00000  -0.00000  -0.00832   0.03544
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.03648  -0.00000   0.00000   0.00000
  1 C 3dz^2    0.04590   0.00000   0.00000  -0.00531   0.01098
  1 C 3dxz     0.00000  -0.00000  -0.03648   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00092
  0 C 2s       0.00000  -0.00000   0.52568
  0 C 3s      -0.00000   0.00000  -0.04590
  0 C 2px      0.70596  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70596  -0.00000
  0 C 2pz     -0.00000   0.00000   0.46846
  0 C 3px     -0.03238  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03238   0.00000
  0 C 3pz     -0.00000   0.00000  -0.00204
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02383   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.04579
  0 C 3dxz    -0.02383  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00092
  1 C 2s       0.00000  -0.00000  -0.52568
  1 C 3s       0.00000  -0.00000   0.04590
  1 C 2px     -0.70596   0.00000   0.00000
  1 C 2py      0.00000  -0.70596  -0.00000
  1 C 2pz     -0.00000  -0.00000   0.46846
  1 C 3px      0.03238   0.00000   0.00000
  1 C 3py      0.00000   0.03238   0.00000
  1 C 3pz      0.00000   0.00000  -0.00204
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02383  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04579
  1 C 3dxz    -0.02383  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99576518
<CAS-nat-orb|mo-hf>  4  4    0.99984965
<CAS-nat-orb|mo-hf>  5  5    0.99984965
<CAS-nat-orb|mo-hf>  6  6    0.99869802
<CAS-nat-orb|mo-hf>  7  7    0.98184923
<CAS-nat-orb|mo-hf>  8  8    0.90221125
<CAS-nat-orb|mo-hf>  8  15   -0.42956745
<CAS-nat-orb|mo-hf>  9  9    0.90221129
<CAS-nat-orb|mo-hf>  9  16   -0.42956738
<CAS-nat-orb|mo-hf>  10  10    0.40783706
<CAS-nat-orb|mo-hf>  10  17    0.50741105
<CAS-nat-orb|mo-hf>  10  20   -0.68802314
CASSCF energy = -75.5771372235523
CASCI E = -75.5771372235523  E(CI) = -18.4770626177156  S^2 = 0.0000000
Density matrix diagonal elements [1.98787567 1.92072814 1.92072813 1.51715225 0.47907623 0.08229681
 0.08229664 0.00984613]
i = 1  <i|F|i> = -11.25749854
i = 2  <i|F|i> = -11.25126968
i = 3  <i|F|i> =  -1.05987226
i = 4  <i|F|i> =  -0.44032632
i = 5  <i|F|i> =  -0.44032632
i = 6  <i|F|i> =  -0.38186117
i = 7  <i|F|i> =  -0.13263996
i = 8  <i|F|i> =   0.34686902
i = 9  <i|F|i> =   0.34686899
i = 10  <i|F|i> =   1.30810028
i = 11  <i|F|i> =   0.57062510
i = 12  <i|F|i> =   0.62275859
i = 13  <i|F|i> =   0.62275860
i = 14  <i|F|i> =   0.74918445
i = 15  <i|F|i> =   0.69803210
i = 16  <i|F|i> =   0.69803213
i = 17  <i|F|i> =   0.55790048
i = 18  <i|F|i> =   1.22751612
i = 19  <i|F|i> =   1.22751612
i = 20  <i|F|i> =   1.17633703
i = 21  <i|F|i> =   1.49148803
i = 22  <i|F|i> =   1.49148804
i = 23  <i|F|i> =   1.70745762
i = 24  <i|F|i> =   1.70745762
i = 25  <i|F|i> =   2.09215530
i = 26  <i|F|i> =   2.21624378
i = 27  <i|F|i> =   2.21624380
i = 28  <i|F|i> =   2.69242912
......production of RDMs took       1.88 sec
......reading the RDM took          0.42 sec
......production of RDMs took      24.63 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00041725927668
E(WickICNEVPT2- rsi) =    -0.00119167816592
E(WickICNEVPT2- ijr) =    -0.00049032370043
E(WickICNEVPT2-  rs) =    -0.04107285724410
E(WickICNEVPT2-  ij) =    -0.00017265596610
E(WickICNEVPT2-  ir) =    -0.00142885113943
E(WickICNEVPT2-   r) =    -0.04133190220335
E(WickICNEVPT2-   i) =    -0.00032780244269
E(WickICNEVPT2) = -75.66357055369105  E_corr_pt = -0.08643333013870332
Timings = pdms =   36.65 | eris =    0.01 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.78 | i =    0.71 | total =   39.66
Time cost =    165.694
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:16:25 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.137731003478 AA    0.000000000000   0.000000000000   2.150000000000 Bohr   0.0

nuclear repulsion = 16.7441860465116
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       771.83


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpsviu09qc
max_memory 4000 MB (current use 319 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.742346402077

WARN: Singularity detected in overlap matrix (condition number =  905). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.314216447683401  LUMO (Ag) = -0.200692527520579
cycle= 1 E= -75.349511035823  delta_E= 0.393  |g|= 0.183  |ddm|= 1.54
HOMO (B2u) = -0.511968787672979  LUMO (Ag) = -0.131517049931573
cycle= 2 E= -75.361230819294  delta_E= -0.0117  |g|= 0.052  |ddm|= 0.195
HOMO (B2u) = -0.477859245905664  LUMO (Ag) = -0.0996643076325125
cycle= 3 E= -75.3620321930707  delta_E= -0.000801  |g|= 0.0118  |ddm|= 0.0834
HOMO (B2u) = -0.48085225451082  LUMO (Ag) = -0.101863987618502
cycle= 4 E= -75.3621184017556  delta_E= -8.62e-05  |g|= 0.00212  |ddm|= 0.0529
HOMO (B3u) = -0.48168450044446  LUMO (Ag) = -0.103214149326986
cycle= 5 E= -75.3621215318461  delta_E= -3.13e-06  |g|= 0.000318  |ddm|= 0.0156
HOMO (B2u) = -0.481600836313237  LUMO (Ag) = -0.103210190493489
cycle= 6 E= -75.3621216003492  delta_E= -6.85e-08  |g|= 2.54e-05  |ddm|= 0.000515
HOMO (B3u) = -0.481601754909294  LUMO (Ag) = -0.103217967965929
cycle= 7 E= -75.3621216006849  delta_E= -3.36e-10  |g|= 2.23e-06  |ddm|= 0.00035
HOMO (B3u) = -0.481601987406661  LUMO (Ag) = -0.103218034520507
cycle= 8 E= -75.362121600687  delta_E= -2.05e-12  |g|= 1.23e-07  |ddm|= 3.4e-05
HOMO (B3u) = -0.481601999518415  LUMO (Ag) = -0.103218045660568
cycle= 9 E= -75.362121600687  delta_E= 1.42e-14  |g|= 7.62e-09  |ddm|= 3.86e-07
HOMO (B2u) = -0.481601998064978  LUMO (Ag) = -0.103218041943686
cycle= 10 E= -75.362121600687  delta_E= -2.84e-14  |g|= 7.43e-09  |ddm|= 1.11e-08
HOMO (B2u) = -0.481601999795426  LUMO (Ag) = -0.103218043457685
cycle= 11 E= -75.362121600687  delta_E=    0  |g|= 7.55e-10  |ddm|= 1.25e-08
HOMO (B2u) = -0.48160199983214  LUMO (Ag) = -0.103218043438327
cycle= 12 E= -75.3621216006869  delta_E= 9.95e-14  |g|= 4.91e-10  |ddm|= 1.57e-09
HOMO (B2u) = -0.481601999859444  LUMO (Ag) = -0.103218043477657
cycle= 13 E= -75.362121600687  delta_E= -7.11e-14  |g|= 4.91e-10  |ddm|= 1.61e-09
HOMO (B3u) = -0.481601999856479  LUMO (Ag) = -0.103218043467961
cycle= 14 E= -75.3621216006869  delta_E= 5.68e-14  |g|= 3.98e-10  |ddm|= 7.46e-10
HOMO (B3u) = -0.481601999867223  LUMO (Ag) = -0.103218043467679
cycle= 15 E= -75.3621216006869  delta_E= -2.84e-14  |g|= 3.61e-10  |ddm|= 4.05e-10
HOMO (B3u) = -0.481601999839246  LUMO (Ag) = -0.103218043456652
cycle= 16 E= -75.362121600687  delta_E= -8.53e-14  |g|= 3.1e-10  |ddm|= 1.65e-09
HOMO (B3u) = -0.481601999853055  LUMO (Ag) = -0.103218043505132
cycle= 17 E= -75.3621216006869  delta_E= 1.28e-13  |g|= 4.65e-10  |ddm|= 7.01e-10
HOMO (B3u) = -0.481601999901537  LUMO (Ag) = -0.103218043509996
cycle= 18 E= -75.3621216006869  delta_E= -4.26e-14  |g|= 3.03e-10  |ddm|= 2.68e-10
HOMO (B3u) = -0.481601999878444  LUMO (Ag) = -0.103218043469053
cycle= 19 E= -75.362121600687  delta_E= -4.26e-14  |g|= 8.71e-11  |ddm|= 4.6e-10
HOMO (B3u) = -0.481601999876045  LUMO (Ag) = -0.103218043465194
cycle= 20 E= -75.3621216006869  delta_E= 5.68e-14  |g|= 7.24e-11  |ddm|= 3.45e-11
HOMO (B3u) = -0.481601999874746  LUMO (Ag) = -0.103218043463392
cycle= 21 E= -75.3621216006869  delta_E= 1.42e-14  |g|= 6.4e-11  |ddm|= 1.54e-11
HOMO (B3u) = -0.481601999872839  LUMO (Ag) = -0.103218043460185
cycle= 22 E= -75.3621216006869  delta_E= -2.84e-14  |g|= 5.33e-11  |ddm|= 7.11e-11
HOMO (B3u) = -0.481601999871314  LUMO (Ag) = -0.103218043457816
cycle= 23 E= -75.3621216006869  delta_E=    0  |g|= 4.47e-11  |ddm|= 4.66e-11
HOMO (B2u) = -0.481601999871983  LUMO (Ag) = -0.1032180434525
Extra cycle  E= -75.3621216006871  delta_E= -1.14e-13  |g|= 1.25e-11  |ddm|= 7.18e-11
converged SCF energy = -75.3621216006871

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpsviu09qc
max_memory 4000 MB (current use 320 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5214099234425  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5403620704944  dE = -0.018952147  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5566943744722  dE = -0.016332304  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0461  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5664483853606  dE = -0.0097540109  S^2 = 0.0000000
               |grad[o]|=0.091  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.573007347288  dE = -0.0065589619  S^2 = 0.0000000
               |grad[o]|=0.0715  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5782102167528  dE = -0.0052028695  S^2 = 0.0000000
               |grad[o]|=0.0576  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5825630264581  dE = -0.0043528097  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5861977853261  dE = -0.0036347589  S^2 = 0.0000000
               |grad[o]|=0.0372  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5891324546794  dE = -0.0029346694  S^2 = 0.0000000
               |grad[o]|=0.0289  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5913444168702  dE = -0.0022119622  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5928029606056  dE = -0.0014585437  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5934808669138  dE = -0.00067790631  S^2 = 0.0000000
               |grad[o]|=0.00812  |ddm|=0.00368  |maxRot[o]|=0.0798
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5935226639145  dE = -4.1797001e-05  S^2 = 0.0000000
               |grad[o]|=0.00228  |ddm|=0.00417  |maxRot[o]|= 0.02
macro iter 13 (3 JK  0 micro), CASSCF E = -75.593527359043  dE = -4.6951285e-06  S^2 = 0.0000000
               |grad[o]|=0.000868  |ddm|=0.00146  |maxRot[o]|=0.00829
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5935274566683  dE = -9.7625303e-08  S^2 = 0.0000000
               |grad[o]|=0.000175  |ddm|=0.000804  |maxRot[o]|=0.00112
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5935274594338  dE = -2.7654607e-09  S^2 = 0.0000000
               |grad[o]|=3.37e-05  |ddm|=0.000201  |maxRot[o]|=0.000174
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5935274595338  dE = -1.0004442e-10  S^2 = 0.0000000
               |grad[o]|=6.88e-06  |ddm|=4.95e-05  |maxRot[o]|=3.08e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5935274595375  dE = -3.6379788e-12  S^2 = 0.0000000
               |grad[o]|=1.18e-06  |ddm|=9.09e-06  |maxRot[o]|=5.92e-06
2-step CASSCF converged in 17 macro (83 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98720387 1.53562489 1.91537976 1.91537954 0.46035381 0.08778187
 0.08778168 0.01049457]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00194   0.00231   0.00000   0.00000  -0.00179
  0 C 2s       0.58123   0.48048  -0.00000  -0.00000  -0.39956
  0 C 3s      -0.05483   0.00943  -0.00000  -0.00000  -0.02456
  0 C 2px      0.00000   0.00000   0.00000   0.70574   0.00000
  0 C 2py      0.00000  -0.00000   0.70574   0.00000   0.00000
  0 C 2pz      0.39276  -0.51862   0.00000  -0.00000   0.58162
  0 C 3px      0.00000   0.00000  -0.00000  -0.02575   0.00000
  0 C 3py     -0.00000   0.00000  -0.02575  -0.00000   0.00000
  0 C 3pz     -0.05404  -0.00761  -0.00000  -0.00000  -0.03659
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.03555  -0.00000   0.00000
  0 C 3dz^2    0.04451   0.00457  -0.00000  -0.00000   0.01083
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03555   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00194  -0.00231   0.00000   0.00000  -0.00179
  1 C 2s       0.58123  -0.48048   0.00000   0.00000  -0.39956
  1 C 3s      -0.05483  -0.00943   0.00000   0.00000  -0.02456
  1 C 2px      0.00000  -0.00000   0.00000   0.70574  -0.00000
  1 C 2py      0.00000  -0.00000   0.70574   0.00000  -0.00000
  1 C 2pz     -0.39276  -0.51862  -0.00000  -0.00000  -0.58162
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.02575  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02575  -0.00000  -0.00000
  1 C 3pz      0.05404  -0.00761  -0.00000  -0.00000   0.03659
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03555   0.00000   0.00000
  1 C 3dz^2    0.04451  -0.00457   0.00000   0.00000   0.01083
  1 C 3dxz     0.00000   0.00000   0.00000  -0.03555   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00088
  0 C 2s      -0.00000  -0.00000   0.51738
  0 C 3s      -0.00000  -0.00000  -0.04498
  0 C 2px      0.70604   0.00000  -0.00000
  0 C 2py      0.00000   0.70604  -0.00000
  0 C 2pz     -0.00000   0.00000   0.47816
  0 C 3px     -0.03061   0.00000  -0.00000
  0 C 3py      0.00000  -0.03061  -0.00000
  0 C 3pz     -0.00000   0.00000   0.00024
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.04072
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00088
  1 C 2s       0.00000  -0.00000  -0.51738
  1 C 3s       0.00000   0.00000   0.04498
  1 C 2px     -0.70604  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70604   0.00000
  1 C 2pz     -0.00000  -0.00000   0.47816
  1 C 3px      0.03061  -0.00000   0.00000
  1 C 3py     -0.00000   0.03061   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00024
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04072
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99556546
<CAS-nat-orb|mo-hf>  4  4    0.99868710
<CAS-nat-orb|mo-hf>  5  5    0.99984158
<CAS-nat-orb|mo-hf>  6  6    0.99984158
<CAS-nat-orb|mo-hf>  7  7    0.98128498
<CAS-nat-orb|mo-hf>  8  8    0.91006599
<CAS-nat-orb|mo-hf>  8  15   -0.41306109
<CAS-nat-orb|mo-hf>  9  9    0.91006591
<CAS-nat-orb|mo-hf>  9  16   -0.41306126
<CAS-nat-orb|mo-hf>  10  10    0.41868601
<CAS-nat-orb|mo-hf>  10  17    0.53963890
<CAS-nat-orb|mo-hf>  10  20   -0.66337393
CASSCF energy = -75.5935274595375
CASCI E = -75.5935274595375  E(CI) = -18.3163035855643  S^2 = 0.0000000
Density matrix diagonal elements [1.98720393 1.53562745 1.91537956 1.9153797  0.46035123 0.08778174
 0.08778185 0.01049455]
i = 1  <i|F|i> = -11.26279327
i = 2  <i|F|i> = -11.25769248
i = 3  <i|F|i> =  -1.05081913
i = 4  <i|F|i> =  -0.39050191
i = 5  <i|F|i> =  -0.43218533
i = 6  <i|F|i> =  -0.43218535
i = 7  <i|F|i> =  -0.13042902
i = 8  <i|F|i> =   0.32803603
i = 9  <i|F|i> =   0.32803611
i = 10  <i|F|i> =   1.24747867
i = 11  <i|F|i> =   0.57579344
i = 12  <i|F|i> =   0.62856630
i = 13  <i|F|i> =   0.62856630
i = 14  <i|F|i> =   0.74534426
i = 15  <i|F|i> =   0.69964280
i = 16  <i|F|i> =   0.69964272
i = 17  <i|F|i> =   0.55660027
i = 18  <i|F|i> =   1.22943752
i = 19  <i|F|i> =   1.22943752
i = 20  <i|F|i> =   1.16854460
i = 21  <i|F|i> =   1.47052622
i = 22  <i|F|i> =   1.47052622
i = 23  <i|F|i> =   1.69478900
i = 24  <i|F|i> =   1.69478900
i = 25  <i|F|i> =   2.08913888
i = 26  <i|F|i> =   2.19574275
i = 27  <i|F|i> =   2.19574274
i = 28  <i|F|i> =   2.60670614
......production of RDMs took       1.83 sec
......reading the RDM took          0.41 sec
......production of RDMs took      23.68 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00039233114689
E(WickICNEVPT2- rsi) =    -0.00115128398696
E(WickICNEVPT2- ijr) =    -0.00047775737513
E(WickICNEVPT2-  rs) =    -0.04075422132577
E(WickICNEVPT2-  ij) =    -0.00017064412220
E(WickICNEVPT2-  ir) =    -0.00140538675294
E(WickICNEVPT2-   r) =    -0.04201142767452
E(WickICNEVPT2-   i) =    -0.00032140198607
E(WickICNEVPT2) = -75.68021191390793  E_corr_pt = -0.08668445437047086
Timings = pdms =   35.63 | eris =    0.61 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.17 | r =    1.77 | i =    0.70 | total =   39.26
Time cost =     99.703
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:18:05 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.164189864024 AA    0.000000000000   0.000000000000   2.200000000000 Bohr   0.0

nuclear repulsion = 16.3636363636364
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.1]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       989.69


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpev51qmw4
max_memory 4000 MB (current use 315 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6850211082767

WARN: Singularity detected in overlap matrix (condition number =  823). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.300635738182938  LUMO (Ag) = -0.196894745039134
cycle= 1 E= -75.3600714434763  delta_E= 0.325  |g|= 0.186  |ddm|= 1.52
HOMO (B2u) = -0.505767689307349  LUMO (Ag) = -0.134850139116739
cycle= 2 E= -75.3722557388853  delta_E= -0.0122  |g|= 0.0519  |ddm|= 0.201
HOMO (B3u) = -0.471042686025418  LUMO (Ag) = -0.101583923798026
cycle= 3 E= -75.3730472275436  delta_E= -0.000791  |g|= 0.011  |ddm|= 0.0769
HOMO (B3u) = -0.473583831878465  LUMO (Ag) = -0.103064436209409
cycle= 4 E= -75.3731222408077  delta_E= -7.5e-05  |g|= 0.00204  |ddm|= 0.0475
HOMO (B3u) = -0.474409949766164  LUMO (Ag) = -0.104308159498407
cycle= 5 E= -75.3731251255001  delta_E= -2.88e-06  |g|= 0.000283  |ddm|= 0.0148
HOMO (B2u) = -0.47434815104296  LUMO (Ag) = -0.104322379442281
cycle= 6 E= -75.3731251811964  delta_E= -5.57e-08  |g|= 2.51e-05  |ddm|= 0.000586
HOMO (B3u) = -0.474349388268696  LUMO (Ag) = -0.104330764317115
cycle= 7 E= -75.3731251815252  delta_E= -3.29e-10  |g|= 2.41e-06  |ddm|= 0.000311
HOMO (B2u) = -0.474349685667097  LUMO (Ag) = -0.104330912577478
cycle= 8 E= -75.3731251815274  delta_E= -2.2e-12  |g|= 1.4e-07  |ddm|= 3.41e-05
HOMO (B3u) = -0.4743496993917  LUMO (Ag) = -0.104330922329524
cycle= 9 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 8.38e-09  |ddm|= 2.86e-07
HOMO (B2u) = -0.474349697422574  LUMO (Ag) = -0.104330918010578
cycle= 10 E= -75.3731251815274  delta_E=    0  |g|= 7.64e-09  |ddm|= 1.04e-08
HOMO (B2u) = -0.474349699524436  LUMO (Ag) = -0.104330919962501
cycle= 11 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 8.18e-10  |ddm|= 1.33e-08
HOMO (B3u) = -0.474349699599448  LUMO (Ag) = -0.10433091999913
cycle= 12 E= -75.3731251815275  delta_E= -8.53e-14  |g|= 6.05e-10  |ddm|= 1.72e-09
HOMO (B3u) = -0.474349699605089  LUMO (Ag) = -0.104330920004441
cycle= 13 E= -75.3731251815274  delta_E= 8.53e-14  |g|= 5.37e-10  |ddm|= 1.25e-09
HOMO (B3u) = -0.474349699604238  LUMO (Ag) = -0.104330919989936
cycle= 14 E= -75.3731251815274  delta_E= -5.68e-14  |g|= 4.51e-10  |ddm|= 1.51e-10
HOMO (B3u) = -0.474349699619153  LUMO (Ag) = -0.104330919983403
cycle= 15 E= -75.3731251815274  delta_E= 4.26e-14  |g|= 4.1e-10  |ddm|= 4.49e-10
HOMO (B3u) = -0.474349699582345  LUMO (Ag) = -0.10433091996492
cycle= 16 E= -75.3731251815274  delta_E= -4.26e-14  |g|= 3.51e-10  |ddm|= 1.48e-09
HOMO (B3u) = -0.474349699578188  LUMO (Ag) = -0.104330920005191
cycle= 17 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 5e-10  |ddm|= 8.03e-10
HOMO (B2u) = -0.474349699622237  LUMO (Ag) = -0.104330920003481
cycle= 18 E= -75.3731251815274  delta_E=    0  |g|= 3.2e-10  |ddm|= 3.54e-10
HOMO (B2u) = -0.474349699594223  LUMO (Ag) = -0.104330919959046
cycle= 19 E= -75.3731251815275  delta_E= -5.68e-14  |g|= 9.93e-11  |ddm|= 6.36e-10
HOMO (B2u) = -0.47434969959214  LUMO (Ag) = -0.104330919955378
cycle= 20 E= -75.3731251815275  delta_E=    0  |g|= 8.35e-11  |ddm|= 3.2e-11
HOMO (B3u) = -0.474349699594672  LUMO (Ag) = -0.104330919948542
Extra cycle  E= -75.3731251815274  delta_E= 2.84e-14  |g|= 2.3e-11  |ddm|= 1.12e-10
converged SCF energy = -75.3731251815274

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpev51qmw4
max_memory 4000 MB (current use 315 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5340692264402  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5535986408691  dE = -0.019529414  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5700765822578  dE = -0.016477941  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0484  |maxRot[o]|=0.0784
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5795456785758  dE = -0.0094690963  S^2 = 0.0000000
               |grad[o]|=0.0899  |ddm|=0.0297  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5861247361224  dE = -0.0065790575  S^2 = 0.0000000
               |grad[o]|=0.0707  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5914072638789  dE = -0.0052825278  S^2 = 0.0000000
               |grad[o]|=0.0568  |ddm|=0.00536  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5958190891985  dE = -0.0044118253  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5994552531644  dE = -0.003636164  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6023109143976  dE = -0.0028556612  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.00296  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043454280619  dE = -0.0020345137  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6054821882679  dE = -0.0011367602  S^2 = 0.0000000
               |grad[o]|=0.012  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 11 (5 JK  0 micro), CASSCF E = -75.6057915430667  dE = -0.0003093548  S^2 = 0.0000000
               |grad[o]|=0.00551  |ddm|=0.00398  |maxRot[o]|=0.0599
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6058040753453  dE = -1.2532279e-05  S^2 = 0.0000000
               |grad[o]|=0.00133  |ddm|=0.00326  |maxRot[o]|=0.0137
macro iter 13 (3 JK  0 micro), CASSCF E = -75.605804318559  dE = -2.4321372e-07  S^2 = 0.0000000
               |grad[o]|=0.000278  |ddm|=0.00116  |maxRot[o]|=0.00175
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6058043249415  dE = -6.3825212e-09  S^2 = 0.0000000
               |grad[o]|=5.08e-05  |ddm|=0.000301  |maxRot[o]|=0.000267
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6058043251432  dE = -2.0172308e-10  S^2 = 0.0000000
               |grad[o]|=9.36e-06  |ddm|=6.66e-05  |maxRot[o]|=4.53e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6058043251499  dE = -6.65068e-12  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=1.38e-05  |maxRot[o]|=8.56e-06
2-step CASSCF converged in 16 macro (79 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98650073 1.55290079 1.90980676 1.90980644 0.44288817 0.09346204
 0.09346214 0.01117293]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00235   0.00241   0.00000   0.00000  -0.00166
  0 C 2s       0.58410   0.48964  -0.00000  -0.00000  -0.39544
  0 C 3s      -0.05356   0.00927  -0.00000  -0.00000  -0.02152
  0 C 2px     -0.00000   0.00000   0.00000   0.70593   0.00000
  0 C 2py      0.00000  -0.00000   0.70593  -0.00000  -0.00000
  0 C 2pz      0.38903  -0.51000   0.00000  -0.00000   0.58448
  0 C 3px     -0.00000   0.00000   0.00000  -0.02144   0.00000
  0 C 3py      0.00000  -0.00000  -0.02144  -0.00000  -0.00000
  0 C 3pz     -0.05250  -0.00695  -0.00000  -0.00000  -0.03768
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03464  -0.00000  -0.00000
  0 C 3dz^2    0.04312   0.00386  -0.00000  -0.00000   0.01086
  0 C 3dxz    -0.00000   0.00000   0.00000   0.03464   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00235  -0.00241   0.00000   0.00000  -0.00166
  1 C 2s       0.58410  -0.48964   0.00000   0.00000  -0.39544
  1 C 3s      -0.05356  -0.00927   0.00000   0.00000  -0.02152
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70593  -0.00000
  1 C 2py      0.00000   0.00000   0.70593   0.00000   0.00000
  1 C 2pz     -0.38903  -0.51000   0.00000  -0.00000  -0.58448
  1 C 3px      0.00000  -0.00000  -0.00000  -0.02144  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02144   0.00000   0.00000
  1 C 3pz      0.05250  -0.00695  -0.00000  -0.00000   0.03768
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03464  -0.00000  -0.00000
  1 C 3dz^2    0.04312  -0.00386   0.00000   0.00000   0.01086
  1 C 3dxz    -0.00000   0.00000   0.00000  -0.03464   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00084
  0 C 2s      -0.00000  -0.00000   0.50895
  0 C 3s      -0.00000  -0.00000  -0.04424
  0 C 2px      0.70611   0.00000  -0.00000
  0 C 2py      0.00000   0.70611  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.48752
  0 C 3px     -0.02900   0.00000  -0.00000
  0 C 3py      0.00000  -0.02900  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00249
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03651
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00084
  1 C 2s       0.00000   0.00000  -0.50895
  1 C 3s       0.00000   0.00000   0.04424
  1 C 2px     -0.70611  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70611   0.00000
  1 C 2pz     -0.00000   0.00000   0.48752
  1 C 3px      0.02900  -0.00000   0.00000
  1 C 3py     -0.00000   0.02900   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00249
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.03651
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99534814
<CAS-nat-orb|mo-hf>  4  4    0.99866563
<CAS-nat-orb|mo-hf>  5  5    0.99983126
<CAS-nat-orb|mo-hf>  6  6    0.99983126
<CAS-nat-orb|mo-hf>  7  7    0.98071661
<CAS-nat-orb|mo-hf>  8  8    0.91723382
<CAS-nat-orb|mo-hf>  9  9    0.91723376
<CAS-nat-orb|mo-hf>  10  10    0.43078504
<CAS-nat-orb|mo-hf>  10  17    0.57019754
<CAS-nat-orb|mo-hf>  10  20   -0.63691916
CASSCF energy = -75.6058043251499
CASCI E = -75.6058043251499  E(CI) = -18.159467329522  S^2 = 0.0000000
Density matrix diagonal elements [1.98650096 1.55290249 1.909806   1.90980625 0.44288693 0.09346228
 0.09346225 0.01117284]
i = 1  <i|F|i> = -11.26829776
i = 2  <i|F|i> = -11.26410821
i = 3  <i|F|i> =  -1.04142138
i = 4  <i|F|i> =  -0.39887892
i = 5  <i|F|i> =  -0.42436504
i = 6  <i|F|i> =  -0.42436508
i = 7  <i|F|i> =  -0.12825476
i = 8  <i|F|i> =   0.31005523
i = 9  <i|F|i> =   0.31005534
i = 10  <i|F|i> =   1.18859839
i = 11  <i|F|i> =   0.58106249
i = 12  <i|F|i> =   0.63412208
i = 13  <i|F|i> =   0.63412209
i = 14  <i|F|i> =   0.74177984
i = 15  <i|F|i> =   0.70102954
i = 16  <i|F|i> =   0.70102948
i = 17  <i|F|i> =   0.55555653
i = 18  <i|F|i> =   1.23163519
i = 19  <i|F|i> =   1.23163519
i = 20  <i|F|i> =   1.16101010
i = 21  <i|F|i> =   1.45014795
i = 22  <i|F|i> =   1.45014795
i = 23  <i|F|i> =   1.68240368
i = 24  <i|F|i> =   1.68240368
i = 25  <i|F|i> =   2.08494014
i = 26  <i|F|i> =   2.17648014
i = 27  <i|F|i> =   2.17648010
i = 28  <i|F|i> =   2.53241535
......production of RDMs took       1.84 sec
......reading the RDM took          0.41 sec
......production of RDMs took      25.69 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00037146662506
E(WickICNEVPT2- rsi) =    -0.00111493542330
E(WickICNEVPT2- ijr) =    -0.00046654533114
E(WickICNEVPT2-  rs) =    -0.04041094452567
E(WickICNEVPT2-  ij) =    -0.00016782847290
E(WickICNEVPT2-  ir) =    -0.00138283330442
E(WickICNEVPT2-   r) =    -0.04269945694308
E(WickICNEVPT2-   i) =    -0.00031504658243
E(WickICNEVPT2) = -75.69273338235786  E_corr_pt = -0.08692905720797874
Timings = pdms =   37.65 | eris =    0.62 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.14 | r =    1.99 | i =    0.81 | total =   41.58
Time cost =    195.075
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:21:20 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.190648724570 AA    0.000000000000   0.000000000000   2.250000000000 Bohr   0.0

nuclear repulsion = 16
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.125]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1079.27


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp8jwg1kcs
max_memory 4000 MB (current use 317 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6287133444179

WARN: Singularity detected in overlap matrix (condition number =  749). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.287801147291401  LUMO (Ag) = -0.193295779361719
cycle= 1 E= -75.3670366286219  delta_E= 0.262  |g|= 0.19  |ddm|= 1.51
HOMO (B2u) = -0.499807889396644  LUMO (Ag) = -0.137862572577771
cycle= 2 E= -75.379748235821  delta_E= -0.0127  |g|= 0.0519  |ddm|= 0.208
HOMO (B3u) = -0.464540226195211  LUMO (Ag) = -0.103237375699654
cycle= 3 E= -75.3805383397255  delta_E= -0.00079  |g|= 0.0104  |ddm|= 0.0716
HOMO (B3u) = -0.466699997579165  LUMO (Ag) = -0.104062742035943
cycle= 4 E= -75.3806041774368  delta_E= -6.58e-05  |g|= 0.00196  |ddm|= 0.0425
HOMO (B3u) = -0.46750761286316  LUMO (Ag) = -0.105181483870834
cycle= 5 E= -75.3806067875641  delta_E= -2.61e-06  |g|= 0.00024  |ddm|= 0.0138
HOMO (B3u) = -0.46746900990427  LUMO (Ag) = -0.105209990979457
cycle= 6 E= -75.3806068286268  delta_E= -4.11e-08  |g|= 2.47e-05  |ddm|= 0.000855
HOMO (B2u) = -0.467470595918402  LUMO (Ag) = -0.10521918079484
cycle= 7 E= -75.3806068289548  delta_E= -3.28e-10  |g|= 2.6e-06  |ddm|= 0.000264
HOMO (B2u) = -0.467470958374986  LUMO (Ag) = -0.105219406231832
cycle= 8 E= -75.3806068289574  delta_E= -2.63e-12  |g|= 1.64e-07  |ddm|= 3.35e-05
HOMO (B3u) = -0.46747097364146  LUMO (Ag) = -0.105219414001671
cycle= 9 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 9.4e-09  |ddm|= 3.15e-07
HOMO (B3u) = -0.467470971054962  LUMO (Ag) = -0.105219408940562
cycle= 10 E= -75.3806068289575  delta_E= -4.26e-14  |g|= 7.59e-09  |ddm|= 1.06e-08
HOMO (B3u) = -0.467470973513664  LUMO (Ag) = -0.105219411368221
cycle= 11 E= -75.3806068289575  delta_E= -1.42e-14  |g|= 9.03e-10  |ddm|= 1.82e-08
HOMO (B3u) = -0.467470973612692  LUMO (Ag) = -0.105219411423924
cycle= 12 E= -75.3806068289575  delta_E=    0  |g|= 7.02e-10  |ddm|= 1.97e-09
HOMO (B3u) = -0.467470973594185  LUMO (Ag) = -0.105219411399272
cycle= 13 E= -75.3806068289575  delta_E= -2.84e-14  |g|= 5.9e-10  |ddm|= 1.29e-09
HOMO (B3u) = -0.467470973608024  LUMO (Ag) = -0.105219411406421
cycle= 14 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 5.2e-10  |ddm|= 1.43e-10
HOMO (B3u) = -0.467470973617533  LUMO (Ag) = -0.105219411398496
cycle= 15 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 4.56e-10  |ddm|= 4.95e-10
HOMO (B3u) = -0.467470973585862  LUMO (Ag) = -0.105219411377642
cycle= 16 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 4.03e-10  |ddm|= 8.96e-10
HOMO (B3u) = -0.467470973561971  LUMO (Ag) = -0.10521941140064
cycle= 17 E= -75.3806068289574  delta_E= -5.68e-14  |g|= 5.3e-10  |ddm|= 1.02e-09
HOMO (B3u) = -0.467470973601473  LUMO (Ag) = -0.105219411390542
cycle= 18 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 3.23e-10  |ddm|= 4.58e-10
HOMO (B3u) = -0.467470973564805  LUMO (Ag) = -0.105219411341019
cycle= 19 E= -75.3806068289574  delta_E=    0  |g|= 1.13e-10  |ddm|= 7.67e-10
HOMO (B3u) = -0.467470973563243  LUMO (Ag) = -0.105219411337592
cycle= 20 E= -75.3806068289575  delta_E= -9.95e-14  |g|= 9.55e-11  |ddm|= 3.22e-11
HOMO (B3u) = -0.467470973565426  LUMO (Ag) = -0.10521941133754
cycle= 21 E= -75.3806068289575  delta_E= 1.42e-14  |g|= 8.07e-11  |ddm|= 3.28e-11
HOMO (B2u) = -0.467470973565783  LUMO (Ag) = -0.105219411336122
cycle= 22 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 6.69e-11  |ddm|= 3.39e-11
HOMO (B3u) = -0.467470973566366  LUMO (Ag) = -0.105219411334998
cycle= 23 E= -75.3806068289574  delta_E= 4.26e-14  |g|= 5.5e-11  |ddm|= 3.59e-11
HOMO (B3u) = -0.467470973566613  LUMO (Ag) = -0.105219411334146
cycle= 24 E= -75.3806068289575  delta_E= -7.11e-14  |g|= 4.61e-11  |ddm|= 4.71e-11
HOMO (B3u) = -0.467470973566734  LUMO (Ag) = -0.105219411332999
cycle= 25 E= -75.3806068289575  delta_E= -2.84e-14  |g|= 3.84e-11  |ddm|= 2.4e-11
HOMO (B2u) = -0.467470973568395  LUMO (Ag) = -0.10521941133181
cycle= 26 E= -75.3806068289575  delta_E= -2.84e-14  |g|= 2.39e-11  |ddm|= 3.44e-11
HOMO (B3u) = -0.467470973570479  LUMO (Ag) = -0.105219411332641
cycle= 27 E= -75.3806068289575  delta_E= 2.84e-14  |g|= 1.76e-11  |ddm|= 2.66e-11
HOMO (B2u) = -0.467470973570306  LUMO (Ag) = -0.105219411331916
cycle= 28 E= -75.3806068289575  delta_E= 4.26e-14  |g|= 1.45e-11  |ddm|= 7.59e-12
HOMO (B3u) = -0.467470973570083  LUMO (Ag) = -0.105219411331206
cycle= 29 E= -75.3806068289575  delta_E= -4.26e-14  |g|= 1.18e-11  |ddm|= 6.86e-12
HOMO (B3u) = -0.467470973569917  LUMO (Ag) = -0.105219411330606
cycle= 30 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 9.48e-12  |ddm|= 6.67e-12
HOMO (B3u) = -0.467470973569793  LUMO (Ag) = -0.105219411330102
cycle= 31 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 7.54e-12  |ddm|= 5.3e-12
HOMO (B2u) = -0.467470973569721  LUMO (Ag) = -0.105219411329705
cycle= 32 E= -75.3806068289574  delta_E= -1.42e-14  |g|= 5.95e-12  |ddm|= 3.76e-12
HOMO (B2u) = -0.467470973569713  LUMO (Ag) = -0.105219411329405
cycle= 33 E= -75.3806068289574  delta_E= 1.42e-14  |g|= 4.63e-12  |ddm|= 2.09e-12
HOMO (B3u) = -0.467470973569734  LUMO (Ag) = -0.105219411329179
cycle= 34 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 3.63e-12  |ddm|= 1.61e-12
HOMO (B3u) = -0.467470973569741  LUMO (Ag) = -0.105219411329028
cycle= 35 E= -75.3806068289574  delta_E= -2.84e-14  |g|= 3e-12  |ddm|= 1.13e-12
HOMO (B2u) = -0.467470973569776  LUMO (Ag) = -0.105219411328918
cycle= 36 E= -75.3806068289574  delta_E= -1.42e-14  |g|= 2.43e-12  |ddm|= 1.77e-12
HOMO (B2u) = -0.467470973569804  LUMO (Ag) = -0.105219411328822
cycle= 37 E= -75.3806068289574  delta_E=    0  |g|= 1.96e-12  |ddm|= 1.56e-12
HOMO (B3u) = -0.467470973569869  LUMO (Ag) = -0.105219411328532
Extra cycle  E= -75.3806068289574  delta_E= 1.42e-14  |g|= 7.17e-13  |ddm|= 3.59e-12
converged SCF energy = -75.3806068289574

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp8jwg1kcs
max_memory 4000 MB (current use 317 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5432350451996  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5633378815476  dE = -0.020102836  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5798666745096  dE = -0.016528793  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0508  |maxRot[o]|=0.0765
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5891764418762  dE = -0.0093097674  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0302  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5958196610644  dE = -0.0066432192  S^2 = 0.0000000
               |grad[o]|=0.0699  |ddm|=0.0111  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6011966185229  dE = -0.0053769575  S^2 = 0.0000000
               |grad[o]|=0.0557  |ddm|=0.00578  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6056569831824  dE = -0.0044603647  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00393  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6092561924983  dE = -0.0035992093  S^2 = 0.0000000
               |grad[o]|=0.034  |ddm|=0.00337  |maxRot[o]|=0.0797
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6118597709656  dE = -0.0026035785  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6135439050931  dE = -0.0016841341  S^2 = 0.0000000
               |grad[o]|=0.0171  |ddm|=0.00365  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6143871912952  dE = -0.0008432862  S^2 = 0.0000000
               |grad[o]|= 0.01  |ddm|=0.00384  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6145205407692  dE = -0.00013334947  S^2 = 0.0000000
               |grad[o]|=0.00374  |ddm|=0.00405  |maxRot[o]|= 0.04
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6145268325251  dE = -6.2917559e-06  S^2 = 0.0000000
               |grad[o]|=0.000953  |ddm|=0.0023  |maxRot[o]|=0.00978
macro iter 13 (3 JK  0 micro), CASSCF E = -75.614526949808  dE = -1.1728288e-07  S^2 = 0.0000000
               |grad[o]|=0.000186  |ddm|=0.000824  |maxRot[o]|=0.00121
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6145269527589  dE = -2.9508413e-09  S^2 = 0.0000000
               |grad[o]|=3.32e-05  |ddm|=0.000205  |maxRot[o]|=0.000182
macro iter 15 (3 JK  0 micro), CASSCF E = -75.614526952846  dE = -8.7112539e-11  S^2 = 0.0000000
               |grad[o]|=6.05e-06  |ddm|=4.46e-05  |maxRot[o]|=3.08e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6145269528482  dE = -2.2311042e-12  S^2 = 0.0000000
               |grad[o]|=1.09e-06  |ddm|=9.17e-06  |maxRot[o]|=5.64e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98576842 1.56903903 1.90400116 1.90400163 0.42663284 0.0993385
 0.0993386  0.01187982]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00276   0.00252   0.00000   0.00000  -0.00155
  0 C 2s       0.58703   0.49855   0.00000   0.00000  -0.39116
  0 C 3s      -0.05216   0.00914   0.00000   0.00000  -0.01848
  0 C 2px      0.00000   0.00000  -0.00000   0.70609   0.00000
  0 C 2py     -0.00000  -0.00000   0.70609   0.00000  -0.00000
  0 C 2pz      0.38514  -0.50131   0.00000  -0.00000   0.58739
  0 C 3px      0.00000  -0.00000  -0.00000  -0.01737  -0.00000
  0 C 3py      0.00000  -0.00000  -0.01737   0.00000  -0.00000
  0 C 3pz     -0.05093  -0.00632   0.00000   0.00000  -0.03868
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03373   0.00000  -0.00000
  0 C 3dz^2    0.04175   0.00318   0.00000   0.00000   0.01107
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03373  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00276  -0.00252   0.00000   0.00000  -0.00155
  1 C 2s       0.58703  -0.49855  -0.00000  -0.00000  -0.39116
  1 C 3s      -0.05216  -0.00914  -0.00000  -0.00000  -0.01848
  1 C 2px     -0.00000   0.00000   0.00000   0.70609   0.00000
  1 C 2py     -0.00000   0.00000   0.70609  -0.00000   0.00000
  1 C 2pz     -0.38514  -0.50131   0.00000  -0.00000  -0.58739
  1 C 3px     -0.00000  -0.00000   0.00000  -0.01737   0.00000
  1 C 3py      0.00000   0.00000  -0.01737  -0.00000   0.00000
  1 C 3pz      0.05093  -0.00632   0.00000   0.00000   0.03868
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.03373   0.00000  -0.00000
  1 C 3dz^2    0.04175  -0.00318  -0.00000   0.00000   0.01107
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03373  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00080
  0 C 2s       0.00000   0.00000   0.50039
  0 C 3s      -0.00000  -0.00000  -0.04369
  0 C 2px      0.70617   0.00000  -0.00000
  0 C 2py      0.00000   0.70617   0.00000
  0 C 2pz     -0.00000  -0.00000   0.49657
  0 C 3px     -0.02753   0.00000  -0.00000
  0 C 3py      0.00000  -0.02753  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00467
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03305
  0 C 3dxz    -0.02382   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00080
  1 C 2s       0.00000   0.00000  -0.50039
  1 C 3s       0.00000   0.00000   0.04369
  1 C 2px     -0.70617  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70617   0.00000
  1 C 2pz     -0.00000   0.00000   0.49657
  1 C 3px      0.02753  -0.00000   0.00000
  1 C 3py     -0.00000   0.02753  -0.00000
  1 C 3pz     -0.00000  -0.00000   0.00467
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03305
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99511402
<CAS-nat-orb|mo-hf>  4  4    0.99863346
<CAS-nat-orb|mo-hf>  5  5    0.99981869
<CAS-nat-orb|mo-hf>  6  6    0.99981869
<CAS-nat-orb|mo-hf>  7  7    0.98014678
<CAS-nat-orb|mo-hf>  8  8    0.92376829
<CAS-nat-orb|mo-hf>  9  9    0.92376839
<CAS-nat-orb|mo-hf>  10  10    0.44416418
<CAS-nat-orb|mo-hf>  10  17    0.59838638
<CAS-nat-orb|mo-hf>  10  20   -0.60893960
CASSCF energy = -75.6145269528482
CASCI E = -75.6145269528482  E(CI) = -18.0065822075068  S^2 = 0.0000000
Density matrix diagonal elements [1.98576857 1.56904065 1.90400126 1.90400176 0.42663125 0.09933825
 0.09933854 0.01187973]
i = 1  <i|F|i> = -11.27391367
i = 2  <i|F|i> = -11.27046354
i = 3  <i|F|i> =  -1.03177040
i = 4  <i|F|i> =  -0.40700707
i = 5  <i|F|i> =  -0.41683748
i = 6  <i|F|i> =  -0.41683758
i = 7  <i|F|i> =  -0.12611617
i = 8  <i|F|i> =   0.29287786
i = 9  <i|F|i> =   0.29287766
i = 10  <i|F|i> =   1.13172458
i = 11  <i|F|i> =   0.58639535
i = 12  <i|F|i> =   0.63942453
i = 13  <i|F|i> =   0.63942452
i = 14  <i|F|i> =   0.73851489
i = 15  <i|F|i> =   0.70221860
i = 16  <i|F|i> =   0.70221870
i = 17  <i|F|i> =   0.55476185
i = 18  <i|F|i> =   1.23410007
i = 19  <i|F|i> =   1.23410007
i = 20  <i|F|i> =   1.15371323
i = 21  <i|F|i> =   1.43038414
i = 22  <i|F|i> =   1.43038415
i = 23  <i|F|i> =   1.67030643
i = 24  <i|F|i> =   1.67030643
i = 25  <i|F|i> =   2.07927179
i = 26  <i|F|i> =   2.15818594
i = 27  <i|F|i> =   2.15818596
i = 28  <i|F|i> =   2.46801470
......production of RDMs took       1.89 sec
......reading the RDM took          0.42 sec
......production of RDMs took      23.05 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.74 sec

E(WickICNEVPT2-ijrs) =    -0.00035404284282
E(WickICNEVPT2- rsi) =    -0.00108230003583
E(WickICNEVPT2- ijr) =    -0.00045650127543
E(WickICNEVPT2-  rs) =    -0.04004585149664
E(WickICNEVPT2-  ij) =    -0.00016433610572
E(WickICNEVPT2-  ir) =    -0.00136112784978
E(WickICNEVPT2-   r) =    -0.04339607628812
E(WickICNEVPT2-   i) =    -0.00030875314024
E(WickICNEVPT2) = -75.70169594188279  E_corr_pt = -0.08716898903459451
Timings = pdms =   35.08 | eris =    0.32 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.77 | i =    0.70 | total =   38.38
Time cost =     81.538
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:22:42 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.217107585116 AA    0.000000000000   0.000000000000   2.300000000000 Bohr   0.0

nuclear repulsion = 15.6521739130435
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.15]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1243.67


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpkpwn6qdy
max_memory 4000 MB (current use 323 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.5736679955661

WARN: Singularity detected in overlap matrix (condition number =  684). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.275669226345097  LUMO (Ag) = -0.189888551192396
cycle= 1 E= -75.3709156762751  delta_E= 0.203  |g|= 0.194  |ddm|=  1.5
HOMO (B2u) = -0.494059555931336  LUMO (Ag) = -0.140557688111629
cycle= 2 E= -75.3842064529923  delta_E= -0.0133  |g|= 0.0519  |ddm|= 0.217
HOMO (B2u) = -0.458318448325722  LUMO (Ag) = -0.104627267109312
cycle= 3 E= -75.3850020490567  delta_E= -0.000796  |g|= 0.00987  |ddm|= 0.0675
HOMO (B2u) = -0.460162695295052  LUMO (Ag) = -0.104859312382324
cycle= 4 E= -75.3850609582637  delta_E= -5.89e-05  |g|= 0.00188  |ddm|= 0.038
HOMO (B2u) = -0.460946264390439  LUMO (Ag) = -0.105848218108887
cycle= 5 E= -75.3850633096871  delta_E= -2.35e-06  |g|= 0.000188  |ddm|= 0.0127
HOMO (B2u) = -0.460927636332217  LUMO (Ag) = -0.105880739343782
cycle= 6 E= -75.3850633353856  delta_E= -2.57e-08  |g|= 2.43e-05  |ddm|= 0.00106
HOMO (B3u) = -0.460929625185359  LUMO (Ag) = -0.105890953720652
cycle= 7 E= -75.3850633357241  delta_E= -3.39e-10  |g|= 2.81e-06  |ddm|= 0.000195
HOMO (B2u) = -0.46093005506604  LUMO (Ag) = -0.105891268417291
cycle= 8 E= -75.3850633357272  delta_E= -3.1e-12  |g|= 1.94e-07  |ddm|= 3.21e-05
HOMO (B2u) = -0.460930071211096  LUMO (Ag) = -0.105891273497153
cycle= 9 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 1.06e-08  |ddm|= 5.6e-07
HOMO (B2u) = -0.460930068175435  LUMO (Ag) = -0.105891267991521
cycle= 10 E= -75.3850633357273  delta_E= -5.68e-14  |g|= 7.07e-09  |ddm|= 1.11e-08
HOMO (B3u) = -0.460930070693787  LUMO (Ag) = -0.105891270573655
cycle= 11 E= -75.3850633357273  delta_E= -5.68e-14  |g|= 9.73e-10  |ddm|= 1.93e-08
HOMO (B3u) = -0.460930070836387  LUMO (Ag) = -0.105891270669565
cycle= 12 E= -75.3850633357272  delta_E= 1.56e-13  |g|= 8.02e-10  |ddm|= 2.57e-09
HOMO (B3u) = -0.46093007080802  LUMO (Ag) = -0.105891270630163
cycle= 13 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 6.46e-10  |ddm|= 8.52e-10
HOMO (B3u) = -0.460930070826679  LUMO (Ag) = -0.105891270646652
cycle= 14 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 6.04e-10  |ddm|= 8.06e-10
HOMO (B3u) = -0.460930070827595  LUMO (Ag) = -0.105891270639547
cycle= 15 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 5.26e-10  |ddm|= 5.37e-10
HOMO (B3u) = -0.460930070801414  LUMO (Ag) = -0.105891270620151
cycle= 16 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 4.66e-10  |ddm|= 4.99e-10
HOMO (B3u) = -0.460930070761816  LUMO (Ag) = -0.105891270622114
cycle= 17 E= -75.3850633357272  delta_E= -4.26e-14  |g|= 5.51e-10  |ddm|= 1.22e-09
HOMO (B3u) = -0.460930070795085  LUMO (Ag) = -0.105891270601471
cycle= 18 E= -75.3850633357273  delta_E= -4.26e-14  |g|= 3.07e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.460930070749736  LUMO (Ag) = -0.105891270547194
cycle= 19 E= -75.3850633357271  delta_E= 1.28e-13  |g|= 1.29e-10  |ddm|= 7.23e-10
HOMO (B2u) = -0.460930070747801  LUMO (Ag) = -0.105891270543445
cycle= 20 E= -75.3850633357272  delta_E= -4.26e-14  |g|= 1.11e-10  |ddm|= 3.74e-11
HOMO (B2u) = -0.460930070751132  LUMO (Ag) = -0.105891270544227
cycle= 21 E= -75.3850633357272  delta_E= -4.26e-14  |g|= 9.35e-11  |ddm|= 4.17e-11
HOMO (B2u) = -0.460930070752814  LUMO (Ag) = -0.105891270544099
cycle= 22 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 7.89e-11  |ddm|= 2.78e-11
HOMO (B2u) = -0.460930070754211  LUMO (Ag) = -0.105891270543561
cycle= 23 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 6.42e-11  |ddm|= 3.78e-11
HOMO (B2u) = -0.460930070755288  LUMO (Ag) = -0.105891270542899
cycle= 24 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 5.19e-11  |ddm|= 4.69e-11
HOMO (B2u) = -0.460930070756108  LUMO (Ag) = -0.105891270541897
cycle= 25 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 4.13e-11  |ddm|= 3.25e-11
HOMO (B2u) = -0.460930070757853  LUMO (Ag) = -0.105891270540637
cycle= 26 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 2.66e-11  |ddm|= 3.19e-11
HOMO (B2u) = -0.460930070759826  LUMO (Ag) = -0.105891270541421
cycle= 27 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 2.1e-11  |ddm|= 2.24e-11
HOMO (B2u) = -0.460930070759497  LUMO (Ag) = -0.105891270540484
cycle= 28 E= -75.3850633357273  delta_E= -1.14e-13  |g|= 1.74e-11  |ddm|= 8.74e-12
HOMO (B3u) = -0.460930070759117  LUMO (Ag) = -0.105891270539565
cycle= 29 E= -75.3850633357272  delta_E= 9.95e-14  |g|= 1.42e-11  |ddm|= 7.95e-12
HOMO (B3u) = -0.460930070758837  LUMO (Ag) = -0.105891270538798
cycle= 30 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 1.15e-11  |ddm|= 7.5e-12
HOMO (B3u) = -0.460930070758628  LUMO (Ag) = -0.10589127053814
cycle= 31 E= -75.3850633357271  delta_E= 5.68e-14  |g|= 9.15e-12  |ddm|= 6.73e-12
HOMO (B3u) = -0.460930070758504  LUMO (Ag) = -0.10589127053762
cycle= 32 E= -75.3850633357272  delta_E= -4.26e-14  |g|= 7.21e-12  |ddm|= 5.14e-12
HOMO (B3u) = -0.460930070758463  LUMO (Ag) = -0.105891270537235
cycle= 33 E= -75.3850633357272  delta_E= -7.11e-14  |g|= 5.68e-12  |ddm|= 3.3e-12
HOMO (B3u) = -0.460930070758475  LUMO (Ag) = -0.105891270536966
cycle= 34 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 4.56e-12  |ddm|= 1.92e-12
HOMO (B3u) = -0.460930070758486  LUMO (Ag) = -0.10589127053679
cycle= 35 E= -75.3850633357273  delta_E= -8.53e-14  |g|= 3.81e-12  |ddm|= 1.83e-12
HOMO (B2u) = -0.46093007075853  LUMO (Ag) = -0.105891270536659
cycle= 36 E= -75.3850633357272  delta_E= 8.53e-14  |g|= 3.12e-12  |ddm|= 2.33e-12
HOMO (B2u) = -0.460930070758564  LUMO (Ag) = -0.105891270536544
cycle= 37 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 2.54e-12  |ddm|= 1.97e-12
HOMO (B3u) = -0.460930070758587  LUMO (Ag) = -0.105891270536442
cycle= 38 E= -75.3850633357272  delta_E=    0  |g|= 2.06e-12  |ddm|= 1.58e-12
HOMO (B3u) = -0.460930070758617  LUMO (Ag) = -0.105891270536115
Extra cycle  E= -75.3850633357273  delta_E= -5.68e-14  |g|= 7.82e-13  |ddm|= 4.69e-12
converged SCF energy = -75.3850633357273

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpkpwn6qdy
max_memory 4000 MB (current use 323 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5493989307673  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5700723796062  dE = -0.020673449  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5865706336683  dE = -0.016498254  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0532  |maxRot[o]|=0.0764
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5958320253998  dE = -0.0092613917  S^2 = 0.0000000
               |grad[o]|=0.0881  |ddm|=0.0308  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6025808194223  dE = -0.006748794  S^2 = 0.0000000
               |grad[o]|=0.069  |ddm|=0.0115  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6080431020609  dE = -0.0054622826  S^2 = 0.0000000
               |grad[o]|=0.0545  |ddm|=0.00631  |maxRot[o]|=0.0795
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6123312983988  dE = -0.0042881963  S^2 = 0.0000000
               |grad[o]|=0.0425  |ddm|=0.00445  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6155976523247  dE = -0.0032663539  S^2 = 0.0000000
               |grad[o]|=0.0324  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6179396613904  dE = -0.0023420091  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00362  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194238178102  dE = -0.0014841564  S^2 = 0.0000000
               |grad[o]|=0.016  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6201144309872  dE = -0.00069061318  S^2 = 0.0000000
               |grad[o]|=0.00899  |ddm|=0.0039  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.620186717582  dE = -7.2286595e-05  S^2 = 0.0000000
               |grad[o]|=0.00281  |ddm|=0.00412  |maxRot[o]|=0.0333
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201877724457  dE = -1.0548637e-06  S^2 = 0.0000000
               |grad[o]|=0.00052  |ddm|=0.00202  |maxRot[o]|=0.00369
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201877958082  dE = -2.3362475e-08  S^2 = 0.0000000
               |grad[o]|=9.05e-05  |ddm|=0.000481  |maxRot[o]|=0.00051
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6201877964403  dE = -6.3208461e-10  S^2 = 0.0000000
               |grad[o]|=1.57e-05  |ddm|=0.000108  |maxRot[o]|=8.3e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6201877964596  dE = -1.9326762e-11  S^2 = 0.0000000
               |grad[o]|=2.92e-06  |ddm|=2.26e-05  |maxRot[o]|=1.42e-05
2-step CASSCF converged in 15 macro (76 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98500898 1.58412136 1.89795623 1.89795655 0.41151926 0.10541182
 0.10541195 0.01261384]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00317   0.00262   0.00000   0.00000  -0.00145
  0 C 2s       0.59002   0.50721   0.00000  -0.00000  -0.38673
  0 C 3s      -0.05064   0.00902   0.00000  -0.00000  -0.01545
  0 C 2px      0.00000  -0.00000  -0.00000   0.70621  -0.00000
  0 C 2py      0.00000   0.00000   0.70621  -0.00000  -0.00000
  0 C 2pz      0.38111  -0.49255   0.00000  -0.00000   0.59034
  0 C 3px      0.00000  -0.00000   0.00000  -0.01351   0.00000
  0 C 3py     -0.00000   0.00000  -0.01351   0.00000  -0.00000
  0 C 3pz     -0.04932  -0.00573   0.00000  -0.00000  -0.03961
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.03283   0.00000  -0.00000
  0 C 3dz^2    0.04041   0.00253   0.00000  -0.00000   0.01144
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03283   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00317  -0.00262   0.00000   0.00000  -0.00145
  1 C 2s       0.59002  -0.50721   0.00000   0.00000  -0.38673
  1 C 3s      -0.05064  -0.00902  -0.00000   0.00000  -0.01545
  1 C 2px     -0.00000   0.00000  -0.00000   0.70621  -0.00000
  1 C 2py      0.00000  -0.00000   0.70621  -0.00000   0.00000
  1 C 2pz     -0.38111  -0.49255   0.00000  -0.00000  -0.59034
  1 C 3px     -0.00000   0.00000   0.00000  -0.01351   0.00000
  1 C 3py     -0.00000  -0.00000  -0.01351   0.00000   0.00000
  1 C 3pz      0.04932  -0.00573   0.00000  -0.00000   0.03961
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03283  -0.00000  -0.00000
  1 C 3dz^2    0.04041  -0.00253  -0.00000   0.00000   0.01144
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03283  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00075
  0 C 2s      -0.00000   0.00000   0.49173
  0 C 3s      -0.00000   0.00000  -0.04330
  0 C 2px      0.70622  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70622   0.00000
  0 C 2pz     -0.00000  -0.00000   0.50534
  0 C 3px     -0.02618  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.02618   0.00000
  0 C 3pz     -0.00000   0.00000   0.00676
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02379   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.03024
  0 C 3dxz    -0.02379  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00075
  1 C 2s       0.00000  -0.00000  -0.49173
  1 C 3s       0.00000  -0.00000   0.04330
  1 C 2px     -0.70622   0.00000   0.00000
  1 C 2py      0.00000  -0.70622   0.00000
  1 C 2pz     -0.00000   0.00000   0.50534
  1 C 3px      0.02618   0.00000   0.00000
  1 C 3py      0.00000   0.02618  -0.00000
  1 C 3pz     -0.00000   0.00000   0.00676
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02379   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03024
  1 C 3dxz    -0.02379  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99486434
<CAS-nat-orb|mo-hf>  4  4    0.99859054
<CAS-nat-orb|mo-hf>  5  5    0.99980387
<CAS-nat-orb|mo-hf>  6  6    0.99980387
<CAS-nat-orb|mo-hf>  7  7    0.97957781
<CAS-nat-orb|mo-hf>  8  8    0.92972102
<CAS-nat-orb|mo-hf>  9  9    0.92972112
<CAS-nat-orb|mo-hf>  10  10    0.45886323
<CAS-nat-orb|mo-hf>  10  17    0.62354822
<CAS-nat-orb|mo-hf>  10  20   -0.57985787
CASSCF energy = -75.6201877964596
CASCI E = -75.6201877964596  E(CI) = -17.8576549918631  S^2 = 0.0000000
Density matrix diagonal elements [1.98500912 1.58412023 1.89795611 1.89795568 0.41152086 0.10541213
 0.10541209 0.01261377]
i = 1  <i|F|i> = -11.27955932
i = 2  <i|F|i> = -11.27671236
i = 3  <i|F|i> =  -1.02194624
i = 4  <i|F|i> =  -0.41490334
i = 5  <i|F|i> =  -0.40957677
i = 6  <i|F|i> =  -0.40957669
i = 7  <i|F|i> =  -0.12400809
i = 8  <i|F|i> =   0.27645817
i = 9  <i|F|i> =   0.27645803
i = 10  <i|F|i> =   1.07702891
i = 11  <i|F|i> =   0.59175606
i = 12  <i|F|i> =   0.64447250
i = 13  <i|F|i> =   0.64447250
i = 14  <i|F|i> =   0.73557137
i = 15  <i|F|i> =   0.70323601
i = 16  <i|F|i> =   0.70323612
i = 17  <i|F|i> =   0.55421759
i = 18  <i|F|i> =   1.23682174
i = 19  <i|F|i> =   1.23682174
i = 20  <i|F|i> =   1.14663410
i = 21  <i|F|i> =   1.41126534
i = 22  <i|F|i> =   1.41126534
i = 23  <i|F|i> =   1.65850146
i = 24  <i|F|i> =   1.65850146
i = 25  <i|F|i> =   2.07189617
i = 26  <i|F|i> =   2.14063005
i = 27  <i|F|i> =   2.14063008
i = 28  <i|F|i> =   2.41218823
......production of RDMs took       2.34 sec
......reading the RDM took          0.42 sec
......production of RDMs took      25.23 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickICNEVPT2-ijrs) =    -0.00033952433187
E(WickICNEVPT2- rsi) =    -0.00105304526005
E(WickICNEVPT2- ijr) =    -0.00044741998397
E(WickICNEVPT2-  rs) =    -0.03966158061541
E(WickICNEVPT2-  ij) =    -0.00016028747253
E(WickICNEVPT2-  ir) =    -0.00134021385704
E(WickICNEVPT2-   r) =    -0.04410232867572
E(WickICNEVPT2-   i) =    -0.00030252763558
E(WickICNEVPT2) = -75.70759472429177  E_corr_pt = -0.08740692783217437
Timings = pdms =   37.72 | eris =    0.06 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.49 | ij =    0.13 | ir =    0.28 | r =    2.35 | i =    0.93 | total =   42.03
Time cost =     95.266
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:24:17 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.243566445662 AA    0.000000000000   0.000000000000   2.350000000000 Bohr   0.0

nuclear repulsion = 15.3191489361702
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.175]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1381.86


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp4jkq52s8
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.520080440469

WARN: Singularity detected in overlap matrix (condition number =  625). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.264198750943282  LUMO (Ag) = -0.186664127921807
cycle= 1 E= -75.3721584993459  delta_E= 0.148  |g|= 0.198  |ddm|= 1.49
HOMO (B2u) = -0.488497893717002  LUMO (Ag) = -0.142939777698249
cycle= 2 E= -75.3860697595071  delta_E= -0.0139  |g|= 0.052  |ddm|= 0.225
HOMO (B2u) = -0.452348284546127  LUMO (Ag) = -0.105756871897142
cycle= 3 E= -75.3868762726882  delta_E= -0.000807  |g|= 0.00951  |ddm|= 0.0641
HOMO (B2u) = -0.453936921014672  LUMO (Ag) = -0.105452022681082
cycle= 4 E= -75.3869305550891  delta_E= -5.43e-05  |g|= 0.00182  |ddm|= 0.034
HOMO (B3u) = -0.4546996704121  LUMO (Ag) = -0.106320748353532
cycle= 5 E= -75.3869327103432  delta_E= -2.16e-06  |g|= 0.00013  |ddm|= 0.0115
HOMO (B2u) = -0.454692197268592  LUMO (Ag) = -0.106342680679351
cycle= 6 E= -75.3869327222535  delta_E= -1.19e-08  |g|= 2.27e-05  |ddm|= 0.00104
HOMO (B3u) = -0.454694399587796  LUMO (Ag) = -0.10635337093974
cycle= 7 E= -75.3869327225933  delta_E= -3.4e-10  |g|= 3.04e-06  |ddm|= 8.49e-05
HOMO (B3u) = -0.454694907644862  LUMO (Ag) = -0.106353839610061
cycle= 8 E= -75.3869327225969  delta_E= -3.64e-12  |g|= 2.27e-07  |ddm|= 2.93e-05
HOMO (B3u) = -0.454694923997806  LUMO (Ag) = -0.106353843315692
cycle= 9 E= -75.3869327225969  delta_E=    0  |g|= 1.18e-08  |ddm|= 9.54e-07
HOMO (B3u) = -0.45469492125666  LUMO (Ag) = -0.106353838491747
cycle= 10 E= -75.386932722597  delta_E= -8.53e-14  |g|= 6.12e-09  |ddm|= 1.64e-08
HOMO (B3u) = -0.454694923049991  LUMO (Ag) = -0.10635384025188
cycle= 11 E= -75.3869327225971  delta_E= -8.53e-14  |g|= 1.12e-09  |ddm|= 1.31e-08
HOMO (B3u) = -0.454694923184546  LUMO (Ag) = -0.106353840337
cycle= 12 E= -75.3869327225969  delta_E= 1.71e-13  |g|= 9.27e-10  |ddm|= 1.96e-09
HOMO (B3u) = -0.454694923151232  LUMO (Ag) = -0.106353840281351
cycle= 13 E= -75.386932722597  delta_E= -8.53e-14  |g|= 7.23e-10  |ddm|= 1.05e-09
HOMO (B3u) = -0.454694923168182  LUMO (Ag) = -0.106353840291128
cycle= 14 E= -75.386932722597  delta_E= 2.84e-14  |g|= 7e-10  |ddm|= 1.3e-09
HOMO (B3u) = -0.454694923166992  LUMO (Ag) = -0.106353840308962
cycle= 15 E= -75.3869327225969  delta_E= 8.53e-14  |g|= 6.17e-10  |ddm|= 9.49e-10
HOMO (B3u) = -0.454694923138615  LUMO (Ag) = -0.106353840281366
cycle= 16 E= -75.386932722597  delta_E= -1.14e-13  |g|= 5.55e-10  |ddm|= 4.66e-10
HOMO (B3u) = -0.45469492309129  LUMO (Ag) = -0.106353840262934
cycle= 17 E= -75.386932722597  delta_E= 5.68e-14  |g|= 5.81e-10  |ddm|= 1.39e-09
HOMO (B3u) = -0.454694923115696  LUMO (Ag) = -0.106353840230339
cycle= 18 E= -75.386932722597  delta_E= -1.42e-14  |g|= 2.91e-10  |ddm|= 6.61e-10
HOMO (B3u) = -0.4546949230748  LUMO (Ag) = -0.106353840179573
cycle= 19 E= -75.3869327225969  delta_E= 5.68e-14  |g|= 1.55e-10  |ddm|= 4.73e-10
HOMO (B3u) = -0.454694923074665  LUMO (Ag) = -0.106353840176724
cycle= 20 E= -75.3869327225971  delta_E= -1.28e-13  |g|= 1.33e-10  |ddm|= 3.97e-11
HOMO (B2u) = -0.454694923079042  LUMO (Ag) = -0.106353840178129
cycle= 21 E= -75.386932722597  delta_E= 8.53e-14  |g|= 1.13e-10  |ddm|= 5.9e-11
HOMO (B2u) = -0.45469492308145  LUMO (Ag) = -0.106353840178696
cycle= 22 E= -75.3869327225971  delta_E= -8.53e-14  |g|= 9.78e-11  |ddm|= 3.67e-11
HOMO (B2u) = -0.454694923082767  LUMO (Ag) = -0.106353840178387
cycle= 23 E= -75.3869327225969  delta_E= 1.14e-13  |g|= 8.06e-11  |ddm|= 4.15e-11
HOMO (B2u) = -0.454694923084237  LUMO (Ag) = -0.106353840177037
cycle= 24 E= -75.386932722597  delta_E= -7.11e-14  |g|= 6.38e-11  |ddm|= 5.81e-11
HOMO (B2u) = -0.45469492308519  LUMO (Ag) = -0.106353840175246
cycle= 25 E= -75.386932722597  delta_E= -1.42e-14  |g|= 4.87e-11  |ddm|= 4.69e-11
HOMO (B2u) = -0.454694923086572  LUMO (Ag) = -0.106353840173312
cycle= 26 E= -75.386932722597  delta_E=    0  |g|= 3.33e-11  |ddm|= 2.74e-11
HOMO (B2u) = -0.454694923086405  LUMO (Ag) = -0.106353840168783
Extra cycle  E= -75.386932722597  delta_E= 1.42e-14  |g|= 1.08e-11  |ddm|= 4.62e-11
converged SCF energy = -75.386932722597

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp4jkq52s8
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5529956225489  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5742379004914  dE = -0.021242278  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5907013338561  dE = -0.016463433  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0556  |maxRot[o]|=0.078
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5999891087199  dE = -0.0092877749  S^2 = 0.0000000
               |grad[o]|=0.0873  |ddm|=0.0313  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066426342123  dE = -0.0066535255  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.012  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6117776285529  dE = -0.0051349943  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.00672  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6158213926942  dE = -0.0040437641  S^2 = 0.0000000
               |grad[o]|=0.042  |ddm|=0.00468  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6189156562435  dE = -0.0030942635  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00394  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6211353675481  dE = -0.0022197113  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00375  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6225338703795  dE = -0.0013985028  S^2 = 0.0000000
               |grad[o]|=0.0158  |ddm|=0.0038  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6231660457142  dE = -0.00063217533  S^2 = 0.0000000
               |grad[o]|=0.00875  |ddm|=0.00396  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6232125140774  dE = -4.6468363e-05  S^2 = 0.0000000
               |grad[o]|=0.00249  |ddm|=0.00421  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6232205425115  dE = -8.0284341e-06  S^2 = 0.0000000
               |grad[o]|=0.00104  |ddm|=0.00126  |maxRot[o]|=0.0112
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6232206703334  dE = -1.2782191e-07  S^2 = 0.0000000
               |grad[o]|=0.000189  |ddm|=0.000799  |maxRot[o]|=0.00125
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6232206732061  dE = -2.8726959e-09  S^2 = 0.0000000
               |grad[o]|=3.19e-05  |ddm|=0.00018  |maxRot[o]|=0.000176
macro iter 15 (3 JK  0 micro), CASSCF E = -75.623220673284  dE = -7.7889695e-11  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=3.89e-05  |maxRot[o]|=2.9e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6232206732861  dE = -2.1032065e-12  S^2 = 0.0000000
               |grad[o]|=9.71e-07  |ddm|=7.82e-06  |maxRot[o]|=5.02e-06
2-step CASSCF converged in 16 macro (77 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98422464 1.59821723 1.89166097 1.89166128 0.39749232 0.11168503
 0.1116852  0.01337334]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00356   0.00273   0.00000   0.00000  -0.00136
  0 C 2s       0.59304   0.51564   0.00000   0.00000  -0.38216
  0 C 3s      -0.04903   0.00893   0.00000   0.00000  -0.01244
  0 C 2px      0.00000   0.00000  -0.00000   0.70632  -0.00000
  0 C 2py      0.00000  -0.00000   0.70632   0.00000  -0.00000
  0 C 2pz      0.37694  -0.48373   0.00000   0.00000   0.59331
  0 C 3px      0.00000   0.00000  -0.00000  -0.00987  -0.00000
  0 C 3py      0.00000  -0.00000  -0.00987  -0.00000   0.00000
  0 C 3pz     -0.04768  -0.00519   0.00000   0.00000  -0.04045
  0 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03194  -0.00000   0.00000
  0 C 3dz^2    0.03910   0.00193   0.00000   0.00000   0.01197
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03194  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00356  -0.00273   0.00000   0.00000  -0.00136
  1 C 2s       0.59304  -0.51564   0.00000   0.00000  -0.38216
  1 C 3s      -0.04903  -0.00893  -0.00000  -0.00000  -0.01244
  1 C 2px     -0.00000  -0.00000   0.00000   0.70632   0.00000
  1 C 2py     -0.00000   0.00000   0.70632   0.00000  -0.00000
  1 C 2pz     -0.37694  -0.48373   0.00000  -0.00000  -0.59331
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00987   0.00000
  1 C 3py     -0.00000   0.00000  -0.00987   0.00000  -0.00000
  1 C 3pz      0.04768  -0.00519   0.00000   0.00000   0.04045
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03194  -0.00000   0.00000
  1 C 3dz^2    0.03910  -0.00193  -0.00000  -0.00000   0.01197
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03194  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00071
  0 C 2s       0.00000   0.00000   0.48298
  0 C 3s       0.00000   0.00000  -0.04305
  0 C 2px      0.70627   0.00000  -0.00000
  0 C 2py     -0.00000   0.70627   0.00000
  0 C 2pz      0.00000   0.00000   0.51383
  0 C 3px     -0.02494   0.00000  -0.00000
  0 C 3py      0.00000  -0.02494   0.00000
  0 C 3pz     -0.00000   0.00000   0.00873
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02373   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02798
  0 C 3dxz    -0.02373   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00071
  1 C 2s       0.00000  -0.00000  -0.48298
  1 C 3s      -0.00000  -0.00000   0.04305
  1 C 2px     -0.70627  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70627  -0.00000
  1 C 2pz     -0.00000   0.00000   0.51383
  1 C 3px      0.02494  -0.00000   0.00000
  1 C 3py     -0.00000   0.02494  -0.00000
  1 C 3pz      0.00000   0.00000   0.00873
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02373   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02798
  1 C 3dxz    -0.02373   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99460039
<CAS-nat-orb|mo-hf>  4  4    0.99853697
<CAS-nat-orb|mo-hf>  5  5    0.99978677
<CAS-nat-orb|mo-hf>  6  6    0.99978677
<CAS-nat-orb|mo-hf>  7  7    0.97901221
<CAS-nat-orb|mo-hf>  8  8    0.93514178
<CAS-nat-orb|mo-hf>  9  9    0.93514186
<CAS-nat-orb|mo-hf>  10  10    0.47490967
<CAS-nat-orb|mo-hf>  10  17    0.64513932
<CAS-nat-orb|mo-hf>  10  20   -0.55018486
CASSCF energy = -75.6232206732861
CASCI E = -75.6232206732861  E(CI) = -17.7126744337435  S^2 = 0.0000000
Density matrix diagonal elements [1.98422465 1.59821655 1.89166107 1.89166133 0.39749311 0.11168491
 0.11168507 0.01337332]
i = 1  <i|F|i> = -11.28516790
i = 2  <i|F|i> = -11.28281589
i = 3  <i|F|i> =  -1.01201827
i = 4  <i|F|i> =  -0.42258436
i = 5  <i|F|i> =  -0.40255929
i = 6  <i|F|i> =  -0.40255934
i = 7  <i|F|i> =  -0.12192532
i = 8  <i|F|i> =   0.26075314
i = 9  <i|F|i> =   0.26075300
i = 10  <i|F|i> =   1.02462410
i = 11  <i|F|i> =   0.59710973
i = 12  <i|F|i> =   0.64926504
i = 13  <i|F|i> =   0.64926505
i = 14  <i|F|i> =   0.73297099
i = 15  <i|F|i> =   0.70410753
i = 16  <i|F|i> =   0.70410762
i = 17  <i|F|i> =   0.55392095
i = 18  <i|F|i> =   1.23978823
i = 19  <i|F|i> =   1.23978823
i = 20  <i|F|i> =   1.13975723
i = 21  <i|F|i> =   1.39282135
i = 22  <i|F|i> =   1.39282136
i = 23  <i|F|i> =   1.64699224
i = 24  <i|F|i> =   1.64699224
i = 25  <i|F|i> =   2.06263426
i = 26  <i|F|i> =   2.12361936
i = 27  <i|F|i> =   2.12361937
i = 28  <i|F|i> =   2.36380663
......production of RDMs took       1.85 sec
......reading the RDM took          0.42 sec
......production of RDMs took      24.55 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICNEVPT2-ijrs) =    -0.00032744852270
E(WickICNEVPT2- rsi) =    -0.00102684594287
E(WickICNEVPT2- ijr) =    -0.00043909775591
E(WickICNEVPT2-  rs) =    -0.03926098479619
E(WickICNEVPT2-  ij) =    -0.00015579820610
E(WickICNEVPT2-  ir) =    -0.00132004117038
E(WickICNEVPT2-   r) =    -0.04481822384399
E(WickICNEVPT2-   i) =    -0.00029637182721
E(WickICNEVPT2) = -75.71086548535145  E_corr_pt = -0.08764481206534726
Timings = pdms =   36.56 | eris =    0.26 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.73 | i =    0.69 | total =   39.76
Time cost =     89.457
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:25:46 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.270025306208 AA    0.000000000000   0.000000000000   2.400000000000 Bohr   0.0

nuclear repulsion = 15
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.2]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1490.18


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpv48alea8
max_memory 4000 MB (current use 322 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4681036266052

WARN: Singularity detected in overlap matrix (condition number =  573). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.253350702957072  LUMO (Ag) = -0.183612207324934
cycle= 1 E= -75.3711621684052  delta_E= 0.0969  |g|= 0.203  |ddm|= 1.48
HOMO (B2u) = -0.483102395155576  LUMO (Ag) = -0.145014054403869
cycle= 2 E= -75.3857253013104  delta_E= -0.0146  |g|= 0.052  |ddm|= 0.234
HOMO (B3u) = -0.446604227160942  LUMO (Ag) = -0.10662994003031
cycle= 3 E= -75.3865468682808  delta_E= -0.000822  |g|= 0.00932  |ddm|= 0.0615
HOMO (B3u) = -0.447990769174571  LUMO (Ag) = -0.105837943292174
cycle= 4 E= -75.3865987559146  delta_E= -5.19e-05  |g|= 0.00179  |ddm|= 0.0304
HOMO (B2u) = -0.448742110750611  LUMO (Ag) = -0.106605000995195
cycle= 5 E= -75.386600812118  delta_E= -2.06e-06  |g|= 7.74e-05  |ddm|= 0.0104
HOMO (B2u) = -0.448735377102867  LUMO (Ag) = -0.106607023368658
cycle= 6 E= -75.3866008154599  delta_E= -3.34e-09  |g|= 1.47e-05  |ddm|= 0.000795
HOMO (B3u) = -0.44873616172034  LUMO (Ag) = -0.10661340360784
cycle= 7 E= -75.3866008156198  delta_E= -1.6e-10  |g|= 2.92e-06  |ddm|= 4.96e-05
HOMO (B2u) = -0.448736721595753  LUMO (Ag) = -0.106614233434895
cycle= 8 E= -75.3866008156237  delta_E= -3.87e-12  |g|= 2.59e-07  |ddm|= 1.95e-05
HOMO (B3u) = -0.448736741738072  LUMO (Ag) = -0.106614252119196
cycle= 9 E= -75.3866008156237  delta_E= -7.11e-14  |g|= 1.3e-08  |ddm|= 1.45e-06
HOMO (B3u) = -0.448736740751493  LUMO (Ag) = -0.106614250130959
cycle= 10 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 5.78e-09  |ddm|= 2.13e-08
HOMO (B3u) = -0.448736740303174  LUMO (Ag) = -0.106614249133944
cycle= 11 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 1.21e-09  |ddm|= 1.28e-08
HOMO (B3u) = -0.448736740436763  LUMO (Ag) = -0.10661424921878
cycle= 12 E= -75.3866008156238  delta_E=    0  |g|= 9.78e-10  |ddm|= 1.58e-09
HOMO (B3u) = -0.448736740404975  LUMO (Ag) = -0.106614249163423
cycle= 13 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 7.75e-10  |ddm|= 7.94e-10
HOMO (B3u) = -0.448736740434426  LUMO (Ag) = -0.106614249171402
cycle= 14 E= -75.3866008156238  delta_E= 8.53e-14  |g|= 7.65e-10  |ddm|= 1.78e-09
HOMO (B3u) = -0.448736740438966  LUMO (Ag) = -0.106614249220731
cycle= 15 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 6.89e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.448736740358875  LUMO (Ag) = -0.10661424917034
cycle= 16 E= -75.3866008156238  delta_E= 2.84e-14  |g|= 6.72e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.448736740338096  LUMO (Ag) = -0.106614249143004
cycle= 17 E= -75.3866008156238  delta_E=    0  |g|= 6.32e-10  |ddm|= 9.28e-10
HOMO (B3u) = -0.44873674034942  LUMO (Ag) = -0.106614249099832
cycle= 18 E= -75.3866008156238  delta_E=    0  |g|= 3.11e-10  |ddm|= 8.01e-10
HOMO (B3u) = -0.448736740351081  LUMO (Ag) = -0.106614249079157
cycle= 19 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 1.75e-10  |ddm|= 3.28e-10
HOMO (B2u) = -0.448736740350494  LUMO (Ag) = -0.106614249075802
cycle= 20 E= -75.3866008156239  delta_E= -5.68e-14  |g|= 1.52e-10  |ddm|= 4.61e-11
HOMO (B3u) = -0.448736740354093  LUMO (Ag) = -0.106614249076672
cycle= 21 E= -75.3866008156238  delta_E= 8.53e-14  |g|= 1.32e-10  |ddm|= 6.07e-11
HOMO (B2u) = -0.448736740355964  LUMO (Ag) = -0.106614249076958
cycle= 22 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 1.16e-10  |ddm|= 4.3e-11
HOMO (B2u) = -0.448736740356256  LUMO (Ag) = -0.106614249076485
cycle= 23 E= -75.3866008156237  delta_E= 1.42e-13  |g|= 9.8e-11  |ddm|= 4.73e-11
HOMO (B2u) = -0.448736740357445  LUMO (Ag) = -0.106614249074567
cycle= 24 E= -75.3866008156238  delta_E= -1.14e-13  |g|= 7.9e-11  |ddm|= 6.74e-11
HOMO (B2u) = -0.44873674035752  LUMO (Ag) = -0.10661424907051
cycle= 25 E= -75.3866008156238  delta_E= 4.26e-14  |g|= 5.88e-11  |ddm|= 4.54e-11
HOMO (B3u) = -0.448736740357769  LUMO (Ag) = -0.106614249067211
cycle= 26 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 4.14e-11  |ddm|= 2.91e-11
HOMO (B2u) = -0.448736740357723  LUMO (Ag) = -0.106614249065492
cycle= 27 E= -75.3866008156238  delta_E= 4.26e-14  |g|= 3.28e-11  |ddm|= 1.54e-11
HOMO (B2u) = -0.448736740357482  LUMO (Ag) = -0.106614249064372
cycle= 28 E= -75.3866008156238  delta_E=    0  |g|= 2.79e-11  |ddm|= 1.16e-11
HOMO (B2u) = -0.448736740356885  LUMO (Ag) = -0.106614249060075
Extra cycle  E= -75.3866008156238  delta_E= -2.84e-14  |g|= 9.88e-12  |ddm|= 5.17e-11
converged SCF energy = -75.3866008156238

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpv48alea8
max_memory 4000 MB (current use 322 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5544099472178  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5762198089567  dE = -0.021809862  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5926046135303  dE = -0.016384805  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0582  |maxRot[o]|=0.0788
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6014950261381  dE = -0.0088904126  S^2 = 0.0000000
               |grad[o]|=0.0866  |ddm|=0.0318  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.607832830462  dE = -0.0063378043  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.0122  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.612799676395  dE = -0.0049668459  S^2 = 0.0000000
               |grad[o]|=0.054  |ddm|=0.00702  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6167369243494  dE = -0.003937248  S^2 = 0.0000000
               |grad[o]|=0.0426  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6197643644063  dE = -0.0030274401  S^2 = 0.0000000
               |grad[o]|=0.0328  |ddm|=0.00419  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.621945338649  dE = -0.0021809742  S^2 = 0.0000000
               |grad[o]|=0.0241  |ddm|=0.0039  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6233253048386  dE = -0.0013799662  S^2 = 0.0000000
               |grad[o]|=0.0162  |ddm|=0.00389  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6239527364934  dE = -0.00062743165  S^2 = 0.0000000
               |grad[o]|=0.00898  |ddm|=0.00404  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6239994402993  dE = -4.6703806e-05  S^2 = 0.0000000
               |grad[o]|=0.00254  |ddm|=0.00433  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6240076588572  dE = -8.2185579e-06  S^2 = 0.0000000
               |grad[o]|=0.00105  |ddm|=0.00126  |maxRot[o]|=0.0113
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6240077853573  dE = -1.2650008e-07  S^2 = 0.0000000
               |grad[o]|=0.000189  |ddm|=0.000798  |maxRot[o]|=0.00123
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6240077881096  dE = -2.7523015e-09  S^2 = 0.0000000
               |grad[o]|=3.14e-05  |ddm|=0.000172  |maxRot[o]|=0.00017
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6240077881801  dE = -7.0457418e-11  S^2 = 0.0000000
               |grad[o]|=5.07e-06  |ddm|=3.62e-05  |maxRot[o]|=2.77e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6240077881818  dE = -1.6768809e-12  S^2 = 0.0000000
               |grad[o]|=9.39e-07  |ddm|=7.18e-06  |maxRot[o]|=4.69e-06
2-step CASSCF converged in 16 macro (77 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98341796 1.61142014 1.88510467 1.88510523 0.38447467 0.11816044
 0.11816041 0.01415649]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00394   0.00282   0.00000   0.00000  -0.00128
  0 C 2s       0.59610   0.52384   0.00000  -0.00000  -0.37748
  0 C 3s      -0.04733   0.00887   0.00000  -0.00000  -0.00946
  0 C 2px      0.00000  -0.00000  -0.00000   0.70639  -0.00000
  0 C 2py     -0.00000   0.00000   0.70639  -0.00000  -0.00000
  0 C 2pz      0.37264  -0.47485  -0.00000  -0.00000   0.59629
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00643  -0.00000
  0 C 3py     -0.00000   0.00000  -0.00643  -0.00000  -0.00000
  0 C 3pz     -0.04603  -0.00469   0.00000  -0.00000  -0.04119
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.03106  -0.00000  -0.00000
  0 C 3dz^2    0.03783   0.00135   0.00000  -0.00000   0.01265
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03106  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00394  -0.00282   0.00000   0.00000  -0.00128
  1 C 2s       0.59610  -0.52384  -0.00000   0.00000  -0.37748
  1 C 3s      -0.04733  -0.00887  -0.00000   0.00000  -0.00946
  1 C 2px      0.00000   0.00000   0.00000   0.70639   0.00000
  1 C 2py      0.00000  -0.00000   0.70639   0.00000   0.00000
  1 C 2pz     -0.37264  -0.47485  -0.00000  -0.00000  -0.59629
  1 C 3px     -0.00000   0.00000   0.00000  -0.00643   0.00000
  1 C 3py      0.00000  -0.00000  -0.00643   0.00000   0.00000
  1 C 3pz      0.04603  -0.00469   0.00000  -0.00000   0.04119
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.03106  -0.00000  -0.00000
  1 C 3dz^2    0.03783  -0.00135  -0.00000   0.00000   0.01265
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03106  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00067
  0 C 2s       0.00000   0.00000   0.47414
  0 C 3s      -0.00000   0.00000  -0.04292
  0 C 2px      0.70631  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70631  -0.00000
  0 C 2pz      0.00000  -0.00000   0.52207
  0 C 3px     -0.02380   0.00000   0.00000
  0 C 3py      0.00000  -0.02380  -0.00000
  0 C 3pz     -0.00000   0.00000   0.01059
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02366   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02618
  0 C 3dxz    -0.02366   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00067
  1 C 2s       0.00000  -0.00000  -0.47414
  1 C 3s       0.00000  -0.00000   0.04292
  1 C 2px     -0.70631  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70631   0.00000
  1 C 2pz     -0.00000  -0.00000   0.52207
  1 C 3px      0.02380   0.00000   0.00000
  1 C 3py      0.00000   0.02380   0.00000
  1 C 3pz     -0.00000   0.00000   0.01059
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02366  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02618
  1 C 3dxz    -0.02366  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99432403
<CAS-nat-orb|mo-hf>  4  4    0.99847304
<CAS-nat-orb|mo-hf>  5  5    0.99976738
<CAS-nat-orb|mo-hf>  6  6    0.99976738
<CAS-nat-orb|mo-hf>  7  7    0.97845223
<CAS-nat-orb|mo-hf>  8  8    0.94007723
<CAS-nat-orb|mo-hf>  9  9    0.94007729
<CAS-nat-orb|mo-hf>  10  10    0.49233326
<CAS-nat-orb|mo-hf>  10  17    0.66275081
<CAS-nat-orb|mo-hf>  10  20   -0.52046340
CASSCF energy = -75.6240077881818
CASCI E = -75.6240077881818  E(CI) = -17.5716139906849  S^2 = 0.0000000
Density matrix diagonal elements [1.98341798 1.61141905 1.88510464 1.88510527 0.38447581 0.11816022
 0.11816055 0.01415649]
i = 1  <i|F|i> = -11.29068477
i = 2  <i|F|i> = -11.28874160
i = 3  <i|F|i> =  -1.00204732
i = 4  <i|F|i> =  -0.43006888
i = 5  <i|F|i> =  -0.39576347
i = 6  <i|F|i> =  -0.39576359
i = 7  <i|F|i> =  -0.11985929
i = 8  <i|F|i> =   0.24572244
i = 9  <i|F|i> =   0.24572230
i = 10  <i|F|i> =   0.97455873
i = 11  <i|F|i> =   0.60242248
i = 12  <i|F|i> =   0.65380122
i = 13  <i|F|i> =   0.65380121
i = 14  <i|F|i> =   0.73073416
i = 15  <i|F|i> =   0.70485720
i = 16  <i|F|i> =   0.70485726
i = 17  <i|F|i> =   0.55387784
i = 18  <i|F|i> =   1.24298621
i = 19  <i|F|i> =   1.24298621
i = 20  <i|F|i> =   1.13306720
i = 21  <i|F|i> =   1.37508141
i = 22  <i|F|i> =   1.37508143
i = 23  <i|F|i> =   1.63578169
i = 24  <i|F|i> =   1.63578169
i = 25  <i|F|i> =   2.05136970
i = 26  <i|F|i> =   2.10699458
i = 27  <i|F|i> =   2.10699459
i = 28  <i|F|i> =   2.32191414
......production of RDMs took       1.86 sec
......reading the RDM took          0.45 sec
......production of RDMs took      25.78 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00031742030569
E(WickICNEVPT2- rsi) =    -0.00100339679879
E(WickICNEVPT2- ijr) =    -0.00043134647247
E(WickICNEVPT2-  rs) =    -0.03884670881027
E(WickICNEVPT2-  ij) =    -0.00015097136512
E(WickICNEVPT2-  ir) =    -0.00130056834575
E(WickICNEVPT2-   r) =    -0.04554421618619
E(WickICNEVPT2-   i) =    -0.00029028118258
E(WickICNEVPT2) = -75.71189269764862  E_corr_pt = -0.08788490946687097
Timings = pdms =   37.80 | eris =    0.05 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.75 | i =    0.71 | total =   40.82
Time cost =    156.718
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:28:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.296484166754 AA    0.000000000000   0.000000000000   2.450000000000 Bohr   0.0

nuclear repulsion = 14.6938775510204
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.225]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1566.88


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpu_pbi__u
max_memory 4000 MB (current use 321 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4178541557328

WARN: Singularity detected in overlap matrix (condition number =  525). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.243088233296001  LUMO (Ag) = -0.180721513540293
cycle= 1 E= -75.3682765376263  delta_E= 0.0496  |g|= 0.207  |ddm|= 1.47
HOMO (B3u) = -0.477856195390324  LUMO (Ag) = -0.146786594446603
cycle= 2 E= -75.3835137621145  delta_E= -0.0152  |g|= 0.0521  |ddm|= 0.243
HOMO (B2u) = -0.441063789154571  LUMO (Ag) = -0.107250630527325
cycle= 3 E= -75.3843533836984  delta_E= -0.00084  |g|= 0.00929  |ddm|= 0.0595
HOMO (B2u) = -0.442295646912941  LUMO (Ag) = -0.10601524512884
cycle= 4 E= -75.3844049545557  delta_E= -5.16e-05  |g|= 0.0018  |ddm|= 0.0274
HOMO (B3u) = -0.443045442143856  LUMO (Ag) = -0.106700546721385
cycle= 5 E= -75.3844070231975  delta_E= -2.07e-06  |g|= 7.54e-05  |ddm|= 0.0094
HOMO (B3u) = -0.443032060379307  LUMO (Ag) = -0.106682393250685
cycle= 6 E= -75.3844070255161  delta_E= -2.32e-09  |g|= 1.3e-05  |ddm|= 0.00058
HOMO (B2u) = -0.443029779172086  LUMO (Ag) = -0.106680098001441
cycle= 7 E= -75.3844070256074  delta_E= -9.13e-11  |g|= 1.64e-06  |ddm|= 2.88e-05
HOMO (B3u) = -0.443029714305106  LUMO (Ag) = -0.10667967191231
cycle= 8 E= -75.3844070256094  delta_E= -2e-12  |g|= 2.42e-07  |ddm|= 1.68e-05
HOMO (B2u) = -0.443029690447587  LUMO (Ag) = -0.106679577821938
cycle= 9 E= -75.3844070256094  delta_E= 1.42e-14  |g|= 1.45e-08  |ddm|= 6.37e-07
HOMO (B2u) = -0.443029691480304  LUMO (Ag) = -0.106679578765668
cycle= 10 E= -75.3844070256093  delta_E= 7.11e-14  |g|= 7.83e-09  |ddm|= 1.24e-08
HOMO (B3u) = -0.443029688105543  LUMO (Ag) = -0.10667957397932
cycle= 11 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 1.36e-09  |ddm|= 2.37e-08
HOMO (B3u) = -0.44302968817873  LUMO (Ag) = -0.106679573993233
cycle= 12 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 1.01e-09  |ddm|= 5.8e-10
HOMO (B2u) = -0.443029688159187  LUMO (Ag) = -0.106679573949203
cycle= 13 E= -75.3844070256094  delta_E= 2.84e-14  |g|= 8.03e-10  |ddm|= 5.37e-10
HOMO (B2u) = -0.443029688192468  LUMO (Ag) = -0.106679573942831
cycle= 14 E= -75.3844070256093  delta_E= 2.84e-14  |g|= 7.71e-10  |ddm|= 1.61e-09
HOMO (B2u) = -0.443029688177654  LUMO (Ag) = -0.106679573918327
cycle= 15 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 6.86e-10  |ddm|= 1.8e-10
HOMO (B2u) = -0.443029688159828  LUMO (Ag) = -0.106679573896741
cycle= 16 E= -75.3844070256093  delta_E= 1.42e-14  |g|= 6.11e-10  |ddm|= 4.18e-10
HOMO (B2u) = -0.443029688049451  LUMO (Ag) = -0.106679573933447
cycle= 17 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 7.87e-10  |ddm|= 5.88e-10
HOMO (B3u) = -0.443029688061723  LUMO (Ag) = -0.106679573857398
cycle= 18 E= -75.3844070256094  delta_E= -7.11e-14  |g|= 4.1e-10  |ddm|= 7.24e-10
HOMO (B2u) = -0.443029688139151  LUMO (Ag) = -0.106679573881794
cycle= 19 E= -75.3844070256094  delta_E= 2.84e-14  |g|= 1.86e-10  |ddm|= 5.25e-10
HOMO (B2u) = -0.443029688139978  LUMO (Ag) = -0.106679573878328
cycle= 20 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 1.57e-10  |ddm|= 6.91e-11
HOMO (B2u) = -0.443029688142387  LUMO (Ag) = -0.106679573877721
cycle= 21 E= -75.3844070256094  delta_E= 4.26e-14  |g|= 1.36e-10  |ddm|= 5.85e-11
HOMO (B3u) = -0.443029688143714  LUMO (Ag) = -0.106679573877023
cycle= 22 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 1.2e-10  |ddm|= 4.65e-11
HOMO (B2u) = -0.443029688143314  LUMO (Ag) = -0.106679573876273
cycle= 23 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 1.02e-10  |ddm|= 3.89e-11
HOMO (B3u) = -0.443029688142384  LUMO (Ag) = -0.106679573875309
cycle= 24 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 8.63e-11  |ddm|= 3.84e-11
HOMO (B3u) = -0.443029688141305  LUMO (Ag) = -0.106679573874497
cycle= 25 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 7.36e-11  |ddm|= 3e-11
HOMO (B3u) = -0.443029688139654  LUMO (Ag) = -0.106679573866772
cycle= 26 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 4.8e-11  |ddm|= 4.73e-11
HOMO (B3u) = -0.443029688137625  LUMO (Ag) = -0.106679573862155
cycle= 27 E= -75.3844070256093  delta_E= 2.84e-14  |g|= 3.53e-11  |ddm|= 2.5e-11
HOMO (B3u) = -0.443029688137604  LUMO (Ag) = -0.106679573861258
cycle= 28 E= -75.3844070256094  delta_E= -8.53e-14  |g|= 3.02e-11  |ddm|= 1.14e-11
HOMO (B3u) = -0.443029688137541  LUMO (Ag) = -0.106679573860466
cycle= 29 E= -75.3844070256093  delta_E= 9.95e-14  |g|= 2.57e-11  |ddm|= 1.11e-11
HOMO (B2u) = -0.443029688137507  LUMO (Ag) = -0.106679573859791
cycle= 30 E= -75.3844070256093  delta_E= -4.26e-14  |g|= 2.17e-11  |ddm|= 1.11e-11
HOMO (B3u) = -0.443029688137486  LUMO (Ag) = -0.106679573859177
cycle= 31 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 1.8e-11  |ddm|= 1.13e-11
HOMO (B3u) = -0.443029688137527  LUMO (Ag) = -0.106679573858606
cycle= 32 E= -75.3844070256094  delta_E= 2.84e-14  |g|= 1.48e-11  |ddm|= 1.01e-11
HOMO (B3u) = -0.443029688137618  LUMO (Ag) = -0.106679573858063
cycle= 33 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 1.19e-11  |ddm|= 8.71e-12
HOMO (B3u) = -0.443029688137748  LUMO (Ag) = -0.106679573857517
cycle= 34 E= -75.3844070256094  delta_E= 5.68e-14  |g|= 9.19e-12  |ddm|= 7.88e-12
HOMO (B3u) = -0.44302968813778  LUMO (Ag) = -0.106679573857159
cycle= 35 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 7.51e-12  |ddm|= 5.42e-12
HOMO (B3u) = -0.443029688137739  LUMO (Ag) = -0.106679573856861
cycle= 36 E= -75.3844070256094  delta_E=    0  |g|= 6.34e-12  |ddm|= 4.15e-12
HOMO (B2u) = -0.443029688137613  LUMO (Ag) = -0.106679573855821
Extra cycle  E= -75.3844070256093  delta_E= 1.28e-13  |g|= 2.45e-12  |ddm|= 1.46e-11
converged SCF energy = -75.3844070256093

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpu_pbi__u
max_memory 4000 MB (current use 321 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5539827086611  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5763588373789  dE = -0.022376129  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.591760411978  dE = -0.015401575  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0607  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6003940119296  dE = -0.0086336  S^2 = 0.0000000
               |grad[o]|=0.0877  |ddm|=0.031  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066572787238  dE = -0.0062632668  S^2 = 0.0000000
               |grad[o]|=0.0695  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6115944226797  dE = -0.004937144  S^2 = 0.0000000
               |grad[o]|=0.0556  |ddm|=0.00767  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.615523357595  dE = -0.0039289349  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00552  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6185579794736  dE = -0.0030346219  S^2 = 0.0000000
               |grad[o]|=0.0341  |ddm|=0.00451  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6207573749602  dE = -0.0021993955  S^2 = 0.0000000
               |grad[o]|=0.0252  |ddm|=0.00408  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6221629715033  dE = -0.0014055965  S^2 = 0.0000000
               |grad[o]|=0.017  |ddm|=0.00399  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6228190649018  dE = -0.0006560934  S^2 = 0.0000000
               |grad[o]|=0.00956  |ddm|=0.00414  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6228849775873  dE = -6.5912685e-05  S^2 = 0.0000000
               |grad[o]|=0.00284  |ddm|=0.00447  |maxRot[o]|=0.0322
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6228858553639  dE = -8.7777659e-07  S^2 = 0.0000000
               |grad[o]|=0.000486  |ddm|=0.00205  |maxRot[o]|=0.00324
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6228858734363  dE = -1.8072399e-08  S^2 = 0.0000000
               |grad[o]|=7.86e-05  |ddm|=0.000399  |maxRot[o]|=0.000423
macro iter 14 (3 JK  0 micro), CASSCF E = -75.622885873879  dE = -4.4269655e-10  S^2 = 0.0000000
               |grad[o]|=1.27e-05  |ddm|=8.07e-05  |maxRot[o]|=6.85e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6228858738904  dE = -1.1425527e-11  S^2 = 0.0000000
               |grad[o]|=2.51e-06  |ddm|=1.82e-05  |maxRot[o]|=1.16e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98259212 1.6238229  1.87827435 1.87827428 0.37239279 0.12484106
 0.12484127 0.01496124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00430   0.00292   0.00000   0.00000  -0.00121
  0 C 2s       0.59918   0.53182   0.00000  -0.00000  -0.37268
  0 C 3s      -0.04557   0.00882   0.00000  -0.00000  -0.00652
  0 C 2px      0.00000  -0.00000  -0.00000   0.70645   0.00000
  0 C 2py      0.00000   0.00000   0.70645  -0.00000  -0.00000
  0 C 2pz      0.36821  -0.46590  -0.00000   0.00000   0.59928
  0 C 3px      0.00000  -0.00000   0.00000  -0.00317  -0.00000
  0 C 3py      0.00000   0.00000  -0.00317  -0.00000  -0.00000
  0 C 3pz     -0.04436  -0.00424   0.00000  -0.00000  -0.04182
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.03019  -0.00000  -0.00000
  0 C 3dz^2    0.03661   0.00082   0.00000  -0.00000   0.01349
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03019  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00430  -0.00292   0.00000   0.00000  -0.00121
  1 C 2s       0.59918  -0.53182   0.00000   0.00000  -0.37268
  1 C 3s      -0.04557  -0.00882  -0.00000   0.00000  -0.00652
  1 C 2px     -0.00000   0.00000  -0.00000   0.70645   0.00000
  1 C 2py     -0.00000  -0.00000   0.70645  -0.00000  -0.00000
  1 C 2pz     -0.36821  -0.46590   0.00000  -0.00000  -0.59928
  1 C 3px     -0.00000   0.00000   0.00000  -0.00317  -0.00000
  1 C 3py     -0.00000  -0.00000  -0.00317   0.00000   0.00000
  1 C 3pz      0.04436  -0.00424   0.00000  -0.00000   0.04182
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03019  -0.00000  -0.00000
  1 C 3dz^2    0.03661  -0.00082  -0.00000   0.00000   0.01349
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.03019   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00063
  0 C 2s      -0.00000   0.00000   0.46522
  0 C 3s      -0.00000   0.00000  -0.04289
  0 C 2px      0.70635  -0.00000  -0.00000
  0 C 2py      0.00000   0.70635   0.00000
  0 C 2pz     -0.00000  -0.00000   0.53006
  0 C 3px     -0.02272   0.00000  -0.00000
  0 C 3py      0.00000  -0.02272   0.00000
  0 C 3pz     -0.00000   0.00000   0.01231
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02357   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02477
  0 C 3dxz    -0.02357   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00063
  1 C 2s       0.00000  -0.00000  -0.46522
  1 C 3s       0.00000  -0.00000   0.04289
  1 C 2px     -0.70635  -0.00000   0.00000
  1 C 2py      0.00000  -0.70635  -0.00000
  1 C 2pz     -0.00000   0.00000   0.53006
  1 C 3px      0.02272  -0.00000   0.00000
  1 C 3py     -0.00000   0.02272  -0.00000
  1 C 3pz     -0.00000   0.00000   0.01231
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02357   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02477
  1 C 3dxz    -0.02357   0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99403735
<CAS-nat-orb|mo-hf>  4  4    0.99839928
<CAS-nat-orb|mo-hf>  5  5    0.99974564
<CAS-nat-orb|mo-hf>  6  6    0.99974564
<CAS-nat-orb|mo-hf>  7  7    0.97790009
<CAS-nat-orb|mo-hf>  8  8    0.94457115
<CAS-nat-orb|mo-hf>  9  9    0.94457117
<CAS-nat-orb|mo-hf>  10  10    0.51114031
<CAS-nat-orb|mo-hf>  10  17    0.67613315
<CAS-nat-orb|mo-hf>  10  18   -0.49120162
CASSCF energy = -75.6228858738904
CASCI E = -75.6228858738904  E(CI) = -17.4344345074032  S^2 = 0.0000000
Density matrix diagonal elements [1.98259236 1.6238224  1.87827446 1.87827441 0.37239364 0.12484097
 0.12484061 0.01496115]
i = 1  <i|F|i> = -11.29606540
i = 2  <i|F|i> = -11.29446245
i = 3  <i|F|i> =  -0.99208609
i = 4  <i|F|i> =  -0.43737622
i = 5  <i|F|i> =  -0.38916934
i = 6  <i|F|i> =  -0.38916934
i = 7  <i|F|i> =  -0.11780043
i = 8  <i|F|i> =   0.23132847
i = 9  <i|F|i> =   0.23132853
i = 10  <i|F|i> =   0.92684663
i = 11  <i|F|i> =   0.60766152
i = 12  <i|F|i> =   0.65808016
i = 13  <i|F|i> =   0.65808016
i = 14  <i|F|i> =   0.72888115
i = 15  <i|F|i> =   0.70550751
i = 16  <i|F|i> =   0.70550753
i = 17  <i|F|i> =   0.55409011
i = 18  <i|F|i> =   1.12655297
i = 19  <i|F|i> =   1.24640121
i = 20  <i|F|i> =   1.24640121
i = 21  <i|F|i> =   1.35807431
i = 22  <i|F|i> =   1.35807431
i = 23  <i|F|i> =   1.62487231
i = 24  <i|F|i> =   1.62487231
i = 25  <i|F|i> =   2.03804823
i = 26  <i|F|i> =   2.09062688
i = 27  <i|F|i> =   2.09062687
i = 28  <i|F|i> =   2.28569764
......production of RDMs took       1.84 sec
......reading the RDM took          0.42 sec
......production of RDMs took      23.87 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickICNEVPT2-ijrs) =    -0.00030910015690
E(WickICNEVPT2- rsi) =    -0.00098241147681
E(WickICNEVPT2- ijr) =    -0.00042400340211
E(WickICNEVPT2-  rs) =    -0.03842145162174
E(WickICNEVPT2-  ij) =    -0.00014590143346
E(WickICNEVPT2-  ir) =    -0.00128176455268
E(WickICNEVPT2-   r) =    -0.04628083116852
E(WickICNEVPT2-   i) =    -0.00028425055914
E(WickICNEVPT2) = -75.71101558826174  E_corr_pt = -0.08812971437134655
Timings = pdms =   35.83 | eris =    0.62 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.29 | ij =    0.07 | ir =    0.14 | r =    1.71 | i =    0.68 | total =   39.39
Time cost =     85.188
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:29:48 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.322943027300 AA    0.000000000000   0.000000000000   2.500000000000 Bohr   0.0

nuclear repulsion = 14.4
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.25]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1734.57


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp2t1k8x7o
max_memory 4000 MB (current use 317 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.3694175262293

WARN: Singularity detected in overlap matrix (condition number =  483). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.233376608122621  LUMO (Ag) = -0.177980136770164
cycle= 1 E= -75.3638092539421  delta_E= 0.00561  |g|= 0.211  |ddm|= 1.47
HOMO (B3u) = -0.472745514482946  LUMO (Ag) = -0.148264279814741
cycle= 2 E= -75.3797344374882  delta_E= -0.0159  |g|= 0.0521  |ddm|= 0.252
HOMO (B2u) = -0.435707130637767  LUMO (Ag) = -0.107623543297932
cycle= 3 E= -75.3805941182358  delta_E= -0.00086  |g|= 0.00941  |ddm|= 0.058
HOMO (B2u) = -0.43682644742338  LUMO (Ag) = -0.105984728580028
cycle= 4 E= -75.3806472395887  delta_E= -5.31e-05  |g|= 0.00184  |ddm|= 0.0247
HOMO (B3u) = -0.437581210136123  LUMO (Ag) = -0.106606422286034
cycle= 5 E= -75.3806494262655  delta_E= -2.19e-06  |g|= 0.000123  |ddm|= 0.0084
HOMO (B2u) = -0.437555273305049  LUMO (Ag) = -0.106565393729156
cycle= 6 E= -75.3806494342396  delta_E= -7.97e-09  |g|= 2.47e-05  |ddm|= 0.000449
HOMO (B2u) = -0.437550531930256  LUMO (Ag) = -0.106557643143755
cycle= 7 E= -75.3806494346656  delta_E= -4.26e-10  |g|= 3.1e-06  |ddm|= 0.000106
HOMO (B3u) = -0.437550642586862  LUMO (Ag) = -0.106557057009289
cycle= 8 E= -75.380649434671  delta_E= -5.31e-12  |g|= 3.13e-07  |ddm|= 2.83e-05
HOMO (B2u) = -0.437550627656825  LUMO (Ag) = -0.106556986158707
cycle= 9 E= -75.380649434671  delta_E= -2.84e-14  |g|= 1.55e-08  |ddm|= 1.79e-06
HOMO (B3u) = -0.437550624651402  LUMO (Ag) = -0.10655698290706
cycle= 10 E= -75.380649434671  delta_E=    0  |g|= 1.93e-09  |ddm|= 3.86e-08
HOMO (B3u) = -0.437550624791614  LUMO (Ag) = -0.106556982996551
cycle= 11 E= -75.380649434671  delta_E= 1.42e-14  |g|= 1.09e-09  |ddm|= 2.01e-09
HOMO (B3u) = -0.43755062502095  LUMO (Ag) = -0.10655698319253
cycle= 12 E= -75.380649434671  delta_E= -4.26e-14  |g|= 9.81e-10  |ddm|= 1.39e-09
HOMO (B3u) = -0.437550624983309  LUMO (Ag) = -0.10655698314218
cycle= 13 E= -75.3806494346711  delta_E= -7.11e-14  |g|= 7.77e-10  |ddm|= 6.02e-10
HOMO (B3u) = -0.437550624986935  LUMO (Ag) = -0.106556983115032
cycle= 14 E= -75.3806494346711  delta_E= 1.42e-14  |g|= 6.86e-10  |ddm|= 1.19e-09
HOMO (B3u) = -0.437550624979706  LUMO (Ag) = -0.106556983104106
cycle= 15 E= -75.3806494346709  delta_E= 1.56e-13  |g|= 5.98e-10  |ddm|= 5.77e-10
HOMO (B3u) = -0.437550624967267  LUMO (Ag) = -0.106556983129529
cycle= 16 E= -75.3806494346709  delta_E= -1.42e-14  |g|= 5.69e-10  |ddm|= 8.09e-10
HOMO (B3u) = -0.437550624903446  LUMO (Ag) = -0.10655698310534
cycle= 17 E= -75.380649434671  delta_E= -9.95e-14  |g|= 6.11e-10  |ddm|= 7.16e-10
HOMO (B3u) = -0.437550624889578  LUMO (Ag) = -0.106556983016536
cycle= 18 E= -75.380649434671  delta_E= 1.42e-14  |g|= 2.02e-10  |ddm|= 9.05e-10
HOMO (B3u) = -0.437550624887551  LUMO (Ag) = -0.106556983009412
cycle= 19 E= -75.380649434671  delta_E= 5.68e-14  |g|= 1.6e-10  |ddm|= 1.05e-10
HOMO (B3u) = -0.437550624886879  LUMO (Ag) = -0.106556983006065
cycle= 20 E= -75.380649434671  delta_E= -8.53e-14  |g|= 1.39e-10  |ddm|= 5.83e-11
HOMO (B3u) = -0.437550624892185  LUMO (Ag) = -0.106556983008289
cycle= 21 E= -75.3806494346711  delta_E= -1.42e-14  |g|= 1.16e-10  |ddm|= 7.32e-11
HOMO (B3u) = -0.437550624896162  LUMO (Ag) = -0.106556983009915
cycle= 22 E= -75.3806494346709  delta_E= 1.42e-13  |g|= 9.83e-11  |ddm|= 6.31e-11
HOMO (B3u) = -0.437550624898403  LUMO (Ag) = -0.106556983011266
cycle= 23 E= -75.380649434671  delta_E= -1.14e-13  |g|= 8.25e-11  |ddm|= 3.84e-11
HOMO (B3u) = -0.43755062490005  LUMO (Ag) = -0.106556983012074
cycle= 24 E= -75.3806494346711  delta_E= -4.26e-14  |g|= 6.84e-11  |ddm|= 3.09e-11
HOMO (B3u) = -0.437550624901617  LUMO (Ag) = -0.106556983011052
cycle= 25 E= -75.3806494346711  delta_E= -1.42e-14  |g|= 5.22e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.437550624902436  LUMO (Ag) = -0.106556983007879
cycle= 26 E= -75.3806494346709  delta_E= 1.71e-13  |g|= 3.37e-11  |ddm|= 3.22e-11
HOMO (B2u) = -0.437550624902166  LUMO (Ag) = -0.106556983006708
cycle= 27 E= -75.380649434671  delta_E= -1.14e-13  |g|= 2.81e-11  |ddm|= 9.79e-12
HOMO (B2u) = -0.437550624901762  LUMO (Ag) = -0.106556983005602
cycle= 28 E= -75.380649434671  delta_E=    0  |g|= 2.37e-11  |ddm|= 8.16e-12
HOMO (B2u) = -0.437550624900569  LUMO (Ag) = -0.106556983001687
Extra cycle  E= -75.380649434671  delta_E= 5.68e-14  |g|= 8.23e-12  |ddm|= 3.41e-11
converged SCF energy = -75.380649434671

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp2t1k8x7o
max_memory 4000 MB (current use 317 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5520156742897  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5749557691934  dE = -0.022940095  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5893075599883  dE = -0.014351791  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0633  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5977719040473  dE = -0.0084643441  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0299  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6039893910604  dE = -0.006217487  S^2 = 0.0000000
               |grad[o]|=0.071  |ddm|=0.0135  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6089055501134  dE = -0.0049161591  S^2 = 0.0000000
               |grad[o]|=0.0571  |ddm|=0.00833  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6128209543821  dE = -0.0039154043  S^2 = 0.0000000
               |grad[o]|=0.0454  |ddm|=0.00602  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6158466050426  dE = -0.0030256507  S^2 = 0.0000000
               |grad[o]|=0.0352  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6180396311177  dE = -0.0021930261  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194395133818  dE = -0.0013998823  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00412  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6200886537406  dE = -0.00064914036  S^2 = 0.0000000
               |grad[o]|=0.00981  |ddm|=0.00428  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201507320498  dE = -6.2078309e-05  S^2 = 0.0000000
               |grad[o]|=0.00282  |ddm|=0.00468  |maxRot[o]|=0.0311
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201515477166  dE = -8.1566682e-07  S^2 = 0.0000000
               |grad[o]|=0.000473  |ddm|=0.00207  |maxRot[o]|=0.00307
macro iter 13 (3 JK  0 micro), CASSCF E = -75.620151564329  dE = -1.6612475e-08  S^2 = 0.0000000
               |grad[o]|=7.49e-05  |ddm|=0.000374  |maxRot[o]|=0.000396
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6201515647232  dE = -3.941949e-10  S^2 = 0.0000000
               |grad[o]|=1.22e-05  |ddm|=7.4e-05  |maxRot[o]|=6.42e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6201515647411  dE = -1.7863044e-11  S^2 = 0.0000000
               |grad[o]|=2.58e-06  |ddm|=1.82e-05  |maxRot[o]|=1.12e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98175021 1.63550776 1.87115624 1.8711556  0.3611846  0.1317302
 0.13173008 0.01578531]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00465   0.00301   0.00000   0.00000  -0.00114
  0 C 2s       0.60227   0.53958  -0.00000  -0.00000  -0.36778
  0 C 3s      -0.04374   0.00880  -0.00000  -0.00000  -0.00363
  0 C 2px      0.00000  -0.00000  -0.00000   0.70650  -0.00000
  0 C 2py      0.00000   0.00000   0.70650  -0.00000   0.00000
  0 C 2pz      0.36367  -0.45689  -0.00000  -0.00000   0.60227
  0 C 3px      0.00000  -0.00000   0.00000  -0.00009   0.00000
  0 C 3py     -0.00000   0.00000  -0.00009  -0.00000   0.00000
  0 C 3pz     -0.04268  -0.00383  -0.00000  -0.00000  -0.04233
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.02932  -0.00000   0.00000
  0 C 3dz^2    0.03544   0.00032  -0.00000  -0.00000   0.01448
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02932   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00465  -0.00301   0.00000   0.00000  -0.00114
  1 C 2s       0.60227  -0.53958   0.00000   0.00000  -0.36778
  1 C 3s      -0.04374  -0.00880   0.00000   0.00000  -0.00363
  1 C 2px     -0.00000   0.00000  -0.00000   0.70650  -0.00000
  1 C 2py      0.00000  -0.00000   0.70650   0.00000  -0.00000
  1 C 2pz     -0.36367  -0.45689  -0.00000   0.00000  -0.60227
  1 C 3px     -0.00000   0.00000   0.00000  -0.00009   0.00000
  1 C 3py     -0.00000  -0.00000  -0.00009   0.00000  -0.00000
  1 C 3pz      0.04268  -0.00383  -0.00000  -0.00000   0.04233
  1 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000  -0.02932  -0.00000   0.00000
  1 C 3dz^2    0.03544  -0.00032   0.00000   0.00000   0.01448
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02932  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s      -0.00000  -0.00000   0.45623
  0 C 3s      -0.00000  -0.00000  -0.04293
  0 C 2px      0.70638   0.00000  -0.00000
  0 C 2py      0.00000   0.70638  -0.00000
  0 C 2pz      0.00000  -0.00000   0.53783
  0 C 3px     -0.02172   0.00000  -0.00000
  0 C 3py      0.00000  -0.02172  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01389
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02345  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02369
  0 C 3dxz    -0.02345   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s       0.00000   0.00000  -0.45623
  1 C 3s       0.00000   0.00000   0.04293
  1 C 2px     -0.70638  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70638   0.00000
  1 C 2pz      0.00000  -0.00000   0.53783
  1 C 3px      0.02172  -0.00000   0.00000
  1 C 3py     -0.00000   0.02172   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01389
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02345  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02369
  1 C 3dxz    -0.02345   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99374273
<CAS-nat-orb|mo-hf>  4  4    0.99831642
<CAS-nat-orb|mo-hf>  5  5    0.99972153
<CAS-nat-orb|mo-hf>  6  6    0.99972153
<CAS-nat-orb|mo-hf>  7  7    0.97735853
<CAS-nat-orb|mo-hf>  8  8    0.94866398
<CAS-nat-orb|mo-hf>  9  9    0.94866393
<CAS-nat-orb|mo-hf>  10  10    0.53130849
<CAS-nat-orb|mo-hf>  10  17    0.68518248
<CAS-nat-orb|mo-hf>  10  18   -0.46282807
CASSCF energy = -75.6201515647411
CASCI E = -75.6201515647411  E(CI) = -17.3010863052879  S^2 = 0.0000000
Density matrix diagonal elements [1.98175036 1.63550679 1.87115589 1.87115563 0.36118591 0.13173015
 0.13172999 0.01578527]
i = 1  <i|F|i> = -11.30127417
i = 2  <i|F|i> = -11.29995650
i = 3  <i|F|i> =  -0.98217967
i = 4  <i|F|i> =  -0.44452360
i = 5  <i|F|i> =  -0.38275841
i = 6  <i|F|i> =  -0.38275836
i = 7  <i|F|i> =  -0.11574127
i = 8  <i|F|i> =   0.21753664
i = 9  <i|F|i> =   0.21753675
i = 10  <i|F|i> =   0.88147093
i = 11  <i|F|i> =   0.61279527
i = 12  <i|F|i> =   0.66210093
i = 13  <i|F|i> =   0.66210093
i = 14  <i|F|i> =   0.72743252
i = 15  <i|F|i> =   0.70607882
i = 16  <i|F|i> =   0.70607876
i = 17  <i|F|i> =   0.55455733
i = 18  <i|F|i> =   1.12020719
i = 19  <i|F|i> =   1.25001754
i = 20  <i|F|i> =   1.25001754
i = 21  <i|F|i> =   1.34182810
i = 22  <i|F|i> =   1.34182809
i = 23  <i|F|i> =   1.61426606
i = 24  <i|F|i> =   1.61426606
i = 25  <i|F|i> =   2.02267326
i = 26  <i|F|i> =   2.07441392
i = 27  <i|F|i> =   2.07441391
i = 28  <i|F|i> =   2.25447079
......production of RDMs took       1.83 sec
......reading the RDM took          0.41 sec
......production of RDMs took      25.70 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickICNEVPT2-ijrs) =    -0.00030220020039
E(WickICNEVPT2- rsi) =    -0.00096363154154
E(WickICNEVPT2- ijr) =    -0.00041693698101
E(WickICNEVPT2-  rs) =    -0.03798793311527
E(WickICNEVPT2-  ij) =    -0.00014067207934
E(WickICNEVPT2-  ir) =    -0.00126360401688
E(WickICNEVPT2-   r) =    -0.04702789816266
E(WickICNEVPT2-   i) =    -0.00027827143188
E(WickICNEVPT2) = -75.70853271227007  E_corr_pt = -0.08838114752896123
Timings = pdms =   37.63 | eris =    0.01 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.16 | r =    2.16 | i =    0.74 | total =   41.08
Time cost =     92.259
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:31:21 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.349401887846 AA    0.000000000000   0.000000000000   2.550000000000 Bohr   0.0

nuclear repulsion = 14.1176470588235
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.275]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1832.64


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmppz0se81o
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.322852658808

WARN: Singularity detected in overlap matrix (condition number =  444). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.224183141291852  LUMO (Ag) = -0.175375833613537
cycle= 1 E= -75.3580302281757  delta_E= -0.0352  |g|= 0.215  |ddm|= 1.46
HOMO (B3u) = -0.467759172708484  LUMO (Ag) = -0.149454753798778
cycle= 2 E= -75.3746497165004  delta_E= -0.0166  |g|= 0.0521  |ddm|= 0.26
HOMO (B3u) = -0.43051679398039  LUMO (Ag) = -0.107753824209472
cycle= 3 E= -75.3755305907904  delta_E= -0.000881  |g|= 0.00966  |ddm|= 0.0568
HOMO (B3u) = -0.431561534231314  LUMO (Ag) = -0.105750596270451
cycle= 4 E= -75.3755868789759  delta_E= -5.63e-05  |g|= 0.00191  |ddm|= 0.0225
HOMO (B3u) = -0.432324246357025  LUMO (Ag) = -0.106325540767305
cycle= 5 E= -75.3755892675814  delta_E= -2.39e-06  |g|= 0.000174  |ddm|= 0.00743
HOMO (B2u) = -0.432284401985618  LUMO (Ag) = -0.106263967776652
cycle= 6 E= -75.3755892854562  delta_E= -1.79e-08  |g|= 3.01e-05  |ddm|= 0.000369
HOMO (B3u) = -0.43227872918366  LUMO (Ag) = -0.106254488809741
cycle= 7 E= -75.3755892860986  delta_E= -6.42e-10  |g|= 3.64e-06  |ddm|= 0.000169
HOMO (B3u) = -0.432278901425311  LUMO (Ag) = -0.106253945307367
cycle= 8 E= -75.3755892861055  delta_E= -6.82e-12  |g|= 3.45e-07  |ddm|= 2.86e-05
HOMO (B2u) = -0.43227888334388  LUMO (Ag) = -0.106253871171305
cycle= 9 E= -75.3755892861056  delta_E= -9.95e-14  |g|= 1.65e-08  |ddm|= 2.14e-06
HOMO (B2u) = -0.432278879789835  LUMO (Ag) = -0.106253868646632
cycle= 10 E= -75.3755892861055  delta_E= 7.11e-14  |g|= 2.15e-09  |ddm|= 4.37e-08
HOMO (B2u) = -0.432278879834847  LUMO (Ag) = -0.10625386859241
cycle= 11 E= -75.3755892861055  delta_E= -2.84e-14  |g|= 1.19e-09  |ddm|= 2.57e-09
HOMO (B2u) = -0.432278880141752  LUMO (Ag) = -0.106253868885865
cycle= 12 E= -75.3755892861054  delta_E= 1.14e-13  |g|= 1.13e-09  |ddm|= 1.54e-09
HOMO (B2u) = -0.432278880105418  LUMO (Ag) = -0.106253868833385
cycle= 13 E= -75.3755892861055  delta_E= -8.53e-14  |g|= 8.75e-10  |ddm|= 9.96e-10
HOMO (B2u) = -0.432278880096256  LUMO (Ag) = -0.106253868794833
cycle= 14 E= -75.3755892861055  delta_E= -5.68e-14  |g|= 7.51e-10  |ddm|= 1.05e-09
HOMO (B2u) = -0.432278880082774  LUMO (Ag) = -0.106253868781562
cycle= 15 E= -75.3755892861055  delta_E= 4.26e-14  |g|= 6.67e-10  |ddm|= 7.56e-10
HOMO (B2u) = -0.432278880085562  LUMO (Ag) = -0.106253868821248
cycle= 16 E= -75.3755892861055  delta_E= -1.42e-14  |g|= 6.25e-10  |ddm|= 1.17e-09
HOMO (B2u) = -0.432278880013886  LUMO (Ag) = -0.106253868781429
cycle= 17 E= -75.3755892861056  delta_E= -9.95e-14  |g|= 6.62e-10  |ddm|= 8.09e-10
HOMO (B2u) = -0.432278879979886  LUMO (Ag) = -0.106253868676536
cycle= 18 E= -75.3755892861055  delta_E= 1.28e-13  |g|= 2.28e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.432278879979406  LUMO (Ag) = -0.106253868669852
cycle= 19 E= -75.3755892861056  delta_E= -8.53e-14  |g|= 1.79e-10  |ddm|= 1.32e-10
HOMO (B2u) = -0.432278879978481  LUMO (Ag) = -0.106253868666216
cycle= 20 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 1.56e-10  |ddm|= 7.59e-11
HOMO (B3u) = -0.432278879985057  LUMO (Ag) = -0.106253868669375
cycle= 21 E= -75.3755892861055  delta_E= -2.84e-14  |g|= 1.29e-10  |ddm|= 9.35e-11
HOMO (B2u) = -0.432278879990126  LUMO (Ag) = -0.106253868671825
cycle= 22 E= -75.3755892861056  delta_E= -4.26e-14  |g|= 1.09e-10  |ddm|= 7.48e-11
HOMO (B3u) = -0.43227887999336  LUMO (Ag) = -0.106253868673926
cycle= 23 E= -75.3755892861055  delta_E= 7.11e-14  |g|= 9.17e-11  |ddm|= 5.23e-11
HOMO (B2u) = -0.432278879995599  LUMO (Ag) = -0.106253868674891
cycle= 24 E= -75.3755892861055  delta_E=    0  |g|= 7.55e-11  |ddm|= 3.88e-11
HOMO (B3u) = -0.432278879997436  LUMO (Ag) = -0.106253868668112
Extra cycle  E= -75.3755892861055  delta_E= -2.84e-14  |g|= 2.45e-11  |ddm|= 9.35e-11
converged SCF energy = -75.3755892861055

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmppz0se81o
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5487757489225  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.572275294748  dE = -0.023499546  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5857503411535  dE = -0.013475046  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0659  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5940452830234  dE = -0.0082949419  S^2 = 0.0000000
               |grad[o]|=0.0897  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.600204946914  dE = -0.0061596639  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0141  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6050819970427  dE = -0.0048770501  S^2 = 0.0000000
               |grad[o]|=0.0582  |ddm|=0.00893  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6089574825406  dE = -0.0038754855  S^2 = 0.0000000
               |grad[o]|=0.0463  |ddm|=0.00649  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6119399769  dE = -0.0029824944  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00515  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6140852962078  dE = -0.0021453193  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00446  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6154329698277  dE = -0.0013476736  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6160256616854  dE = -0.00059269186  S^2 = 0.0000000
               |grad[o]|=0.00954  |ddm|=0.00447  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6160629697539  dE = -3.7308069e-05  S^2 = 0.0000000
               |grad[o]|=0.00234  |ddm|=0.00498  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6160660554681  dE = -3.0857143e-06  S^2 = 0.0000000
               |grad[o]|=0.000716  |ddm|=0.00145  |maxRot[o]|=0.00665
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6160661048717  dE = -4.940361e-08  S^2 = 0.0000000
               |grad[o]|=0.000124  |ddm|=0.000551  |maxRot[o]|=0.000718
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6160661059023  dE = -1.030557e-09  S^2 = 0.0000000
               |grad[o]|=1.96e-05  |ddm|=9.67e-05  |maxRot[o]|=9.86e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6160661059281  dE = -2.5792701e-11  S^2 = 0.0000000
               |grad[o]|=3.01e-06  |ddm|=1.91e-05  |maxRot[o]|=1.56e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98089624 1.64657015 1.86373182 1.86373136 0.35078076 0.13883165
 0.1388318  0.01662623]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00498   0.00310   0.00000   0.00000  -0.00109
  0 C 2s       0.60537   0.54713  -0.00000   0.00000  -0.36277
  0 C 3s      -0.04187   0.00880  -0.00000  -0.00000  -0.00080
  0 C 2px      0.00000  -0.00000   0.00000   0.70653  -0.00000
  0 C 2py      0.00000  -0.00000   0.70653  -0.00000   0.00000
  0 C 2pz      0.35902  -0.44783   0.00000   0.00000   0.60525
  0 C 3px     -0.00000   0.00000   0.00000   0.00282   0.00000
  0 C 3py     -0.00000   0.00000   0.00282   0.00000   0.00000
  0 C 3pz     -0.04100  -0.00346  -0.00000  -0.00000  -0.04273
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.02846  -0.00000   0.00000
  0 C 3dz^2    0.03432  -0.00016  -0.00000  -0.00000   0.01561
  0 C 3dxz    -0.00000   0.00000   0.00000   0.02846   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00498  -0.00310   0.00000   0.00000  -0.00109
  1 C 2s       0.60537  -0.54713   0.00000   0.00000  -0.36277
  1 C 3s      -0.04187  -0.00880   0.00000   0.00000  -0.00080
  1 C 2px      0.00000  -0.00000  -0.00000   0.70653  -0.00000
  1 C 2py      0.00000  -0.00000   0.70653  -0.00000  -0.00000
  1 C 2pz     -0.35902  -0.44783   0.00000   0.00000  -0.60525
  1 C 3px     -0.00000   0.00000  -0.00000   0.00282   0.00000
  1 C 3py     -0.00000   0.00000   0.00282   0.00000  -0.00000
  1 C 3pz      0.04100  -0.00346  -0.00000  -0.00000   0.04273
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02846  -0.00000   0.00000
  1 C 3dz^2    0.03432   0.00016   0.00000  -0.00000   0.01561
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.02846  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s       0.00000  -0.00000   0.44717
  0 C 3s       0.00000   0.00000  -0.04302
  0 C 2px      0.70642  -0.00000   0.00000
  0 C 2py      0.00000   0.70642   0.00000
  0 C 2pz      0.00000   0.00000   0.54537
  0 C 3px     -0.02076  -0.00000   0.00000
  0 C 3py     -0.00000  -0.02076   0.00000
  0 C 3pz      0.00000   0.00000   0.01534
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02331   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02287
  0 C 3dxz    -0.02331  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000  -0.00000  -0.44717
  1 C 3s      -0.00000  -0.00000   0.04302
  1 C 2px     -0.70642   0.00000  -0.00000
  1 C 2py      0.00000  -0.70642   0.00000
  1 C 2pz      0.00000  -0.00000   0.54537
  1 C 3px      0.02076   0.00000  -0.00000
  1 C 3py     -0.00000   0.02076  -0.00000
  1 C 3pz      0.00000  -0.00000   0.01534
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02331   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02287
  1 C 3dxz    -0.02331  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99344302
<CAS-nat-orb|mo-hf>  4  4    0.99822555
<CAS-nat-orb|mo-hf>  5  5    0.99969500
<CAS-nat-orb|mo-hf>  6  6    0.99969500
<CAS-nat-orb|mo-hf>  7  7    0.97683028
<CAS-nat-orb|mo-hf>  8  8    0.95239327
<CAS-nat-orb|mo-hf>  9  9    0.95239324
<CAS-nat-orb|mo-hf>  10  10    0.55278427
<CAS-nat-orb|mo-hf>  10  17    0.68990826
<CAS-nat-orb|mo-hf>  10  18   -0.43567179
CASSCF energy = -75.6160661059281
CASCI E = -75.6160661059281  E(CI) = -17.1715111507676  S^2 = 0.0000000
Density matrix diagonal elements [1.98089604 1.64656613 1.86373333 1.86373231 0.35078325 0.13883134
 0.1388314  0.01662619]
i = 1  <i|F|i> = -11.30628332
i = 2  <i|F|i> = -11.30520689
i = 3  <i|F|i> =  -0.97236801
i = 4  <i|F|i> =  -0.45153030
i = 5  <i|F|i> =  -0.37651394
i = 6  <i|F|i> =  -0.37651374
i = 7  <i|F|i> =  -0.11367238
i = 8  <i|F|i> =   0.20431398
i = 9  <i|F|i> =   0.20431399
i = 10  <i|F|i> =   0.83838836
i = 11  <i|F|i> =   0.61779302
i = 12  <i|F|i> =   0.66586230
i = 13  <i|F|i> =   0.66586230
i = 14  <i|F|i> =   0.72640818
i = 15  <i|F|i> =   0.70658966
i = 16  <i|F|i> =   0.70658964
i = 17  <i|F|i> =   0.55528068
i = 18  <i|F|i> =   1.11402350
i = 19  <i|F|i> =   1.25381840
i = 20  <i|F|i> =   1.25381840
i = 21  <i|F|i> =   1.32637004
i = 22  <i|F|i> =   1.32637002
i = 23  <i|F|i> =   1.60396434
i = 24  <i|F|i> =   1.60396434
i = 25  <i|F|i> =   2.00529893
i = 26  <i|F|i> =   2.05827646
i = 27  <i|F|i> =   2.05827647
i = 28  <i|F|i> =   2.22765704
......production of RDMs took       2.33 sec
......reading the RDM took          0.41 sec
......production of RDMs took      26.41 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.72 sec

E(WickICNEVPT2-ijrs) =    -0.00029647948832
E(WickICNEVPT2- rsi) =    -0.00094682632009
E(WickICNEVPT2- ijr) =    -0.00041004729695
E(WickICNEVPT2-  rs) =    -0.03754876826592
E(WickICNEVPT2-  ij) =    -0.00013535545381
E(WickICNEVPT2-  ir) =    -0.00124607096751
E(WickICNEVPT2-   r) =    -0.04778645589702
E(WickICNEVPT2-   i) =    -0.00027233718677
E(WickICNEVPT2) = -75.70470844680447  E_corr_pt = -0.08864234087637979
Timings = pdms =   38.85 | eris =    0.01 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.77 | i =    0.70 | total =   41.85
Time cost =     92.735
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:32:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.375860748392 AA    0.000000000000   0.000000000000   2.600000000000 Bohr   0.0

nuclear repulsion = 13.8461538461538
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.3]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1925.16


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpatl8tzn9
max_memory 4000 MB (current use 322 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.278195813693

WARN: Singularity detected in overlap matrix (condition number =  409). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.215477115824915  LUMO (Ag) = -0.172896295276614
cycle= 1 E= -75.3511756370242  delta_E= -0.073  |g|= 0.218  |ddm|= 1.45
HOMO (B3u) = -0.462888168119372  LUMO (Ag) = -0.150366392380425
cycle= 2 E= -75.3684890547634  delta_E= -0.0173  |g|= 0.0521  |ddm|= 0.268
HOMO (B3u) = -0.425477509345156  LUMO (Ag) = -0.107647319512262
cycle= 3 E= -75.369391499486  delta_E= -0.000902  |g|= 0.00999  |ddm|= 0.056
HOMO (B2u) = -0.426482502338424  LUMO (Ag) = -0.105320428216433
cycle= 4 E= -75.3694522894417  delta_E= -6.08e-05  |g|= 0.002  |ddm|= 0.0206
HOMO (B3u) = -0.427253849930314  LUMO (Ag) = -0.105864709294584
cycle= 5 E= -75.3694549331517  delta_E= -2.64e-06  |g|= 0.000217  |ddm|= 0.00651
HOMO (B3u) = -0.427202128961965  LUMO (Ag) = -0.105788865113731
cycle= 6 E= -75.3694549621127  delta_E= -2.9e-08  |g|= 3.29e-05  |ddm|= 0.000392
HOMO (B2u) = -0.427195922281588  LUMO (Ag) = -0.105778621503337
cycle= 7 E= -75.3694549628765  delta_E= -7.64e-10  |g|= 4.04e-06  |ddm|= 0.000193
HOMO (B3u) = -0.427196084833615  LUMO (Ag) = -0.105778048731943
cycle= 8 E= -75.3694549628846  delta_E= -8.14e-12  |g|= 3.71e-07  |ddm|= 2.79e-05
HOMO (B2u) = -0.427196062615918  LUMO (Ag) = -0.105777966012863
cycle= 9 E= -75.3694549628848  delta_E= -1.71e-13  |g|= 1.75e-08  |ddm|= 2.3e-06
HOMO (B3u) = -0.427196058477427  LUMO (Ag) = -0.105777964390646
cycle= 10 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 2.34e-09  |ddm|= 4.88e-08
HOMO (B3u) = -0.427196058523832  LUMO (Ag) = -0.105777964301872
cycle= 11 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 1.37e-09  |ddm|= 2.34e-09
HOMO (B3u) = -0.427196058860429  LUMO (Ag) = -0.105777964639639
cycle= 12 E= -75.3694549628848  delta_E=    0  |g|= 1.25e-09  |ddm|= 6.79e-10
HOMO (B3u) = -0.427196058808444  LUMO (Ag) = -0.105777964573545
cycle= 13 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 9.78e-10  |ddm|= 1.03e-09
HOMO (B3u) = -0.427196058787184  LUMO (Ag) = -0.105777964525761
cycle= 14 E= -75.3694549628848  delta_E= -1.42e-14  |g|= 8.27e-10  |ddm|= 9.38e-10
HOMO (B3u) = -0.427196058774659  LUMO (Ag) = -0.105777964513356
cycle= 15 E= -75.3694549628848  delta_E= 1.42e-14  |g|= 7.31e-10  |ddm|= 9.09e-10
HOMO (B2u) = -0.427196058780527  LUMO (Ag) = -0.105777964558645
cycle= 16 E= -75.3694549628847  delta_E= 8.53e-14  |g|= 6.83e-10  |ddm|= 1.29e-09
HOMO (B3u) = -0.427196058709289  LUMO (Ag) = -0.10577796451112
cycle= 17 E= -75.3694549628849  delta_E= -1.71e-13  |g|= 7.12e-10  |ddm|= 7e-10
HOMO (B2u) = -0.427196058654945  LUMO (Ag) = -0.105777964391068
cycle= 18 E= -75.3694549628848  delta_E= 1.14e-13  |g|= 2.56e-10  |ddm|= 1.18e-09
HOMO (B3u) = -0.427196058655488  LUMO (Ag) = -0.10577796438474
cycle= 19 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 2.02e-10  |ddm|= 1.61e-10
HOMO (B3u) = -0.427196058656339  LUMO (Ag) = -0.105777964382296
cycle= 20 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 1.73e-10  |ddm|= 1.09e-10
HOMO (B2u) = -0.427196058664211  LUMO (Ag) = -0.105777964386539
cycle= 21 E= -75.3694549628848  delta_E= -7.11e-14  |g|= 1.42e-10  |ddm|= 1.05e-10
HOMO (B2u) = -0.427196058670138  LUMO (Ag) = -0.105777964389693
cycle= 22 E= -75.3694549628848  delta_E= 1.42e-14  |g|= 1.19e-10  |ddm|= 8.57e-11
HOMO (B2u) = -0.427196058674145  LUMO (Ag) = -0.105777964392352
cycle= 23 E= -75.3694549628848  delta_E= -1.42e-14  |g|= 1e-10  |ddm|= 6.62e-11
HOMO (B3u) = -0.427196058677027  LUMO (Ag) = -0.105777964393746
cycle= 24 E= -75.3694549628848  delta_E= -1.42e-14  |g|= 8.26e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.427196058679999  LUMO (Ag) = -0.105777964393407
cycle= 25 E= -75.3694549628849  delta_E= -2.84e-14  |g|= 6.3e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.427196058681616  LUMO (Ag) = -0.10577796439101
cycle= 26 E= -75.3694549628848  delta_E= 8.53e-14  |g|= 4.17e-11  |ddm|= 4.01e-11
HOMO (B3u) = -0.42719605868105  LUMO (Ag) = -0.105777964389359
cycle= 27 E= -75.3694549628848  delta_E= -4.26e-14  |g|= 3.46e-11  |ddm|= 1.33e-11
HOMO (B2u) = -0.427196058680397  LUMO (Ag) = -0.105777964387875
cycle= 28 E= -75.3694549628848  delta_E= 4.26e-14  |g|= 2.89e-11  |ddm|= 1.03e-11
HOMO (B2u) = -0.427196058679717  LUMO (Ag) = -0.105777964386456
cycle= 29 E= -75.3694549628847  delta_E= 8.53e-14  |g|= 2.39e-11  |ddm|= 9.06e-12
HOMO (B2u) = -0.427196058679254  LUMO (Ag) = -0.105777964385339
cycle= 30 E= -75.3694549628848  delta_E= -1.14e-13  |g|= 1.97e-11  |ddm|= 7.79e-12
HOMO (B2u) = -0.427196058678943  LUMO (Ag) = -0.105777964384434
cycle= 31 E= -75.3694549628848  delta_E= 5.68e-14  |g|= 1.61e-11  |ddm|= 7.16e-12
HOMO (B2u) = -0.427196058678763  LUMO (Ag) = -0.105777964383665
cycle= 32 E= -75.3694549628848  delta_E= -7.11e-14  |g|= 1.29e-11  |ddm|= 6.88e-12
HOMO (B3u) = -0.427196058678693  LUMO (Ag) = -0.105777964383032
cycle= 33 E= -75.3694549628848  delta_E= 4.26e-14  |g|= 1.02e-11  |ddm|= 6.13e-12
HOMO (B3u) = -0.427196058678726  LUMO (Ag) = -0.105777964382614
cycle= 34 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 8.1e-12  |ddm|= 4.69e-12
HOMO (B3u) = -0.427196058678791  LUMO (Ag) = -0.105777964382386
cycle= 35 E= -75.3694549628848  delta_E= -8.53e-14  |g|= 6.73e-12  |ddm|= 3.37e-12
HOMO (B3u) = -0.427196058678836  LUMO (Ag) = -0.10577796438218
cycle= 36 E= -75.3694549628849  delta_E= -2.84e-14  |g|= 5.57e-12  |ddm|= 3.01e-12
HOMO (B3u) = -0.427196058678861  LUMO (Ag) = -0.105777964381988
cycle= 37 E= -75.3694549628848  delta_E= 9.95e-14  |g|= 4.6e-12  |ddm|= 2.66e-12
HOMO (B3u) = -0.427196058678868  LUMO (Ag) = -0.105777964381809
cycle= 38 E= -75.3694549628848  delta_E= -1.42e-14  |g|= 3.78e-12  |ddm|= 2.35e-12
HOMO (B3u) = -0.427196058678864  LUMO (Ag) = -0.105777964381645
cycle= 39 E= -75.3694549628849  delta_E= -8.53e-14  |g|= 3.08e-12  |ddm|= 2.01e-12
HOMO (B3u) = -0.427196058678855  LUMO (Ag) = -0.105777964381501
cycle= 40 E= -75.3694549628848  delta_E= 1.14e-13  |g|= 2.52e-12  |ddm|= 1.65e-12
HOMO (B3u) = -0.427196058678844  LUMO (Ag) = -0.105777964381379
cycle= 41 E= -75.3694549628847  delta_E= 2.84e-14  |g|= 2.06e-12  |ddm|= 1.42e-12
HOMO (B2u) = -0.427196058678832  LUMO (Ag) = -0.105777964381278
cycle= 42 E= -75.3694549628848  delta_E= -1.14e-13  |g|= 1.7e-12  |ddm|= 1.13e-12
HOMO (B2u) = -0.427196058678823  LUMO (Ag) = -0.105777964381198
cycle= 43 E= -75.3694549628849  delta_E= -1.42e-14  |g|= 1.42e-12  |ddm|= 8.93e-13
HOMO (B2u) = -0.427196058678817  LUMO (Ag) = -0.105777964381131
cycle= 44 E= -75.3694549628848  delta_E= 4.26e-14  |g|= 1.17e-12  |ddm|= 8.07e-13
HOMO (B2u) = -0.427196058678814  LUMO (Ag) = -0.105777964381076
cycle= 45 E= -75.3694549628849  delta_E= -8.53e-14  |g|= 9.74e-13  |ddm|= 6.37e-13
HOMO (B3u) = -0.427196058678813  LUMO (Ag) = -0.10577796438103
cycle= 46 E= -75.3694549628848  delta_E= 8.53e-14  |g|= 8.04e-13  |ddm|= 5.62e-13
HOMO (B2u) = -0.427196058678813  LUMO (Ag) = -0.105777964380994
cycle= 47 E= -75.3694549628848  delta_E=    0  |g|= 6.65e-13  |ddm|= 4.78e-13
HOMO (B2u) = -0.427196058678815  LUMO (Ag) = -0.105777964380889
Extra cycle  E= -75.3694549628848  delta_E=    0  |g|= 2.68e-13  |ddm|= 1.21e-12
converged SCF energy = -75.3694549628848

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpatl8tzn9
max_memory 4000 MB (current use 322 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5444984241905  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5681594686599  dE = -0.023661044  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0785
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5810819888402  dE = -0.01292252  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0676  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5892771745196  dE = -0.0081951857  S^2 = 0.0000000
               |grad[o]|=0.0906  |ddm|=0.0288  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5954033818113  dE = -0.0061262073  S^2 = 0.0000000
               |grad[o]|=0.0731  |ddm|=0.0147  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6002475134348  dE = -0.0048441316  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00955  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6040772496006  dE = -0.0038297362  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.00694  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6070010105597  dE = -0.002923761  S^2 = 0.0000000
               |grad[o]|=0.0361  |ddm|=0.00545  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6090752010627  dE = -0.0020741905  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00466  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6103412339138  dE = -0.0012660329  S^2 = 0.0000000
               |grad[o]|=0.0172  |ddm|=0.00445  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6107871863664  dE = -0.00044595245  S^2 = 0.0000000
               |grad[o]|=0.00888  |ddm|=0.00474  |maxRot[o]|= 0.06
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6108585911988  dE = -7.1404832e-05  S^2 = 0.0000000
               |grad[o]|=0.00316  |ddm|=0.00398  |maxRot[o]|=0.0329
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6108594685962  dE = -8.773974e-07  S^2 = 0.0000000
               |grad[o]|=0.0005  |ddm|=0.00241  |maxRot[o]|=0.00309
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6108594862078  dE = -1.7611669e-08  S^2 = 0.0000000
               |grad[o]|=7.67e-05  |ddm|=0.000367  |maxRot[o]|=0.000384
macro iter 14 (3 JK  0 micro), CASSCF E = -75.610859486608  dE = -4.0016346e-10  S^2 = 0.0000000
               |grad[o]|=1.26e-05  |ddm|=6.64e-05  |maxRot[o]|=6.02e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6108594866192  dE = -1.1183943e-11  S^2 = 0.0000000
               |grad[o]|=2.08e-06  |ddm|=1.32e-05  |maxRot[o]|=1.01e-05
2-step CASSCF converged in 15 macro (74 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98003344 1.65708287 1.85598498 1.85598555 0.341134   0.14614874
 0.14614893 0.01748149]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00530   0.00319   0.00000   0.00000  -0.00104
  0 C 2s       0.60847   0.55448  -0.00000  -0.00000  -0.35767
  0 C 3s      -0.03996   0.00882  -0.00000  -0.00000   0.00198
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655  -0.00000
  0 C 2py     -0.00000   0.00000   0.70655  -0.00000   0.00000
  0 C 2pz      0.35425  -0.43870  -0.00000  -0.00000   0.60822
  0 C 3px     -0.00000  -0.00000   0.00000   0.00558  -0.00000
  0 C 3py     -0.00000   0.00000   0.00558   0.00000   0.00000
  0 C 3pz     -0.03931  -0.00314  -0.00000  -0.00000  -0.04299
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02761   0.00000   0.00000
  0 C 3dz^2    0.03326  -0.00060  -0.00000  -0.00000   0.01688
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02761  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00530  -0.00319   0.00000   0.00000  -0.00104
  1 C 2s       0.60847  -0.55448   0.00000  -0.00000  -0.35767
  1 C 3s      -0.03996  -0.00882   0.00000   0.00000   0.00198
  1 C 2px     -0.00000   0.00000  -0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000  -0.00000
  1 C 2pz     -0.35425  -0.43870  -0.00000   0.00000  -0.60822
  1 C 3px      0.00000   0.00000   0.00000   0.00558   0.00000
  1 C 3py      0.00000  -0.00000   0.00558   0.00000  -0.00000
  1 C 3pz      0.03931  -0.00314  -0.00000  -0.00000   0.04299
  1 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02761  -0.00000   0.00000
  1 C 3dz^2    0.03326   0.00060   0.00000   0.00000   0.01688
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02761  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00051
  0 C 2s      -0.00000  -0.00000   0.43805
  0 C 3s      -0.00000  -0.00000  -0.04314
  0 C 2px      0.70645   0.00000   0.00000
  0 C 2py      0.00000   0.70645  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55270
  0 C 3px     -0.01985   0.00000   0.00000
  0 C 3py      0.00000  -0.01985  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01664
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02315  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02225
  0 C 3dxz    -0.02315   0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00051
  1 C 2s      -0.00000   0.00000  -0.43805
  1 C 3s       0.00000   0.00000   0.04314
  1 C 2px     -0.70645  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70645   0.00000
  1 C 2pz      0.00000  -0.00000   0.55270
  1 C 3px      0.01985  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01985   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01664
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02315  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02225
  1 C 3dxz    -0.02315   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99314132
<CAS-nat-orb|mo-hf>  4  4    0.99812795
<CAS-nat-orb|mo-hf>  5  5    0.99966602
<CAS-nat-orb|mo-hf>  6  6    0.99966602
<CAS-nat-orb|mo-hf>  7  7    0.97631889
<CAS-nat-orb|mo-hf>  8  8    0.95579302
<CAS-nat-orb|mo-hf>  9  9    0.95579308
<CAS-nat-orb|mo-hf>  10  10    0.57545984
<CAS-nat-orb|mo-hf>  10  17    0.69042018
<CAS-nat-orb|mo-hf>  10  18   -0.40995044
CASSCF energy = -75.6108594866192
CASCI E = -75.6108594866192  E(CI) = -17.0456439489633  S^2 = 0.0000000
Density matrix diagonal elements [1.9800333  1.65707948 1.85598587 1.85598589 0.34113618 0.14614913
 0.14614866 0.01748149]
i = 1  <i|F|i> = -11.31106939
i = 2  <i|F|i> = -11.31019888
i = 3  <i|F|i> =  -0.96268438
i = 4  <i|F|i> =  -0.45841239
i = 5  <i|F|i> =  -0.37041883
i = 6  <i|F|i> =  -0.37041885
i = 7  <i|F|i> =  -0.11158762
i = 8  <i|F|i> =   0.19163141
i = 9  <i|F|i> =   0.19163143
i = 10  <i|F|i> =   0.79754337
i = 11  <i|F|i> =   0.62262630
i = 12  <i|F|i> =   0.66936345
i = 13  <i|F|i> =   0.66936346
i = 14  <i|F|i> =   0.72582856
i = 15  <i|F|i> =   0.70705630
i = 16  <i|F|i> =   0.70705637
i = 17  <i|F|i> =   0.55625431
i = 18  <i|F|i> =   1.10800061
i = 19  <i|F|i> =   1.25778679
i = 20  <i|F|i> =   1.25778679
i = 21  <i|F|i> =   1.31172733
i = 22  <i|F|i> =   1.31172733
i = 23  <i|F|i> =   1.59396869
i = 24  <i|F|i> =   1.59396869
i = 25  <i|F|i> =   1.98602297
i = 26  <i|F|i> =   2.04215573
i = 27  <i|F|i> =   2.04215573
i = 28  <i|F|i> =   2.20477071
......production of RDMs took       1.86 sec
......reading the RDM took          0.41 sec
......production of RDMs took      25.81 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickICNEVPT2-ijrs) =    -0.00029173755907
E(WickICNEVPT2- rsi) =    -0.00093179348675
E(WickICNEVPT2- ijr) =    -0.00040326557406
E(WickICNEVPT2-  rs) =    -0.03710655733236
E(WickICNEVPT2-  ij) =    -0.00013001375874
E(WickICNEVPT2-  ir) =    -0.00122915565210
E(WickICNEVPT2-   r) =    -0.04855473598111
E(WickICNEVPT2-   i) =    -0.00026644054992
E(WickICNEVPT2) = -75.6997731865133  E_corr_pt = -0.0889136998941059
Timings = pdms =   37.84 | eris =    0.02 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.23 | ij =    0.07 | ir =    0.15 | r =    1.78 | i =    0.70 | total =   40.84
Time cost =     85.141
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:34:18 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.402319608938 AA    0.000000000000   0.000000000000   2.650000000000 Bohr   0.0

nuclear repulsion = 13.5849056603774
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.325]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2092.93


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmplkmg1oic
max_memory 4000 MB (current use 321 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.2354639903452

WARN: Singularity detected in overlap matrix (condition number =  377). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.207229697178327  LUMO (Ag) = -0.170529385107338
cycle= 1 E= -75.3434515147689  delta_E= -0.108  |g|= 0.222  |ddm|= 1.45
HOMO (B3u) = -0.458125308046683  LUMO (Ag) = -0.151008288235491
cycle= 2 E= -75.3614525114845  delta_E= -0.018  |g|= 0.052  |ddm|= 0.276
HOMO (B2u) = -0.420576044882482  LUMO (Ag) = -0.107310756967327
cycle= 3 E= -75.3623762459039  delta_E= -0.000924  |g|= 0.0104  |ddm|= 0.0554
HOMO (B2u) = -0.421573778613678  LUMO (Ag) = -0.104704594692273
cycle= 4 E= -75.3624425687672  delta_E= -6.63e-05  |g|= 0.00208  |ddm|= 0.019
HOMO (B3u) = -0.422353066342065  LUMO (Ag) = -0.10523294916925
cycle= 5 E= -75.3624454885392  delta_E= -2.92e-06  |g|= 0.000251  |ddm|= 0.00568
HOMO (B2u) = -0.422292447876759  LUMO (Ag) = -0.105149049472678
cycle= 6 E= -75.3624455277623  delta_E= -3.92e-08  |g|= 3.5e-05  |ddm|= 0.000464
HOMO (B3u) = -0.422285778696184  LUMO (Ag) = -0.105138173661535
cycle= 7 E= -75.362445528617  delta_E= -8.55e-10  |g|= 4.37e-06  |ddm|= 0.0002
HOMO (B2u) = -0.422285894464521  LUMO (Ag) = -0.105137535804996
cycle= 8 E= -75.3624455286266  delta_E= -9.63e-12  |g|= 3.96e-07  |ddm|= 2.7e-05
HOMO (B3u) = -0.422285868761357  LUMO (Ag) = -0.105137442523291
cycle= 9 E= -75.3624455286267  delta_E= -5.68e-14  |g|= 1.83e-08  |ddm|= 2.34e-06
HOMO (B3u) = -0.422285864047108  LUMO (Ag) = -0.105137442034635
cycle= 10 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 2.5e-09  |ddm|= 5.4e-08
HOMO (B2u) = -0.422285864224368  LUMO (Ag) = -0.105137442056441
cycle= 11 E= -75.3624455286268  delta_E=    0  |g|= 1.65e-09  |ddm|= 1.87e-09
HOMO (B2u) = -0.422285864468804  LUMO (Ag) = -0.105137442314399
cycle= 12 E= -75.3624455286267  delta_E= 2.84e-14  |g|= 1.38e-09  |ddm|= 9.71e-10
HOMO (B3u) = -0.422285864409527  LUMO (Ag) = -0.105137442235902
cycle= 13 E= -75.3624455286267  delta_E=    0  |g|= 1.09e-09  |ddm|= 1.17e-09
HOMO (B2u) = -0.422285864387593  LUMO (Ag) = -0.105137442189719
cycle= 14 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 9.03e-10  |ddm|= 1.05e-09
HOMO (B3u) = -0.422285864372394  LUMO (Ag) = -0.105137442174066
cycle= 15 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 7.9e-10  |ddm|= 8.87e-10
HOMO (B2u) = -0.422285864377023  LUMO (Ag) = -0.105137442219225
cycle= 16 E= -75.3624455286268  delta_E= -4.26e-14  |g|= 7.38e-10  |ddm|= 1.29e-09
HOMO (B3u) = -0.422285864307522  LUMO (Ag) = -0.105137442167945
cycle= 17 E= -75.3624455286268  delta_E= 8.53e-14  |g|= 7.59e-10  |ddm|= 5.52e-10
HOMO (B2u) = -0.422285864233045  LUMO (Ag) = -0.105137442035206
cycle= 18 E= -75.3624455286267  delta_E= 4.26e-14  |g|= 2.86e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.422285864234287  LUMO (Ag) = -0.105137442029173
cycle= 19 E= -75.3624455286268  delta_E= -1.14e-13  |g|= 2.29e-10  |ddm|= 1.9e-10
HOMO (B2u) = -0.422285864239279  LUMO (Ag) = -0.105137442029881
cycle= 20 E= -75.3624455286267  delta_E= 9.95e-14  |g|= 1.9e-10  |ddm|= 1.43e-10
HOMO (B3u) = -0.422285864248192  LUMO (Ag) = -0.105137442034913
cycle= 21 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 1.56e-10  |ddm|= 1.2e-10
HOMO (B2u) = -0.422285864254743  LUMO (Ag) = -0.105137442038674
cycle= 22 E= -75.3624455286268  delta_E= 2.84e-14  |g|= 1.3e-10  |ddm|= 9.69e-11
HOMO (B2u) = -0.422285864259437  LUMO (Ag) = -0.105137442041886
cycle= 23 E= -75.3624455286268  delta_E=    0  |g|= 1.09e-10  |ddm|= 7.56e-11
HOMO (B2u) = -0.42228586426296  LUMO (Ag) = -0.105137442043875
cycle= 24 E= -75.3624455286268  delta_E=    0  |g|= 8.92e-11  |ddm|= 5.71e-11
HOMO (B2u) = -0.42228586426567  LUMO (Ag) = -0.105137442037484
Extra cycle  E= -75.3624455286268  delta_E= -5.68e-14  |g|= 2.83e-11  |ddm|= 1.22e-10
converged SCF energy = -75.3624455286268

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmplkmg1oic
max_memory 4000 MB (current use 321 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5393906023651  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5630104601599  dE = -0.023619858  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0764
macro iter 2 (6 JK  0 micro), CASSCF E = -75.575566172623  dE = -0.012555712  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0687  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5837036694587  dE = -0.0081374968  S^2 = 0.0000000
               |grad[o]|=0.0914  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5898080852883  dE = -0.0061044158  S^2 = 0.0000000
               |grad[o]|=0.0739  |ddm|=0.0154  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5946166481792  dE = -0.0048085629  S^2 = 0.0000000
               |grad[o]|=0.0596  |ddm|=0.0101  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5983876151677  dE = -0.003770967  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00736  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6012309234095  dE = -0.0028433082  S^2 = 0.0000000
               |grad[o]|=0.036  |ddm|=0.00571  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6032054515104  dE = -0.0019745281  S^2 = 0.0000000
               |grad[o]|=0.0259  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043561327516  dE = -0.0011506812  S^2 = 0.0000000
               |grad[o]|=0.0165  |ddm|=0.00467  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6047080782072  dE = -0.00035194546  S^2 = 0.0000000
               |grad[o]|=0.00777  |ddm|=0.00509  |maxRot[o]|= 0.06
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6047337091184  dE = -2.5630911e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00437  |maxRot[o]|=0.0194
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6047340656797  dE = -3.5656133e-07  S^2 = 0.0000000
               |grad[o]|=0.000329  |ddm|=0.0016  |maxRot[o]|=0.00185
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6047340727529  dE = -7.0731687e-09  S^2 = 0.0000000
               |grad[o]|=5.38e-05  |ddm|=0.000237  |maxRot[o]|=0.00024
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6047340729173  dE = -1.644338e-10  S^2 = 0.0000000
               |grad[o]|=7.44e-06  |ddm|=3.84e-05  |maxRot[o]|=3.68e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6047340729272  dE = -9.9049657e-12  S^2 = 0.0000000
               |grad[o]|=2.27e-06  |ddm|=1.32e-05  |maxRot[o]|=6.59e-06
2-step CASSCF converged in 15 macro (74 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97916617 1.66712587 1.84789479 1.84789575 0.33219718 0.15368589
 0.15368596 0.01834841]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00560   0.00327   0.00000   0.00000  -0.00099
  0 C 2s       0.61156   0.56162   0.00000  -0.00000  -0.35247
  0 C 3s      -0.03803   0.00886   0.00000  -0.00000   0.00469
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py     -0.00000   0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34937  -0.42951  -0.00000  -0.00000   0.61119
  0 C 3px     -0.00000   0.00000  -0.00000   0.00818   0.00000
  0 C 3py     -0.00000   0.00000   0.00818  -0.00000  -0.00000
  0 C 3pz     -0.03762  -0.00286   0.00000  -0.00000  -0.04310
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.02675  -0.00000  -0.00000
  0 C 3dz^2    0.03225  -0.00101   0.00000  -0.00000   0.01829
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02675   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00560  -0.00327   0.00000   0.00000  -0.00099
  1 C 2s       0.61156  -0.56162  -0.00000   0.00000  -0.35247
  1 C 3s      -0.03803  -0.00886  -0.00000   0.00000   0.00469
  1 C 2px      0.00000  -0.00000   0.00000   0.70655  -0.00000
  1 C 2py     -0.00000  -0.00000   0.70655   0.00000   0.00000
  1 C 2pz     -0.34937  -0.42951  -0.00000  -0.00000  -0.61119
  1 C 3px      0.00000   0.00000   0.00000   0.00818  -0.00000
  1 C 3py      0.00000  -0.00000   0.00818  -0.00000   0.00000
  1 C 3pz      0.03762  -0.00286   0.00000  -0.00000   0.04310
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02675  -0.00000  -0.00000
  1 C 3dz^2    0.03225   0.00101   0.00000   0.00000   0.01829
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02675   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00047
  0 C 2s      -0.00000   0.00000   0.42887
  0 C 3s       0.00000   0.00000  -0.04326
  0 C 2px      0.70648   0.00000  -0.00000
  0 C 2py      0.00000   0.70648  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55983
  0 C 3px     -0.01896   0.00000   0.00000
  0 C 3py      0.00000  -0.01896  -0.00000
  0 C 3pz      0.00000   0.00000   0.01780
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02297  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02181
  0 C 3dxz    -0.02297   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00047
  1 C 2s      -0.00000  -0.00000  -0.42887
  1 C 3s      -0.00000  -0.00000   0.04326
  1 C 2px     -0.70648  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70648   0.00000
  1 C 2pz      0.00000  -0.00000   0.55983
  1 C 3px      0.01896  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01896   0.00000
  1 C 3pz     -0.00000   0.00000   0.01780
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02297  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02181
  1 C 3dxz    -0.02297   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99284124
<CAS-nat-orb|mo-hf>  4  4    0.99802529
<CAS-nat-orb|mo-hf>  5  5    0.99963455
<CAS-nat-orb|mo-hf>  6  6    0.99963455
<CAS-nat-orb|mo-hf>  7  7    0.97582852
<CAS-nat-orb|mo-hf>  8  8    0.95889489
<CAS-nat-orb|mo-hf>  9  9    0.95889494
<CAS-nat-orb|mo-hf>  10  10    0.59917818
<CAS-nat-orb|mo-hf>  10  17    0.68689328
CASSCF energy = -75.6047340729272
CASCI E = -75.6047340729272  E(CI) = -16.9234139258866  S^2 = 0.0000000
Density matrix diagonal elements [1.97916623 1.66712542 1.84789496 1.84789563 0.33219768 0.15368589
 0.15368578 0.0183484 ]
i = 1  <i|F|i> = -11.31561684
i = 2  <i|F|i> = -11.31492363
i = 3  <i|F|i> =  -0.95315835
i = 4  <i|F|i> =  -0.46518657
i = 5  <i|F|i> =  -0.36445882
i = 6  <i|F|i> =  -0.36445896
i = 7  <i|F|i> =  -0.10948217
i = 8  <i|F|i> =   0.17946062
i = 9  <i|F|i> =   0.17946058
i = 10  <i|F|i> =   0.75886410
i = 11  <i|F|i> =   0.62726844
i = 12  <i|F|i> =   0.67260287
i = 13  <i|F|i> =   0.67260287
i = 14  <i|F|i> =   0.72571234
i = 15  <i|F|i> =   0.70749333
i = 16  <i|F|i> =   0.70749339
i = 17  <i|F|i> =   0.55747284
i = 18  <i|F|i> =   1.10213708
i = 19  <i|F|i> =   1.26190427
i = 20  <i|F|i> =   1.26190427
i = 21  <i|F|i> =   1.29792540
i = 22  <i|F|i> =   1.29792541
i = 23  <i|F|i> =   1.58427958
i = 24  <i|F|i> =   1.58427958
i = 25  <i|F|i> =   1.96497623
i = 26  <i|F|i> =   2.02600909
i = 27  <i|F|i> =   2.02600908
i = 28  <i|F|i> =   2.18540077
......production of RDMs took       1.99 sec
......reading the RDM took          0.42 sec
......production of RDMs took      27.33 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00028781357563
E(WickICNEVPT2- rsi) =    -0.00091836221610
E(WickICNEVPT2- ijr) =    -0.00039655145231
E(WickICNEVPT2-  rs) =    -0.03666387794873
E(WickICNEVPT2-  ij) =    -0.00012469827290
E(WickICNEVPT2-  ir) =    -0.00121285399674
E(WickICNEVPT2-   r) =    -0.04933395578981
E(WickICNEVPT2-   i) =    -0.00026057316321
E(WickICNEVPT2) = -75.69393275934264  E_corr_pt = -0.08919868641542193
Timings = pdms =   39.45 | eris =    0.01 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.23 | ij =    0.07 | ir =    0.15 | r =    1.77 | i =    0.70 | total =   42.44
Time cost =     93.579
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:35:52 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.428778469484 AA    0.000000000000   0.000000000000   2.700000000000 Bohr   0.0

nuclear repulsion = 13.3333333333333
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.35]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2171.75


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpwlsn_tfw
max_memory 4000 MB (current use 323 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1946578857085

WARN: Singularity detected in overlap matrix (condition number =  348). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.199413840928996  LUMO (Ag) = -0.168263344015825
cycle= 1 E= -75.3350369843806  delta_E= -0.14  |g|= 0.225  |ddm|= 1.44
HOMO (B2u) = -0.453464888109061  LUMO (Ag) = -0.15139024066393
cycle= 2 E= -75.3537139122307  delta_E= -0.0187  |g|= 0.0519  |ddm|= 0.284
HOMO (B3u) = -0.415801083744366  LUMO (Ag) = -0.106751931948702
cycle= 3 E= -75.3546580860939  delta_E= -0.000944  |g|= 0.0108  |ddm|= 0.0549
HOMO (B2u) = -0.416822160762622  LUMO (Ag) = -0.10391543379031
cycle= 4 E= -75.3547306562047  delta_E= -7.26e-05  |g|= 0.00215  |ddm|= 0.0177
HOMO (B3u) = -0.417607675822701  LUMO (Ag) = -0.104440258456577
cycle= 5 E= -75.3547338450162  delta_E= -3.19e-06  |g|= 0.000277  |ddm|= 0.00497
HOMO (B2u) = -0.417541021758627  LUMO (Ag) = -0.104353293703204
cycle= 6 E= -75.3547338927567  delta_E= -4.77e-08  |g|= 3.68e-05  |ddm|= 0.000534
HOMO (B2u) = -0.417533919980036  LUMO (Ag) = -0.104341804406652
cycle= 7 E= -75.3547338936913  delta_E= -9.35e-10  |g|= 4.65e-06  |ddm|= 0.000197
HOMO (B2u) = -0.417533963921607  LUMO (Ag) = -0.104341084871133
cycle= 8 E= -75.3547338937025  delta_E= -1.12e-11  |g|= 4.19e-07  |ddm|= 2.62e-05
HOMO (B2u) = -0.417533935669322  LUMO (Ag) = -0.104340979663645
cycle= 9 E= -75.3547338937025  delta_E= -1.42e-14  |g|= 1.9e-08  |ddm|= 2.29e-06
HOMO (B3u) = -0.417533930414548  LUMO (Ag) = -0.104340980550985
cycle= 10 E= -75.3547338937026  delta_E= -7.11e-14  |g|= 2.65e-09  |ddm|= 5.91e-08
HOMO (B2u) = -0.41753393080534  LUMO (Ag) = -0.104340980789889
cycle= 11 E= -75.3547338937026  delta_E= -4.26e-14  |g|= 1.96e-09  |ddm|= 1.85e-09
HOMO (B2u) = -0.417533930886363  LUMO (Ag) = -0.104340980879392
cycle= 12 E= -75.3547338937025  delta_E= 8.53e-14  |g|= 1.5e-09  |ddm|= 1.71e-09
HOMO (B3u) = -0.417533930830689  LUMO (Ag) = -0.104340980797575
cycle= 13 E= -75.3547338937026  delta_E= -5.68e-14  |g|= 1.18e-09  |ddm|= 1.39e-09
HOMO (B2u) = -0.417533930794765  LUMO (Ag) = -0.104340980739553
cycle= 14 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 9.83e-10  |ddm|= 9.3e-10
HOMO (B2u) = -0.417533930774858  LUMO (Ag) = -0.104340980717674
cycle= 15 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 8.53e-10  |ddm|= 7.72e-10
HOMO (B2u) = -0.417533930785002  LUMO (Ag) = -0.104340980767868
cycle= 16 E= -75.3547338937027  delta_E= -1.14e-13  |g|= 7.87e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.417533930718251  LUMO (Ag) = -0.104340980715771
cycle= 17 E= -75.3547338937026  delta_E= 4.26e-14  |g|= 8.01e-10  |ddm|= 3.93e-10
HOMO (B2u) = -0.41753393062435  LUMO (Ag) = -0.104340980573546
cycle= 18 E= -75.3547338937026  delta_E= 4.26e-14  |g|= 3.16e-10  |ddm|= 1.48e-09
HOMO (B2u) = -0.41753393062603  LUMO (Ag) = -0.104340980567753
cycle= 19 E= -75.3547338937025  delta_E= 4.26e-14  |g|= 2.56e-10  |ddm|= 2.19e-10
HOMO (B2u) = -0.417533930636099  LUMO (Ag) = -0.1043409805724
cycle= 20 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 2.06e-10  |ddm|= 1.67e-10
HOMO (B2u) = -0.417533930645864  LUMO (Ag) = -0.104340980578077
cycle= 21 E= -75.3547338937025  delta_E= 1.42e-14  |g|= 1.68e-10  |ddm|= 1.31e-10
HOMO (B2u) = -0.417533930653068  LUMO (Ag) = -0.104340980582481
cycle= 22 E= -75.3547338937025  delta_E= 2.84e-14  |g|= 1.39e-10  |ddm|= 1.03e-10
HOMO (B2u) = -0.417533930658194  LUMO (Ag) = -0.104340980586116
cycle= 23 E= -75.3547338937025  delta_E= -1.42e-14  |g|= 1.16e-10  |ddm|= 8.48e-11
HOMO (B2u) = -0.417533930662153  LUMO (Ag) = -0.104340980588686
cycle= 24 E= -75.3547338937026  delta_E= -8.53e-14  |g|= 9.51e-11  |ddm|= 6.86e-11
HOMO (B2u) = -0.417533930666056  LUMO (Ag) = -0.104340980589446
cycle= 25 E= -75.3547338937026  delta_E= 1.42e-14  |g|= 7.33e-11  |ddm|= 4.6e-11
HOMO (B2u) = -0.417533930668315  LUMO (Ag) = -0.10434098058814
cycle= 26 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 4.98e-11  |ddm|= 5.05e-11
HOMO (B2u) = -0.417533930667279  LUMO (Ag) = -0.104340980585927
cycle= 27 E= -75.3547338937026  delta_E= -5.68e-14  |g|= 4.08e-11  |ddm|= 1.8e-11
HOMO (B3u) = -0.41753393066615  LUMO (Ag) = -0.104340980583891
cycle= 28 E= -75.3547338937026  delta_E=    0  |g|= 3.34e-11  |ddm|= 1.4e-11
HOMO (B3u) = -0.417533930663915  LUMO (Ag) = -0.104340980578512
Extra cycle  E= -75.3547338937026  delta_E= 2.84e-14  |g|= 1.11e-11  |ddm|= 4.03e-11
converged SCF energy = -75.3547338937026

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpwlsn_tfw
max_memory 4000 MB (current use 323 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5336329215188  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5570298593016  dE = -0.023396938  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0768
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5693666525342  dE = -0.012336793  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0694  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5774849618823  dE = -0.0081183093  S^2 = 0.0000000
               |grad[o]|=0.0922  |ddm|=0.0294  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5835779169566  dE = -0.0060929551  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0162  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5883468964496  dE = -0.0047689795  S^2 = 0.0000000
               |grad[o]|=0.0599  |ddm|=0.0107  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5920450999688  dE = -0.0036982035  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00775  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5947857838616  dE = -0.0027406839  S^2 = 0.0000000
               |grad[o]|=0.0356  |ddm|=0.00594  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5966321676884  dE = -0.0018463838  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00502  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5976345635032  dE = -0.0010023958  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00495  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5978367086501  dE = -0.00020214515  S^2 = 0.0000000
               |grad[o]|=0.00622  |ddm|=0.00558  |maxRot[o]|= 0.04
macro iter 11 (3 JK  0 micro), CASSCF E = -75.597867096195  dE = -3.0387545e-05  S^2 = 0.0000000
               |grad[o]|=0.00217  |ddm|=0.00321  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5978677929632  dE = -6.9676821e-07  S^2 = 0.0000000
               |grad[o]|=0.000398  |ddm|=0.00173  |maxRot[o]|=0.00283
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5978678057743  dE = -1.2811086e-08  S^2 = 0.0000000
               |grad[o]|=6.59e-05  |ddm|=0.000311  |maxRot[o]|=0.000323
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5978678060433  dE = -2.690399e-10  S^2 = 0.0000000
               |grad[o]|=1.02e-05  |ddm|=4.86e-05  |maxRot[o]|=4.75e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5978678060503  dE = -7.0201622e-12  S^2 = 0.0000000
               |grad[o]|=1.58e-06  |ddm|=8.75e-06  |maxRot[o]|=7.7e-06
2-step CASSCF converged in 15 macro (72 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97829963 1.67678201 1.83943573 1.83943619 0.32392972 0.16144632
 0.16144639 0.01922401]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00588   0.00336   0.00000   0.00000  -0.00095
  0 C 2s       0.61465   0.56857  -0.00000  -0.00000  -0.34718
  0 C 3s      -0.03607   0.00891  -0.00000   0.00000   0.00734
  0 C 2px      0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py      0.00000  -0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34438  -0.42027   0.00000   0.00000   0.61414
  0 C 3px      0.00000   0.00000  -0.00000   0.01064   0.00000
  0 C 3py      0.00000  -0.00000   0.01064   0.00000  -0.00000
  0 C 3pz     -0.03594  -0.00262  -0.00000   0.00000  -0.04307
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.02590   0.00000  -0.00000
  0 C 3dz^2    0.03130  -0.00139  -0.00000   0.00000   0.01982
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02590   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00588  -0.00336   0.00000   0.00000  -0.00095
  1 C 2s       0.61465  -0.56857   0.00000  -0.00000  -0.34718
  1 C 3s      -0.03607  -0.00891   0.00000  -0.00000   0.00734
  1 C 2px      0.00000  -0.00000   0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000   0.00000
  1 C 2pz     -0.34438  -0.42027   0.00000   0.00000  -0.61414
  1 C 3px     -0.00000   0.00000   0.00000   0.01064  -0.00000
  1 C 3py     -0.00000   0.00000   0.01064  -0.00000   0.00000
  1 C 3pz      0.03594  -0.00262  -0.00000   0.00000   0.04307
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02590   0.00000  -0.00000
  1 C 3dz^2    0.03130   0.00139   0.00000  -0.00000   0.01982
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02590   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00044
  0 C 2s      -0.00000  -0.00000   0.41964
  0 C 3s       0.00000  -0.00000  -0.04337
  0 C 2px      0.70651  -0.00000   0.00000
  0 C 2py     -0.00000   0.70651  -0.00000
  0 C 2pz      0.00000  -0.00000   0.56675
  0 C 3px     -0.01810  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01810  -0.00000
  0 C 3pz      0.00000  -0.00000   0.01881
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02276  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02148
  0 C 3dxz    -0.02276  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00044
  1 C 2s      -0.00000   0.00000  -0.41964
  1 C 3s      -0.00000   0.00000   0.04337
  1 C 2px     -0.70651   0.00000   0.00000
  1 C 2py      0.00000  -0.70651   0.00000
  1 C 2pz     -0.00000   0.00000   0.56675
  1 C 3px      0.01810   0.00000  -0.00000
  1 C 3py      0.00000   0.01810   0.00000
  1 C 3pz      0.00000  -0.00000   0.01881
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02276  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02148
  1 C 3dxz    -0.02276  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99254642
<CAS-nat-orb|mo-hf>  4  4    0.99791955
<CAS-nat-orb|mo-hf>  5  5    0.99960057
<CAS-nat-orb|mo-hf>  6  6    0.99960057
<CAS-nat-orb|mo-hf>  7  7    0.97536358
<CAS-nat-orb|mo-hf>  8  8    0.96172748
<CAS-nat-orb|mo-hf>  9  9    0.96172750
<CAS-nat-orb|mo-hf>  10  10    0.62371856
<CAS-nat-orb|mo-hf>  10  17    0.67956522
CASSCF energy = -75.5978678060503
CASCI E = -75.5978678060503  E(CI) = -16.8047461472217  S^2 = 0.0000000
Density matrix diagonal elements [1.97829949 1.67677898 1.83943634 1.83943637 0.32393208 0.16144635
 0.16144637 0.01922402]
i = 1  <i|F|i> = -11.31991257
i = 2  <i|F|i> = -11.31937357
i = 3  <i|F|i> =  -0.94381463
i = 4  <i|F|i> =  -0.47186812
i = 5  <i|F|i> =  -0.35861909
i = 6  <i|F|i> =  -0.35861910
i = 7  <i|F|i> =  -0.10735300
i = 8  <i|F|i> =   0.16777611
i = 9  <i|F|i> =   0.16777608
i = 10  <i|F|i> =   0.72227470
i = 11  <i|F|i> =   0.63169625
i = 12  <i|F|i> =   0.67557943
i = 13  <i|F|i> =   0.67557943
i = 14  <i|F|i> =   0.72607641
i = 15  <i|F|i> =   0.70791349
i = 16  <i|F|i> =   0.70791352
i = 17  <i|F|i> =   0.55892584
i = 18  <i|F|i> =   1.09643370
i = 19  <i|F|i> =   1.26615254
i = 20  <i|F|i> =   1.26615254
i = 21  <i|F|i> =   1.28498921
i = 22  <i|F|i> =   1.28498921
i = 23  <i|F|i> =   1.57489766
i = 24  <i|F|i> =   1.57489766
i = 25  <i|F|i> =   1.94231569
i = 26  <i|F|i> =   2.00980877
i = 27  <i|F|i> =   2.00980877
i = 28  <i|F|i> =   2.16919377
......production of RDMs took       1.82 sec
......reading the RDM took          0.41 sec
......production of RDMs took      24.11 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.74 sec

E(WickICNEVPT2-ijrs) =    -0.00028457826252
E(WickICNEVPT2- rsi) =    -0.00090638562486
E(WickICNEVPT2- ijr) =    -0.00038988697794
E(WickICNEVPT2-  rs) =    -0.03622319927336
E(WickICNEVPT2-  ij) =    -0.00011945177548
E(WickICNEVPT2-  ir) =    -0.00119716685142
E(WickICNEVPT2-   r) =    -0.05012406838916
E(WickICNEVPT2-   i) =    -0.00025472881159
E(WickICNEVPT2) = -75.68736727201667  E_corr_pt = -0.08949946596632855
Timings = pdms =   36.05 | eris =    0.26 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.23 | ij =    0.07 | ir =    0.15 | r =    1.77 | i =    0.70 | total =   39.29
Time cost =     83.612
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:37:16 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.455237330030 AA    0.000000000000   0.000000000000   2.750000000000 Bohr   0.0

nuclear repulsion = 13.0909090909091
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.375]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2280.02


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp7sugafx3
max_memory 4000 MB (current use 320 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1557644738047

WARN: Singularity detected in overlap matrix (condition number =  321). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.192004197271889  LUMO (Ag) = -0.16608696150487
cycle= 1 E= -75.3260871697503  delta_E= -0.17  |g|= 0.228  |ddm|= 1.44
HOMO (B3u) = -0.448902413635199  LUMO (Ag) = -0.151522743525041
cycle= 2 E= -75.3454236890815  delta_E= -0.0193  |g|= 0.0517  |ddm|= 0.291
HOMO (B3u) = -0.411143114796124  LUMO (Ag) = -0.105979877749066
cycle= 3 E= -75.3463869604458  delta_E= -0.000963  |g|= 0.0112  |ddm|= 0.0546
HOMO (B2u) = -0.412216378156835  LUMO (Ag) = -0.102966454342323
cycle= 4 E= -75.3464661736964  delta_E= -7.92e-05  |g|= 0.00221  |ddm|= 0.0168
HOMO (B3u) = -0.413005500150535  LUMO (Ag) = -0.103497081119969
cycle= 5 E= -75.3464696035284  delta_E= -3.43e-06  |g|= 0.000295  |ddm|= 0.00439
HOMO (B3u) = -0.412935226123349  LUMO (Ag) = -0.10341077061928
cycle= 6 E= -75.3464696577874  delta_E= -5.43e-08  |g|= 3.83e-05  |ddm|= 0.000585
HOMO (B2u) = -0.412927742673199  LUMO (Ag) = -0.103398722647748
cycle= 7 E= -75.346469658793  delta_E= -1.01e-09  |g|= 4.88e-06  |ddm|= 0.00019
HOMO (B3u) = -0.412927696344287  LUMO (Ag) = -0.103397915940648
cycle= 8 E= -75.3464696588055  delta_E= -1.25e-11  |g|= 4.41e-07  |ddm|= 2.55e-05
HOMO (B2u) = -0.412927666372211  LUMO (Ag) = -0.103397797537721
cycle= 9 E= -75.3464696588056  delta_E= -7.11e-14  |g|= 1.96e-08  |ddm|= 2.16e-06
HOMO (B2u) = -0.412927660626365  LUMO (Ag) = -0.103397800029289
cycle= 10 E= -75.3464696588056  delta_E= -1.42e-14  |g|= 2.79e-09  |ddm|= 6.41e-08
HOMO (B2u) = -0.412927661258026  LUMO (Ag) = -0.103397800547321
cycle= 11 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 2.25e-09  |ddm|= 1.96e-09
HOMO (B3u) = -0.412927661153122  LUMO (Ag) = -0.1033978004176
cycle= 12 E= -75.3464696588055  delta_E= -2.84e-14  |g|= 1.61e-09  |ddm|= 2.49e-09
HOMO (B2u) = -0.412927661095508  LUMO (Ag) = -0.103397800320615
cycle= 13 E= -75.3464696588056  delta_E= -5.68e-14  |g|= 1.29e-09  |ddm|= 1.42e-09
HOMO (B3u) = -0.41292766106039  LUMO (Ag) = -0.103397800268446
cycle= 14 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 1.06e-09  |ddm|= 1.04e-09
HOMO (B3u) = -0.412927661039495  LUMO (Ag) = -0.103397800245028
cycle= 15 E= -75.3464696588056  delta_E= 1.42e-14  |g|= 9.1e-10  |ddm|= 7.01e-10
HOMO (B3u) = -0.412927661045479  LUMO (Ag) = -0.103397800288465
cycle= 16 E= -75.3464696588055  delta_E= 9.95e-14  |g|= 8.36e-10  |ddm|= 1.29e-09
HOMO (B3u) = -0.412927660984872  LUMO (Ag) = -0.103397800239519
cycle= 17 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 8.37e-10  |ddm|= 2.12e-10
HOMO (B3u) = -0.412927660873002  LUMO (Ag) = -0.103397800091582
cycle= 18 E= -75.3464696588055  delta_E= -4.26e-14  |g|= 3.44e-10  |ddm|= 1.65e-09
HOMO (B3u) = -0.412927660874858  LUMO (Ag) = -0.103397800085916
cycle= 19 E= -75.3464696588056  delta_E= -4.26e-14  |g|= 2.8e-10  |ddm|= 2.47e-10
HOMO (B3u) = -0.41292766088966  LUMO (Ag) = -0.103397800094503
cycle= 20 E= -75.3464696588056  delta_E=    0  |g|= 2.21e-10  |ddm|= 1.93e-10
HOMO (B2u) = -0.412927660900076  LUMO (Ag) = -0.103397800100642
cycle= 21 E= -75.3464696588056  delta_E= -5.68e-14  |g|= 1.81e-10  |ddm|= 1.42e-10
HOMO (B3u) = -0.412927660907509  LUMO (Ag) = -0.103397800105575
cycle= 22 E= -75.3464696588055  delta_E= 1.14e-13  |g|= 1.48e-10  |ddm|= 1.12e-10
HOMO (B3u) = -0.412927660912994  LUMO (Ag) = -0.103397800109647
cycle= 23 E= -75.3464696588056  delta_E= -8.53e-14  |g|= 1.22e-10  |ddm|= 9.18e-11
HOMO (B3u) = -0.412927660917522  LUMO (Ag) = -0.103397800112985
cycle= 24 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 1e-10  |ddm|= 7.82e-11
HOMO (B3u) = -0.412927660921766  LUMO (Ag) = -0.103397800114464
cycle= 25 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 7.74e-11  |ddm|= 5.4e-11
HOMO (B3u) = -0.412927660924352  LUMO (Ag) = -0.103397800113939
cycle= 26 E= -75.3464696588055  delta_E= -4.26e-14  |g|= 5.33e-11  |ddm|= 5.66e-11
HOMO (B3u) = -0.412927660923119  LUMO (Ag) = -0.103397800111535
cycle= 27 E= -75.3464696588055  delta_E= 4.26e-14  |g|= 4.34e-11  |ddm|= 2.04e-11
HOMO (B3u) = -0.412927660921774  LUMO (Ag) = -0.103397800109291
cycle= 28 E= -75.3464696588056  delta_E= -9.95e-14  |g|= 3.53e-11  |ddm|= 1.58e-11
HOMO (B2u) = -0.412927660920841  LUMO (Ag) = -0.103397800107649
cycle= 29 E= -75.3464696588055  delta_E= 9.95e-14  |g|= 2.88e-11  |ddm|= 1.23e-11
HOMO (B2u) = -0.412927660920185  LUMO (Ag) = -0.103397800106411
cycle= 30 E= -75.3464696588055  delta_E= -2.84e-14  |g|= 2.34e-11  |ddm|= 9.87e-12
HOMO (B2u) = -0.412927660919743  LUMO (Ag) = -0.103397800105449
cycle= 31 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 1.89e-11  |ddm|= 8.1e-12
HOMO (B2u) = -0.412927660919472  LUMO (Ag) = -0.10339780010468
cycle= 32 E= -75.3464696588056  delta_E= -9.95e-14  |g|= 1.51e-11  |ddm|= 6.82e-12
HOMO (B2u) = -0.412927660919342  LUMO (Ag) = -0.103397800104065
cycle= 33 E= -75.3464696588056  delta_E= -4.26e-14  |g|= 1.19e-11  |ddm|= 5.91e-12
HOMO (B2u) = -0.412927660919344  LUMO (Ag) = -0.103397800103667
cycle= 34 E= -75.3464696588055  delta_E= 8.53e-14  |g|= 9.43e-12  |ddm|= 4.78e-12
HOMO (B2u) = -0.412927660919423  LUMO (Ag) = -0.103397800103461
cycle= 35 E= -75.3464696588055  delta_E= -1.42e-14  |g|= 7.71e-12  |ddm|= 3.54e-12
HOMO (B2u) = -0.412927660919465  LUMO (Ag) = -0.103397800103269
cycle= 36 E= -75.3464696588055  delta_E= -1.42e-14  |g|= 6.3e-12  |ddm|= 3.04e-12
HOMO (B2u) = -0.412927660919475  LUMO (Ag) = -0.103397800103085
cycle= 37 E= -75.3464696588055  delta_E= 7.11e-14  |g|= 5.14e-12  |ddm|= 2.58e-12
HOMO (B2u) = -0.412927660919465  LUMO (Ag) = -0.103397800102912
cycle= 38 E= -75.3464696588056  delta_E= -1.14e-13  |g|= 4.18e-12  |ddm|= 2.18e-12
HOMO (B2u) = -0.412927660919444  LUMO (Ag) = -0.103397800102752
cycle= 39 E= -75.3464696588055  delta_E= 7.11e-14  |g|= 3.39e-12  |ddm|= 1.86e-12
HOMO (B2u) = -0.412927660919417  LUMO (Ag) = -0.103397800102607
cycle= 40 E= -75.3464696588055  delta_E=    0  |g|= 2.75e-12  |ddm|= 1.61e-12
HOMO (B2u) = -0.412927660919315  LUMO (Ag) = -0.103397800102167
Extra cycle  E= -75.3464696588056  delta_E= -1.14e-13  |g|= 9.97e-13  |ddm|= 5.02e-12
converged SCF energy = -75.3464696588056

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp7sugafx3
max_memory 4000 MB (current use 320 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5273817495036  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5505812895231  dE = -0.02319954  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0789
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5627423957471  dE = -0.012161106  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5708416789258  dE = -0.0080992832  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0298  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.576911425564  dE = -0.0060697466  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0169  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5816202918561  dE = -0.0047088663  S^2 = 0.0000000
               |grad[o]|=0.0598  |ddm|=0.0112  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.585218014268  dE = -0.0035977224  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.00806  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.587822096899  dE = -0.0026040826  S^2 = 0.0000000
               |grad[o]|=0.0347  |ddm|=0.00612  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5895016097381  dE = -0.0016795128  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5903141997755  dE = -0.00081259004  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.00535  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5904157790265  dE = -0.00010157925  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.00625  |maxRot[o]|=0.0374
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5904169954666  dE = -1.2164401e-06  S^2 = 0.0000000
               |grad[o]|=0.000611  |ddm|=0.00344  |maxRot[o]|=0.00344
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5904170207647  dE = -2.5298121e-08  S^2 = 0.0000000
               |grad[o]|=9.15e-05  |ddm|=0.000453  |maxRot[o]|=0.000415
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5904170213121  dE = -5.4734528e-10  S^2 = 0.0000000
               |grad[o]|=1.51e-05  |ddm|=6.86e-05  |maxRot[o]|=6.34e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5904170213273  dE = -1.5205615e-11  S^2 = 0.0000000
               |grad[o]|=2.37e-06  |ddm|=1.28e-05  |maxRot[o]|=1.1e-05
2-step CASSCF converged in 14 macro (69 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97743796 1.68610721 1.83058145 1.83058041 0.31631683 0.16943524
 0.16943537 0.02010553]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00615   0.00344   0.00000   0.00000  -0.00091
  0 C 2s       0.61773   0.57533   0.00000  -0.00000  -0.34180
  0 C 3s      -0.03411   0.00898  -0.00000  -0.00000   0.00990
  0 C 2px      0.00000  -0.00000  -0.00000   0.70654  -0.00000
  0 C 2py     -0.00000   0.00000   0.70654  -0.00000  -0.00000
  0 C 2pz      0.33928  -0.41097  -0.00000  -0.00000   0.61707
  0 C 3px     -0.00000  -0.00000   0.00000   0.01297  -0.00000
  0 C 3py      0.00000  -0.00000   0.01297   0.00000  -0.00000
  0 C 3pz     -0.03426  -0.00242  -0.00000  -0.00000  -0.04286
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02505   0.00000  -0.00000
  0 C 3dz^2    0.03040  -0.00175  -0.00000  -0.00000   0.02149
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02505  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00615  -0.00344   0.00000   0.00000  -0.00091
  1 C 2s       0.61773  -0.57533  -0.00000   0.00000  -0.34180
  1 C 3s      -0.03411  -0.00898   0.00000   0.00000   0.00990
  1 C 2px      0.00000   0.00000  -0.00000   0.70654  -0.00000
  1 C 2py      0.00000   0.00000   0.70654  -0.00000   0.00000
  1 C 2pz     -0.33928  -0.41097  -0.00000   0.00000  -0.61707
  1 C 3px     -0.00000   0.00000   0.00000   0.01297   0.00000
  1 C 3py      0.00000  -0.00000   0.01297  -0.00000   0.00000
  1 C 3pz      0.03426  -0.00242  -0.00000  -0.00000   0.04286
  1 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02505   0.00000  -0.00000
  1 C 3dz^2    0.03040   0.00175   0.00000   0.00000   0.02149
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02505  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s      -0.00000   0.00000   0.41035
  0 C 3s      -0.00000  -0.00000  -0.04345
  0 C 2px      0.70654   0.00000  -0.00000
  0 C 2py     -0.00000   0.70654  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.57349
  0 C 3px     -0.01725  -0.00000   0.00000
  0 C 3py     -0.00000  -0.01725  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01967
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02253  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02125
  0 C 3dxz    -0.02253  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.41035
  1 C 3s       0.00000   0.00000   0.04345
  1 C 2px     -0.70654   0.00000  -0.00000
  1 C 2py      0.00000  -0.70654   0.00000
  1 C 2pz      0.00000   0.00000   0.57349
  1 C 3px      0.01725  -0.00000   0.00000
  1 C 3py      0.00000   0.01725   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01967
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02253  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02125
  1 C 3dxz    -0.02253   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99226092
<CAS-nat-orb|mo-hf>  4  4    0.99781292
<CAS-nat-orb|mo-hf>  5  5    0.99956408
<CAS-nat-orb|mo-hf>  6  6    0.99956408
<CAS-nat-orb|mo-hf>  7  7    0.97493010
<CAS-nat-orb|mo-hf>  8  8    0.96431698
<CAS-nat-orb|mo-hf>  9  9    0.96431697
<CAS-nat-orb|mo-hf>  10  10    0.64879987
<CAS-nat-orb|mo-hf>  10  17    0.66873221
CASSCF energy = -75.5904170213273
CASCI E = -75.5904170213273  E(CI) = -16.6895622816505  S^2 = 0.0000000
Density matrix diagonal elements [1.97743766 1.68610189 1.83058286 1.83058159 0.31631925 0.16943545
 0.16943573 0.02010557]
i = 1  <i|F|i> = -11.32394820
i = 2  <i|F|i> = -11.32354456
i = 3  <i|F|i> =  -0.93467424
i = 4  <i|F|i> =  -0.47847007
i = 5  <i|F|i> =  -0.35288569
i = 6  <i|F|i> =  -0.35288545
i = 7  <i|F|i> =  -0.10520179
i = 8  <i|F|i> =   0.15655395
i = 9  <i|F|i> =   0.15655387
i = 10  <i|F|i> =   0.68769342
i = 11  <i|F|i> =   0.63589216
i = 12  <i|F|i> =   0.67829196
i = 13  <i|F|i> =   0.67829196
i = 14  <i|F|i> =   0.72693411
i = 15  <i|F|i> =   0.70832789
i = 16  <i|F|i> =   0.70832788
i = 17  <i|F|i> =   0.56059880
i = 18  <i|F|i> =   1.09089247
i = 19  <i|F|i> =   1.27051277
i = 20  <i|F|i> =   1.27051277
i = 21  <i|F|i> =   1.27294207
i = 22  <i|F|i> =   1.27294205
i = 23  <i|F|i> =   1.56582295
i = 24  <i|F|i> =   1.56582295
i = 25  <i|F|i> =   1.91821587
i = 26  <i|F|i> =   1.99353864
i = 27  <i|F|i> =   1.99353866
i = 28  <i|F|i> =   2.15583957
......production of RDMs took       2.34 sec
......reading the RDM took          0.41 sec
......production of RDMs took      25.29 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickICNEVPT2-ijrs) =    -0.00028193247586
E(WickICNEVPT2- rsi) =    -0.00089574470633
E(WickICNEVPT2- ijr) =    -0.00038327319360
E(WickICNEVPT2-  rs) =    -0.03578700836689
E(WickICNEVPT2-  ij) =    -0.00011430832505
E(WickICNEVPT2-  ir) =    -0.00118209904486
E(WickICNEVPT2-   r) =    -0.05092515192345
E(WickICNEVPT2-   i) =    -0.00024889969971
E(WickICNEVPT2) = -75.68023543906304  E_corr_pt = -0.08981841773575354
Timings = pdms =   37.80 | eris =    0.03 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.23 | ij =    0.07 | ir =    0.15 | r =    1.97 | i =    0.75 | total =   41.05
Time cost =    163.877
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:40:00 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.481696190576 AA    0.000000000000   0.000000000000   2.800000000000 Bohr   0.0

nuclear repulsion = 12.8571428571429
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.4]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2448.81


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpsmy_xr19
max_memory 4000 MB (current use 322 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1187592585641

WARN: Singularity detected in overlap matrix (condition number =  297). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.184977014444633  LUMO (Ag) = -0.163989710542375
cycle= 1 E= -75.3167358242477  delta_E= -0.198  |g|= 0.231  |ddm|= 1.44
HOMO (B3u) = -0.444434359277164  LUMO (Ag) = -0.15141696369634
cycle= 2 E= -75.3367114409982  delta_E= -0.02  |g|= 0.0515  |ddm|= 0.298
HOMO (B2u) = -0.406594326641877  LUMO (Ag) = -0.105005000614388
cycle= 3 E= -75.3376920455643  delta_E= -0.000981  |g|= 0.0117  |ddm|= 0.0545
HOMO (B2u) = -0.407746719644285  LUMO (Ag) = -0.101871698894467
cycle= 4 E= -75.3377779901322  delta_E= -8.59e-05  |g|= 0.00225  |ddm|= 0.0162
HOMO (B2u) = -0.408536003811461  LUMO (Ag) = -0.102414153547261
cycle= 5 E= -75.3377816192104  delta_E= -3.63e-06  |g|= 0.000309  |ddm|= 0.00396
HOMO (B2u) = -0.408464040126319  LUMO (Ag) = -0.102331174534053
cycle= 6 E= -75.3377816780684  delta_E= -5.89e-08  |g|= 3.95e-05  |ddm|= 0.000618
HOMO (B2u) = -0.40845625601887  LUMO (Ag) = -0.102318677176297
cycle= 7 E= -75.3377816791323  delta_E= -1.06e-09  |g|= 5.06e-06  |ddm|= 0.00018
HOMO (B2u) = -0.408456106236035  LUMO (Ag) = -0.102317785563318
cycle= 8 E= -75.337781679146  delta_E= -1.38e-11  |g|= 4.62e-07  |ddm|= 2.48e-05
HOMO (B3u) = -0.40845607514401  LUMO (Ag) = -0.102317652726058
cycle= 9 E= -75.337781679146  delta_E=    0  |g|= 2.02e-08  |ddm|= 1.99e-06
HOMO (B3u) = -0.408456068963824  LUMO (Ag) = -0.102317657025672
cycle= 10 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 2.92e-09  |ddm|= 6.88e-08
HOMO (B2u) = -0.408456069765084  LUMO (Ag) = -0.102317657749991
cycle= 11 E= -75.3377816791461  delta_E= 5.68e-14  |g|= 2.42e-09  |ddm|= 2.5e-09
HOMO (B3u) = -0.408456069554476  LUMO (Ag) = -0.102317657488081
cycle= 12 E= -75.3377816791461  delta_E=    0  |g|= 1.71e-09  |ddm|= 2.74e-09
HOMO (B3u) = -0.408456069502259  LUMO (Ag) = -0.102317657381637
cycle= 13 E= -75.3377816791461  delta_E= -1.42e-14  |g|= 1.38e-09  |ddm|= 1.49e-09
HOMO (B3u) = -0.408456069459979  LUMO (Ag) = -0.102317657325152
cycle= 14 E= -75.3377816791461  delta_E= 2.84e-14  |g|= 1.14e-09  |ddm|= 1.01e-09
HOMO (B3u) = -0.40845606943648  LUMO (Ag) = -0.102317657299904
cycle= 15 E= -75.3377816791461  delta_E=    0  |g|= 9.69e-10  |ddm|= 6.25e-10
HOMO (B3u) = -0.408456069440299  LUMO (Ag) = -0.10231765733699
cycle= 16 E= -75.3377816791461  delta_E= -7.11e-14  |g|= 8.82e-10  |ddm|= 1.21e-09
HOMO (B3u) = -0.408456069386909  LUMO (Ag) = -0.102317657293197
cycle= 17 E= -75.3377816791461  delta_E= 7.11e-14  |g|= 8.66e-10  |ddm|= 8.98e-11
HOMO (B3u) = -0.408456069259124  LUMO (Ag) = -0.102317657143647
cycle= 18 E= -75.3377816791461  delta_E= -7.11e-14  |g|= 3.65e-10  |ddm|= 1.82e-09
HOMO (B3u) = -0.408456069260906  LUMO (Ag) = -0.102317657137976
cycle= 19 E= -75.3377816791462  delta_E= -2.84e-14  |g|= 2.99e-10  |ddm|= 2.73e-10
HOMO (B3u) = -0.408456069278291  LUMO (Ag) = -0.102317657148884
cycle= 20 E= -75.3377816791461  delta_E= 7.11e-14  |g|= 2.35e-10  |ddm|= 2.07e-10
HOMO (B3u) = -0.408456069289289  LUMO (Ag) = -0.102317657155422
cycle= 21 E= -75.337781679146  delta_E= 4.26e-14  |g|= 1.92e-10  |ddm|= 1.5e-10
HOMO (B3u) = -0.408456069297002  LUMO (Ag) = -0.102317657160938
cycle= 22 E= -75.337781679146  delta_E= 2.84e-14  |g|= 1.57e-10  |ddm|= 1.18e-10
HOMO (B3u) = -0.408456069302688  LUMO (Ag) = -0.102317657165434
cycle= 23 E= -75.3377816791461  delta_E= -1.14e-13  |g|= 1.28e-10  |ddm|= 9.79e-11
HOMO (B3u) = -0.408456069307707  LUMO (Ag) = -0.10231765716959
cycle= 24 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 1.04e-10  |ddm|= 8.79e-11
HOMO (B2u) = -0.408456069312271  LUMO (Ag) = -0.102317657171944
cycle= 25 E= -75.3377816791461  delta_E=    0  |g|= 8.07e-11  |ddm|= 6.34e-11
HOMO (B2u) = -0.408456069309945  LUMO (Ag) = -0.102317657164423
Extra cycle  E= -75.337781679146  delta_E= 7.11e-14  |g|= 2.49e-11  |ddm|= 1.27e-10
converged SCF energy = -75.337781679146

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpsmy_xr19
max_memory 4000 MB (current use 322 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5207710561407  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5435858178725  dE = -0.022814762  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5556863536553  dE = -0.012100536  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5638012283037  dE = -0.0081148746  S^2 = 0.0000000
               |grad[o]|=0.0929  |ddm|=0.0305  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5698554857246  dE = -0.0060542574  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0176  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5744974578813  dE = -0.0046419722  S^2 = 0.0000000
               |grad[o]|=0.0595  |ddm|=0.0117  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5779785033124  dE = -0.0034810454  S^2 = 0.0000000
               |grad[o]|=0.0458  |ddm|=0.00833  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5804227194731  dE = -0.0024442162  S^2 = 0.0000000
               |grad[o]|=0.0334  |ddm|=0.00629  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5819072097378  dE = -0.0014844903  S^2 = 0.0000000
               |grad[o]|=0.0219  |ddm|=0.00549  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5824311518786  dE = -0.00052394214  S^2 = 0.0000000
               |grad[o]|=0.0112  |ddm|=0.00592  |maxRot[o]|= 0.06
macro iter 10 (4 JK  0 micro), CASSCF E = -75.582517888629  dE = -8.673675e-05  S^2 = 0.0000000
               |grad[o]|=0.00395  |ddm|=0.00526  |maxRot[o]|=0.0339
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5825189143669  dE = -1.0257379e-06  S^2 = 0.0000000
               |grad[o]|=0.00057  |ddm|=0.00341  |maxRot[o]|=0.00308
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5825189359808  dE = -2.16139e-08  S^2 = 0.0000000
               |grad[o]|=8.53e-05  |ddm|=0.000437  |maxRot[o]|=0.000367
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5825189364279  dE = -4.4711612e-10  S^2 = 0.0000000
               |grad[o]|=1.4e-05  |ddm|=6.12e-05  |maxRot[o]|=5.56e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5825189364314  dE = -3.4816594e-12  S^2 = 0.0000000
               |grad[o]|=1.99e-06  |ddm|=1.03e-05  |maxRot[o]|=9.54e-06
2-step CASSCF converged in 14 macro (68 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97658606 1.69515621 1.82129742 1.82129801 0.3093552  0.17765826
 0.17765866 0.02099018]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00641   0.00352   0.00000   0.00000  -0.00088
  0 C 2s       0.62079   0.58190   0.00000  -0.00000  -0.33633
  0 C 3s      -0.03214   0.00906   0.00000  -0.00000   0.01238
  0 C 2px     -0.00000   0.00000  -0.00000   0.70653   0.00000
  0 C 2py      0.00000  -0.00000   0.70653   0.00000  -0.00000
  0 C 2pz      0.33407  -0.40161   0.00000   0.00000   0.61999
  0 C 3px     -0.00000  -0.00000  -0.00000   0.01517  -0.00000
  0 C 3py      0.00000  -0.00000   0.01517   0.00000  -0.00000
  0 C 3pz     -0.03258  -0.00225   0.00000   0.00000  -0.04249
  0 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02420   0.00000  -0.00000
  0 C 3dz^2    0.02955  -0.00209   0.00000  -0.00000   0.02326
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.02420  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00641  -0.00352   0.00000   0.00000  -0.00088
  1 C 2s       0.62079  -0.58190  -0.00000  -0.00000  -0.33633
  1 C 3s      -0.03214  -0.00906  -0.00000   0.00000   0.01238
  1 C 2px      0.00000   0.00000   0.00000   0.70653   0.00000
  1 C 2py     -0.00000   0.00000   0.70653   0.00000  -0.00000
  1 C 2pz     -0.33407  -0.40161   0.00000  -0.00000  -0.61999
  1 C 3px      0.00000  -0.00000   0.00000   0.01517  -0.00000
  1 C 3py     -0.00000   0.00000   0.01517  -0.00000   0.00000
  1 C 3pz      0.03258  -0.00225   0.00000  -0.00000   0.04249
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02420   0.00000  -0.00000
  1 C 3dz^2    0.02955   0.00209  -0.00000   0.00000   0.02326
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02420   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000   0.00000   0.40101
  0 C 3s      -0.00000  -0.00000  -0.04346
  0 C 2px      0.70657  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70657   0.00000
  0 C 2pz     -0.00000   0.00000   0.58004
  0 C 3px     -0.01641  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01641  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02037
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02228  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02106
  0 C 3dxz    -0.02228  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s       0.00000   0.00000  -0.40101
  1 C 3s       0.00000  -0.00000   0.04346
  1 C 2px     -0.70657   0.00000   0.00000
  1 C 2py      0.00000  -0.70657   0.00000
  1 C 2pz     -0.00000   0.00000   0.58004
  1 C 3px      0.01641   0.00000   0.00000
  1 C 3py      0.00000   0.01641  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02037
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02228   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02106
  1 C 3dxz    -0.02228  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99198874
<CAS-nat-orb|mo-hf>  4  4    0.99770782
<CAS-nat-orb|mo-hf>  5  5    0.99952508
<CAS-nat-orb|mo-hf>  6  6    0.99952508
<CAS-nat-orb|mo-hf>  7  7    0.97453484
<CAS-nat-orb|mo-hf>  8  8    0.96668730
<CAS-nat-orb|mo-hf>  9  9    0.96668736
<CAS-nat-orb|mo-hf>  10  10    0.67408746
<CAS-nat-orb|mo-hf>  10  17    0.65475223
CASSCF energy = -75.5825189364314
CASCI E = -75.5825189364314  E(CI) = -16.5777815975582  S^2 = 0.0000000
Density matrix diagonal elements [1.97658597 1.69515468 1.82129794 1.82129974 0.30935478 0.17765841
 0.1776583  0.02099018]
i = 1  <i|F|i> = -11.32771811
i = 2  <i|F|i> = -11.32743437
i = 3  <i|F|i> =  -0.92575498
i = 4  <i|F|i> =  -0.48500486
i = 5  <i|F|i> =  -0.34724388
i = 6  <i|F|i> =  -0.34724422
i = 7  <i|F|i> =  -0.10303479
i = 8  <i|F|i> =   0.14577199
i = 9  <i|F|i> =   0.14577198
i = 10  <i|F|i> =   0.65503726
i = 11  <i|F|i> =   0.63984566
i = 12  <i|F|i> =   0.68073953
i = 13  <i|F|i> =   0.68073953
i = 14  <i|F|i> =   0.72829309
i = 15  <i|F|i> =   0.70874630
i = 16  <i|F|i> =   0.70874638
i = 17  <i|F|i> =   0.56247274
i = 18  <i|F|i> =   1.08551612
i = 19  <i|F|i> =   1.26180562
i = 20  <i|F|i> =   1.26180564
i = 21  <i|F|i> =   1.27496608
i = 22  <i|F|i> =   1.27496608
i = 23  <i|F|i> =   1.55705516
i = 24  <i|F|i> =   1.55705516
i = 25  <i|F|i> =   1.89286220
i = 26  <i|F|i> =   1.97719264
i = 27  <i|F|i> =   1.97719261
i = 28  <i|F|i> =   2.14505729
......production of RDMs took       1.87 sec
......reading the RDM took          0.42 sec
......production of RDMs took      23.61 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickICNEVPT2-ijrs) =    -0.00027980145968
E(WickICNEVPT2- rsi) =    -0.00088634169779
E(WickICNEVPT2- ijr) =    -0.00037672365992
E(WickICNEVPT2-  rs) =    -0.03535770937755
E(WickICNEVPT2-  ij) =    -0.00010929455633
E(WickICNEVPT2-  ir) =    -0.00116766094059
E(WickICNEVPT2-   r) =    -0.05173594341955
E(WickICNEVPT2-   i) =    -0.00024307898843
E(WickICNEVPT2) = -75.67267549053122  E_corr_pt = -0.09015655409983259
Timings = pdms =   35.65 | eris =    0.05 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.16 | r =    2.06 | i =    0.82 | total =   39.13
Time cost =     87.528
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:41:27 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.508155051122 AA    0.000000000000   0.000000000000   2.850000000000 Bohr   0.0

nuclear repulsion = 12.6315789473684
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.425]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2530.63


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpup63l_qw
max_memory 4000 MB (current use 317 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0836082427711

WARN: Singularity detected in overlap matrix (condition number =  275). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.178310042866846  LUMO (Ag) = -0.161961845746924
cycle= 1 E= -75.3070977055452  delta_E= -0.223  |g|= 0.234  |ddm|= 1.43
HOMO (B3u) = -0.440057963112902  LUMO (Ag) = -0.151084704136084
cycle= 2 E= -75.3276882495978  delta_E= -0.0206  |g|= 0.0513  |ddm|= 0.304
HOMO (B3u) = -0.402148496278865  LUMO (Ag) = -0.103839161942738
cycle= 3 E= -75.3286840635261  delta_E= -0.000996  |g|= 0.0121  |ddm|= 0.0544
HOMO (B3u) = -0.40340473923216  LUMO (Ag) = -0.100645294675409
cycle= 4 E= -75.3287765426505  delta_E= -9.25e-05  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.404190054526265  LUMO (Ag) = -0.101202470957947
cycle= 5 E= -75.3287803215959  delta_E= -3.78e-06  |g|= 0.000318  |ddm|= 0.00364
HOMO (B2u) = -0.404117903551409  LUMO (Ag) = -0.10112470506654
cycle= 6 E= -75.3287803833538  delta_E= -6.18e-08  |g|= 4.04e-05  |ddm|= 0.000637
HOMO (B3u) = -0.404109925173544  LUMO (Ag) = -0.101111910622253
cycle= 7 E= -75.3287803844587  delta_E= -1.1e-09  |g|= 5.18e-06  |ddm|= 0.000169
HOMO (B2u) = -0.404109663968696  LUMO (Ag) = -0.101110942652342
cycle= 8 E= -75.3287803844733  delta_E= -1.46e-11  |g|= 4.83e-07  |ddm|= 2.4e-05
HOMO (B3u) = -0.404109632109878  LUMO (Ag) = -0.101110794247843
cycle= 9 E= -75.3287803844734  delta_E= -8.53e-14  |g|= 2.07e-08  |ddm|= 1.8e-06
HOMO (B3u) = -0.404109625552917  LUMO (Ag) = -0.101110800522626
cycle= 10 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 3.06e-09  |ddm|= 7.31e-08
HOMO (B2u) = -0.404109626471967  LUMO (Ag) = -0.101110801398531
cycle= 11 E= -75.3287803844733  delta_E=    0  |g|= 2.51e-09  |ddm|= 3.11e-09
HOMO (B2u) = -0.404109626201608  LUMO (Ag) = -0.101110801058637
cycle= 12 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 1.79e-09  |ddm|= 2.71e-09
HOMO (B2u) = -0.404109626163897  LUMO (Ag) = -0.101110800945878
cycle= 13 E= -75.3287803844734  delta_E= 4.26e-14  |g|= 1.48e-09  |ddm|= 1.6e-09
HOMO (B2u) = -0.404109626115953  LUMO (Ag) = -0.101110800888829
cycle= 14 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 1.23e-09  |ddm|= 9.94e-10
HOMO (B3u) = -0.404109626089659  LUMO (Ag) = -0.101110800862319
cycle= 15 E= -75.3287803844734  delta_E= -8.53e-14  |g|= 1.04e-09  |ddm|= 6.13e-10
HOMO (B2u) = -0.404109626085114  LUMO (Ag) = -0.10111080088874
cycle= 16 E= -75.3287803844733  delta_E= 5.68e-14  |g|= 9.48e-10  |ddm|= 1.08e-09
HOMO (B2u) = -0.404109626047519  LUMO (Ag) = -0.10111080085625
cycle= 17 E= -75.3287803844733  delta_E= -2.84e-14  |g|= 8.95e-10  |ddm|= 2.18e-10
HOMO (B2u) = -0.404109625906487  LUMO (Ag) = -0.101110800709383
cycle= 18 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 3.85e-10  |ddm|= 1.99e-09
HOMO (B2u) = -0.404109625907978  LUMO (Ag) = -0.101110800703584
cycle= 19 E= -75.3287803844734  delta_E= 4.26e-14  |g|= 3.16e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.404109625926527  LUMO (Ag) = -0.101110800715775
cycle= 20 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 2.5e-10  |ddm|= 2.16e-10
HOMO (B3u) = -0.404109625937812  LUMO (Ag) = -0.101110800722489
cycle= 21 E= -75.3287803844734  delta_E= -8.53e-14  |g|= 2.04e-10  |ddm|= 1.59e-10
HOMO (B3u) = -0.40410962594554  LUMO (Ag) = -0.10111080072857
cycle= 22 E= -75.3287803844734  delta_E= -2.84e-14  |g|= 1.66e-10  |ddm|= 1.23e-10
HOMO (B3u) = -0.404109625951271  LUMO (Ag) = -0.101110800733468
cycle= 23 E= -75.3287803844733  delta_E= 5.68e-14  |g|= 1.35e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.404109625956676  LUMO (Ag) = -0.10111080073845
cycle= 24 E= -75.3287803844734  delta_E= -1.42e-14  |g|= 1.09e-10  |ddm|= 9.76e-11
HOMO (B2u) = -0.40410962596132  LUMO (Ag) = -0.101110800741477
cycle= 25 E= -75.3287803844733  delta_E= 1.42e-14  |g|= 8.4e-11  |ddm|= 7.46e-11
HOMO (B3u) = -0.404109625964657  LUMO (Ag) = -0.101110800743059
cycle= 26 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 5.92e-11  |ddm|= 7.01e-11
HOMO (B3u) = -0.404109625963265  LUMO (Ag) = -0.101110800740647
cycle= 27 E= -75.3287803844734  delta_E= -2.84e-14  |g|= 4.81e-11  |ddm|= 2.48e-11
HOMO (B2u) = -0.404109625961693  LUMO (Ag) = -0.101110800738323
cycle= 28 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 3.88e-11  |ddm|= 1.88e-11
HOMO (B2u) = -0.404109625960619  LUMO (Ag) = -0.101110800736731
cycle= 29 E= -75.3287803844734  delta_E= -1.42e-14  |g|= 3.14e-11  |ddm|= 1.47e-11
HOMO (B2u) = -0.40410962595982  LUMO (Ag) = -0.101110800735585
cycle= 30 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 2.52e-11  |ddm|= 1.17e-11
HOMO (B3u) = -0.40410962595928  LUMO (Ag) = -0.101110800734741
cycle= 31 E= -75.3287803844733  delta_E= 1.14e-13  |g|= 2.02e-11  |ddm|= 9.43e-12
HOMO (B2u) = -0.404109625958937  LUMO (Ag) = -0.101110800734111
cycle= 32 E= -75.3287803844733  delta_E=    0  |g|= 1.61e-11  |ddm|= 7.47e-12
HOMO (B3u) = -0.404109625958851  LUMO (Ag) = -0.101110800732996
Extra cycle  E= -75.3287803844733  delta_E= -5.68e-14  |g|= 5.27e-12  |ddm|= 1.88e-11
converged SCF energy = -75.3287803844733

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpup63l_qw
max_memory 4000 MB (current use 317 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5139143945433  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5362301908139  dE = -0.022315796  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.548339880982  dE = -0.01210969  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0695  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5564887719849  dE = -0.008148891  S^2 = 0.0000000
               |grad[o]|=0.0932  |ddm|=0.0312  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.562526237471  dE = -0.0060374655  S^2 = 0.0000000
               |grad[o]|=0.0747  |ddm|=0.0183  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5670881352969  dE = -0.0045618978  S^2 = 0.0000000
               |grad[o]|=0.0588  |ddm|=0.0122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.570431354928  dE = -0.0033432196  S^2 = 0.0000000
               |grad[o]|=0.0446  |ddm|=0.00858  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5726887962906  dE = -0.0022574414  S^2 = 0.0000000
               |grad[o]|=0.0317  |ddm|=0.00647  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5739475221515  dE = -0.0012587259  S^2 = 0.0000000
               |grad[o]|=0.0197  |ddm|=0.00591  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5742840857051  dE = -0.00033656355  S^2 = 0.0000000
               |grad[o]|=0.00857  |ddm|=0.00674  |maxRot[o]|= 0.06
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5742936841768  dE = -9.5984717e-06  S^2 = 0.0000000
               |grad[o]|=0.00138  |ddm|=0.00615  |maxRot[o]|=0.0106
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5742938473245  dE = -1.6314766e-07  S^2 = 0.0000000
               |grad[o]|=0.00024  |ddm|=0.00135  |maxRot[o]|=0.00105
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5742938504641  dE = -3.1396041e-09  S^2 = 0.0000000
               |grad[o]|=3.74e-05  |ddm|=0.000171  |maxRot[o]|=0.00015
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5742938505334  dE = -6.9320549e-11  S^2 = 0.0000000
               |grad[o]|=4.73e-06  |ddm|=2.25e-05  |maxRot[o]|=2.25e-05
2-step CASSCF converged in 13 macro (65 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97574992 1.70399847 1.81154522 1.81154426 0.30304426 0.18612138
 0.1861214  0.02187509]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00665   0.00360   0.00000   0.00000  -0.00085
  0 C 2s       0.62384   0.58827  -0.00000   0.00000  -0.33076
  0 C 3s      -0.03017   0.00916   0.00000   0.00000   0.01475
  0 C 2px      0.00000  -0.00000  -0.00000   0.70651  -0.00000
  0 C 2py      0.00000  -0.00000   0.70651  -0.00000   0.00000
  0 C 2pz      0.32876  -0.39221   0.00000  -0.00000   0.62289
  0 C 3px      0.00000  -0.00000   0.00000   0.01725  -0.00000
  0 C 3py      0.00000  -0.00000   0.01725   0.00000   0.00000
  0 C 3pz     -0.03092  -0.00212   0.00000   0.00000  -0.04192
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02335   0.00000   0.00000
  0 C 3dz^2    0.02875  -0.00240   0.00000   0.00000   0.02515
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02335  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00665  -0.00360   0.00000   0.00000  -0.00085
  1 C 2s       0.62384  -0.58827  -0.00000  -0.00000  -0.33076
  1 C 3s      -0.03017  -0.00916  -0.00000  -0.00000   0.01475
  1 C 2px     -0.00000   0.00000  -0.00000   0.70651   0.00000
  1 C 2py     -0.00000   0.00000   0.70651  -0.00000  -0.00000
  1 C 2pz     -0.32876  -0.39221  -0.00000   0.00000  -0.62289
  1 C 3px     -0.00000   0.00000   0.00000   0.01725   0.00000
  1 C 3py     -0.00000   0.00000   0.01725   0.00000  -0.00000
  1 C 3pz      0.03092  -0.00212   0.00000   0.00000   0.04192
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02335  -0.00000   0.00000
  1 C 3dz^2    0.02875   0.00240  -0.00000  -0.00000   0.02515
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02335  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00033
  0 C 2s       0.00000  -0.00000   0.39163
  0 C 3s       0.00000   0.00000  -0.04339
  0 C 2px      0.70659   0.00000   0.00000
  0 C 2py      0.00000   0.70659   0.00000
  0 C 2pz      0.00000   0.00000   0.58640
  0 C 3px     -0.01557   0.00000   0.00000
  0 C 3py      0.00000  -0.01557   0.00000
  0 C 3pz      0.00000  -0.00000   0.02090
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02201   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02090
  0 C 3dxz    -0.02201   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00033
  1 C 2s       0.00000   0.00000  -0.39163
  1 C 3s      -0.00000  -0.00000   0.04339
  1 C 2px     -0.70659  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70659  -0.00000
  1 C 2pz      0.00000   0.00000   0.58640
  1 C 3px      0.01557  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01557  -0.00000
  1 C 3pz      0.00000   0.00000   0.02090
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02201   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02090
  1 C 3dxz    -0.02201   0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99173412
<CAS-nat-orb|mo-hf>  4  4    0.99760703
<CAS-nat-orb|mo-hf>  5  5    0.99948360
<CAS-nat-orb|mo-hf>  6  6    0.99948359
<CAS-nat-orb|mo-hf>  7  7    0.97418543
<CAS-nat-orb|mo-hf>  8  8    0.96886035
<CAS-nat-orb|mo-hf>  9  9    0.96886034
<CAS-nat-orb|mo-hf>  10  10    0.69921469
<CAS-nat-orb|mo-hf>  10  15   -0.63804094
CASSCF energy = -75.5742938505334
CASCI E = -75.5742938505334  E(CI) = -16.4693217945526  S^2 = 0.0000000
Density matrix diagonal elements [1.97574977 1.70399292 1.81154694 1.81154635 0.30304693 0.18612105
 0.18612097 0.02187507]
i = 1  <i|F|i> = -11.33121906
i = 2  <i|F|i> = -11.33104257
i = 3  <i|F|i> =  -0.91707179
i = 4  <i|F|i> =  -0.49148412
i = 5  <i|F|i> =  -0.34168022
i = 6  <i|F|i> =  -0.34168011
i = 7  <i|F|i> =  -0.10086144
i = 8  <i|F|i> =   0.13540970
i = 9  <i|F|i> =   0.13540973
i = 10  <i|F|i> =   0.62422172
i = 11  <i|F|i> =   0.64355463
i = 12  <i|F|i> =   0.68292166
i = 13  <i|F|i> =   0.68292165
i = 14  <i|F|i> =   0.73015370
i = 15  <i|F|i> =   0.56452735
i = 16  <i|F|i> =   0.70917737
i = 17  <i|F|i> =   0.70917736
i = 18  <i|F|i> =   1.08030629
i = 19  <i|F|i> =   1.25159949
i = 20  <i|F|i> =   1.25159949
i = 21  <i|F|i> =   1.27949379
i = 22  <i|F|i> =   1.27949379
i = 23  <i|F|i> =   1.54859374
i = 24  <i|F|i> =   1.54859374
i = 25  <i|F|i> =   1.86644482
i = 26  <i|F|i> =   1.96077271
i = 27  <i|F|i> =   1.96077272
i = 28  <i|F|i> =   2.13658401
......production of RDMs took       2.34 sec
......reading the RDM took          0.43 sec
......production of RDMs took      25.23 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickICNEVPT2-ijrs) =    -0.00027813098363
E(WickICNEVPT2- rsi) =    -0.00087809771340
E(WickICNEVPT2- ijr) =    -0.00037025971138
E(WickICNEVPT2-  rs) =    -0.03493760367457
E(WickICNEVPT2-  ij) =    -0.00010443018097
E(WickICNEVPT2-  ir) =    -0.00115386322232
E(WickICNEVPT2-   r) =    -0.05255644647135
E(WickICNEVPT2-   i) =    -0.00023725935850
E(WickICNEVPT2) = -75.66480994184951  E_corr_pt = -0.09051609131612041
Timings = pdms =   37.73 | eris =    0.01 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.77 | i =    0.70 | total =   40.71
Time cost =     78.518
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:42:46 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.534613911668 AA    0.000000000000   0.000000000000   2.900000000000 Bohr   0.0

nuclear repulsion = 12.4137931034483
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.45]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2682.47


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpfdugx3lv
max_memory 4000 MB (current use 323 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0502696488693

WARN: Singularity detected in overlap matrix (condition number =  255). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.171982441441623  LUMO (Ag) = -0.159994465911486
cycle= 1 E= -75.2972707224471  delta_E= -0.247  |g|= 0.236  |ddm|= 1.43
HOMO (B3u) = -0.435771051837409  LUMO (Ag) = -0.150538347855669
cycle= 2 E= -75.3184487790456  delta_E= -0.0212  |g|= 0.051  |ddm|= 0.31
HOMO (B3u) = -0.397800865131721  LUMO (Ag) = -0.102495692949929
cycle= 3 E= -75.3194573772646  delta_E= -0.00101  |g|= 0.0124  |ddm|= 0.0544
HOMO (B3u) = -0.399183030564799  LUMO (Ag) = -0.0993011615665489
cycle= 4 E= -75.3195559425282  delta_E= -9.86e-05  |g|= 0.00229  |ddm|= 0.0157
HOMO (B3u) = -0.399959753294003  LUMO (Ag) = -0.0998732578136638
cycle= 5 E= -75.3195598190019  delta_E= -3.88e-06  |g|= 0.000323  |ddm|= 0.00343
HOMO (B3u) = -0.399888567456492  LUMO (Ag) = -0.0998019916939266
cycle= 6 E= -75.3195598822275  delta_E= -6.32e-08  |g|= 4.09e-05  |ddm|= 0.000646
HOMO (B2u) = -0.399880517827681  LUMO (Ag) = -0.0997890778930997
cycle= 7 E= -75.3195598833514  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000156
HOMO (B2u) = -0.399880142870899  LUMO (Ag) = -0.0997880477227859
cycle= 8 E= -75.319559883367  delta_E= -1.55e-11  |g|= 5.02e-07  |ddm|= 2.32e-05
HOMO (B2u) = -0.399880110369069  LUMO (Ag) = -0.0997878828351939
cycle= 9 E= -75.319559883367  delta_E= -2.84e-14  |g|= 2.12e-08  |ddm|= 1.59e-06
HOMO (B2u) = -0.399880103488951  LUMO (Ag) = -0.0997878912045862
cycle= 10 E= -75.319559883367  delta_E= -2.84e-14  |g|= 3.19e-09  |ddm|= 7.71e-08
HOMO (B2u) = -0.399880104484025  LUMO (Ag) = -0.0997878921849248
cycle= 11 E= -75.319559883367  delta_E= 5.68e-14  |g|= 2.57e-09  |ddm|= 3.61e-09
HOMO (B2u) = -0.399880104194279  LUMO (Ag) = -0.0997878918162759
cycle= 12 E= -75.3195598833671  delta_E= -1.14e-13  |g|= 1.87e-09  |ddm|= 2.67e-09
HOMO (B2u) = -0.399880104173764  LUMO (Ag) = -0.0997878916971467
cycle= 13 E= -75.319559883367  delta_E= 2.84e-14  |g|= 1.58e-09  |ddm|= 1.71e-09
HOMO (B3u) = -0.399880104127005  LUMO (Ag) = -0.0997878916473109
cycle= 14 E= -75.319559883367  delta_E= 2.84e-14  |g|= 1.31e-09  |ddm|= 1.04e-09
HOMO (B2u) = -0.399880104099768  LUMO (Ag) = -0.0997878916241648
cycle= 15 E= -75.3195598833671  delta_E= -8.53e-14  |g|= 1.11e-09  |ddm|= 6.96e-10
HOMO (B2u) = -0.399880104086343  LUMO (Ag) = -0.0997878916344632
cycle= 16 E= -75.319559883367  delta_E= 8.53e-14  |g|= 1.01e-09  |ddm|= 9e-10
HOMO (B2u) = -0.399880104058109  LUMO (Ag) = -0.0997878916092984
cycle= 17 E= -75.3195598833671  delta_E= -5.68e-14  |g|= 9.25e-10  |ddm|= 3.42e-10
HOMO (B2u) = -0.39988010390707  LUMO (Ag) = -0.0997878914694816
cycle= 18 E= -75.3195598833671  delta_E=    0  |g|= 4.03e-10  |ddm|= 2.15e-09
HOMO (B3u) = -0.399880103908126  LUMO (Ag) = -0.0997878914634836
cycle= 19 E= -75.319559883367  delta_E= 2.84e-14  |g|= 3.3e-10  |ddm|= 3.17e-10
HOMO (B2u) = -0.399880103926872  LUMO (Ag) = -0.099787891476263
cycle= 20 E= -75.319559883367  delta_E=    0  |g|= 2.64e-10  |ddm|= 2.25e-10
HOMO (B3u) = -0.399880103938289  LUMO (Ag) = -0.0997878914830495
cycle= 21 E= -75.319559883367  delta_E= 2.84e-14  |g|= 2.17e-10  |ddm|= 1.67e-10
HOMO (B3u) = -0.399880103945835  LUMO (Ag) = -0.099787891489662
cycle= 22 E= -75.319559883367  delta_E= 2.84e-14  |g|= 1.76e-10  |ddm|= 1.29e-10
HOMO (B2u) = -0.399880103951567  LUMO (Ag) = -0.0997878914950018
cycle= 23 E= -75.3195598833671  delta_E= -1.42e-13  |g|= 1.42e-10  |ddm|= 1.08e-10
HOMO (B3u) = -0.399880103957393  LUMO (Ag) = -0.0997878915008287
cycle= 24 E= -75.3195598833671  delta_E= 5.68e-14  |g|= 1.14e-10  |ddm|= 1.04e-10
HOMO (B3u) = -0.399880103962193  LUMO (Ag) = -0.0997878915047753
cycle= 25 E= -75.319559883367  delta_E= 5.68e-14  |g|= 8.75e-11  |ddm|= 8.45e-11
HOMO (B3u) = -0.399880103965885  LUMO (Ag) = -0.0997878915075724
cycle= 26 E= -75.319559883367  delta_E= 2.84e-14  |g|= 6.24e-11  |ddm|= 7.76e-11
HOMO (B3u) = -0.399880103964495  LUMO (Ag) = -0.0997878915053051
cycle= 27 E= -75.3195598833671  delta_E= -1.14e-13  |g|= 5.08e-11  |ddm|= 2.69e-11
HOMO (B3u) = -0.399880103962883  LUMO (Ag) = -0.0997878915030762
cycle= 28 E= -75.3195598833671  delta_E=    0  |g|= 4.11e-11  |ddm|= 2.03e-11
HOMO (B3u) = -0.399880103959626  LUMO (Ag) = -0.099787891498699
Extra cycle  E= -75.319559883367  delta_E= 5.68e-14  |g|= 1.28e-11  |ddm|= 5.47e-11
converged SCF energy = -75.319559883367

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpfdugx3lv
max_memory 4000 MB (current use 323 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5069071999529  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5287942623675  dE = -0.021887062  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.72  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5408991693832  dE = -0.012104907  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0689  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5490639029554  dE = -0.0081647336  S^2 = 0.0000000
               |grad[o]|=0.093  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5550610059576  dE = -0.005997103  S^2 = 0.0000000
               |grad[o]|=0.0741  |ddm|=0.0189  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5595129978512  dE = -0.0044519919  S^2 = 0.0000000
               |grad[o]|=0.0577  |ddm|=0.0126  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5626837707789  dE = -0.0031707729  S^2 = 0.0000000
               |grad[o]|=0.043  |ddm|=0.00882  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5647161334135  dE = -0.0020323626  S^2 = 0.0000000
               |grad[o]|=0.0294  |ddm|=0.00676  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5657087101248  dE = -0.00099257671  S^2 = 0.0000000
               |grad[o]|=0.0169  |ddm|=0.00658  |maxRot[o]|=0.0799
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5658453298489  dE = -0.00013661972  S^2 = 0.0000000
               |grad[o]|=0.00539  |ddm|=0.00791  |maxRot[o]|= 0.04
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5658470539864  dE = -1.7241375e-06  S^2 = 0.0000000
               |grad[o]|=0.000739  |ddm|=0.00486  |maxRot[o]|=0.00387
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5658470909476  dE = -3.6961211e-08  S^2 = 0.0000000
               |grad[o]|=0.000114  |ddm|=0.000648  |maxRot[o]|=0.000437
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5658470916856  dE = -7.3799811e-10  S^2 = 0.0000000
               |grad[o]|=1.91e-05  |ddm|=8.13e-05  |maxRot[o]|=6.69e-05
macro iter 13 (3 JK  0 micro), CASSCF E = -75.565847091702  dE = -1.6399326e-11  S^2 = 0.0000000
               |grad[o]|=2.73e-06  |ddm|=1.31e-05  |maxRot[o]|=1.18e-05
2-step CASSCF converged in 13 macro (64 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97493415 1.71266198 1.80128063 1.80127968 0.2974251  0.19483039
 0.1948301  0.02275797]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00688   0.00368   0.00000   0.00000  -0.00082
  0 C 2s       0.62688   0.59446  -0.00000  -0.00000  -0.32511
  0 C 3s      -0.02821   0.00928  -0.00000  -0.00000   0.01701
  0 C 2px      0.00000  -0.00000  -0.00000   0.70649   0.00000
  0 C 2py     -0.00000  -0.00000   0.70649  -0.00000   0.00000
  0 C 2pz      0.32333  -0.38275   0.00000  -0.00000   0.62577
  0 C 3px      0.00000  -0.00000   0.00000   0.01921   0.00000
  0 C 3py     -0.00000   0.00000   0.01921   0.00000  -0.00000
  0 C 3pz     -0.02927  -0.00203  -0.00000  -0.00000  -0.04115
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02251   0.00000  -0.00000
  0 C 3dz^2    0.02800  -0.00269  -0.00000  -0.00000   0.02714
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02251   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00688  -0.00368   0.00000   0.00000  -0.00082
  1 C 2s       0.62688  -0.59446   0.00000   0.00000  -0.32511
  1 C 3s      -0.02821  -0.00928   0.00000   0.00000   0.01701
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70649  -0.00000
  1 C 2py      0.00000  -0.00000   0.70649  -0.00000   0.00000
  1 C 2pz     -0.32333  -0.38275  -0.00000  -0.00000  -0.62577
  1 C 3px     -0.00000   0.00000   0.00000   0.01921  -0.00000
  1 C 3py      0.00000  -0.00000   0.01921   0.00000  -0.00000
  1 C 3pz      0.02927  -0.00203  -0.00000  -0.00000   0.04115
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02251  -0.00000  -0.00000
  1 C 3dz^2    0.02800   0.00269  -0.00000   0.00000   0.02714
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02251   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.38221
  0 C 3s      -0.00000  -0.00000  -0.04321
  0 C 2px      0.70662  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70662  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.59260
  0 C 3px     -0.01471  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01471  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02126
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02171  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02074
  0 C 3dxz    -0.02171  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.38221
  1 C 3s       0.00000   0.00000   0.04321
  1 C 2px     -0.70662   0.00000   0.00000
  1 C 2py      0.00000  -0.70662   0.00000
  1 C 2pz     -0.00000  -0.00000   0.59260
  1 C 3px      0.01471   0.00000   0.00000
  1 C 3py      0.00000   0.01471   0.00000
  1 C 3pz     -0.00000  -0.00000   0.02126
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02171  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02074
  1 C 3dxz    -0.02171  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99150096
<CAS-nat-orb|mo-hf>  4  4    0.99751312
<CAS-nat-orb|mo-hf>  5  5    0.99943968
<CAS-nat-orb|mo-hf>  6  6    0.99943968
<CAS-nat-orb|mo-hf>  7  7    0.97389130
<CAS-nat-orb|mo-hf>  8  8    0.97085580
<CAS-nat-orb|mo-hf>  9  9    0.97085576
<CAS-nat-orb|mo-hf>  10  10    0.72379474
<CAS-nat-orb|mo-hf>  10  14   -0.61908421
CASSCF energy = -75.565847091702
CASCI E = -75.565847091702  E(CI) = -16.364099552506  S^2 = 0.0000000
Density matrix diagonal elements [1.97493419 1.71266134 1.80128111 1.80128068 0.29742571 0.19482968
 0.19482934 0.02275795]
i = 1  <i|F|i> = -11.33444963
i = 2  <i|F|i> = -11.33436997
i = 3  <i|F|i> =  -0.90863638
i = 4  <i|F|i> =  -0.49791672
i = 5  <i|F|i> =  -0.33617932
i = 6  <i|F|i> =  -0.33617925
i = 7  <i|F|i> =  -0.09869923
i = 8  <i|F|i> =   0.12544862
i = 9  <i|F|i> =   0.12544873
i = 10  <i|F|i> =   0.59516688
i = 11  <i|F|i> =   0.64702856
i = 12  <i|F|i> =   0.68483865
i = 13  <i|F|i> =   0.68483864
i = 14  <i|F|i> =   0.56673412
i = 15  <i|F|i> =   0.73250757
i = 16  <i|F|i> =   0.70962832
i = 17  <i|F|i> =   0.70962827
i = 18  <i|F|i> =   1.07526638
i = 19  <i|F|i> =   1.24234087
i = 20  <i|F|i> =   1.24234086
i = 21  <i|F|i> =   1.28407754
i = 22  <i|F|i> =   1.28407754
i = 23  <i|F|i> =   1.54043780
i = 24  <i|F|i> =   1.54043780
i = 25  <i|F|i> =   1.83915494
i = 26  <i|F|i> =   1.94428771
i = 27  <i|F|i> =   1.94428772
i = 28  <i|F|i> =   2.13016395
......production of RDMs took       1.87 sec
......reading the RDM took          0.41 sec
......production of RDMs took      24.18 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICNEVPT2-ijrs) =    -0.00027688237227
E(WickICNEVPT2- rsi) =    -0.00087094833381
E(WickICNEVPT2- ijr) =    -0.00036390609691
E(WickICNEVPT2-  rs) =    -0.03452908888669
E(WickICNEVPT2-  ij) =    -0.00009973067864
E(WickICNEVPT2-  ir) =    -0.00114071917504
E(WickICNEVPT2-   r) =    -0.05338673223814
E(WickICNEVPT2-   i) =    -0.00023143408094
E(WickICNEVPT2) = -75.65674653356444  E_corr_pt = -0.09089944186244003
Timings = pdms =   36.19 | eris =    0.01 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.23 | ij =    0.07 | ir =    0.15 | r =    1.76 | i =    0.70 | total =   39.17
Time cost =     80.290
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:44:06 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.561072772214 AA    0.000000000000   0.000000000000   2.950000000000 Bohr   0.0

nuclear repulsion = 12.2033898305085
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.475]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2771.07


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpqydunx1v
max_memory 4000 MB (current use 320 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0186954217207

WARN: Singularity detected in overlap matrix (condition number =  236). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.165974687131635  LUMO (Ag) = -0.158079543422896
cycle= 1 E= -75.2873378760355  delta_E= -0.269  |g|= 0.239  |ddm|= 1.43
HOMO (B3u) = -0.431571893819983  LUMO (Ag) = -0.149790781563184
cycle= 2 E= -75.3090731833374  delta_E= -0.0217  |g|= 0.0507  |ddm|= 0.316
HOMO (B3u) = -0.393547996937856  LUMO (Ag) = -0.100989331184847
cycle= 3 E= -75.3100918952135  delta_E= -0.00102  |g|= 0.0127  |ddm|= 0.0544
HOMO (B2u) = -0.395075054129108  LUMO (Ag) = -0.0978528282721954
cycle= 4 E= -75.3101958879618  delta_E= -0.000104  |g|= 0.00229  |ddm|= 0.0157
HOMO (B3u) = -0.395838291352906  LUMO (Ag) = -0.098437906239965
cycle= 5 E= -75.3101998099164  delta_E= -3.92e-06  |g|= 0.000326  |ddm|= 0.00328
HOMO (B3u) = -0.3957689454445  LUMO (Ag) = -0.0983739814936229
cycle= 6 E= -75.3101998734465  delta_E= -6.35e-08  |g|= 4.1e-05  |ddm|= 0.000649
HOMO (B3u) = -0.395760954503403  LUMO (Ag) = -0.0983611341563446
cycle= 7 E= -75.3101998745662  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000143
HOMO (B2u) = -0.395760469633686  LUMO (Ag) = -0.0983600611975565
cycle= 8 E= -75.310199874582  delta_E= -1.59e-11  |g|= 5.2e-07  |ddm|= 2.23e-05
HOMO (B3u) = -0.395760436404813  LUMO (Ag) = -0.098359879241227
cycle= 9 E= -75.3101998745822  delta_E= -1.28e-13  |g|= 2.17e-08  |ddm|= 1.39e-06
HOMO (B3u) = -0.395760429248386  LUMO (Ag) = -0.0983598897706439
cycle= 10 E= -75.3101998745821  delta_E= 2.84e-14  |g|= 3.33e-09  |ddm|= 8.05e-08
HOMO (B3u) = -0.395760430313182  LUMO (Ag) = -0.0983598908473289
cycle= 11 E= -75.3101998745822  delta_E= -8.53e-14  |g|= 2.6e-09  |ddm|= 4.16e-09
HOMO (B3u) = -0.395760430019764  LUMO (Ag) = -0.0983598904704345
cycle= 12 E= -75.3101998745823  delta_E= -5.68e-14  |g|= 1.93e-09  |ddm|= 2.62e-09
HOMO (B3u) = -0.395760430010128  LUMO (Ag) = -0.098359890337942
cycle= 13 E= -75.3101998745822  delta_E= 8.53e-14  |g|= 1.67e-09  |ddm|= 1.74e-09
HOMO (B3u) = -0.395760429956847  LUMO (Ag) = -0.0983598902854222
cycle= 14 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 1.39e-09  |ddm|= 9.68e-10
HOMO (B3u) = -0.395760429928458  LUMO (Ag) = -0.0983598902665739
cycle= 15 E= -75.3101998745823  delta_E= -1.42e-14  |g|= 1.19e-09  |ddm|= 8e-10
HOMO (B3u) = -0.395760429913515  LUMO (Ag) = -0.098359890268148
cycle= 16 E= -75.3101998745822  delta_E= 9.95e-14  |g|= 1.06e-09  |ddm|= 8.03e-10
HOMO (B3u) = -0.395760429892042  LUMO (Ag) = -0.0983598902484914
cycle= 17 E= -75.3101998745822  delta_E= -2.84e-14  |g|= 9.59e-10  |ddm|= 4.23e-10
HOMO (B3u) = -0.395760429734567  LUMO (Ag) = -0.0983598901198589
cycle= 18 E= -75.3101998745822  delta_E= -2.84e-14  |g|= 4.21e-10  |ddm|= 2.31e-09
HOMO (B3u) = -0.3957604297351  LUMO (Ag) = -0.0983598901136321
cycle= 19 E= -75.3101998745822  delta_E=    0  |g|= 3.45e-10  |ddm|= 3.34e-10
HOMO (B3u) = -0.395760429753827  LUMO (Ag) = -0.0983598901268115
cycle= 20 E= -75.3101998745823  delta_E= -4.26e-14  |g|= 2.78e-10  |ddm|= 2.29e-10
HOMO (B3u) = -0.395760429765423  LUMO (Ag) = -0.0983598901336998
cycle= 21 E= -75.3101998745822  delta_E= 9.95e-14  |g|= 2.31e-10  |ddm|= 1.7e-10
HOMO (B3u) = -0.395760429772696  LUMO (Ag) = -0.0983598901408038
cycle= 22 E= -75.3101998745823  delta_E= -9.95e-14  |g|= 1.87e-10  |ddm|= 1.33e-10
HOMO (B3u) = -0.395760429778194  LUMO (Ag) = -0.0983598901464993
cycle= 23 E= -75.3101998745822  delta_E= 5.68e-14  |g|= 1.51e-10  |ddm|= 1.13e-10
HOMO (B2u) = -0.395760429784152  LUMO (Ag) = -0.098359890152972
cycle= 24 E= -75.3101998745822  delta_E=    0  |g|= 1.2e-10  |ddm|= 1.11e-10
HOMO (B2u) = -0.395760429789066  LUMO (Ag) = -0.0983598901578743
cycle= 25 E= -75.3101998745822  delta_E= -1.42e-14  |g|= 9.18e-11  |ddm|= 9.33e-11
HOMO (B3u) = -0.395760429793048  LUMO (Ag) = -0.0983598901618853
cycle= 26 E= -75.3101998745822  delta_E= 1.42e-14  |g|= 6.6e-11  |ddm|= 8.5e-11
HOMO (B3u) = -0.395760429791678  LUMO (Ag) = -0.0983598901598064
cycle= 27 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 5.4e-11  |ddm|= 2.88e-11
HOMO (B3u) = -0.395760429790042  LUMO (Ag) = -0.0983598901577137
cycle= 28 E= -75.3101998745821  delta_E= 9.95e-14  |g|= 4.38e-11  |ddm|= 2.17e-11
HOMO (B2u) = -0.395760429788857  LUMO (Ag) = -0.0983598901563228
cycle= 29 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 3.55e-11  |ddm|= 1.73e-11
HOMO (B2u) = -0.395760429787925  LUMO (Ag) = -0.0983598901553895
cycle= 30 E= -75.3101998745822  delta_E= 2.84e-14  |g|= 2.83e-11  |ddm|= 1.4e-11
HOMO (B2u) = -0.395760429787281  LUMO (Ag) = -0.0983598901547535
cycle= 31 E= -75.3101998745822  delta_E= -2.84e-14  |g|= 2.25e-11  |ddm|= 1.14e-11
HOMO (B2u) = -0.395760429786862  LUMO (Ag) = -0.0983598901543352
cycle= 32 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 1.78e-11  |ddm|= 9.1e-12
HOMO (B2u) = -0.395760429786617  LUMO (Ag) = -0.0983598901540476
cycle= 33 E= -75.3101998745823  delta_E= -4.26e-14  |g|= 1.4e-11  |ddm|= 6.86e-12
HOMO (B2u) = -0.39576042978652  LUMO (Ag) = -0.0983598901538881
cycle= 34 E= -75.3101998745822  delta_E= 2.84e-14  |g|= 1.11e-11  |ddm|= 4.96e-12
HOMO (B2u) = -0.395760429786549  LUMO (Ag) = -0.0983598901538341
cycle= 35 E= -75.3101998745822  delta_E= 5.68e-14  |g|= 9.01e-12  |ddm|= 3.42e-12
HOMO (B2u) = -0.395760429786546  LUMO (Ag) = -0.0983598901537811
cycle= 36 E= -75.3101998745821  delta_E= 4.26e-14  |g|= 7.3e-12  |ddm|= 2.78e-12
HOMO (B3u) = -0.395760429786513  LUMO (Ag) = -0.0983598901537242
cycle= 37 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 5.89e-12  |ddm|= 2.24e-12
HOMO (B2u) = -0.395760429786464  LUMO (Ag) = -0.0983598901536639
cycle= 38 E= -75.3101998745823  delta_E= -7.11e-14  |g|= 4.73e-12  |ddm|= 1.8e-12
HOMO (B3u) = -0.395760429786411  LUMO (Ag) = -0.0983598901536011
cycle= 39 E= -75.3101998745822  delta_E= 8.53e-14  |g|= 3.8e-12  |ddm|= 1.45e-12
HOMO (B3u) = -0.395760429786356  LUMO (Ag) = -0.098359890153537
cycle= 40 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 3.05e-12  |ddm|= 1.17e-12
HOMO (B3u) = -0.395760429786304  LUMO (Ag) = -0.0983598901534739
cycle= 41 E= -75.3101998745823  delta_E= -4.26e-14  |g|= 2.45e-12  |ddm|= 9.68e-13
HOMO (B2u) = -0.395760429786257  LUMO (Ag) = -0.0983598901534173
cycle= 42 E= -75.3101998745821  delta_E= 1.71e-13  |g|= 1.98e-12  |ddm|= 7.77e-13
HOMO (B2u) = -0.395760429786217  LUMO (Ag) = -0.09835989015337
cycle= 43 E= -75.3101998745822  delta_E= -1.14e-13  |g|= 1.6e-12  |ddm|= 6.44e-13
HOMO (B2u) = -0.395760429786185  LUMO (Ag) = -0.0983598901533349
cycle= 44 E= -75.3101998745823  delta_E= -5.68e-14  |g|= 1.29e-12  |ddm|= 5.44e-13
HOMO (B2u) = -0.395760429786162  LUMO (Ag) = -0.098359890153308
cycle= 45 E= -75.3101998745822  delta_E= 5.68e-14  |g|= 1.04e-12  |ddm|= 4.46e-13
HOMO (B2u) = -0.395760429786143  LUMO (Ag) = -0.0983598901532872
cycle= 46 E= -75.3101998745822  delta_E= 4.26e-14  |g|= 8.43e-13  |ddm|= 3.55e-13
HOMO (B2u) = -0.395760429786129  LUMO (Ag) = -0.0983598901532716
cycle= 47 E= -75.3101998745822  delta_E= -7.11e-14  |g|= 6.78e-13  |ddm|= 2.93e-13
HOMO (B2u) = -0.395760429786118  LUMO (Ag) = -0.0983598901532594
cycle= 48 E= -75.3101998745822  delta_E= 8.53e-14  |g|= 5.48e-13  |ddm|= 2.32e-13
HOMO (B2u) = -0.395760429786109  LUMO (Ag) = -0.0983598901532483
cycle= 49 E= -75.3101998745822  delta_E=    0  |g|= 4.41e-13  |ddm|= 2.16e-13
HOMO (B2u) = -0.395760429786081  LUMO (Ag) = -0.0983598901532173
Extra cycle  E= -75.3101998745821  delta_E= 8.53e-14  |g|= 1.53e-13  |ddm|= 5.9e-13
converged SCF energy = -75.3101998745821

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpqydunx1v
max_memory 4000 MB (current use 320 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4998295378018  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.521333533592  dE = -0.021503996  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.533416138205  dE = -0.012082605  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0682  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5415789229104  dE = -0.0081627847  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0323  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5475124010129  dE = -0.0059334781  S^2 = 0.0000000
               |grad[o]|=0.0732  |ddm|=0.0196  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5518257257353  dE = -0.0043133247  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0131  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5547913705212  dE = -0.0029656448  S^2 = 0.0000000
               |grad[o]|=0.0409  |ddm|=0.00918  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5565626349571  dE = -0.0017712644  S^2 = 0.0000000
               |grad[o]|=0.0267  |ddm|=0.00732  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5571750232565  dE = -0.0006123883  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00767  |maxRot[o]|= 0.06
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5572696087177  dE = -9.4585461e-05  S^2 = 0.0000000
               |grad[o]|=0.00458  |ddm|=0.00702  |maxRot[o]|=0.0325
macro iter 10 (3 JK  0 micro), CASSCF E = -75.55727072122  dE = -1.1125023e-06  S^2 = 0.0000000
               |grad[o]|=0.000629  |ddm|=0.00451  |maxRot[o]|=0.00289
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5572707457968  dE = -2.4576735e-08  S^2 = 0.0000000
               |grad[o]|=9.69e-05  |ddm|=0.000585  |maxRot[o]|=0.000339
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5572707462855  dE = -4.8878235e-10  S^2 = 0.0000000
               |grad[o]|=1.64e-05  |ddm|=7.43e-05  |maxRot[o]|=4.96e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5572707462966  dE = -1.1041834e-11  S^2 = 0.0000000
               |grad[o]|=2.45e-06  |ddm|=1.14e-05  |maxRot[o]|=8.68e-06
2-step CASSCF converged in 13 macro (62 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97414482 1.72120466 1.79044226 1.79044094 0.29254404 0.20379322
 0.20379325 0.02363682]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00710   0.00377   0.00000   0.00000  -0.00079
  0 C 2s       0.62989   0.60047   0.00000   0.00000  -0.31937
  0 C 3s      -0.02627   0.00941  -0.00000   0.00000   0.01911
  0 C 2px     -0.00000   0.00000   0.00000   0.70646  -0.00000
  0 C 2py      0.00000  -0.00000   0.70646  -0.00000  -0.00000
  0 C 2pz      0.31779  -0.37325   0.00000   0.00000   0.62862
  0 C 3px     -0.00000   0.00000  -0.00000   0.02107  -0.00000
  0 C 3py      0.00000  -0.00000   0.02107  -0.00000  -0.00000
  0 C 3pz     -0.02764  -0.00196  -0.00000   0.00000  -0.04016
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02166  -0.00000  -0.00000
  0 C 3dz^2    0.02729  -0.00296  -0.00000   0.00000   0.02921
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02166  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00710  -0.00377   0.00000   0.00000  -0.00079
  1 C 2s       0.62989  -0.60047   0.00000  -0.00000  -0.31937
  1 C 3s      -0.02627  -0.00941  -0.00000  -0.00000   0.01911
  1 C 2px      0.00000   0.00000   0.00000   0.70646   0.00000
  1 C 2py      0.00000   0.00000   0.70646   0.00000   0.00000
  1 C 2pz     -0.31779  -0.37325   0.00000   0.00000  -0.62862
  1 C 3px      0.00000  -0.00000  -0.00000   0.02107   0.00000
  1 C 3py     -0.00000   0.00000   0.02107   0.00000   0.00000
  1 C 3pz      0.02764  -0.00196   0.00000   0.00000   0.04016
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02166  -0.00000  -0.00000
  1 C 3dz^2    0.02729   0.00296  -0.00000  -0.00000   0.02921
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02166  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00027
  0 C 2s       0.00000   0.00000   0.37274
  0 C 3s       0.00000  -0.00000  -0.04290
  0 C 2px      0.70665  -0.00000   0.00000
  0 C 2py     -0.00000   0.70665   0.00000
  0 C 2pz      0.00000  -0.00000   0.59862
  0 C 3px     -0.01384   0.00000   0.00000
  0 C 3py      0.00000  -0.01384  -0.00000
  0 C 3pz      0.00000  -0.00000   0.02142
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02139  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02055
  0 C 3dxz    -0.02139   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00027
  1 C 2s      -0.00000   0.00000  -0.37274
  1 C 3s      -0.00000   0.00000   0.04290
  1 C 2px     -0.70665   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70665   0.00000
  1 C 2pz      0.00000   0.00000   0.59862
  1 C 3px      0.01384   0.00000  -0.00000
  1 C 3py      0.00000   0.01384   0.00000
  1 C 3pz      0.00000  -0.00000   0.02142
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02139  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02055
  1 C 3dxz    -0.02139  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99129326
<CAS-nat-orb|mo-hf>  4  4    0.99742902
<CAS-nat-orb|mo-hf>  5  5    0.99939339
<CAS-nat-orb|mo-hf>  6  6    0.99939339
<CAS-nat-orb|mo-hf>  7  7    0.97366309
<CAS-nat-orb|mo-hf>  8  8    0.97269186
<CAS-nat-orb|mo-hf>  9  9    0.97269185
<CAS-nat-orb|mo-hf>  10  10    0.74746745
<CAS-nat-orb|mo-hf>  10  14   -0.59840371
CASSCF energy = -75.5572707462966
CASCI E = -75.5572707462966  E(CI) = -16.2620310686453  S^2 = 0.0000000
Density matrix diagonal elements [1.97414479 1.72120402 1.79044347 1.79044158 0.29254381 0.20379282
 0.20379274 0.02363676]
i = 1  <i|F|i> = -11.33741014
i = 2  <i|F|i> = -11.33741861
i = 3  <i|F|i> =  -0.90045847
i = 4  <i|F|i> =  -0.50431181
i = 5  <i|F|i> =  -0.33072527
i = 6  <i|F|i> =  -0.33072493
i = 7  <i|F|i> =  -0.09657174
i = 8  <i|F|i> =   0.11587130
i = 9  <i|F|i> =   0.11587127
i = 10  <i|F|i> =   0.56778911
i = 11  <i|F|i> =   0.65028751
i = 12  <i|F|i> =   0.68649158
i = 13  <i|F|i> =   0.68649158
i = 14  <i|F|i> =   0.56906859
i = 15  <i|F|i> =   0.73533713
i = 16  <i|F|i> =   0.71010575
i = 17  <i|F|i> =   0.71010574
i = 18  <i|F|i> =   1.07039694
i = 19  <i|F|i> =   1.23404377
i = 20  <i|F|i> =   1.23404376
i = 21  <i|F|i> =   1.28869943
i = 22  <i|F|i> =   1.28869943
i = 23  <i|F|i> =   1.53258608
i = 24  <i|F|i> =   1.53258608
i = 25  <i|F|i> =   1.81117988
i = 26  <i|F|i> =   1.92775168
i = 27  <i|F|i> =   1.92775170
i = 28  <i|F|i> =   2.12554407
......production of RDMs took       1.81 sec
......reading the RDM took          0.42 sec
......production of RDMs took      44.77 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

E(WickICNEVPT2-ijrs) =    -0.00027603158347
E(WickICNEVPT2- rsi) =    -0.00086484576723
E(WickICNEVPT2- ijr) =    -0.00035768703815
E(WickICNEVPT2-  rs) =    -0.03413439601145
E(WickICNEVPT2-  ij) =    -0.00009520497053
E(WickICNEVPT2-  ir) =    -0.00112824258857
E(WickICNEVPT2-   r) =    -0.05422618366822
E(WickICNEVPT2-   i) =    -0.00022559459141
E(WickICNEVPT2) = -75.64857893251563  E_corr_pt = -0.09130818621904542
Timings = pdms =   56.71 | eris =    0.01 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.75 | i =    0.69 | total =   59.66
Time cost =    217.844
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:47:44 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.587531632760 AA    0.000000000000   0.000000000000   3.000000000000 Bohr   0.0

nuclear repulsion = 12
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.5]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2849.22


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpbpg_zf0_
max_memory 4000 MB (current use 322 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9888325390205

WARN: Singularity detected in overlap matrix (condition number =  219). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.160268488606781  LUMO (Ag) = -0.156209924431072
cycle= 1 E= -75.2773690146387  delta_E= -0.289  |g|= 0.241  |ddm|= 1.43
HOMO (B2u) = -0.427459076932469  LUMO (Ag) = -0.148855300078026
cycle= 2 E= -75.2996288397617  delta_E= -0.0223  |g|= 0.0503  |ddm|= 0.321
HOMO (B3u) = -0.389387614274556  LUMO (Ag) = -0.09933607369724
cycle= 3 E= -75.3006548036907  delta_E= -0.00103  |g|= 0.013  |ddm|= 0.0545
HOMO (B2u) = -0.391075001807695  LUMO (Ag) = -0.0963133132876663
cycle= 4 E= -75.300763401749  delta_E= -0.000109  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.391819817512155  LUMO (Ag) = -0.0969078799501842
cycle= 5 E= -75.3007673195955  delta_E= -3.92e-06  |g|= 0.000327  |ddm|= 0.00318
HOMO (B2u) = -0.391752968347543  LUMO (Ag) = -0.096851802087955
cycle= 6 E= -75.3007673825198  delta_E= -6.29e-08  |g|= 4.07e-05  |ddm|= 0.000647
HOMO (B3u) = -0.391745163678226  LUMO (Ag) = -0.096839200145766
cycle= 7 E= -75.3007673836115  delta_E= -1.09e-09  |g|= 5.16e-06  |ddm|= 0.00013
HOMO (B3u) = -0.391744579298904  LUMO (Ag) = -0.096838108742986
cycle= 8 E= -75.3007673836275  delta_E= -1.6e-11  |g|= 5.37e-07  |ddm|= 2.12e-05
HOMO (B3u) = -0.391744545069315  LUMO (Ag) = -0.0968379095777559
cycle= 9 E= -75.3007673836276  delta_E= -1.14e-13  |g|= 2.23e-08  |ddm|= 1.2e-06
HOMO (B2u) = -0.391744537674297  LUMO (Ag) = -0.0968379222718526
cycle= 10 E= -75.3007673836275  delta_E= 5.68e-14  |g|= 3.48e-09  |ddm|= 8.33e-08
HOMO (B2u) = -0.391744538783401  LUMO (Ag) = -0.0968379234149882
cycle= 11 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 2.63e-09  |ddm|= 4.53e-09
HOMO (B3u) = -0.391744538505575  LUMO (Ag) = -0.0968379230556894
cycle= 12 E= -75.3007673836276  delta_E=    0  |g|= 2e-09  |ddm|= 2.59e-09
HOMO (B2u) = -0.391744538510616  LUMO (Ag) = -0.0968379229129831
cycle= 13 E= -75.3007673836277  delta_E= -8.53e-14  |g|= 1.76e-09  |ddm|= 1.81e-09
HOMO (B2u) = -0.391744538456186  LUMO (Ag) = -0.0968379228641019
cycle= 14 E= -75.3007673836277  delta_E= 2.84e-14  |g|= 1.47e-09  |ddm|= 9.42e-10
HOMO (B3u) = -0.391744538422894  LUMO (Ag) = -0.0968379228452705
cycle= 15 E= -75.3007673836276  delta_E= 5.68e-14  |g|= 1.27e-09  |ddm|= 8.89e-10
HOMO (B2u) = -0.391744538403727  LUMO (Ag) = -0.0968379228367193
cycle= 16 E= -75.3007673836276  delta_E=    0  |g|= 1.14e-09  |ddm|= 6.92e-10
HOMO (B2u) = -0.391744538390087  LUMO (Ag) = -0.0968379228224103
cycle= 17 E= -75.3007673836277  delta_E= -5.68e-14  |g|= 1e-09  |ddm|= 4.87e-10
HOMO (B2u) = -0.391744538229882  LUMO (Ag) = -0.0968379227085943
cycle= 18 E= -75.3007673836276  delta_E= 8.53e-14  |g|= 4.41e-10  |ddm|= 2.45e-09
HOMO (B2u) = -0.391744538229819  LUMO (Ag) = -0.0968379227020959
cycle= 19 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 3.6e-10  |ddm|= 3.48e-10
HOMO (B2u) = -0.391744538248043  LUMO (Ag) = -0.096837922715324
cycle= 20 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 2.95e-10  |ddm|= 2.34e-10
HOMO (B2u) = -0.391744538259669  LUMO (Ag) = -0.0968379227222117
cycle= 21 E= -75.3007673836277  delta_E= -8.53e-14  |g|= 2.47e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.39174453826654  LUMO (Ag) = -0.0968379227297552
cycle= 22 E= -75.3007673836276  delta_E= 2.84e-14  |g|= 2e-10  |ddm|= 1.37e-10
HOMO (B2u) = -0.391744538271795  LUMO (Ag) = -0.0968379227358043
cycle= 23 E= -75.3007673836276  delta_E= 7.11e-14  |g|= 1.62e-10  |ddm|= 1.17e-10
HOMO (B2u) = -0.391744538277748  LUMO (Ag) = -0.0968379227428055
cycle= 24 E= -75.3007673836276  delta_E= -4.26e-14  |g|= 1.28e-10  |ddm|= 1.16e-10
HOMO (B2u) = -0.39174453828262  LUMO (Ag) = -0.0968379227484701
cycle= 25 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 9.73e-11  |ddm|= 1.01e-10
HOMO (B2u) = -0.391744538286831  LUMO (Ag) = -0.0968379227536591
cycle= 26 E= -75.3007673836276  delta_E= 5.68e-14  |g|= 7.05e-11  |ddm|= 9.22e-11
HOMO (B3u) = -0.391744538285512  LUMO (Ag) = -0.0968379227518174
cycle= 27 E= -75.3007673836276  delta_E=    0  |g|= 5.79e-11  |ddm|= 3.08e-11
HOMO (B2u) = -0.391744538280083  LUMO (Ag) = -0.0968379227467381
Extra cycle  E= -75.3007673836276  delta_E= -1.42e-14  |g|= 1.81e-11  |ddm|= 8.37e-11
converged SCF energy = -75.3007673836276

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpbpg_zf0_
max_memory 4000 MB (current use 322 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4927493145095  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5138848570109  dE = -0.021135543  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5259228808653  dE = -0.012038024  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5340673145835  dE = -0.0081444337  S^2 = 0.0000000
               |grad[o]|=0.0918  |ddm|=0.0329  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5399163566944  dE = -0.0058490421  S^2 = 0.0000000
               |grad[o]|=0.0719  |ddm|=0.0206  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5440667830721  dE = -0.0041504264  S^2 = 0.0000000
               |grad[o]|=0.0544  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5467996670425  dE = -0.002732884  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00993  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5482783207085  dE = -0.0014786537  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00842  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5486404656312  dE = -0.00036214492  S^2 = 0.0000000
               |grad[o]|=0.00986  |ddm|=0.00938  |maxRot[o]|= 0.06
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5486450984632  dE = -4.632832e-06  S^2 = 0.0000000
               |grad[o]|=0.00124  |ddm|=0.0088  |maxRot[o]|=0.00593
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5486452003136  dE = -1.0185039e-07  S^2 = 0.0000000
               |grad[o]|=0.000216  |ddm|=0.00137  |maxRot[o]|=0.00062
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5486452023075  dE = -1.9939392e-09  S^2 = 0.0000000
               |grad[o]|=3.57e-05  |ddm|=0.000184  |maxRot[o]|=8.97e-05
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5486452023529  dE = -4.5332627e-11  S^2 = 0.0000000
               |grad[o]|=5.19e-06  |ddm|=2.78e-05  |maxRot[o]|=1.6e-05
2-step CASSCF converged in 12 macro (59 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97338733 1.72966171 1.77895355 1.77895233 0.28849582 0.21301943
 0.21301931 0.02451051]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00731   0.00385   0.00000   0.00000  -0.00077
  0 C 2s       0.63288   0.60630   0.00000  -0.00000  -0.31355
  0 C 3s      -0.02435   0.00955  -0.00000  -0.00000   0.02103
  0 C 2px      0.00000  -0.00000  -0.00000   0.70643  -0.00000
  0 C 2py     -0.00000   0.00000   0.70643   0.00000  -0.00000
  0 C 2pz      0.31214  -0.36370  -0.00000  -0.00000   0.63146
  0 C 3px      0.00000  -0.00000  -0.00000   0.02283  -0.00000
  0 C 3py      0.00000  -0.00000   0.02283   0.00000  -0.00000
  0 C 3pz     -0.02602  -0.00192  -0.00000  -0.00000  -0.03894
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02081   0.00000  -0.00000
  0 C 3dz^2    0.02662  -0.00320  -0.00000  -0.00000   0.03135
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02081  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00731  -0.00385   0.00000   0.00000  -0.00077
  1 C 2s       0.63288  -0.60630   0.00000   0.00000  -0.31355
  1 C 3s      -0.02435  -0.00955   0.00000   0.00000   0.02103
  1 C 2px     -0.00000   0.00000   0.00000   0.70643   0.00000
  1 C 2py      0.00000   0.00000   0.70643  -0.00000   0.00000
  1 C 2pz     -0.31214  -0.36370   0.00000   0.00000  -0.63146
  1 C 3px     -0.00000   0.00000   0.00000   0.02283   0.00000
  1 C 3py      0.00000  -0.00000   0.02283  -0.00000   0.00000
  1 C 3pz      0.02602  -0.00192  -0.00000  -0.00000   0.03894
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02081   0.00000  -0.00000
  1 C 3dz^2    0.02662   0.00320   0.00000   0.00000   0.03135
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02081  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s       0.00000   0.00000   0.36324
  0 C 3s      -0.00000   0.00000  -0.04243
  0 C 2px      0.70668   0.00000  -0.00000
  0 C 2py     -0.00000   0.70668  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.60447
  0 C 3px     -0.01294  -0.00000   0.00000
  0 C 3py      0.00000  -0.01294   0.00000
  0 C 3pz     -0.00000   0.00000   0.02137
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02104   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02031
  0 C 3dxz    -0.02104  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000  -0.00000  -0.36324
  1 C 3s       0.00000  -0.00000   0.04243
  1 C 2px     -0.70668   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70668  -0.00000
  1 C 2pz      0.00000   0.00000   0.60447
  1 C 3px      0.01294  -0.00000   0.00000
  1 C 3py      0.00000   0.01294  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02137
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02104   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02031
  1 C 3dxz    -0.02104   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99111461
<CAS-nat-orb|mo-hf>  4  4    0.99735746
<CAS-nat-orb|mo-hf>  5  5    0.99934482
<CAS-nat-orb|mo-hf>  6  6    0.99934482
<CAS-nat-orb|mo-hf>  7  7    0.97351400
<CAS-nat-orb|mo-hf>  8  8    0.97438519
<CAS-nat-orb|mo-hf>  9  9    0.97438516
<CAS-nat-orb|mo-hf>  10  10    0.76990744
<CAS-nat-orb|mo-hf>  10  14   -0.57655943
CASSCF energy = -75.5486452023529
CASCI E = -75.5486452023529  E(CI) = -16.1630327259081  S^2 = 0.0000000
Density matrix diagonal elements [1.97338725 1.72966045 1.77895714 1.77895491 0.28849393 0.21301797
 0.21301783 0.02451053]
i = 1  <i|F|i> = -11.34010200
i = 2  <i|F|i> = -11.34019149
i = 3  <i|F|i> =  -0.89254590
i = 4  <i|F|i> =  -0.51067752
i = 5  <i|F|i> =  -0.32529928
i = 6  <i|F|i> =  -0.32529889
i = 7  <i|F|i> =  -0.09451543
i = 8  <i|F|i> =   0.10666230
i = 9  <i|F|i> =   0.10666229
i = 10  <i|F|i> =   0.54201106
i = 11  <i|F|i> =   0.65336423
i = 12  <i|F|i> =   0.68788273
i = 13  <i|F|i> =   0.68788273
i = 14  <i|F|i> =   0.57150006
i = 15  <i|F|i> =   0.73861562
i = 16  <i|F|i> =   0.71061555
i = 17  <i|F|i> =   0.71061552
i = 18  <i|F|i> =   1.06569795
i = 19  <i|F|i> =   1.22671867
i = 20  <i|F|i> =   1.22671865
i = 21  <i|F|i> =   1.29334206
i = 22  <i|F|i> =   1.29334206
i = 23  <i|F|i> =   1.52503672
i = 24  <i|F|i> =   1.52503672
i = 25  <i|F|i> =   1.78270165
i = 26  <i|F|i> =   1.91118298
i = 27  <i|F|i> =   1.91118302
i = 28  <i|F|i> =   2.12246764
......production of RDMs took       2.27 sec
......reading the RDM took          0.41 sec
......production of RDMs took      65.75 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickICNEVPT2-ijrs) =    -0.00027556391325
E(WickICNEVPT2- rsi) =    -0.00085975121882
E(WickICNEVPT2- ijr) =    -0.00035162228262
E(WickICNEVPT2-  rs) =    -0.03375580098320
E(WickICNEVPT2-  ij) =    -0.00009085895172
E(WickICNEVPT2-  ir) =    -0.00111644908264
E(WickICNEVPT2-   r) =    -0.05507452009690
E(WickICNEVPT2-   i) =    -0.00021973223174
E(WickICNEVPT2) = -75.64038950111375  E_corr_pt = -0.09174429876087603
Timings = pdms =   78.19 | eris =    0.02 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.15 | r =    2.13 | i =    0.80 | total =   81.67
Time cost =    372.485
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:53:56 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.613990493306 AA    0.000000000000   0.000000000000   3.050000000000 Bohr   0.0

nuclear repulsion = 11.8032786885246
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.525]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3092.16


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpv__19u5z
max_memory 4000 MB (current use 321 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9606241516019

WARN: Singularity detected in overlap matrix (condition number =  203). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.154846704479716  LUMO (Ag) = -0.154379304561516

WARN: Ag LUMO -0.154379304561516 < system HOMO -0.154846704479716


WARN: B2u HOMO -0.154846704479716 > system LUMO -0.154379304561516


WARN: B3u HOMO -0.154846704479716 > system LUMO -0.154379304561516

cycle= 1 E= -75.2674224197194  delta_E= -0.307  |g|= 0.242  |ddm|= 1.42
HOMO (B2u) = -0.423431408188683  LUMO (Ag) = -0.147745494594374
cycle= 2 E= -75.2901719236938  delta_E= -0.0227  |g|= 0.0499  |ddm|= 0.326
HOMO (B3u) = -0.385318413495459  LUMO (Ag) = -0.0975529483033097
cycle= 3 E= -75.2912021417108  delta_E= -0.00103  |g|= 0.0132  |ddm|= 0.0546
HOMO (B3u) = -0.387177687087388  LUMO (Ag) = -0.0946950408357176
cycle= 4 E= -75.291314408399  delta_E= -0.000112  |g|= 0.00225  |ddm|= 0.0161
HOMO (B2u) = -0.387899311052256  LUMO (Ag) = -0.095294592888326
cycle= 5 E= -75.2913182764059  delta_E= -3.87e-06  |g|= 0.000326  |ddm|= 0.00311
HOMO (B2u) = -0.387835444387874  LUMO (Ag) = -0.0952466102829217
cycle= 6 E= -75.2913183380417  delta_E= -6.16e-08  |g|= 4.01e-05  |ddm|= 0.000644
HOMO (B2u) = -0.387827943274184  LUMO (Ag) = -0.095234414042338
cycle= 7 E= -75.2913183390841  delta_E= -1.04e-09  |g|= 5.01e-06  |ddm|= 0.000118
HOMO (B3u) = -0.387827276401273  LUMO (Ag) = -0.0952333329362496
cycle= 8 E= -75.2913183390997  delta_E= -1.55e-11  |g|= 5.51e-07  |ddm|= 1.99e-05
HOMO (B3u) = -0.387827240724822  LUMO (Ag) = -0.0952331169886966
cycle= 9 E= -75.2913183390998  delta_E= -1.71e-13  |g|= 2.29e-08  |ddm|= 1.04e-06
HOMO (B3u) = -0.387827233118364  LUMO (Ag) = -0.0952331317889677
cycle= 10 E= -75.2913183390997  delta_E= 8.53e-14  |g|= 3.63e-09  |ddm|= 8.55e-08
HOMO (B2u) = -0.387827234291164  LUMO (Ag) = -0.0952331330214451
cycle= 11 E= -75.2913183390998  delta_E= -8.53e-14  |g|= 2.64e-09  |ddm|= 5.05e-09
HOMO (B2u) = -0.387827234009972  LUMO (Ag) = -0.0952331326582988
cycle= 12 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 2.05e-09  |ddm|= 2.38e-09
HOMO (B2u) = -0.387827234017247  LUMO (Ag) = -0.0952331324924031
cycle= 13 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 1.85e-09  |ddm|= 1.76e-09
HOMO (B2u) = -0.387827233970917  LUMO (Ag) = -0.0952331324569915
cycle= 14 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 1.55e-09  |ddm|= 9.87e-10
HOMO (B3u) = -0.387827233948745  LUMO (Ag) = -0.09523313245969
cycle= 15 E= -75.2913183390997  delta_E= 8.53e-14  |g|= 1.35e-09  |ddm|= 1.05e-09
HOMO (B2u) = -0.387827233907008  LUMO (Ag) = -0.09523313241906
cycle= 16 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 1.21e-09  |ddm|= 4.03e-10
HOMO (B2u) = -0.387827233900509  LUMO (Ag) = -0.0952331324084367
cycle= 17 E= -75.2913183390997  delta_E= -2.84e-14  |g|= 1.05e-09  |ddm|= 5.32e-10
HOMO (B2u) = -0.387827233741219  LUMO (Ag) = -0.0952331323123442
cycle= 18 E= -75.2913183390997  delta_E= 1.42e-14  |g|= 4.6e-10  |ddm|= 2.57e-09
HOMO (B2u) = -0.387827233740551  LUMO (Ag) = -0.0952331323055758
cycle= 19 E= -75.2913183390998  delta_E= -4.26e-14  |g|= 3.76e-10  |ddm|= 3.58e-10
HOMO (B2u) = -0.387827233758578  LUMO (Ag) = -0.0952331323190825
cycle= 20 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 3.11e-10  |ddm|= 2.31e-10
HOMO (B3u) = -0.387827233770217  LUMO (Ag) = -0.0952331323259754
cycle= 21 E= -75.2913183390999  delta_E= -1.28e-13  |g|= 2.63e-10  |ddm|= 1.75e-10
HOMO (B2u) = -0.387827233776461  LUMO (Ag) = -0.0952331323338182
cycle= 22 E= -75.2913183390999  delta_E=    0  |g|= 2.14e-10  |ddm|= 1.41e-10
HOMO (B2u) = -0.387827233781413  LUMO (Ag) = -0.095233132340197
cycle= 23 E= -75.2913183390997  delta_E= 1.28e-13  |g|= 1.74e-10  |ddm|= 1.2e-10
HOMO (B2u) = -0.387827233787541  LUMO (Ag) = -0.0952331323477055
cycle= 24 E= -75.2913183390997  delta_E=    0  |g|= 1.37e-10  |ddm|= 1.15e-10
HOMO (B2u) = -0.3878272337922  LUMO (Ag) = -0.0952331323538772
cycle= 25 E= -75.2913183390998  delta_E= -1.42e-14  |g|= 1.04e-10  |ddm|= 1.07e-10
HOMO (B2u) = -0.387827233796527  LUMO (Ag) = -0.0952331323601018
cycle= 26 E= -75.2913183390999  delta_E= -9.95e-14  |g|= 7.54e-11  |ddm|= 9.84e-11
HOMO (B2u) = -0.38782723379525  LUMO (Ag) = -0.0952331323584806
cycle= 27 E= -75.2913183390998  delta_E= 5.68e-14  |g|= 6.23e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.387827233793624  LUMO (Ag) = -0.0952331323567355
cycle= 28 E= -75.2913183390997  delta_E= 1.14e-13  |g|= 5.13e-11  |ddm|= 2.43e-11
HOMO (B2u) = -0.387827233792375  LUMO (Ag) = -0.0952331323556134
cycle= 29 E= -75.2913183390998  delta_E= -1.14e-13  |g|= 4.18e-11  |ddm|= 1.97e-11
HOMO (B2u) = -0.387827233791343  LUMO (Ag) = -0.0952331323549468
cycle= 30 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 3.34e-11  |ddm|= 1.63e-11
HOMO (B2u) = -0.387827233790614  LUMO (Ag) = -0.0952331323545385
cycle= 31 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 2.66e-11  |ddm|= 1.34e-11
HOMO (B2u) = -0.387827233790129  LUMO (Ag) = -0.0952331323543391
cycle= 32 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 2.1e-11  |ddm|= 1.1e-11
HOMO (B2u) = -0.387827233789836  LUMO (Ag) = -0.095233132354262
cycle= 33 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 1.65e-11  |ddm|= 8.38e-12
HOMO (B2u) = -0.387827233789693  LUMO (Ag) = -0.0952331323542613
cycle= 34 E= -75.2913183390998  delta_E= 7.11e-14  |g|= 1.32e-11  |ddm|= 5.9e-12
HOMO (B2u) = -0.387827233789681  LUMO (Ag) = -0.0952331323542935
cycle= 35 E= -75.2913183390998  delta_E= -7.11e-14  |g|= 1.09e-11  |ddm|= 3.81e-12
HOMO (B2u) = -0.387827233789643  LUMO (Ag) = -0.0952331323543204
cycle= 36 E= -75.2913183390998  delta_E= 1.42e-14  |g|= 8.88e-12  |ddm|= 3.1e-12
HOMO (B2u) = -0.387827233789581  LUMO (Ag) = -0.0952331323543363
cycle= 37 E= -75.2913183390997  delta_E= 8.53e-14  |g|= 7.2e-12  |ddm|= 2.52e-12
HOMO (B2u) = -0.38782723378951  LUMO (Ag) = -0.0952331323543427
cycle= 38 E= -75.2913183390997  delta_E= 1.42e-14  |g|= 5.81e-12  |ddm|= 2.04e-12
HOMO (B2u) = -0.387827233789439  LUMO (Ag) = -0.0952331323543364
cycle= 39 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 4.68e-12  |ddm|= 1.61e-12
HOMO (B2u) = -0.387827233789371  LUMO (Ag) = -0.0952331323543209
cycle= 40 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 3.78e-12  |ddm|= 1.28e-12
HOMO (B3u) = -0.387827233789306  LUMO (Ag) = -0.0952331323542972
cycle= 41 E= -75.2913183390998  delta_E= -4.26e-14  |g|= 3.06e-12  |ddm|= 1e-12
HOMO (B2u) = -0.387827233789249  LUMO (Ag) = -0.0952331323542707
cycle= 42 E= -75.2913183390998  delta_E=    0  |g|= 2.49e-12  |ddm|= 7.95e-13
HOMO (B2u) = -0.387827233789086  LUMO (Ag) = -0.0952331323542121
Extra cycle  E= -75.2913183390997  delta_E= 4.26e-14  |g|= 8.75e-13  |ddm|= 2.26e-12
converged SCF energy = -75.2913183390997

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpv__19u5z
max_memory 4000 MB (current use 321 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4857258490142  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5064676419928  dE = -0.020741793  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.68  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5184322052125  dE = -0.011964563  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0656  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5265434762509  dE = -0.008111271  S^2 = 0.0000000
               |grad[o]|=0.0908  |ddm|=0.0339  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5322928310123  dE = -0.0057493548  S^2 = 0.0000000
               |grad[o]|=0.0705  |ddm|=0.0223  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5362657422529  dE = -0.0039729112  S^2 = 0.0000000
               |grad[o]|=0.0523  |ddm|=0.0155  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5387478296721  dE = -0.0024820874  S^2 = 0.0000000
               |grad[o]|=0.0357  |ddm|=0.0116  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.539909490304  dE = -0.0011616606  S^2 = 0.0000000
               |grad[o]|=0.0201  |ddm|=0.0105  |maxRot[o]|=0.0799
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5400388138209  dE = -0.00012932352  S^2 = 0.0000000
               |grad[o]|=0.00582  |ddm|=0.0121  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5400404965111  dE = -1.6826902e-06  S^2 = 0.0000000
               |grad[o]|=0.000811  |ddm|=0.00672  |maxRot[o]|=0.00294
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5400405390561  dE = -4.2544983e-08  S^2 = 0.0000000
               |grad[o]|=0.000142  |ddm|=0.00102  |maxRot[o]|=0.000305
macro iter 11 (3 JK  0 micro), CASSCF E = -75.540040540097  dE = -1.0409025e-09  S^2 = 0.0000000
               |grad[o]|=2.61e-05  |ddm|=0.000167  |maxRot[o]|=3.46e-05
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5400405401291  dE = -3.2173375e-11  S^2 = 0.0000000
               |grad[o]|=4.43e-06  |ddm|=2.92e-05  |maxRot[o]|=5.26e-06
2-step CASSCF converged in 12 macro (58 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97266784 1.73807347 1.76671877 1.76671799 0.28541952 0.22251184
 0.22251147 0.02537909]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00752   0.00393   0.00000   0.00000  -0.00075
  0 C 2s       0.63584   0.61195  -0.00000  -0.00000  -0.30764
  0 C 3s      -0.02245   0.00972   0.00000   0.00000   0.02272
  0 C 2px     -0.00000   0.00000  -0.00000   0.70640   0.00000
  0 C 2py     -0.00000   0.00000   0.70640  -0.00000   0.00000
  0 C 2pz      0.30639  -0.35411   0.00000   0.00000   0.63428
  0 C 3px     -0.00000  -0.00000  -0.00000   0.02449   0.00000
  0 C 3py     -0.00000   0.00000   0.02449  -0.00000   0.00000
  0 C 3pz     -0.02442  -0.00191   0.00000   0.00000  -0.03747
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.01996  -0.00000   0.00000
  0 C 3dz^2    0.02599  -0.00343   0.00000   0.00000   0.03354
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.01996   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00752  -0.00393   0.00000   0.00000  -0.00075
  1 C 2s       0.63584  -0.61195  -0.00000  -0.00000  -0.30764
  1 C 3s      -0.02245  -0.00972  -0.00000  -0.00000   0.02272
  1 C 2px     -0.00000   0.00000   0.00000   0.70640  -0.00000
  1 C 2py      0.00000  -0.00000   0.70640   0.00000   0.00000
  1 C 2pz     -0.30639  -0.35411  -0.00000   0.00000  -0.63428
  1 C 3px      0.00000  -0.00000   0.00000   0.02449  -0.00000
  1 C 3py      0.00000  -0.00000   0.02449   0.00000  -0.00000
  1 C 3pz      0.02442  -0.00191   0.00000   0.00000   0.03747
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.01996  -0.00000   0.00000
  1 C 3dz^2    0.02599   0.00343  -0.00000  -0.00000   0.03354
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.01996   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.35370
  0 C 3s       0.00000   0.00000  -0.04177
  0 C 2px      0.70670  -0.00000   0.00000
  0 C 2py     -0.00000   0.70670  -0.00000
  0 C 2pz      0.00000  -0.00000   0.61017
  0 C 3px     -0.01201   0.00000   0.00000
  0 C 3py      0.00000  -0.01201  -0.00000
  0 C 3pz      0.00000   0.00000   0.02109
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02067  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01998
  0 C 3dxz    -0.02067   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s      -0.00000  -0.00000  -0.35370
  1 C 3s      -0.00000  -0.00000   0.04177
  1 C 2px     -0.70670  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70670   0.00000
  1 C 2pz      0.00000  -0.00000   0.61017
  1 C 3px      0.01201   0.00000  -0.00000
  1 C 3py      0.00000   0.01201   0.00000
  1 C 3pz      0.00000   0.00000   0.02109
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02067  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.01998
  1 C 3dxz    -0.02067  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99096816
<CAS-nat-orb|mo-hf>  4  4    0.99730114
<CAS-nat-orb|mo-hf>  5  5    0.99929409
<CAS-nat-orb|mo-hf>  6  6    0.99929408
<CAS-nat-orb|mo-hf>  7  7    0.97345971
<CAS-nat-orb|mo-hf>  8  8    0.97595061
<CAS-nat-orb|mo-hf>  9  9    0.97595057
<CAS-nat-orb|mo-hf>  10  10    0.79085172
<CAS-nat-orb|mo-hf>  10  14   -0.55412006
CASSCF energy = -75.5400405401291
CASCI E = -75.5400405401291  E(CI) = -16.0670213494963  S^2 = 0.0000000
Density matrix diagonal elements [1.97266775 1.7380736  1.76672189 1.76672139 0.28541547 0.22251034
 0.22251047 0.02537909]
i = 1  <i|F|i> = -11.34252691
i = 2  <i|F|i> = -11.34269152
i = 3  <i|F|i> =  -0.88490499
i = 4  <i|F|i> =  -0.51702295
i = 5  <i|F|i> =  -0.31987905
i = 6  <i|F|i> =  -0.31987895
i = 7  <i|F|i> =  -0.09258019
i = 8  <i|F|i> =   0.09780955
i = 9  <i|F|i> =   0.09780956
i = 10  <i|F|i> =   0.51775932
i = 11  <i|F|i> =   0.65630304
i = 12  <i|F|i> =   0.68901597
i = 13  <i|F|i> =   0.68901596
i = 14  <i|F|i> =   0.57399581
i = 15  <i|F|i> =   0.74230829
i = 16  <i|F|i> =   0.71116260
i = 17  <i|F|i> =   0.71116255
i = 18  <i|F|i> =   1.06116923
i = 19  <i|F|i> =   1.22037212
i = 20  <i|F|i> =   1.22037212
i = 21  <i|F|i> =   1.29798889
i = 22  <i|F|i> =   1.29798889
i = 23  <i|F|i> =   1.51778761
i = 24  <i|F|i> =   1.51778761
i = 25  <i|F|i> =   1.75389494
i = 26  <i|F|i> =   1.89460362
i = 27  <i|F|i> =   1.89460363
i = 28  <i|F|i> =   2.12067216
......production of RDMs took       2.65 sec
......reading the RDM took          0.42 sec
......production of RDMs took      25.13 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.82 sec

E(WickICNEVPT2-ijrs) =    -0.00027547139718
E(WickICNEVPT2- rsi) =    -0.00085563089180
E(WickICNEVPT2- ijr) =    -0.00034572390115
E(WickICNEVPT2-  rs) =    -0.03339557033249
E(WickICNEVPT2-  ij) =    -0.00008669621120
E(WickICNEVPT2-  ir) =    -0.00110535843989
E(WickICNEVPT2-   r) =    -0.05593162217821
E(WickICNEVPT2-   i) =    -0.00021383929121
E(WickICNEVPT2) = -75.63225045277227  E_corr_pt = -0.09220991264314032
Timings = pdms =   38.01 | eris =    0.62 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.51 | ij =    0.13 | ir =    0.29 | r =    3.09 | i =    1.38 | total =   44.09
Time cost =    352.796
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:59:49 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.640449353852 AA    0.000000000000   0.000000000000   3.100000000000 Bohr   0.0

nuclear repulsion = 11.6129032258065
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.55]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3536.09


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp75hfclew
max_memory 4000 MB (current use 319 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9340105731017

WARN: Singularity detected in overlap matrix (condition number =  188). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.14969326640479  LUMO (B3u) = -0.149693266404789

WARN: B2u HOMO -0.14969326640479 > system LUMO -0.149693266404789

cycle= 1 E= -75.3573845713053  delta_E= -0.423  |g|= 0.265  |ddm|= 1.55
HOMO (B2u) = -0.413310367291846  LUMO (B3u) = -0.0846696262312553
cycle= 2 E= -75.3843760014415  delta_E= -0.027  |g|= 0.0539  |ddm|= 0.354
HOMO (B2u) = -0.373182146511252  LUMO (B3u) = -0.0395668514335563
cycle= 3 E= -75.3858456567449  delta_E= -0.00147  |g|= 0.018  |ddm|= 0.0717
HOMO (B2u) = -0.377721327859487  LUMO (B3u) = -0.0440841679310574
cycle= 4 E= -75.3860530258635  delta_E= -0.000207  |g|= 0.000721  |ddm|= 0.0382
HOMO (B2u) = -0.377699771169468  LUMO (B3u) = -0.0442008432276684
cycle= 5 E= -75.3860532373451  delta_E= -2.11e-07  |g|= 8.07e-05  |ddm|= 0.00144
HOMO (B2u) = -0.377674560909568  LUMO (B3u) = -0.044174044628683
cycle= 6 E= -75.3860532409994  delta_E= -3.65e-09  |g|= 1.32e-05  |ddm|= 0.000134
HOMO (B2u) = -0.377672848926072  LUMO (B3u) = -0.0441758015090258
cycle= 7 E= -75.3860532411126  delta_E= -1.13e-10  |g|= 1.86e-06  |ddm|= 3.43e-05
HOMO (B2u) = -0.377672100443113  LUMO (B3u) = -0.0441752784120235
cycle= 8 E= -75.3860532411149  delta_E= -2.23e-12  |g|= 1.02e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.377672134543572  LUMO (B3u) = -0.0441753126357508
cycle= 9 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 9.15e-09  |ddm|= 2.08e-07
HOMO (B2u) = -0.377672135427861  LUMO (B3u) = -0.0441753150882741
cycle= 10 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 5.28e-09  |ddm|= 8.76e-09
HOMO (B2u) = -0.377672135485317  LUMO (B3u) = -0.0441753151248049
cycle= 11 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 4.99e-09  |ddm|= 4.29e-09
HOMO (B2u) = -0.377672134122637  LUMO (B3u) = -0.0441753136925174
cycle= 12 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 4.61e-09  |ddm|= 2.33e-09
HOMO (B2u) = -0.377672133903657  LUMO (B3u) = -0.0441753133840723
cycle= 13 E= -75.3860532411149  delta_E= -2.84e-14  |g|= 8.94e-10  |ddm|= 7.69e-09
HOMO (B2u) = -0.377672133973393  LUMO (B3u) = -0.0441753134345977
cycle= 14 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 7.9e-10  |ddm|= 4.35e-10
HOMO (B2u) = -0.37767213414151  LUMO (B3u) = -0.0441753135504194
cycle= 15 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 6.66e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.377672134097405  LUMO (B3u) = -0.0441753135970882
cycle= 16 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 7.82e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.377672134148776  LUMO (B3u) = -0.0441753136135251
cycle= 17 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 8.39e-10  |ddm|= 6.59e-10
HOMO (B2u) = -0.377672134162242  LUMO (B3u) = -0.0441753136099344
cycle= 18 E= -75.3860532411149  delta_E=    0  |g|= 5.71e-10  |ddm|= 5.55e-10
HOMO (B2u) = -0.377672134187557  LUMO (B3u) = -0.0441753136340385
cycle= 19 E= -75.3860532411149  delta_E=    0  |g|= 4.44e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.377672134218923  LUMO (B3u) = -0.0441753136628911
cycle= 20 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 3.14e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.377672134234333  LUMO (B3u) = -0.0441753136725847
cycle= 21 E= -75.3860532411149  delta_E= 4.26e-14  |g|= 1.86e-10  |ddm|= 2.78e-10
HOMO (B2u) = -0.377672134234364  LUMO (B3u) = -0.0441753136702842
cycle= 22 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 1.62e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.377672134234204  LUMO (B3u) = -0.0441753136686036
cycle= 23 E= -75.3860532411149  delta_E= -2.84e-14  |g|= 1.43e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.377672134231526  LUMO (B3u) = -0.0441753136668767
cycle= 24 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 1.3e-10  |ddm|= 5.92e-11
HOMO (B2u) = -0.377672134234441  LUMO (B3u) = -0.0441753136670375
cycle= 25 E= -75.3860532411149  delta_E= 4.26e-14  |g|= 1.06e-10  |ddm|= 6.65e-11
HOMO (B2u) = -0.377672134236893  LUMO (B3u) = -0.0441753136680616
cycle= 26 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 7.86e-11  |ddm|= 6.24e-11
HOMO (B2u) = -0.377672134238189  LUMO (B3u) = -0.044175313668538
cycle= 27 E= -75.3860532411149  delta_E=    0  |g|= 6.05e-11  |ddm|= 4.29e-11
HOMO (B2u) = -0.377672134242241  LUMO (B3u) = -0.0441753136702934
Extra cycle  E= -75.3860532411149  delta_E= -2.84e-14  |g|= 1.93e-11  |ddm|= 1.02e-10
converged SCF energy = -75.3860532411149

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp75hfclew
max_memory 4000 MB (current use 319 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4764159496076  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4872396096399  dE = -0.01082366  S^2 = 0.0000000
               |grad[o]|=0.0774  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4972270887841  dE = -0.0099874791  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0605  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5063987161786  dE = -0.0091716274  S^2 = 0.0000000
               |grad[o]|=0.0682  |ddm|=0.0991  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5143818192369  dE = -0.0079831031  S^2 = 0.0000000
               |grad[o]|=0.0667  |ddm|=0.194  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5204922499846  dE = -0.0061104307  S^2 = 0.0000000
               |grad[o]|=0.0614  |ddm|=0.222  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5243786184255  dE = -0.0038863684  S^2 = 0.0000000
               |grad[o]|=0.048  |ddm|=0.157  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.525753421223  dE = -0.0013748028  S^2 = 0.0000000
               |grad[o]|=0.0286  |ddm|=  0.1  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5259733306901  dE = -0.00021990947  S^2 = 0.0000000
               |grad[o]|=0.0122  |ddm|=0.0931  |maxRot[o]|=0.0188
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5262794790052  dE = -0.00030614832  S^2 = 0.0000000
               |grad[o]|=0.0118  |ddm|=0.171  |maxRot[o]|=0.00855
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5272581187872  dE = -0.00097863978  S^2 = 0.0000000
               |grad[o]|=0.022  |ddm|=0.309  |maxRot[o]|=0.019
macro iter 11 (4 JK  0 micro), CASSCF E = -75.5294134822322  dE = -0.0021553634  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.465  |maxRot[o]|=0.0329
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5311332612993  dE = -0.0017197791  S^2 = 0.0000000
               |grad[o]|=0.0308  |ddm|=0.348  |maxRot[o]|= 0.04
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5314667399081  dE = -0.00033347861  S^2 = 0.0000000
               |grad[o]|=0.0126  |ddm|=0.107  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5315144591188  dE = -4.7719211e-05  S^2 = 0.0000000
               |grad[o]|=0.00437  |ddm|=0.0224  |maxRot[o]|=0.00856
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5315175887209  dE = -3.1296021e-06  S^2 = 0.0000000
               |grad[o]|=0.00109  |ddm|=0.00794  |maxRot[o]|=0.00211
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5315177947156  dE = -2.059947e-07  S^2 = 0.0000000
               |grad[o]|=0.000288  |ddm|=0.00204  |maxRot[o]|=0.000518
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5315178084869  dE = -1.377127e-08  S^2 = 0.0000000
               |grad[o]|=7.68e-05  |ddm|=0.000533  |maxRot[o]|=0.000129
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5315178094242  dE = -9.3736219e-10  S^2 = 0.0000000
               |grad[o]|=2.05e-05  |ddm|=0.00014  |maxRot[o]|=3.33e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.5315178094869  dE = -6.268408e-11  S^2 = 0.0000000
               |grad[o]|=5.47e-06  |ddm|=3.78e-05  |maxRot[o]|=8.79e-06
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5315178094905  dE = -3.6379788e-12  S^2 = 0.0000000
               |grad[o]|=1.41e-06  |ddm|=9.82e-06  |maxRot[o]|=2.34e-06
2-step CASSCF converged in 20 macro (80 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97199268 1.74648642 0.28354296 1.75359768 1.75359611 0.2322697
 0.23226976 0.02624468]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00771   0.00402  -0.00073   0.00000   0.00000
  0 C 2s       0.63877   0.61742  -0.30165   0.00000   0.00000
  0 C 3s      -0.02059   0.00990   0.02411   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.70637
  0 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  0 C 2pz      0.30053  -0.34447   0.63708  -0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000   0.02607
  0 C 3py      0.00000  -0.00000   0.00000   0.02607  -0.00000
  0 C 3pz     -0.02284  -0.00193  -0.03571   0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000   0.01911  -0.00000
  0 C 3dz^2    0.02539  -0.00363   0.03576   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000   0.01911
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00771  -0.00402  -0.00073   0.00000   0.00000
  1 C 2s       0.63877  -0.61742  -0.30165  -0.00000  -0.00000
  1 C 3s      -0.02059  -0.00990   0.02411  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000   0.00000   0.70637
  1 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  1 C 2pz     -0.30053  -0.34447  -0.63708  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000   0.02607
  1 C 3py      0.00000  -0.00000  -0.00000   0.02607  -0.00000
  1 C 3pz      0.02284  -0.00193   0.03571   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01911   0.00000
  1 C 3dz^2    0.02539   0.00363   0.03576  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000  -0.01911
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s       0.00000   0.00000   0.34413
  0 C 3s       0.00000   0.00000  -0.04088
  0 C 2px      0.00000   0.70673   0.00000
  0 C 2py      0.70673   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.61571
  0 C 3px      0.00000  -0.01104   0.00000
  0 C 3py     -0.01104   0.00000   0.00000
  0 C 3pz      0.00000   0.00000   0.02055
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.02028   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01955
  0 C 3dxz     0.00000  -0.02028   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.34413
  1 C 3s      -0.00000  -0.00000   0.04088
  1 C 2px     -0.00000  -0.70673  -0.00000
  1 C 2py     -0.70673  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.61571
  1 C 3px     -0.00000   0.01104  -0.00000
  1 C 3py      0.01104  -0.00000  -0.00000
  1 C 3pz      0.00000   0.00000   0.02055
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.02028   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.01955
  1 C 3dxz     0.00000  -0.02028   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99970732
<CAS-nat-orb|mo-hf>  4  4    0.99969115
<CAS-nat-orb|mo-hf>  5  5    0.99206275
<CAS-nat-orb|mo-hf>  6  6    0.99749856
<CAS-nat-orb|mo-hf>  7  7    0.98939317
<CAS-nat-orb|mo-hf>  8  8    0.97289816
<CAS-nat-orb|mo-hf>  9  9    0.95779871
<CAS-nat-orb|mo-hf>  10  10    0.87337001
<CAS-nat-orb|mo-hf>  10  12   -0.42886300
CASSCF energy = -75.5315178094905
CASCI E = -75.5315178094905  E(CI) = -15.9739146588953  S^2 = 0.0000000
Density matrix diagonal elements [1.97199259 1.7464861  0.28354157 1.75359887 1.75359697 0.23226957
 0.23226961 0.02624474]
i = 1  <i|F|i> = -11.34468693
i = 2  <i|F|i> = -11.34492180
i = 3  <i|F|i> =  -0.87754086
i = 4  <i|F|i> =  -0.52335791
i = 5  <i|F|i> =  -0.09084200
i = 6  <i|F|i> =  -0.31443583
i = 7  <i|F|i> =  -0.31443548
i = 8  <i|F|i> =   0.08930509
i = 9  <i|F|i> =   0.08930510
i = 10  <i|F|i> =   0.49496168
i = 11  <i|F|i> =   0.65916167
i = 12  <i|F|i> =   0.57652368
i = 13  <i|F|i> =   0.68989692
i = 14  <i|F|i> =   0.68989692
i = 15  <i|F|i> =   0.74637407
i = 16  <i|F|i> =   0.71175141
i = 17  <i|F|i> =   0.71175144
i = 18  <i|F|i> =   1.05680805
i = 19  <i|F|i> =   1.21500629
i = 20  <i|F|i> =   1.21500631
i = 21  <i|F|i> =   1.30262422
i = 22  <i|F|i> =   1.30262422
i = 23  <i|F|i> =   1.51083587
i = 24  <i|F|i> =   1.51083587
i = 25  <i|F|i> =   1.72492645
i = 26  <i|F|i> =   1.87803831
i = 27  <i|F|i> =   1.87803834
i = 28  <i|F|i> =   2.11989234
......production of RDMs took       1.81 sec
......reading the RDM took          0.41 sec
......production of RDMs took      26.04 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickICNEVPT2-ijrs) =    -0.00027575425509
E(WickICNEVPT2- rsi) =    -0.00085246269429
E(WickICNEVPT2- ijr) =    -0.00033999442930
E(WickICNEVPT2-  rs) =    -0.03305608663457
E(WickICNEVPT2-  ij) =    -0.00008271681122
E(WickICNEVPT2-  ir) =    -0.00109499351094
E(WickICNEVPT2-   r) =    -0.05679919892602
E(WickICNEVPT2-   i) =    -0.00020790514986
E(WickICNEVPT2) = -75.62422692190184  E_corr_pt = -0.09270911241129215
Timings = pdms =   38.01 | eris =    0.62 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.31 | ij =    0.07 | ir =    0.15 | r =    2.03 | i =    0.84 | total =   42.10
Time cost =    361.867
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:05:51 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.666908214398 AA    0.000000000000   0.000000000000   3.150000000000 Bohr   0.0

nuclear repulsion = 11.4285714285714
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.575]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3675.94


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpwmmgbyz5
max_memory 4000 MB (current use 318 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9089301361996

WARN: Singularity detected in overlap matrix (condition number =  175). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.144793107119776  LUMO (B3u) = -0.144793107119776

WARN: B2u HOMO -0.144793107119776 > system LUMO -0.144793107119776

cycle= 1 E= -75.3499635205345  delta_E= -0.441  |g|= 0.262  |ddm|= 1.54
HOMO (B2u) = -0.407994029365035  LUMO (B3u) = -0.0815659278261179
cycle= 2 E= -75.3765746590879  delta_E= -0.0266  |g|= 0.0534  |ddm|= 0.353
HOMO (B2u) = -0.368435737958924  LUMO (B3u) = -0.037056221089633
cycle= 3 E= -75.3780458200466  delta_E= -0.00147  |g|= 0.0181  |ddm|= 0.0711
HOMO (B2u) = -0.372975542135575  LUMO (B3u) = -0.0415562017768406
cycle= 4 E= -75.3782577251018  delta_E= -0.000212  |g|= 0.000712  |ddm|= 0.0382
HOMO (B2u) = -0.372986320268992  LUMO (B3u) = -0.0417075409102713
cycle= 5 E= -75.3782579293203  delta_E= -2.04e-07  |g|= 8.31e-05  |ddm|= 0.00134
HOMO (B2u) = -0.37295840763499  LUMO (B3u) = -0.0416782676150322
cycle= 6 E= -75.3782579331954  delta_E= -3.88e-09  |g|= 1.36e-05  |ddm|= 0.000138
HOMO (B2u) = -0.37295677807502  LUMO (B3u) = -0.0416799724229746
cycle= 7 E= -75.3782579333153  delta_E= -1.2e-10  |g|= 1.9e-06  |ddm|= 3.4e-05
HOMO (B2u) = -0.372956024408942  LUMO (B3u) = -0.0416794932470663
cycle= 8 E= -75.3782579333177  delta_E= -2.42e-12  |g|= 1.05e-07  |ddm|= 4.17e-06
HOMO (B2u) = -0.372956052023502  LUMO (B3u) = -0.0416795190602691
cycle= 9 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 8.21e-09  |ddm|= 2.09e-07
HOMO (B2u) = -0.372956052949556  LUMO (B3u) = -0.0416795215603419
cycle= 10 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 4.91e-09  |ddm|= 8.05e-09
HOMO (B2u) = -0.372956052906223  LUMO (B3u) = -0.0416795214922563
cycle= 11 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 4.53e-09  |ddm|= 4.18e-09
HOMO (B2u) = -0.372956051583859  LUMO (B3u) = -0.0416795201009598
cycle= 12 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 4.18e-09  |ddm|= 2.1e-09
HOMO (B2u) = -0.372956051859913  LUMO (B3u) = -0.0416795203493001
cycle= 13 E= -75.3782579333176  delta_E= 5.68e-14  |g|= 3.58e-09  |ddm|= 9.57e-10
HOMO (B2u) = -0.372956051442394  LUMO (B3u) = -0.0416795198744974
cycle= 14 E= -75.3782579333177  delta_E= -7.11e-14  |g|= 6.87e-10  |ddm|= 5.81e-09
HOMO (B2u) = -0.372956051678606  LUMO (B3u) = -0.0416795200412738
cycle= 15 E= -75.3782579333177  delta_E=    0  |g|= 6.54e-10  |ddm|= 1.57e-09
HOMO (B2u) = -0.372956051603979  LUMO (B3u) = -0.0416795200817033
cycle= 16 E= -75.3782579333177  delta_E= 4.26e-14  |g|= 8e-10  |ddm|= 1.64e-09
HOMO (B2u) = -0.372956051656126  LUMO (B3u) = -0.0416795200906306
cycle= 17 E= -75.3782579333176  delta_E= 7.11e-14  |g|= 8.09e-10  |ddm|= 7.4e-10
HOMO (B2u) = -0.372956051662841  LUMO (B3u) = -0.0416795200818745
cycle= 18 E= -75.3782579333178  delta_E= -1.71e-13  |g|= 5.76e-10  |ddm|= 4.36e-10
HOMO (B2u) = -0.37295605168483  LUMO (B3u) = -0.0416795201033162
cycle= 19 E= -75.3782579333176  delta_E= 1.14e-13  |g|= 4.86e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.372956051711204  LUMO (B3u) = -0.0416795201278921
cycle= 20 E= -75.3782579333177  delta_E= -5.68e-14  |g|= 3.79e-10  |ddm|= 1.94e-10
HOMO (B2u) = -0.372956051722233  LUMO (B3u) = -0.0416795201341123
cycle= 21 E= -75.3782579333176  delta_E= 8.53e-14  |g|= 2.58e-10  |ddm|= 2.18e-10
HOMO (B2u) = -0.372956051734037  LUMO (B3u) = -0.0416795201426549
cycle= 22 E= -75.3782579333177  delta_E= -5.68e-14  |g|= 1.57e-10  |ddm|= 1.95e-10
HOMO (B2u) = -0.372956051733242  LUMO (B3u) = -0.0416795201402833
cycle= 23 E= -75.3782579333177  delta_E=    0  |g|= 1.49e-10  |ddm|= 5.82e-11
HOMO (B2u) = -0.372956051729244  LUMO (B3u) = -0.041679520138044
cycle= 24 E= -75.3782579333177  delta_E= -7.11e-14  |g|= 1.38e-10  |ddm|= 5.99e-11
HOMO (B2u) = -0.37295605173215  LUMO (B3u) = -0.0416795201379914
cycle= 25 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 1.13e-10  |ddm|= 6.49e-11
HOMO (B2u) = -0.372956051734061  LUMO (B3u) = -0.0416795201385795
cycle= 26 E= -75.3782579333177  delta_E= 4.26e-14  |g|= 8.79e-11  |ddm|= 5.32e-11
HOMO (B2u) = -0.372956051735019  LUMO (B3u) = -0.0416795201387532
cycle= 27 E= -75.3782579333176  delta_E= 4.26e-14  |g|= 7.06e-11  |ddm|= 3.75e-11
HOMO (B2u) = -0.37295605173588  LUMO (B3u) = -0.0416795201388605
cycle= 28 E= -75.3782579333177  delta_E= -8.53e-14  |g|= 5.47e-11  |ddm|= 3.39e-11
HOMO (B2u) = -0.372956051736757  LUMO (B3u) = -0.0416795201391078
cycle= 29 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 4.19e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.372956051737369  LUMO (B3u) = -0.0416795201392997
cycle= 30 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 3.33e-11  |ddm|= 1.96e-11
HOMO (B2u) = -0.372956051737816  LUMO (B3u) = -0.0416795201394939
cycle= 31 E= -75.3782579333177  delta_E= -4.26e-14  |g|= 2.85e-11  |ddm|= 1.23e-11
HOMO (B2u) = -0.372956051738143  LUMO (B3u) = -0.0416795201396038
cycle= 32 E= -75.3782579333176  delta_E= 9.95e-14  |g|= 2.36e-11  |ddm|= 1.18e-11
HOMO (B2u) = -0.372956051738564  LUMO (B3u) = -0.0416795201397135
cycle= 33 E= -75.3782579333177  delta_E= -5.68e-14  |g|= 1.89e-11  |ddm|= 1.09e-11
HOMO (B2u) = -0.372956051738853  LUMO (B3u) = -0.0416795201397992
cycle= 34 E= -75.3782579333177  delta_E=    0  |g|= 1.51e-11  |ddm|= 8.72e-12
HOMO (B2u) = -0.372956051739542  LUMO (B3u) = -0.0416795201399536
Extra cycle  E= -75.3782579333177  delta_E= 2.84e-14  |g|= 5.25e-12  |ddm|= 2.3e-11
converged SCF energy = -75.3782579333177

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpwmmgbyz5
max_memory 4000 MB (current use 318 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4725934895911  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.483738543246  dE = -0.011145054  S^2 = 0.0000000
               |grad[o]|=0.0791  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4938627006704  dE = -0.010124157  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0567  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.50289353368  dE = -0.009030833  S^2 = 0.0000000
               |grad[o]|=0.0659  |ddm|=0.0667  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5105630063414  dE = -0.0076694727  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5162482933842  dE = -0.005685287  S^2 = 0.0000000
               |grad[o]|=0.051  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5197013968003  dE = -0.0034531034  S^2 = 0.0000000
               |grad[o]|=0.0355  |ddm|=0.0366  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.5210733309374  dE = -0.0013719341  S^2 = 0.0000000
               |grad[o]|=0.0178  |ddm|=0.0634  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5215988184226  dE = -0.00052548749  S^2 = 0.0000000
               |grad[o]|=0.0113  |ddm|=0.115  |maxRot[o]|= 0.02
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5222374490246  dE = -0.0006386306  S^2 = 0.0000000
               |grad[o]|=0.0104  |ddm|=0.0771  |maxRot[o]|=0.033
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5226563533734  dE = -0.00041890435  S^2 = 0.0000000
               |grad[o]|=0.00749  |ddm|=0.064  |maxRot[o]|=0.0335
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5227995203782  dE = -0.000143167  S^2 = 0.0000000
               |grad[o]|=0.00438  |ddm|=0.0306  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5228528705774  dE = -5.3350199e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.0113  |maxRot[o]|=0.0144
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5228636275606  dE = -1.0756983e-05  S^2 = 0.0000000
               |grad[o]|=0.00112  |ddm|=0.00642  |maxRot[o]|=0.00668
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5228655523388  dE = -1.9247783e-06  S^2 = 0.0000000
               |grad[o]|=0.000479  |ddm|=0.00263  |maxRot[o]|=0.00287
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5228658806958  dE = -3.2835698e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.00108  |maxRot[o]|=0.00119
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5228659357624  dE = -5.5066636e-08  S^2 = 0.0000000
               |grad[o]|=8.2e-05  |ddm|=0.000438  |maxRot[o]|=0.000488
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5228659449374  dE = -9.1749826e-09  S^2 = 0.0000000
               |grad[o]|=3.35e-05  |ddm|=0.000178  |maxRot[o]|=0.000199
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5228659464735  dE = -1.5360513e-09  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.23e-05  |maxRot[o]|=8.09e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.5228659467353  dE = -2.6184921e-10  S^2 = 0.0000000
               |grad[o]|=5.53e-06  |ddm|=2.94e-05  |maxRot[o]|=3.29e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5228659467818  dE = -4.6497917e-11  S^2 = 0.0000000
               |grad[o]|=2.25e-06  |ddm|=1.19e-05  |maxRot[o]|=1.33e-05
2-step CASSCF converged in 20 macro (77 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96757995 1.92636359 1.90257312 1.85304912 0.08669295 0.15330618
 0.05997838 0.05045671]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00942   0.00931  -0.00604   0.00000   0.00000
  0 C 2s       0.58733   0.63316  -0.39276   0.00000  -0.00000
  0 C 3s      -0.02996   0.01840  -0.05304   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69586
  0 C 2py      0.00000   0.00000   0.00000   0.70455   0.00000
  0 C 2pz      0.38981  -0.31366   0.58451   0.00000  -0.00000
  0 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05174
  0 C 3py      0.00000  -0.00000   0.00000   0.04283  -0.00000
  0 C 3pz     -0.02787  -0.00316  -0.00116   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.04212  -0.00000
  0 C 3dz^2    0.03630  -0.01553   0.03447   0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000  -0.11447
 0 C 3dx2-y2  -0.00196   0.00750  -0.00750   0.00000  -0.00000
  1 C 1s       0.00942  -0.00931  -0.00604   0.00000   0.00000
  1 C 2s       0.58733  -0.63316  -0.39276  -0.00000  -0.00000
  1 C 3s      -0.02996  -0.01840  -0.05304  -0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69586
  1 C 2py     -0.00000   0.00000  -0.00000   0.70455   0.00000
  1 C 2pz     -0.38981  -0.31366  -0.58451  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000   0.00000  -0.05174
  1 C 3py     -0.00000  -0.00000  -0.00000   0.04283  -0.00000
  1 C 3pz      0.02787  -0.00316   0.00116   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.04212   0.00000
  1 C 3dz^2    0.03630   0.01553   0.03447  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000   0.11447
 1 C 3dx2-y2  -0.00196  -0.00750  -0.00750   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s       0.00000  -0.00000   0.31126
  0 C 3s       0.00000   0.00000   0.04123
  0 C 2px     -0.00000   0.69686   0.00000
  0 C 2py      0.70644  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.62985
  0 C 3px     -0.00000   0.00767   0.00000
  0 C 3py     -0.02723  -0.00000   0.00000
  0 C 3pz      0.00000   0.00000  -0.05999
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.01434   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000   0.01543
  0 C 3dxz    -0.00000  -0.11967   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02938
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s      -0.00000  -0.00000  -0.31126
  1 C 3s      -0.00000  -0.00000  -0.04123
  1 C 2px     -0.00000  -0.69686  -0.00000
  1 C 2py     -0.70644   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.62985
  1 C 3px      0.00000  -0.00767  -0.00000
  1 C 3py      0.02723   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.05999
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01434  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.01543
  1 C 3dxz    -0.00000  -0.11967   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02938
<CAS-nat-orb|mo-hf>  3  3    0.98488177
<CAS-nat-orb|mo-hf>  4  4    0.99976478
<CAS-nat-orb|mo-hf>  5  5    0.98488756
<CAS-nat-orb|mo-hf>  6  6    0.99934351
<CAS-nat-orb|mo-hf>  7  7    0.94550984
<CAS-nat-orb|mo-hf>  8  8    0.96719800
<CAS-nat-orb|mo-hf>  9  9    0.95784087
<CAS-nat-orb|mo-hf>  10  10    0.82549313
<CAS-nat-orb|mo-hf>  10  11   -0.53364519
CASSCF energy = -75.5228659467818
CASCI E = -75.5228659467818  E(CI) = -15.8845981664542  S^2 = 0.0000000
Density matrix diagonal elements [1.96757991 1.92636425 1.90257844 1.85304905 0.08668752 0.15330602
 0.05997801 0.0504568 ]
i = 1  <i|F|i> = -11.33674529
i = 2  <i|F|i> = -11.33675283
i = 3  <i|F|i> =  -0.88551728
i = 4  <i|F|i> =  -0.59963609
i = 5  <i|F|i> =  -0.40273020
i = 6  <i|F|i> =  -0.33727456
i = 7  <i|F|i> =   0.06361541
i = 8  <i|F|i> =   0.10630660
i = 9  <i|F|i> =   0.20959079
i = 10  <i|F|i> =   0.45728881
i = 11  <i|F|i> =   0.56339554
i = 12  <i|F|i> =   0.68392255
i = 13  <i|F|i> =   0.68760840
i = 14  <i|F|i> =   0.65697447
i = 15  <i|F|i> =   0.73254179
i = 16  <i|F|i> =   0.70900041
i = 17  <i|F|i> =   0.72285354
i = 18  <i|F|i> =   1.05235276
i = 19  <i|F|i> =   1.14674207
i = 20  <i|F|i> =   1.21205890
i = 21  <i|F|i> =   1.29773601
i = 22  <i|F|i> =   1.29790745
i = 23  <i|F|i> =   1.48990403
i = 24  <i|F|i> =   1.48787047
i = 25  <i|F|i> =   1.69726098
i = 26  <i|F|i> =   1.81014255
i = 27  <i|F|i> =   1.87735389
i = 28  <i|F|i> =   2.13374440
......production of RDMs took       1.86 sec
......reading the RDM took          0.42 sec
......production of RDMs took      25.35 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICNEVPT2-ijrs) =    -0.00028234425255
E(WickICNEVPT2- rsi) =    -0.00080818583139
E(WickICNEVPT2- ijr) =    -0.00029150356204
E(WickICNEVPT2-  rs) =    -0.03540315177256
E(WickICNEVPT2-  ij) =    -0.00008991723064
E(WickICNEVPT2-  ir) =    -0.00108755252811
E(WickICNEVPT2-   r) =    -0.05616521955029
E(WickICNEVPT2-   i) =    -0.00009820392400
E(WickICNEVPT2) = -75.61709202543339  E_corr_pt = -0.09422607865157828
Timings = pdms =   37.38 | eris =    0.03 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.98 | i =    0.83 | total =   40.74
Time cost =    218.572
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:09:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.693367074944 AA    0.000000000000   0.000000000000   3.200000000000 Bohr   0.0

nuclear repulsion = 11.25
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.6]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3856.34


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpesv6sqs7
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8853199307072

WARN: Singularity detected in overlap matrix (condition number =  163). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.140132093357863  LUMO (B3u) = -0.140132093357862

WARN: B2u HOMO -0.140132093357863 > system LUMO -0.140132093357862

cycle= 1 E= -75.3423788059563  delta_E= -0.457  |g|= 0.259  |ddm|= 1.53
HOMO (B2u) = -0.402834374141249  LUMO (B3u) = -0.0785386739836396
cycle= 2 E= -75.3685959970365  delta_E= -0.0262  |g|= 0.053  |ddm|= 0.353
HOMO (B2u) = -0.363851731217669  LUMO (B3u) = -0.0346304224365195
cycle= 3 E= -75.3700649559039  delta_E= -0.00147  |g|= 0.0182  |ddm|= 0.0704
HOMO (B2u) = -0.368389012587525  LUMO (B3u) = -0.0391108103436437
cycle= 4 E= -75.3702805696256  delta_E= -0.000216  |g|= 0.000703  |ddm|= 0.0381
HOMO (B2u) = -0.368430097958781  LUMO (B3u) = -0.039294541003682
cycle= 5 E= -75.37028076688  delta_E= -1.97e-07  |g|= 8.62e-05  |ddm|= 0.00125
HOMO (B2u) = -0.368399790742495  LUMO (B3u) = -0.0392632961118453
cycle= 6 E= -75.3702807710483  delta_E= -4.17e-09  |g|= 1.41e-05  |ddm|= 0.000143
HOMO (B2u) = -0.368398140839552  LUMO (B3u) = -0.0392648663308166
cycle= 7 E= -75.3702807711757  delta_E= -1.27e-10  |g|= 1.92e-06  |ddm|= 3.39e-05
HOMO (B2u) = -0.368397398348841  LUMO (B3u) = -0.0392644368517082
cycle= 8 E= -75.3702807711782  delta_E= -2.47e-12  |g|= 1.08e-07  |ddm|= 4.2e-06
HOMO (B2u) = -0.368397420522795  LUMO (B3u) = -0.0392644560500555
cycle= 9 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 7.49e-09  |ddm|= 2.14e-07
HOMO (B2u) = -0.368397421405054  LUMO (B3u) = -0.0392644585080291
cycle= 10 E= -75.3702807711781  delta_E= 5.68e-14  |g|= 4.69e-09  |ddm|= 7.64e-09
HOMO (B2u) = -0.368397421287425  LUMO (B3u) = -0.0392644583623032
cycle= 11 E= -75.3702807711782  delta_E= -8.53e-14  |g|= 4.19e-09  |ddm|= 4.08e-09
HOMO (B2u) = -0.368397419986153  LUMO (B3u) = -0.0392644569925067
cycle= 12 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 3.87e-09  |ddm|= 1.94e-09
HOMO (B2u) = -0.368397420307889  LUMO (B3u) = -0.039264457288484
cycle= 13 E= -75.3702807711782  delta_E=    0  |g|= 3.34e-09  |ddm|= 8.4e-10
HOMO (B2u) = -0.36839741992113  LUMO (B3u) = -0.0392644568733392
cycle= 14 E= -75.3702807711782  delta_E= -7.11e-14  |g|= 5.28e-10  |ddm|= 5e-09
HOMO (B2u) = -0.368397420132673  LUMO (B3u) = -0.0392644570113275
cycle= 15 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 5.84e-10  |ddm|= 1.53e-09
HOMO (B2u) = -0.368397420046868  LUMO (B3u) = -0.0392644570358247
cycle= 16 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 7.21e-10  |ddm|= 1.54e-09
HOMO (B2u) = -0.368397420093481  LUMO (B3u) = -0.039264457038268
cycle= 17 E= -75.3702807711782  delta_E= 5.68e-14  |g|= 7.08e-10  |ddm|= 7.34e-10
HOMO (B2u) = -0.368397420093854  LUMO (B3u) = -0.0392644570251925
cycle= 18 E= -75.3702807711783  delta_E= -8.53e-14  |g|= 5.03e-10  |ddm|= 3.46e-10
HOMO (B2u) = -0.368397420112622  LUMO (B3u) = -0.0392644570440158
cycle= 19 E= -75.3702807711782  delta_E= 5.68e-14  |g|= 4.32e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.36839742013449  LUMO (B3u) = -0.0392644570648008
cycle= 20 E= -75.3702807711782  delta_E=    0  |g|= 3.4e-10  |ddm|= 1.43e-10
HOMO (B2u) = -0.368397420141465  LUMO (B3u) = -0.0392644570678046
cycle= 21 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 2.32e-10  |ddm|= 1.79e-10
HOMO (B2u) = -0.368397420150091  LUMO (B3u) = -0.0392644570740966
cycle= 22 E= -75.3702807711782  delta_E= 4.26e-14  |g|= 1.37e-10  |ddm|= 1.65e-10
HOMO (B2u) = -0.368397420149817  LUMO (B3u) = -0.039264457072194
cycle= 23 E= -75.3702807711782  delta_E= -4.26e-14  |g|= 1.32e-10  |ddm|= 4.11e-11
HOMO (B2u) = -0.368397420145925  LUMO (B3u) = -0.0392644570701027
cycle= 24 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 1.23e-10  |ddm|= 5.37e-11
HOMO (B2u) = -0.368397420148405  LUMO (B3u) = -0.0392644570698319
cycle= 25 E= -75.3702807711782  delta_E= 7.11e-14  |g|= 9.96e-11  |ddm|= 5.6e-11
HOMO (B2u) = -0.368397420149645  LUMO (B3u) = -0.0392644570699849
cycle= 26 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 7.83e-11  |ddm|= 4.05e-11
HOMO (B2u) = -0.368397420150149  LUMO (B3u) = -0.0392644570698613
cycle= 27 E= -75.3702807711783  delta_E= -7.11e-14  |g|= 6.41e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.36839742015063  LUMO (B3u) = -0.0392644570697265
cycle= 28 E= -75.3702807711782  delta_E= 7.11e-14  |g|= 5e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.368397420151194  LUMO (B3u) = -0.0392644570697681
cycle= 29 E= -75.3702807711782  delta_E=    0  |g|= 3.85e-11  |ddm|= 2.34e-11
HOMO (B2u) = -0.368397420152603  LUMO (B3u) = -0.0392644570699488
Extra cycle  E= -75.3702807711782  delta_E= -2.84e-14  |g|= 1.36e-11  |ddm|= 5.45e-11
converged SCF energy = -75.3702807711782

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpesv6sqs7
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.468663923479  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4801659097187  dE = -0.011501986  S^2 = 0.0000000
               |grad[o]|=0.0808  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4904755225418  dE = -0.010309613  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0571  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4994469984987  dE = -0.008971476  S^2 = 0.0000000
               |grad[o]|=0.0646  |ddm|=0.0512  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5069095409411  dE = -0.0074625424  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0778  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5123640585539  dE = -0.0054545176  S^2 = 0.0000000
               |grad[o]|=0.0456  |ddm|=0.0796  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5156468201299  dE = -0.0032827616  S^2 = 0.0000000
               |grad[o]|=0.0301  |ddm|=0.0211  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5168779321717  dE = -0.001231112  S^2 = 0.0000000
               |grad[o]|=0.015  |ddm|=0.0787  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5176271585408  dE = -0.00074922637  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0722  |maxRot[o]|= 0.04
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5179500779134  dE = -0.00032291937  S^2 = 0.0000000
               |grad[o]|=0.00624  |ddm|=0.0442  |maxRot[o]|=0.0327
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5180290722482  dE = -7.8994335e-05  S^2 = 0.0000000
               |grad[o]|=0.00298  |ddm|=0.0185  |maxRot[o]|=0.0178
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5180431645367  dE = -1.4092289e-05  S^2 = 0.0000000
               |grad[o]|=0.00127  |ddm|=0.00708  |maxRot[o]|=0.0078
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5180453677531  dE = -2.2032164e-06  S^2 = 0.0000000
               |grad[o]|=0.000512  |ddm|=0.00271  |maxRot[o]|=0.00313
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5180456955226  dE = -3.2776948e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.00104  |maxRot[o]|=0.00122
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5180457433191  dE = -4.7796476e-08  S^2 = 0.0000000
               |grad[o]|=7.71e-05  |ddm|=0.000395  |maxRot[o]|=0.000466
macro iter 15 (2 JK  0 micro), CASSCF E = -75.518045750198  dE = -6.878949e-09  S^2 = 0.0000000
               |grad[o]|=2.95e-05  |ddm|=0.00015  |maxRot[o]|=0.000178
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5180457511752  dE = -9.7713837e-10  S^2 = 0.0000000
               |grad[o]|=1.12e-05  |ddm|=5.71e-05  |maxRot[o]|=6.77e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5180457513066  dE = -1.3146462e-10  S^2 = 0.0000000
               |grad[o]|=4.24e-06  |ddm|=2.16e-05  |maxRot[o]|=2.54e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5180457513229  dE = -1.6328272e-11  S^2 = 0.0000000
               |grad[o]|=1.61e-06  |ddm|=8.17e-06  |maxRot[o]|=9.68e-06
2-step CASSCF converged in 18 macro (71 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9663057  1.92713079 1.90282925 1.84406996 0.08365691 0.16227412
 0.0596417  0.05409157]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00972   0.00945  -0.00589   0.00000   0.00000
  0 C 2s       0.59726   0.63748  -0.37752  -0.00000   0.00000
  0 C 3s      -0.02696   0.01811  -0.05147  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000  -0.00000   0.00000   0.69538
  0 C 2py     -0.00000   0.00000   0.00000   0.70451   0.00000
  0 C 2pz      0.37495  -0.30481   0.59459   0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.05355
  0 C 3py     -0.00000   0.00000   0.00000   0.04456  -0.00000
  0 C 3pz     -0.02582  -0.00292  -0.00005  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.04098  -0.00000
  0 C 3dz^2    0.03462  -0.01515   0.03455  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11653
 0 C 3dx2-y2  -0.00172   0.00737  -0.00749  -0.00000   0.00000
  1 C 1s       0.00972  -0.00945  -0.00589   0.00000   0.00000
  1 C 2s       0.59726  -0.63748  -0.37752  -0.00000   0.00000
  1 C 3s      -0.02696  -0.01811  -0.05147   0.00000   0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69538
  1 C 2py      0.00000  -0.00000   0.00000   0.70451  -0.00000
  1 C 2pz     -0.37495  -0.30481  -0.59459  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00000  -0.05355
  1 C 3py      0.00000  -0.00000  -0.00000   0.04456  -0.00000
  1 C 3pz      0.02582  -0.00292   0.00005  -0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.04098   0.00000
  1 C 3dz^2    0.03462   0.01515   0.03455   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000  -0.00000   0.00000   0.11653
 1 C 3dx2-y2  -0.00172  -0.00737  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s      -0.00000   0.00000   0.30262
  0 C 3s      -0.00000   0.00000   0.04028
  0 C 2px      0.00000   0.69699  -0.00000
  0 C 2py      0.70653   0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.63446
  0 C 3px      0.00000   0.00537   0.00000
  0 C 3py     -0.02507   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05718
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01392   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01415
  0 C 3dxz     0.00000  -0.11904   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02809
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000   0.00000  -0.30262
  1 C 3s       0.00000  -0.00000  -0.04028
  1 C 2px     -0.00000  -0.69699  -0.00000
  1 C 2py     -0.70653  -0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.63446
  1 C 3px     -0.00000  -0.00537   0.00000
  1 C 3py      0.02507  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.05718
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.01392   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01415
  1 C 3dxz     0.00000  -0.11904  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02809
<CAS-nat-orb|mo-hf>  3  3    0.98713996
<CAS-nat-orb|mo-hf>  4  4    0.99975825
<CAS-nat-orb|mo-hf>  5  5    0.98714928
<CAS-nat-orb|mo-hf>  6  6    0.99929981
<CAS-nat-orb|mo-hf>  7  7    0.94370155
<CAS-nat-orb|mo-hf>  8  8    0.96917400
<CAS-nat-orb|mo-hf>  9  9    0.95823418
<CAS-nat-orb|mo-hf>  10  10    0.84381041
<CAS-nat-orb|mo-hf>  10  11   -0.50815317
CASSCF energy = -75.5180457513229
CASCI E = -75.5180457513229  E(CI) = -15.8005832192871  S^2 = 0.0000000
Density matrix diagonal elements [1.96630586 1.92713133 1.90283033 1.84407008 0.08365522 0.162274
 0.05964164 0.05409153]
i = 1  <i|F|i> = -11.33818284
i = 2  <i|F|i> = -11.33824792
i = 3  <i|F|i> =  -0.87927468
i = 4  <i|F|i> =  -0.60319887
i = 5  <i|F|i> =  -0.39717345
i = 6  <i|F|i> =  -0.33144659
i = 7  <i|F|i> =   0.06926816
i = 8  <i|F|i> =   0.09800327
i = 9  <i|F|i> =   0.20617571
i = 10  <i|F|i> =   0.43305052
i = 11  <i|F|i> =   0.56783537
i = 12  <i|F|i> =   0.69022159
i = 13  <i|F|i> =   0.68892872
i = 14  <i|F|i> =   0.65531619
i = 15  <i|F|i> =   0.73417127
i = 16  <i|F|i> =   0.71039014
i = 17  <i|F|i> =   0.72226333
i = 18  <i|F|i> =   1.04724383
i = 19  <i|F|i> =   1.14546059
i = 20  <i|F|i> =   1.20950931
i = 21  <i|F|i> =   1.30325462
i = 22  <i|F|i> =   1.30342988
i = 23  <i|F|i> =   1.48444251
i = 24  <i|F|i> =   1.48257413
i = 25  <i|F|i> =   1.66921916
i = 26  <i|F|i> =   1.79422580
i = 27  <i|F|i> =   1.86103043
i = 28  <i|F|i> =   2.13561226
......production of RDMs took       2.39 sec
......reading the RDM took          0.42 sec
......production of RDMs took      65.33 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.13 sec

E(WickICNEVPT2-ijrs) =    -0.00028243922577
E(WickICNEVPT2- rsi) =    -0.00080540994349
E(WickICNEVPT2- ijr) =    -0.00028784112057
E(WickICNEVPT2-  rs) =    -0.03519553544758
E(WickICNEVPT2-  ij) =    -0.00008633151204
E(WickICNEVPT2-  ir) =    -0.00107627583345
E(WickICNEVPT2-   r) =    -0.05656592899757
E(WickICNEVPT2-   i) =    -0.00009315177616
E(WickICNEVPT2) = -75.61243866517957  E_corr_pt = -0.09439291385662048
Timings = pdms =   78.25 | eris =    0.62 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.30 | ij =    0.07 | ir =    0.16 | r =    2.02 | i =    0.81 | total =   82.30
Time cost =    290.960
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:14:20 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.719825935490 AA    0.000000000000   0.000000000000   3.250000000000 Bohr   0.0

nuclear repulsion = 11.0769230769231
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.625]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      4012.83


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp2nsi39bc
max_memory 4000 MB (current use 317 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8631164371269

WARN: Singularity detected in overlap matrix (condition number =  151). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.13569696344616  LUMO (B3u) = -0.13569696344616

WARN: B2u HOMO -0.13569696344616 > system LUMO -0.13569696344616

cycle= 1 E= -75.3346710578886  delta_E= -0.472  |g|= 0.257  |ddm|= 1.52
HOMO (B2u) = -0.397829563278946  LUMO (B3u) = -0.0755897093543538
cycle= 2 E= -75.3604859400341  delta_E= -0.0258  |g|= 0.0524  |ddm|= 0.352
HOMO (B2u) = -0.359424194210818  LUMO (B3u) = -0.0322866366973563
cycle= 3 E= -75.3619492644577  delta_E= -0.00146  |g|= 0.0182  |ddm|= 0.0697
HOMO (B2u) = -0.363955951245319  LUMO (B3u) = -0.0367454491314129
cycle= 4 E= -75.3621677667453  delta_E= -0.000219  |g|= 0.000695  |ddm|= 0.0379
HOMO (B2u) = -0.364024863853048  LUMO (B3u) = -0.0369588213878731
cycle= 5 E= -75.3621679575039  delta_E= -1.91e-07  |g|= 8.98e-05  |ddm|= 0.00116
HOMO (B2u) = -0.363992517085413  LUMO (B3u) = -0.0369261206635506
cycle= 6 E= -75.3621679620312  delta_E= -4.53e-09  |g|= 1.46e-05  |ddm|= 0.000149
HOMO (B2u) = -0.363990782245936  LUMO (B3u) = -0.0369275152560868
cycle= 7 E= -75.3621679621673  delta_E= -1.36e-10  |g|= 1.94e-06  |ddm|= 3.41e-05
HOMO (B2u) = -0.363990060624671  LUMO (B3u) = -0.0369271360119323
cycle= 8 E= -75.3621679621697  delta_E= -2.42e-12  |g|= 1.11e-07  |ddm|= 4.19e-06
HOMO (B2u) = -0.363990078365494  LUMO (B3u) = -0.0369271500513704
cycle= 9 E= -75.3621679621697  delta_E= 5.68e-14  |g|= 7.05e-09  |ddm|= 2.21e-07
HOMO (B2u) = -0.363990079141353  LUMO (B3u) = -0.0369271524103332
cycle= 10 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 4.67e-09  |ddm|= 7.46e-09
HOMO (B2u) = -0.363990078974583  LUMO (B3u) = -0.0369271522146703
cycle= 11 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 4e-09  |ddm|= 4.01e-09
HOMO (B2u) = -0.363990077683242  LUMO (B3u) = -0.0369271508562332
cycle= 12 E= -75.3621679621697  delta_E=    0  |g|= 3.68e-09  |ddm|= 1.85e-09
HOMO (B2u) = -0.363990078038993  LUMO (B3u) = -0.0369271511895338
cycle= 13 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 3.23e-09  |ddm|= 8.42e-10
HOMO (B2u) = -0.363990077657526  LUMO (B3u) = -0.0369271508035447
cycle= 14 E= -75.3621679621698  delta_E= -1.14e-13  |g|= 4.12e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.363990077851547  LUMO (B3u) = -0.0369271509287231
cycle= 15 E= -75.3621679621697  delta_E= 7.11e-14  |g|= 5.36e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.363990077758604  LUMO (B3u) = -0.0369271509420554
cycle= 16 E= -75.3621679621697  delta_E= 7.11e-14  |g|= 6.73e-10  |ddm|= 1.36e-09
HOMO (B2u) = -0.363990077805882  LUMO (B3u) = -0.0369271509397745
cycle= 17 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 6.48e-10  |ddm|= 8.26e-10
HOMO (B2u) = -0.363990077800044  LUMO (B3u) = -0.0369271509230197
cycle= 18 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 4.59e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.363990077815424  LUMO (B3u) = -0.0369271509392621
cycle= 19 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 3.99e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.363990077833027  LUMO (B3u) = -0.0369271509567012
cycle= 20 E= -75.3621679621696  delta_E= 1.42e-14  |g|= 3.18e-10  |ddm|= 1.18e-10
HOMO (B2u) = -0.363990077836116  LUMO (B3u) = -0.0369271509567847
cycle= 21 E= -75.3621679621697  delta_E= -7.11e-14  |g|= 2.17e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.363990077841596  LUMO (B3u) = -0.0369271509609147
cycle= 22 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 1.25e-10  |ddm|= 1.53e-10
HOMO (B2u) = -0.36399007784118  LUMO (B3u) = -0.036927150959029
cycle= 23 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 1.23e-10  |ddm|= 2.67e-11
HOMO (B2u) = -0.3639900778375  LUMO (B3u) = -0.03692715095706
cycle= 24 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 1.13e-10  |ddm|= 4.74e-11
HOMO (B2u) = -0.363990077839562  LUMO (B3u) = -0.0369271509564474
cycle= 25 E= -75.3621679621697  delta_E=    0  |g|= 9.12e-11  |ddm|= 5.14e-11
HOMO (B2u) = -0.363990077840559  LUMO (B3u) = -0.0369271509550708
Extra cycle  E= -75.3621679621697  delta_E= -2.84e-14  |g|= 3.15e-11  |ddm|= 1.09e-10
converged SCF energy = -75.3621679621697

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp2nsi39bc
max_memory 4000 MB (current use 317 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4646530045337  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4765356118731  dE = -0.011882607  S^2 = 0.0000000
               |grad[o]|=0.0827  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4870504127952  dE = -0.010514801  S^2 = 0.0000000
               |grad[o]|=0.0737  |ddm|=0.0595  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.495987741907  dE = -0.0089373291  S^2 = 0.0000000
               |grad[o]|=0.0638  |ddm|=0.044  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5032500656283  dE = -0.0072623237  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.0592  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5084942261316  dE = -0.0052441605  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.0625  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.511603300483  dE = -0.0031090744  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5125684622515  dE = -0.00096516177  S^2 = 0.0000000
               |grad[o]|=0.0119  |ddm|=0.0749  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5130317828138  dE = -0.00046332056  S^2 = 0.0000000
               |grad[o]|=0.00731  |ddm|=0.0414  |maxRot[o]|=0.0388
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5131334897682  dE = -0.00010170695  S^2 = 0.0000000
               |grad[o]|=0.00337  |ddm|=0.0207  |maxRot[o]|= 0.02
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5131512581344  dE = -1.7768366e-05  S^2 = 0.0000000
               |grad[o]|=0.00142  |ddm|=0.00715  |maxRot[o]|=0.00888
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5131537359664  dE = -2.477832e-06  S^2 = 0.0000000
               |grad[o]|=0.000543  |ddm|=0.00276  |maxRot[o]|=0.00337
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5131540649679  dE = -3.2900152e-07  S^2 = 0.0000000
               |grad[o]|=0.000202  |ddm|=0.000999  |maxRot[o]|=0.00124
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5131541079163  dE = -4.2948429e-08  S^2 = 0.0000000
               |grad[o]|=7.36e-05  |ddm|=0.000361  |maxRot[o]|=0.000449
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5131541134676  dE = -5.551243e-09  S^2 = 0.0000000
               |grad[o]|=2.66e-05  |ddm|=0.00013  |maxRot[o]|=0.000162
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5131541141775  dE = -7.0988904e-10  S^2 = 0.0000000
               |grad[o]|=9.58e-06  |ddm|=4.67e-05  |maxRot[o]|=5.83e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5131541142659  dE = -8.8419938e-11  S^2 = 0.0000000
               |grad[o]|=3.46e-06  |ddm|=1.68e-05  |maxRot[o]|=2.1e-05
2-step CASSCF converged in 16 macro (65 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96506513 1.92787018 1.90242015 1.83461648 0.08106132 0.17170008
 0.05932555 0.0579411 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01001   0.00958  -0.00569   0.00000   0.00000
  0 C 2s       0.60769   0.64161  -0.36054  -0.00000   0.00000
  0 C 3s      -0.02394   0.01781  -0.04989  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69498
  0 C 2py     -0.00000   0.00000  -0.00000   0.70448  -0.00000
  0 C 2pz      0.35831  -0.29606   0.60517  -0.00000  -0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.05520
  0 C 3py     -0.00000   0.00000   0.00000   0.04615   0.00000
  0 C 3pz     -0.02386  -0.00271   0.00109  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03981  -0.00000
  0 C 3dz^2    0.03287  -0.01476   0.03469  -0.00000  -0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.11816
 0 C 3dx2-y2  -0.00145   0.00725  -0.00749   0.00000  -0.00000
  1 C 1s       0.01001  -0.00958  -0.00569   0.00000   0.00000
  1 C 2s       0.60769  -0.64161  -0.36054   0.00000   0.00000
  1 C 3s      -0.02394  -0.01781  -0.04989   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69498
  1 C 2py      0.00000  -0.00000   0.00000   0.70448   0.00000
  1 C 2pz     -0.35831  -0.29606  -0.60517  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05520
  1 C 3py      0.00000  -0.00000  -0.00000   0.04615   0.00000
  1 C 3pz      0.02386  -0.00271  -0.00109  -0.00000   0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03981  -0.00000
  1 C 3dz^2    0.03287   0.01476   0.03469   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11816
 1 C 3dx2-y2  -0.00145  -0.00725  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00052
  0 C 2s      -0.00000   0.00000   0.29408
  0 C 3s      -0.00000  -0.00000   0.03931
  0 C 2px      0.00000   0.69713  -0.00000
  0 C 2py      0.70661   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.63885
  0 C 3px      0.00000   0.00311  -0.00000
  0 C 3py     -0.02293   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05440
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01349   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.01292
  0 C 3dxz     0.00000  -0.11834  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02684
  1 C 1s       0.00000   0.00000   0.00052
  1 C 2s       0.00000   0.00000  -0.29408
  1 C 3s       0.00000   0.00000  -0.03931
  1 C 2px     -0.00000  -0.69713   0.00000
  1 C 2py     -0.70661  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.63885
  1 C 3px     -0.00000  -0.00311   0.00000
  1 C 3py      0.02293  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.05440
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01349   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.01292
  1 C 3dxz     0.00000  -0.11834  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02684
<CAS-nat-orb|mo-hf>  3  3    0.98958162
<CAS-nat-orb|mo-hf>  4  4    0.99975150
<CAS-nat-orb|mo-hf>  5  5    0.98959416
<CAS-nat-orb|mo-hf>  6  6    0.99925428
<CAS-nat-orb|mo-hf>  7  7    0.94209804
<CAS-nat-orb|mo-hf>  8  8    0.97102424
<CAS-nat-orb|mo-hf>  9  9    0.95858985
<CAS-nat-orb|mo-hf>  10  10    0.86001483
<CAS-nat-orb|mo-hf>  10  11   -0.48380369
CASSCF energy = -75.5131541142659
CASCI E = -75.5131541142659  E(CI) = -15.7189305753106  S^2 = 0.0000000
Density matrix diagonal elements [1.96506534 1.92787136 1.90242346 1.83461676 0.08105701 0.17169976
 0.05932521 0.0579411 ]
i = 1  <i|F|i> = -11.33948734
i = 2  <i|F|i> = -11.33960314
i = 3  <i|F|i> =  -0.87345923
i = 4  <i|F|i> =  -0.60666534
i = 5  <i|F|i> =  -0.39134281
i = 6  <i|F|i> =  -0.32570729
i = 7  <i|F|i> =   0.07435586
i = 8  <i|F|i> =   0.08996158
i = 9  <i|F|i> =   0.20288096
i = 10  <i|F|i> =   0.41009375
i = 11  <i|F|i> =   0.57226235
i = 12  <i|F|i> =   0.68995170
i = 13  <i|F|i> =   0.69596438
i = 14  <i|F|i> =   0.65349797
i = 15  <i|F|i> =   0.73644034
i = 16  <i|F|i> =   0.71175484
i = 17  <i|F|i> =   0.72172175
i = 18  <i|F|i> =   1.04234308
i = 19  <i|F|i> =   1.14537815
i = 20  <i|F|i> =   1.20788777
i = 21  <i|F|i> =   1.30864747
i = 22  <i|F|i> =   1.30882747
i = 23  <i|F|i> =   1.47924181
i = 24  <i|F|i> =   1.47752774
i = 25  <i|F|i> =   1.64146536
i = 26  <i|F|i> =   1.77851160
i = 27  <i|F|i> =   1.84479797
i = 28  <i|F|i> =   2.13743596
......production of RDMs took       1.88 sec
......reading the RDM took          0.43 sec
......production of RDMs took      67.00 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.80 sec

E(WickICNEVPT2-ijrs) =    -0.00028273956543
E(WickICNEVPT2- rsi) =    -0.00080339429207
E(WickICNEVPT2- ijr) =    -0.00028445918027
E(WickICNEVPT2-  rs) =    -0.03498808503801
E(WickICNEVPT2-  ij) =    -0.00008296709239
E(WickICNEVPT2-  ir) =    -0.00106578632213
E(WickICNEVPT2-   r) =    -0.05697471226956
E(WickICNEVPT2-   i) =    -0.00008847211865
E(WickICNEVPT2) = -75.60772473014438  E_corr_pt = -0.09457061587850329
Timings = pdms =   79.11 | eris =    0.61 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.57 | ij =    0.14 | ir =    0.27 | r =    2.09 | i =    0.84 | total =   83.69
Time cost =    358.987
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:20:19 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.746284796036 AA    0.000000000000   0.000000000000   3.300000000000 Bohr   0.0

nuclear repulsion = 10.9090909090909
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.65]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      4240.63


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpbbivc9kw
max_memory 4000 MB (current use 317 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.842256067793

WARN: Singularity detected in overlap matrix (condition number =  141). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.131475269334874  LUMO (B3u) = -0.131475269334873

WARN: B2u HOMO -0.131475269334874 > system LUMO -0.131475269334873

cycle= 1 E= -75.3268751185368  delta_E= -0.485  |g|= 0.254  |ddm|= 1.52
HOMO (B2u) = -0.392977692990133  LUMO (B3u) = -0.0727206501017187
cycle= 2 E= -75.3522841088372  delta_E= -0.0254  |g|= 0.0519  |ddm|= 0.352
HOMO (B2u) = -0.355147584178279  LUMO (B3u) = -0.030022292089129
cycle= 3 E= -75.3537386656221  delta_E= -0.00145  |g|= 0.0182  |ddm|= 0.0689
HOMO (B2u) = -0.359671017046595  LUMO (B3u) = -0.0344578300630398
cycle= 4 E= -75.3539592586542  delta_E= -0.000221  |g|= 0.000688  |ddm|= 0.0377
HOMO (B2u) = -0.359764894042609  LUMO (B3u) = -0.0346976899212315
cycle= 5 E= -75.3539594435198  delta_E= -1.85e-07  |g|= 9.37e-05  |ddm|= 0.00109
HOMO (B2u) = -0.359730880125606  LUMO (B3u) = -0.034664030564039
cycle= 6 E= -75.3539594484633  delta_E= -4.94e-09  |g|= 1.51e-05  |ddm|= 0.000157
HOMO (B2u) = -0.35972902657833  LUMO (B3u) = -0.034665238650945
cycle= 7 E= -75.3539594486084  delta_E= -1.45e-10  |g|= 1.94e-06  |ddm|= 3.44e-05
HOMO (B2u) = -0.359728331017035  LUMO (B3u) = -0.0346649076944361
cycle= 8 E= -75.3539594486108  delta_E= -2.4e-12  |g|= 1.14e-07  |ddm|= 4.16e-06
HOMO (B2u) = -0.359728345183892  LUMO (B3u) = -0.034664917699732
cycle= 9 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 6.91e-09  |ddm|= 2.29e-07
HOMO (B2u) = -0.359728345817104  LUMO (B3u) = -0.0346649199359361
cycle= 10 E= -75.3539594486108  delta_E= -5.68e-14  |g|= 4.83e-09  |ddm|= 7.45e-09
HOMO (B2u) = -0.359728345628833  LUMO (B3u) = -0.0346649197220441
cycle= 11 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 3.95e-09  |ddm|= 4.04e-09
HOMO (B2u) = -0.35972834432455  LUMO (B3u) = -0.0346649183506504
cycle= 12 E= -75.3539594486108  delta_E=    0  |g|= 3.62e-09  |ddm|= 1.84e-09
HOMO (B2u) = -0.359728344700565  LUMO (B3u) = -0.0346649187078871
cycle= 13 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 3.21e-09  |ddm|= 9.33e-10
HOMO (B2u) = -0.35972834432266  LUMO (B3u) = -0.0346649183501947
cycle= 14 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 3.93e-10  |ddm|= 4.6e-09
HOMO (B2u) = -0.359728344496018  LUMO (B3u) = -0.0346649184551001
cycle= 15 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 5.49e-10  |ddm|= 1.31e-09
HOMO (B2u) = -0.359728344408451  LUMO (B3u) = -0.0346649184600198
cycle= 16 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 6.41e-10  |ddm|= 1.25e-09
HOMO (B2u) = -0.359728344445389  LUMO (B3u) = -0.0346649184557001
cycle= 17 E= -75.3539594486108  delta_E= 4.26e-14  |g|= 6.39e-10  |ddm|= 6.95e-10
HOMO (B2u) = -0.359728344433607  LUMO (B3u) = -0.0346649184358496
cycle= 18 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 4.57e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.359728344445606  LUMO (B3u) = -0.0346649184496974
cycle= 19 E= -75.3539594486108  delta_E= -7.11e-14  |g|= 3.95e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.359728344459466  LUMO (B3u) = -0.0346649184644346
cycle= 20 E= -75.3539594486109  delta_E= -2.84e-14  |g|= 3.17e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.359728344458908  LUMO (B3u) = -0.0346649184619292
cycle= 21 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 2.19e-10  |ddm|= 1.63e-10
HOMO (B2u) = -0.359728344461322  LUMO (B3u) = -0.0346649184640209
cycle= 22 E= -75.3539594486107  delta_E= 5.68e-14  |g|= 1.26e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.359728344460736  LUMO (B3u) = -0.0346649184621283
cycle= 23 E= -75.3539594486107  delta_E= 1.42e-14  |g|= 1.23e-10  |ddm|= 1.77e-11
HOMO (B2u) = -0.359728344456849  LUMO (B3u) = -0.0346649184600474
cycle= 24 E= -75.3539594486108  delta_E= -8.53e-14  |g|= 1.11e-10  |ddm|= 4.67e-11
HOMO (B2u) = -0.359728344457944  LUMO (B3u) = -0.0346649184591152
cycle= 25 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 9.02e-11  |ddm|= 4.48e-11
HOMO (B2u) = -0.359728344457696  LUMO (B3u) = -0.034664918458386
cycle= 26 E= -75.3539594486107  delta_E= 8.53e-14  |g|= 7.22e-11  |ddm|= 3.21e-11
HOMO (B2u) = -0.359728344457181  LUMO (B3u) = -0.0346649184576507
cycle= 27 E= -75.3539594486109  delta_E= -1.42e-13  |g|= 6.05e-11  |ddm|= 2.13e-11
HOMO (B2u) = -0.359728344456817  LUMO (B3u) = -0.0346649184570239
cycle= 28 E= -75.3539594486108  delta_E= 8.53e-14  |g|= 4.8e-11  |ddm|= 2.38e-11
HOMO (B2u) = -0.359728344456699  LUMO (B3u) = -0.034664918456658
cycle= 29 E= -75.3539594486107  delta_E= 2.84e-14  |g|= 3.73e-11  |ddm|= 2.1e-11
HOMO (B2u) = -0.359728344456559  LUMO (B3u) = -0.0346649184563589
cycle= 30 E= -75.3539594486108  delta_E= -8.53e-14  |g|= 2.98e-11  |ddm|= 1.51e-11
HOMO (B2u) = -0.359728344456518  LUMO (B3u) = -0.0346649184562041
cycle= 31 E= -75.3539594486109  delta_E= -2.84e-14  |g|= 2.57e-11  |ddm|= 8.66e-12
HOMO (B2u) = -0.359728344456415  LUMO (B3u) = -0.0346649184560265
cycle= 32 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 2.14e-11  |ddm|= 9.08e-12
HOMO (B2u) = -0.359728344456434  LUMO (B3u) = -0.0346649184558871
cycle= 33 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 1.75e-11  |ddm|= 8.01e-12
HOMO (B2u) = -0.359728344456396  LUMO (B3u) = -0.0346649184557693
cycle= 34 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 1.44e-11  |ddm|= 6.4e-12
HOMO (B2u) = -0.35972834445636  LUMO (B3u) = -0.0346649184556721
cycle= 35 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 1.19e-11  |ddm|= 5.28e-12
HOMO (B2u) = -0.359728344456329  LUMO (B3u) = -0.0346649184555851
cycle= 36 E= -75.3539594486107  delta_E= 8.53e-14  |g|= 9.7e-12  |ddm|= 4.64e-12
HOMO (B2u) = -0.359728344456302  LUMO (B3u) = -0.0346649184555129
cycle= 37 E= -75.3539594486108  delta_E= -1.14e-13  |g|= 7.93e-12  |ddm|= 3.75e-12
HOMO (B2u) = -0.359728344456281  LUMO (B3u) = -0.0346649184554565
cycle= 38 E= -75.3539594486109  delta_E= -5.68e-14  |g|= 6.57e-12  |ddm|= 2.91e-12
HOMO (B2u) = -0.359728344456266  LUMO (B3u) = -0.0346649184554118
cycle= 39 E= -75.3539594486108  delta_E= 4.26e-14  |g|= 5.48e-12  |ddm|= 2.33e-12
HOMO (B2u) = -0.359728344456253  LUMO (B3u) = -0.0346649184553741
cycle= 40 E= -75.3539594486108  delta_E= 4.26e-14  |g|= 4.53e-12  |ddm|= 2.02e-12
HOMO (B2u) = -0.359728344456245  LUMO (B3u) = -0.0346649184553434
cycle= 41 E= -75.3539594486107  delta_E= 5.68e-14  |g|= 3.74e-12  |ddm|= 1.69e-12
HOMO (B2u) = -0.359728344456237  LUMO (B3u) = -0.0346649184553183
cycle= 42 E= -75.3539594486108  delta_E= -4.26e-14  |g|= 3.08e-12  |ddm|= 1.39e-12
HOMO (B2u) = -0.359728344456231  LUMO (B3u) = -0.0346649184552978
cycle= 43 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 2.55e-12  |ddm|= 1.16e-12
HOMO (B2u) = -0.359728344456225  LUMO (B3u) = -0.0346649184552812
cycle= 44 E= -75.3539594486108  delta_E= -5.68e-14  |g|= 2.1e-12  |ddm|= 9.54e-13
HOMO (B2u) = -0.359728344456222  LUMO (B3u) = -0.0346649184552679
cycle= 45 E= -75.3539594486108  delta_E= 4.26e-14  |g|= 1.74e-12  |ddm|= 7.75e-13
HOMO (B2u) = -0.359728344456218  LUMO (B3u) = -0.0346649184552571
cycle= 46 E= -75.3539594486108  delta_E= -4.26e-14  |g|= 1.44e-12  |ddm|= 6.38e-13
HOMO (B2u) = -0.359728344456216  LUMO (B3u) = -0.0346649184552481
cycle= 47 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 1.19e-12  |ddm|= 5.31e-13
HOMO (B2u) = -0.359728344456214  LUMO (B3u) = -0.0346649184552409
cycle= 48 E= -75.3539594486108  delta_E= -5.68e-14  |g|= 9.84e-13  |ddm|= 4.42e-13
HOMO (B2u) = -0.359728344456212  LUMO (B3u) = -0.0346649184552348
cycle= 49 E= -75.3539594486108  delta_E=    0  |g|= 8.13e-13  |ddm|= 3.68e-13
HOMO (B2u) = -0.359728344456207  LUMO (B3u) = -0.0346649184552165
Extra cycle  E= -75.3539594486108  delta_E= 5.68e-14  |g|= 3.14e-13  |ddm|= 1.06e-12
converged SCF energy = -75.3539594486108

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpbbivc9kw
max_memory 4000 MB (current use 317 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4605852262837  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4728649095989  dE = -0.012279683  S^2 = 0.0000000
               |grad[o]|=0.0845  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4835908921719  dE = -0.010725983  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0629  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.492493353682  dE = -0.0089024615  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.0412  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.499541597522  dE = -0.0070482438  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0503  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5045613523081  dE = -0.0050197548  S^2 = 0.0000000
               |grad[o]|=0.0383  |ddm|=0.0585  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5070403288392  dE = -0.0024789765  S^2 = 0.0000000
               |grad[o]|=0.0222  |ddm|=0.0398  |maxRot[o]|= 0.06
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5078465774001  dE = -0.00080624856  S^2 = 0.0000000
               |grad[o]|=0.0105  |ddm|=0.0554  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5081670994055  dE = -0.00032052201  S^2 = 0.0000000
               |grad[o]|=0.00584  |ddm|=0.0262  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5082201129814  dE = -5.3013576e-05  S^2 = 0.0000000
               |grad[o]|=0.0024  |ddm|=0.0133  |maxRot[o]|=0.0153
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5082271260862  dE = -7.0131048e-06  S^2 = 0.0000000
               |grad[o]|=0.000905  |ddm|=0.00451  |maxRot[o]|=0.00572
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5082279839393  dE = -8.5785308e-07  S^2 = 0.0000000
               |grad[o]|=0.000325  |ddm|=0.00156  |maxRot[o]|=0.00202
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5082280860406  dE = -1.0210124e-07  S^2 = 0.0000000
               |grad[o]|=0.000114  |ddm|=0.000538  |maxRot[o]|=0.0007
macro iter 13 (2 JK  0 micro), CASSCF E = -75.508228098037  dE = -1.199642e-08  S^2 = 0.0000000
               |grad[o]|=3.95e-05  |ddm|=0.000185  |maxRot[o]|=0.000241
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5082280994327  dE = -1.3956765e-09  S^2 = 0.0000000
               |grad[o]|=1.37e-05  |ddm|=6.4e-05  |maxRot[o]|=8.32e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5082280995929  dE = -1.6022739e-10  S^2 = 0.0000000
               |grad[o]|=4.71e-06  |ddm|=2.19e-05  |maxRot[o]|=2.86e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.508228099607  dE = -1.41398e-11  S^2 = 0.0000000
               |grad[o]|=1.56e-06  |ddm|=7e-06  |maxRot[o]|=9.46e-06
2-step CASSCF converged in 16 macro (63 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96387359 1.92858695 1.90144122 1.82466897 0.07878278 0.18160432
 0.05902031 0.06202185]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01031   0.00970  -0.00544   0.00000   0.00000
  0 C 2s       0.61830   0.64554  -0.34208   0.00000  -0.00000
  0 C 3s      -0.02094   0.01752  -0.04828   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69463
  0 C 2py      0.00000  -0.00000   0.00000   0.70445   0.00000
  0 C 2pz      0.34017  -0.28744   0.61591   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.05672
  0 C 3py     -0.00000   0.00000   0.00000   0.04759  -0.00000
  0 C 3pz     -0.02200  -0.00251   0.00227   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.03863  -0.00000
  0 C 3dz^2    0.03108  -0.01437   0.03487   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.11945
 0 C 3dx2-y2  -0.00117   0.00712  -0.00747   0.00000  -0.00000
  1 C 1s       0.01031  -0.00970  -0.00544   0.00000   0.00000
  1 C 2s       0.61830  -0.64554  -0.34208   0.00000   0.00000
  1 C 3s      -0.02094  -0.01752  -0.04828  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69463
  1 C 2py      0.00000  -0.00000  -0.00000   0.70445   0.00000
  1 C 2pz     -0.34017  -0.28744  -0.61591   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.05672
  1 C 3py     -0.00000   0.00000  -0.00000   0.04759  -0.00000
  1 C 3pz      0.02200  -0.00251  -0.00227   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.03863   0.00000
  1 C 3dz^2    0.03108   0.01437   0.03487  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.11945
 1 C 3dx2-y2  -0.00117  -0.00712  -0.00747   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00049
  0 C 2s       0.00000  -0.00000   0.28563
  0 C 3s       0.00000  -0.00000   0.03833
  0 C 2px     -0.00000   0.69726  -0.00000
  0 C 2py      0.70668  -0.00000   0.00000
  0 C 2pz      0.00000  -0.00000   0.64303
  0 C 3px     -0.00000   0.00091  -0.00000
  0 C 3py     -0.02081  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.05165
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.01306  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.01176
  0 C 3dxz    -0.00000  -0.11759  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02562
  1 C 1s       0.00000   0.00000   0.00049
  1 C 2s      -0.00000   0.00000  -0.28563
  1 C 3s      -0.00000   0.00000  -0.03833
  1 C 2px      0.00000  -0.69726  -0.00000
  1 C 2py     -0.70668   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.64303
  1 C 3px      0.00000  -0.00091   0.00000
  1 C 3py      0.02081   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.05165
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01306  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.01176
  1 C 3dxz    -0.00000  -0.11759  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.02562
<CAS-nat-orb|mo-hf>  3  3    0.99201756
<CAS-nat-orb|mo-hf>  4  4    0.99974451
<CAS-nat-orb|mo-hf>  5  5    0.99203281
<CAS-nat-orb|mo-hf>  6  6    0.99920694
<CAS-nat-orb|mo-hf>  7  7    0.94066257
<CAS-nat-orb|mo-hf>  8  8    0.97275729
<CAS-nat-orb|mo-hf>  9  9    0.95891046
<CAS-nat-orb|mo-hf>  10  10    0.87431676
<CAS-nat-orb|mo-hf>  10  11   -0.46069473
CASSCF energy = -75.508228099607
CASCI E = -75.508228099607  E(CI) = -15.6395663675253  S^2 = 0.0000000
Density matrix diagonal elements [1.96387368 1.92858773 1.90144192 1.82466898 0.0787815  0.18160418
 0.05902019 0.06202182]
i = 1  <i|F|i> = -11.34065953
i = 2  <i|F|i> = -11.34081998
i = 3  <i|F|i> =  -0.86788198
i = 4  <i|F|i> =  -0.61003702
i = 5  <i|F|i> =  -0.38544721
i = 6  <i|F|i> =  -0.32005152
i = 7  <i|F|i> =   0.07899155
i = 8  <i|F|i> =   0.08216831
i = 9  <i|F|i> =   0.19971645
i = 10  <i|F|i> =   0.38833560
i = 11  <i|F|i> =   0.57666769
i = 12  <i|F|i> =   0.69068894
i = 13  <i|F|i> =   0.70098412
i = 14  <i|F|i> =   0.65153725
i = 15  <i|F|i> =   0.73949302
i = 16  <i|F|i> =   0.71309559
i = 17  <i|F|i> =   0.72122831
i = 18  <i|F|i> =   1.03764731
i = 19  <i|F|i> =   1.14637123
i = 20  <i|F|i> =   1.20716809
i = 21  <i|F|i> =   1.31390298
i = 22  <i|F|i> =   1.31408881
i = 23  <i|F|i> =   1.47429605
i = 24  <i|F|i> =   1.47272637
i = 25  <i|F|i> =   1.61411477
i = 26  <i|F|i> =   1.76300726
i = 27  <i|F|i> =   1.82868408
i = 28  <i|F|i> =   2.13899306
......production of RDMs took       1.90 sec
......reading the RDM took          0.42 sec
......production of RDMs took     120.92 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.82 sec

E(WickICNEVPT2-ijrs) =    -0.00028323588753
E(WickICNEVPT2- rsi) =    -0.00080209516106
E(WickICNEVPT2- ijr) =    -0.00028134796372
E(WickICNEVPT2-  rs) =    -0.03478249643540
E(WickICNEVPT2-  ij) =    -0.00007981662164
E(WickICNEVPT2-  ir) =    -0.00105604429233
E(WickICNEVPT2-   r) =    -0.05738469592421
E(WickICNEVPT2-   i) =    -0.00008410868613
E(WickICNEVPT2) = -75.60298194057904  E_corr_pt = -0.0947538409720167
Timings = pdms =  133.05 | eris =    0.02 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.23 | ij =    0.07 | ir =    0.15 | r =    1.72 | i =    0.69 | total =  135.98
Time cost =    306.268
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:25:26 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.772743656582 AA    0.000000000000   0.000000000000   3.350000000000 Bohr   0.0

nuclear repulsion = 10.7462686567164
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.675]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      4544.99


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpxzvljnro
max_memory 4000 MB (current use 320 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8226756263582

WARN: Singularity detected in overlap matrix (condition number =  131). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.127455322759628  LUMO (B3u) = -0.127455322759628

WARN: B2u HOMO -0.127455322759628 > system LUMO -0.127455322759628

cycle= 1 E= -75.3190207821596  delta_E= -0.496  |g|= 0.252  |ddm|= 1.51
HOMO (B2u) = -0.388276779674662  LUMO (B3u) = -0.0699328749080285
cycle= 2 E= -75.3440245529482  delta_E= -0.025  |g|= 0.0513  |ddm|= 0.351
HOMO (B2u) = -0.351016713810033  LUMO (B3u) = -0.0278350417390017
cycle= 3 E= -75.3454675220221  delta_E= -0.00144  |g|= 0.0181  |ddm|= 0.0681
HOMO (B2u) = -0.355529260677999  LUMO (B3u) = -0.0322458808802169
cycle= 4 E= -75.3456894433558  delta_E= -0.000222  |g|= 0.000681  |ddm|= 0.0375
HOMO (B2u) = -0.355644927845466  LUMO (B3u) = -0.0325087452095928
cycle= 5 E= -75.3456896230235  delta_E= -1.8e-07  |g|= 9.78e-05  |ddm|= 0.00103
HOMO (B2u) = -0.35560961319006  LUMO (B3u) = -0.0324745833916061
cycle= 6 E= -75.3456896284284  delta_E= -5.4e-09  |g|= 1.56e-05  |ddm|= 0.000165
HOMO (B2u) = -0.355607628482627  LUMO (B3u) = -0.0324756124305758
cycle= 7 E= -75.3456896285829  delta_E= -1.55e-10  |g|= 1.94e-06  |ddm|= 3.47e-05
HOMO (B2u) = -0.355606961355048  LUMO (B3u) = -0.0324753268422256
cycle= 8 E= -75.3456896285854  delta_E= -2.47e-12  |g|= 1.17e-07  |ddm|= 4.13e-06
HOMO (B2u) = -0.355606972650228  LUMO (B3u) = -0.0324753336783064
cycle= 9 E= -75.3456896285854  delta_E=    0  |g|= 7.02e-09  |ddm|= 2.39e-07
HOMO (B2u) = -0.355606973121315  LUMO (B3u) = -0.0324753357847754
cycle= 10 E= -75.3456896285854  delta_E=    0  |g|= 5.12e-09  |ddm|= 7.53e-09
HOMO (B2u) = -0.355606972919616  LUMO (B3u) = -0.0324753355623303
cycle= 11 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 4.03e-09  |ddm|= 4.15e-09
HOMO (B2u) = -0.355606971599799  LUMO (B3u) = -0.0324753341761667
cycle= 12 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 3.67e-09  |ddm|= 1.89e-09
HOMO (B2u) = -0.355606971984169  LUMO (B3u) = -0.032475334545996
cycle= 13 E= -75.3456896285855  delta_E= -8.53e-14  |g|= 3.28e-09  |ddm|= 1.07e-09
HOMO (B2u) = -0.355606971978621  LUMO (B3u) = -0.0324753345653278
cycle= 14 E= -75.3456896285854  delta_E= 8.53e-14  |g|= 3.08e-09  |ddm|= 7.32e-10
HOMO (B2u) = -0.355606971764231  LUMO (B3u) = -0.0324753342957669
cycle= 15 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 7.17e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.355606971674273  LUMO (B3u) = -0.0324753342947331
cycle= 16 E= -75.3456896285853  delta_E= 8.53e-14  |g|= 7.7e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.355606971704685  LUMO (B3u) = -0.0324753342895558
cycle= 17 E= -75.3456896285854  delta_E= -8.53e-14  |g|= 7.69e-10  |ddm|= 6.14e-10
HOMO (B2u) = -0.355606971687492  LUMO (B3u) = -0.0324753342674219
cycle= 18 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 5.86e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.355606971696388  LUMO (B3u) = -0.0324753342793535
cycle= 19 E= -75.3456896285854  delta_E=    0  |g|= 5.26e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.355606971707019  LUMO (B3u) = -0.0324753342920672
cycle= 20 E= -75.3456896285854  delta_E=    0  |g|= 4.52e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.355606971703298  LUMO (B3u) = -0.0324753342875926
cycle= 21 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 3.59e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.355606971702998  LUMO (B3u) = -0.032475334288086
cycle= 22 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 2.68e-10  |ddm|= 1.69e-10
HOMO (B2u) = -0.355606971703309  LUMO (B3u) = -0.0324753342883303
cycle= 23 E= -75.3456896285855  delta_E= -5.68e-14  |g|= 1.73e-10  |ddm|= 1.82e-10
HOMO (B2u) = -0.355606971698459  LUMO (B3u) = -0.0324753342857345
cycle= 24 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 1.54e-10  |ddm|= 5.83e-11
HOMO (B2u) = -0.355606971698413  LUMO (B3u) = -0.0324753342842453
cycle= 25 E= -75.3456896285855  delta_E= -5.68e-14  |g|= 1.3e-10  |ddm|= 5.11e-11
HOMO (B2u) = -0.355606971697199  LUMO (B3u) = -0.0324753342829316
cycle= 26 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 1.08e-10  |ddm|= 4.42e-11
HOMO (B2u) = -0.355606971695944  LUMO (B3u) = -0.0324753342817232
cycle= 27 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 9.28e-11  |ddm|= 3.29e-11
HOMO (B2u) = -0.355606971694923  LUMO (B3u) = -0.0324753342806689
cycle= 28 E= -75.3456896285854  delta_E= -5.68e-14  |g|= 7.62e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.355606971694215  LUMO (B3u) = -0.0324753342799002
cycle= 29 E= -75.3456896285854  delta_E=    0  |g|= 6.08e-11  |ddm|= 3.16e-11
HOMO (B2u) = -0.355606971692347  LUMO (B3u) = -0.0324753342779033
Extra cycle  E= -75.3456896285854  delta_E=    0  |g|= 2.3e-11  |ddm|= 7.98e-11
converged SCF energy = -75.3456896285854

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpxzvljnro
max_memory 4000 MB (current use 320 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4564838553944  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4691733729364  dE = -0.012689518  S^2 = 0.0000000
               |grad[o]|=0.0865  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4801083821044  dE = -0.010935009  S^2 = 0.0000000
               |grad[o]|=0.0752  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4889631035538  dE = -0.0088547214  S^2 = 0.0000000
               |grad[o]|=0.0624  |ddm|=0.0406  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.495778971285  dE = -0.0068158677  S^2 = 0.0000000
               |grad[o]|=0.0491  |ddm|=0.0471  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5005605118448  dE = -0.0047815406  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.0609  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5027257962515  dE = -0.0021652844  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.0448  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5031948312488  dE = -0.000469035  S^2 = 0.0000000
               |grad[o]|=0.00722  |ddm|=0.0469  |maxRot[o]|= 0.04
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5032865778878  dE = -9.1746639e-05  S^2 = 0.0000000
               |grad[o]|=0.00309  |ddm|=0.0149  |maxRot[o]|= 0.02
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5032982747812  dE = -1.1696893e-05  S^2 = 0.0000000
               |grad[o]|=0.00115  |ddm|=0.00551  |maxRot[o]|=0.00744
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5032995997978  dE = -1.3250166e-06  S^2 = 0.0000000
               |grad[o]|=0.000405  |ddm|=0.00187  |maxRot[o]|=0.00253
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5032997456183  dE = -1.4582045e-07  S^2 = 0.0000000
               |grad[o]|=0.000138  |ddm|=0.000621  |maxRot[o]|=0.000845
macro iter 12 (2 JK  0 micro), CASSCF E = -75.5032997614883  dE = -1.587e-08  S^2 = 0.0000000
               |grad[o]|=4.59e-05  |ddm|=0.000206  |maxRot[o]|=0.000279
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5032997632074  dE = -1.7191724e-09  S^2 = 0.0000000
               |grad[o]|=1.52e-05  |ddm|=6.73e-05  |maxRot[o]|=9.2e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5032997633895  dE = -1.8208368e-10  S^2 = 0.0000000
               |grad[o]|=5.06e-06  |ddm|=2.27e-05  |maxRot[o]|=3.05e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5032997634144  dE = -2.4925839e-11  S^2 = 0.0000000
               |grad[o]|=1.69e-06  |ddm|=7.63e-06  |maxRot[o]|=1.01e-05
2-step CASSCF converged in 15 macro (59 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96274301 1.92928247 1.89992238 1.8142028  0.07676462 0.19201084
 0.05872205 0.06635183]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01059   0.00982  -0.00515   0.00000   0.00000
  0 C 2s       0.62877   0.64927  -0.32247   0.00000   0.00000
  0 C 3s      -0.01802   0.01723  -0.04662  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69435
  0 C 2py     -0.00000   0.00000  -0.00000   0.70442   0.00000
  0 C 2pz      0.32084  -0.27893   0.62651  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000  -0.05813
  0 C 3py     -0.00000   0.00000  -0.00000   0.04890  -0.00000
  0 C 3pz     -0.02026  -0.00235   0.00351  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03743  -0.00000
  0 C 3dz^2    0.02926  -0.01397   0.03504  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000  -0.12042
 0 C 3dx2-y2  -0.00088   0.00700  -0.00745  -0.00000   0.00000
  1 C 1s       0.01059  -0.00982  -0.00515   0.00000   0.00000
  1 C 2s       0.62877  -0.64927  -0.32247   0.00000  -0.00000
  1 C 3s      -0.01802  -0.01723  -0.04662   0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70442   0.00000
  1 C 2pz     -0.32084  -0.27893  -0.62651  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.05813
  1 C 3py      0.00000  -0.00000   0.00000   0.04890  -0.00000
  1 C 3pz      0.02026  -0.00235  -0.00351  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.03743   0.00000
  1 C 3dz^2    0.02926   0.01397   0.03504   0.00000  -0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12042
 1 C 3dx2-y2  -0.00088  -0.00700  -0.00745   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00046
  0 C 2s      -0.00000   0.00000   0.27729
  0 C 3s      -0.00000   0.00000   0.03734
  0 C 2px     -0.00000   0.69739   0.00000
  0 C 2py      0.70675   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.64700
  0 C 3px     -0.00000  -0.00124   0.00000
  0 C 3py     -0.01872   0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.04893
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01263  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01067
  0 C 3dxz     0.00000  -0.11680   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.02442
  1 C 1s       0.00000   0.00000   0.00046
  1 C 2s      -0.00000  -0.00000  -0.27729
  1 C 3s       0.00000  -0.00000  -0.03734
  1 C 2px     -0.00000  -0.69739  -0.00000
  1 C 2py     -0.70675   0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.64700
  1 C 3px      0.00000   0.00124  -0.00000
  1 C 3py      0.01872  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04893
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01263  -0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01067
  1 C 3dxz    -0.00000  -0.11680   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02442
<CAS-nat-orb|mo-hf>  3  3    0.99427993
<CAS-nat-orb|mo-hf>  4  4    0.99973720
<CAS-nat-orb|mo-hf>  5  5    0.99429720
<CAS-nat-orb|mo-hf>  6  6    0.99915774
<CAS-nat-orb|mo-hf>  7  7    0.93938547
<CAS-nat-orb|mo-hf>  8  8    0.97438152
<CAS-nat-orb|mo-hf>  9  9    0.95919913
<CAS-nat-orb|mo-hf>  10  10    0.88692941
<CAS-nat-orb|mo-hf>  10  11   -0.43885970
CASSCF energy = -75.5032997634144
CASCI E = -75.5032997634144  E(CI) = -15.5624178249744  S^2 = 0.0000000
Density matrix diagonal elements [1.96274315 1.92928299 1.89992312 1.8142033  0.07676329 0.19201048
 0.05872185 0.06635183]
i = 1  <i|F|i> = -11.34170113
i = 2  <i|F|i> = -11.34190061
i = 3  <i|F|i> =  -0.86237766
i = 4  <i|F|i> =  -0.61331382
i = 5  <i|F|i> =  -0.37966104
i = 6  <i|F|i> =  -0.31447341
i = 7  <i|F|i> =   0.08322256
i = 8  <i|F|i> =   0.07460995
i = 9  <i|F|i> =   0.19668350
i = 10  <i|F|i> =   0.36769793
i = 11  <i|F|i> =   0.58104384
i = 12  <i|F|i> =   0.69115484
i = 13  <i|F|i> =   0.64946847
i = 14  <i|F|i> =   0.70516575
i = 15  <i|F|i> =   0.74342043
i = 16  <i|F|i> =   0.71441350
i = 17  <i|F|i> =   0.72078074
i = 18  <i|F|i> =   1.03315317
i = 19  <i|F|i> =   1.14835446
i = 20  <i|F|i> =   1.20731821
i = 21  <i|F|i> =   1.31901148
i = 22  <i|F|i> =   1.31920444
i = 23  <i|F|i> =   1.46959970
i = 24  <i|F|i> =   1.46816517
i = 25  <i|F|i> =   1.58727323
i = 26  <i|F|i> =   1.74772841
i = 27  <i|F|i> =   1.81271545
i = 28  <i|F|i> =   2.14007633
......production of RDMs took       1.96 sec
......reading the RDM took          0.44 sec
......production of RDMs took      30.46 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.74 sec

E(WickICNEVPT2-ijrs) =    -0.00028392175789
E(WickICNEVPT2- rsi) =    -0.00080147663303
E(WickICNEVPT2- ijr) =    -0.00027849329895
E(WickICNEVPT2-  rs) =    -0.03458004858572
E(WickICNEVPT2-  ij) =    -0.00007686821861
E(WickICNEVPT2-  ir) =    -0.00104701887002
E(WickICNEVPT2-   r) =    -0.05779155850980
E(WickICNEVPT2-   i) =    -0.00008002388511
E(WickICNEVPT2) = -75.59823917317358  E_corr_pt = -0.09493940975913327
Timings = pdms =   42.57 | eris =    0.03 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.50 | ij =    0.14 | ir =    0.28 | r =    2.90 | i =    1.08 | total =   47.55
Time cost =    355.249
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:31:21 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.799202517128 AA    0.000000000000   0.000000000000   3.400000000000 Bohr   0.0

nuclear repulsion = 10.5882352941176
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.7]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      4902.07


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp96liwy1q
max_memory 4000 MB (current use 318 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8043126951475

WARN: Singularity detected in overlap matrix (condition number =  122). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.123626145223848  LUMO (B3u) = -0.123626145223849

WARN: B2u HOMO -0.123626145223848 > system LUMO -0.123626145223849

cycle= 1 E= -75.3111334513161  delta_E= -0.507  |g|= 0.249  |ddm|=  1.5
HOMO (B2u) = -0.383724747851055  LUMO (B3u) = -0.0672275188573608
cycle= 2 E= -75.3357364104633  delta_E= -0.0246  |g|= 0.0507  |ddm|= 0.351
HOMO (B2u) = -0.347026718276071  LUMO (B3u) = -0.0257227421999457
cycle= 3 E= -75.337165289928  delta_E= -0.00143  |g|= 0.0181  |ddm|= 0.0673
HOMO (B2u) = -0.351526070447291  LUMO (B3u) = -0.0301077062023752
cycle= 4 E= -75.3373878233178  delta_E= -0.000223  |g|= 0.000675  |ddm|= 0.0372
HOMO (B2u) = -0.351660112314435  LUMO (B3u) = -0.0303898359337075
cycle= 5 E= -75.3373879985295  delta_E= -1.75e-07  |g|= 0.000102  |ddm|= 0.000975
HOMO (B2u) = -0.351623840121637  LUMO (B3u) = -0.030355571962397
cycle= 6 E= -75.3373880044287  delta_E= -5.9e-09  |g|= 1.61e-05  |ddm|= 0.000173
HOMO (B2u) = -0.351621725064436  LUMO (B3u) = -0.0303564386936711
cycle= 7 E= -75.3373880045927  delta_E= -1.64e-10  |g|= 1.94e-06  |ddm|= 3.52e-05
HOMO (B2u) = -0.351621087023842  LUMO (B3u) = -0.0303561953012023
cycle= 8 E= -75.3373880045953  delta_E= -2.53e-12  |g|= 1.2e-07  |ddm|= 4.09e-06
HOMO (B2u) = -0.351621096028007  LUMO (B3u) = -0.0303561996523085
cycle= 9 E= -75.3373880045952  delta_E= 5.68e-14  |g|= 7.3e-09  |ddm|= 2.5e-07
HOMO (B2u) = -0.351621096337596  LUMO (B3u) = -0.0303562016411111
cycle= 10 E= -75.3373880045952  delta_E= 4.26e-14  |g|= 5.48e-09  |ddm|= 7.67e-09
HOMO (B2u) = -0.351621096130334  LUMO (B3u) = -0.0303562014210079
cycle= 11 E= -75.3373880045952  delta_E= -4.26e-14  |g|= 4.19e-09  |ddm|= 4.36e-09
HOMO (B2u) = -0.351621094785326  LUMO (B3u) = -0.0303562000104109
cycle= 12 E= -75.3373880045953  delta_E= -5.68e-14  |g|= 3.79e-09  |ddm|= 1.99e-09
HOMO (B2u) = -0.351621095168533  LUMO (B3u) = -0.0303562003839728
cycle= 13 E= -75.3373880045952  delta_E= 5.68e-14  |g|= 3.4e-09  |ddm|= 1.23e-09
HOMO (B2u) = -0.351621095129708  LUMO (B3u) = -0.0303562003621745
cycle= 14 E= -75.3373880045953  delta_E= -5.68e-14  |g|= 3.04e-09  |ddm|= 6.93e-10
HOMO (B2u) = -0.351621094931948  LUMO (B3u) = -0.0303562001382079
cycle= 15 E= -75.3373880045953  delta_E= -2.84e-14  |g|= 7.9e-10  |ddm|= 4.8e-09
HOMO (B2u) = -0.351621094828778  LUMO (B3u) = -0.0303562001337953
cycle= 16 E= -75.3373880045952  delta_E= 4.26e-14  |g|= 8.05e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.351621094865842  LUMO (B3u) = -0.0303562001249232
cycle= 17 E= -75.3373880045951  delta_E= 1.14e-13  |g|= 8.23e-10  |ddm|= 8.23e-10
HOMO (B2u) = -0.351621094843505  LUMO (B3u) = -0.0303562001008729
cycle= 18 E= -75.3373880045953  delta_E= -1.42e-13  |g|= 6.29e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.351621094849271  LUMO (B3u) = -0.0303562001110235
cycle= 19 E= -75.3373880045952  delta_E= 7.11e-14  |g|= 5.5e-10  |ddm|= 3.07e-10
HOMO (B2u) = -0.35162109485691  LUMO (B3u) = -0.0303562001220162
cycle= 20 E= -75.3373880045952  delta_E= -1.42e-14  |g|= 4.68e-10  |ddm|= 2.06e-10
HOMO (B2u) = -0.351621094850127  LUMO (B3u) = -0.0303562001157029
cycle= 21 E= -75.3373880045953  delta_E= -4.26e-14  |g|= 3.7e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.351621094847081  LUMO (B3u) = -0.0303562001145439
cycle= 22 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 2.74e-10  |ddm|= 1.96e-10
HOMO (B2u) = -0.351621094844428  LUMO (B3u) = -0.0303562001131813
cycle= 23 E= -75.3373880045952  delta_E= 5.68e-14  |g|= 1.83e-10  |ddm|= 1.88e-10
HOMO (B2u) = -0.35162109483894  LUMO (B3u) = -0.0303562001103525
cycle= 24 E= -75.3373880045953  delta_E= -8.53e-14  |g|= 1.61e-10  |ddm|= 6.43e-11
HOMO (B2u) = -0.351621094838495  LUMO (B3u) = -0.0303562001084871
cycle= 25 E= -75.3373880045952  delta_E= 9.95e-14  |g|= 1.36e-10  |ddm|= 5.73e-11
HOMO (B2u) = -0.351621094836488  LUMO (B3u) = -0.0303562001067928
cycle= 26 E= -75.3373880045952  delta_E=    0  |g|= 1.12e-10  |ddm|= 5.33e-11
HOMO (B2u) = -0.351621094834664  LUMO (B3u) = -0.0303562001053162
cycle= 27 E= -75.3373880045952  delta_E= -5.68e-14  |g|= 9.56e-11  |ddm|= 4.01e-11
HOMO (B2u) = -0.351621094833169  LUMO (B3u) = -0.0303562001040477
cycle= 28 E= -75.3373880045952  delta_E= 1.42e-14  |g|= 7.83e-11  |ddm|= 3.82e-11
HOMO (B2u) = -0.351621094832068  LUMO (B3u) = -0.0303562001031021
cycle= 29 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 6.25e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.351621094831095  LUMO (B3u) = -0.030356200102282
cycle= 30 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 4.96e-11  |ddm|= 2.81e-11
HOMO (B2u) = -0.351621094830367  LUMO (B3u) = -0.0303562001016681
cycle= 31 E= -75.3373880045952  delta_E= -4.26e-14  |g|= 3.99e-11  |ddm|= 2.12e-11
HOMO (B2u) = -0.351621094829859  LUMO (B3u) = -0.0303562001012568
cycle= 32 E= -75.3373880045952  delta_E= 7.11e-14  |g|= 3.36e-11  |ddm|= 1.42e-11
HOMO (B2u) = -0.35162109482953  LUMO (B3u) = -0.030356200100913
cycle= 33 E= -75.3373880045952  delta_E=    0  |g|= 2.8e-11  |ddm|= 1.24e-11
HOMO (B2u) = -0.351621094828354  LUMO (B3u) = -0.0303562000998639
Extra cycle  E= -75.3373880045953  delta_E= -8.53e-14  |g|= 1.07e-11  |ddm|= 3.79e-11
converged SCF energy = -75.3373880045953

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp96liwy1q
max_memory 4000 MB (current use 318 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4523708352866  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.46548026737  dE = -0.013109432  S^2 = 0.0000000
               |grad[o]|=0.0884  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4766184169948  dE = -0.01113815  S^2 = 0.0000000
               |grad[o]|=0.0759  |ddm|=0.0715  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4854060650756  dE = -0.0087876481  S^2 = 0.0000000
               |grad[o]|=0.0617  |ddm|=0.0413  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4919732081388  dE = -0.0065671431  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.048  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4965052075377  dE = -0.0045319994  S^2 = 0.0000000
               |grad[o]|=0.0318  |ddm|=0.0653  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4980364476433  dE = -0.0015312401  S^2 = 0.0000000
               |grad[o]|=0.0142  |ddm|=0.0476  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4983508478308  dE = -0.00031440019  S^2 = 0.0000000
               |grad[o]|=0.00565  |ddm|=0.0316  |maxRot[o]|=0.0358
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4983917552915  dE = -4.0907461e-05  S^2 = 0.0000000
               |grad[o]|=0.0021  |ddm|=0.0103  |maxRot[o]|=0.0138
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4983962080755  dE = -4.452784e-06  S^2 = 0.0000000
               |grad[o]|=0.000736  |ddm|=0.0033  |maxRot[o]|=0.00467
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4983966685694  dE = -4.6049382e-07  S^2 = 0.0000000
               |grad[o]|=0.000246  |ddm|=0.00107  |maxRot[o]|=0.00151
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4983967154179  dE = -4.6848498e-08  S^2 = 0.0000000
               |grad[o]|=7.99e-05  |ddm|=0.000342  |maxRot[o]|=0.000483
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4983967201881  dE = -4.7702571e-09  S^2 = 0.0000000
               |grad[o]|=2.57e-05  |ddm|=0.000109  |maxRot[o]|=0.000155
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4983967206664  dE = -4.7823789e-10  S^2 = 0.0000000
               |grad[o]|=8.2e-06  |ddm|=3.47e-05  |maxRot[o]|=4.91e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4983967207137  dE = -4.7350568e-11  S^2 = 0.0000000
               |grad[o]|=2.59e-06  |ddm|=1.1e-05  |maxRot[o]|=1.54e-05
2-step CASSCF converged in 14 macro (57 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96168427 1.92995961 1.89788677 1.80319402 0.07495279 0.20294448
 0.05842681 0.07095125]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01086   0.00993  -0.00483   0.00000   0.00000
  0 C 2s       0.63886   0.65282  -0.30204  -0.00000  -0.00000
  0 C 3s      -0.01519   0.01695  -0.04490  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69411
  0 C 2py      0.00000  -0.00000  -0.00000   0.70440   0.00000
  0 C 2pz      0.30069  -0.27056   0.63672  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.05943
  0 C 3py      0.00000  -0.00000  -0.00000   0.05007   0.00000
  0 C 3pz     -0.01863  -0.00220   0.00482  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03622   0.00000
  0 C 3dz^2    0.02743  -0.01357   0.03519  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.12113
 0 C 3dx2-y2  -0.00059   0.00688  -0.00742  -0.00000  -0.00000
  1 C 1s       0.01086  -0.00993  -0.00483   0.00000   0.00000
  1 C 2s       0.63886  -0.65282  -0.30204   0.00000  -0.00000
  1 C 3s      -0.01519  -0.01695  -0.04490   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69411
  1 C 2py     -0.00000   0.00000   0.00000   0.70440  -0.00000
  1 C 2pz     -0.30069  -0.27056  -0.63672  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.05943
  1 C 3py     -0.00000   0.00000   0.00000   0.05007  -0.00000
  1 C 3pz      0.01863  -0.00220  -0.00482  -0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03622   0.00000
  1 C 3dz^2    0.02743   0.01357   0.03519   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12113
 1 C 3dx2-y2  -0.00059  -0.00688  -0.00742   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00043
  0 C 2s      -0.00000  -0.00000   0.26907
  0 C 3s      -0.00000  -0.00000   0.03634
  0 C 2px      0.00000   0.69753  -0.00000
  0 C 2py      0.70681   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.65078
  0 C 3px      0.00000  -0.00334  -0.00000
  0 C 3py     -0.01665   0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04624
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01219   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00964
  0 C 3dxz     0.00000  -0.11596  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02324
  1 C 1s       0.00000   0.00000   0.00043
  1 C 2s       0.00000  -0.00000  -0.26907
  1 C 3s       0.00000   0.00000  -0.03634
  1 C 2px      0.00000  -0.69753   0.00000
  1 C 2py     -0.70681  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.65078
  1 C 3px     -0.00000   0.00334   0.00000
  1 C 3py      0.01665  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04624
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.01219   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00964
  1 C 3dxz     0.00000  -0.11596  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02324
<CAS-nat-orb|mo-hf>  3  3    0.99623595
<CAS-nat-orb|mo-hf>  4  4    0.99972951
<CAS-nat-orb|mo-hf>  5  5    0.99625438
<CAS-nat-orb|mo-hf>  6  6    0.99910667
<CAS-nat-orb|mo-hf>  7  7    0.93825029
<CAS-nat-orb|mo-hf>  8  8    0.97590449
<CAS-nat-orb|mo-hf>  9  9    0.95945853
<CAS-nat-orb|mo-hf>  10  10    0.89805646
<CAS-nat-orb|mo-hf>  10  11   -0.41828627
CASSCF energy = -75.4983967207137
CASCI E = -75.4983967207137  E(CI) = -15.4874144112172  S^2 = 0.0000000
Density matrix diagonal elements [1.96168457 1.92996036 1.89788831 1.80319423 0.07495045 0.20294435
 0.05842652 0.07095121]
i = 1  <i|F|i> = -11.34261351
i = 2  <i|F|i> = -11.34284696
i = 3  <i|F|i> =  -0.85681815
i = 4  <i|F|i> =  -0.61649540
i = 5  <i|F|i> =  -0.37411765
i = 6  <i|F|i> =  -0.30896690
i = 7  <i|F|i> =   0.08710433
i = 8  <i|F|i> =   0.06727355
i = 9  <i|F|i> =   0.19378343
i = 10  <i|F|i> =   0.34810746
i = 11  <i|F|i> =   0.58538483
i = 12  <i|F|i> =   0.69136623
i = 13  <i|F|i> =   0.64731837
i = 14  <i|F|i> =   0.70850007
i = 15  <i|F|i> =   0.74820609
i = 16  <i|F|i> =   0.71570929
i = 17  <i|F|i> =   0.72037683
i = 18  <i|F|i> =   1.02885677
i = 19  <i|F|i> =   1.15123645
i = 20  <i|F|i> =   1.20830065
i = 21  <i|F|i> =   1.32396481
i = 22  <i|F|i> =   1.32416661
i = 23  <i|F|i> =   1.46514723
i = 24  <i|F|i> =   1.46383917
i = 25  <i|F|i> =   1.56103852
i = 26  <i|F|i> =   1.73268995
i = 27  <i|F|i> =   1.79691808
i = 28  <i|F|i> =   2.14049860
......production of RDMs took       1.83 sec
......reading the RDM took          0.45 sec
......production of RDMs took      56.89 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.81 sec

E(WickICNEVPT2-ijrs) =    -0.00028478793364
E(WickICNEVPT2- rsi) =    -0.00080149667545
E(WickICNEVPT2- ijr) =    -0.00027587635807
E(WickICNEVPT2-  rs) =    -0.03438195875619
E(WickICNEVPT2-  ij) =    -0.00007411076354
E(WickICNEVPT2-  ir) =    -0.00103867713798
E(WickICNEVPT2-   r) =    -0.05819123432538
E(WickICNEVPT2-   i) =    -0.00007618575499
E(WickICNEVPT2) = -75.59352104841896  E_corr_pt = -0.09512432770524994
Timings = pdms =   68.95 | eris =    0.62 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.27 | ij =    0.07 | ir =    0.14 | r =    1.93 | i =    0.83 | total =   72.87
Time cost =    245.031
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:35:26 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.825661377674 AA    0.000000000000   0.000000000000   3.450000000000 Bohr   0.0

nuclear repulsion = 10.4347826086957
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.725]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5121.67


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpyu3bhprd
max_memory 4000 MB (current use 317 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7871059587891

WARN: Singularity detected in overlap matrix (condition number =  114). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.119977421491999  LUMO (B3u) = -0.119977421491999

WARN: B2u HOMO -0.119977421491999 > system LUMO -0.119977421491999

cycle= 1 E= -75.3032347208422  delta_E= -0.516  |g|= 0.247  |ddm|=  1.5
HOMO (B2u) = -0.379319419622634  LUMO (B3u) = -0.0646054692258417
cycle= 2 E= -75.327444504769  delta_E= -0.0242  |g|= 0.0501  |ddm|= 0.35
HOMO (B2u) = -0.343173022356371  LUMO (B3u) = -0.0236834315639849
cycle= 3 E= -75.3288571081842  delta_E= -0.00141  |g|= 0.018  |ddm|= 0.0664
HOMO (B2u) = -0.347657119428849  LUMO (B3u) = -0.0280415501187841
cycle= 4 E= -75.3290795920014  delta_E= -0.000222  |g|= 0.00067  |ddm|= 0.0369
HOMO (B2u) = -0.347805946692315  LUMO (B3u) = -0.0283390207306007
cycle= 5 E= -75.3290797635008  delta_E= -1.71e-07  |g|= 0.000106  |ddm|= 0.000935
HOMO (B2u) = -0.347769025805498  LUMO (B3u) = -0.0283049912511335
cycle= 6 E= -75.3290797699135  delta_E= -6.41e-09  |g|= 1.65e-05  |ddm|= 0.000181
HOMO (B2u) = -0.347766788756665  LUMO (B3u) = -0.0283057158319162
cycle= 7 E= -75.3290797700874  delta_E= -1.74e-10  |g|= 1.94e-06  |ddm|= 3.58e-05
HOMO (B2u) = -0.34776617940692  LUMO (B3u) = -0.0283055115205126
cycle= 8 E= -75.3290797700899  delta_E= -2.47e-12  |g|= 1.22e-07  |ddm|= 4.05e-06
HOMO (B2u) = -0.347766186618019  LUMO (B3u) = -0.0283055139496229
cycle= 9 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 7.66e-09  |ddm|= 2.61e-07
HOMO (B2u) = -0.347766186760276  LUMO (B3u) = -0.0283055158235439
cycle= 10 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 5.88e-09  |ddm|= 7.8e-09
HOMO (B2u) = -0.347766186553263  LUMO (B3u) = -0.0283055156123698
cycle= 11 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 4.4e-09  |ddm|= 4.59e-09
HOMO (B2u) = -0.347766185193172  LUMO (B3u) = -0.0283055141901203
cycle= 12 E= -75.3290797700898  delta_E= -1.42e-14  |g|= 3.94e-09  |ddm|= 2.13e-09
HOMO (B2u) = -0.347766185565661  LUMO (B3u) = -0.02830551455673
cycle= 13 E= -75.3290797700899  delta_E= -1.42e-14  |g|= 3.55e-09  |ddm|= 1.35e-09
HOMO (B2u) = -0.347766185498257  LUMO (B3u) = -0.028305514501106
cycle= 14 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 3.06e-09  |ddm|= 9.46e-10
HOMO (B2u) = -0.347766185312268  LUMO (B3u) = -0.0283055143167979
cycle= 15 E= -75.3290797700899  delta_E= -9.95e-14  |g|= 8.69e-10  |ddm|= 5.07e-09
HOMO (B2u) = -0.347766185208997  LUMO (B3u) = -0.0283055143073631
cycle= 16 E= -75.3290797700898  delta_E= 1.14e-13  |g|= 8.55e-10  |ddm|= 1.37e-09
HOMO (B2u) = -0.34776618524106  LUMO (B3u) = -0.0283055142974205
cycle= 17 E= -75.3290797700898  delta_E= -1.42e-14  |g|= 8.91e-10  |ddm|= 7.73e-10
HOMO (B2u) = -0.347766185214193  LUMO (B3u) = -0.0283055142720508
cycle= 18 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 6.83e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.34776618521701  LUMO (B3u) = -0.0283055142806924
cycle= 19 E= -75.3290797700899  delta_E= -1.28e-13  |g|= 5.82e-10  |ddm|= 3.65e-10
HOMO (B2u) = -0.347766185221917  LUMO (B3u) = -0.0283055142902954
cycle= 20 E= -75.3290797700898  delta_E= 9.95e-14  |g|= 4.9e-10  |ddm|= 2.5e-10
HOMO (B2u) = -0.347766185212451  LUMO (B3u) = -0.0283055142825459
cycle= 21 E= -75.3290797700898  delta_E=    0  |g|= 3.86e-10  |ddm|= 2.35e-10
HOMO (B2u) = -0.347766185206885  LUMO (B3u) = -0.0283055142799963
cycle= 22 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 2.84e-10  |ddm|= 2.23e-10
HOMO (B2u) = -0.347766185201638  LUMO (B3u) = -0.0283055142773474
cycle= 23 E= -75.3290797700898  delta_E= -4.26e-14  |g|= 1.94e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.347766185195544  LUMO (B3u) = -0.0283055142743026
cycle= 24 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 1.7e-10  |ddm|= 7.07e-11
HOMO (B2u) = -0.34776618519421  LUMO (B3u) = -0.0283055142721251
cycle= 25 E= -75.3290797700899  delta_E= -5.68e-14  |g|= 1.43e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.347766185191444  LUMO (B3u) = -0.0283055142701073
cycle= 26 E= -75.3290797700898  delta_E= 7.11e-14  |g|= 1.18e-10  |ddm|= 6.3e-11
HOMO (B2u) = -0.347766185189069  LUMO (B3u) = -0.0283055142684045
cycle= 27 E= -75.3290797700898  delta_E= -4.26e-14  |g|= 9.9e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.347766185187114  LUMO (B3u) = -0.0283055142669578
cycle= 28 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 8.08e-11  |ddm|= 4.27e-11
HOMO (B2u) = -0.347766185185624  LUMO (B3u) = -0.0283055142658637
cycle= 29 E= -75.3290797700898  delta_E= -1.42e-14  |g|= 6.43e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.347766185184338  LUMO (B3u) = -0.0283055142649274
cycle= 30 E= -75.3290797700898  delta_E= -1.42e-14  |g|= 5.1e-11  |ddm|= 3.01e-11
HOMO (B2u) = -0.347766185183369  LUMO (B3u) = -0.0283055142642287
cycle= 31 E= -75.3290797700898  delta_E=    0  |g|= 4.11e-11  |ddm|= 2.24e-11
HOMO (B2u) = -0.347766185180985  LUMO (B3u) = -0.028305514262437
Extra cycle  E= -75.3290797700898  delta_E= 2.84e-14  |g|= 1.55e-11  |ddm|= 5.87e-11
converged SCF energy = -75.3290797700898

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpyu3bhprd
max_memory 4000 MB (current use 317 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4482666492426  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4618049986753  dE = -0.013538349  S^2 = 0.0000000
               |grad[o]|=0.0903  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.473137240898  dE = -0.011332242  S^2 = 0.0000000
               |grad[o]|=0.0766  |ddm|=0.0762  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4818347664696  dE = -0.0086975256  S^2 = 0.0000000
               |grad[o]|=0.0609  |ddm|=0.0424  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4881398056544  dE = -0.0063050392  S^2 = 0.0000000
               |grad[o]|=0.0447  |ddm|=0.0518  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4917456919673  dE = -0.0036058863  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.0696  |maxRot[o]|= 0.06
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4932311762251  dE = -0.0014854843  S^2 = 0.0000000
               |grad[o]|=0.014  |ddm|=0.0391  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4935071628875  dE = -0.00027598666  S^2 = 0.0000000
               |grad[o]|=0.00522  |ddm|=0.0263  |maxRot[o]|=0.034
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4935391201178  dE = -3.195723e-05  S^2 = 0.0000000
               |grad[o]|=0.00188  |ddm|=0.00869  |maxRot[o]|=0.0124
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4935423354116  dE = -3.2152939e-06  S^2 = 0.0000000
               |grad[o]|=0.000641  |ddm|=0.00271  |maxRot[o]|=0.004
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4935426466092  dE = -3.1119757e-07  S^2 = 0.0000000
               |grad[o]|=0.000207  |ddm|=0.000854  |maxRot[o]|=0.00125
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4935426764192  dE = -2.981001e-08  S^2 = 0.0000000
               |grad[o]|=6.54e-05  |ddm|=0.000266  |maxRot[o]|=0.000388
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4935426792612  dE = -2.8420146e-09  S^2 = 0.0000000
               |grad[o]|=2.04e-05  |ddm|=8.28e-05  |maxRot[o]|=0.00012
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4935426795291  dE = -2.6791724e-10  S^2 = 0.0000000
               |grad[o]|=6.32e-06  |ddm|=2.56e-05  |maxRot[o]|=3.72e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4935426795535  dE = -2.4371616e-11  S^2 = 0.0000000
               |grad[o]|=1.96e-06  |ddm|=7.9e-06  |maxRot[o]|=1.15e-05
2-step CASSCF converged in 14 macro (56 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96070609 1.93062246 1.89534328 1.79161505 0.07330624 0.21443249
 0.05813181 0.07584257]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01111   0.01003  -0.00449   0.00000   0.00000
  0 C 2s       0.64834   0.65619  -0.28117   0.00000   0.00000
  0 C 3s      -0.01251   0.01666  -0.04312  -0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69393
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439   0.00000
  0 C 2pz      0.28005  -0.26233   0.64632  -0.00000   0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06065
  0 C 3py      0.00000  -0.00000   0.00000   0.05111   0.00000
  0 C 3pz     -0.01714  -0.00207   0.00620  -0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.03500   0.00000
  0 C 3dz^2    0.02561  -0.01317   0.03529  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.12160
 0 C 3dx2-y2  -0.00030   0.00676  -0.00739   0.00000   0.00000
  1 C 1s       0.01111  -0.01003  -0.00449   0.00000   0.00000
  1 C 2s       0.64834  -0.65619  -0.28117   0.00000   0.00000
  1 C 3s      -0.01251  -0.01666  -0.04312   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69393
  1 C 2py     -0.00000   0.00000  -0.00000   0.70439  -0.00000
  1 C 2pz     -0.28005  -0.26233  -0.64632   0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000  -0.06065
  1 C 3py     -0.00000   0.00000   0.00000   0.05111  -0.00000
  1 C 3pz      0.01714  -0.00207  -0.00620  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03500   0.00000
  1 C 3dz^2    0.02561   0.01317   0.03529   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12160
 1 C 3dx2-y2  -0.00030  -0.00676  -0.00739  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s       0.00000   0.00000   0.26097
  0 C 3s      -0.00000   0.00000   0.03534
  0 C 2px     -0.00000   0.69766   0.00000
  0 C 2py      0.70686  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.65436
  0 C 3px     -0.00000  -0.00539  -0.00000
  0 C 3py     -0.01459  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04356
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01176  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00868
  0 C 3dxz    -0.00000  -0.11509   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02209
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.26097
  1 C 3s       0.00000  -0.00000  -0.03534
  1 C 2px      0.00000  -0.69766   0.00000
  1 C 2py     -0.70686   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.65436
  1 C 3px      0.00000   0.00539  -0.00000
  1 C 3py      0.01459   0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04356
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01176  -0.00000   0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00868
  1 C 3dxz    -0.00000  -0.11509   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02209
<CAS-nat-orb|mo-hf>  3  3    0.99779512
<CAS-nat-orb|mo-hf>  4  4    0.99972139
<CAS-nat-orb|mo-hf>  5  5    0.99781371
<CAS-nat-orb|mo-hf>  6  6    0.99905368
<CAS-nat-orb|mo-hf>  7  7    0.93724395
<CAS-nat-orb|mo-hf>  8  8    0.97733329
<CAS-nat-orb|mo-hf>  9  9    0.95969121
<CAS-nat-orb|mo-hf>  10  10    0.90788563
CASSCF energy = -75.4935426795535
CASCI E = -75.4935426795535  E(CI) = -15.4144875345159  S^2 = 0.0000000
Density matrix diagonal elements [1.9607064  1.93062285 1.8953433  1.79161591 0.07330536 0.214432
 0.05813169 0.07584249]
i = 1  <i|F|i> = -11.34339815
i = 2  <i|F|i> = -11.34366104
i = 3  <i|F|i> =  -0.85111785
i = 4  <i|F|i> =  -0.61958111
i = 5  <i|F|i> =  -0.36890398
i = 6  <i|F|i> =  -0.30352605
i = 7  <i|F|i> =   0.09068052
i = 8  <i|F|i> =   0.06014667
i = 9  <i|F|i> =   0.19101584
i = 10  <i|F|i> =   0.32949508
i = 11  <i|F|i> =   0.58968599
i = 12  <i|F|i> =   0.69134186
i = 13  <i|F|i> =   0.64511319
i = 14  <i|F|i> =   0.71108638
i = 15  <i|F|i> =   0.75372288
i = 16  <i|F|i> =   0.71698347
i = 17  <i|F|i> =   0.72001406
i = 18  <i|F|i> =   1.02475402
i = 19  <i|F|i> =   1.15493252
i = 20  <i|F|i> =   1.21007274
i = 21  <i|F|i> =   1.32875617
i = 22  <i|F|i> =   1.32896908
i = 23  <i|F|i> =   1.46093309
i = 24  <i|F|i> =   1.45974326
i = 25  <i|F|i> =   1.53550128
i = 26  <i|F|i> =   1.71790779
i = 27  <i|F|i> =   1.78131704
i = 28  <i|F|i> =   2.14009629
......production of RDMs took       2.35 sec
......reading the RDM took          0.42 sec
......production of RDMs took      24.30 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.83 sec

E(WickICNEVPT2-ijrs) =    -0.00028582396995
E(WickICNEVPT2- rsi) =    -0.00080211173785
E(WickICNEVPT2- ijr) =    -0.00027347530355
E(WickICNEVPT2-  rs) =    -0.03418929400301
E(WickICNEVPT2-  ij) =    -0.00007153263131
E(WickICNEVPT2-  ir) =    -0.00103098627026
E(WickICNEVPT2-   r) =    -0.05858027437286
E(WickICNEVPT2-   i) =    -0.00007256906102
E(WickICNEVPT2) = -75.58884874690331  E_corr_pt = -0.09530606734981058
Timings = pdms =   36.89 | eris =    0.02 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.44 | ij =    0.14 | ir =    0.21 | r =    1.86 | i =    0.72 | total =   40.34
Time cost =    119.613
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:37:26 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.852120238220 AA    0.000000000000   0.000000000000   3.500000000000 Bohr   0.0

nuclear repulsion = 10.2857142857143
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.75]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5265.06


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpf1hf8jdh
max_memory 4000 MB (current use 324 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.770995471526

WARN: Singularity detected in overlap matrix (condition number =  106). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.116499456302711  LUMO (B3u) = -0.116499456302711

WARN: B2u HOMO -0.116499456302711 > system LUMO -0.116499456302711

cycle= 1 E= -75.2953428985397  delta_E= -0.524  |g|= 0.245  |ddm|= 1.49
HOMO (B2u) = -0.375058505355512  LUMO (B3u) = -0.0620673626538293
cycle= 2 E= -75.3191698853078  delta_E= -0.0238  |g|= 0.0495  |ddm|= 0.35
HOMO (B2u) = -0.33945130724101  LUMO (B3u) = -0.0217153065240369
cycle= 3 E= -75.3205643325183  delta_E= -0.00139  |g|= 0.0179  |ddm|= 0.0655
HOMO (B2u) = -0.343918314413037  LUMO (B3u) = -0.0260457604373091
cycle= 4 E= -75.3207861657731  delta_E= -0.000222  |g|= 0.000666  |ddm|= 0.0365
HOMO (B2u) = -0.344078228753201  LUMO (B3u) = -0.026354530161275
cycle= 5 E= -75.3207863342661  delta_E= -1.68e-07  |g|= 0.00011  |ddm|= 0.000905
HOMO (B2u) = -0.344040928123835  LUMO (B3u) = -0.0263210064987872
cycle= 6 E= -75.3207863411988  delta_E= -6.93e-09  |g|= 1.7e-05  |ddm|= 0.000188
HOMO (B2u) = -0.344038581299421  LUMO (B3u) = -0.0263216091209638
cycle= 7 E= -75.3207863413827  delta_E= -1.84e-10  |g|= 1.93e-06  |ddm|= 3.63e-05
HOMO (B2u) = -0.344037999604733  LUMO (B3u) = -0.0263214409572579
cycle= 8 E= -75.3207863413851  delta_E= -2.44e-12  |g|= 1.24e-07  |ddm|= 4.02e-06
HOMO (B2u) = -0.344038005466855  LUMO (B3u) = -0.026321441945732
cycle= 9 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 8.04e-09  |ddm|= 2.72e-07
HOMO (B2u) = -0.344038005450483  LUMO (B3u) = -0.0263214437175566
cycle= 10 E= -75.3207863413851  delta_E=    0  |g|= 6.26e-09  |ddm|= 7.91e-09
HOMO (B2u) = -0.344038005257779  LUMO (B3u) = -0.0263214435358413
cycle= 11 E= -75.3207863413852  delta_E= -1.14e-13  |g|= 4.62e-09  |ddm|= 4.91e-09
HOMO (B2u) = -0.344038003879731  LUMO (B3u) = -0.0263214420965444
cycle= 12 E= -75.3207863413851  delta_E= 1.42e-13  |g|= 4.1e-09  |ddm|= 2.26e-09
HOMO (B2u) = -0.344038004235187  LUMO (B3u) = -0.026321442450432
cycle= 13 E= -75.3207863413852  delta_E= -1.14e-13  |g|= 3.69e-09  |ddm|= 1.47e-09
HOMO (B2u) = -0.344038004143377  LUMO (B3u) = -0.0263214423662343
cycle= 14 E= -75.3207863413851  delta_E= 1.14e-13  |g|= 3.11e-09  |ddm|= 1.26e-09
HOMO (B2u) = -0.344038003955589  LUMO (B3u) = -0.0263214422137552
cycle= 15 E= -75.3207863413851  delta_E= -2.84e-14  |g|= 9.32e-10  |ddm|= 5.21e-09
HOMO (B2u) = -0.344038003851158  LUMO (B3u) = -0.0263214422045219
cycle= 16 E= -75.3207863413851  delta_E=    0  |g|= 8.98e-10  |ddm|= 1.22e-09
HOMO (B2u) = -0.344038003889229  LUMO (B3u) = -0.0263214421914239
cycle= 17 E= -75.3207863413852  delta_E= -8.53e-14  |g|= 9.61e-10  |ddm|= 9.8e-10
HOMO (B2u) = -0.344038003858493  LUMO (B3u) = -0.0263214421653493
cycle= 18 E= -75.3207863413852  delta_E= 2.84e-14  |g|= 7.37e-10  |ddm|= 5.29e-10
HOMO (B2u) = -0.344038003858552  LUMO (B3u) = -0.02632144217282
cycle= 19 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 6.17e-10  |ddm|= 4.19e-10
HOMO (B2u) = -0.344038003861282  LUMO (B3u) = -0.02632144218155
cycle= 20 E= -75.3207863413851  delta_E=    0  |g|= 5.15e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.344038003849512  LUMO (B3u) = -0.0263214421727819
cycle= 21 E= -75.3207863413851  delta_E=    0  |g|= 4.04e-10  |ddm|= 2.64e-10
HOMO (B2u) = -0.344038003841708  LUMO (B3u) = -0.0263214421691253
cycle= 22 E= -75.3207863413851  delta_E=    0  |g|= 2.96e-10  |ddm|= 2.48e-10
HOMO (B2u) = -0.344038003834217  LUMO (B3u) = -0.0263214421655091
cycle= 23 E= -75.3207863413851  delta_E=    0  |g|= 2.07e-10  |ddm|= 2.11e-10
HOMO (B2u) = -0.344038003827952  LUMO (B3u) = -0.0263214421623587
cycle= 24 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 1.79e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.344038003826297  LUMO (B3u) = -0.0263214421599136
cycle= 25 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.51e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.344038003822879  LUMO (B3u) = -0.0263214421576399
cycle= 26 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 1.23e-10  |ddm|= 7.2e-11
HOMO (B2u) = -0.344038003820041  LUMO (B3u) = -0.0263214421557625
cycle= 27 E= -75.3207863413852  delta_E= -1.14e-13  |g|= 1.03e-10  |ddm|= 5.49e-11
HOMO (B2u) = -0.344038003817708  LUMO (B3u) = -0.0263214421541772
cycle= 28 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 8.37e-11  |ddm|= 4.71e-11
HOMO (B2u) = -0.344038003815909  LUMO (B3u) = -0.0263214421529702
cycle= 29 E= -75.3207863413851  delta_E= -2.84e-14  |g|= 6.65e-11  |ddm|= 4.03e-11
HOMO (B2u) = -0.344038003814385  LUMO (B3u) = -0.0263214421519469
cycle= 30 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 5.27e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.344038003813242  LUMO (B3u) = -0.0263214421511856
cycle= 31 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 4.26e-11  |ddm|= 2.38e-11
HOMO (B2u) = -0.344038003812438  LUMO (B3u) = -0.0263214421506454
cycle= 32 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 3.55e-11  |ddm|= 1.66e-11
HOMO (B2u) = -0.344038003811838  LUMO (B3u) = -0.0263214421501886
cycle= 33 E= -75.3207863413851  delta_E=    0  |g|= 2.94e-11  |ddm|= 1.44e-11
HOMO (B2u) = -0.344038003809897  LUMO (B3u) = -0.0263214421488331
Extra cycle  E= -75.3207863413851  delta_E=    0  |g|= 1.1e-11  |ddm|= 4.27e-11
converged SCF energy = -75.3207863413851

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpf1hf8jdh
max_memory 4000 MB (current use 324 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4441902032777  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4581664018814  dE = -0.013976199  S^2 = 0.0000000
               |grad[o]|=0.0923  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4696819209071  dE = -0.011515519  S^2 = 0.0000000
               |grad[o]|=0.0772  |ddm|=0.0811  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4782645461769  dE = -0.0085826253  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.0433  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4842992499761  dE = -0.0060347038  S^2 = 0.0000000
               |grad[o]|=0.0424  |ddm|=0.0579  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4876547162107  dE = -0.0033554662  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.0727  |maxRot[o]|=0.0598
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4884265086891  dE = -0.00077179248  S^2 = 0.0000000
               |grad[o]|=0.0102  |ddm|=0.0385  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4887230889617  dE = -0.00029658027  S^2 = 0.0000000
               |grad[o]|=0.00537  |ddm|=0.0131  |maxRot[o]|=0.0351
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4887546373467  dE = -3.1548385e-05  S^2 = 0.0000000
               |grad[o]|=0.00189  |ddm|=0.0083  |maxRot[o]|=0.0124
macro iter 9 (3 JK  0 micro), CASSCF E = -75.488757631922  dE = -2.9945753e-06  S^2 = 0.0000000
               |grad[o]|=0.000634  |ddm|=0.00254  |maxRot[o]|=0.00388
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4887579066453  dE = -2.7472329e-07  S^2 = 0.0000000
               |grad[o]|=0.000199  |ddm|=0.000782  |maxRot[o]|=0.00118
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4887579316397  dE = -2.4994392e-08  S^2 = 0.0000000
               |grad[o]|=6.16e-05  |ddm|=0.000238  |maxRot[o]|=0.000357
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4887579338976  dE = -2.2579201e-09  S^2 = 0.0000000
               |grad[o]|=1.87e-05  |ddm|=7.12e-05  |maxRot[o]|=0.000108
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4887579341009  dE = -2.0332891e-10  S^2 = 0.0000000
               |grad[o]|=5.64e-06  |ddm|=2.16e-05  |maxRot[o]|=3.22e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4887579341156  dE = -1.4708235e-11  S^2 = 0.0000000
               |grad[o]|=1.72e-06  |ddm|=6.52e-06  |maxRot[o]|=9.79e-06
2-step CASSCF converged in 14 macro (55 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95981388 1.93127285 1.8922826  1.77943942 0.07180263 0.22650183
 0.05783615 0.08105064]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01133   0.01013  -0.00414   0.00000   0.00000
  0 C 2s       0.65705   0.65938  -0.26022  -0.00000  -0.00000
  0 C 3s      -0.00998   0.01639  -0.04128   0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69378
  0 C 2py     -0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.25932  -0.25424   0.65514  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06179
  0 C 3py     -0.00000   0.00000   0.00000   0.05203   0.00000
  0 C 3pz     -0.01577  -0.00197   0.00765   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.03378   0.00000
  0 C 3dz^2    0.02382  -0.01278   0.03532  -0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000  -0.12186
 0 C 3dx2-y2  -0.00000   0.00665  -0.00734  -0.00000   0.00000
  1 C 1s       0.01133  -0.01013  -0.00414   0.00000   0.00000
  1 C 2s       0.65705  -0.65938  -0.26022  -0.00000  -0.00000
  1 C 3s      -0.00998  -0.01639  -0.04128   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69378
  1 C 2py     -0.00000   0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.25932  -0.25424  -0.65514  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06179
  1 C 3py      0.00000  -0.00000  -0.00000   0.05203  -0.00000
  1 C 3pz      0.01577  -0.00197  -0.00765  -0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03378   0.00000
  1 C 3dz^2    0.02382   0.01278   0.03532   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12186
 1 C 3dx2-y2  -0.00000  -0.00665  -0.00734  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000  -0.00000   0.25300
  0 C 3s      -0.00000   0.00000   0.03435
  0 C 2px     -0.00000   0.69779  -0.00000
  0 C 2py      0.70690   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.65775
  0 C 3px     -0.00000  -0.00738  -0.00000
  0 C 3py     -0.01256  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.04088
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01132  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00778
  0 C 3dxz    -0.00000  -0.11419   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02095
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s      -0.00000  -0.00000  -0.25300
  1 C 3s       0.00000   0.00000  -0.03435
  1 C 2px      0.00000  -0.69779  -0.00000
  1 C 2py     -0.70690   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.65775
  1 C 3px      0.00000   0.00738   0.00000
  1 C 3py      0.01256   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04088
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01132  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00778
  1 C 3dxz    -0.00000  -0.11419  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02095
<CAS-nat-orb|mo-hf>  3  3    0.99891158
<CAS-nat-orb|mo-hf>  4  4    0.99971276
<CAS-nat-orb|mo-hf>  5  5    0.99892917
<CAS-nat-orb|mo-hf>  6  6    0.99899872
<CAS-nat-orb|mo-hf>  7  7    0.93636098
<CAS-nat-orb|mo-hf>  8  8    0.97867429
<CAS-nat-orb|mo-hf>  9  9    0.95989986
<CAS-nat-orb|mo-hf>  10  10    0.91658565
CASSCF energy = -75.4887579341156
CASCI E = -75.4887579341156  E(CI) = -15.3435702378968  S^2 = 0.0000000
Density matrix diagonal elements [1.95981402 1.93127356 1.89228386 1.77943919 0.0718009  0.22650193
 0.05783594 0.08105061]
i = 1  <i|F|i> = -11.34405675
i = 2  <i|F|i> = -11.34434492
i = 3  <i|F|i> =  -0.84523435
i = 4  <i|F|i> =  -0.62257020
i = 5  <i|F|i> =  -0.36406053
i = 6  <i|F|i> =  -0.29814452
i = 7  <i|F|i> =   0.09397672
i = 8  <i|F|i> =   0.05321735
i = 9  <i|F|i> =   0.18837783
i = 10  <i|F|i> =   0.31179551
i = 11  <i|F|i> =   0.59394373
i = 12  <i|F|i> =   0.69110208
i = 13  <i|F|i> =   0.64288277
i = 14  <i|F|i> =   0.71308029
i = 15  <i|F|i> =   0.71823615
i = 16  <i|F|i> =   0.71968949
i = 17  <i|F|i> =   0.75978473
i = 18  <i|F|i> =   1.02084084
i = 19  <i|F|i> =   1.15936767
i = 20  <i|F|i> =   1.21258730
i = 21  <i|F|i> =   1.33337991
i = 22  <i|F|i> =   1.33360713
i = 23  <i|F|i> =   1.45695167
i = 24  <i|F|i> =   1.45587217
i = 25  <i|F|i> =   1.51074630
i = 26  <i|F|i> =   1.70339982
i = 27  <i|F|i> =   1.76593632
i = 28  <i|F|i> =   2.13873209
......production of RDMs took      17.89 sec
......reading the RDM took          0.44 sec
......production of RDMs took      25.48 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.85 sec

E(WickICNEVPT2-ijrs) =    -0.00028701891628
E(WickICNEVPT2- rsi) =    -0.00080327883328
E(WickICNEVPT2- ijr) =    -0.00027126679563
E(WickICNEVPT2-  rs) =    -0.03400292069410
E(WickICNEVPT2-  ij) =    -0.00006912132260
E(WickICNEVPT2-  ir) =    -0.00102391572570
E(WickICNEVPT2-   r) =    -0.05895618686818
E(WickICNEVPT2-   i) =    -0.00006915344026
E(WickICNEVPT2) = -75.58424079671165  E_corr_pt = -0.09548286259602862
Timings = pdms =   53.64 | eris =    0.01 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.23 | ij =    0.07 | ir =    0.15 | r =    1.78 | i =    0.71 | total =   56.64
Time cost =    117.722
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:39:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.878579098766 AA    0.000000000000   0.000000000000   3.550000000000 Bohr   0.0

nuclear repulsion = 10.1408450704225
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.775]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5470.03


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmprtk7ljxb
max_memory 4000 MB (current use 320 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.755922874727

WARN: Singularity detected in overlap matrix (condition number = 98.8). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.113183134036076  LUMO (B3u) = -0.113183134036076

WARN: B2u HOMO -0.113183134036076 > system LUMO -0.113183134036076

cycle= 1 E= -75.287473469352  delta_E= -0.532  |g|= 0.242  |ddm|= 1.48
HOMO (B2u) = -0.370939595595209  LUMO (B3u) = -0.0596135835397209
cycle= 2 E= -75.3109303175842  delta_E= -0.0235  |g|= 0.0489  |ddm|= 0.349
HOMO (B2u) = -0.335857476925406  LUMO (B3u) = -0.0198166980956913
cycle= 3 E= -75.3123050204643  delta_E= -0.00137  |g|= 0.0178  |ddm|= 0.0646
HOMO (B2u) = -0.340305747412608  LUMO (B3u) = -0.0241187549333953
cycle= 4 E= -75.3125256665475  delta_E= -0.000221  |g|= 0.000662  |ddm|= 0.0362
HOMO (B2u) = -0.340473004463873  LUMO (B3u) = -0.0244347316795391
cycle= 5 E= -75.3125258326696  delta_E= -1.66e-07  |g|= 0.000114  |ddm|= 0.000883
HOMO (B2u) = -0.340435552234749  LUMO (B3u) = -0.0244019229355908
cycle= 6 E= -75.3125258401168  delta_E= -7.45e-09  |g|= 1.75e-05  |ddm|= 0.000196
HOMO (B2u) = -0.340433109443014  LUMO (B3u) = -0.0244024220699455
cycle= 7 E= -75.3125258403104  delta_E= -1.94e-10  |g|= 1.93e-06  |ddm|= 3.69e-05
HOMO (B2u) = -0.340432553987155  LUMO (B3u) = -0.0244022873481488
cycle= 8 E= -75.3125258403129  delta_E= -2.44e-12  |g|= 1.26e-07  |ddm|= 4e-06
HOMO (B2u) = -0.340432558917248  LUMO (B3u) = -0.0244022873230522
cycle= 9 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 8.37e-09  |ddm|= 2.82e-07
HOMO (B2u) = -0.340432558751934  LUMO (B3u) = -0.0244022890087012
cycle= 10 E= -75.3125258403129  delta_E=    0  |g|= 6.61e-09  |ddm|= 7.96e-09
HOMO (B2u) = -0.34043255858251  LUMO (B3u) = -0.0244022888654972
cycle= 11 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 4.82e-09  |ddm|= 5.22e-09
HOMO (B2u) = -0.340432557195532  LUMO (B3u) = -0.0244022874168929
cycle= 12 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 4.25e-09  |ddm|= 2.37e-09
HOMO (B2u) = -0.340432557527067  LUMO (B3u) = -0.024402287752728
cycle= 13 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 3.83e-09  |ddm|= 1.6e-09
HOMO (B2u) = -0.340432557415035  LUMO (B3u) = -0.0244022876441513
cycle= 14 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 3.17e-09  |ddm|= 1.55e-09
HOMO (B2u) = -0.340432557231931  LUMO (B3u) = -0.0244022875215442
cycle= 15 E= -75.3125258403129  delta_E=    0  |g|= 9.91e-10  |ddm|= 5.61e-09
HOMO (B2u) = -0.340432557138565  LUMO (B3u) = -0.0244022875065844
cycle= 16 E= -75.3125258403128  delta_E= 2.84e-14  |g|= 9.67e-10  |ddm|= 1.31e-09
HOMO (B2u) = -0.3404325571636  LUMO (B3u) = -0.0244022874951457
cycle= 17 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 1.02e-09  |ddm|= 7.11e-10
HOMO (B2u) = -0.340432557129869  LUMO (B3u) = -0.0244022874689619
cycle= 18 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 7.87e-10  |ddm|= 5.81e-10
HOMO (B2u) = -0.340432557127681  LUMO (B3u) = -0.0244022874756338
cycle= 19 E= -75.3125258403129  delta_E=    0  |g|= 6.49e-10  |ddm|= 4.67e-10
HOMO (B2u) = -0.340432557128761  LUMO (B3u) = -0.0244022874838862
cycle= 20 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 5.38e-10  |ddm|= 3.24e-10
HOMO (B2u) = -0.340432557115206  LUMO (B3u) = -0.0244022874745594
cycle= 21 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 4.21e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.340432557105618  LUMO (B3u) = -0.0244022874701112
cycle= 22 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 3.07e-10  |ddm|= 2.69e-10
HOMO (B2u) = -0.340432557096354  LUMO (B3u) = -0.0244022874658613
cycle= 23 E= -75.3125258403129  delta_E= -1.14e-13  |g|= 2.17e-10  |ddm|= 2.24e-10
HOMO (B2u) = -0.340432557089647  LUMO (B3u) = -0.0244022874625653
cycle= 24 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 1.88e-10  |ddm|= 7.9e-11
HOMO (B2u) = -0.340432557086861  LUMO (B3u) = -0.0244022874599237
cycle= 25 E= -75.3125258403128  delta_E= 2.84e-14  |g|= 1.58e-10  |ddm|= 7.29e-11
HOMO (B2u) = -0.340432557082863  LUMO (B3u) = -0.0244022874574693
cycle= 26 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 1.28e-10  |ddm|= 7.99e-11
HOMO (B2u) = -0.340432557079601  LUMO (B3u) = -0.0244022874554733
cycle= 27 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 1.06e-10  |ddm|= 6.12e-11
HOMO (B2u) = -0.340432557076913  LUMO (B3u) = -0.0244022874537954
cycle= 28 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 8.56e-11  |ddm|= 5.11e-11
HOMO (B2u) = -0.34043255707481  LUMO (B3u) = -0.0244022874525108
cycle= 29 E= -75.3125258403129  delta_E=    0  |g|= 6.79e-11  |ddm|= 4.3e-11
HOMO (B2u) = -0.34043255706932  LUMO (B3u) = -0.0244022874491365
Extra cycle  E= -75.3125258403129  delta_E=    0  |g|= 2.45e-11  |ddm|= 1.06e-10
converged SCF energy = -75.3125258403129

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmprtk7ljxb
max_memory 4000 MB (current use 320 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4401587585067  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4545821847275  dE = -0.014423426  S^2 = 0.0000000
               |grad[o]|=0.0942  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4662692480554  dE = -0.011687063  S^2 = 0.0000000
               |grad[o]|=0.0778  |ddm|=0.0861  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4747099542622  dE = -0.0084407062  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.0439  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4804719532747  dE = -0.005761999  S^2 = 0.0000000
               |grad[o]|= 0.04  |ddm|=0.0658  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4831435204791  dE = -0.0026715672  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.0737  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4838239796137  dE = -0.00068045913  S^2 = 0.0000000
               |grad[o]|=0.00925  |ddm|=0.0308  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.484037116035  dE = -0.00021313642  S^2 = 0.0000000
               |grad[o]|=0.00453  |ddm|=0.0109  |maxRot[o]|=0.0304
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4840577811657  dE = -2.0665131e-05  S^2 = 0.0000000
               |grad[o]|=0.00158  |ddm|=0.00643  |maxRot[o]|=0.0101
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4840596355541  dE = -1.8543884e-06  S^2 = 0.0000000
               |grad[o]|=0.000517  |ddm|=0.00195  |maxRot[o]|=0.00307
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4840597983765  dE = -1.6282236e-07  S^2 = 0.0000000
               |grad[o]|=0.000159  |ddm|=0.000592  |maxRot[o]|=0.000913
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4840598125418  dE = -1.4165295e-08  S^2 = 0.0000000
               |grad[o]|=4.79e-05  |ddm|=0.000176  |maxRot[o]|=0.00027
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4840598137744  dE = -1.2326495e-09  S^2 = 0.0000000
               |grad[o]|=1.43e-05  |ddm|=5.21e-05  |maxRot[o]|=7.95e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4840598138813  dE = -1.0693668e-10  S^2 = 0.0000000
               |grad[o]|=4.23e-06  |ddm|=1.54e-05  |maxRot[o]|=2.35e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4840598138905  dE = -9.1091579e-12  S^2 = 0.0000000
               |grad[o]|=1.25e-06  |ddm|=4.55e-06  |maxRot[o]|=6.92e-06
2-step CASSCF converged in 14 macro (55 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95901066 1.93191387 1.88869909 1.76663822 0.07041579 0.23918108
 0.05753793 0.08660336]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01153   0.01022  -0.00378   0.00000   0.00000
  0 C 2s       0.66488   0.66240  -0.23954  -0.00000  -0.00000
  0 C 3s      -0.00763   0.01613  -0.03939  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69368
  0 C 2py      0.00000  -0.00000  -0.00000   0.70438  -0.00000
  0 C 2pz      0.23883  -0.24630   0.66308  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06285
  0 C 3py     -0.00000  -0.00000  -0.00000   0.05282  -0.00000
  0 C 3pz     -0.01454  -0.00188   0.00916  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.00000  -0.00000   0.03256  -0.00000
  0 C 3dz^2    0.02207  -0.01238   0.03528  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.12191
 0 C 3dx2-y2   0.00028   0.00654  -0.00728   0.00000  -0.00000
  1 C 1s       0.01153  -0.01022  -0.00378   0.00000   0.00000
  1 C 2s       0.66488  -0.66240  -0.23954   0.00000   0.00000
  1 C 3s      -0.00763  -0.01613  -0.03939   0.00000   0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69368
  1 C 2py      0.00000  -0.00000   0.00000   0.70438   0.00000
  1 C 2pz     -0.23883  -0.24630  -0.66308   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06285
  1 C 3py     -0.00000   0.00000   0.00000   0.05282   0.00000
  1 C 3pz      0.01454  -0.00188  -0.00916  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03256  -0.00000
  1 C 3dz^2    0.02207   0.01238   0.03528   0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12191
 1 C 3dx2-y2   0.00028  -0.00654  -0.00728   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00035
  0 C 2s      -0.00000  -0.00000   0.24517
  0 C 3s      -0.00000  -0.00000   0.03335
  0 C 2px     -0.00000   0.69791  -0.00000
  0 C 2py      0.70694   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.66096
  0 C 3px      0.00000  -0.00931  -0.00000
  0 C 3py     -0.01055  -0.00000   0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03822
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.01090  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00694
  0 C 3dxz     0.00000  -0.11326  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01984
  1 C 1s       0.00000   0.00000   0.00035
  1 C 2s       0.00000   0.00000  -0.24517
  1 C 3s       0.00000   0.00000  -0.03335
  1 C 2px     -0.00000  -0.69791  -0.00000
  1 C 2py     -0.70694   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.66096
  1 C 3px      0.00000   0.00931   0.00000
  1 C 3py      0.01055  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03822
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01090   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00694
  1 C 3dxz    -0.00000  -0.11326  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01984
<CAS-nat-orb|mo-hf>  3  3    0.99958549
<CAS-nat-orb|mo-hf>  4  4    0.99970353
<CAS-nat-orb|mo-hf>  5  5    0.99960080
<CAS-nat-orb|mo-hf>  6  6    0.99894173
<CAS-nat-orb|mo-hf>  7  7    0.93559187
<CAS-nat-orb|mo-hf>  8  8    0.97993346
<CAS-nat-orb|mo-hf>  9  9    0.96008674
<CAS-nat-orb|mo-hf>  10  10    0.92430540
CASSCF energy = -75.4840598138905
CASCI E = -75.4840598138905  E(CI) = -15.274597890724  S^2 = 0.0000000
Density matrix diagonal elements [1.95901083 1.93191411 1.88870033 1.76663797 0.07041432 0.23918133
 0.05753775 0.08660336]
i = 1  <i|F|i> = -11.34459083
i = 2  <i|F|i> = -11.34490056
i = 3  <i|F|i> =  -0.83916933
i = 4  <i|F|i> =  -0.62546185
i = 5  <i|F|i> =  -0.35958216
i = 6  <i|F|i> =  -0.29281660
i = 7  <i|F|i> =   0.09702292
i = 8  <i|F|i> =   0.04647434
i = 9  <i|F|i> =   0.18586676
i = 10  <i|F|i> =   0.29494710
i = 11  <i|F|i> =   0.59815531
i = 12  <i|F|i> =   0.69066828
i = 13  <i|F|i> =   0.64064937
i = 14  <i|F|i> =   0.71463686
i = 15  <i|F|i> =   0.71946735
i = 16  <i|F|i> =   0.71939993
i = 17  <i|F|i> =   0.76620299
i = 18  <i|F|i> =   1.01711312
i = 19  <i|F|i> =   1.16446642
i = 20  <i|F|i> =   1.21579320
i = 21  <i|F|i> =   1.33783109
i = 22  <i|F|i> =   1.33807735
i = 23  <i|F|i> =   1.45319723
i = 24  <i|F|i> =   1.45222052
i = 25  <i|F|i> =   1.48685387
i = 26  <i|F|i> =   1.68918311
i = 27  <i|F|i> =   1.75079880
i = 28  <i|F|i> =   2.13629650
......production of RDMs took       1.92 sec
......reading the RDM took          0.42 sec
......production of RDMs took      68.16 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.90 sec

E(WickICNEVPT2-ijrs) =    -0.00028835922520
E(WickICNEVPT2- rsi) =    -0.00080495084969
E(WickICNEVPT2- ijr) =    -0.00026922638350
E(WickICNEVPT2-  rs) =    -0.03382366990711
E(WickICNEVPT2-  ij) =    -0.00006686567512
E(WickICNEVPT2-  ir) =    -0.00101743194836
E(WickICNEVPT2-   r) =    -0.05931632193407
E(WickICNEVPT2-   i) =    -0.00006592191038
E(WickICNEVPT2) = -75.57971256172388  E_corr_pt = -0.09565274783342551
Timings = pdms =   80.43 | eris =    0.63 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.63 | ij =    0.14 | ir =    0.29 | r =    3.13 | i =    1.31 | total =   86.62
Time cost =    193.109
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:42:36 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.905037959312 AA    0.000000000000   0.000000000000   3.600000000000 Bohr   0.0

nuclear repulsion = 10
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.8]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5822.72


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmprnzm6t40
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7418315703506

WARN: Singularity detected in overlap matrix (condition number = 92.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.110019881100111  LUMO (B3u) = -0.110019881100111

WARN: B2u HOMO -0.110019881100111 > system LUMO -0.110019881100111

cycle= 1 E= -75.2796395081188  delta_E= -0.538  |g|= 0.24  |ddm|= 1.48
HOMO (B2u) = -0.366960154497  LUMO (B3u) = -0.0572442637655633
cycle= 2 E= -75.3027407260662  delta_E= -0.0231  |g|= 0.0483  |ddm|= 0.349
HOMO (B2u) = -0.332387624443797  LUMO (B3u) = -0.0179860460523914
cycle= 3 E= -75.3040943705399  delta_E= -0.00135  |g|= 0.0177  |ddm|= 0.0637
HOMO (B2u) = -0.336815650622685  LUMO (B3u) = -0.0222589901147901
cycle= 4 E= -75.3043133588736  delta_E= -0.000219  |g|= 0.000659  |ddm|= 0.0358
HOMO (B2u) = -0.33698652190454  LUMO (B3u) = -0.0225780980112814
cycle= 5 E= -75.3043135231659  delta_E= -1.64e-07  |g|= 0.000118  |ddm|= 0.000867
HOMO (B2u) = -0.336949107818826  LUMO (B3u) = -0.0225461573189898
cycle= 6 E= -75.3043135311109  delta_E= -7.95e-09  |g|= 1.79e-05  |ddm|= 0.000202
HOMO (B2u) = -0.336946583100424  LUMO (B3u) = -0.0225465689188835
cycle= 7 E= -75.3043135313142  delta_E= -2.03e-10  |g|= 1.93e-06  |ddm|= 3.75e-05
HOMO (B2u) = -0.336946052255891  LUMO (B3u) = -0.0225464651749648
cycle= 8 E= -75.3043135313167  delta_E= -2.46e-12  |g|= 1.28e-07  |ddm|= 3.99e-06
HOMO (B2u) = -0.336946056653685  LUMO (B3u) = -0.0225464645227833
cycle= 9 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 8.64e-09  |ddm|= 2.92e-07
HOMO (B2u) = -0.336946056356197  LUMO (B3u) = -0.022546466140869
cycle= 10 E= -75.3043135313167  delta_E=    0  |g|= 6.89e-09  |ddm|= 7.94e-09
HOMO (B2u) = -0.336946056208932  LUMO (B3u) = -0.0225464660336316
cycle= 11 E= -75.3043135313166  delta_E= 5.68e-14  |g|= 4.99e-09  |ddm|= 5.47e-09
HOMO (B2u) = -0.33694605482981  LUMO (B3u) = -0.0225464645957648
cycle= 12 E= -75.3043135313166  delta_E= 1.42e-14  |g|= 4.37e-09  |ddm|= 2.52e-09
HOMO (B2u) = -0.336946055133765  LUMO (B3u) = -0.0225464649075569
cycle= 13 E= -75.3043135313166  delta_E= -1.42e-14  |g|= 3.93e-09  |ddm|= 1.66e-09
HOMO (B2u) = -0.336946055006215  LUMO (B3u) = -0.0225464647807816
cycle= 14 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 3.23e-09  |ddm|= 1.79e-09
HOMO (B2u) = -0.336946054816697  LUMO (B3u) = -0.0225464646818633
cycle= 15 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 1.03e-09  |ddm|= 5.76e-09
HOMO (B2u) = -0.33694605471538  LUMO (B3u) = -0.0225464646716776
cycle= 16 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 9.61e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.336946054755268  LUMO (B3u) = -0.0225464646547177
cycle= 17 E= -75.3043135313167  delta_E=    0  |g|= 1.07e-09  |ddm|= 1.17e-09
HOMO (B2u) = -0.336946054719343  LUMO (B3u) = -0.0225464646290009
cycle= 18 E= -75.3043135313166  delta_E= 5.68e-14  |g|= 8.24e-10  |ddm|= 6.21e-10
HOMO (B2u) = -0.336946054715322  LUMO (B3u) = -0.0225464646352574
cycle= 19 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 6.72e-10  |ddm|= 5.08e-10
HOMO (B2u) = -0.336946054715024  LUMO (B3u) = -0.0225464646432986
cycle= 20 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 5.53e-10  |ddm|= 3.53e-10
HOMO (B2u) = -0.336946054700156  LUMO (B3u) = -0.0225464646338313
cycle= 21 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 4.31e-10  |ddm|= 3.1e-10
HOMO (B2u) = -0.33694605468912  LUMO (B3u) = -0.0225464646289396
cycle= 22 E= -75.3043135313167  delta_E=    0  |g|= 3.14e-10  |ddm|= 2.86e-10
HOMO (B2u) = -0.336946054678446  LUMO (B3u) = -0.0225464646243893
cycle= 23 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 2.24e-10  |ddm|= 2.37e-10
HOMO (B2u) = -0.336946054671705  LUMO (B3u) = -0.0225464646210603
cycle= 24 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 1.93e-10  |ddm|= 8.15e-11
HOMO (B2u) = -0.336946054669203  LUMO (B3u) = -0.0225464646182699
cycle= 25 E= -75.3043135313167  delta_E=    0  |g|= 1.63e-10  |ddm|= 7.31e-11
HOMO (B2u) = -0.336946054664796  LUMO (B3u) = -0.022546464615721
cycle= 26 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 1.31e-10  |ddm|= 8.58e-11
HOMO (B2u) = -0.336946054661255  LUMO (B3u) = -0.0225464646136732
cycle= 27 E= -75.3043135313167  delta_E= -8.53e-14  |g|= 1.08e-10  |ddm|= 6.59e-11
HOMO (B2u) = -0.336946054658344  LUMO (B3u) = -0.0225464646119537
cycle= 28 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 8.7e-11  |ddm|= 5.39e-11
HOMO (B2u) = -0.33694605465606  LUMO (B3u) = -0.0225464646106316
cycle= 29 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 6.89e-11  |ddm|= 4.49e-11
HOMO (B2u) = -0.336946054654163  LUMO (B3u) = -0.0225464646095258
cycle= 30 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 5.44e-11  |ddm|= 3.54e-11
HOMO (B2u) = -0.336946054652741  LUMO (B3u) = -0.0225464646087075
cycle= 31 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 4.4e-11  |ddm|= 2.58e-11
HOMO (B2u) = -0.336946054651739  LUMO (B3u) = -0.022546464608105
cycle= 32 E= -75.3043135313167  delta_E=    0  |g|= 3.65e-11  |ddm|= 1.83e-11
HOMO (B2u) = -0.336946054648755  LUMO (B3u) = -0.0225464646062776
Extra cycle  E= -75.3043135313167  delta_E=    0  |g|= 1.33e-11  |ddm|= 5.66e-11
converged SCF energy = -75.3043135313167

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmprnzm6t40
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4361879187434  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4510691607456  dE = -0.014881242  S^2 = 0.0000000
               |grad[o]|=0.0962  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4629145321989  dE = -0.011845371  S^2 = 0.0000000
               |grad[o]|=0.0783  |ddm|=0.0912  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4711866391315  dE = -0.0082721069  S^2 = 0.0000000
               |grad[o]|=0.0578  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4766787942675  dE = -0.0054921551  S^2 = 0.0000000
               |grad[o]|=0.0375  |ddm|=0.075  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4787632077906  dE = -0.0020844135  S^2 = 0.0000000
               |grad[o]|=0.0178  |ddm|=0.0723  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4793231918282  dE = -0.00055998404  S^2 = 0.0000000
               |grad[o]|=0.00799  |ddm|=0.0239  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4794386335798  dE = -0.00011544175  S^2 = 0.0000000
               |grad[o]|=0.00353  |ddm|=0.00914  |maxRot[o]|= 0.02
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4794609801221  dE = -2.2346542e-05  S^2 = 0.0000000
               |grad[o]|=0.00158  |ddm|=0.00384  |maxRot[o]|=0.0105
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4794629087142  dE = -1.9285921e-06  S^2 = 0.0000000
               |grad[o]|=0.000536  |ddm|=0.00194  |maxRot[o]|=0.00314
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4794630725591  dE = -1.638449e-07  S^2 = 0.0000000
               |grad[o]|=0.000164  |ddm|=0.000582  |maxRot[o]|=0.000918
macro iter 11 (3 JK  0 micro), CASSCF E = -75.479463086382  dE = -1.3822913e-08  S^2 = 0.0000000
               |grad[o]|=4.88e-05  |ddm|=0.000171  |maxRot[o]|=0.000267
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4794630875463  dE = -1.1642669e-09  S^2 = 0.0000000
               |grad[o]|=1.44e-05  |ddm|=5.01e-05  |maxRot[o]|=7.74e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4794630876437  dE = -9.7372777e-11  S^2 = 0.0000000
               |grad[o]|=4.2e-06  |ddm|=1.46e-05  |maxRot[o]|=2.25e-05
2-step CASSCF converged in 13 macro (52 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95829684 1.93254559 1.88457143 1.75318656 0.06913527 0.2524963
 0.05723697 0.09253104]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01171   0.01031  -0.00343   0.00000   0.00000
  0 C 2s       0.67180   0.66526  -0.21945   0.00000  -0.00000
  0 C 3s      -0.00547   0.01587  -0.03746   0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69361
  0 C 2py      0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.21892  -0.23851   0.67009   0.00000  -0.00000
  0 C 3px      0.00000   0.00000   0.00000   0.00000  -0.06384
  0 C 3py      0.00000   0.00000   0.00000   0.05350  -0.00000
  0 C 3pz     -0.01342  -0.00181   0.01074   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000   0.03134   0.00000
  0 C 3dz^2    0.02038  -0.01199   0.03514   0.00000   0.00000
  0 C 3dxz     0.00000   0.00000   0.00000  -0.00000  -0.12178
 0 C 3dx2-y2   0.00055   0.00643  -0.00721  -0.00000  -0.00000
  1 C 1s       0.01171  -0.01031  -0.00343   0.00000   0.00000
  1 C 2s       0.67180  -0.66526  -0.21945  -0.00000  -0.00000
  1 C 3s      -0.00547  -0.01587  -0.03746  -0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69361
  1 C 2py     -0.00000  -0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.21892  -0.23851  -0.67009   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06384
  1 C 3py     -0.00000  -0.00000  -0.00000   0.05350  -0.00000
  1 C 3pz      0.01342  -0.00181  -0.01074   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.03134   0.00000
  1 C 3dz^2    0.02038   0.01199   0.03514  -0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12178
 1 C 3dx2-y2   0.00055  -0.00643  -0.00721   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00032
  0 C 2s       0.00000  -0.00000   0.23748
  0 C 3s      -0.00000  -0.00000   0.03235
  0 C 2px      0.00000   0.69804  -0.00000
  0 C 2py      0.70698  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.66400
  0 C 3px     -0.00000  -0.01120  -0.00000
  0 C 3py     -0.00856  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03555
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01047  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00616
  0 C 3dxz    -0.00000  -0.11230  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01875
  1 C 1s       0.00000   0.00000   0.00032
  1 C 2s       0.00000  -0.00000  -0.23748
  1 C 3s       0.00000   0.00000  -0.03235
  1 C 2px      0.00000  -0.69804   0.00000
  1 C 2py     -0.70698   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66400
  1 C 3px     -0.00000   0.01120   0.00000
  1 C 3py      0.00856   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03555
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01047  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00616
  1 C 3dxz     0.00000  -0.11230  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01875
<CAS-nat-orb|mo-hf>  3  3    0.99985292
<CAS-nat-orb|mo-hf>  4  4    0.99969360
<CAS-nat-orb|mo-hf>  5  5    0.99986456
<CAS-nat-orb|mo-hf>  6  6    0.99888267
<CAS-nat-orb|mo-hf>  7  7    0.93493366
<CAS-nat-orb|mo-hf>  8  8    0.98111604
<CAS-nat-orb|mo-hf>  9  9    0.96025422
<CAS-nat-orb|mo-hf>  10  10    0.93117477
CASSCF energy = -75.4794630876437
CASCI E = -75.4794630876437  E(CI) = -15.207507530585  S^2 = 0.0000000
Density matrix diagonal elements [1.95829738 1.93254685 1.88457248 1.75318649 0.0691328  0.25249623
 0.05723685 0.09253092]
i = 1  <i|F|i> = -11.34500220
i = 2  <i|F|i> = -11.34533014
i = 3  <i|F|i> =  -0.83295723
i = 4  <i|F|i> =  -0.62825523
i = 5  <i|F|i> =  -0.35542819
i = 6  <i|F|i> =  -0.28753668
i = 7  <i|F|i> =   0.09983449
i = 8  <i|F|i> =   0.03990745
i = 9  <i|F|i> =   0.18347799
i = 10  <i|F|i> =   0.27889198
i = 11  <i|F|i> =   0.60231860
i = 12  <i|F|i> =   0.69006255
i = 13  <i|F|i> =   0.63843920
i = 14  <i|F|i> =   0.71588185
i = 15  <i|F|i> =   0.72067660
i = 16  <i|F|i> =   0.71914203
i = 17  <i|F|i> =   0.77281467
i = 18  <i|F|i> =   1.01356683
i = 19  <i|F|i> =   1.17015964
i = 20  <i|F|i> =   1.21963610
i = 21  <i|F|i> =   1.34210489
i = 22  <i|F|i> =   1.34237766
i = 23  <i|F|i> =   1.44966394
i = 24  <i|F|i> =   1.44878273
i = 25  <i|F|i> =   1.46390138
i = 26  <i|F|i> =   1.67527558
i = 27  <i|F|i> =   1.73592612
i = 28  <i|F|i> =   2.13270809
......production of RDMs took       4.50 sec
......reading the RDM took          0.41 sec
......production of RDMs took      24.70 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.61 sec

E(WickICNEVPT2-ijrs) =    -0.00028983132507
E(WickICNEVPT2- rsi) =    -0.00080708290077
E(WickICNEVPT2- ijr) =    -0.00026733023417
E(WickICNEVPT2-  rs) =    -0.03365218762216
E(WickICNEVPT2-  ij) =    -0.00006475386527
E(WickICNEVPT2-  ir) =    -0.00101150385351
E(WickICNEVPT2-   r) =    -0.05965877952774
E(WickICNEVPT2-   i) =    -0.00006286212508
E(WickICNEVPT2) = -75.57527741909746  E_corr_pt = -0.09581433145378956
Timings = pdms =   39.26 | eris =    0.03 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.26 | ij =    0.07 | ir =    0.15 | r =    1.82 | i =    0.74 | total =   42.39
Time cost =    215.754
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:46:12 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.931496819858 AA    0.000000000000   0.000000000000   3.650000000000 Bohr   0.0

nuclear repulsion = 9.86301369863014
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.825]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6114.50


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpppl44cd9
max_memory 4000 MB (current use 322 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7286668554631

WARN: Singularity detected in overlap matrix (condition number = 86.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.107001630831573  LUMO (B3u) = -0.107001630831573

WARN: B2u HOMO -0.107001630831573 > system LUMO -0.107001630831573

cycle= 1 E= -75.2718520447977  delta_E= -0.543  |g|= 0.238  |ddm|= 1.48
HOMO (B2u) = -0.363117515186496  LUMO (B3u) = -0.0549592840356619
cycle= 2 E= -75.2946135925964  delta_E= -0.0228  |g|= 0.0477  |ddm|= 0.349
HOMO (B2u) = -0.329037998444987  LUMO (B3u) = -0.0162218724304524
cycle= 3 E= -75.2959451182036  delta_E= -0.00133  |g|= 0.0175  |ddm|= 0.0628
HOMO (B2u) = -0.333444355785576  LUMO (B3u) = -0.0204649331299223
cycle= 4 E= -75.2961620440471  delta_E= -0.000217  |g|= 0.000656  |ddm|= 0.0354
HOMO (B2u) = -0.333615190019281  LUMO (B3u) = -0.0207831790531193
cycle= 5 E= -75.2961622069416  delta_E= -1.63e-07  |g|= 0.000121  |ddm|= 0.000855
HOMO (B2u) = -0.333577969876327  LUMO (B3u) = -0.0207522115134113
cycle= 6 E= -75.2961622153583  delta_E= -8.42e-09  |g|= 1.83e-05  |ddm|= 0.000208
HOMO (B2u) = -0.333575376692483  LUMO (B3u) = -0.0207525487418169
cycle= 7 E= -75.2961622155709  delta_E= -2.13e-10  |g|= 1.93e-06  |ddm|= 3.81e-05
HOMO (B2u) = -0.333574868730913  LUMO (B3u) = -0.020752473751912
cycle= 8 E= -75.2961622155733  delta_E= -2.36e-12  |g|= 1.29e-07  |ddm|= 4e-06
HOMO (B2u) = -0.33357487298702  LUMO (B3u) = -0.0207524728269084
cycle= 9 E= -75.2961622155733  delta_E= -7.11e-14  |g|= 8.8e-09  |ddm|= 3e-07
HOMO (B2u) = -0.333574872575065  LUMO (B3u) = -0.0207524743969787
cycle= 10 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 7.09e-09  |ddm|= 7.86e-09
HOMO (B2u) = -0.333574872450897  LUMO (B3u) = -0.0207524743254356
cycle= 11 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 5.12e-09  |ddm|= 5.66e-09
HOMO (B2u) = -0.333574871096985  LUMO (B3u) = -0.0207524729162467
cycle= 12 E= -75.2961622155733  delta_E=    0  |g|= 4.45e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.3335748713718  LUMO (B3u) = -0.0207524732022427
cycle= 13 E= -75.2961622155733  delta_E= -1.42e-14  |g|= 3.99e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.333574871232158  LUMO (B3u) = -0.020752473060936
cycle= 14 E= -75.2961622155733  delta_E= -1.42e-14  |g|= 3.27e-09  |ddm|= 2e-09
HOMO (B2u) = -0.333574871044279  LUMO (B3u) = -0.0207524729848404
cycle= 15 E= -75.2961622155733  delta_E=    0  |g|= 1.05e-09  |ddm|= 6.09e-09
HOMO (B2u) = -0.333574870942188  LUMO (B3u) = -0.0207524729743933
cycle= 16 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 9.68e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.333574870983401  LUMO (B3u) = -0.0207524729551997
cycle= 17 E= -75.2961622155733  delta_E=    0  |g|= 1.1e-09  |ddm|= 1.28e-09
HOMO (B2u) = -0.333574870946245  LUMO (B3u) = -0.020752472930492
cycle= 18 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 8.48e-10  |ddm|= 6.48e-10
HOMO (B2u) = -0.333574870941025  LUMO (B3u) = -0.020752472936722
cycle= 19 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 6.85e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.333574870939862  LUMO (B3u) = -0.0207524729448328
cycle= 20 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 5.61e-10  |ddm|= 3.75e-10
HOMO (B2u) = -0.333574870924302  LUMO (B3u) = -0.0207524729356471
cycle= 21 E= -75.2961622155734  delta_E= -5.68e-14  |g|= 4.36e-10  |ddm|= 3.24e-10
HOMO (B2u) = -0.33357487091236  LUMO (B3u) = -0.0207524729306515
cycle= 22 E= -75.2961622155733  delta_E= 7.11e-14  |g|= 3.17e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.333574870900812  LUMO (B3u) = -0.0207524729261198
cycle= 23 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 2.27e-10  |ddm|= 2.46e-10
HOMO (B2u) = -0.333574870893875  LUMO (B3u) = -0.0207524729227586
cycle= 24 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 1.95e-10  |ddm|= 8.29e-11
HOMO (B2u) = -0.333574870891148  LUMO (B3u) = -0.0207524729198921
cycle= 25 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 1.65e-10  |ddm|= 7.38e-11
HOMO (B2u) = -0.333574870886452  LUMO (B3u) = -0.0207524729173362
cycle= 26 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 1.33e-10  |ddm|= 8.99e-11
HOMO (B2u) = -0.333574870882717  LUMO (B3u) = -0.0207524729153012
cycle= 27 E= -75.2961622155732  delta_E= 5.68e-14  |g|= 1.08e-10  |ddm|= 6.92e-11
HOMO (B2u) = -0.333574870879643  LUMO (B3u) = -0.0207524729135915
cycle= 28 E= -75.2961622155732  delta_E=    0  |g|= 8.71e-11  |ddm|= 5.58e-11
HOMO (B2u) = -0.333574870871827  LUMO (B3u) = -0.0207524729092805
Extra cycle  E= -75.2961622155733  delta_E= -5.68e-14  |g|= 3.04e-11  |ddm|= 1.43e-10
converged SCF energy = -75.2961622155733

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpppl44cd9
max_memory 4000 MB (current use 322 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4322916655025  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4476417851216  dE = -0.01535012  S^2 = 0.0000000
               |grad[o]|=0.0982  |ddm|= 3.79  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4596313154462  dE = -0.01198953  S^2 = 0.0000000
               |grad[o]|=0.0787  |ddm|=0.0963  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4677080360295  dE = -0.0080767206  S^2 = 0.0000000
               |grad[o]|=0.0566  |ddm|=0.0425  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4729323362365  dE = -0.0052243002  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.0846  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4745134386325  dE = -0.0015811024  S^2 = 0.0000000
               |grad[o]|=0.0141  |ddm|=0.069  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4749250270408  dE = -0.00041158841  S^2 = 0.0000000
               |grad[o]|=0.00645  |ddm|=0.0178  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4749755961068  dE = -5.0569066e-05  S^2 = 0.0000000
               |grad[o]|=0.00239  |ddm|=0.00767  |maxRot[o]|=0.0157
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4749799280372  dE = -4.3319304e-06  S^2 = 0.0000000
               |grad[o]|=0.00081  |ddm|=0.00276  |maxRot[o]|=0.00471
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4749802891725  dE = -3.6113538e-07  S^2 = 0.0000000
               |grad[o]|=0.000249  |ddm|=0.00084  |maxRot[o]|=0.00136
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4749803190999  dE = -2.9927349e-08  S^2 = 0.0000000
               |grad[o]|=7.39e-05  |ddm|=0.000248  |maxRot[o]|=0.000392
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4749803215772  dE = -2.477293e-09  S^2 = 0.0000000
               |grad[o]|=2.16e-05  |ddm|=7.21e-05  |maxRot[o]|=0.000112
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4749803217822  dE = -2.0497737e-10  S^2 = 0.0000000
               |grad[o]|=6.26e-06  |ddm|=2.09e-05  |maxRot[o]|=3.23e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4749803217991  dE = -1.6967761e-11  S^2 = 0.0000000
               |grad[o]|=1.81e-06  |ddm|=6.02e-06  |maxRot[o]|=9.28e-06
2-step CASSCF converged in 13 macro (51 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95767231 1.93317369 1.87988783 1.73905658 0.0679361  0.26647505
 0.056932   0.09886644]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01187   0.01040  -0.00309   0.00000   0.00000
  0 C 2s       0.67780   0.66796  -0.20019  -0.00000  -0.00000
  0 C 3s      -0.00350   0.01562  -0.03551  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69358
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439  -0.00000
  0 C 2pz      0.19981  -0.23087   0.67619  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06476
  0 C 3py      0.00000  -0.00000  -0.00000   0.05406  -0.00000
  0 C 3pz     -0.01243  -0.00176   0.01236  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03012  -0.00000
  0 C 3dz^2    0.01877  -0.01161   0.03492  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.12148
 0 C 3dx2-y2   0.00081   0.00633  -0.00713   0.00000   0.00000
  1 C 1s       0.01187  -0.01040  -0.00309   0.00000   0.00000
  1 C 2s       0.67780  -0.66796  -0.20019   0.00000   0.00000
  1 C 3s      -0.00350  -0.01562  -0.03551   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69358
  1 C 2py     -0.00000   0.00000   0.00000   0.70439   0.00000
  1 C 2pz     -0.19981  -0.23087  -0.67619  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06476
  1 C 3py     -0.00000   0.00000   0.00000   0.05406   0.00000
  1 C 3pz      0.01243  -0.00176  -0.01236  -0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03012  -0.00000
  1 C 3dz^2    0.01877   0.01161   0.03492   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12148
 1 C 3dx2-y2   0.00081  -0.00633  -0.00713  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.22994
  0 C 3s      -0.00000  -0.00000   0.03135
  0 C 2px     -0.00000   0.69817  -0.00000
  0 C 2py      0.70700  -0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.66687
  0 C 3px      0.00000  -0.01303  -0.00000
  0 C 3py     -0.00659   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03288
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01006   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00544
  0 C 3dxz     0.00000  -0.11131  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01768
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.22994
  1 C 3s       0.00000   0.00000  -0.03135
  1 C 2px     -0.00000  -0.69817   0.00000
  1 C 2py     -0.70700  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66687
  1 C 3px     -0.00000   0.01303   0.00000
  1 C 3py      0.00659   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03288
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01006   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00544
  1 C 3dxz     0.00000  -0.11131  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01768
<CAS-nat-orb|mo-hf>  3  3    0.99977693
<CAS-nat-orb|mo-hf>  4  4    0.99968291
<CAS-nat-orb|mo-hf>  5  5    0.99978338
<CAS-nat-orb|mo-hf>  6  6    0.99882147
<CAS-nat-orb|mo-hf>  7  7    0.93437311
<CAS-nat-orb|mo-hf>  8  8    0.98222688
<CAS-nat-orb|mo-hf>  9  9    0.96040421
<CAS-nat-orb|mo-hf>  10  10    0.93730552
CASSCF energy = -75.4749803217991
CASCI E = -75.4749803217991  E(CI) = -15.1422389244404  S^2 = 0.0000000
Density matrix diagonal elements [1.95767256 1.93317406 1.87988841 1.73905662 0.06793501 0.26647501
 0.05693194 0.09886639]
i = 1  <i|F|i> = -11.34529225
i = 2  <i|F|i> = -11.34563541
i = 3  <i|F|i> =  -0.82665679
i = 4  <i|F|i> =  -0.63095031
i = 5  <i|F|i> =  -0.35153489
i = 6  <i|F|i> =  -0.28229911
i = 7  <i|F|i> =   0.10244569
i = 8  <i|F|i> =   0.03350668
i = 9  <i|F|i> =   0.18120984
i = 10  <i|F|i> =   0.26357601
i = 11  <i|F|i> =   0.60643199
i = 12  <i|F|i> =   0.68930702
i = 13  <i|F|i> =   0.63626563
i = 14  <i|F|i> =   0.71690790
i = 15  <i|F|i> =   0.72186338
i = 16  <i|F|i> =   0.71891330
i = 17  <i|F|i> =   0.77948552
i = 18  <i|F|i> =   1.01019748
i = 19  <i|F|i> =   1.17637125
i = 20  <i|F|i> =   1.22405926
i = 21  <i|F|i> =   1.34619497
i = 22  <i|F|i> =   1.34650705
i = 23  <i|F|i> =   1.44196580
i = 24  <i|F|i> =   1.44634572
i = 25  <i|F|i> =   1.44555295
i = 26  <i|F|i> =   1.66169112
i = 27  <i|F|i> =   1.72133872
i = 28  <i|F|i> =   2.12791305
......production of RDMs took       1.86 sec
......reading the RDM took          0.45 sec
......production of RDMs took      33.67 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.78 sec

E(WickICNEVPT2-ijrs) =    -0.00029141884760
E(WickICNEVPT2- rsi) =    -0.00080962553932
E(WickICNEVPT2- ijr) =    -0.00026555450688
E(WickICNEVPT2-  rs) =    -0.03348909351787
E(WickICNEVPT2-  ij) =    -0.00006277630970
E(WickICNEVPT2-  ir) =    -0.00100609710607
E(WickICNEVPT2-   r) =    -0.05998153040449
E(WickICNEVPT2-   i) =    -0.00005995779985
E(WickICNEVPT2) = -75.57094637583093  E_corr_pt = -0.0959660540317919
Timings = pdms =   45.75 | eris =    0.00 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.27 | ij =    0.07 | ir =    0.15 | r =    3.00 | i =    1.27 | total =   50.56
Time cost =    235.196
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:50:07 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.957955680404 AA    0.000000000000   0.000000000000   3.700000000000 Bohr   0.0

nuclear repulsion = 9.72972972972973
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.85]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6227.75


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp1bp5uv4y
max_memory 4000 MB (current use 317 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7163760223708

WARN: Singularity detected in overlap matrix (condition number = 80.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.104120790735629  LUMO (B3u) = -0.104120790735628

WARN: B2u HOMO -0.104120790735629 > system LUMO -0.104120790735628

cycle= 1 E= -75.2641203852924  delta_E= -0.548  |g|= 0.236  |ddm|= 1.47
HOMO (B2u) = -0.359408877513719  LUMO (B3u) = -0.0527582771899446
cycle= 2 E= -75.2865593123333  delta_E= -0.0224  |g|= 0.0471  |ddm|= 0.348
HOMO (B2u) = -0.325804970810901  LUMO (B3u) = -0.0145227547118896
cycle= 3 E= -75.2878678904738  delta_E= -0.00131  |g|= 0.0174  |ddm|= 0.0619
HOMO (B2u) = -0.330188258882717  LUMO (B3u) = -0.0187350374973003
cycle= 4 E= -75.2880824131579  delta_E= -0.000215  |g|= 0.000653  |ddm|= 0.035
HOMO (B2u) = -0.330355542534975  LUMO (B3u) = -0.0190485772808918
cycle= 5 E= -75.288082574972  delta_E= -1.62e-07  |g|= 0.000124  |ddm|= 0.000847
HOMO (B2u) = -0.330318643630841  LUMO (B3u) = -0.0190186484174847
cycle= 6 E= -75.2880825838255  delta_E= -8.85e-09  |g|= 1.86e-05  |ddm|= 0.000214
HOMO (B2u) = -0.330315994378311  LUMO (B3u) = -0.019018921639851
cycle= 7 E= -75.2880825840469  delta_E= -2.21e-10  |g|= 1.93e-06  |ddm|= 3.86e-05
HOMO (B2u) = -0.330315507539127  LUMO (B3u) = -0.0190188734083648
cycle= 8 E= -75.2880825840493  delta_E= -2.43e-12  |g|= 1.29e-07  |ddm|= 4.01e-06
HOMO (B2u) = -0.330315512036346  LUMO (B3u) = -0.0190188725353706
cycle= 9 E= -75.2880825840493  delta_E= 8.53e-14  |g|= 8.84e-09  |ddm|= 3.07e-07
HOMO (B2u) = -0.330315511519672  LUMO (B3u) = -0.0190188740669329
cycle= 10 E= -75.2880825840493  delta_E= -1.42e-14  |g|= 7.22e-09  |ddm|= 7.71e-09
HOMO (B2u) = -0.33031551143057  LUMO (B3u) = -0.0190188740435354
cycle= 11 E= -75.2880825840493  delta_E= -7.11e-14  |g|= 5.2e-09  |ddm|= 5.8e-09
HOMO (B2u) = -0.330315510118461  LUMO (B3u) = -0.0190188726790425
cycle= 12 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 4.49e-09  |ddm|= 2.78e-09
HOMO (B2u) = -0.330315510361485  LUMO (B3u) = -0.019018872936669
cycle= 13 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 4.02e-09  |ddm|= 1.74e-09
HOMO (B2u) = -0.330315510214236  LUMO (B3u) = -0.0190188727855298
cycle= 14 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 3.28e-09  |ddm|= 2.15e-09
HOMO (B2u) = -0.330315510028963  LUMO (B3u) = -0.0190188727302232
cycle= 15 E= -75.2880825840493  delta_E= 8.53e-14  |g|= 1.06e-09  |ddm|= 6.34e-09
HOMO (B2u) = -0.330315509940722  LUMO (B3u) = -0.0190188727154821
cycle= 16 E= -75.2880825840494  delta_E= -5.68e-14  |g|= 9.94e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.330315509970084  LUMO (B3u) = -0.0190188726985459
cycle= 17 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 1.11e-09  |ddm|= 1e-09
HOMO (B2u) = -0.330315509932707  LUMO (B3u) = -0.0190188726753085
cycle= 18 E= -75.2880825840493  delta_E=    0  |g|= 8.61e-10  |ddm|= 6.58e-10
HOMO (B2u) = -0.330315509926818  LUMO (B3u) = -0.0190188726817887
cycle= 19 E= -75.2880825840493  delta_E=    0  |g|= 6.9e-10  |ddm|= 5.59e-10
HOMO (B2u) = -0.330315509925318  LUMO (B3u) = -0.0190188726902478
cycle= 20 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 5.63e-10  |ddm|= 3.89e-10
HOMO (B2u) = -0.330315509909668  LUMO (B3u) = -0.019018872681767
cycle= 21 E= -75.2880825840493  delta_E= 4.26e-14  |g|= 4.37e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.330315509897373  LUMO (B3u) = -0.0190188726770183
cycle= 22 E= -75.2880825840492  delta_E= 9.95e-14  |g|= 3.17e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.330315509885468  LUMO (B3u) = -0.0190188726728172
cycle= 23 E= -75.2880825840494  delta_E= -1.28e-13  |g|= 2.27e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.330315509878509  LUMO (B3u) = -0.019018872669482
cycle= 24 E= -75.2880825840493  delta_E= 8.53e-14  |g|= 1.96e-10  |ddm|= 8.25e-11
HOMO (B2u) = -0.33031550987509  LUMO (B3u) = -0.0190188726666646
cycle= 25 E= -75.2880825840493  delta_E= -5.68e-14  |g|= 1.65e-10  |ddm|= 7.64e-11
HOMO (B2u) = -0.330315509870249  LUMO (B3u) = -0.0190188726641958
cycle= 26 E= -75.2880825840494  delta_E= -1.42e-14  |g|= 1.32e-10  |ddm|= 9.2e-11
HOMO (B2u) = -0.330315509866421  LUMO (B3u) = -0.0190188726622466
cycle= 27 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 1.07e-10  |ddm|= 7.12e-11
HOMO (B2u) = -0.330315509863258  LUMO (B3u) = -0.0190188726606009
cycle= 28 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 8.58e-11  |ddm|= 5.68e-11
HOMO (B2u) = -0.330315509860744  LUMO (B3u) = -0.0190188726593263
cycle= 29 E= -75.2880825840493  delta_E=    0  |g|= 6.76e-11  |ddm|= 4.65e-11
HOMO (B2u) = -0.330315509854283  LUMO (B3u) = -0.0190188726559784
Extra cycle  E= -75.2880825840493  delta_E= -2.84e-14  |g|= 2.34e-11  |ddm|= 1.13e-10
converged SCF energy = -75.2880825840493

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp1bp5uv4y
max_memory 4000 MB (current use 317 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4284824270343  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4443133541936  dE = -0.015830927  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|= 3.78  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4564312005229  dE = -0.012117846  S^2 = 0.0000000
               |grad[o]|=0.079  |ddm|=0.101  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4642866715206  dE = -0.007855471  S^2 = 0.0000000
               |grad[o]|=0.0552  |ddm|=0.0402  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4683743861181  dE = -0.0040877146  S^2 = 0.0000000
               |grad[o]|=0.032  |ddm|=0.0939  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4701448490402  dE = -0.0017704629  S^2 = 0.0000000
               |grad[o]|=0.0156  |ddm|=0.0559  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4705677128511  dE = -0.00042286381  S^2 = 0.0000000
               |grad[o]|=0.00657  |ddm|=0.0184  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4706176210689  dE = -4.9908218e-05  S^2 = 0.0000000
               |grad[o]|=0.00242  |ddm|=0.00761  |maxRot[o]|=0.0156
macro iter 8 (3 JK  0 micro), CASSCF E = -75.470621817114  dE = -4.1960451e-06  S^2 = 0.0000000
               |grad[o]|=0.000823  |ddm|=0.00269  |maxRot[o]|=0.00463
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4706221621622  dE = -3.4504815e-07  S^2 = 0.0000000
               |grad[o]|=0.000251  |ddm|=0.000815  |maxRot[o]|=0.00133
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4706221904069  dE = -2.8244671e-08  S^2 = 0.0000000
               |grad[o]|=7.44e-05  |ddm|=0.00024  |maxRot[o]|=0.000379
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4706221927127  dE = -2.3058675e-09  S^2 = 0.0000000
               |grad[o]|=2.17e-05  |ddm|=6.94e-05  |maxRot[o]|=0.000108
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4706221929015  dE = -1.887912e-10  S^2 = 0.0000000
               |grad[o]|=6.23e-06  |ddm|=2.01e-05  |maxRot[o]|=3.08e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4706221929169  dE = -1.5376145e-11  S^2 = 0.0000000
               |grad[o]|=1.79e-06  |ddm|=5.75e-06  |maxRot[o]|=8.82e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95713289 1.93379643 1.87461992 1.72422801 0.06681526 0.28113864
 0.05662336 0.10564549]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01200   0.01047  -0.00276   0.00000   0.00000
  0 C 2s       0.68293   0.67051  -0.18198   0.00000  -0.00000
  0 C 3s      -0.00172   0.01539  -0.03356   0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69358
  0 C 2py     -0.00000   0.00000  -0.00000   0.70441   0.00000
  0 C 2pz      0.18173  -0.22338   0.68140   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06561
  0 C 3py     -0.00000   0.00000  -0.00000   0.05451   0.00000
  0 C 3pz     -0.01154  -0.00172   0.01401   0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02892  -0.00000
  0 C 3dz^2    0.01723  -0.01123   0.03460   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.12102
 0 C 3dx2-y2   0.00106   0.00623  -0.00705   0.00000   0.00000
  1 C 1s       0.01200  -0.01047  -0.00276   0.00000   0.00000
  1 C 2s       0.68293  -0.67051  -0.18198   0.00000  -0.00000
  1 C 3s      -0.00172  -0.01539  -0.03356  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69358
  1 C 2py      0.00000  -0.00000  -0.00000   0.70441   0.00000
  1 C 2pz     -0.18173  -0.22338  -0.68140   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06561
  1 C 3py      0.00000  -0.00000   0.00000   0.05451  -0.00000
  1 C 3pz      0.01154  -0.00172  -0.01401   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02892   0.00000
  1 C 3dz^2    0.01723   0.01123   0.03460  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12102
 1 C 3dx2-y2   0.00106  -0.00623  -0.00705   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00028
  0 C 2s       0.00000  -0.00000   0.22254
  0 C 3s       0.00000  -0.00000   0.03036
  0 C 2px     -0.00000   0.69830  -0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.66959
  0 C 3px     -0.00000  -0.01481   0.00000
  0 C 3py     -0.00465   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.03021
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00965   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00477
  0 C 3dxz    -0.00000  -0.11029  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01664
  1 C 1s       0.00000   0.00000   0.00028
  1 C 2s      -0.00000   0.00000  -0.22254
  1 C 3s      -0.00000   0.00000  -0.03036
  1 C 2px      0.00000  -0.69830  -0.00000
  1 C 2py     -0.70703  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66959
  1 C 3px      0.00000   0.01481   0.00000
  1 C 3py      0.00465   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.03021
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00965  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00477
  1 C 3dxz    -0.00000  -0.11029  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01664
<CAS-nat-orb|mo-hf>  3  3    0.99943449
<CAS-nat-orb|mo-hf>  4  4    0.99967130
<CAS-nat-orb|mo-hf>  5  5    0.99943415
<CAS-nat-orb|mo-hf>  6  6    0.99875809
<CAS-nat-orb|mo-hf>  7  7    0.93391056
<CAS-nat-orb|mo-hf>  8  8    0.98327030
<CAS-nat-orb|mo-hf>  9  9    0.96053902
<CAS-nat-orb|mo-hf>  10  10    0.94279395
CASSCF energy = -75.4706221929169
CASCI E = -75.4706221929169  E(CI) = -15.078733235137  S^2 = 0.0000000
Density matrix diagonal elements [1.95713307 1.93379692 1.87462015 1.72422678 0.0668147  0.28113984
 0.05662316 0.10564538]
i = 1  <i|F|i> = -11.34546297
i = 2  <i|F|i> = -11.34581867
i = 3  <i|F|i> =  -0.82033739
i = 4  <i|F|i> =  -0.63354655
i = 5  <i|F|i> =  -0.34782438
i = 6  <i|F|i> =  -0.27709905
i = 7  <i|F|i> =   0.10486162
i = 8  <i|F|i> =   0.02726357
i = 9  <i|F|i> =   0.17905574
i = 10  <i|F|i> =   0.24894785
i = 11  <i|F|i> =   0.61049377
i = 12  <i|F|i> =   0.68842378
i = 13  <i|F|i> =   0.63415098
i = 14  <i|F|i> =   0.71778001
i = 15  <i|F|i> =   0.72302681
i = 16  <i|F|i> =   0.71870987
i = 17  <i|F|i> =   0.78610439
i = 18  <i|F|i> =   1.00700133
i = 19  <i|F|i> =   1.18304087
i = 20  <i|F|i> =   1.22900418
i = 21  <i|F|i> =   1.35008953
i = 22  <i|F|i> =   1.35046566
i = 23  <i|F|i> =   1.42112833
i = 24  <i|F|i> =   1.44323650
i = 25  <i|F|i> =   1.44252531
i = 26  <i|F|i> =   1.64844806
i = 27  <i|F|i> =   1.70705559
i = 28  <i|F|i> =   2.12188379
......production of RDMs took      43.51 sec
......reading the RDM took          0.41 sec
......production of RDMs took      44.17 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.09 sec

E(WickICNEVPT2-ijrs) =    -0.00029310630934
E(WickICNEVPT2- rsi) =    -0.00081253399220
E(WickICNEVPT2- ijr) =    -0.00026387774947
E(WickICNEVPT2-  rs) =    -0.03333479374601
E(WickICNEVPT2-  ij) =    -0.00006092243556
E(WickICNEVPT2-  ir) =    -0.00100118162578
E(WickICNEVPT2-   r) =    -0.06028333077644
E(WickICNEVPT2-   i) =    -0.00005720086508
E(WickICNEVPT2) = -75.56672914041678  E_corr_pt = -0.09610694749989016
Timings = pdms =   98.26 | eris =    0.61 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.32 | ij =    0.09 | ir =    0.18 | r =    2.22 | i =    0.85 | total =  102.58
Time cost =    258.718
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:54:26 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.984414540950 AA    0.000000000000   0.000000000000   3.750000000000 Bohr   0.0

nuclear repulsion = 9.6
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.875]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6624.92


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpofwrtq6y
max_memory 4000 MB (current use 320 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7049084284725

WARN: Singularity detected in overlap matrix (condition number = 75.6). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.101370211913451  LUMO (B3u) = -0.101370211913452

WARN: B2u HOMO -0.101370211913451 > system LUMO -0.101370211913452

cycle= 1 E= -75.2564523906343  delta_E= -0.552  |g|= 0.234  |ddm|= 1.47
HOMO (B2u) = -0.355831308623934  LUMO (B3u) = -0.0506406338501569
cycle= 2 E= -75.2785865089974  delta_E= -0.0221  |g|= 0.0465  |ddm|= 0.348
HOMO (B2u) = -0.322685006141469  LUMO (B3u) = -0.0128872994795376
cycle= 3 E= -75.2798715208091  delta_E= -0.00129  |g|= 0.0172  |ddm|= 0.061
HOMO (B2u) = -0.327043790963023  LUMO (B3u) = -0.0170677233110581
cycle= 4 E= -75.2800833606866  delta_E= -0.000212  |g|= 0.000651  |ddm|= 0.0346
HOMO (B2u) = -0.327204207243866  LUMO (B3u) = -0.0173729266447937
cycle= 5 E= -75.280083521623  delta_E= -1.61e-07  |g|= 0.000127  |ddm|= 0.00084
HOMO (B2u) = -0.327167734029076  LUMO (B3u) = -0.0173440705847794
cycle= 6 E= -75.2800835308716  delta_E= -9.25e-09  |g|= 1.89e-05  |ddm|= 0.000218
HOMO (B2u) = -0.327165039753315  LUMO (B3u) = -0.0173442874866636
cycle= 7 E= -75.2800835311012  delta_E= -2.3e-10  |g|= 1.94e-06  |ddm|= 3.91e-05
HOMO (B2u) = -0.327164572283828  LUMO (B3u) = -0.0173442642259046
cycle= 8 E= -75.2800835311035  delta_E= -2.27e-12  |g|= 1.3e-07  |ddm|= 4.03e-06
HOMO (B2u) = -0.327164577390953  LUMO (B3u) = -0.0173442637009126
cycle= 9 E= -75.2800835311036  delta_E= -8.53e-14  |g|= 8.76e-09  |ddm|= 3.12e-07
HOMO (B2u) = -0.327164576779063  LUMO (B3u) = -0.0173442652018592
cycle= 10 E= -75.2800835311036  delta_E=    0  |g|= 7.28e-09  |ddm|= 7.49e-09
HOMO (B2u) = -0.327164576741839  LUMO (B3u) = -0.0173442652465928
cycle= 11 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 5.2e-09  |ddm|= 5.96e-09
HOMO (B2u) = -0.327164575481139  LUMO (B3u) = -0.0173442639352938
cycle= 12 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 4.47e-09  |ddm|= 2.87e-09
HOMO (B2u) = -0.327164575694546  LUMO (B3u) = -0.017344264163857
cycle= 13 E= -75.2800835311036  delta_E= -8.53e-14  |g|= 4e-09  |ddm|= 1.7e-09
HOMO (B2u) = -0.32716457524105  LUMO (B3u) = -0.017344263931453
cycle= 14 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 9.56e-10  |ddm|= 7.35e-09
HOMO (B2u) = -0.327164575348891  LUMO (B3u) = -0.0173442639680124
cycle= 15 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 9.67e-10  |ddm|= 1.36e-09
HOMO (B2u) = -0.327164575269138  LUMO (B3u) = -0.0173442639535627
cycle= 16 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 9.09e-10  |ddm|= 1.07e-09
HOMO (B2u) = -0.327164575295488  LUMO (B3u) = -0.0173442639368028
cycle= 17 E= -75.2800835311035  delta_E= 8.53e-14  |g|= 1.03e-09  |ddm|= 9.57e-10
HOMO (B2u) = -0.32716457525832  LUMO (B3u) = -0.0173442639153242
cycle= 18 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 7.75e-10  |ddm|= 6.6e-10
HOMO (B2u) = -0.327164575251759  LUMO (B3u) = -0.0173442639221845
cycle= 19 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 6.01e-10  |ddm|= 5.77e-10
HOMO (B2u) = -0.327164575250018  LUMO (B3u) = -0.0173442639311685
cycle= 20 E= -75.2800835311036  delta_E= -1.14e-13  |g|= 4.73e-10  |ddm|= 4.01e-10
HOMO (B2u) = -0.327164575234336  LUMO (B3u) = -0.0173442639235994
cycle= 21 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 3.47e-10  |ddm|= 3.39e-10
HOMO (B2u) = -0.327164575221617  LUMO (B3u) = -0.0173442639192906
cycle= 22 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 2.28e-10  |ddm|= 3.1e-10
HOMO (B2u) = -0.327164575218655  LUMO (B3u) = -0.0173442639165192
cycle= 23 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 2.01e-10  |ddm|= 7.27e-11
HOMO (B2u) = -0.327164575212243  LUMO (B3u) = -0.0173442639134276
cycle= 24 E= -75.2800835311036  delta_E=    0  |g|= 1.72e-10  |ddm|= 7.57e-11
HOMO (B2u) = -0.327164575209021  LUMO (B3u) = -0.0173442639108304
cycle= 25 E= -75.2800835311036  delta_E=    0  |g|= 1.44e-10  |ddm|= 7.08e-11
HOMO (B2u) = -0.327164575204547  LUMO (B3u) = -0.0173442639086258
cycle= 26 E= -75.2800835311035  delta_E= 8.53e-14  |g|= 1.13e-10  |ddm|= 8.64e-11
HOMO (B2u) = -0.327164575201131  LUMO (B3u) = -0.0173442639069264
cycle= 27 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 9.07e-11  |ddm|= 6.54e-11
HOMO (B2u) = -0.327164575198398  LUMO (B3u) = -0.0173442639055026
cycle= 28 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 7.21e-11  |ddm|= 5.01e-11
HOMO (B2u) = -0.32716457519633  LUMO (B3u) = -0.0173442639044309
cycle= 29 E= -75.2800835311036  delta_E= -1.14e-13  |g|= 5.66e-11  |ddm|= 3.94e-11
HOMO (B2u) = -0.327164575194748  LUMO (B3u) = -0.017344263903574
cycle= 30 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 4.49e-11  |ddm|= 2.89e-11
HOMO (B2u) = -0.327164575193719  LUMO (B3u) = -0.0173442639029923
cycle= 31 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 3.74e-11  |ddm|= 1.86e-11
HOMO (B2u) = -0.327164575192743  LUMO (B3u) = -0.0173442639024711
cycle= 32 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 3.06e-11  |ddm|= 1.66e-11
HOMO (B2u) = -0.327164575191975  LUMO (B3u) = -0.0173442639020371
cycle= 33 E= -75.2800835311036  delta_E= 2.84e-14  |g|= 2.49e-11  |ddm|= 1.43e-11
HOMO (B2u) = -0.327164575191296  LUMO (B3u) = -0.017344263901682
cycle= 34 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 2.02e-11  |ddm|= 1.21e-11
HOMO (B2u) = -0.327164575190763  LUMO (B3u) = -0.0173442639013961
cycle= 35 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 1.65e-11  |ddm|= 9.43e-12
HOMO (B2u) = -0.327164575190334  LUMO (B3u) = -0.0173442639011559
cycle= 36 E= -75.2800835311037  delta_E= -1.71e-13  |g|= 1.34e-11  |ddm|= 7.54e-12
HOMO (B2u) = -0.327164575189993  LUMO (B3u) = -0.0173442639009594
cycle= 37 E= -75.2800835311035  delta_E= 1.42e-13  |g|= 1.09e-11  |ddm|= 5.96e-12
HOMO (B2u) = -0.327164575189726  LUMO (B3u) = -0.0173442639008045
cycle= 38 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 8.89e-12  |ddm|= 4.65e-12
HOMO (B2u) = -0.327164575189514  LUMO (B3u) = -0.0173442639006816
cycle= 39 E= -75.2800835311035  delta_E=    0  |g|= 7.33e-12  |ddm|= 3.67e-12
HOMO (B2u) = -0.327164575188907  LUMO (B3u) = -0.0173442639003256
Extra cycle  E= -75.2800835311035  delta_E= 2.84e-14  |g|= 2.75e-12  |ddm|= 1.06e-11
converged SCF energy = -75.2800835311035

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpofwrtq6y
max_memory 4000 MB (current use 320 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4247711667694  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4410961607661  dE = -0.016324994  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4533243763462  dE = -0.012228216  S^2 = 0.0000000
               |grad[o]|=0.0793  |ddm|=0.107  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4609348681371  dE = -0.0076104918  S^2 = 0.0000000
               |grad[o]|=0.0537  |ddm|=0.0363  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4644374668594  dE = -0.0035025987  S^2 = 0.0000000
               |grad[o]|=0.029  |ddm|=0.102  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4660330712973  dE = -0.0015956044  S^2 = 0.0000000
               |grad[o]|=0.0144  |ddm|=0.0465  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4663655365141  dE = -0.00033246522  S^2 = 0.0000000
               |grad[o]|=0.00576  |ddm|=0.0163  |maxRot[o]|=0.0375
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4663950794203  dE = -2.9542906e-05  S^2 = 0.0000000
               |grad[o]|=0.00202  |ddm|=0.00671  |maxRot[o]|=0.0121
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4663975357625  dE = -2.4563422e-06  S^2 = 0.0000000
               |grad[o]|=0.000663  |ddm|=0.00206  |maxRot[o]|=0.00353
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4663977370562  dE = -2.012937e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.000624  |maxRot[o]|=0.00101
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4663977534854  dE = -1.6429183e-08  S^2 = 0.0000000
               |grad[o]|=5.9e-05  |ddm|=0.000183  |maxRot[o]|=0.000287
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4663977548322  dE = -1.3468622e-09  S^2 = 0.0000000
               |grad[o]|=1.71e-05  |ddm|=5.31e-05  |maxRot[o]|=8.13e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4663977549444  dE = -1.1210943e-10  S^2 = 0.0000000
               |grad[o]|=4.95e-06  |ddm|=1.52e-05  |maxRot[o]|=2.35e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4663977549535  dE = -9.1660013e-12  S^2 = 0.0000000
               |grad[o]|=1.43e-06  |ddm|=4.49e-06  |maxRot[o]|=6.65e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95667457 1.9344164  1.86874334 1.70868175 0.06576131 0.29650692
 0.0563102  0.1129055 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01211   0.01055  -0.00246   0.00000   0.00000
  0 C 2s       0.68726   0.67292  -0.16495  -0.00000  -0.00000
  0 C 3s      -0.00012   0.01517  -0.03163  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69361
  0 C 2py      0.00000  -0.00000  -0.00000   0.70443  -0.00000
  0 C 2pz      0.16481  -0.21605   0.68580   0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06639
  0 C 3py      0.00000  -0.00000  -0.00000   0.05485  -0.00000
  0 C 3pz     -0.01075  -0.00170   0.01569  -0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02772  -0.00000
  0 C 3dz^2    0.01579  -0.01087   0.03419  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.12041
 0 C 3dx2-y2   0.00128   0.00613  -0.00696   0.00000  -0.00000
  1 C 1s       0.01211  -0.01055  -0.00246   0.00000   0.00000
  1 C 2s       0.68726  -0.67292  -0.16495   0.00000   0.00000
  1 C 3s      -0.00012  -0.01517  -0.03163   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69361
  1 C 2py      0.00000  -0.00000  -0.00000   0.70443   0.00000
  1 C 2pz     -0.16481  -0.21605  -0.68580   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.06639
  1 C 3py     -0.00000   0.00000   0.00000   0.05485   0.00000
  1 C 3pz      0.01075  -0.00170  -0.01569  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02772  -0.00000
  1 C 3dz^2    0.01579   0.01087   0.03419   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.12041
 1 C 3dx2-y2   0.00128  -0.00613  -0.00696   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00026
  0 C 2s      -0.00000  -0.00000   0.21528
  0 C 3s      -0.00000  -0.00000   0.02936
  0 C 2px     -0.00000   0.69842   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67214
  0 C 3px      0.00000  -0.01654  -0.00000
  0 C 3py     -0.00273  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02753
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00925   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00414
  0 C 3dxz     0.00000  -0.10923   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01562
  1 C 1s       0.00000   0.00000   0.00026
  1 C 2s       0.00000   0.00000  -0.21528
  1 C 3s       0.00000   0.00000  -0.02936
  1 C 2px     -0.00000  -0.69842   0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.67214
  1 C 3px      0.00000   0.01654  -0.00000
  1 C 3py      0.00273  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02753
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00925   0.00000   0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00414
  1 C 3dxz    -0.00000  -0.10923   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01562
<CAS-nat-orb|mo-hf>  3  3    0.99890662
<CAS-nat-orb|mo-hf>  4  4    0.99965866
<CAS-nat-orb|mo-hf>  5  5    0.99889779
<CAS-nat-orb|mo-hf>  6  6    0.99869247
<CAS-nat-orb|mo-hf>  7  7    0.93353913
<CAS-nat-orb|mo-hf>  8  8    0.98425021
<CAS-nat-orb|mo-hf>  9  9    0.96066028
<CAS-nat-orb|mo-hf>  10  10    0.94772193
CASSCF energy = -75.4663977549535
CASCI E = -75.4663977549535  E(CI) = -15.0169341303922  S^2 = 0.0000000
Density matrix diagonal elements [1.9566748  1.93441654 1.86874407 1.70868165 0.06576029 0.29650709
 0.05631014 0.11290543]
i = 1  <i|F|i> = -11.34551650
i = 2  <i|F|i> = -11.34588233
i = 3  <i|F|i> =  -0.81407052
i = 4  <i|F|i> =  -0.63604414
i = 5  <i|F|i> =  -0.34421774
i = 6  <i|F|i> =  -0.27193268
i = 7  <i|F|i> =   0.10710097
i = 8  <i|F|i> =   0.02117077
i = 9  <i|F|i> =   0.17701195
i = 10  <i|F|i> =   0.23496001
i = 11  <i|F|i> =   0.61450207
i = 12  <i|F|i> =   0.68743422
i = 13  <i|F|i> =   0.63210884
i = 14  <i|F|i> =   0.71854329
i = 15  <i|F|i> =   0.72416590
i = 16  <i|F|i> =   0.71852844
i = 17  <i|F|i> =   0.79257466
i = 18  <i|F|i> =   1.00397415
i = 19  <i|F|i> =   1.19010236
i = 20  <i|F|i> =   1.23441140
i = 21  <i|F|i> =   1.35375648
i = 22  <i|F|i> =   1.35425444
i = 23  <i|F|i> =   1.40148973
i = 24  <i|F|i> =   1.44032993
i = 25  <i|F|i> =   1.43969367
i = 26  <i|F|i> =   1.63556044
i = 27  <i|F|i> =   1.69309436
i = 28  <i|F|i> =   2.11461662
......production of RDMs took       2.38 sec
......reading the RDM took          0.43 sec
......production of RDMs took      66.89 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.00 sec

E(WickICNEVPT2-ijrs) =    -0.00029487669947
E(WickICNEVPT2- rsi) =    -0.00081576155434
E(WickICNEVPT2- ijr) =    -0.00026227995215
E(WickICNEVPT2-  rs) =    -0.03318967968148
E(WickICNEVPT2-  ij) =    -0.00005918346877
E(WickICNEVPT2-  ir) =    -0.00099672484601
E(WickICNEVPT2-   r) =    -0.06056281230846
E(WickICNEVPT2-   i) =    -0.00005458072672
E(WickICNEVPT2) = -75.56263365419093  E_corr_pt = -0.0962358992374138
Timings = pdms =   79.75 | eris =    0.01 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.15 | r =    2.09 | i =    0.99 | total =   83.35
Time cost =    223.691
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:58:10 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.010873401496 AA    0.000000000000   0.000000000000   3.800000000000 Bohr   0.0

nuclear repulsion = 9.47368421052632
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6958.83


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp7onqa8ah
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6942155395781

WARN: Singularity detected in overlap matrix (condition number = 70.9). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0987431605477886  LUMO (B3u) = -0.0987431605477896

WARN: B2u HOMO -0.0987431605477886 > system LUMO -0.0987431605477896

cycle= 1 E= -75.2488547171612  delta_E= -0.555  |g|= 0.232  |ddm|= 1.46
HOMO (B2u) = -0.352381746665135  LUMO (B3u) = -0.0486055106897028
cycle= 2 E= -75.2707023112208  delta_E= -0.0218  |g|= 0.046  |ddm|= 0.348
HOMO (B2u) = -0.319674633980573  LUMO (B3u) = -0.0113141174561873
cycle= 3 E= -75.2719633258624  delta_E= -0.00126  |g|= 0.0171  |ddm|= 0.0602
HOMO (B2u) = -0.324007395733248  LUMO (B3u) = -0.0154613624878824
cycle= 4 E= -75.2721722602516  delta_E= -0.000209  |g|= 0.000648  |ddm|= 0.0343
HOMO (B2u) = -0.324157880743129  LUMO (B3u) = -0.0157548749526135
cycle= 5 E= -75.2721724204055  delta_E= -1.6e-07  |g|= 0.000129  |ddm|= 0.000835
HOMO (B2u) = -0.324121920212104  LUMO (B3u) = -0.0157271018699659
cycle= 6 E= -75.2721724300014  delta_E= -9.6e-09  |g|= 1.92e-05  |ddm|= 0.000222
HOMO (B2u) = -0.324119190447222  LUMO (B3u) = -0.0157272676284043
cycle= 7 E= -75.2721724302383  delta_E= -2.37e-10  |g|= 1.95e-06  |ddm|= 3.95e-05
HOMO (B2u) = -0.324118740620386  LUMO (B3u) = -0.0157272677303703
cycle= 8 E= -75.2721724302408  delta_E= -2.44e-12  |g|= 1.3e-07  |ddm|= 4.06e-06
HOMO (B2u) = -0.324118746684608  LUMO (B3u) = -0.0157272678197088
cycle= 9 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 8.56e-09  |ddm|= 3.15e-07
HOMO (B2u) = -0.324118746001904  LUMO (B3u) = -0.0157272693207541
cycle= 10 E= -75.2721724302408  delta_E= -4.26e-14  |g|= 7.22e-09  |ddm|= 7.24e-09
HOMO (B2u) = -0.324118746009922  LUMO (B3u) = -0.0157272694172725
cycle= 11 E= -75.2721724302408  delta_E=    0  |g|= 5.15e-09  |ddm|= 5.91e-09
HOMO (B2u) = -0.324118744820934  LUMO (B3u) = -0.0157272681801235
cycle= 12 E= -75.2721724302408  delta_E= -1.42e-14  |g|= 4.4e-09  |ddm|= 2.93e-09
HOMO (B2u) = -0.324118745005548  LUMO (B3u) = -0.0157272683815557
cycle= 13 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 3.94e-09  |ddm|= 1.69e-09
HOMO (B2u) = -0.32411874456033  LUMO (B3u) = -0.0157272681653091
cycle= 14 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 9.13e-10  |ddm|= 7.35e-09
HOMO (B2u) = -0.324118744667803  LUMO (B3u) = -0.0157272682018
cycle= 15 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 9.35e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.324118744590976  LUMO (B3u) = -0.0157272681872724
cycle= 16 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 8.7e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.324118744616254  LUMO (B3u) = -0.0157272681691108
cycle= 17 E= -75.2721724302407  delta_E= 8.53e-14  |g|= 9.98e-10  |ddm|= 9.92e-10
HOMO (B2u) = -0.324118744580643  LUMO (B3u) = -0.0157272681499073
cycle= 18 E= -75.2721724302407  delta_E=    0  |g|= 7.54e-10  |ddm|= 6.38e-10
HOMO (B2u) = -0.324118744574854  LUMO (B3u) = -0.0157272681577478
cycle= 19 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 5.82e-10  |ddm|= 5.73e-10
HOMO (B2u) = -0.324118744573817  LUMO (B3u) = -0.0157272681676053
cycle= 20 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 4.57e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.324118744559217  LUMO (B3u) = -0.0157272681614907
cycle= 21 E= -75.2721724302407  delta_E= -1.42e-14  |g|= 3.35e-10  |ddm|= 3.32e-10
HOMO (B2u) = -0.324118744547194  LUMO (B3u) = -0.015727268158106
cycle= 22 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 2.18e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.32411874454442  LUMO (B3u) = -0.0157272681554608
cycle= 23 E= -75.2721724302408  delta_E= -9.95e-14  |g|= 1.93e-10  |ddm|= 6.87e-11
HOMO (B2u) = -0.324118744538217  LUMO (B3u) = -0.0157272681524954
cycle= 24 E= -75.2721724302407  delta_E= 7.11e-14  |g|= 1.65e-10  |ddm|= 7.26e-11
HOMO (B2u) = -0.324118744535106  LUMO (B3u) = -0.0157272681500475
cycle= 25 E= -75.2721724302407  delta_E= 1.42e-14  |g|= 1.38e-10  |ddm|= 6.72e-11
HOMO (B2u) = -0.324118744530827  LUMO (B3u) = -0.0157272681480869
cycle= 26 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 1.08e-10  |ddm|= 8.37e-11
HOMO (B2u) = -0.324118744527578  LUMO (B3u) = -0.0157272681465826
cycle= 27 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 8.69e-11  |ddm|= 6.36e-11
HOMO (B2u) = -0.324118744524963  LUMO (B3u) = -0.0157272681452985
cycle= 28 E= -75.2721724302408  delta_E= -2.84e-14  |g|= 6.91e-11  |ddm|= 4.83e-11
HOMO (B2u) = -0.324118744522971  LUMO (B3u) = -0.0157272681443206
cycle= 29 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 5.41e-11  |ddm|= 3.78e-11
HOMO (B2u) = -0.324118744521453  LUMO (B3u) = -0.0157272681435341
cycle= 30 E= -75.2721724302407  delta_E=    0  |g|= 4.29e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.324118744517542  LUMO (B3u) = -0.0157272681414942
Extra cycle  E= -75.2721724302407  delta_E= 2.84e-14  |g|= 1.51e-11  |ddm|= 6.95e-11
converged SCF energy = -75.2721724302407

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp7onqa8ah
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4211674784897  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4380007566068  dE = -0.016833278  S^2 = 0.0000000
               |grad[o]|=0.104  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4503194901039  dE = -0.012318733  S^2 = 0.0000000
               |grad[o]|=0.0795  |ddm|=0.112  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4576628758804  dE = -0.0073433858  S^2 = 0.0000000
               |grad[o]|=0.052  |ddm|=0.0313  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4606478981361  dE = -0.0029850223  S^2 = 0.0000000
               |grad[o]|=0.0258  |ddm|=0.108  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4620547102115  dE = -0.0014068121  S^2 = 0.0000000
               |grad[o]|=0.0131  |ddm|=0.0375  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4622921063013  dE = -0.00023739609  S^2 = 0.0000000
               |grad[o]|=0.00495  |ddm|=0.0145  |maxRot[o]|=0.0323
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4623127843088  dE = -2.0678007e-05  S^2 = 0.0000000
               |grad[o]|=0.00178  |ddm|=0.00552  |maxRot[o]|=0.0101
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4623145068647  dE = -1.7225559e-06  S^2 = 0.0000000
               |grad[o]|=0.000579  |ddm|=0.00172  |maxRot[o]|=0.00294
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4623146489297  dE = -1.4206502e-07  S^2 = 0.0000000
               |grad[o]|=0.000174  |ddm|=0.000526  |maxRot[o]|=0.000839
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4623146606368  dE = -1.1707115e-08  S^2 = 0.0000000
               |grad[o]|=5.14e-05  |ddm|=0.000155  |maxRot[o]|=0.000239
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4623146616044  dE = -9.6757446e-10  S^2 = 0.0000000
               |grad[o]|=1.5e-05  |ddm|=4.51e-05  |maxRot[o]|=6.85e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4623146616921  dE = -8.7723606e-11  S^2 = 0.0000000
               |grad[o]|=4.32e-06  |ddm|=1.31e-05  |maxRot[o]|=1.93e-05
2-step CASSCF converged in 12 macro (48 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9562916  1.9350335  1.86223013 1.69240306 0.06476757 0.312595
 0.05599298 0.12068616]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01220   0.01062  -0.00217   0.00000   0.00000
  0 C 2s       0.69087   0.67520  -0.14918  -0.00000   0.00000
  0 C 3s       0.00130   0.01496  -0.02972  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69367
  0 C 2py      0.00000  -0.00000  -0.00000   0.70446   0.00000
  0 C 2pz      0.14914  -0.20886   0.68947  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06711
  0 C 3py      0.00000  -0.00000  -0.00000   0.05509  -0.00000
  0 C 3pz     -0.01004  -0.00168   0.01737  -0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02654   0.00000
  0 C 3dz^2    0.01444  -0.01051   0.03370  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.11966
 0 C 3dx2-y2   0.00150   0.00603  -0.00686  -0.00000  -0.00000
  1 C 1s       0.01220  -0.01062  -0.00217   0.00000   0.00000
  1 C 2s       0.69087  -0.67520  -0.14918   0.00000  -0.00000
  1 C 3s       0.00130  -0.01496  -0.02972   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69367
  1 C 2py     -0.00000   0.00000   0.00000   0.70446  -0.00000
  1 C 2pz     -0.14914  -0.20886  -0.68947   0.00000   0.00000
  1 C 3px     -0.00000  -0.00000   0.00000   0.00000  -0.06711
  1 C 3py     -0.00000   0.00000   0.00000   0.05509  -0.00000
  1 C 3pz      0.01004  -0.00168  -0.01737  -0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02654   0.00000
  1 C 3dz^2    0.01444   0.01051   0.03370   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11966
 1 C 3dx2-y2   0.00150  -0.00603  -0.00686  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s      -0.00000   0.00000   0.20816
  0 C 3s      -0.00000   0.00000   0.02837
  0 C 2px     -0.00000   0.69855   0.00000
  0 C 2py      0.70705  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67455
  0 C 3px     -0.00000  -0.01822   0.00000
  0 C 3py     -0.00084  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.02485
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00885  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00357
  0 C 3dxz    -0.00000  -0.10813  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01462
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000   0.00000  -0.20816
  1 C 3s       0.00000  -0.00000  -0.02837
  1 C 2px      0.00000  -0.69855  -0.00000
  1 C 2py     -0.70705   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.67455
  1 C 3px      0.00000   0.01822  -0.00000
  1 C 3py      0.00084   0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.02485
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00885  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00357
  1 C 3dxz    -0.00000  -0.10813   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01462
<CAS-nat-orb|mo-hf>  3  3    0.99826978
<CAS-nat-orb|mo-hf>  4  4    0.99964484
<CAS-nat-orb|mo-hf>  5  5    0.99825063
<CAS-nat-orb|mo-hf>  6  6    0.99862457
<CAS-nat-orb|mo-hf>  7  7    0.93325604
<CAS-nat-orb|mo-hf>  8  8    0.98517025
<CAS-nat-orb|mo-hf>  9  9    0.96077010
<CAS-nat-orb|mo-hf>  10  10    0.95215926
CASSCF energy = -75.4623146616921
CASCI E = -75.4623146616921  E(CI) = -14.9567871966137  S^2 = 0.0000000
Density matrix diagonal elements [1.95629204 1.93503426 1.8622311  1.69240341 0.06476555 0.31259506
 0.05599277 0.12068582]
i = 1  <i|F|i> = -11.34545482
i = 2  <i|F|i> = -11.34582863
i = 3  <i|F|i> =  -0.80792134
i = 4  <i|F|i> =  -0.63844329
i = 5  <i|F|i> =  -0.34064106
i = 6  <i|F|i> =  -0.26679581
i = 7  <i|F|i> =   0.10917251
i = 8  <i|F|i> =   0.01522116
i = 9  <i|F|i> =   0.17507227
i = 10  <i|F|i> =   0.22156804
i = 11  <i|F|i> =   0.61845488
i = 12  <i|F|i> =   0.68635897
i = 13  <i|F|i> =   0.63015304
i = 14  <i|F|i> =   0.71922927
i = 15  <i|F|i> =   0.72527967
i = 16  <i|F|i> =   0.71836544
i = 17  <i|F|i> =   0.79880834
i = 18  <i|F|i> =   1.00111208
i = 19  <i|F|i> =   1.19749746
i = 20  <i|F|i> =   1.24022130
i = 21  <i|F|i> =   1.35706229
i = 22  <i|F|i> =   1.35787538
i = 23  <i|F|i> =   1.38325198
i = 24  <i|F|i> =   1.43761966
i = 25  <i|F|i> =   1.43705190
i = 26  <i|F|i> =   1.62304408
i = 27  <i|F|i> =   1.67947128
i = 28  <i|F|i> =   2.10612955
......production of RDMs took       2.32 sec
......reading the RDM took          0.41 sec
......production of RDMs took      64.33 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.77 sec

E(WickICNEVPT2-ijrs) =    -0.00029671296155
E(WickICNEVPT2- rsi) =    -0.00081926376230
E(WickICNEVPT2- ijr) =    -0.00026074334770
E(WickICNEVPT2-  rs) =    -0.03305395495603
E(WickICNEVPT2-  ij) =    -0.00005755101304
E(WickICNEVPT2-  ir) =    -0.00099269733931
E(WickICNEVPT2-   r) =    -0.06081922345817
E(WickICNEVPT2-   i) =    -0.00005208976121
E(WickICNEVPT2) = -75.55866689829141  E_corr_pt = -0.09635223659929958
Timings = pdms =   76.82 | eris =    0.01 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.24 | ij =    0.07 | ir =    0.15 | r =    1.71 | i =    0.69 | total =   79.73
Time cost =    282.824
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:02:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.037332262042 AA    0.000000000000   0.000000000000   3.850000000000 Bohr   0.0

nuclear repulsion = 9.35064935064935
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7123.87


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp64prwe0s
max_memory 4000 MB (current use 322 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6842509501291

WARN: Singularity detected in overlap matrix (condition number = 66.5). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0962332913313834  LUMO (B3u) = -0.096233291331383

WARN: B2u HOMO -0.0962332913313834 > system LUMO -0.096233291331383

cycle= 1 E= -75.241333020414  delta_E= -0.557  |g|= 0.231  |ddm|= 1.46
HOMO (B2u) = -0.349057007799766  LUMO (B3u) = -0.0466518414985271
cycle= 2 E= -75.2629125920112  delta_E= -0.0216  |g|= 0.0454  |ddm|= 0.348
HOMO (B2u) = -0.316770424633126  LUMO (B3u) = -0.00980180087757344
cycle= 3 E= -75.2641493459228  delta_E= -0.00124  |g|= 0.0169  |ddm|= 0.0593
HOMO (B2u) = -0.321075514288455  LUMO (B3u) = -0.0139142694602825
cycle= 4 E= -75.2643552043107  delta_E= -0.000206  |g|= 0.000645  |ddm|= 0.0339
HOMO (B2u) = -0.321213308623815  LUMO (B3u) = -0.0141930697532578
cycle= 5 E= -75.2643553636796  delta_E= -1.59e-07  |g|= 0.000131  |ddm|= 0.00083
HOMO (B2u) = -0.321177935176442  LUMO (B3u) = -0.0141663723644064
cycle= 6 E= -75.2643553735705  delta_E= -9.89e-09  |g|= 1.94e-05  |ddm|= 0.000225
HOMO (B2u) = -0.321175177873371  LUMO (B3u) = -0.0141664898415902
cycle= 7 E= -75.2643553738138  delta_E= -2.43e-10  |g|= 1.96e-06  |ddm|= 3.98e-05
HOMO (B2u) = -0.321174743989129  LUMO (B3u) = -0.0141665118435176
cycle= 8 E= -75.2643553738163  delta_E= -2.44e-12  |g|= 1.29e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.321174751334189  LUMO (B3u) = -0.0141665127831208
cycle= 9 E= -75.2643553738164  delta_E= -8.53e-14  |g|= 8.24e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.321174750584463  LUMO (B3u) = -0.0141665142885408
cycle= 10 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 7.1e-09  |ddm|= 7e-09
HOMO (B2u) = -0.321174750648579  LUMO (B3u) = -0.0141665144470684
cycle= 11 E= -75.2643553738163  delta_E=    0  |g|= 5.05e-09  |ddm|= 5.81e-09
HOMO (B2u) = -0.321174749546645  LUMO (B3u) = -0.0141665133016706
cycle= 12 E= -75.2643553738163  delta_E= 1.42e-14  |g|= 4.29e-09  |ddm|= 2.98e-09
HOMO (B2u) = -0.321174749705825  LUMO (B3u) = -0.0141665134763572
cycle= 13 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 3.84e-09  |ddm|= 1.6e-09
HOMO (B2u) = -0.321174749276154  LUMO (B3u) = -0.0141665132807802
cycle= 14 E= -75.2643553738164  delta_E= -1.14e-13  |g|= 8.47e-10  |ddm|= 7.27e-09
HOMO (B2u) = -0.321174749384486  LUMO (B3u) = -0.0141665133176394
cycle= 15 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 8.86e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.321174749309358  LUMO (B3u) = -0.0141665133033331
cycle= 16 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 8.1e-10  |ddm|= 1.02e-09
HOMO (B2u) = -0.321174749333901  LUMO (B3u) = -0.0141665132831696
cycle= 17 E= -75.2643553738163  delta_E= -2.84e-14  |g|= 9.48e-10  |ddm|= 1.05e-09
HOMO (B2u) = -0.321174749300702  LUMO (B3u) = -0.0141665132664564
cycle= 18 E= -75.2643553738163  delta_E= 1.42e-14  |g|= 7.18e-10  |ddm|= 5.96e-10
HOMO (B2u) = -0.321174749296146  LUMO (B3u) = -0.0141665132754695
cycle= 19 E= -75.2643553738163  delta_E= 1.42e-14  |g|= 5.51e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.32117474929622  LUMO (B3u) = -0.0141665132863726
cycle= 20 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 4.33e-10  |ddm|= 3.86e-10
HOMO (B2u) = -0.321174749283256  LUMO (B3u) = -0.0141665132819952
cycle= 21 E= -75.2643553738163  delta_E= -2.84e-14  |g|= 3.15e-10  |ddm|= 3.17e-10
HOMO (B2u) = -0.321174749272411  LUMO (B3u) = -0.0141665132798474
cycle= 22 E= -75.2643553738163  delta_E= 7.11e-14  |g|= 2.04e-10  |ddm|= 2.88e-10
HOMO (B2u) = -0.321174749269944  LUMO (B3u) = -0.0141665132773788
cycle= 23 E= -75.2643553738163  delta_E= -2.84e-14  |g|= 1.81e-10  |ddm|= 6.27e-11
HOMO (B2u) = -0.321174749264041  LUMO (B3u) = -0.0141665132745909
cycle= 24 E= -75.2643553738163  delta_E= 1.42e-14  |g|= 1.54e-10  |ddm|= 6.81e-11
HOMO (B2u) = -0.321174749261197  LUMO (B3u) = -0.0141665132723479
cycle= 25 E= -75.2643553738162  delta_E= 8.53e-14  |g|= 1.29e-10  |ddm|= 6.16e-11
HOMO (B2u) = -0.32117474925726  LUMO (B3u) = -0.0141665132707104
cycle= 26 E= -75.2643553738164  delta_E= -1.56e-13  |g|= 1.01e-10  |ddm|= 7.86e-11
HOMO (B2u) = -0.321174749254288  LUMO (B3u) = -0.0141665132694628
cycle= 27 E= -75.2643553738163  delta_E= 5.68e-14  |g|= 8.15e-11  |ddm|= 6e-11
HOMO (B2u) = -0.321174749251874  LUMO (B3u) = -0.0141665132683623
cycle= 28 E= -75.2643553738163  delta_E=    0  |g|= 6.49e-11  |ddm|= 4.52e-11
HOMO (B2u) = -0.321174749246106  LUMO (B3u) = -0.0141665132656036
Extra cycle  E= -75.2643553738163  delta_E=    0  |g|= 2.26e-11  |ddm|= 1.06e-10
converged SCF energy = -75.2643553738163

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp64prwe0s
max_memory 4000 MB (current use 322 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4176796778923  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4350360693868  dE = -0.017356391  S^2 = 0.0000000
               |grad[o]|=0.106  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4474226987165  dE = -0.012386629  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.117  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.454478805779  dE = -0.0070561071  S^2 = 0.0000000
               |grad[o]|=0.0502  |ddm|=0.0257  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4570100429391  dE = -0.0025312372  S^2 = 0.0000000
               |grad[o]|=0.0225  |ddm|= 0.11  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4582120424494  dE = -0.0012019995  S^2 = 0.0000000
               |grad[o]|=0.0117  |ddm|=0.0293  |maxRot[o]|=0.0599
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4583431399107  dE = -0.00013109746  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.013  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4583762943588  dE = -3.3154448e-05  S^2 = 0.0000000
               |grad[o]|=0.00212  |ddm|=0.00331  |maxRot[o]|=0.0127
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4583790907345  dE = -2.7963757e-06  S^2 = 0.0000000
               |grad[o]|=0.000733  |ddm|=0.00214  |maxRot[o]|=0.00372
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4583793249554  dE = -2.3422092e-07  S^2 = 0.0000000
               |grad[o]|=0.000228  |ddm|=0.000666  |maxRot[o]|=0.00107
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4583793444848  dE = -1.9529438e-08  S^2 = 0.0000000
               |grad[o]|=6.8e-05  |ddm|=0.0002  |maxRot[o]|=0.000307
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4583793461193  dE = -1.6344757e-09  S^2 = 0.0000000
               |grad[o]|=2e-05  |ddm|=5.91e-05  |maxRot[o]|=8.82e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4583793462597  dE = -1.4043167e-10  S^2 = 0.0000000
               |grad[o]|=5.87e-06  |ddm|=1.72e-05  |maxRot[o]|=2.55e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4583793462634  dE = -3.6521897e-12  S^2 = 0.0000000
               |grad[o]|=1.7e-06  |ddm|=4.77e-06  |maxRot[o]|=7.43e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95597942 1.93565101 1.85505357 1.67538719 0.06382152 0.32940982
 0.05567107 0.12902641]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01228   0.01069  -0.00190   0.00000   0.00000
  0 C 2s       0.69385   0.67734  -0.13470  -0.00000  -0.00000
  0 C 3s       0.00257   0.01477  -0.02786  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69376
  0 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  0 C 2pz      0.13475  -0.20184   0.69251   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06778
  0 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  0 C 3pz     -0.00941  -0.00168   0.01906  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02538  -0.00000
  0 C 3dz^2    0.01317  -0.01016   0.03314  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.11878
 0 C 3dx2-y2   0.00169   0.00594  -0.00676   0.00000  -0.00000
  1 C 1s       0.01228  -0.01069  -0.00190   0.00000   0.00000
  1 C 2s       0.69385  -0.67734  -0.13470   0.00000  -0.00000
  1 C 3s       0.00257  -0.01477  -0.02786  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69376
  1 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  1 C 2pz     -0.13475  -0.20184  -0.69251  -0.00000  -0.00000
  1 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06778
  1 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  1 C 3pz      0.00941  -0.00168  -0.01906   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.02538   0.00000
  1 C 3dz^2    0.01317   0.01016   0.03314  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11878
 1 C 3dx2-y2   0.00169  -0.00594  -0.00676  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.20120
  0 C 3s      -0.00000  -0.00000   0.02738
  0 C 2px     -0.00000   0.69868  -0.00000
  0 C 2py      0.70706  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.67682
  0 C 3px     -0.00000  -0.01985  -0.00000
  0 C 3py      0.00101  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02216
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00847   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00304
  0 C 3dxz    -0.00000  -0.10700  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01365
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s       0.00000   0.00000  -0.20120
  1 C 3s       0.00000   0.00000  -0.02738
  1 C 2px      0.00000  -0.69868   0.00000
  1 C 2py     -0.70706   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67682
  1 C 3px      0.00000   0.01985   0.00000
  1 C 3py     -0.00101   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02216
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00847  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00304
  1 C 3dxz    -0.00000  -0.10700  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01365
<CAS-nat-orb|mo-hf>  3  3    0.99758995
<CAS-nat-orb|mo-hf>  4  4    0.99962978
<CAS-nat-orb|mo-hf>  5  5    0.99755853
<CAS-nat-orb|mo-hf>  6  6    0.99855438
<CAS-nat-orb|mo-hf>  7  7    0.93305005
<CAS-nat-orb|mo-hf>  8  8    0.98603349
<CAS-nat-orb|mo-hf>  9  9    0.96086979
<CAS-nat-orb|mo-hf>  10  10    0.95616481
CASSCF energy = -75.4583793462634
CASCI E = -75.4583793462634  E(CI) = -14.8982403377176  S^2 = 0.0000000
Density matrix diagonal elements [1.95597961 1.93565121 1.8550537  1.67538705 0.06382106 0.32940997
 0.05567109 0.1290263 ]
i = 1  <i|F|i> = -11.34528046
i = 2  <i|F|i> = -11.34566036
i = 3  <i|F|i> =  -0.80194431
i = 4  <i|F|i> =  -0.64074484
i = 5  <i|F|i> =  -0.33703231
i = 6  <i|F|i> =  -0.26168607
i = 7  <i|F|i> =   0.11110101
i = 8  <i|F|i> =   0.00940969
i = 9  <i|F|i> =   0.17323408
i = 10  <i|F|i> =   0.20873165
i = 11  <i|F|i> =   0.62234970
i = 12  <i|F|i> =   0.68521751
i = 13  <i|F|i> =   0.62828852
i = 14  <i|F|i> =   0.71985997
i = 15  <i|F|i> =   0.72636668
i = 16  <i|F|i> =   0.71821846
i = 17  <i|F|i> =   0.80472150
i = 18  <i|F|i> =   0.99841064
i = 19  <i|F|i> =   1.20516013
i = 20  <i|F|i> =   1.24637463
i = 21  <i|F|i> =   1.35859832
i = 22  <i|F|i> =   1.36133099
i = 23  <i|F|i> =   1.36789144
i = 24  <i|F|i> =   1.43509904
i = 25  <i|F|i> =   1.43459349
i = 26  <i|F|i> =   1.61090865
i = 27  <i|F|i> =   1.66620113
i = 28  <i|F|i> =   2.09645904
......production of RDMs took       2.55 sec
......reading the RDM took          0.42 sec
......production of RDMs took      38.56 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICNEVPT2-ijrs) =    -0.00029859720898
E(WickICNEVPT2- rsi) =    -0.00082299512853
E(WickICNEVPT2- ijr) =    -0.00025925246936
E(WickICNEVPT2-  rs) =    -0.03292782958735
E(WickICNEVPT2-  ij) =    -0.00005601838397
E(WickICNEVPT2-  ir) =    -0.00098906764297
E(WickICNEVPT2-   r) =    -0.06105143571940
E(WickICNEVPT2-   i) =    -0.00004971952196
E(WickICNEVPT2) = -75.55483426192592  E_corr_pt = -0.09645491566253445
Timings = pdms =   51.28 | eris =    0.20 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.23 | ij =    0.07 | ir =    0.15 | r =    1.76 | i =    0.70 | total =   54.43
Time cost =    239.012
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:06:52 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.063791122588 AA    0.000000000000   0.000000000000   3.900000000000 Bohr   0.0

nuclear repulsion = 9.23076923076923
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7252.47


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpcha_i1hv
max_memory 4000 MB (current use 324 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6749703835052

WARN: Singularity detected in overlap matrix (condition number = 62.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0938346227346636  LUMO (B3u) = -0.0938346227346639

WARN: B2u HOMO -0.0938346227346636 > system LUMO -0.0938346227346639

cycle= 1 E= -75.2338921256662  delta_E= -0.559  |g|= 0.229  |ddm|= 1.46
HOMO (B2u) = -0.345853796512397  LUMO (B3u) = -0.0447783510681939
cycle= 2 E= -75.2552221736389  delta_E= -0.0213  |g|= 0.0449  |ddm|= 0.347
HOMO (B2u) = -0.313968969330059  LUMO (B3u) = -0.00834890411120143
cycle= 3 E= -75.2564345511741  delta_E= -0.00121  |g|= 0.0167  |ddm|= 0.0585
HOMO (B2u) = -0.318244577067682  LUMO (B3u) = -0.0124246975036482
cycle= 4 E= -75.256637209921  delta_E= -0.000203  |g|= 0.000641  |ddm|= 0.0335
HOMO (B2u) = -0.318367270990411  LUMO (B3u) = -0.0126861477138984
cycle= 5 E= -75.2566373684186  delta_E= -1.58e-07  |g|= 0.000132  |ddm|= 0.000824
HOMO (B2u) = -0.318332550664858  LUMO (B3u) = -0.0126605067829992
cycle= 6 E= -75.2566373785487  delta_E= -1.01e-08  |g|= 1.96e-05  |ddm|= 0.000227
HOMO (B2u) = -0.318329772186369  LUMO (B3u) = -0.0126605767315271
cycle= 7 E= -75.2566373787974  delta_E= -2.49e-10  |g|= 1.98e-06  |ddm|= 4.01e-05
HOMO (B2u) = -0.318329352566606  LUMO (B3u) = -0.0126606192769649
cycle= 8 E= -75.2566373788  delta_E= -2.59e-12  |g|= 1.29e-07  |ddm|= 4.15e-06
HOMO (B2u) = -0.318329361478953  LUMO (B3u) = -0.0126606212717556
cycle= 9 E= -75.2566373788  delta_E= 5.68e-14  |g|= 7.84e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.318329360674807  LUMO (B3u) = -0.0126606228015449
cycle= 10 E= -75.2566373788  delta_E=    0  |g|= 6.91e-09  |ddm|= 6.79e-09
HOMO (B2u) = -0.31832936080774  LUMO (B3u) = -0.0126606230323529
cycle= 11 E= -75.2566373788  delta_E= -8.53e-14  |g|= 4.88e-09  |ddm|= 5.64e-09
HOMO (B2u) = -0.318329359796677  LUMO (B3u) = -0.0126606219766828
cycle= 12 E= -75.2566373788  delta_E= 5.68e-14  |g|= 4.15e-09  |ddm|= 2.92e-09
HOMO (B2u) = -0.318329359932234  LUMO (B3u) = -0.0126606221275439
cycle= 13 E= -75.2566373788  delta_E= 2.84e-14  |g|= 3.71e-09  |ddm|= 1.53e-09
HOMO (B2u) = -0.318329359524993  LUMO (B3u) = -0.0126606219552217
cycle= 14 E= -75.2566373788  delta_E= -2.84e-14  |g|= 7.6e-10  |ddm|= 7.09e-09
HOMO (B2u) = -0.318329359627892  LUMO (B3u) = -0.0126606219881924
cycle= 15 E= -75.2566373788  delta_E=    0  |g|= 8.15e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.318329359568647  LUMO (B3u) = -0.0126606219724629
cycle= 16 E= -75.2566373788  delta_E= 2.84e-14  |g|= 7.74e-10  |ddm|= 9.25e-10
HOMO (B2u) = -0.318329359584869  LUMO (B3u) = -0.0126606219558293
cycle= 17 E= -75.2566373788  delta_E=    0  |g|= 8.85e-10  |ddm|= 7.84e-10
HOMO (B2u) = -0.31832935955474  LUMO (B3u) = -0.0126606219417636
cycle= 18 E= -75.2566373788  delta_E= -8.53e-14  |g|= 6.72e-10  |ddm|= 5.38e-10
HOMO (B2u) = -0.318329359552157  LUMO (B3u) = -0.0126606219522098
cycle= 19 E= -75.2566373788  delta_E= 5.68e-14  |g|= 5.15e-10  |ddm|= 5.27e-10
HOMO (B2u) = -0.31832935955399  LUMO (B3u) = -0.0126606219644208
cycle= 20 E= -75.2566373788  delta_E= 2.84e-14  |g|= 4.03e-10  |ddm|= 3.62e-10
HOMO (B2u) = -0.318329359543138  LUMO (B3u) = -0.0126606219620566
cycle= 21 E= -75.2566373788  delta_E= -2.84e-14  |g|= 2.92e-10  |ddm|= 2.94e-10
HOMO (B2u) = -0.318329359533937  LUMO (B3u) = -0.0126606219613679
cycle= 22 E= -75.2566373788  delta_E= 2.84e-14  |g|= 1.87e-10  |ddm|= 2.67e-10
HOMO (B2u) = -0.318329359531883  LUMO (B3u) = -0.0126606219590888
cycle= 23 E= -75.2566373787999  delta_E= 2.84e-14  |g|= 1.66e-10  |ddm|= 5.47e-11
HOMO (B2u) = -0.318329359526669  LUMO (B3u) = -0.01266062195664
cycle= 24 E= -75.2566373788  delta_E= -2.84e-14  |g|= 1.42e-10  |ddm|= 6.17e-11
HOMO (B2u) = -0.318329359523906  LUMO (B3u) = -0.0126606219548226
cycle= 25 E= -75.2566373788  delta_E= -5.68e-14  |g|= 1.18e-10  |ddm|= 5.78e-11
HOMO (B2u) = -0.318329359520452  LUMO (B3u) = -0.0126606219535824
cycle= 26 E= -75.2566373788  delta_E= 5.68e-14  |g|= 9.25e-11  |ddm|= 7.13e-11
HOMO (B2u) = -0.318329359517864  LUMO (B3u) = -0.0126606219526469
cycle= 27 E= -75.2566373788  delta_E=    0  |g|= 7.46e-11  |ddm|= 5.48e-11
HOMO (B2u) = -0.318329359511255  LUMO (B3u) = -0.0126606219498089
Extra cycle  E= -75.2566373788  delta_E= -5.68e-14  |g|= 2.54e-11  |ddm|= 1.24e-10
converged SCF energy = -75.2566373788

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpcha_i1hv
max_memory 4000 MB (current use 324 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4143148843353  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.432208931242  dE = -0.017894047  S^2 = 0.0000000
               |grad[o]|=0.108  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4446390101756  dE = -0.012430079  S^2 = 0.0000000
               |grad[o]|=0.0797  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4513833169327  dE = -0.0067443068  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.0218  |maxRot[o]|=0.0798
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4535226116705  dE = -0.0021392947  S^2 = 0.0000000
               |grad[o]|=0.0191  |ddm|=0.109  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4543051713637  dE = -0.00078255969  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0227  |maxRot[o]|= 0.04
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4545713698987  dE = -0.00026619854  S^2 = 0.0000000
               |grad[o]|=0.00524  |ddm|=0.00808  |maxRot[o]|=0.0333
macro iter 7 (3 JK  0 micro), CASSCF E = -75.454594923569  dE = -2.355367e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00574  |maxRot[o]|=0.0107
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4545969674346  dE = -2.0438657e-06  S^2 = 0.0000000
               |grad[o]|=0.000657  |ddm|=0.00185  |maxRot[o]|=0.00315
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4545971430655  dE = -1.7563084e-07  S^2 = 0.0000000
               |grad[o]|=0.000203  |ddm|=0.000583  |maxRot[o]|=0.000913
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4545971581098  dE = -1.5044293e-08  S^2 = 0.0000000
               |grad[o]|=6.12e-05  |ddm|=0.000176  |maxRot[o]|=0.000266
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4545971593833  dE = -1.27352e-09  S^2 = 0.0000000
               |grad[o]|=1.83e-05  |ddm|=5.27e-05  |maxRot[o]|=7.71e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4545971594909  dE = -1.0763301e-10  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=1.57e-05  |maxRot[o]|=2.24e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4545971594996  dE = -8.6401997e-12  S^2 = 0.0000000
               |grad[o]|=1.57e-06  |ddm|=4.58e-06  |maxRot[o]|=6.58e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95573076 1.93626698 1.84718162 1.65763445 0.06292257 0.34695114
 0.05534507 0.13796741]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01234   0.01075  -0.00166   0.00000   0.00000
  0 C 2s       0.69629   0.67936  -0.12152  -0.00000  -0.00000
  0 C 3s       0.00370   0.01459  -0.02605   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69387
  0 C 2py     -0.00000   0.00000   0.00000   0.70453  -0.00000
  0 C 2pz      0.12164  -0.19495   0.69500  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06838
  0 C 3py     -0.00000   0.00000  -0.00000   0.05527   0.00000
  0 C 3pz     -0.00884  -0.00169   0.02073   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02424   0.00000
  0 C 3dz^2    0.01200  -0.00982   0.03250   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.11777
 0 C 3dx2-y2   0.00188   0.00585  -0.00666  -0.00000  -0.00000
  1 C 1s       0.01234  -0.01075  -0.00166   0.00000   0.00000
  1 C 2s       0.69629  -0.67936  -0.12152  -0.00000   0.00000
  1 C 3s       0.00370  -0.01459  -0.02605  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69387
  1 C 2py      0.00000  -0.00000   0.00000   0.70453  -0.00000
  1 C 2pz     -0.12164  -0.19495  -0.69500  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06838
  1 C 3py      0.00000  -0.00000  -0.00000   0.05527   0.00000
  1 C 3pz      0.00884  -0.00169  -0.02073   0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.02424  -0.00000
  1 C 3dz^2    0.01200   0.00982   0.03250  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.11777
 1 C 3dx2-y2   0.00188  -0.00585  -0.00666   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00021
  0 C 2s      -0.00000  -0.00000   0.19437
  0 C 3s       0.00000  -0.00000   0.02640
  0 C 2px     -0.00000   0.69881  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.67895
  0 C 3px      0.00000  -0.02144   0.00000
  0 C 3py      0.00283  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01949
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00809  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00255
  0 C 3dxz     0.00000  -0.10583   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01271
  1 C 1s       0.00000   0.00000   0.00021
  1 C 2s      -0.00000   0.00000  -0.19437
  1 C 3s       0.00000   0.00000  -0.02640
  1 C 2px     -0.00000  -0.69881  -0.00000
  1 C 2py     -0.70705  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67895
  1 C 3px      0.00000   0.02144   0.00000
  1 C 3py     -0.00283  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01949
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00809  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00255
  1 C 3dxz    -0.00000  -0.10583  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.01271
<CAS-nat-orb|mo-hf>  3  3    0.99692136
<CAS-nat-orb|mo-hf>  4  4    0.99961325
<CAS-nat-orb|mo-hf>  5  5    0.99687558
<CAS-nat-orb|mo-hf>  6  6    0.99848189
<CAS-nat-orb|mo-hf>  7  7    0.93292275
<CAS-nat-orb|mo-hf>  8  8    0.98684296
<CAS-nat-orb|mo-hf>  9  9    0.96096128
<CAS-nat-orb|mo-hf>  10  10    0.95978892
CASSCF energy = -75.4545971594996
CASCI E = -75.4545971594996  E(CI) = -14.8412429814246  S^2 = 0.0000000
Density matrix diagonal elements [1.95573092 1.93626737 1.84718142 1.65763442 0.06292248 0.34695117
 0.05534504 0.13796719]
i = 1  <i|F|i> = -11.34499658
i = 2  <i|F|i> = -11.34538087
i = 3  <i|F|i> =  -0.79618173
i = 4  <i|F|i> =  -0.64294962
i = 5  <i|F|i> =  -0.33334099
i = 6  <i|F|i> =  -0.25660193
i = 7  <i|F|i> =   0.11288496
i = 8  <i|F|i> =   0.00373200
i = 9  <i|F|i> =   0.17148989
i = 10  <i|F|i> =   0.19641221
i = 11  <i|F|i> =   0.62618351
i = 12  <i|F|i> =   0.68402806
i = 13  <i|F|i> =   0.62652807
i = 14  <i|F|i> =   0.72045084
i = 15  <i|F|i> =   0.72742572
i = 16  <i|F|i> =   0.71808328
i = 17  <i|F|i> =   0.81023243
i = 18  <i|F|i> =   0.99586607
i = 19  <i|F|i> =   1.21304155
i = 20  <i|F|i> =   1.25281309
i = 21  <i|F|i> =   1.34827189
i = 22  <i|F|i> =   1.36462446
i = 23  <i|F|i> =   1.36556723
i = 24  <i|F|i> =   1.43276136
i = 25  <i|F|i> =   1.43231199
i = 26  <i|F|i> =   1.59916908
i = 27  <i|F|i> =   1.65329712
i = 28  <i|F|i> =   2.08565739
......production of RDMs took       1.89 sec
......reading the RDM took          0.42 sec
......production of RDMs took      84.16 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.76 sec

E(WickICNEVPT2-ijrs) =    -0.00030051284536
E(WickICNEVPT2- rsi) =    -0.00082691471099
E(WickICNEVPT2- ijr) =    -0.00025779460814
E(WickICNEVPT2-  rs) =    -0.03281131729018
E(WickICNEVPT2-  ij) =    -0.00005457851658
E(WickICNEVPT2-  ir) =    -0.00098580828738
E(WickICNEVPT2-   r) =    -0.06125930478208
E(WickICNEVPT2-   i) =    -0.00004746378191
E(WickICNEVPT2) = -75.55114085432218  E_corr_pt = -0.09654369482261328
Timings = pdms =   96.22 | eris =    0.13 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.41 | ij =    0.07 | ir =    0.15 | r =    1.84 | i =    0.84 | total =   99.72
Time cost =    172.216
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:09:44 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.090249983134 AA    0.000000000000   0.000000000000   3.950000000000 Bohr   0.0

nuclear repulsion = 9.11392405063291
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7442.96


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpeph5lsh6
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6663316753772

WARN: Singularity detected in overlap matrix (condition number = 58.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0915415140147808  LUMO (B3u) = -0.0915415140147811

WARN: B2u HOMO -0.0915415140147808 > system LUMO -0.0915415140147811

cycle= 1 E= -75.2265361682301  delta_E= -0.56  |g|= 0.228  |ddm|= 1.46
HOMO (B2u) = -0.342768719019989  LUMO (B3u) = -0.0429835717594447
cycle= 2 E= -75.2476350005993  delta_E= -0.0211  |g|= 0.0444  |ddm|= 0.347
HOMO (B2u) = -0.311266865337974  LUMO (B3u) = -0.00695392831511016
cycle= 3 E= -75.2488230162567  delta_E= -0.00119  |g|= 0.0166  |ddm|= 0.0577
HOMO (B2u) = -0.315511002797547  LUMO (B3u) = -0.0109908406189058
cycle= 4 E= -75.24902239302  delta_E= -0.000199  |g|= 0.000637  |ddm|= 0.0332
HOMO (B2u) = -0.315616573066829  LUMO (B3u) = -0.0112327274277411
cycle= 5 E= -75.2490225504907  delta_E= -1.57e-07  |g|= 0.000134  |ddm|= 0.000817
HOMO (B2u) = -0.315582567140402  LUMO (B3u) = -0.0112081163367543
cycle= 6 E= -75.2490225608019  delta_E= -1.03e-08  |g|= 1.98e-05  |ddm|= 0.000228
HOMO (B2u) = -0.315579772310319  LUMO (B3u) = -0.0112081376157159
cycle= 7 E= -75.2490225610551  delta_E= -2.53e-10  |g|= 2e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.315579365287553  LUMO (B3u) = -0.0112081994129437
cycle= 8 E= -75.2490225610576  delta_E= -2.53e-12  |g|= 1.29e-07  |ddm|= 4.21e-06
HOMO (B2u) = -0.315579376014097  LUMO (B3u) = -0.0112082026369361
cycle= 9 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 7.39e-09  |ddm|= 3.13e-07
HOMO (B2u) = -0.315579375155019  LUMO (B3u) = -0.0112082041927768
cycle= 10 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 6.7e-09  |ddm|= 6.7e-09
HOMO (B2u) = -0.315579375373773  LUMO (B3u) = -0.0112082045131865
cycle= 11 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 4.69e-09  |ddm|= 5.44e-09
HOMO (B2u) = -0.315579374456204  LUMO (B3u) = -0.011208203552118
cycle= 12 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 3.99e-09  |ddm|= 2.86e-09
HOMO (B2u) = -0.315579374574283  LUMO (B3u) = -0.0112082036830294
cycle= 13 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 3.57e-09  |ddm|= 1.42e-09
HOMO (B2u) = -0.315579374205116  LUMO (B3u) = -0.0112082035350247
cycle= 14 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 7.08e-10  |ddm|= 6.55e-09
HOMO (B2u) = -0.315579374303743  LUMO (B3u) = -0.0112082035701839
cycle= 15 E= -75.2490225610576  delta_E=    0  |g|= 7.47e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.315579374231878  LUMO (B3u) = -0.0112082035635681
cycle= 16 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 6.5e-10  |ddm|= 8.6e-10
HOMO (B2u) = -0.315579374257371  LUMO (B3u) = -0.0112082035350009
cycle= 17 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 8.08e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.315579374230836  LUMO (B3u) = -0.0112082035236459
cycle= 18 E= -75.2490225610576  delta_E=    0  |g|= 6.14e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.315579374230564  LUMO (B3u) = -0.0112082035356646
cycle= 19 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 4.68e-10  |ddm|= 4.88e-10
HOMO (B2u) = -0.315579374234531  LUMO (B3u) = -0.0112082035493846
cycle= 20 E= -75.2490225610576  delta_E=    0  |g|= 3.68e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.315579374226203  LUMO (B3u) = -0.01120820354919
cycle= 21 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 2.65e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.315579374219017  LUMO (B3u) = -0.0112082035501594
cycle= 22 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 1.68e-10  |ddm|= 2.4e-10
HOMO (B2u) = -0.31557937421721  LUMO (B3u) = -0.011208203548263
cycle= 23 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 1.48e-10  |ddm|= 4.95e-11
HOMO (B2u) = -0.315579374212328  LUMO (B3u) = -0.0112082035460615
cycle= 24 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 1.25e-10  |ddm|= 5.57e-11
HOMO (B2u) = -0.315579374210474  LUMO (B3u) = -0.0112082035442421
cycle= 25 E= -75.2490225610576  delta_E=    0  |g|= 1.06e-10  |ddm|= 4.69e-11
HOMO (B2u) = -0.315579374207618  LUMO (B3u) = -0.0112082035434462
cycle= 26 E= -75.2490225610575  delta_E= 5.68e-14  |g|= 8.31e-11  |ddm|= 6.16e-11
HOMO (B2u) = -0.315579374205497  LUMO (B3u) = -0.0112082035428539
cycle= 27 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 6.77e-11  |ddm|= 4.76e-11
HOMO (B2u) = -0.315579374203708  LUMO (B3u) = -0.011208203542224
cycle= 28 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 5.42e-11  |ddm|= 3.53e-11
HOMO (B2u) = -0.315579374202309  LUMO (B3u) = -0.0112082035417073
cycle= 29 E= -75.2490225610577  delta_E= -5.68e-14  |g|= 4.24e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.315579374201242  LUMO (B3u) = -0.0112082035412582
cycle= 30 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 3.36e-11  |ddm|= 2.02e-11
HOMO (B2u) = -0.315579374200562  LUMO (B3u) = -0.0112082035409267
cycle= 31 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 2.79e-11  |ddm|= 1.27e-11
HOMO (B2u) = -0.315579374199903  LUMO (B3u) = -0.0112082035406337
cycle= 32 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 2.29e-11  |ddm|= 1.13e-11
HOMO (B2u) = -0.315579374199401  LUMO (B3u) = -0.0112082035404009
cycle= 33 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 1.87e-11  |ddm|= 9.61e-12
HOMO (B2u) = -0.315579374198947  LUMO (B3u) = -0.0112082035402246
cycle= 34 E= -75.2490225610575  delta_E= 5.68e-14  |g|= 1.54e-11  |ddm|= 8.23e-12
HOMO (B2u) = -0.315579374198588  LUMO (B3u) = -0.011208203540075
cycle= 35 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 1.27e-11  |ddm|= 6.41e-12
HOMO (B2u) = -0.315579374198292  LUMO (B3u) = -0.011208203539938
cycle= 36 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 1.03e-11  |ddm|= 5.2e-12
HOMO (B2u) = -0.315579374198053  LUMO (B3u) = -0.0112082035398198
cycle= 37 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 8.41e-12  |ddm|= 4.17e-12
HOMO (B2u) = -0.315579374197866  LUMO (B3u) = -0.0112082035397238
cycle= 38 E= -75.2490225610575  delta_E= 1.14e-13  |g|= 6.9e-12  |ddm|= 3.26e-12
HOMO (B2u) = -0.315579374197717  LUMO (B3u) = -0.0112082035396462
cycle= 39 E= -75.2490225610576  delta_E= -8.53e-14  |g|= 5.7e-12  |ddm|= 2.57e-12
HOMO (B2u) = -0.315579374197592  LUMO (B3u) = -0.0112082035395825
cycle= 40 E= -75.2490225610576  delta_E=    0  |g|= 4.71e-12  |ddm|= 2.14e-12
HOMO (B2u) = -0.315579374197244  LUMO (B3u) = -0.0112082035393983
Extra cycle  E= -75.2490225610576  delta_E= 2.84e-14  |g|= 1.82e-12  |ddm|= 6.09e-12
converged SCF energy = -75.2490225610576

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpeph5lsh6
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4110790881549  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4295260725499  dE = -0.018446984  S^2 = 0.0000000
               |grad[o]|= 0.11  |ddm|= 3.74  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4419549870947  dE = -0.012428915  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.127  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4482968221781  dE = -0.0063418351  S^2 = 0.0000000
               |grad[o]|=0.0462  |ddm|=0.0237  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4501430171729  dE = -0.001846195  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.104  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4507876396908  dE = -0.00064462252  S^2 = 0.0000000
               |grad[o]|=0.00867  |ddm|=0.0182  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4509297658646  dE = -0.00014212617  S^2 = 0.0000000
               |grad[o]|=0.00428  |ddm|=0.00737  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4509686911441  dE = -3.8925279e-05  S^2 = 0.0000000
               |grad[o]|=0.00227  |ddm|=0.00337  |maxRot[o]|=0.0135
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4509721356549  dE = -3.4445108e-06  S^2 = 0.0000000
               |grad[o]|=0.000835  |ddm|=0.00232  |maxRot[o]|=0.00406
macro iter 9 (3 JK  0 micro), CASSCF E = -75.450972441234  dE = -3.0557912e-07  S^2 = 0.0000000
               |grad[o]|=0.000269  |ddm|=0.000751  |maxRot[o]|=0.0012
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4509724682703  dE = -2.703635e-08  S^2 = 0.0000000
               |grad[o]|=8.26e-05  |ddm|=0.000234  |maxRot[o]|=0.000351
macro iter 11 (2 JK  0 micro), CASSCF E = -75.45097247068  dE = -2.4096778e-09  S^2 = 0.0000000
               |grad[o]|=2.5e-05  |ddm|=7.12e-05  |maxRot[o]|=0.000104
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4509724708869  dE = -2.0692426e-10  S^2 = 0.0000000
               |grad[o]|=7.49e-06  |ddm|=2.18e-05  |maxRot[o]|=3.08e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4509724709118  dE = -2.4883207e-11  S^2 = 0.0000000
               |grad[o]|=2.29e-06  |ddm|=6.43e-06  |maxRot[o]|=8.97e-06
2-step CASSCF converged in 13 macro (48 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95553917 1.93688266 1.83858342 1.63915689 0.06206762 0.36520863
 0.05501491 0.1475467 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01239   0.01081  -0.00143   0.00000   0.00000
  0 C 2s       0.69827   0.68127  -0.10961  -0.00000   0.00000
  0 C 3s       0.00470   0.01443  -0.02431  -0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000   0.00000   0.69401
  0 C 2py     -0.00000  -0.00000  -0.00000   0.70457   0.00000
  0 C 2pz      0.10978  -0.18822   0.69702  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  0 C 3py     -0.00000   0.00000   0.00000   0.05523   0.00000
  0 C 3pz     -0.00833  -0.00170   0.02237  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02312   0.00000
  0 C 3dz^2    0.01091  -0.00949   0.03179  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000  -0.00000  -0.11663
 0 C 3dx2-y2   0.00204   0.00576  -0.00656   0.00000  -0.00000
  1 C 1s       0.01239  -0.01081  -0.00143   0.00000   0.00000
  1 C 2s       0.69827  -0.68127  -0.10961   0.00000  -0.00000
  1 C 3s       0.00470  -0.01443  -0.02431   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69401
  1 C 2py      0.00000  -0.00000   0.00000   0.70457  -0.00000
  1 C 2pz     -0.10978  -0.18822  -0.69702   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  1 C 3py      0.00000   0.00000   0.00000   0.05523   0.00000
  1 C 3pz      0.00833  -0.00170  -0.02237  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000  -0.02312  -0.00000
  1 C 3dz^2    0.01091   0.00949   0.03179   0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000   0.00000   0.11663
 1 C 3dx2-y2   0.00204  -0.00576  -0.00656   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s      -0.00000   0.00000   0.18769
  0 C 3s       0.00000  -0.00000   0.02542
  0 C 2px      0.00000   0.69895  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.68096
  0 C 3px      0.00000  -0.02298  -0.00000
  0 C 3py      0.00461   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01682
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00772   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00210
  0 C 3dxz     0.00000  -0.10461  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01180
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.18769
  1 C 3s       0.00000   0.00000  -0.02542
  1 C 2px     -0.00000  -0.69895   0.00000
  1 C 2py     -0.70705  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.68096
  1 C 3px     -0.00000   0.02298   0.00000
  1 C 3py     -0.00461  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01682
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00772  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00210
  1 C 3dxz     0.00000  -0.10461  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01180
<CAS-nat-orb|mo-hf>  3  3    0.99630523
<CAS-nat-orb|mo-hf>  4  4    0.99959512
<CAS-nat-orb|mo-hf>  5  5    0.99624282
<CAS-nat-orb|mo-hf>  6  6    0.99840712
<CAS-nat-orb|mo-hf>  7  7    0.93287017
<CAS-nat-orb|mo-hf>  8  8    0.98760133
<CAS-nat-orb|mo-hf>  9  9    0.96104580
<CAS-nat-orb|mo-hf>  10  10    0.96307389
CASSCF energy = -75.4509724709118
CASCI E = -75.4509724709118  E(CI) = -14.7857465824132  S^2 = 0.0000000
Density matrix diagonal elements [1.95553952 1.93688274 1.83858443 1.63915708 0.06206605 0.36520843
 0.05501503 0.14754671]
i = 1  <i|F|i> = -11.34460680
i = 2  <i|F|i> = -11.34499390
i = 3  <i|F|i> =  -0.79066351
i = 4  <i|F|i> =  -0.64505885
i = 5  <i|F|i> =  -0.32952975
i = 6  <i|F|i> =  -0.25154313
i = 7  <i|F|i> =   0.11453374
i = 8  <i|F|i> =  -0.00181478
i = 9  <i|F|i> =   0.16983457
i = 10  <i|F|i> =   0.18457548
i = 11  <i|F|i> =   0.62995274
i = 12  <i|F|i> =   0.68280746
i = 13  <i|F|i> =   0.62487934
i = 14  <i|F|i> =   0.72101284
i = 15  <i|F|i> =   0.72845533
i = 16  <i|F|i> =   0.71795621
i = 17  <i|F|i> =   0.81526059
i = 18  <i|F|i> =   0.99347404
i = 19  <i|F|i> =   1.22108691
i = 20  <i|F|i> =   1.25947996
i = 21  <i|F|i> =   1.33427528
i = 22  <i|F|i> =   1.36775945
i = 23  <i|F|i> =   1.36815110
i = 24  <i|F|i> =   1.43059971
i = 25  <i|F|i> =   1.43020071
i = 26  <i|F|i> =   1.58783590
i = 27  <i|F|i> =   1.64077099
i = 28  <i|F|i> =   2.07378946
......production of RDMs took       1.85 sec
......reading the RDM took          0.42 sec
......production of RDMs took      26.22 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.80 sec

E(WickICNEVPT2-ijrs) =    -0.00030244331761
E(WickICNEVPT2- rsi) =    -0.00083098225065
E(WickICNEVPT2- ijr) =    -0.00025635953655
E(WickICNEVPT2-  rs) =    -0.03270439065443
E(WickICNEVPT2-  ij) =    -0.00005322550417
E(WickICNEVPT2-  ir) =    -0.00098289134576
E(WickICNEVPT2-   r) =    -0.06144245371734
E(WickICNEVPT2-   i) =    -0.00004531707812
E(WickICNEVPT2) = -75.54759053431643  E_corr_pt = -0.09661806340462235
Timings = pdms =   38.26 | eris =    0.02 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.50 | ij =    0.14 | ir =    0.28 | r =    2.24 | i =    0.85 | total =   42.34
Time cost =    104.068
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:11:28 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.116708843680 AA    0.000000000000   0.000000000000   4.000000000000 Bohr   0.0

nuclear repulsion = 9
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 2.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7684.66


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpx5dhsxeb
max_memory 4000 MB (current use 316 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.65829474285

WARN: Singularity detected in overlap matrix (condition number = 55.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0893486438705837  LUMO (B3u) = -0.0893486438705833

WARN: B2u HOMO -0.0893486438705837 > system LUMO -0.0893486438705833

cycle= 1 E= -75.2192687068769  delta_E= -0.561  |g|= 0.226  |ddm|= 1.45
HOMO (B2u) = -0.339798299416294  LUMO (B3u) = -0.0412658624563702
cycle= 2 E= -75.2401542835959  delta_E= -0.0209  |g|= 0.0439  |ddm|= 0.347
HOMO (B2u) = -0.308660706394019  LUMO (B3u) = -0.00561531074292766
cycle= 3 E= -75.2413180659383  delta_E= -0.00116  |g|= 0.0164  |ddm|= 0.0569
HOMO (B2u) = -0.312871203858108  LUMO (B3u) = -0.00961084060264988
cycle= 4 E= -75.2415141140049  delta_E= -0.000196  |g|= 0.000633  |ddm|= 0.0328
HOMO (B2u) = -0.312958040513246  LUMO (B3u) = -0.00983140550670168
cycle= 5 E= -75.2415142702404  delta_E= -1.56e-07  |g|= 0.000135  |ddm|= 0.00081
HOMO (B2u) = -0.312924808517807  LUMO (B3u) = -0.00980779398986125
cycle= 6 E= -75.2415142806734  delta_E= -1.04e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.31292200071528  LUMO (B3u) = -0.00980776379454681
cycle= 7 E= -75.2415142809299  delta_E= -2.56e-10  |g|= 2.02e-06  |ddm|= 4.04e-05
HOMO (B2u) = -0.312921604622191  LUMO (B3u) = -0.009807843574212
cycle= 8 E= -75.2415142809325  delta_E= -2.61e-12  |g|= 1.28e-07  |ddm|= 4.27e-06
HOMO (B2u) = -0.312921617364753  LUMO (B3u) = -0.00980784817104863
cycle= 9 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 6.97e-09  |ddm|= 3.09e-07
HOMO (B2u) = -0.3129216164583  LUMO (B3u) = -0.00980784977244889
cycle= 10 E= -75.2415142809324  delta_E=    0  |g|= 6.47e-09  |ddm|= 6.76e-09
HOMO (B2u) = -0.312921616763775  LUMO (B3u) = -0.00980785017553337
cycle= 11 E= -75.2415142809325  delta_E= -5.68e-14  |g|= 4.53e-09  |ddm|= 5.08e-09
HOMO (B2u) = -0.312921615944824  LUMO (B3u) = -0.00980784931569267
cycle= 12 E= -75.2415142809325  delta_E= 4.26e-14  |g|= 3.83e-09  |ddm|= 2.8e-09
HOMO (B2u) = -0.312921616048665  LUMO (B3u) = -0.00980784942801753
cycle= 13 E= -75.2415142809324  delta_E= 1.42e-14  |g|= 3.44e-09  |ddm|= 1.27e-09
HOMO (B2u) = -0.312921615711846  LUMO (B3u) = -0.00980784930689594
cycle= 14 E= -75.2415142809325  delta_E= -1.42e-14  |g|= 6.03e-10  |ddm|= 6.18e-09
HOMO (B2u) = -0.312921615819805  LUMO (B3u) = -0.00980784934704355
cycle= 15 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 6.91e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615751515  LUMO (B3u) = -0.00980784933023361
cycle= 16 E= -75.2415142809325  delta_E= -4.26e-14  |g|= 5.91e-10  |ddm|= 1.01e-09
HOMO (B2u) = -0.312921615768468  LUMO (B3u) = -0.00980784930652019
cycle= 17 E= -75.2415142809325  delta_E=    0  |g|= 7.34e-10  |ddm|= 1.01e-09
HOMO (B2u) = -0.31292161574588  LUMO (B3u) = -0.0098078492978009
cycle= 18 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 5.59e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.312921615748492  LUMO (B3u) = -0.00980784931154944
cycle= 19 E= -75.2415142809324  delta_E= 1.14e-13  |g|= 4.25e-10  |ddm|= 4.38e-10
HOMO (B2u) = -0.312921615754882  LUMO (B3u) = -0.00980784932688052
cycle= 20 E= -75.2415142809324  delta_E= -2.84e-14  |g|= 3.35e-10  |ddm|= 2.92e-10
HOMO (B2u) = -0.312921615749395  LUMO (B3u) = -0.00980784932893739
cycle= 21 E= -75.2415142809325  delta_E= -8.53e-14  |g|= 2.4e-10  |ddm|= 2.29e-10
HOMO (B2u) = -0.312921615744528  LUMO (B3u) = -0.00980784933169526
cycle= 22 E= -75.2415142809324  delta_E= 1.14e-13  |g|= 1.48e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.312921615743349  LUMO (B3u) = -0.00980784933007141
cycle= 23 E= -75.2415142809324  delta_E= -1.42e-14  |g|= 1.31e-10  |ddm|= 3.98e-11
HOMO (B2u) = -0.312921615738829  LUMO (B3u) = -0.00980784932805147
cycle= 24 E= -75.2415142809325  delta_E= -1.14e-13  |g|= 1.11e-10  |ddm|= 5.15e-11
HOMO (B2u) = -0.312921615737248  LUMO (B3u) = -0.00980784932681096
cycle= 25 E= -75.2415142809325  delta_E= 4.26e-14  |g|= 9.34e-11  |ddm|= 3.92e-11
HOMO (B2u) = -0.312921615735069  LUMO (B3u) = -0.00980784932651211
cycle= 26 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 7.37e-11  |ddm|= 5.05e-11
HOMO (B2u) = -0.312921615733472  LUMO (B3u) = -0.00980784932630647
cycle= 27 E= -75.2415142809325  delta_E= -5.68e-14  |g|= 6.06e-11  |ddm|= 3.94e-11
HOMO (B2u) = -0.312921615732061  LUMO (B3u) = -0.00980784932595461
cycle= 28 E= -75.2415142809326  delta_E= -7.11e-14  |g|= 4.88e-11  |ddm|= 2.91e-11
HOMO (B2u) = -0.312921615730934  LUMO (B3u) = -0.00980784932563783
cycle= 29 E= -75.2415142809325  delta_E= 7.11e-14  |g|= 3.82e-11  |ddm|= 2.31e-11
HOMO (B2u) = -0.312921615730065  LUMO (B3u) = -0.0098078493253361
cycle= 30 E= -75.2415142809324  delta_E= 5.68e-14  |g|= 3.01e-11  |ddm|= 1.69e-11
HOMO (B2u) = -0.31292161572951  LUMO (B3u) = -0.00980784932509954
cycle= 31 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 2.51e-11  |ddm|= 1.06e-11
HOMO (B2u) = -0.312921615728955  LUMO (B3u) = -0.00980784932489318
cycle= 32 E= -75.2415142809325  delta_E=    0  |g|= 2.06e-11  |ddm|= 9.48e-12
HOMO (B2u) = -0.312921615727441  LUMO (B3u) = -0.0098078493243359
Extra cycle  E= -75.2415142809325  delta_E=    0  |g|= 7.63e-12  |ddm|= 2.78e-11
converged SCF energy = -75.2415142809325

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpx5dhsxeb
max_memory 4000 MB (current use 316 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4079772031596  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4269928701498  dE = -0.019015667  S^2 = 0.0000000
               |grad[o]|=0.112  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4392401163837  dE = -0.012247246  S^2 = 0.0000000
               |grad[o]|=0.0794  |ddm|=0.133  |maxRot[o]|=0.079
macro iter 3 (6 JK  0 micro), CASSCF E = -75.445192175914  dE = -0.0059520595  S^2 = 0.0000000
               |grad[o]|=0.0445  |ddm|=0.0301  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4468428192958  dE = -0.0016506434  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.0981  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4473888812544  dE = -0.00054606196  S^2 = 0.0000000
               |grad[o]|=0.0077  |ddm|=0.0155  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4474923150785  dE = -0.00010343382  S^2 = 0.0000000
               |grad[o]|=0.00362  |ddm|=0.00704  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4475072129745  dE = -1.4897896e-05  S^2 = 0.0000000
               |grad[o]|=0.00159  |ddm|=0.00339  |maxRot[o]|=0.00836
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4475085952737  dE = -1.3822992e-06  S^2 = 0.0000000
               |grad[o]|=0.000559  |ddm|=0.00151  |maxRot[o]|=0.00253
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4475087228391  dE = -1.2756539e-07  S^2 = 0.0000000
               |grad[o]|=0.000179  |ddm|=0.000495  |maxRot[o]|=0.000757
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4475087345609  dE = -1.1721781e-08  S^2 = 0.0000000
               |grad[o]|=5.56e-05  |ddm|=0.000156  |maxRot[o]|=0.000227
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4475087356465  dE = -1.0856525e-09  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=4.8e-05  |maxRot[o]|=6.85e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4475087357395  dE = -9.293899e-11  S^2 = 0.0000000
               |grad[o]|=5.27e-06  |ddm|=1.47e-05  |maxRot[o]|=2.04e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95539885 1.93749708 1.8292365  1.61997882 0.06124694 0.38415954
 0.05468074 0.15780153]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01243   0.01086  -0.00123   0.00000   0.00000
  0 C 2s       0.69987   0.68306  -0.09890  -0.00000   0.00000
  0 C 3s       0.00559   0.01429  -0.02264   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.69417
  0 C 2py      0.00000  -0.00000  -0.00000   0.70461   0.00000
  0 C 2pz      0.09912  -0.18163   0.69866   0.00000   0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.06942
  0 C 3py      0.00000  -0.00000  -0.00000   0.05510   0.00000
  0 C 3pz     -0.00787  -0.00173   0.02398   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02202   0.00000
  0 C 3dz^2    0.00990  -0.00917   0.03103   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.11537
 0 C 3dx2-y2   0.00220   0.00568  -0.00646   0.00000   0.00000
  1 C 1s       0.01243  -0.01086  -0.00123   0.00000   0.00000
  1 C 2s       0.69987  -0.68306  -0.09890  -0.00000   0.00000
  1 C 3s       0.00559  -0.01429  -0.02264  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000  -0.00000  -0.00000   0.69417
  1 C 2py     -0.00000   0.00000   0.00000   0.70461  -0.00000
  1 C 2pz     -0.09912  -0.18163  -0.69866   0.00000   0.00000
  1 C 3px      0.00000   0.00000  -0.00000  -0.00000  -0.06942
  1 C 3py     -0.00000   0.00000   0.00000   0.05510  -0.00000
  1 C 3pz      0.00787  -0.00173  -0.02398   0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02202  -0.00000
  1 C 3dz^2    0.00990   0.00917   0.03103  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000   0.11537
 1 C 3dx2-y2   0.00220  -0.00568  -0.00646  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00018
  0 C 2s      -0.00000  -0.00000   0.18114
  0 C 3s      -0.00000   0.00000   0.02444
  0 C 2px      0.00000   0.69909   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.68284
  0 C 3px     -0.00000  -0.02448   0.00000
  0 C 3py      0.00635  -0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.01417
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00736   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00169
  0 C 3dxz    -0.00000  -0.10334   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01092
  1 C 1s       0.00000   0.00000   0.00018
  1 C 2s       0.00000  -0.00000  -0.18114
  1 C 3s       0.00000  -0.00000  -0.02444
  1 C 2px      0.00000  -0.69909  -0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.68284
  1 C 3px     -0.00000   0.02448  -0.00000
  1 C 3py     -0.00635  -0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01417
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00736   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00169
  1 C 3dxz     0.00000  -0.10334   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01092
<CAS-nat-orb|mo-hf>  3  3    0.99576781
<CAS-nat-orb|mo-hf>  4  4    0.99957524
<CAS-nat-orb|mo-hf>  5  5    0.99568632
<CAS-nat-orb|mo-hf>  6  6    0.99833014
<CAS-nat-orb|mo-hf>  7  7    0.93288519
<CAS-nat-orb|mo-hf>  8  8    0.98831105
<CAS-nat-orb|mo-hf>  9  9    0.96112500
<CAS-nat-orb|mo-hf>  10  10    0.96605593
CASSCF energy = -75.4475087357395
CASCI E = -75.4475087357395  E(CI) = -14.7317045576553  S^2 = 0.0000000
Density matrix diagonal elements [1.95539933 1.93749779 1.82923627 1.61997896 0.06124623 0.38415942
 0.05468108 0.15780091]
i = 1  <i|F|i> = -11.34411509
i = 2  <i|F|i> = -11.34450369
i = 3  <i|F|i> =  -0.78540601
i = 4  <i|F|i> =  -0.64707423
i = 5  <i|F|i> =  -0.32557613
i = 6  <i|F|i> =  -0.24651091
i = 7  <i|F|i> =   0.11605952
i = 8  <i|F|i> =  -0.00723209
i = 9  <i|F|i> =   0.16826213
i = 10  <i|F|i> =   0.17318937
i = 11  <i|F|i> =   0.63365360
i = 12  <i|F|i> =   0.68157112
i = 13  <i|F|i> =   0.62334220
i = 14  <i|F|i> =   0.72155366
i = 15  <i|F|i> =   0.72945404
i = 16  <i|F|i> =   0.71783406
i = 17  <i|F|i> =   0.81972737
i = 18  <i|F|i> =   0.99123042
i = 19  <i|F|i> =   1.22924695
i = 20  <i|F|i> =   1.26632053
i = 21  <i|F|i> =   1.32134780
i = 22  <i|F|i> =   1.37074001
i = 23  <i|F|i> =   1.37096337
i = 24  <i|F|i> =   1.42860707
i = 25  <i|F|i> =   1.42825289
i = 26  <i|F|i> =   1.57691873
i = 27  <i|F|i> =   1.62863299
i = 28  <i|F|i> =   2.06093014
......production of RDMs took       3.09 sec
......reading the RDM took          0.42 sec
......production of RDMs took      66.19 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.42 sec

E(WickICNEVPT2-ijrs) =    -0.00030437144302
E(WickICNEVPT2- rsi) =    -0.00083515631158
E(WickICNEVPT2- ijr) =    -0.00025493907682
E(WickICNEVPT2-  rs) =    -0.03260693715128
E(WickICNEVPT2-  ij) =    -0.00005195518840
E(WickICNEVPT2-  ir) =    -0.00098028967803
E(WickICNEVPT2-   r) =    -0.06160090455640
E(WickICNEVPT2-   i) =    -0.00004327398693
E(WickICNEVPT2) = -75.54418656313193  E_corr_pt = -0.09667782739245118
Timings = pdms =   80.11 | eris =    0.01 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.14 | r =    2.02 | i =    0.91 | total =   83.55
Time cost =    165.277
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:14:13 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.143167704226 AA    0.000000000000   0.000000000000   4.050000000000 Bohr   0.0

nuclear repulsion = 8.88888888888889
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7913.57


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpco248rv2
max_memory 4000 MB (current use 317 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.650821541947

WARN: Singularity detected in overlap matrix (condition number = 52.1). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0872509906487019  LUMO (B3u) = -0.0872509906487013

WARN: B2u HOMO -0.0872509906487019 > system LUMO -0.0872509906487013

cycle= 1 E= -75.2120928138537  delta_E= -0.561  |g|= 0.225  |ddm|= 1.45
HOMO (B2u) = -0.336938998033696  LUMO (B3u) = -0.0396234294723683
cycle= 2 E= -75.232782617734  delta_E= -0.0207  |g|= 0.0434  |ddm|= 0.347
HOMO (B2u) = -0.306147078592026  LUMO (B3u) = -0.00433141905845759
cycle= 3 E= -75.2339223949765  delta_E= -0.00114  |g|= 0.0162  |ddm|= 0.0561
HOMO (B2u) = -0.310321597199801  LUMO (B3u) = -0.00828279864970648
cycle= 4 E= -75.2341150976661  delta_E= -0.000193  |g|= 0.000629  |ddm|= 0.0325
HOMO (B2u) = -0.310388518956865  LUMO (B3u) = -0.00848075571953751
cycle= 5 E= -75.234115252423  delta_E= -1.55e-07  |g|= 0.000135  |ddm|= 0.000802
HOMO (B2u) = -0.310356121170236  LUMO (B3u) = -0.00845811286980665
cycle= 6 E= -75.2341152629183  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.31035330246065  LUMO (B3u) = -0.00845802697819674
cycle= 7 E= -75.2341152631768  delta_E= -2.59e-10  |g|= 2.04e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.310352915622194  LUMO (B3u) = -0.00845812345203341
cycle= 8 E= -75.2341152631795  delta_E= -2.64e-12  |g|= 1.28e-07  |ddm|= 4.34e-06
HOMO (B2u) = -0.310352930536287  LUMO (B3u) = -0.0084581295366934
cycle= 9 E= -75.2341152631795  delta_E= -4.26e-14  |g|= 6.65e-09  |ddm|= 3.04e-07
HOMO (B2u) = -0.31035292958063  LUMO (B3u) = -0.00845813119531624
cycle= 10 E= -75.2341152631795  delta_E= 1.42e-14  |g|= 6.3e-09  |ddm|= 7.03e-09
HOMO (B2u) = -0.310352929990545  LUMO (B3u) = -0.00845813169875921
cycle= 11 E= -75.2341152631795  delta_E= 1.42e-14  |g|= 4.39e-09  |ddm|= 4.73e-09
HOMO (B2u) = -0.310352929258363  LUMO (B3u) = -0.00845813092286866
cycle= 12 E= -75.2341152631795  delta_E= 2.84e-14  |g|= 3.73e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.3103529293504  LUMO (B3u) = -0.0084581310189494
cycle= 13 E= -75.2341152631794  delta_E= 1.42e-14  |g|= 3.35e-09  |ddm|= 1.12e-09
HOMO (B2u) = -0.310352929050668  LUMO (B3u) = -0.00845813092925447
cycle= 14 E= -75.2341152631794  delta_E= 4.26e-14  |g|= 5.26e-10  |ddm|= 5.83e-09
HOMO (B2u) = -0.310352929162598  LUMO (B3u) = -0.00845813096838486
cycle= 15 E= -75.2341152631795  delta_E= -5.68e-14  |g|= 6.38e-10  |ddm|= 1.08e-09
HOMO (B2u) = -0.310352929091106  LUMO (B3u) = -0.00845813096087429
cycle= 16 E= -75.2341152631794  delta_E= 2.84e-14  |g|= 5.34e-10  |ddm|= 8.95e-10
HOMO (B2u) = -0.31035292911064  LUMO (B3u) = -0.00845813092680548
cycle= 17 E= -75.2341152631795  delta_E= -4.26e-14  |g|= 6.72e-10  |ddm|= 1.34e-09
HOMO (B2u) = -0.310352929092114  LUMO (B3u) = -0.00845813092054848
cycle= 18 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 5.12e-10  |ddm|= 3e-10
HOMO (B2u) = -0.310352929097915  LUMO (B3u) = -0.00845813093611273
cycle= 19 E= -75.2341152631794  delta_E=    0  |g|= 3.89e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.310352929107129  LUMO (B3u) = -0.00845813095327786
cycle= 20 E= -75.2341152631794  delta_E= 1.42e-14  |g|= 3.08e-10  |ddm|= 2.49e-10
HOMO (B2u) = -0.310352929104635  LUMO (B3u) = -0.00845813095768536
cycle= 21 E= -75.2341152631794  delta_E= -5.68e-14  |g|= 2.19e-10  |ddm|= 1.93e-10
HOMO (B2u) = -0.310352929102234  LUMO (B3u) = -0.00845813096232862
cycle= 22 E= -75.2341152631794  delta_E= 4.26e-14  |g|= 1.33e-10  |ddm|= 1.79e-10
HOMO (B2u) = -0.310352929101648  LUMO (B3u) = -0.00845813096089651
cycle= 23 E= -75.2341152631794  delta_E=    0  |g|= 1.19e-10  |ddm|= 3.44e-11
HOMO (B2u) = -0.310352929097728  LUMO (B3u) = -0.00845813095923037
cycle= 24 E= -75.2341152631795  delta_E= -5.68e-14  |g|= 9.98e-11  |ddm|= 4.72e-11
HOMO (B2u) = -0.310352929096908  LUMO (B3u) = -0.00845813095804235
cycle= 25 E= -75.2341152631794  delta_E= 2.84e-14  |g|= 8.42e-11  |ddm|= 3.78e-11
HOMO (B2u) = -0.310352929095488  LUMO (B3u) = -0.00845813095825407
cycle= 26 E= -75.2341152631795  delta_E= -2.84e-14  |g|= 6.7e-11  |ddm|= 3.85e-11
HOMO (B2u) = -0.310352929094484  LUMO (B3u) = -0.00845813095844031
cycle= 27 E= -75.2341152631794  delta_E= 4.26e-14  |g|= 5.6e-11  |ddm|= 3.02e-11
HOMO (B2u) = -0.310352929093508  LUMO (B3u) = -0.00845813095836689
cycle= 28 E= -75.2341152631794  delta_E=    0  |g|= 4.56e-11  |ddm|= 2.24e-11
HOMO (B2u) = -0.310352929091051  LUMO (B3u) = -0.00845813095782566
Extra cycle  E= -75.2341152631795  delta_E= -5.68e-14  |g|= 1.7e-11  |ddm|= 5.44e-11
converged SCF energy = -75.2341152631795

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpco248rv2
max_memory 4000 MB (current use 317 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4050131046161  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4242837882352  dE = -0.019270684  S^2 = 0.0000000
               |grad[o]|=0.114  |ddm|= 3.72  |maxRot[o]|=0.0784
macro iter 2 (6 JK  0 micro), CASSCF E = -75.436385727247  dE = -0.012101939  S^2 = 0.0000000
               |grad[o]|=0.0799  |ddm|=0.135  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4421036044513  dE = -0.0057178772  S^2 = 0.0000000
               |grad[o]|=0.0439  |ddm|=0.0337  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4436293617453  dE = -0.0015257573  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.0939  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4441199083143  dE = -0.00049054657  S^2 = 0.0000000
               |grad[o]|=0.00716  |ddm|=0.0142  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4441997253183  dE = -7.9817004e-05  S^2 = 0.0000000
               |grad[o]|=0.00326  |ddm|=0.00696  |maxRot[o]|=0.019
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4442076744556  dE = -7.9491373e-06  S^2 = 0.0000000
               |grad[o]|=0.00128  |ddm|=0.0033  |maxRot[o]|=0.00603
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4442084507923  dE = -7.7633666e-07  S^2 = 0.0000000
               |grad[o]|=0.000435  |ddm|=0.00116  |maxRot[o]|=0.00186
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4442085256887  dE = -7.4896391e-08  S^2 = 0.0000000
               |grad[o]|=0.00014  |ddm|=0.000383  |maxRot[o]|=0.000569
macro iter 10 (3 JK  0 micro), CASSCF E = -75.444208532894  dE = -7.2053723e-09  S^2 = 0.0000000
               |grad[o]|=4.42e-05  |ddm|=0.000122  |maxRot[o]|=0.000175
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4442085335819  dE = -6.8789063e-10  S^2 = 0.0000000
               |grad[o]|=1.38e-05  |ddm|=3.84e-05  |maxRot[o]|=5.39e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.444208533648  dE = -6.6108896e-11  S^2 = 0.0000000
               |grad[o]|=4.29e-06  |ddm|=1.2e-05  |maxRot[o]|=1.66e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95530405 1.93811148 1.81911524 1.60013605 0.06045908 0.40376984
 0.05434302 0.16876124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01246   0.01091  -0.00105   0.00000   0.00000
  0 C 2s       0.70117   0.68475  -0.08932   0.00000   0.00000
  0 C 3s       0.00639   0.01416  -0.02106   0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69435
  0 C 2py      0.00000   0.00000  -0.00000   0.70466  -0.00000
  0 C 2pz      0.08959  -0.17518   0.69998   0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06986
  0 C 3py     -0.00000   0.00000   0.00000   0.05490   0.00000
  0 C 3pz     -0.00744  -0.00175   0.02554   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.02095   0.00000
  0 C 3dz^2    0.00897  -0.00886   0.03021   0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11401
 0 C 3dx2-y2   0.00234   0.00560  -0.00636   0.00000   0.00000
  1 C 1s       0.01246  -0.01091  -0.00105   0.00000   0.00000
  1 C 2s       0.70117  -0.68475  -0.08932   0.00000   0.00000
  1 C 3s       0.00639  -0.01416  -0.02106  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70466  -0.00000
  1 C 2pz     -0.08959  -0.17518  -0.69998   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000   0.00000  -0.06986
  1 C 3py      0.00000  -0.00000   0.00000   0.05490  -0.00000
  1 C 3pz      0.00744  -0.00175  -0.02554   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02095   0.00000
  1 C 3dz^2    0.00897   0.00886   0.03021  -0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11401
 1 C 3dx2-y2   0.00234  -0.00560  -0.00636  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00016
  0 C 2s       0.00000   0.00000   0.17473
  0 C 3s       0.00000   0.00000   0.02347
  0 C 2px     -0.00000   0.69923   0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68460
  0 C 3px     -0.00000  -0.02593  -0.00000
  0 C 3py      0.00804  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.01155
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00702  -0.00000  -0.00000
  0 C 3dz^2    0.00000   0.00000   0.00132
  0 C 3dxz    -0.00000  -0.10203   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01008
  1 C 1s       0.00000   0.00000   0.00016
  1 C 2s      -0.00000  -0.00000  -0.17473
  1 C 3s      -0.00000  -0.00000  -0.02347
  1 C 2px      0.00000  -0.69923   0.00000
  1 C 2py     -0.70703   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68460
  1 C 3px      0.00000   0.02593  -0.00000
  1 C 3py     -0.00804   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.01155
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00702   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00132
  1 C 3dxz    -0.00000  -0.10203   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01008
<CAS-nat-orb|mo-hf>  3  3    0.99532683
<CAS-nat-orb|mo-hf>  4  4    0.99955353
<CAS-nat-orb|mo-hf>  5  5    0.99522359
<CAS-nat-orb|mo-hf>  6  6    0.99825105
<CAS-nat-orb|mo-hf>  7  7    0.93296321
<CAS-nat-orb|mo-hf>  8  8    0.98897441
<CAS-nat-orb|mo-hf>  9  9    0.96119969
<CAS-nat-orb|mo-hf>  10  10    0.96876542
CASSCF energy = -75.444208533648
CASCI E = -75.444208533648  E(CI) = -14.6790716900886  S^2 = 0.0000000
Density matrix diagonal elements [1.95530449 1.93811202 1.81911598 1.60013641 0.06045804 0.4037695
 0.05434306 0.1687605 ]
i = 1  <i|F|i> = -11.34352671
i = 2  <i|F|i> = -11.34391560
i = 3  <i|F|i> =  -0.78041793
i = 4  <i|F|i> =  -0.64899785
i = 5  <i|F|i> =  -0.32146696
i = 6  <i|F|i> =  -0.24150820
i = 7  <i|F|i> =   0.11747225
i = 8  <i|F|i> =  -0.01252016
i = 9  <i|F|i> =   0.16676914
i = 10  <i|F|i> =   0.16222578
i = 11  <i|F|i> =   0.63728161
i = 12  <i|F|i> =   0.68033279
i = 13  <i|F|i> =   0.62192092
i = 14  <i|F|i> =   0.72207848
i = 15  <i|F|i> =   0.73042018
i = 16  <i|F|i> =   0.71771397
i = 17  <i|F|i> =   0.82355772
i = 18  <i|F|i> =   0.98913049
i = 19  <i|F|i> =   1.23747043
i = 20  <i|F|i> =   1.27328242
i = 21  <i|F|i> =   1.30983149
i = 22  <i|F|i> =   1.37357030
i = 23  <i|F|i> =   1.37371436
i = 24  <i|F|i> =   1.42677611
i = 25  <i|F|i> =   1.42646143
i = 26  <i|F|i> =   1.56642252
i = 27  <i|F|i> =   1.61689171
i = 28  <i|F|i> =   2.04716129
......production of RDMs took       2.11 sec
......reading the RDM took          0.42 sec
......production of RDMs took      29.48 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.75 sec

E(WickICNEVPT2-ijrs) =    -0.00030628244014
E(WickICNEVPT2- rsi) =    -0.00083940074781
E(WickICNEVPT2- ijr) =    -0.00025352786660
E(WickICNEVPT2-  rs) =    -0.03251880348083
E(WickICNEVPT2-  ij) =    -0.00005076280655
E(WickICNEVPT2-  ir) =    -0.00097797684527
E(WickICNEVPT2-   r) =    -0.06173460809373
E(WickICNEVPT2-   i) =    -0.00004132816063
E(WickICNEVPT2) = -75.5409312240896  E_corr_pt = -0.09672269044156902
Timings = pdms =   41.79 | eris =    0.63 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.25 | ij =    0.07 | ir =    0.15 | r =    1.79 | i =    0.76 | total =   45.49
Time cost =    142.693
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:16:36 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.169626564772 AA    0.000000000000   0.000000000000   4.100000000000 Bohr   0.0

nuclear repulsion = 8.78048780487805
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   2.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      8187.07


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpysrvka9w
max_memory 4000 MB (current use 324 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.643876015773

WARN: Singularity detected in overlap matrix (condition number = 49.2). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0852438140031948  LUMO (B3u) = -0.085243814003195

WARN: B2u HOMO -0.0852438140031948 > system LUMO -0.085243814003195

cycle= 1 E= -75.2050111450144  delta_E= -0.561  |g|= 0.224  |ddm|= 1.45
HOMO (B2u) = -0.334187231388071  LUMO (B3g) = -0.0398454588841027
cycle= 2 E= -75.2255220782413  delta_E= -0.0205  |g|= 0.043  |ddm|= 0.347
HOMO (B2u) = -0.303722561565161  LUMO (B3g) = -0.00486882385407524
cycle= 3 E= -75.2266381654048  delta_E= -0.00112  |g|= 0.0161  |ddm|= 0.0554
HOMO (B2u) = -0.307858619678186  LUMO (B3g) = -0.00776666805282885
cycle= 4 E= -75.226827530681  delta_E= -0.000189  |g|= 0.000623  |ddm|= 0.0321
HOMO (B2u) = -0.307904877132321  LUMO (B3g) = -0.0079120047359263
cycle= 5 E= -75.2268276836983  delta_E= -1.53e-07  |g|= 0.000135  |ddm|= 0.000792
HOMO (B2u) = -0.30787337659822  LUMO (B3g) = -0.00787181864145264
cycle= 6 E= -75.2268276941976  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000228
HOMO (B2u) = -0.307870547891912  LUMO (B3g) = -0.00786924076200736
cycle= 7 E= -75.2268276944567  delta_E= -2.59e-10  |g|= 2.07e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.307870168621818  LUMO (B3g) = -0.00786899944460128
cycle= 8 E= -75.2268276944595  delta_E= -2.81e-12  |g|= 1.28e-07  |ddm|= 4.42e-06
HOMO (B2u) = -0.307870185809037  LUMO (B3g) = -0.00786900390111171
cycle= 9 E= -75.2268276944595  delta_E=    0  |g|= 6.56e-09  |ddm|= 2.97e-07
HOMO (B2u) = -0.307870184793606  LUMO (B3g) = -0.00786900501161471
cycle= 10 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 6.26e-09  |ddm|= 7.52e-09
HOMO (B2u) = -0.307870185324147  LUMO (B3g) = -0.00786900549093225
cycle= 11 E= -75.2268276944595  delta_E=    0  |g|= 4.35e-09  |ddm|= 4.42e-09
HOMO (B2u) = -0.30787018467351  LUMO (B3g) = -0.00786900468964266
cycle= 12 E= -75.2268276944595  delta_E= -4.26e-14  |g|= 3.7e-09  |ddm|= 2.56e-09
HOMO (B2u) = -0.307870184756502  LUMO (B3g) = -0.00786900477079586
cycle= 13 E= -75.2268276944595  delta_E=    0  |g|= 3.34e-09  |ddm|= 9.7e-10
HOMO (B2u) = -0.307870184502927  LUMO (B3g) = -0.00786900460320247
cycle= 14 E= -75.2268276944595  delta_E=    0  |g|= 5.17e-10  |ddm|= 5.31e-09
HOMO (B2u) = -0.30787018461641  LUMO (B3g) = -0.00786900470668257
cycle= 15 E= -75.2268276944594  delta_E= 5.68e-14  |g|= 6.33e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.307870184546986  LUMO (B3g) = -0.00786900464584421
cycle= 16 E= -75.2268276944595  delta_E= -5.68e-14  |g|= 5.24e-10  |ddm|= 9.76e-10
HOMO (B2u) = -0.307870184560453  LUMO (B3g) = -0.00786900465959183
cycle= 17 E= -75.2268276944594  delta_E= 7.11e-14  |g|= 6.56e-10  |ddm|= 1.07e-09
HOMO (B2u) = -0.307870184545942  LUMO (B3g) = -0.0078690046508233
cycle= 18 E= -75.2268276944595  delta_E= -7.11e-14  |g|= 5.02e-10  |ddm|= 2.42e-10
HOMO (B2u) = -0.307870184554937  LUMO (B3g) = -0.00786900465774723
cycle= 19 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 3.82e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.307870184567147  LUMO (B3g) = -0.00786900467017679
cycle= 20 E= -75.2268276944594  delta_E= 2.84e-14  |g|= 3.04e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.307870184567739  LUMO (B3g) = -0.00786900467422405
cycle= 21 E= -75.2268276944594  delta_E=    0  |g|= 2.16e-10  |ddm|= 1.62e-10
HOMO (B2u) = -0.307870184567913  LUMO (B3g) = -0.00786900467900199
cycle= 22 E= -75.2268276944594  delta_E= 1.42e-14  |g|= 1.31e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.307870184567887  LUMO (B3g) = -0.00786900467984626
cycle= 23 E= -75.2268276944595  delta_E= -1.14e-13  |g|= 1.16e-10  |ddm|= 3.46e-11
HOMO (B2u) = -0.307870184564446  LUMO (B3g) = -0.0078690046779351
cycle= 24 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 9.8e-11  |ddm|= 4.85e-11
HOMO (B2u) = -0.307870184564103  LUMO (B3g) = -0.00786900467863027
cycle= 25 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 8.23e-11  |ddm|= 3.37e-11
HOMO (B2u) = -0.307870184563447  LUMO (B3g) = -0.00786900467870709
cycle= 26 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 6.56e-11  |ddm|= 2.95e-11
HOMO (B2u) = -0.30787018456303  LUMO (B3g) = -0.00786900467867374
cycle= 27 E= -75.2268276944595  delta_E=    0  |g|= 5.5e-11  |ddm|= 2.31e-11
HOMO (B2u) = -0.307870184561139  LUMO (B3g) = -0.00786900467903501
Extra cycle  E= -75.2268276944595  delta_E= 1.42e-14  |g|= 2.01e-11  |ddm|= 5.84e-11
converged SCF energy = -75.2268276944595

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmpysrvka9w
max_memory 4000 MB (current use 324 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4021896555601  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.421464960641  dE = -0.019275305  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4334658808299  dE = -0.01200092  S^2 = 0.0000000
               |grad[o]|=0.0809  |ddm|=0.135  |maxRot[o]|=0.0799
macro iter 3 (5 JK  0 micro), CASSCF E = -75.4382739601755  dE = -0.0048080793  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.0331  |maxRot[o]|= 0.06
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4401616772161  dE = -0.001887717  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.0842  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4408726065555  dE = -0.00071092934  S^2 = 0.0000000
               |grad[o]|=0.00949  |ddm|=0.0179  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4410249536859  dE = -0.00015234713  S^2 = 0.0000000
               |grad[o]|=0.0045  |ddm|=0.00833  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.441068642474  dE = -4.3688788e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.00376  |maxRot[o]|=0.0138
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4410730802276  dE = -4.4377535e-06  S^2 = 0.0000000
               |grad[o]|=0.000978  |ddm|=0.00262  |maxRot[o]|=0.00444
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4410735333521  dE = -4.5312456e-07  S^2 = 0.0000000
               |grad[o]|=0.000336  |ddm|=0.000902  |maxRot[o]|=0.00139
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4410735792916  dE = -4.5939444e-08  S^2 = 0.0000000
               |grad[o]|=0.00011  |ddm|=0.0003  |maxRot[o]|=0.000438
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4410735839378  dE = -4.6462105e-09  S^2 = 0.0000000
               |grad[o]|=3.55e-05  |ddm|=9.77e-05  |maxRot[o]|=0.000139
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4410735844028  dE = -4.650218e-10  S^2 = 0.0000000
               |grad[o]|=1.14e-05  |ddm|=3.12e-05  |maxRot[o]|=4.36e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.441073584449  dE = -4.622791e-11  S^2 = 0.0000000
               |grad[o]|=3.63e-06  |ddm|=1e-05  |maxRot[o]|=1.38e-05
2-step CASSCF converged in 13 macro (47 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95524813 1.93872441 1.80820228 1.57967996 0.42398994 0.05970186
 0.05400188 0.18045154]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01248   0.01096  -0.00089   0.00000   0.00000
  0 C 2s       0.70221   0.68634  -0.08081   0.00000   0.00000
  0 C 3s       0.00710   0.01405  -0.01955  -0.00000   0.00000
  0 C 2px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 2py      0.00000  -0.00000   0.00000   0.70471   0.70701
  0 C 2pz      0.08112  -0.16887   0.70104   0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3py      0.00000  -0.00000   0.00000   0.05462   0.00967
  0 C 3pz     -0.00705  -0.00178   0.02705  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.01990   0.00668
  0 C 3dz^2    0.00810  -0.00856   0.02935  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.00000
 0 C 3dx2-y2   0.00247   0.00552  -0.00626   0.00000  -0.00000
  1 C 1s       0.01248  -0.01096  -0.00089   0.00000   0.00000
  1 C 2s       0.70221  -0.68634  -0.08081   0.00000   0.00000
  1 C 3s       0.00710  -0.01405  -0.01955  -0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 2py     -0.00000   0.00000  -0.00000   0.70471  -0.70701
  1 C 2pz     -0.08112  -0.16887  -0.70104   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3py     -0.00000   0.00000  -0.00000   0.05462  -0.00967
  1 C 3pz      0.00705  -0.00178  -0.02705   0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.01990   0.00668
  1 C 3dz^2    0.00810   0.00856   0.02935  -0.00000  -0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
 1 C 3dx2-y2   0.00247  -0.00552  -0.00626  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00015
  0 C 2s       0.00000   0.00000   0.16846
  0 C 3s       0.00000  -0.00000   0.02250
  0 C 2px      0.69455   0.69937   0.00000
  0 C 2py      0.00000  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68626
  0 C 3px     -0.07025  -0.02735   0.00000
  0 C 3py     -0.00000   0.00000   0.00000
  0 C 3pz      0.00000  -0.00000  -0.00897
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00098
  0 C 3dxz    -0.11253  -0.10066   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00927
  1 C 1s       0.00000   0.00000   0.00015
  1 C 2s      -0.00000   0.00000  -0.16846
  1 C 3s      -0.00000  -0.00000  -0.02250
  1 C 2px      0.69455  -0.69937  -0.00000
  1 C 2py     -0.00000  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.68626
  1 C 3px     -0.07025   0.02735  -0.00000
  1 C 3py     -0.00000   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.00897
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00098
  1 C 3dxz     0.11253  -0.10066   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00927
<CAS-nat-orb|mo-hf>  3  3    0.99498963
<CAS-nat-orb|mo-hf>  4  4    0.99952982
<CAS-nat-orb|mo-hf>  5  5    0.99486173
<CAS-nat-orb|mo-hf>  6  6    0.99817000
<CAS-nat-orb|mo-hf>  7  7    0.98959359
<CAS-nat-orb|mo-hf>  8  8    0.93310195
<CAS-nat-orb|mo-hf>  9  9    0.96127102
<CAS-nat-orb|mo-hf>  10  10    0.97122875
CASSCF energy = -75.441073584449
CASCI E = -75.441073584449  E(CI) = -14.62780430648  S^2 = 0.0000000
Density matrix diagonal elements [1.95524844 1.93872489 1.80820259 1.57967994 0.42398994 0.05970133
 0.05400184 0.18045104]
i = 1  <i|F|i> = -11.34284732
i = 2  <i|F|i> = -11.34323537
i = 3  <i|F|i> =  -0.77569882
i = 4  <i|F|i> =  -0.65083185
i = 5  <i|F|i> =  -0.31719849
i = 6  <i|F|i> =  -0.23653946
i = 7  <i|F|i> =  -0.01767782
i = 8  <i|F|i> =   0.11877419
i = 9  <i|F|i> =   0.16534864
i = 10  <i|F|i> =   0.15165859
i = 11  <i|F|i> =   0.64083229
i = 12  <i|F|i> =   0.67910489
i = 13  <i|F|i> =   0.62061787
i = 14  <i|F|i> =   0.72259061
i = 15  <i|F|i> =   0.73135220
i = 16  <i|F|i> =   0.71759170
i = 17  <i|F|i> =   0.82668342
i = 18  <i|F|i> =   0.98716994
i = 19  <i|F|i> =   1.24571597
i = 20  <i|F|i> =   1.28031601
i = 21  <i|F|i> =   1.29981874
i = 22  <i|F|i> =   1.37625483
i = 23  <i|F|i> =   1.37635389
i = 24  <i|F|i> =   1.42509947
i = 25  <i|F|i> =   1.42481933
i = 26  <i|F|i> =   1.55635533
i = 27  <i|F|i> =   1.60555424
i = 28  <i|F|i> =   2.03256983
......production of RDMs took       2.00 sec
......reading the RDM took          0.42 sec
......production of RDMs took      39.95 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.23 sec

E(WickICNEVPT2-ijrs) =    -0.00030816155871
E(WickICNEVPT2- rsi) =    -0.00084367960389
E(WickICNEVPT2- ijr) =    -0.00025212247631
E(WickICNEVPT2-  rs) =    -0.03243970131170
E(WickICNEVPT2-  ij) =    -0.00004964473930
E(WickICNEVPT2-  ir) =    -0.00097592823537
E(WickICNEVPT2-   r) =    -0.06184409944520
E(WickICNEVPT2-   i) =    -0.00003947690245
E(WickICNEVPT2) = -75.53782639872198  E_corr_pt = -0.09675281427292695
Timings = pdms =   52.57 | eris =    0.62 | ijrs =    0.02 | rsi =    0.03 | ijr =    0.01 | rs =    0.42 | ij =    0.08 | ir =    0.17 | r =    2.17 | i =    0.83 | total =   56.94
Time cost =    113.714
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-31.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:18:30 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.196085425318 AA    0.000000000000   0.000000000000   4.150000000000 Bohr   0.0

nuclear repulsion = 8.67469879518072
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      8413.34


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp8l7dc4cq
max_memory 4000 MB (current use 320 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6374240354882

WARN: Singularity detected in overlap matrix (condition number = 46.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0833226379096656  LUMO (B3u) = -0.0833226379096665

WARN: B2u HOMO -0.0833226379096656 > system LUMO -0.0833226379096665

cycle= 1 E= -75.1980259935244  delta_E= -0.561  |g|= 0.223  |ddm|= 1.45
HOMO (B2u) = -0.331539393004467  LUMO (B3g) = -0.0424794268999045
cycle= 2 E= -75.218374297065  delta_E= -0.0203  |g|= 0.0426  |ddm|= 0.347
HOMO (B2u) = -0.301383734536959  LUMO (B3g) = -0.00782777517474494
cycle= 3 E= -75.2194670845424  delta_E= -0.00109  |g|= 0.0159  |ddm|= 0.0547
HOMO (B2u) = -0.305478746489494  LUMO (B3g) = -0.0107333088759242
cycle= 4 E= -75.2196531399389  delta_E= -0.000186  |g|= 0.000618  |ddm|= 0.0318
HOMO (B2u) = -0.305504012954428  LUMO (B3g) = -0.0108540193385382
cycle= 5 E= -75.2196532909579  delta_E= -1.51e-07  |g|= 0.000135  |ddm|= 0.000782
HOMO (B2u) = -0.3054734770586  LUMO (B3g) = -0.0108148524604097
cycle= 6 E= -75.2196533014041  delta_E= -1.04e-08  |g|= 1.98e-05  |ddm|= 0.000227
HOMO (B2u) = -0.305470638287287  LUMO (B3g) = -0.010812174102776
cycle= 7 E= -75.2196533016625  delta_E= -2.58e-10  |g|= 2.1e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.305470264892481  LUMO (B3g) = -0.0108119322510685
cycle= 8 E= -75.2196533016654  delta_E= -2.86e-12  |g|= 1.29e-07  |ddm|= 4.5e-06
HOMO (B2u) = -0.305470284406284  LUMO (B3g) = -0.0108119381626109
cycle= 9 E= -75.2196533016653  delta_E= 7.11e-14  |g|= 6.74e-09  |ddm|= 2.91e-07
HOMO (B2u) = -0.30547028332608  LUMO (B3g) = -0.0108119393036919
cycle= 10 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 6.37e-09  |ddm|= 8.17e-09
HOMO (B2u) = -0.305470283984228  LUMO (B3g) = -0.0108119399130877
cycle= 11 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 4.44e-09  |ddm|= 4.13e-09
HOMO (B2u) = -0.30547028340399  LUMO (B3g) = -0.0108119391827513
cycle= 12 E= -75.2196533016653  delta_E= -8.53e-14  |g|= 3.78e-09  |ddm|= 2.49e-09
HOMO (B2u) = -0.305470283231348  LUMO (B3g) = -0.0108119391067642
cycle= 13 E= -75.2196533016654  delta_E= -1.42e-14  |g|= 3.38e-10  |ddm|= 5.64e-09
HOMO (B2u) = -0.30547028328092  LUMO (B3g) = -0.0108119391357427
cycle= 14 E= -75.2196533016653  delta_E= 8.53e-14  |g|= 4.47e-10  |ddm|= 6.63e-10
HOMO (B2u) = -0.305470283380819  LUMO (B3g) = -0.0108119392268189
cycle= 15 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 5.45e-10  |ddm|= 9.28e-10
HOMO (B2u) = -0.305470283318671  LUMO (B3g) = -0.0108119391709209
cycle= 16 E= -75.2196533016653  delta_E= -8.53e-14  |g|= 4.69e-10  |ddm|= 8.42e-10
HOMO (B2u) = -0.305470283328683  LUMO (B3g) = -0.0108119391823294
cycle= 17 E= -75.2196533016653  delta_E= 8.53e-14  |g|= 5.86e-10  |ddm|= 9.64e-10
HOMO (B2u) = -0.305470283317725  LUMO (B3g) = -0.0108119391767531
cycle= 18 E= -75.2196533016653  delta_E= -5.68e-14  |g|= 4.24e-10  |ddm|= 2.55e-10
HOMO (B2u) = -0.305470283329749  LUMO (B3g) = -0.0108119391864238
cycle= 19 E= -75.2196533016654  delta_E= -8.53e-14  |g|= 2.87e-10  |ddm|= 3e-10
HOMO (B2u) = -0.305470283344818  LUMO (B3g) = -0.0108119392016179
cycle= 20 E= -75.2196533016654  delta_E= -1.42e-14  |g|= 1.97e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.305470283348195  LUMO (B3g) = -0.0108119392084033
cycle= 21 E= -75.2196533016653  delta_E= 1.56e-13  |g|= 1.04e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.305470283348763  LUMO (B3g) = -0.0108119392083435
cycle= 22 E= -75.2196533016654  delta_E= -9.95e-14  |g|= 1.02e-10  |ddm|= 1.96e-11
HOMO (B2u) = -0.305470283349388  LUMO (B3g) = -0.0108119392095811
cycle= 23 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 9.01e-11  |ddm|= 3.46e-11
HOMO (B2u) = -0.305470283347031  LUMO (B3g) = -0.0108119392083794
cycle= 24 E= -75.2196533016653  delta_E=    0  |g|= 7.55e-11  |ddm|= 4.38e-11
HOMO (B2u) = -0.305470283347895  LUMO (B3g) = -0.0108119392112458
Extra cycle  E= -75.2196533016653  delta_E=    0  |g|= 2.49e-11  |ddm|= 8e-11
converged SCF energy = -75.2196533016653

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-nevpt2/tmp8l7dc4cq
max_memory 4000 MB (current use 320 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-nevpt2
integralFile           = /central/scratch/hczhai/st-07-01-ic-nevpt2/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-nevpt2/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3995087253748  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4185114041755  dE = -0.019002679  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4305668436542  dE = -0.012055439  S^2 = 0.0000000
               |grad[o]|=0.0825  |ddm|=0.132  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4361439009818  dE = -0.0055770573  S^2 = 0.0000000
               |grad[o]|=0.0449  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4375519165581  dE = -0.0014080156  S^2 = 0.0000000
               |grad[o]|=0.013  |ddm|=0.0914  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4380256239116  dE = -0.00047370735  S^2 = 0.0000000
               |grad[o]|=0.00692  |ddm|=0.0133  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4380958438932  dE = -7.0219982e-05  S^2 = 0.0000000
               |grad[o]|=0.0032  |ddm|=0.00727  |maxRot[o]|=0.0175
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4381037763663  dE = -7.932473e-06  S^2 = 0.0000000
               |grad[o]|=0.0013  |ddm|=0.00326  |maxRot[o]|=0.00586
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4381046435678  dE = -8.6720156e-07  S^2 = 0.0000000
               |grad[o]|=0.000463  |ddm|=0.00121  |maxRot[o]|=0.0019
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4381047367794  dE = -9.3211554e-08  S^2 = 0.0000000
               |grad[o]|=0.000156  |ddm|=0.000418  |maxRot[o]|=0.000616
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4381047467064  dE = -9.9270068e-09  S^2 = 0.0000000
               |grad[o]|=5.18e-05  |ddm|=0.00014  |maxRot[o]|=0.0002
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4381047477632  dE = -1.0568328e-09  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=4.62e-05  |maxRot[o]|=6.5e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.438104747875  dE = -1.1176837e-10  S^2 = 0.0000000
               |grad[o]|=5.58e-06  |ddm|=1.52e-05  |maxRot[o]|=2.12e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4381047478866  dE = -1.1624479e-11  S^2 = 0.0000000
               |grad[o]|=1.82e-06  |ddm|=4.99e-06  |maxRot[o]|=6.9e-06
2-step CASSCF converged in 13 macro (48 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95522558 1.93933508 1.79648698 1.55867498 0.44475735 0.05897222
 0.05365785 0.19288996]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01249   0.01101  -0.00075   0.00000   0.00000
  0 C 2s       0.70304   0.68783  -0.07328   0.00000   0.00000
  0 C 3s       0.00773   0.01395  -0.01813   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 2py     -0.00000   0.00000  -0.00000   0.70477   0.70699
  0 C 2pz      0.07361  -0.16270   0.70188  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3py      0.00000   0.00000  -0.00000   0.05427   0.01126
  0 C 3pz     -0.00668  -0.00182   0.02850   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.01889   0.00635
  0 C 3dz^2    0.00731  -0.00827   0.02845   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 0 C 3dx2-y2   0.00258   0.00545  -0.00616  -0.00000  -0.00000
  1 C 1s       0.01249  -0.01101  -0.00075   0.00000   0.00000
  1 C 2s       0.70304  -0.68783  -0.07328  -0.00000  -0.00000
  1 C 3s       0.00773  -0.01395  -0.01813  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 2py     -0.00000   0.00000   0.00000   0.70477  -0.70699
  1 C 2pz     -0.07361  -0.16270  -0.70188  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3py      0.00000  -0.00000  -0.00000   0.05427  -0.01126
  1 C 3pz      0.00668  -0.00182  -0.02850   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01889   0.00635
  1 C 3dz^2    0.00731   0.00827   0.02845   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 1 C 3dx2-y2   0.00258  -0.00545  -0.00616   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00014
  0 C 2s      -0.00000   0.00000   0.16232
  0 C 3s       0.00000  -0.00000   0.02153
  0 C 2px      0.69477   0.69952  -0.00000
  0 C 2py      0.00000  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.68780
  0 C 3px     -0.07060  -0.02872  -0.00000
  0 C 3py      0.00000   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00644
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00067
  0 C 3dxz    -0.11095  -0.09923  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00851
  1 C 1s       0.00000   0.00000   0.00014
  1 C 2s       0.00000   0.00000  -0.16232
  1 C 3s      -0.00000   0.00000  -0.02153
  1 C 2px      0.69477  -0.69952   0.00000
  1 C 2py      0.00000  -0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68780
  1 C 3px     -0.07060   0.02872   0.00000
  1 C 3py     -0.00000   0.00000   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00644
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00067
  1 C 3dxz     0.11095  -0.09923  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00851
<CAS-nat-orb|mo-hf>  3  3    0.99475642
<CAS-nat-orb|mo-hf>  4  4    0.99950402
<CAS-nat-orb|mo-hf>  5  5    0.99460067
<CAS-nat-orb|mo-hf>  6  6    0.99808720
<CAS-nat-orb|mo-hf>  7  7    0.99017070
<CAS-nat-orb|mo-hf>  8  8    0.93329646
<CAS-nat-orb|mo-hf>  9  9    0.96133984
<CAS-nat-orb|mo-hf>  10  10    0.97346862
CASSCF energy = -75.4381047478866
CASCI E = -75.4381047478866  E(CI) = -14.5778600953512  S^2 = 0.0000000
Density matrix diagonal elements [1.95522571 1.93933514 1.79648724 1.5586749  0.44475743 0.05897173
 0.05365804 0.19288982]
i = 1  <i|F|i> = -11.34208370
i = 2  <i|F|i> = -11.34246992
i = 3  <i|F|i> =  -0.77124251
i = 4  <i|F|i> =  -0.65257890
i = 5  <i|F|i> =  -0.31277562
i = 6  <i|F|i> =  -0.23161106
i = 7  <i|F|i> =  -0.02270276
i = 8  <i|F|i> =   0.11997316
i = 9  <i|F|i> =   0.16399560
i = 10  <i|F|i> =   0.14146451
i = 11  <i|F|i> =   0.64430107
i = 12  <i|F|i> =   0.67789822
i = 13  <i|F|i> =   0.61943246
i = 14  <i|F|i> =   0.72309183
i = 15  <i|F|i> =   0.73224843
i = 16  <i|F|i> =   0.71746391
i = 17  <i|F|i> =   0.82904595
i = 18  <i|F|i> =   0.98534401
i = 19  <i|F|i> =   1.25394109
i = 20  <i|F|i> =   1.28737462
i = 21  <i|F|i> =   1.29135053
i = 22  <i|F|i> =   1.37879798
i = 23  <i|F|i> =   1.37886901
i = 24  <i|F|i> =   1.42356952
i = 25  <i|F|i> =   1.42331924
i = 26  <i|F|i> =   1.54672073
i = 27  <i|F|i> =   1.59462605
i = 28  <i|F|i> =   2.01724529
......production of RDMs took       1.88 sec
......reading the RDM took          0.42 sec
......production of RDMs took      26.49 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.85 sec

E(WickICNEVPT2-ijrs) =    -0.00030999539000
E(WickICNEVPT2- rsi) =    -0.00084795910637
E(WickICNEVPT2- ijr) =    -0.00025072143972
E(WickICNEVPT2-  rs) =    -0.03236933243770
E(WickICNEVPT2-  ij) =    -0.00004859778704
E(WickICNEVPT2-  ir) =    -0.00097411882801
E(WickICNEVPT2-   r) =    -0.06192990383416
E(WickICNEVPT2-   i) =    -0.00003771491643
E(WickICNEVPT2) = -75.53487309162604  E_corr_pt = -0.0967683437394229
Timings = pdms =   38.62 | eris =    0.62 | ijrs =    0.02 | rsi =    0.02 | ijr =    0.01 | rs =    0.30 | ij =    0.07 | ir =    0.15 | r =    2.34 | i =    0.92 | total =   43.07
Time cost =    109.438
