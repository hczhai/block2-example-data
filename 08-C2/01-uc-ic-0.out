#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 14:36:12 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.952518979656 AA    0.000000000000   0.000000000000   1.800000000000 Bohr   0.0

nuclear repulsion = 20
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  0.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:         2.98


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpp1e4ggy3
max_memory 4000 MB (current use 70 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.1366469280558

WARN: Singularity detected in overlap matrix (condition number = 1.91e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.411563442743742  LUMO (Ag) = -0.232616164544875
cycle= 1 E= -75.1160073846338  delta_E= 1.02  |g|= 0.175  |ddm|= 1.65
HOMO (B1u) = -0.462886704875275  LUMO (Ag) = -0.0990177048643894
cycle= 2 E= -75.1270298311364  delta_E= -0.011  |g|= 0.057  |ddm|= 0.233
HOMO (B1u) = -0.438000780243466  LUMO (Ag) = -0.0789293202815889
cycle= 3 E= -75.1282984729017  delta_E= -0.00127  |g|= 0.0157  |ddm|= 0.191
HOMO (B1u) = -0.440879448397979  LUMO (Ag) = -0.0869420301347693
cycle= 4 E= -75.1284487654916  delta_E= -0.00015  |g|= 0.00222  |ddm|= 0.0862
HOMO (B1u) = -0.441380240119146  LUMO (Ag) = -0.0882782976431981
cycle= 5 E= -75.1284520756329  delta_E= -3.31e-06  |g|= 0.000419  |ddm|= 0.0158
HOMO (B1u) = -0.441351661772559  LUMO (Ag) = -0.0881933274529098
cycle= 6 E= -75.1284521927704  delta_E= -1.17e-07  |g|= 2.77e-05  |ddm|= 0.00246
HOMO (B1u) = -0.441354048137817  LUMO (Ag) = -0.0881978149646854
cycle= 7 E= -75.1284521931898  delta_E= -4.19e-10  |g|= 1.77e-06  |ddm|= 0.000613
HOMO (B1u) = -0.441354076509809  LUMO (Ag) = -0.0881971474461383
cycle= 8 E= -75.128452193191  delta_E= -1.14e-12  |g|= 1.61e-07  |ddm|= 3.45e-05
HOMO (B1u) = -0.441354065704933  LUMO (Ag) = -0.0881971923687671
cycle= 9 E= -75.128452193191  delta_E= -5.68e-14  |g|= 1.18e-08  |ddm|= 1.67e-06
HOMO (B1u) = -0.441354065626742  LUMO (Ag) = -0.0881971880043362
cycle= 10 E= -75.128452193191  delta_E= 2.84e-14  |g|= 5.48e-09  |ddm|= 1.02e-07
HOMO (B1u) = -0.441354065553645  LUMO (Ag) = -0.0881971874777128
cycle= 11 E= -75.1284521931909  delta_E= 9.95e-14  |g|= 6.51e-10  |ddm|= 4.11e-08
HOMO (B1u) = -0.44135406554474  LUMO (Ag) = -0.0881971874551356
cycle= 12 E= -75.128452193191  delta_E= -4.26e-14  |g|= 4.39e-10  |ddm|= 1.36e-09
HOMO (B1u) = -0.441354065568057  LUMO (Ag) = -0.0881971875267269
cycle= 13 E= -75.128452193191  delta_E= -8.53e-14  |g|= 3.63e-10  |ddm|= 1.48e-09
HOMO (B1u) = -0.441354065533061  LUMO (Ag) = -0.088197187462962
cycle= 14 E= -75.1284521931911  delta_E= -1.42e-14  |g|= 3.28e-10  |ddm|= 2.1e-09
HOMO (B1u) = -0.44135406549911  LUMO (Ag) = -0.0881971874060817
cycle= 15 E= -75.128452193191  delta_E= 1.42e-14  |g|= 4e-10  |ddm|= 4.88e-09
HOMO (B1u) = -0.441354065482266  LUMO (Ag) = -0.0881971874619458
cycle= 16 E= -75.1284521931911  delta_E= -2.84e-14  |g|= 4.25e-10  |ddm|= 1.09e-08
HOMO (B1u) = -0.441354065534085  LUMO (Ag) = -0.0881971875091683
cycle= 17 E= -75.128452193191  delta_E= 4.26e-14  |g|= 4.37e-10  |ddm|= 6.58e-10
HOMO (B1u) = -0.441354065582171  LUMO (Ag) = -0.0881971875247017
cycle= 18 E= -75.128452193191  delta_E= 4.26e-14  |g|= 1.75e-10  |ddm|= 3.91e-09
HOMO (B1u) = -0.441354065573672  LUMO (Ag) = -0.0881971875099039
cycle= 19 E= -75.128452193191  delta_E= 1.42e-14  |g|= 6.36e-11  |ddm|= 1.05e-09
HOMO (B1u) = -0.441354065569941  LUMO (Ag) = -0.088197187505782
cycle= 20 E= -75.128452193191  delta_E= -1.42e-14  |g|= 5.29e-11  |ddm|= 5.66e-11
HOMO (B1u) = -0.441354065566822  LUMO (Ag) = -0.0881971875029072
cycle= 21 E= -75.128452193191  delta_E=    0  |g|= 4.76e-11  |ddm|= 2.7e-11
HOMO (B1u) = -0.441354065556722  LUMO (Ag) = -0.0881971874850226
Extra cycle  E= -75.1284521931911  delta_E= -1.14e-13  |g|= 1.38e-11  |ddm|= 9.15e-11
converged SCF energy = -75.1284521931911

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpp1e4ggy3
max_memory 4000 MB (current use 82 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.2773851266806  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.29216125529  dE = -0.014776129  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.305453341827  dE = -0.013292087  S^2 = 0.0000000
               |grad[o]|=0.122  |ddm|=0.0317  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3171665948292  dE = -0.011713253  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|=0.022  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3257563368153  dE = -0.008589742  S^2 = 0.0000000
               |grad[o]|=0.0806  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3312100882418  dE = -0.0054537514  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.00664  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3353808805703  dE = -0.0041707923  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3388115062511  dE = -0.0034306257  S^2 = 0.0000000
               |grad[o]|=0.0423  |ddm|=0.00197  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3416937899069  dE = -0.0028822837  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.00139  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.3441068760508  dE = -0.0024130861  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.00119  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.346086894791  dE = -0.0019800187  S^2 = 0.0000000
               |grad[o]|=0.023  |ddm|=0.00138  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.3476533580243  dE = -0.0015664632  S^2 = 0.0000000
               |grad[o]|=0.0181  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.3488207494799  dE = -0.0011673915  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00222  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.3496021914654  dE = -0.00078144199  S^2 = 0.0000000
               |grad[o]|=0.00962  |ddm|=0.00269  |maxRot[o]|=0.0799
macro iter 14 (6 JK  0 micro), CASSCF E = -75.3500076019283  dE = -0.00040541046  S^2 = 0.0000000
               |grad[o]|=0.00596  |ddm|=0.00323  |maxRot[o]|=0.0799
macro iter 15 (4 JK  0 micro), CASSCF E = -75.3500690559467  dE = -6.1454018e-05  S^2 = 0.0000000
               |grad[o]|=0.00259  |ddm|=0.004  |maxRot[o]|=0.0356
macro iter 16 (3 JK  0 micro), CASSCF E = -75.3500711296791  dE = -2.0737324e-06  S^2 = 0.0000000
               |grad[o]|=0.000771  |ddm|=0.00302  |maxRot[o]|=0.0056
macro iter 17 (3 JK  0 micro), CASSCF E = -75.3500712273195  dE = -9.7640424e-08  S^2 = 0.0000000
               |grad[o]|=0.000204  |ddm|=0.00102  |maxRot[o]|=0.00111
macro iter 18 (3 JK  0 micro), CASSCF E = -75.3500712324682  dE = -5.1486637e-09  S^2 = 0.0000000
               |grad[o]|=5.3e-05  |ddm|=0.000289  |maxRot[o]|=0.000238
macro iter 19 (3 JK  0 micro), CASSCF E = -75.350071232753  dE = -2.8482816e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=6.97e-05  |maxRot[o]|=5.33e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.3500712327691  dE = -1.612932e-11  S^2 = 0.0000000
               |grad[o]|=3.36e-06  |ddm|=1.72e-05  |maxRot[o]|=1.23e-05
2-step CASSCF converged in 20 macro (102 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99117055 1.9483733  1.94837323 1.38207917 0.61632491 0.05352421
 0.05352413 0.0066305 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00026   0.00000   0.00000   0.00156  -0.00335
  0 C 2s       0.56540   0.00000  -0.00000   0.40871  -0.42139
  0 C 3s      -0.05874   0.00000  -0.00000   0.01072  -0.04347
  0 C 2px     -0.00000  -0.00000   0.70297  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70297  -0.00000  -0.00000  -0.00000
  0 C 2pz      0.41246   0.00000  -0.00000  -0.57668   0.56528
  0 C 3px      0.00000   0.00000  -0.06368  -0.00000   0.00000
  0 C 3py     -0.00000  -0.06368   0.00000  -0.00000  -0.00000
  0 C 3pz     -0.06271   0.00000  -0.00000  -0.01322  -0.02762
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.04218   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.05310   0.00000  -0.00000   0.01011   0.01522
  0 C 3dxz    -0.00000   0.00000   0.04218  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s      -0.00026   0.00000   0.00000  -0.00156  -0.00335
  1 C 2s       0.56540  -0.00000   0.00000  -0.40871  -0.42139
  1 C 3s      -0.05874  -0.00000   0.00000  -0.01072  -0.04347
  1 C 2px      0.00000  -0.00000   0.70297   0.00000  -0.00000
  1 C 2py      0.00000   0.70297  -0.00000   0.00000   0.00000
  1 C 2pz     -0.41246   0.00000   0.00000  -0.57668  -0.56528
  1 C 3px      0.00000  -0.00000  -0.06368   0.00000   0.00000
  1 C 3py      0.00000  -0.06368   0.00000   0.00000   0.00000
  1 C 3pz      0.06271   0.00000  -0.00000  -0.01322   0.02762
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.04218  -0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.05310  -0.00000   0.00000  -0.01011   0.01522
  1 C 3dxz    -0.00000   0.00000  -0.04218  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00117
  0 C 2s      -0.00000   0.00000   0.57006
  0 C 3s      -0.00000   0.00000  -0.05590
  0 C 2px      0.70510  -0.00000  -0.00000
  0 C 2py      0.00000   0.70510   0.00000
  0 C 2pz     -0.00000   0.00000   0.40146
  0 C 3px     -0.04754  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04754   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01218
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02390   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.10289
  0 C 3dxz    -0.02390  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00117
  1 C 2s       0.00000  -0.00000  -0.57006
  1 C 3s       0.00000  -0.00000   0.05590
  1 C 2px     -0.70510   0.00000   0.00000
  1 C 2py      0.00000  -0.70510  -0.00000
  1 C 2pz     -0.00000   0.00000   0.40146
  1 C 3px      0.04754   0.00000   0.00000
  1 C 3py      0.00000   0.04754  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01218
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02390   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.10289
  1 C 3dxz    -0.02390  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99656097
<CAS-nat-orb|mo-hf>  4  4    0.99984847
<CAS-nat-orb|mo-hf>  5  5    0.99984847
<CAS-nat-orb|mo-hf>  6  6    0.99856152
<CAS-nat-orb|mo-hf>  7  7    0.98495368
<CAS-nat-orb|mo-hf>  8  8    0.83784467
<CAS-nat-orb|mo-hf>  8  15   -0.54092854
<CAS-nat-orb|mo-hf>  9  9    0.83784453
<CAS-nat-orb|mo-hf>  9  16   -0.54092872
<CAS-nat-orb|mo-hf>  10  20   -0.80017035
CASSCF energy = -75.3500712327691
CASCI E = -75.3500712327691  E(CI) = -19.5186694186697  S^2 = 0.0000000
Time cost =    482.229
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 14:44:14 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.978977840202 AA    0.000000000000   0.000000000000   1.850000000000 Bohr   0.0

nuclear repulsion = 19.4594594594595
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       587.72


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp296ot7bo
max_memory 4000 MB (current use 167 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.0853308429703

WARN: Singularity detected in overlap matrix (condition number = 1.7e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.413580977369316  LUMO (Ag) = -0.227598981995081
cycle= 1 E= -75.172693617241  delta_E= 0.913  |g|= 0.173  |ddm|= 1.63
HOMO (B1u) = -0.471112350140236  LUMO (Ag) = -0.104670423689865
cycle= 2 E= -75.1835008238031  delta_E= -0.0108  |g|= 0.0557  |ddm|= 0.215
HOMO (B1u) = -0.445209609873388  LUMO (Ag) = -0.0826198965911255
cycle= 3 E= -75.1846477232623  delta_E= -0.00115  |g|= 0.0156  |ddm|= 0.166
HOMO (B1u) = -0.447439744130486  LUMO (Ag) = -0.0899048584713124
cycle= 4 E= -75.1847993820882  delta_E= -0.000152  |g|= 0.00222  |ddm|= 0.0841
HOMO (B1u) = -0.447984981890541  LUMO (Ag) = -0.0913127106239863
cycle= 5 E= -75.1848027365252  delta_E= -3.35e-06  |g|= 0.00041  |ddm|= 0.016
HOMO (B1u) = -0.447956467884101  LUMO (Ag) = -0.0912347091259222
cycle= 6 E= -75.1848028483201  delta_E= -1.12e-07  |g|= 2.74e-05  |ddm|= 0.00219
HOMO (B1u) = -0.447959917478173  LUMO (Ag) = -0.0912398214370592
cycle= 7 E= -75.184802848724  delta_E= -4.04e-10  |g|= 1.64e-06  |ddm|= 0.00057
HOMO (B1u) = -0.447959903825146  LUMO (Ag) = -0.0912392511181024
cycle= 8 E= -75.1848028487249  delta_E= -8.81e-13  |g|= 1.46e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.447959899406599  LUMO (Ag) = -0.0912392910095078
cycle= 9 E= -75.184802848725  delta_E= -1.14e-13  |g|= 1.12e-08  |ddm|= 1.31e-06
HOMO (B1u) = -0.447959898994043  LUMO (Ag) = -0.091239285821971
cycle= 10 E= -75.184802848725  delta_E= 5.68e-14  |g|= 5.76e-09  |ddm|= 8.39e-08
HOMO (B1u) = -0.447959899038164  LUMO (Ag) = -0.0912392856210514
cycle= 11 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 6.33e-10  |ddm|= 4.19e-08
HOMO (B1u) = -0.447959899083749  LUMO (Ag) = -0.0912392856775223
cycle= 12 E= -75.184802848725  delta_E= -2.84e-14  |g|= 4.3e-10  |ddm|= 1.46e-09
HOMO (B1u) = -0.447959899109049  LUMO (Ag) = -0.0912392857528564
cycle= 13 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 3.41e-10  |ddm|= 1.2e-09
HOMO (B1u) = -0.447959899057845  LUMO (Ag) = -0.0912392856770847
cycle= 14 E= -75.184802848725  delta_E= -5.68e-14  |g|= 3.35e-10  |ddm|= 1.57e-09
HOMO (B1u) = -0.447959899025961  LUMO (Ag) = -0.0912392856292301
cycle= 15 E= -75.184802848725  delta_E= 2.84e-14  |g|= 3.82e-10  |ddm|= 4.4e-09
HOMO (B1u) = -0.447959899031831  LUMO (Ag) = -0.0912392857013684
cycle= 16 E= -75.184802848725  delta_E=    0  |g|= 4.25e-10  |ddm|= 9.15e-09
HOMO (B1u) = -0.447959899081909  LUMO (Ag) = -0.0912392857455663
cycle= 17 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 4.42e-10  |ddm|= 4.66e-10
HOMO (B1u) = -0.447959899145388  LUMO (Ag) = -0.0912392857747673
cycle= 18 E= -75.1848028487249  delta_E=    0  |g|= 2.01e-10  |ddm|= 3.46e-09
HOMO (B1u) = -0.447959899127656  LUMO (Ag) = -0.0912392857540224
cycle= 19 E= -75.1848028487249  delta_E=    0  |g|= 6.68e-11  |ddm|= 1.01e-09
HOMO (B1u) = -0.447959899105962  LUMO (Ag) = -0.0912392857236003
Extra cycle  E= -75.1848028487249  delta_E=    0  |g|= 1.55e-11  |ddm|= 2.23e-10
converged SCF energy = -75.1848028487249

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp296ot7bo
max_memory 4000 MB (current use 169 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.335087523524  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3504688257659  dE = -0.015381302  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.364220941569  dE = -0.013752116  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0334  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.376254388767  dE = -0.012033447  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|=0.0229  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3841494399165  dE = -0.0078950511  S^2 = 0.0000000
               |grad[o]|=0.0782  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3894371369668  dE = -0.0052876971  S^2 = 0.0000000
               |grad[o]|=0.0619  |ddm|=0.00584  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.393580615446  dE = -0.0041434785  S^2 = 0.0000000
               |grad[o]|=0.0506  |ddm|=0.0029  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.397025971191  dE = -0.0034453557  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.00187  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3999303987027  dE = -0.0029044275  S^2 = 0.0000000
               |grad[o]|=0.0343  |ddm|=0.00135  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4023575425747  dE = -0.0024271439  S^2 = 0.0000000
               |grad[o]|=0.0279  |ddm|=0.00128  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4043337729413  dE = -0.0019762304  S^2 = 0.0000000
               |grad[o]|=0.0223  |ddm|=0.00152  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.405872606506  dE = -0.0015388336  S^2 = 0.0000000
               |grad[o]|=0.0173  |ddm|=0.00192  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4069843919809  dE = -0.0011117855  S^2 = 0.0000000
               |grad[o]|=0.0127  |ddm|=0.00237  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.407678772549  dE = -0.00069438057  S^2 = 0.0000000
               |grad[o]|=0.00858  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 14 (5 JK  0 micro), CASSCF E = -75.407930357833  dE = -0.00025158528  S^2 = 0.0000000
               |grad[o]|=0.00476  |ddm|=0.00338  |maxRot[o]|=0.0599
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4079625114612  dE = -3.2153628e-05  S^2 = 0.0000000
               |grad[o]|=0.00199  |ddm|=0.0033  |maxRot[o]|= 0.02
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4079663374752  dE = -3.826014e-06  S^2 = 0.0000000
               |grad[o]|=0.000823  |ddm|=0.00183  |maxRot[o]|=0.00719
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4079664742542  dE = -1.3677897e-07  S^2 = 0.0000000
               |grad[o]|=0.000218  |ddm|=0.00105  |maxRot[o]|=0.00136
macro iter 18 (3 JK  0 micro), CASSCF E = -75.407966480525  dE = -6.2708096e-09  S^2 = 0.0000000
               |grad[o]|=5.52e-05  |ddm|=0.000306  |maxRot[o]|=0.000269
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4079664808389  dE = -3.1387515e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.59e-05  |maxRot[o]|=5.69e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.407966480855  dE = -1.6171953e-11  S^2 = 0.0000000
               |grad[o]|=3.35e-06  |ddm|=1.8e-05  |maxRot[o]|=1.26e-05
2-step CASSCF converged in 20 macro (100 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99071502 1.94427775 1.94427796 1.40690755 0.59110188 0.05781808
 0.05781831 0.00708345]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00011   0.00000   0.00000   0.00165  -0.00303
  0 C 2s       0.56693  -0.00000   0.00000   0.41981  -0.41934
  0 C 3s      -0.05883   0.00000   0.00000   0.01056  -0.04125
  0 C 2px      0.00000  -0.00000   0.70357  -0.00000  -0.00000
  0 C 2py      0.00000   0.70357  -0.00000   0.00000   0.00000
  0 C 2pz      0.41060   0.00000   0.00000  -0.56869   0.56692
  0 C 3px      0.00000  -0.00000  -0.05731  -0.00000  -0.00000
  0 C 3py      0.00000  -0.05731  -0.00000  -0.00000   0.00000
  0 C 3pz     -0.06180   0.00000   0.00000  -0.01234  -0.02899
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.04122  -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.05218   0.00000   0.00000   0.00930   0.01419
  0 C 3dxz     0.00000  -0.00000   0.04122  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s      -0.00011   0.00000   0.00000  -0.00165  -0.00303
  1 C 2s       0.56693  -0.00000  -0.00000  -0.41981  -0.41934
  1 C 3s      -0.05883  -0.00000  -0.00000  -0.01056  -0.04125
  1 C 2px     -0.00000  -0.00000   0.70357   0.00000   0.00000
  1 C 2py     -0.00000   0.70357   0.00000   0.00000  -0.00000
  1 C 2pz     -0.41060  -0.00000   0.00000  -0.56869  -0.56692
  1 C 3px     -0.00000   0.00000  -0.05731   0.00000   0.00000
  1 C 3py     -0.00000  -0.05731   0.00000   0.00000  -0.00000
  1 C 3pz      0.06180   0.00000   0.00000  -0.01234   0.02899
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.04122  -0.00000  -0.00000   0.00000
  1 C 3dz^2    0.05218   0.00000  -0.00000  -0.00930   0.01419
  1 C 3dxz     0.00000  -0.00000  -0.04122  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00113
  0 C 2s       0.00000  -0.00000   0.56365
  0 C 3s       0.00000  -0.00000  -0.05372
  0 C 2px      0.70531   0.00000   0.00000
  0 C 2py      0.00000   0.70531   0.00000
  0 C 2pz      0.00000   0.00000   0.41389
  0 C 3px     -0.04437   0.00000   0.00000
  0 C 3py      0.00000  -0.04437   0.00000
  0 C 3pz      0.00000  -0.00000  -0.01152
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02384   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.08932
  0 C 3dxz    -0.02384   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00113
  1 C 2s      -0.00000  -0.00000  -0.56365
  1 C 3s      -0.00000   0.00000   0.05372
  1 C 2px     -0.70531  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70531  -0.00000
  1 C 2pz      0.00000  -0.00000   0.41389
  1 C 3px      0.04437  -0.00000  -0.00000
  1 C 3py     -0.00000   0.04437  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.01152
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02384   0.00000
  1 C 3dz^2   -0.00000   0.00000   0.08932
  1 C 3dxz    -0.02384   0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99647819
<CAS-nat-orb|mo-hf>  4  4    0.99985488
<CAS-nat-orb|mo-hf>  5  5    0.99985488
<CAS-nat-orb|mo-hf>  6  6    0.99860559
<CAS-nat-orb|mo-hf>  7  7    0.98449183
<CAS-nat-orb|mo-hf>  8  8    0.85083670
<CAS-nat-orb|mo-hf>  8  15   -0.52116437
<CAS-nat-orb|mo-hf>  9  9    0.85083700
<CAS-nat-orb|mo-hf>  9  16   -0.52116393
<CAS-nat-orb|mo-hf>  10  20   -0.78474240
CASSCF energy = -75.407966480855
CASCI E = -75.407966480855  E(CI) = -19.3366965246132  S^2 = 0.0000000
Time cost =    706.052
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 14:56:00 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.005436700748 AA    0.000000000000   0.000000000000   1.900000000000 Bohr   0.0

nuclear repulsion = 18.9473684210526
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   0.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1459.38


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp2qv6i9g0
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.031041178399

WARN: Singularity detected in overlap matrix (condition number = 1.52e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.39498553715523  LUMO (Ag) = -0.222680456230757
cycle= 1 E= -75.2198455234797  delta_E= 0.811  |g|= 0.173  |ddm|= 1.61
HOMO (B1u) = -0.479415237903265  LUMO (Ag) = -0.109973136342066
cycle= 2 E= -75.2305447304663  delta_E= -0.0107  |g|= 0.0546  |ddm|= 0.201
HOMO (B1u) = -0.452535964635349  LUMO (Ag) = -0.0860888408725827
cycle= 3 E= -75.2315902210701  delta_E= -0.00105  |g|= 0.0153  |ddm|= 0.145
HOMO (B1u) = -0.45410326382499  LUMO (Ag) = -0.0925462170063918
cycle= 4 E= -75.2317373690303  delta_E= -0.000147  |g|= 0.00222  |ddm|= 0.0805
HOMO (B1u) = -0.454675048897533  LUMO (Ag) = -0.0940058731975904
cycle= 5 E= -75.2317407777114  delta_E= -3.41e-06  |g|= 0.0004  |ddm|= 0.0162
HOMO (B1u) = -0.454646635749827  LUMO (Ag) = -0.0939357427361134
cycle= 6 E= -75.231740884219  delta_E= -1.07e-07  |g|= 2.7e-05  |ddm|= 0.00191
HOMO (B1u) = -0.454651041484014  LUMO (Ag) = -0.0939413575689308
cycle= 7 E= -75.2317408846097  delta_E= -3.91e-10  |g|= 1.59e-06  |ddm|= 0.000529
HOMO (B1u) = -0.454650997156078  LUMO (Ag) = -0.0939408954912718
cycle= 8 E= -75.2317408846106  delta_E= -9.24e-13  |g|= 1.33e-07  |ddm|= 2.94e-05
HOMO (B1u) = -0.454650997886312  LUMO (Ag) = -0.093940927386887
cycle= 9 E= -75.2317408846106  delta_E= 1.42e-14  |g|= 9.79e-09  |ddm|= 1.1e-06
HOMO (B1u) = -0.454650996883733  LUMO (Ag) = -0.0939409222273261
cycle= 10 E= -75.2317408846106  delta_E= -1.42e-14  |g|= 6.07e-09  |ddm|= 5.23e-08
HOMO (B1u) = -0.454650997076365  LUMO (Ag) = -0.0939409224026677
cycle= 11 E= -75.2317408846107  delta_E= -2.84e-14  |g|= 6.37e-10  |ddm|= 4.13e-08
HOMO (B1u) = -0.454650997097169  LUMO (Ag) = -0.0939409224173116
cycle= 12 E= -75.2317408846107  delta_E= 1.42e-14  |g|= 4.17e-10  |ddm|= 1.61e-09
HOMO (B1u) = -0.454650997114628  LUMO (Ag) = -0.0939409225001122
cycle= 13 E= -75.2317408846106  delta_E= 9.95e-14  |g|= 3.39e-10  |ddm|= 6.21e-10
HOMO (B1u) = -0.454650997062704  LUMO (Ag) = -0.0939409224280599
cycle= 14 E= -75.2317408846107  delta_E= -1.28e-13  |g|= 3.58e-10  |ddm|= 5.76e-10
HOMO (B1u) = -0.454650997041243  LUMO (Ag) = -0.0939409223984034
cycle= 15 E= -75.2317408846107  delta_E= 1.42e-14  |g|= 3.68e-10  |ddm|= 3.61e-09
HOMO (B1u) = -0.454650997046752  LUMO (Ag) = -0.0939409224491072
cycle= 16 E= -75.2317408846106  delta_E= 2.84e-14  |g|= 3.8e-10  |ddm|= 5.28e-09
HOMO (B1u) = -0.454650997122019  LUMO (Ag) = -0.0939409225146574
cycle= 17 E= -75.2317408846107  delta_E= -2.84e-14  |g|= 4.27e-10  |ddm|= 9.86e-10
HOMO (B1u) = -0.454650997188976  LUMO (Ag) = -0.0939409225489129
cycle= 18 E= -75.2317408846106  delta_E= 7.11e-14  |g|= 2.26e-10  |ddm|= 2.6e-09
HOMO (B1u) = -0.454650997162522  LUMO (Ag) = -0.0939409225225419
cycle= 19 E= -75.2317408846106  delta_E=    0  |g|= 7.07e-11  |ddm|= 9.43e-10
HOMO (B1u) = -0.454650997140105  LUMO (Ag) = -0.0939409224891167
Extra cycle  E= -75.2317408846108  delta_E= -1.56e-13  |g|= 1.73e-11  |ddm|= 2.97e-10
converged SCF energy = -75.2317408846108

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp2qv6i9g0
max_memory 4000 MB (current use 166 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3834026666695  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3993895752133  dE = -0.015986909  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4135906512377  dE = -0.014201076  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0352  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4257782802767  dE = -0.012187629  S^2 = 0.0000000
               |grad[o]|=0.0987  |ddm|=0.0239  |maxRot[o]|=0.0787
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4331189720403  dE = -0.0073406918  S^2 = 0.0000000
               |grad[o]|=0.0761  |ddm|=0.0138  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4382734993378  dE = -0.0051545273  S^2 = 0.0000000
               |grad[o]|=0.0608  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4423993023535  dE = -0.004125803  S^2 = 0.0000000
               |grad[o]|=0.0498  |ddm|=0.00272  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4458591691174  dE = -0.0034598668  S^2 = 0.0000000
               |grad[o]|=0.041  |ddm|=0.00177  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4487792692901  dE = -0.0029201002  S^2 = 0.0000000
               |grad[o]|=0.0336  |ddm|=0.00136  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4512079251546  dE = -0.0024286559  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.0014  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.453161892988  dE = -0.0019539678  S^2 = 0.0000000
               |grad[o]|=0.0215  |ddm|=0.00171  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4546486323563  dE = -0.0014867394  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4556742884704  dE = -0.0010256561  S^2 = 0.0000000
               |grad[o]|=0.0116  |ddm|=0.00257  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.456244193239  dE = -0.00056990477  S^2 = 0.0000000
               |grad[o]|=0.00729  |ddm|=0.00301  |maxRot[o]|=0.0799
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4563598640014  dE = -0.00011567076  S^2 = 0.0000000
               |grad[o]|=0.00332  |ddm|=0.00359  |maxRot[o]|= 0.04
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4563704251768  dE = -1.0561175e-05  S^2 = 0.0000000
               |grad[o]|=0.00121  |ddm|=0.00264  |maxRot[o]|=0.0119
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4563707480314  dE = -3.2285466e-07  S^2 = 0.0000000
               |grad[o]|=0.000317  |ddm|=0.00143  |maxRot[o]|=0.0021
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4563707612965  dE = -1.3265094e-08  S^2 = 0.0000000
               |grad[o]|=7.82e-05  |ddm|=0.000427  |maxRot[o]|=0.000394
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4563707619109  dE = -6.1437788e-10  S^2 = 0.0000000
               |grad[o]|=1.87e-05  |ddm|=0.000113  |maxRot[o]|=7.93e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.456370761939  dE = -2.8080649e-11  S^2 = 0.0000000
               |grad[o]|=4.01e-06  |ddm|=2.09e-05  |maxRot[o]|=1.68e-05
2-step CASSCF converged in 19 macro (96 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99022078 1.9399813  1.93998148 1.43110823 0.56650677 0.06231562
 0.0623158  0.00757002]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00012   0.00000   0.00000   0.00176  -0.00276
  0 C 2s       0.56879   0.00000   0.00000   0.43063  -0.41683
  0 C 3s      -0.05868   0.00000   0.00000   0.01038  -0.03881
  0 C 2px     -0.00000   0.00000   0.70409  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70409   0.00000   0.00000   0.00000
  0 C 2pz      0.40833   0.00000   0.00000  -0.56057   0.56889
  0 C 3px     -0.00000   0.00000  -0.05130  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.05130  -0.00000   0.00000  -0.00000
  0 C 3pz     -0.06076   0.00000  -0.00000  -0.01148  -0.03034
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.04026  -0.00000   0.00000  -0.00000
  0 C 3dz^2    0.05111   0.00000   0.00000   0.00848   0.01325
  0 C 3dxz    -0.00000   0.00000   0.04026  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00012   0.00000   0.00000  -0.00176  -0.00276
  1 C 2s       0.56879  -0.00000  -0.00000  -0.43063  -0.41683
  1 C 3s      -0.05868  -0.00000  -0.00000  -0.01038  -0.03881
  1 C 2px      0.00000  -0.00000   0.70409   0.00000   0.00000
  1 C 2py      0.00000   0.70409   0.00000   0.00000   0.00000
  1 C 2pz     -0.40833  -0.00000   0.00000  -0.56057  -0.56889
  1 C 3px      0.00000  -0.00000  -0.05130   0.00000   0.00000
  1 C 3py      0.00000  -0.05130   0.00000  -0.00000   0.00000
  1 C 3pz      0.06076   0.00000   0.00000  -0.01148   0.03034
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.04026  -0.00000   0.00000  -0.00000
  1 C 3dz^2    0.05111  -0.00000  -0.00000  -0.00848   0.01325
  1 C 3dxz    -0.00000   0.00000  -0.04026  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00109
  0 C 2s       0.00000   0.00000   0.55672
  0 C 3s      -0.00000   0.00000  -0.05173
  0 C 2px      0.70549  -0.00000   0.00000
  0 C 2py      0.00000   0.70549   0.00000
  0 C 2pz      0.00000  -0.00000   0.42574
  0 C 3px     -0.04149  -0.00000   0.00000
  0 C 3py     -0.00000  -0.04149   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01023
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02382   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.07763
  0 C 3dxz    -0.02382  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00109
  1 C 2s      -0.00000  -0.00000  -0.55672
  1 C 3s       0.00000  -0.00000   0.05173
  1 C 2px     -0.70549  -0.00000  -0.00000
  1 C 2py      0.00000  -0.70549   0.00000
  1 C 2pz      0.00000   0.00000   0.42574
  1 C 3px      0.04149   0.00000  -0.00000
  1 C 3py     -0.00000   0.04149  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01023
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.07763
  1 C 3dxz    -0.02382  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99637511
<CAS-nat-orb|mo-hf>  4  4    0.99985872
<CAS-nat-orb|mo-hf>  5  5    0.99985872
<CAS-nat-orb|mo-hf>  6  6    0.99864217
<CAS-nat-orb|mo-hf>  7  7    0.98400068
<CAS-nat-orb|mo-hf>  8  8    0.86287869
<CAS-nat-orb|mo-hf>  8  15   -0.50178860
<CAS-nat-orb|mo-hf>  9  9    0.86287886
<CAS-nat-orb|mo-hf>  9  16   -0.50178832
<CAS-nat-orb|mo-hf>  10  20   -0.76833535
CASSCF energy = -75.456370761939
CASCI E = -75.456370761939  E(CI) = -19.157786508775  S^2 = 0.0000000
Time cost =    523.122
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:04:43 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.031895561294 AA    0.000000000000   0.000000000000   1.950000000000 Bohr   0.0

nuclear repulsion = 18.4615384615385
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      1912.67


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpzpi_kgex
max_memory 4000 MB (current use 172 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9746920535549

WARN: Singularity detected in overlap matrix (condition number = 1.36e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.376946372482714  LUMO (Ag) = -0.217906597905048
cycle= 1 E= -75.2586399523511  delta_E= 0.716  |g|= 0.174  |ddm|=  1.6
HOMO (B1u) = -0.487753910327477  LUMO (Ag) = -0.114938505564517
cycle= 2 E= -75.2693410539255  delta_E= -0.0107  |g|= 0.0537  |ddm|= 0.193
HOMO (B1u) = -0.459920537702702  LUMO (Ag) = -0.0893203899470906
cycle= 3 E= -75.2703049843484  delta_E= -0.000964  |g|= 0.0148  |ddm|= 0.127
HOMO (B1u) = -0.460845458131852  LUMO (Ag) = -0.0948990398153166
cycle= 4 E= -75.2704430756293  delta_E= -0.000138  |g|= 0.00223  |ddm|= 0.0758
HOMO (B1u) = -0.46142649405618  LUMO (Ag) = -0.0963896216507959
cycle= 5 E= -75.2704465290253  delta_E= -3.45e-06  |g|= 0.00039  |ddm|= 0.0164
HOMO (B1u) = -0.461398372411752  LUMO (Ag) = -0.0963285783601123
cycle= 6 E= -75.270446630032  delta_E= -1.01e-07  |g|= 2.67e-05  |ddm|= 0.00163
HOMO (B1u) = -0.461403601387675  LUMO (Ag) = -0.0963346266369743
cycle= 7 E= -75.2704466304108  delta_E= -3.79e-10  |g|= 1.62e-06  |ddm|= 0.000491
HOMO (B1u) = -0.461403547807349  LUMO (Ag) = -0.0963342779054391
cycle= 8 E= -75.2704466304118  delta_E= -9.95e-13  |g|= 1.22e-07  |ddm|= 2.97e-05
HOMO (B1u) = -0.461403551923834  LUMO (Ag) = -0.0963343022401018
cycle= 9 E= -75.2704466304118  delta_E= -1.42e-14  |g|= 8.39e-09  |ddm|= 9.29e-07
HOMO (B1u) = -0.461403550345067  LUMO (Ag) = -0.0963342976558249
cycle= 10 E= -75.2704466304118  delta_E=    0  |g|= 6.38e-09  |ddm|= 2.39e-08
HOMO (B1u) = -0.461403550628465  LUMO (Ag) = -0.0963342981105717
cycle= 11 E= -75.270446630412  delta_E= -1.56e-13  |g|= 6.1e-10  |ddm|= 3.93e-08
HOMO (B1u) = -0.461403550659772  LUMO (Ag) = -0.0963342981429877
cycle= 12 E= -75.2704466304119  delta_E= 8.53e-14  |g|= 4.16e-10  |ddm|= 1.24e-09
HOMO (B1u) = -0.461403550692827  LUMO (Ag) = -0.0963342982251243
cycle= 13 E= -75.2704466304118  delta_E= 8.53e-14  |g|= 3.48e-10  |ddm|= 4.12e-10
HOMO (B1u) = -0.461403550632739  LUMO (Ag) = -0.0963342981528765
cycle= 14 E= -75.2704466304119  delta_E= -8.53e-14  |g|= 3.49e-10  |ddm|= 3.68e-10
HOMO (B1u) = -0.461403550574115  LUMO (Ag) = -0.0963342981169664
cycle= 15 E= -75.2704466304119  delta_E= 2.84e-14  |g|= 3.81e-10  |ddm|= 1.49e-09
HOMO (B1u) = -0.461403550647103  LUMO (Ag) = -0.0963342981903721
cycle= 16 E= -75.2704466304119  delta_E=    0  |g|= 3.58e-10  |ddm|= 1.94e-09
HOMO (B1u) = -0.461403550698048  LUMO (Ag) = -0.0963342982330115
cycle= 17 E= -75.2704466304119  delta_E= -2.84e-14  |g|= 4.18e-10  |ddm|= 5.93e-10
HOMO (B1u) = -0.461403550757521  LUMO (Ag) = -0.0963342982640893
cycle= 18 E= -75.2704466304119  delta_E= -5.68e-14  |g|= 2.54e-10  |ddm|= 1.74e-09
HOMO (B1u) = -0.461403550723491  LUMO (Ag) = -0.0963342982329197
cycle= 19 E= -75.2704466304119  delta_E= 2.84e-14  |g|= 7.7e-11  |ddm|= 8.43e-10
HOMO (B1u) = -0.461403550718578  LUMO (Ag) = -0.0963342982276666
cycle= 20 E= -75.2704466304119  delta_E=    0  |g|= 6.46e-11  |ddm|= 5.39e-11
HOMO (B1u) = -0.461403550704124  LUMO (Ag) = -0.096334298202939
Extra cycle  E= -75.2704466304119  delta_E= 2.84e-14  |g|= 1.69e-11  |ddm|= 2.87e-10
converged SCF energy = -75.2704466304119

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpzpi_kgex
max_memory 4000 MB (current use 174 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4235309438987  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4401210471516  dE = -0.016590103  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4547605469453  dE = -0.0146395  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0372  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4667277351409  dE = -0.011967188  S^2 = 0.0000000
               |grad[o]|=0.0972  |ddm|=0.0249  |maxRot[o]|=0.0768
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4737200297878  dE = -0.0069922946  S^2 = 0.0000000
               |grad[o]|=0.0746  |ddm|=0.0134  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4788108824187  dE = -0.0050908526  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.00488  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4829510191132  dE = -0.0041401367  S^2 = 0.0000000
               |grad[o]|=0.0492  |ddm|=0.00261  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4864411688596  dE = -0.0034901497  S^2 = 0.0000000
               |grad[o]|=0.0404  |ddm|=0.00172  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4893827132693  dE = -0.0029415444  S^2 = 0.0000000
               |grad[o]|=0.0329  |ddm|=0.00143  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4918101611022  dE = -0.0024274478  S^2 = 0.0000000
               |grad[o]|=0.0264  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4937310872024  dE = -0.0019209261  S^2 = 0.0000000
               |grad[o]|=0.0205  |ddm|=0.00194  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4951471171327  dE = -0.0014160299  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00236  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4960600255512  dE = -0.00091290842  S^2 = 0.0000000
               |grad[o]|=0.0103  |ddm|=0.00278  |maxRot[o]|=0.0799
macro iter 13 (5 JK  0 micro), CASSCF E = -75.4964166727057  dE = -0.00035664715  S^2 = 0.0000000
               |grad[o]|=0.00583  |ddm|=0.00322  |maxRot[o]|=0.0599
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4964898899805  dE = -7.3217275e-05  S^2 = 0.0000000
               |grad[o]|=0.0026  |ddm|=0.00297  |maxRot[o]|=0.0347
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4964915888359  dE = -1.6988554e-06  S^2 = 0.0000000
               |grad[o]|=0.000643  |ddm|=0.00246  |maxRot[o]|=0.00494
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4964916480309  dE = -5.9194988e-08  S^2 = 0.0000000
               |grad[o]|=0.000153  |ddm|=0.000803  |maxRot[o]|=0.000856
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4964916504785  dE = -2.447635e-09  S^2 = 0.0000000
               |grad[o]|=3.6e-05  |ddm|=0.000218  |maxRot[o]|=0.000159
macro iter 18 (3 JK  0 micro), CASSCF E = -75.4964916505853  dE = -1.0680878e-10  S^2 = 0.0000000
               |grad[o]|=8.02e-06  |ddm|=4.83e-05  |maxRot[o]|=3.2e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.4964916505898  dE = -4.4337867e-12  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=1.09e-05  |maxRot[o]|=6.69e-06
2-step CASSCF converged in 19 macro (95 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98968842 1.93548132 1.93548121 1.45436124 0.54286927 0.0670143
 0.06701424 0.00808999]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00041   0.00000   0.00000   0.00186  -0.00251
  0 C 2s       0.57092   0.00000   0.00000   0.44116  -0.41394
  0 C 3s      -0.05831   0.00000  -0.00000   0.01019  -0.03618
  0 C 2px      0.00000   0.00000   0.70454  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70454   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40572  -0.00000  -0.00000  -0.55236   0.57112
  0 C 3px      0.00000  -0.00000  -0.04561  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04561  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05958   0.00000  -0.00000  -0.01065  -0.03168
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.03931  -0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04991   0.00000  -0.00000   0.00767   0.01244
  0 C 3dxz     0.00000  -0.00000   0.03931  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00041   0.00000   0.00000  -0.00186  -0.00251
  1 C 2s       0.57092  -0.00000   0.00000  -0.44116  -0.41394
  1 C 3s      -0.05831  -0.00000   0.00000  -0.01019  -0.03618
  1 C 2px     -0.00000   0.00000   0.70454  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70454   0.00000   0.00000   0.00000
  1 C 2pz     -0.40572  -0.00000   0.00000  -0.55236  -0.57112
  1 C 3px     -0.00000  -0.00000  -0.04561   0.00000   0.00000
  1 C 3py      0.00000  -0.04561  -0.00000   0.00000   0.00000
  1 C 3pz      0.05958   0.00000   0.00000  -0.01065   0.03168
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03931   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04991  -0.00000  -0.00000  -0.00767   0.01244
  1 C 3dxz     0.00000   0.00000  -0.03931  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00105
  0 C 2s       0.00000   0.00000   0.54938
  0 C 3s      -0.00000  -0.00000  -0.04995
  0 C 2px      0.70564  -0.00000   0.00000
  0 C 2py     -0.00000   0.70564   0.00000
  0 C 2pz      0.00000  -0.00000   0.43709
  0 C 3px     -0.03887  -0.00000   0.00000
  0 C 3py     -0.00000  -0.03887  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.00850
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02381   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.06762
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00105
  1 C 2s       0.00000   0.00000  -0.54938
  1 C 3s      -0.00000   0.00000   0.04995
  1 C 2px     -0.70564   0.00000  -0.00000
  1 C 2py      0.00000  -0.70564  -0.00000
  1 C 2pz     -0.00000   0.00000   0.43709
  1 C 3px      0.03887   0.00000  -0.00000
  1 C 3py      0.00000   0.03887  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.00850
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02381   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.06762
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99625189
<CAS-nat-orb|mo-hf>  4  4    0.99986004
<CAS-nat-orb|mo-hf>  5  5    0.99986004
<CAS-nat-orb|mo-hf>  6  6    0.99867026
<CAS-nat-orb|mo-hf>  7  7    0.98348638
<CAS-nat-orb|mo-hf>  8  8    0.87399692
<CAS-nat-orb|mo-hf>  8  15   -0.48288163
<CAS-nat-orb|mo-hf>  9  9    0.87399683
<CAS-nat-orb|mo-hf>  9  16   -0.48288177
<CAS-nat-orb|mo-hf>  10  17    0.40709983
<CAS-nat-orb|mo-hf>  10  20   -0.75070510
CASSCF energy = -75.4964916505898
CASCI E = -75.4964916505898  E(CI) = -18.9821893903547  S^2 = 0.0000000
Time cost =    625.269
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:15:08 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.058354421840 AA    0.000000000000   0.000000000000   2.000000000000 Bohr   0.0

nuclear repulsion = 18
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 1.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      2595.04


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpkvl14nz4
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9170535172816

WARN: Singularity detected in overlap matrix (condition number = 1.22e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.359902883841541  LUMO (Ag) = -0.21330704303973
cycle= 1 E= -75.2901241201449  delta_E= 0.627  |g|= 0.175  |ddm|= 1.58
HOMO (B1u) = -0.496094054564504  LUMO (Ag) = -0.119573071329235
cycle= 2 E= -75.3009349666093  delta_E= -0.0108  |g|= 0.0531  |ddm|= 0.188
HOMO (B1u) = -0.467321073254815  LUMO (Ag) = -0.0923011554436188
cycle= 3 E= -75.3018357121932  delta_E= -0.000901  |g|= 0.0141  |ddm|= 0.113
HOMO (B1u) = -0.467647600574111  LUMO (Ag) = -0.0969889779106499
cycle= 4 E= -75.3019617797126  delta_E= -0.000126  |g|= 0.00222  |ddm|= 0.0704
HOMO (B1u) = -0.468220968325748  LUMO (Ag) = -0.0984869419679166
cycle= 5 E= -75.3019652459277  delta_E= -3.47e-06  |g|= 0.000378  |ddm|= 0.0164
HOMO (B1u) = -0.468193490312785  LUMO (Ag) = -0.0984366742323406
cycle= 6 E= -75.3019653408538  delta_E= -9.49e-08  |g|= 2.64e-05  |ddm|= 0.00134
HOMO (B1u) = -0.468199393066118  LUMO (Ag) = -0.098443126147323
cycle= 7 E= -75.3019653412214  delta_E= -3.68e-10  |g|= 1.72e-06  |ddm|= 0.000455
HOMO (B1u) = -0.46819935387089  LUMO (Ag) = -0.0984428907847664
cycle= 8 E= -75.3019653412227  delta_E= -1.22e-12  |g|= 1.15e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.468199359870208  LUMO (Ag) = -0.0984429094357044
cycle= 9 E= -75.3019653412226  delta_E= 5.68e-14  |g|= 7.48e-09  |ddm|= 7.76e-07
HOMO (B1u) = -0.468199357846816  LUMO (Ag) = -0.0984429054908239
cycle= 10 E= -75.3019653412227  delta_E= -8.53e-14  |g|= 6.65e-09  |ddm|= 7.73e-09
HOMO (B1u) = -0.468199358207453  LUMO (Ag) = -0.0984429061929038
cycle= 11 E= -75.3019653412226  delta_E= 7.11e-14  |g|= 6.18e-10  |ddm|= 3.45e-08
HOMO (B1u) = -0.468199358192985  LUMO (Ag) = -0.0984429061658824
cycle= 12 E= -75.3019653412227  delta_E= -9.95e-14  |g|= 3.88e-10  |ddm|= 1.55e-09
HOMO (B1u) = -0.468199358214409  LUMO (Ag) = -0.0984429062621653
cycle= 13 E= -75.3019653412227  delta_E= 5.68e-14  |g|= 3.66e-10  |ddm|= 5.11e-10
HOMO (B1u) = -0.468199358197304  LUMO (Ag) = -0.0984429062231798
cycle= 14 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 3.53e-10  |ddm|= 3.1e-10
HOMO (B1u) = -0.468199358148557  LUMO (Ag) = -0.098442906204018
cycle= 15 E= -75.3019653412226  delta_E= 5.68e-14  |g|= 3.79e-10  |ddm|= 3.64e-10
HOMO (B1u) = -0.468199358214104  LUMO (Ag) = -0.0984429062443553
cycle= 16 E= -75.3019653412227  delta_E= -8.53e-14  |g|= 3e-10  |ddm|= 8.64e-10
HOMO (B1u) = -0.468199358284454  LUMO (Ag) = -0.098442906301609
cycle= 17 E= -75.3019653412227  delta_E=    0  |g|= 4.07e-10  |ddm|= 9.47e-10
HOMO (B1u) = -0.468199358331782  LUMO (Ag) = -0.0984429063257027
cycle= 18 E= -75.3019653412226  delta_E= 4.26e-14  |g|= 2.61e-10  |ddm|= 1.08e-09
HOMO (B1u) = -0.46819935829123  LUMO (Ag) = -0.0984429062909828
cycle= 19 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 7.39e-11  |ddm|= 7e-10
HOMO (B1u) = -0.468199358286798  LUMO (Ag) = -0.0984429062860068
cycle= 20 E= -75.3019653412226  delta_E= 1.42e-14  |g|= 6.2e-11  |ddm|= 5.29e-11
HOMO (B1u) = -0.46819935828323  LUMO (Ag) = -0.0984429062823557
cycle= 21 E= -75.3019653412226  delta_E= -5.68e-14  |g|= 5.72e-11  |ddm|= 2.11e-11
HOMO (B1u) = -0.468199358282614  LUMO (Ag) = -0.0984429062788506
cycle= 22 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 5.04e-11  |ddm|= 5.89e-11
HOMO (B1u) = -0.468199358281321  LUMO (Ag) = -0.0984429062755639
cycle= 23 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 4.42e-11  |ddm|= 7.56e-11
HOMO (B1u) = -0.468199358279608  LUMO (Ag) = -0.0984429062694143
cycle= 24 E= -75.3019653412227  delta_E= 2.84e-14  |g|= 3.71e-11  |ddm|= 7.6e-11
HOMO (B1u) = -0.468199358278135  LUMO (Ag) = -0.0984429062652065
cycle= 25 E= -75.3019653412227  delta_E=    0  |g|= 2.96e-11  |ddm|= 4.06e-11
HOMO (B1u) = -0.468199358279178  LUMO (Ag) = -0.09844290626335
Extra cycle  E= -75.3019653412227  delta_E=    0  |g|= 8.51e-12  |ddm|= 1.1e-10
converged SCF energy = -75.3019653412227

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpkvl14nz4
max_memory 4000 MB (current use 166 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4565254955835  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4737144532507  dE = -0.017188958  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4887834603589  dE = -0.015069007  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0393  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5003060228575  dE = -0.011522562  S^2 = 0.0000000
               |grad[o]|=0.0957  |ddm|=0.0259  |maxRot[o]|=0.0796
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5070819970766  dE = -0.0067759742  S^2 = 0.0000000
               |grad[o]|=0.0736  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5121575588693  dE = -0.0050755618  S^2 = 0.0000000
               |grad[o]|=0.0594  |ddm|=0.00472  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5163346555919  dE = -0.0041770967  S^2 = 0.0000000
               |grad[o]|=0.0486  |ddm|=0.00258  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5198644569745  dE = -0.0035298014  S^2 = 0.0000000
               |grad[o]|=0.0398  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5228265620871  dE = -0.0029621051  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5252425455579  dE = -0.0024159835  S^2 = 0.0000000
               |grad[o]|=0.0255  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.527110580554  dE = -0.001868035  S^2 = 0.0000000
               |grad[o]|=0.0195  |ddm|=0.00221  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5284265120688  dE = -0.0013159315  S^2 = 0.0000000
               |grad[o]|=0.0139  |ddm|=0.00263  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5291872107433  dE = -0.00076069867  S^2 = 0.0000000
               |grad[o]|=0.00884  |ddm|=0.00303  |maxRot[o]|=0.0798
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5293600923573  dE = -0.00017288161  S^2 = 0.0000000
               |grad[o]|=0.00412  |ddm|=0.00349  |maxRot[o]|= 0.04
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5293894029149  dE = -2.9310558e-05  S^2 = 0.0000000
               |grad[o]|=0.00174  |ddm|=0.00233  |maxRot[o]|=0.0197
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5293900629002  dE = -6.599853e-07  S^2 = 0.0000000
               |grad[o]|=0.000421  |ddm|=0.00168  |maxRot[o]|=0.00302
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5293900845571  dE = -2.1656817e-08  S^2 = 0.0000000
               |grad[o]|=9.61e-05  |ddm|=0.000516  |maxRot[o]|=0.000499
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5293900854118  dE = -8.5472607e-10  S^2 = 0.0000000
               |grad[o]|=2.13e-05  |ddm|=0.000131  |maxRot[o]|=9.08e-05
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5293900854452  dE = -3.342393e-11  S^2 = 0.0000000
               |grad[o]|=4.17e-06  |ddm|=2.58e-05  |maxRot[o]|=1.78e-05
2-step CASSCF converged in 18 macro (91 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98911928 1.93077463 1.93077483 1.47651509 0.52034969 0.07191156
 0.07191178 0.00864315]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00076   0.00000   0.00000   0.00197  -0.00230
  0 C 2s       0.57327  -0.00000  -0.00000   0.45141  -0.41073
  0 C 3s      -0.05772  -0.00000   0.00000   0.00999  -0.03341
  0 C 2px     -0.00000   0.00000   0.70492   0.00000   0.00000
  0 C 2py     -0.00000   0.70492   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40282  -0.00000   0.00000  -0.54404   0.57355
  0 C 3px     -0.00000   0.00000  -0.04022   0.00000  -0.00000
  0 C 3py      0.00000  -0.04022  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05831  -0.00000   0.00000  -0.00984  -0.03298
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.03836   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04862  -0.00000   0.00000   0.00687   0.01178
  0 C 3dxz    -0.00000   0.00000   0.03836   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00076   0.00000   0.00000  -0.00197  -0.00230
  1 C 2s       0.57327   0.00000  -0.00000  -0.45141  -0.41073
  1 C 3s      -0.05772   0.00000  -0.00000  -0.00999  -0.03341
  1 C 2px      0.00000  -0.00000   0.70492  -0.00000   0.00000
  1 C 2py      0.00000   0.70492   0.00000   0.00000  -0.00000
  1 C 2pz     -0.40282   0.00000   0.00000  -0.54404  -0.57355
  1 C 3px      0.00000  -0.00000  -0.04022  -0.00000  -0.00000
  1 C 3py      0.00000  -0.04022  -0.00000   0.00000   0.00000
  1 C 3pz      0.05831  -0.00000   0.00000  -0.00984   0.03298
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03836   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04862   0.00000  -0.00000  -0.00687   0.01178
  1 C 3dxz    -0.00000   0.00000  -0.03836   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00101
  0 C 2s      -0.00000  -0.00000   0.54172
  0 C 3s       0.00000  -0.00000  -0.04839
  0 C 2px      0.70576  -0.00000   0.00000
  0 C 2py      0.00000   0.70576  -0.00000
  0 C 2pz     -0.00000   0.00000   0.44796
  0 C 3px     -0.03649  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03649  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00649
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02381  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.05909
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00101
  1 C 2s      -0.00000   0.00000  -0.54172
  1 C 3s      -0.00000   0.00000   0.04839
  1 C 2px     -0.70576   0.00000   0.00000
  1 C 2py      0.00000  -0.70576  -0.00000
  1 C 2pz      0.00000   0.00000   0.44796
  1 C 3px      0.03649   0.00000  -0.00000
  1 C 3py     -0.00000   0.03649   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00649
  1 C 3dxy    -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02381  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.05909
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99610894
<CAS-nat-orb|mo-hf>  4  4    0.99985893
<CAS-nat-orb|mo-hf>  5  5    0.99985893
<CAS-nat-orb|mo-hf>  6  6    0.99868925
<CAS-nat-orb|mo-hf>  7  7    0.98295349
<CAS-nat-orb|mo-hf>  8  8    0.88422763
<CAS-nat-orb|mo-hf>  8  15   -0.46451050
<CAS-nat-orb|mo-hf>  9  9    0.88422779
<CAS-nat-orb|mo-hf>  9  16   -0.46451022
<CAS-nat-orb|mo-hf>  10  17    0.44059927
<CAS-nat-orb|mo-hf>  10  20   -0.73158934
CASSCF energy = -75.5293900854452
CASCI E = -75.5293900854452  E(CI) = -18.8101054540113  S^2 = 0.0000000
Time cost =    513.859
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:23:42 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.084813282386 AA    0.000000000000   0.000000000000   2.050000000000 Bohr   0.0

nuclear repulsion = 17.5609756097561
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3052.48


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpmrnfhq6e
max_memory 4000 MB (current use 172 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8587717717965

WARN: Singularity detected in overlap matrix (condition number = 1.1e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.343801090949931  LUMO (Ag) = -0.208899636382796
cycle= 1 E= -75.3152287127073  delta_E= 0.544  |g|= 0.177  |ddm|= 1.56
HOMO (B1u) = -0.504407518465331  LUMO (Ag) = -0.123879990102773
cycle= 2 E= -75.326251581953  delta_E= -0.011  |g|= 0.0526  |ddm|= 0.188
HOMO (B1u) = -0.474708360691123  LUMO (Ag) = -0.0950218080877905
cycle= 3 E= -75.3271055696139  delta_E= -0.000854  |g|= 0.0134  |ddm|= 0.101
HOMO (B1u) = -0.474494822450144  LUMO (Ag) = -0.0988363835418852
cycle= 4 E= -75.3272181663453  delta_E= -0.000113  |g|= 0.00221  |ddm|= 0.0646
HOMO (B1u) = -0.475044448091171  LUMO (Ag) = -0.10031489519861
cycle= 5 E= -75.3272215916787  delta_E= -3.43e-06  |g|= 0.000363  |ddm|= 0.0164
HOMO (B1u) = -0.475018098728985  LUMO (Ag) = -0.10027761522135
cycle= 6 E= -75.3272216794877  delta_E= -8.78e-08  |g|= 2.61e-05  |ddm|= 0.00103
HOMO (B1u) = -0.475024517384063  LUMO (Ag) = -0.100284470661362
cycle= 7 E= -75.3272216798442  delta_E= -3.57e-10  |g|= 1.87e-06  |ddm|= 0.000419
HOMO (B1u) = -0.475024512000399  LUMO (Ag) = -0.100284344431193
cycle= 8 E= -75.3272216798457  delta_E= -1.48e-12  |g|= 1.12e-07  |ddm|= 3.22e-05
HOMO (B1u) = -0.475024518733802  LUMO (Ag) = -0.100284359326906
cycle= 9 E= -75.3272216798457  delta_E=    0  |g|= 7.12e-09  |ddm|= 6.36e-07
HOMO (B1u) = -0.475024516369193  LUMO (Ag) = -0.100284355796612
cycle= 10 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 6.87e-09  |ddm|= 8.54e-09
HOMO (B1u) = -0.47502451841189  LUMO (Ag) = -0.100284358872986
cycle= 11 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 5.89e-09  |ddm|= 2.95e-08
HOMO (B1u) = -0.475024516766677  LUMO (Ag) = -0.100284356668066
cycle= 12 E= -75.3272216798456  delta_E= 1.42e-14  |g|= 5.21e-10  |ddm|= 7.36e-09
HOMO (B1u) = -0.475024516792927  LUMO (Ag) = -0.100284356799374
cycle= 13 E= -75.3272216798456  delta_E= -7.11e-14  |g|= 5.1e-10  |ddm|= 1.11e-09
HOMO (B1u) = -0.475024516708962  LUMO (Ag) = -0.100284356707554
cycle= 14 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 5.53e-10  |ddm|= 1.29e-09
HOMO (B1u) = -0.47502451668782  LUMO (Ag) = -0.100284356713032
cycle= 15 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 5.39e-10  |ddm|= 6.98e-10
HOMO (B1u) = -0.475024516721493  LUMO (Ag) = -0.100284356696034
cycle= 16 E= -75.3272216798456  delta_E= -5.68e-14  |g|= 4.35e-10  |ddm|= 4.11e-09
HOMO (B1u) = -0.475024516863657  LUMO (Ag) = -0.100284356808068
cycle= 17 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 5.68e-10  |ddm|= 1.78e-09
HOMO (B1u) = -0.47502451690094  LUMO (Ag) = -0.100284356827269
cycle= 18 E= -75.3272216798456  delta_E=    0  |g|= 4.14e-10  |ddm|= 6.15e-10
HOMO (B1u) = -0.475024516856153  LUMO (Ag) = -0.100284356792662
cycle= 19 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 2.33e-10  |ddm|= 5.22e-10
HOMO (B1u) = -0.47502451688103  LUMO (Ag) = -0.100284356813484
cycle= 20 E= -75.3272216798457  delta_E= -4.26e-14  |g|= 9.88e-11  |ddm|= 2.28e-10
HOMO (B1u) = -0.475024516876518  LUMO (Ag) = -0.100284356808951
cycle= 21 E= -75.3272216798456  delta_E= 4.26e-14  |g|= 9.25e-11  |ddm|= 3.14e-11
HOMO (B1u) = -0.475024516875839  LUMO (Ag) = -0.100284356804189
cycle= 22 E= -75.3272216798456  delta_E=    0  |g|= 8.16e-11  |ddm|= 9.61e-11
HOMO (B1u) = -0.475024516863522  LUMO (Ag) = -0.100284356774334
Extra cycle  E= -75.3272216798456  delta_E=    0  |g|= 2.64e-11  |ddm|= 3.24e-10
converged SCF energy = -75.3272216798456

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpmrnfhq6e
max_memory 4000 MB (current use 173 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.483311105906  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5010935167459  dE = -0.017782411  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5165854057097  dE = -0.015491889  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0415  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5274438859712  dE = -0.01085848  S^2 = 0.0000000
               |grad[o]|=0.0941  |ddm|=0.0269  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5341204754949  dE = -0.0066765895  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0121  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5392309343564  dE = -0.0051104589  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00475  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5434695377216  dE = -0.0042386034  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.00267  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5470496061636  dE = -0.0035800684  S^2 = 0.0000000
               |grad[o]|=0.0393  |ddm|=0.00189  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5500313213434  dE = -0.0029817152  S^2 = 0.0000000
               |grad[o]|=0.0315  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5524229991944  dE = -0.0023916779  S^2 = 0.0000000
               |grad[o]|=0.0245  |ddm|=0.0021  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5542142117055  dE = -0.0017912125  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.555394327276  dE = -0.0011801156  S^2 = 0.0000000
               |grad[o]|=0.0125  |ddm|=0.00293  |maxRot[o]|=0.0798
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5559531754068  dE = -0.00055884813  S^2 = 0.0000000
               |grad[o]|=0.0071  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5559945763552  dE = -4.1400948e-05  S^2 = 0.0000000
               |grad[o]|=0.00221  |ddm|=0.00383  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5559984928642  dE = -3.916509e-06  S^2 = 0.0000000
               |grad[o]|=0.000816  |ddm|=0.00164  |maxRot[o]|=0.00745
macro iter 15 (3 JK  0 micro), CASSCF E = -75.555998589026  dE = -9.6161813e-08  S^2 = 0.0000000
               |grad[o]|=0.00018  |ddm|=0.000849  |maxRot[o]|=0.00111
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5559985922085  dE = -3.1824783e-09  S^2 = 0.0000000
               |grad[o]|=3.82e-05  |ddm|=0.000222  |maxRot[o]|=0.000183
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5559985923272  dE = -1.1867485e-10  S^2 = 0.0000000
               |grad[o]|=8.07e-06  |ddm|=5.39e-05  |maxRot[o]|=3.39e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5559985923254  dE = 1.8189894e-12  S^2 = 0.0000000
               |grad[o]|=1.4e-06  |ddm|=5.57e-06  |maxRot[o]|=6.6e-06
2-step CASSCF converged in 18 macro (89 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98851474 1.9258584  1.92585834 1.49745706 0.49907021 0.07700636
 0.07700623 0.00922867]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00113   0.00000   0.00000   0.00208  -0.00211
  0 C 2s       0.57579   0.00000  -0.00000   0.46137  -0.40723
  0 C 3s      -0.05693  -0.00000  -0.00000   0.00979  -0.03053
  0 C 2px     -0.00000   0.00000   0.70524  -0.00000   0.00000
  0 C 2py      0.00000   0.70524   0.00000  -0.00000  -0.00000
  0 C 2pz      0.39967   0.00000   0.00000  -0.53564   0.57613
  0 C 3px     -0.00000   0.00000  -0.03513  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03513   0.00000   0.00000  -0.00000
  0 C 3pz     -0.05695  -0.00000   0.00000  -0.00906  -0.03424
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.03742   0.00000   0.00000  -0.00000
  0 C 3dz^2    0.04728  -0.00000   0.00000   0.00608   0.01129
  0 C 3dxz    -0.00000   0.00000   0.03742  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00113   0.00000   0.00000  -0.00208  -0.00211
  1 C 2s       0.57579   0.00000  -0.00000  -0.46137  -0.40723
  1 C 3s      -0.05693   0.00000   0.00000  -0.00979  -0.03053
  1 C 2px      0.00000  -0.00000   0.70524   0.00000   0.00000
  1 C 2py      0.00000   0.70524  -0.00000  -0.00000   0.00000
  1 C 2pz     -0.39967   0.00000  -0.00000  -0.53564  -0.57613
  1 C 3px      0.00000  -0.00000  -0.03513   0.00000  -0.00000
  1 C 3py      0.00000  -0.03513  -0.00000   0.00000   0.00000
  1 C 3pz      0.05695  -0.00000  -0.00000  -0.00906   0.03424
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.03742   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04728  -0.00000   0.00000  -0.00608   0.01129
  1 C 3dxz    -0.00000   0.00000  -0.03742  -0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00097
  0 C 2s      -0.00000   0.00000   0.53380
  0 C 3s      -0.00000   0.00000  -0.04704
  0 C 2px      0.70587   0.00000  -0.00000
  0 C 2py      0.00000   0.70587   0.00000
  0 C 2pz     -0.00000  -0.00000   0.45840
  0 C 3px     -0.03434   0.00000  -0.00000
  0 C 3py      0.00000  -0.03434  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.00431
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.05187
  0 C 3dxz    -0.02382  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00097
  1 C 2s       0.00000  -0.00000  -0.53380
  1 C 3s       0.00000  -0.00000   0.04704
  1 C 2px     -0.70587   0.00000   0.00000
  1 C 2py     -0.00000  -0.70587   0.00000
  1 C 2pz      0.00000   0.00000   0.45840
  1 C 3px      0.03434  -0.00000   0.00000
  1 C 3py     -0.00000   0.03434   0.00000
  1 C 3pz     -0.00000   0.00000  -0.00431
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.05187
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99594657
<CAS-nat-orb|mo-hf>  4  4    0.99985545
<CAS-nat-orb|mo-hf>  5  5    0.99985545
<CAS-nat-orb|mo-hf>  6  6    0.99869865
<CAS-nat-orb|mo-hf>  7  7    0.98240657
<CAS-nat-orb|mo-hf>  8  8    0.89361613
<CAS-nat-orb|mo-hf>  8  15   -0.44672576
<CAS-nat-orb|mo-hf>  9  9    0.89361609
<CAS-nat-orb|mo-hf>  9  16   -0.44672584
<CAS-nat-orb|mo-hf>  10  17    0.47419755
<CAS-nat-orb|mo-hf>  10  20   -0.71074878
CASSCF energy = -75.5559985923254
CASCI E = -75.5559985923254  E(CI) = -18.6416908978602  S^2 = 0.0000000
Time cost =    685.818
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:35:08 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.111272142932 AA    0.000000000000   0.000000000000   2.100000000000 Bohr   0.0

nuclear repulsion = 17.1428571428571
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3629.04


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp6u5uc3m6
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8003866027882

WARN: Singularity detected in overlap matrix (condition number =  999). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.32858894486889  LUMO (Ag) = -0.204693729619157
cycle= 1 E= -75.3347800230759  delta_E= 0.466  |g|= 0.18  |ddm|= 1.55
HOMO (B1u) = -0.512671455628693  LUMO (Ag) = -0.127860887413401
cycle= 2 E= -75.346109112634  delta_E= -0.0113  |g|= 0.0522  |ddm|= 0.19
HOMO (B1u) = -0.482062537885922  LUMO (Ag) = -0.0974769445191799
cycle= 3 E= -75.3469306677088  delta_E= -0.000822  |g|= 0.0126  |ddm|= 0.0913
HOMO (B1u) = -0.48137446602495  LUMO (Ag) = -0.100457341704972
cycle= 4 E= -75.3470296424032  delta_E= -9.9e-05  |g|= 0.00217  |ddm|= 0.0587
HOMO (B1u) = -0.481886259872505  LUMO (Ag) = -0.101886818572119
cycle= 5 E= -75.3470329570725  delta_E= -3.31e-06  |g|= 0.000344  |ddm|= 0.0161
HOMO (B1u) = -0.481861583616578  LUMO (Ag) = -0.101865081892999
cycle= 6 E= -75.3470330362213  delta_E= -7.91e-08  |g|= 2.58e-05  |ddm|= 0.000729
HOMO (B1u) = -0.481868355987195  LUMO (Ag) = -0.101872367771489
cycle= 7 E= -75.3470330365669  delta_E= -3.46e-10  |g|= 2.05e-06  |ddm|= 0.000385
HOMO (B1u) = -0.481868395860487  LUMO (Ag) = -0.101872342919473
cycle= 8 E= -75.3470330365686  delta_E= -1.68e-12  |g|= 1.14e-07  |ddm|= 3.34e-05
HOMO (B1u) = -0.481868402323485  LUMO (Ag) = -0.101872355527732
cycle= 9 E= -75.3470330365685  delta_E= 2.84e-14  |g|= 7.18e-09  |ddm|= 5.08e-07
HOMO (B1u) = -0.481868399645947  LUMO (Ag) = -0.101872352075774
cycle= 10 E= -75.3470330365686  delta_E= -5.68e-14  |g|= 7.12e-09  |ddm|= 1.11e-08
HOMO (B1u) = -0.481868400188337  LUMO (Ag) = -0.101872353262891
cycle= 11 E= -75.3470330365685  delta_E= 5.68e-14  |g|= 6.89e-10  |ddm|= 1.9e-08
HOMO (B1u) = -0.481868400157477  LUMO (Ag) = -0.101872353226149
cycle= 12 E= -75.3470330365686  delta_E= -8.53e-14  |g|= 4.23e-10  |ddm|= 1.78e-09
HOMO (B1u) = -0.481868400178973  LUMO (Ag) = -0.101872353305485
cycle= 13 E= -75.3470330365686  delta_E= 1.42e-14  |g|= 4.25e-10  |ddm|= 1.03e-09
HOMO (B1u) = -0.481868400173508  LUMO (Ag) = -0.101872353276568
cycle= 14 E= -75.3470330365686  delta_E= -1.42e-14  |g|= 3.66e-10  |ddm|= 2.42e-10
HOMO (B1u) = -0.481868400169708  LUMO (Ag) = -0.101872353281737
cycle= 15 E= -75.3470330365686  delta_E= 5.68e-14  |g|= 3.32e-10  |ddm|= 1.96e-10
HOMO (B1u) = -0.481868400197232  LUMO (Ag) = -0.101872353279947
cycle= 16 E= -75.3470330365686  delta_E= -1.42e-14  |g|= 2.85e-10  |ddm|= 1.64e-09
HOMO (B1u) = -0.481868400273126  LUMO (Ag) = -0.101872353333773
cycle= 17 E= -75.3470330365686  delta_E= -4.26e-14  |g|= 4.36e-10  |ddm|= 7.94e-10
HOMO (B1u) = -0.481868400301092  LUMO (Ag) = -0.101872353344419
cycle= 18 E= -75.3470330365687  delta_E= -5.68e-14  |g|= 2.88e-10  |ddm|= 3.37e-10
HOMO (B1u) = -0.481868400249757  LUMO (Ag) = -0.101872353305691
cycle= 19 E= -75.3470330365686  delta_E= 5.68e-14  |g|= 7.89e-11  |ddm|= 4.08e-10
HOMO (B1u) = -0.481868400246702  LUMO (Ag) = -0.101872353301327
cycle= 20 E= -75.3470330365686  delta_E= 2.84e-14  |g|= 6.53e-11  |ddm|= 4.47e-11
HOMO (B1u) = -0.48186840024532  LUMO (Ag) = -0.101872353298673
cycle= 21 E= -75.3470330365686  delta_E= 2.84e-14  |g|= 5.9e-11  |ddm|= 1.52e-11
HOMO (B1u) = -0.481868400245858  LUMO (Ag) = -0.101872353295617
cycle= 22 E= -75.3470330365685  delta_E= 7.11e-14  |g|= 5.02e-11  |ddm|= 6.13e-11
HOMO (B1u) = -0.481868400245752  LUMO (Ag) = -0.101872353292754
cycle= 23 E= -75.3470330365686  delta_E= -1.28e-13  |g|= 4.28e-11  |ddm|= 5.74e-11
HOMO (B1u) = -0.481868400245978  LUMO (Ag) = -0.101872353289541
cycle= 24 E= -75.3470330365686  delta_E=    0  |g|= 3.73e-11  |ddm|= 6.55e-11
HOMO (B1u) = -0.481868400245752  LUMO (Ag) = -0.101872353285633
Extra cycle  E= -75.3470330365686  delta_E=    0  |g|= 1.03e-11  |ddm|= 5.95e-11
converged SCF energy = -75.3470330365686

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp6u5uc3m6
max_memory 4000 MB (current use 167 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5047007388544  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5230707816029  dE = -0.018370043  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5389823177173  dE = -0.015911536  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5492400907485  dE = -0.010257773  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0279  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5558470442049  dE = -0.0066069535  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5609995608455  dE = -0.0051525166  S^2 = 0.0000000
               |grad[o]|=0.0585  |ddm|=0.00486  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5652985944658  dE = -0.0042990336  S^2 = 0.0000000
               |grad[o]|=0.0476  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5689164658854  dE = -0.0036178714  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5718931660025  dE = -0.0029767001  S^2 = 0.0000000
               |grad[o]|=0.0304  |ddm|=0.00212  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5742225159342  dE = -0.0023293499  S^2 = 0.0000000
               |grad[o]|=0.0232  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5758843687276  dE = -0.0016618528  S^2 = 0.0000000
               |grad[o]|=0.0166  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5768610787163  dE = -0.00097670999  S^2 = 0.0000000
               |grad[o]|=0.0106  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 12 (5 JK  0 micro), CASSCF E = -75.5771323611594  dE = -0.00027128244  S^2 = 0.0000000
               |grad[o]|=0.00491  |ddm|=0.00368  |maxRot[o]|=0.0599
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5771370942202  dE = -4.7330608e-06  S^2 = 0.0000000
               |grad[o]|=0.00106  |ddm|=0.0034  |maxRot[o]|=0.00809
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5771372193369  dE = -1.2511673e-07  S^2 = 0.0000000
               |grad[o]|=0.000227  |ddm|=0.00107  |maxRot[o]|=0.00121
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5771372233949  dE = -4.0579806e-09  S^2 = 0.0000000
               |grad[o]|=4.47e-05  |ddm|=0.000274  |maxRot[o]|=0.000204
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5771372235462  dE = -1.5131718e-10  S^2 = 0.0000000
               |grad[o]|=8.73e-06  |ddm|=5.85e-05  |maxRot[o]|=3.68e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5771372235523  dE = -6.0822458e-12  S^2 = 0.0000000
               |grad[o]|=1.69e-06  |ddm|=1.21e-05  |maxRot[o]|=7.24e-06
2-step CASSCF converged in 17 macro (85 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98787579 1.9207281  1.92072834 1.51715844 0.47907021 0.08229648
 0.08229651 0.00984614]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00153   0.00000   0.00000   0.00220  -0.00194
  0 C 2s       0.57846  -0.00000  -0.00000   0.47106  -0.40350
  0 C 3s      -0.05596  -0.00000  -0.00000   0.00960  -0.02757
  0 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  0 C 2py      0.00000   0.70551  -0.00000  -0.00000   0.00000
  0 C 2pz      0.39631   0.00000  -0.00000  -0.52717   0.57883
  0 C 3px     -0.00000   0.00000  -0.03031   0.00000  -0.00000
  0 C 3py      0.00000  -0.03031  -0.00000   0.00000   0.00000
  0 C 3pz     -0.05553  -0.00000  -0.00000  -0.00832  -0.03544
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.03648  -0.00000   0.00000   0.00000
  0 C 3dz^2    0.04590  -0.00000  -0.00000   0.00531   0.01098
  0 C 3dxz     0.00000   0.00000   0.03648   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00153   0.00000   0.00000  -0.00220  -0.00194
  1 C 2s       0.57846   0.00000   0.00000  -0.47106  -0.40350
  1 C 3s      -0.05596   0.00000   0.00000  -0.00960  -0.02757
  1 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70551  -0.00000  -0.00000  -0.00000
  1 C 2pz     -0.39631   0.00000   0.00000  -0.52717  -0.57883
  1 C 3px     -0.00000   0.00000  -0.03031  -0.00000   0.00000
  1 C 3py     -0.00000  -0.03031   0.00000  -0.00000  -0.00000
  1 C 3pz      0.05553  -0.00000  -0.00000  -0.00832   0.03544
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.03648  -0.00000   0.00000   0.00000
  1 C 3dz^2    0.04590   0.00000   0.00000  -0.00531   0.01098
  1 C 3dxz     0.00000  -0.00000  -0.03648   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00092
  0 C 2s       0.00000  -0.00000   0.52568
  0 C 3s      -0.00000   0.00000  -0.04590
  0 C 2px      0.70596  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70596  -0.00000
  0 C 2pz     -0.00000   0.00000   0.46846
  0 C 3px     -0.03238  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03238   0.00000
  0 C 3pz     -0.00000   0.00000  -0.00204
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02383   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.04579
  0 C 3dxz    -0.02383  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00092
  1 C 2s       0.00000  -0.00000  -0.52568
  1 C 3s       0.00000  -0.00000   0.04590
  1 C 2px     -0.70596   0.00000   0.00000
  1 C 2py      0.00000  -0.70596  -0.00000
  1 C 2pz     -0.00000  -0.00000   0.46846
  1 C 3px      0.03238   0.00000   0.00000
  1 C 3py      0.00000   0.03238   0.00000
  1 C 3pz      0.00000   0.00000  -0.00204
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02383  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04579
  1 C 3dxz    -0.02383  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99576518
<CAS-nat-orb|mo-hf>  4  4    0.99984965
<CAS-nat-orb|mo-hf>  5  5    0.99984965
<CAS-nat-orb|mo-hf>  6  6    0.99869802
<CAS-nat-orb|mo-hf>  7  7    0.98184923
<CAS-nat-orb|mo-hf>  8  8    0.90221125
<CAS-nat-orb|mo-hf>  8  15   -0.42956745
<CAS-nat-orb|mo-hf>  9  9    0.90221129
<CAS-nat-orb|mo-hf>  9  16   -0.42956738
<CAS-nat-orb|mo-hf>  10  10    0.40783706
<CAS-nat-orb|mo-hf>  10  17    0.50741106
<CAS-nat-orb|mo-hf>  10  20   -0.68802314
CASSCF energy = -75.5771372235523
CASCI E = -75.5771372235523  E(CI) = -18.4770626177142  S^2 = 0.0000000
Time cost =    381.077
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:41:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.137731003478 AA    0.000000000000   0.000000000000   2.150000000000 Bohr   0.0

nuclear repulsion = 16.7441860465116
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      3949.25


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp4lv5wmgt
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.742346402077

WARN: Singularity detected in overlap matrix (condition number =  905). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.314216447683402  LUMO (Ag) = -0.200692527520579
cycle= 1 E= -75.3495110358229  delta_E= 0.393  |g|= 0.183  |ddm|= 1.54
HOMO (B2u) = -0.511968787672979  LUMO (Ag) = -0.131517049931573
cycle= 2 E= -75.3612308192939  delta_E= -0.0117  |g|= 0.052  |ddm|= 0.195
HOMO (B2u) = -0.477859245905662  LUMO (Ag) = -0.0996643076325099
cycle= 3 E= -75.3620321930708  delta_E= -0.000801  |g|= 0.0118  |ddm|= 0.0834
HOMO (B3u) = -0.480852254510821  LUMO (Ag) = -0.101863987618505
cycle= 4 E= -75.3621184017555  delta_E= -8.62e-05  |g|= 0.00212  |ddm|= 0.0529
HOMO (B2u) = -0.481684500444461  LUMO (Ag) = -0.103214149326987
cycle= 5 E= -75.3621215318461  delta_E= -3.13e-06  |g|= 0.000318  |ddm|= 0.0156
HOMO (B3u) = -0.48160083631323  LUMO (Ag) = -0.103210190493482
cycle= 6 E= -75.3621216003491  delta_E= -6.85e-08  |g|= 2.54e-05  |ddm|= 0.000515
HOMO (B3u) = -0.481601754909297  LUMO (Ag) = -0.103217967965941
cycle= 7 E= -75.3621216006849  delta_E= -3.36e-10  |g|= 2.23e-06  |ddm|= 0.00035
HOMO (B3u) = -0.481601987406679  LUMO (Ag) = -0.103218034520516
cycle= 8 E= -75.362121600687  delta_E= -2.07e-12  |g|= 1.23e-07  |ddm|= 3.4e-05
HOMO (B2u) = -0.481601999518625  LUMO (Ag) = -0.103218045660807
cycle= 9 E= -75.362121600687  delta_E= -5.68e-14  |g|= 7.62e-09  |ddm|= 3.86e-07
HOMO (B3u) = -0.481601998062901  LUMO (Ag) = -0.103218041939092
cycle= 10 E= -75.362121600687  delta_E= 5.68e-14  |g|= 7.42e-09  |ddm|= 1.11e-08
HOMO (B3u) = -0.481601999776807  LUMO (Ag) = -0.103218043429022
cycle= 11 E= -75.3621216006869  delta_E= 5.68e-14  |g|= 7.21e-10  |ddm|= 1.25e-08
HOMO (B3u) = -0.481601999835168  LUMO (Ag) = -0.103218043443168
cycle= 12 E= -75.3621216006869  delta_E= 2.84e-14  |g|= 4.93e-10  |ddm|= 1.78e-09
HOMO (B3u) = -0.481601999873071  LUMO (Ag) = -0.103218043499639
cycle= 13 E= -75.3621216006869  delta_E=    0  |g|= 4.69e-10  |ddm|= 8.7e-10
HOMO (B2u) = -0.481601999855712  LUMO (Ag) = -0.103218043466939
cycle= 14 E= -75.362121600687  delta_E= -8.53e-14  |g|= 3.95e-10  |ddm|= 1.4e-10
HOMO (B2u) = -0.481601999866836  LUMO (Ag) = -0.10321804346668
cycle= 15 E= -75.362121600687  delta_E=    0  |g|= 3.58e-10  |ddm|= 4.1e-10
HOMO (B3u) = -0.481601999836846  LUMO (Ag) = -0.103218043446296
cycle= 16 E= -75.3621216006869  delta_E= 8.53e-14  |g|= 3.12e-10  |ddm|= 1.68e-09
HOMO (B2u) = -0.481601999852983  LUMO (Ag) = -0.103218043504367
cycle= 17 E= -75.3621216006869  delta_E=    0  |g|= 4.64e-10  |ddm|= 8.34e-10
HOMO (B2u) = -0.48160199990146  LUMO (Ag) = -0.103218043509197
cycle= 18 E= -75.3621216006869  delta_E= 2.84e-14  |g|= 3.03e-10  |ddm|= 2.68e-10
HOMO (B2u) = -0.481601999878259  LUMO (Ag) = -0.1032180434682
cycle= 19 E= -75.3621216006869  delta_E= -8.53e-14  |g|= 8.5e-11  |ddm|= 4.59e-10
HOMO (B2u) = -0.481601999874858  LUMO (Ag) = -0.103218043463998
cycle= 20 E= -75.362121600687  delta_E= -2.84e-14  |g|= 7.15e-11  |ddm|= 3.94e-11
HOMO (B3u) = -0.481601999873721  LUMO (Ag) = -0.103218043462234
cycle= 21 E= -75.3621216006869  delta_E= 2.84e-14  |g|= 6.28e-11  |ddm|= 1.56e-11
HOMO (B3u) = -0.4816019998732  LUMO (Ag) = -0.103218043459977
cycle= 22 E= -75.3621216006869  delta_E=    0  |g|= 5.19e-11  |ddm|= 4.18e-11
HOMO (B3u) = -0.481601999871907  LUMO (Ag) = -0.103218043452704
Extra cycle  E= -75.3621216006869  delta_E= 1.42e-14  |g|= 1.46e-11  |ddm|= 9.4e-11
converged SCF energy = -75.3621216006869

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp4lv5wmgt
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5214099234425  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5403620704932  dE = -0.018952147  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5566943744711  dE = -0.016332304  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0461  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5664483853601  dE = -0.0097540109  S^2 = 0.0000000
               |grad[o]|=0.091  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5730073472862  dE = -0.0065589619  S^2 = 0.0000000
               |grad[o]|=0.0715  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.578210216752  dE = -0.0052028695  S^2 = 0.0000000
               |grad[o]|=0.0576  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5825630264579  dE = -0.0043528097  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5861977853267  dE = -0.0036347589  S^2 = 0.0000000
               |grad[o]|=0.0372  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5891324546801  dE = -0.0029346694  S^2 = 0.0000000
               |grad[o]|=0.0289  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.59134441687  dE = -0.0022119622  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.592802960606  dE = -0.0014585437  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5934808669139  dE = -0.00067790631  S^2 = 0.0000000
               |grad[o]|=0.00812  |ddm|=0.00368  |maxRot[o]|=0.0798
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5935226639147  dE = -4.1797001e-05  S^2 = 0.0000000
               |grad[o]|=0.00228  |ddm|=0.00417  |maxRot[o]|= 0.02
macro iter 13 (3 JK  0 micro), CASSCF E = -75.593527359043  dE = -4.6951283e-06  S^2 = 0.0000000
               |grad[o]|=0.000868  |ddm|=0.00146  |maxRot[o]|=0.00829
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5935274566683  dE = -9.7625303e-08  S^2 = 0.0000000
               |grad[o]|=0.000175  |ddm|=0.000804  |maxRot[o]|=0.00112
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5935274594337  dE = -2.7654323e-09  S^2 = 0.0000000
               |grad[o]|=3.37e-05  |ddm|=0.000201  |maxRot[o]|=0.000174
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5935274595338  dE = -1.0007284e-10  S^2 = 0.0000000
               |grad[o]|=6.88e-06  |ddm|=4.95e-05  |maxRot[o]|=3.08e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5935274595374  dE = -3.5527137e-12  S^2 = 0.0000000
               |grad[o]|=1.18e-06  |ddm|=9.09e-06  |maxRot[o]|=5.92e-06
2-step CASSCF converged in 17 macro (83 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98720387 1.53562489 1.91537976 1.91537954 0.46035381 0.08778187
 0.08778168 0.01049457]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00194   0.00231   0.00000   0.00000  -0.00179
  0 C 2s       0.58123   0.48048  -0.00000  -0.00000  -0.39956
  0 C 3s      -0.05483   0.00943  -0.00000  -0.00000  -0.02456
  0 C 2px      0.00000   0.00000   0.00000   0.70574   0.00000
  0 C 2py      0.00000  -0.00000   0.70574   0.00000   0.00000
  0 C 2pz      0.39276  -0.51862   0.00000  -0.00000   0.58162
  0 C 3px      0.00000   0.00000  -0.00000  -0.02575   0.00000
  0 C 3py     -0.00000   0.00000  -0.02575  -0.00000   0.00000
  0 C 3pz     -0.05404  -0.00761  -0.00000  -0.00000  -0.03659
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.03555  -0.00000   0.00000
  0 C 3dz^2    0.04451   0.00457  -0.00000  -0.00000   0.01083
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03555   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00194  -0.00231   0.00000   0.00000  -0.00179
  1 C 2s       0.58123  -0.48048   0.00000   0.00000  -0.39956
  1 C 3s      -0.05483  -0.00943   0.00000   0.00000  -0.02456
  1 C 2px      0.00000  -0.00000   0.00000   0.70574  -0.00000
  1 C 2py      0.00000  -0.00000   0.70574   0.00000  -0.00000
  1 C 2pz     -0.39276  -0.51862  -0.00000  -0.00000  -0.58162
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.02575  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02575  -0.00000  -0.00000
  1 C 3pz      0.05404  -0.00761  -0.00000  -0.00000   0.03659
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03555   0.00000   0.00000
  1 C 3dz^2    0.04451  -0.00457   0.00000   0.00000   0.01083
  1 C 3dxz     0.00000   0.00000   0.00000  -0.03555   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00088
  0 C 2s      -0.00000  -0.00000   0.51738
  0 C 3s      -0.00000  -0.00000  -0.04498
  0 C 2px      0.70604   0.00000  -0.00000
  0 C 2py      0.00000   0.70604  -0.00000
  0 C 2pz     -0.00000   0.00000   0.47816
  0 C 3px     -0.03061   0.00000  -0.00000
  0 C 3py      0.00000  -0.03061  -0.00000
  0 C 3pz     -0.00000   0.00000   0.00024
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.04072
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00088
  1 C 2s       0.00000  -0.00000  -0.51738
  1 C 3s       0.00000   0.00000   0.04498
  1 C 2px     -0.70604  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70604   0.00000
  1 C 2pz     -0.00000  -0.00000   0.47816
  1 C 3px      0.03061  -0.00000   0.00000
  1 C 3py     -0.00000   0.03061   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00024
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04072
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99556546
<CAS-nat-orb|mo-hf>  4  4    0.99868710
<CAS-nat-orb|mo-hf>  5  5    0.99984158
<CAS-nat-orb|mo-hf>  6  6    0.99984158
<CAS-nat-orb|mo-hf>  7  7    0.98128498
<CAS-nat-orb|mo-hf>  8  8    0.91006599
<CAS-nat-orb|mo-hf>  8  15   -0.41306109
<CAS-nat-orb|mo-hf>  9  9    0.91006591
<CAS-nat-orb|mo-hf>  9  16   -0.41306126
<CAS-nat-orb|mo-hf>  10  10    0.41868601
<CAS-nat-orb|mo-hf>  10  17    0.53963890
<CAS-nat-orb|mo-hf>  10  20   -0.66337393
CASSCF energy = -75.5935274595374
CASCI E = -75.5935274595374  E(CI) = -18.3163035855625  S^2 = 0.0000000
Time cost =    320.969
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:46:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.164189864024 AA    0.000000000000   0.000000000000   2.200000000000 Bohr   0.0

nuclear repulsion = 16.3636363636364
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.1]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      4397.17


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpety40g52
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6850211082767

WARN: Singularity detected in overlap matrix (condition number =  823). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.300635738182938  LUMO (Ag) = -0.196894745039134
cycle= 1 E= -75.3600714434764  delta_E= 0.325  |g|= 0.186  |ddm|= 1.52
HOMO (B2u) = -0.505767689307348  LUMO (Ag) = -0.134850139116738
cycle= 2 E= -75.3722557388853  delta_E= -0.0122  |g|= 0.0519  |ddm|= 0.201
HOMO (B3u) = -0.47104268602542  LUMO (Ag) = -0.101583923798026
cycle= 3 E= -75.3730472275436  delta_E= -0.000791  |g|= 0.011  |ddm|= 0.0769
HOMO (B2u) = -0.473583831878466  LUMO (Ag) = -0.10306443620941
cycle= 4 E= -75.3731222408077  delta_E= -7.5e-05  |g|= 0.00204  |ddm|= 0.0475
HOMO (B3u) = -0.47440994976617  LUMO (Ag) = -0.104308159498412
cycle= 5 E= -75.3731251255  delta_E= -2.88e-06  |g|= 0.000283  |ddm|= 0.0148
HOMO (B3u) = -0.474348151042955  LUMO (Ag) = -0.104322379442281
cycle= 6 E= -75.3731251811964  delta_E= -5.57e-08  |g|= 2.51e-05  |ddm|= 0.000586
HOMO (B2u) = -0.474349388268697  LUMO (Ag) = -0.104330764317115
cycle= 7 E= -75.3731251815251  delta_E= -3.29e-10  |g|= 2.41e-06  |ddm|= 0.000311
HOMO (B3u) = -0.474349685667066  LUMO (Ag) = -0.104330912577474
cycle= 8 E= -75.3731251815274  delta_E= -2.33e-12  |g|= 1.4e-07  |ddm|= 3.41e-05
HOMO (B3u) = -0.474349699391972  LUMO (Ag) = -0.104330922329734
cycle= 9 E= -75.3731251815275  delta_E= -2.84e-14  |g|= 8.38e-09  |ddm|= 2.86e-07
HOMO (B3u) = -0.47434969742804  LUMO (Ag) = -0.104330918023253
cycle= 10 E= -75.3731251815275  delta_E=    0  |g|= 7.67e-09  |ddm|= 1.04e-08
HOMO (B3u) = -0.474349699520808  LUMO (Ag) = -0.104330919956991
cycle= 11 E= -75.3731251815275  delta_E= 1.42e-14  |g|= 8.12e-10  |ddm|= 1.34e-08
HOMO (B2u) = -0.474349699590064  LUMO (Ag) = -0.104330919975534
cycle= 12 E= -75.3731251815275  delta_E= -1.42e-14  |g|= 5.76e-10  |ddm|= 1.63e-09
HOMO (B2u) = -0.474349699604102  LUMO (Ag) = -0.104330920001102
cycle= 13 E= -75.3731251815275  delta_E= -2.84e-14  |g|= 5.34e-10  |ddm|= 1.1e-09
HOMO (B2u) = -0.47434969960484  LUMO (Ag) = -0.104330919990152
cycle= 14 E= -75.3731251815274  delta_E= 5.68e-14  |g|= 4.5e-10  |ddm|= 1.53e-10
HOMO (B2u) = -0.474349699619663  LUMO (Ag) = -0.104330919983614
cycle= 15 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 4.09e-10  |ddm|= 4.51e-10
HOMO (B2u) = -0.474349699583241  LUMO (Ag) = -0.104330919965468
cycle= 16 E= -75.3731251815274  delta_E= -2.84e-14  |g|= 3.5e-10  |ddm|= 1.46e-09
HOMO (B2u) = -0.47434969957897  LUMO (Ag) = -0.104330920005373
cycle= 17 E= -75.3731251815275  delta_E= -4.26e-14  |g|= 4.97e-10  |ddm|= 7.98e-10
HOMO (B2u) = -0.474349699623017  LUMO (Ag) = -0.104330920003659
cycle= 18 E= -75.3731251815275  delta_E= -1.42e-14  |g|= 3.16e-10  |ddm|= 3.55e-10
HOMO (B2u) = -0.474349699595277  LUMO (Ag) = -0.104330919959225
cycle= 19 E= -75.3731251815274  delta_E= 1.14e-13  |g|= 9.72e-11  |ddm|= 6.37e-10
HOMO (B2u) = -0.474349699592985  LUMO (Ag) = -0.104330919955455
cycle= 20 E= -75.3731251815274  delta_E= -2.84e-14  |g|= 8.18e-11  |ddm|= 3.29e-11
HOMO (B2u) = -0.474349699593123  LUMO (Ag) = -0.104330919954367
cycle= 21 E= -75.3731251815274  delta_E= 1.42e-14  |g|= 7.08e-11  |ddm|= 2.02e-11
HOMO (B3u) = -0.474349699592727  LUMO (Ag) = -0.104330919952211
cycle= 22 E= -75.3731251815273  delta_E= 5.68e-14  |g|= 5.81e-11  |ddm|= 4.49e-11
HOMO (B2u) = -0.474349699592217  LUMO (Ag) = -0.104330919950351
cycle= 23 E= -75.3731251815274  delta_E= -7.11e-14  |g|= 4.81e-11  |ddm|= 4.34e-11
HOMO (B2u) = -0.474349699591392  LUMO (Ag) = -0.104330919948898
cycle= 24 E= -75.3731251815274  delta_E=    0  |g|= 4.16e-11  |ddm|= 5.87e-11
HOMO (B3u) = -0.474349699594049  LUMO (Ag) = -0.104330919945728
Extra cycle  E= -75.3731251815274  delta_E= -2.84e-14  |g|= 1.12e-11  |ddm|= 4.27e-11
converged SCF energy = -75.3731251815274

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpety40g52
max_memory 4000 MB (current use 167 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5340692264397  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5535986408742  dE = -0.019529414  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5700765822586  dE = -0.016477941  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0484  |maxRot[o]|=0.0784
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5795456785758  dE = -0.0094690963  S^2 = 0.0000000
               |grad[o]|=0.0899  |ddm|=0.0297  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5861247361222  dE = -0.0065790575  S^2 = 0.0000000
               |grad[o]|=0.0707  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5914072638816  dE = -0.0052825278  S^2 = 0.0000000
               |grad[o]|=0.0568  |ddm|=0.00536  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5958190892003  dE = -0.0044118253  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5994552531657  dE = -0.003636164  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6023109143982  dE = -0.0028556612  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.00296  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043454280624  dE = -0.0020345137  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6054821882678  dE = -0.0011367602  S^2 = 0.0000000
               |grad[o]|=0.012  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 11 (5 JK  0 micro), CASSCF E = -75.6057915430668  dE = -0.0003093548  S^2 = 0.0000000
               |grad[o]|=0.00551  |ddm|=0.00398  |maxRot[o]|=0.0599
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6058040753453  dE = -1.2532279e-05  S^2 = 0.0000000
               |grad[o]|=0.00133  |ddm|=0.00326  |maxRot[o]|=0.0137
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6058043185589  dE = -2.4321363e-07  S^2 = 0.0000000
               |grad[o]|=0.000278  |ddm|=0.00116  |maxRot[o]|=0.00175
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6058043249415  dE = -6.3825212e-09  S^2 = 0.0000000
               |grad[o]|=5.08e-05  |ddm|=0.000301  |maxRot[o]|=0.000267
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6058043251433  dE = -2.0183677e-10  S^2 = 0.0000000
               |grad[o]|=9.36e-06  |ddm|=6.66e-05  |maxRot[o]|=4.53e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6058043251499  dE = -6.6364692e-12  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=1.38e-05  |maxRot[o]|=8.56e-06
2-step CASSCF converged in 16 macro (79 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98650073 1.55290079 1.90980644 1.90980676 0.44288817 0.09346214
 0.09346204 0.01117293]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00235   0.00241   0.00000   0.00000  -0.00166
  0 C 2s       0.58410   0.48964  -0.00000  -0.00000  -0.39544
  0 C 3s      -0.05356   0.00927  -0.00000  -0.00000  -0.02152
  0 C 2px     -0.00000   0.00000   0.00000   0.70593   0.00000
  0 C 2py      0.00000  -0.00000   0.70593  -0.00000  -0.00000
  0 C 2pz      0.38903  -0.51000   0.00000  -0.00000   0.58448
  0 C 3px     -0.00000   0.00000   0.00000  -0.02144   0.00000
  0 C 3py      0.00000  -0.00000  -0.02144  -0.00000  -0.00000
  0 C 3pz     -0.05250  -0.00695  -0.00000  -0.00000  -0.03768
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03464  -0.00000  -0.00000
  0 C 3dz^2    0.04312   0.00386  -0.00000  -0.00000   0.01086
  0 C 3dxz    -0.00000   0.00000   0.00000   0.03464   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00235  -0.00241   0.00000   0.00000  -0.00166
  1 C 2s       0.58410  -0.48964   0.00000   0.00000  -0.39544
  1 C 3s      -0.05356  -0.00927   0.00000   0.00000  -0.02152
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70593  -0.00000
  1 C 2py      0.00000   0.00000   0.70593   0.00000   0.00000
  1 C 2pz     -0.38903  -0.51000   0.00000  -0.00000  -0.58448
  1 C 3px      0.00000  -0.00000  -0.00000  -0.02144  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02144   0.00000   0.00000
  1 C 3pz      0.05250  -0.00695  -0.00000  -0.00000   0.03768
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03464  -0.00000  -0.00000
  1 C 3dz^2    0.04312  -0.00386   0.00000   0.00000   0.01086
  1 C 3dxz    -0.00000   0.00000   0.00000  -0.03464   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00084
  0 C 2s      -0.00000  -0.00000   0.50895
  0 C 3s      -0.00000  -0.00000  -0.04424
  0 C 2px      0.70611   0.00000  -0.00000
  0 C 2py      0.00000   0.70611  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.48752
  0 C 3px     -0.02900   0.00000  -0.00000
  0 C 3py      0.00000  -0.02900  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00249
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03651
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00084
  1 C 2s       0.00000   0.00000  -0.50895
  1 C 3s       0.00000   0.00000   0.04424
  1 C 2px     -0.70611  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70611   0.00000
  1 C 2pz     -0.00000   0.00000   0.48752
  1 C 3px      0.02900  -0.00000   0.00000
  1 C 3py     -0.00000   0.02900   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00249
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.03651
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99534814
<CAS-nat-orb|mo-hf>  4  4    0.99866563
<CAS-nat-orb|mo-hf>  5  5    0.99983126
<CAS-nat-orb|mo-hf>  6  6    0.99983126
<CAS-nat-orb|mo-hf>  7  7    0.98071661
<CAS-nat-orb|mo-hf>  8  8    0.91723376
<CAS-nat-orb|mo-hf>  9  9    0.91723382
<CAS-nat-orb|mo-hf>  10  10    0.43078504
<CAS-nat-orb|mo-hf>  10  17    0.57019754
<CAS-nat-orb|mo-hf>  10  20   -0.63691916
CASSCF energy = -75.6058043251499
CASCI E = -75.6058043251499  E(CI) = -18.1594673295311  S^2 = 0.0000000
Time cost =    790.260
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:00:00 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.190648724570 AA    0.000000000000   0.000000000000   2.250000000000 Bohr   0.0

nuclear repulsion = 16
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.125]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5090.85


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpxaf4ze6o
max_memory 4000 MB (current use 174 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6287133444179

WARN: Singularity detected in overlap matrix (condition number =  749). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.287801147291402  LUMO (Ag) = -0.193295779361719
cycle= 1 E= -75.3670366286219  delta_E= 0.262  |g|= 0.19  |ddm|= 1.51
HOMO (B2u) = -0.499807889396644  LUMO (Ag) = -0.137862572577773
cycle= 2 E= -75.379748235821  delta_E= -0.0127  |g|= 0.0519  |ddm|= 0.208
HOMO (B2u) = -0.464540226195211  LUMO (Ag) = -0.103237375699654
cycle= 3 E= -75.3805383397254  delta_E= -0.00079  |g|= 0.0104  |ddm|= 0.0716
HOMO (B2u) = -0.466699997579163  LUMO (Ag) = -0.104062742035943
cycle= 4 E= -75.3806041774367  delta_E= -6.58e-05  |g|= 0.00196  |ddm|= 0.0425
HOMO (B3u) = -0.467507612863153  LUMO (Ag) = -0.105181483870829
cycle= 5 E= -75.3806067875641  delta_E= -2.61e-06  |g|= 0.00024  |ddm|= 0.0138
HOMO (B2u) = -0.467469009904278  LUMO (Ag) = -0.105209990979467
cycle= 6 E= -75.3806068286268  delta_E= -4.11e-08  |g|= 2.47e-05  |ddm|= 0.000855
HOMO (B2u) = -0.467470595918397  LUMO (Ag) = -0.105219180794839
cycle= 7 E= -75.3806068289548  delta_E= -3.28e-10  |g|= 2.6e-06  |ddm|= 0.000264
HOMO (B2u) = -0.467470958374879  LUMO (Ag) = -0.105219406231763
cycle= 8 E= -75.3806068289574  delta_E= -2.66e-12  |g|= 1.64e-07  |ddm|= 3.35e-05
HOMO (B3u) = -0.467470973641904  LUMO (Ag) = -0.105219414001886
cycle= 9 E= -75.3806068289574  delta_E=    0  |g|= 9.4e-09  |ddm|= 3.15e-07
HOMO (B2u) = -0.467470971062246  LUMO (Ag) = -0.105219408955832
cycle= 10 E= -75.3806068289574  delta_E= -2.84e-14  |g|= 7.61e-09  |ddm|= 1.06e-08
HOMO (B2u) = -0.467470973483451  LUMO (Ag) = -0.105219411329008
cycle= 11 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 8.66e-10  |ddm|= 1.9e-08
HOMO (B2u) = -0.467470973615999  LUMO (Ag) = -0.105219411433978
cycle= 12 E= -75.3806068289573  delta_E= 5.68e-14  |g|= 7.19e-10  |ddm|= 2.94e-09
HOMO (B2u) = -0.467470973595175  LUMO (Ag) = -0.105219411401842
cycle= 13 E= -75.3806068289574  delta_E= -1.14e-13  |g|= 5.91e-10  |ddm|= 1.41e-09
HOMO (B2u) = -0.467470973608268  LUMO (Ag) = -0.10521941140661
cycle= 14 E= -75.3806068289575  delta_E= -2.84e-14  |g|= 5.18e-10  |ddm|= 1.92e-10
HOMO (B2u) = -0.467470973616965  LUMO (Ag) = -0.105219411397833
cycle= 15 E= -75.3806068289575  delta_E= 1.42e-14  |g|= 4.55e-10  |ddm|= 4.71e-10
HOMO (B2u) = -0.46747097358385  LUMO (Ag) = -0.105219411381442
cycle= 16 E= -75.3806068289573  delta_E= 1.14e-13  |g|= 4.02e-10  |ddm|= 9.52e-10
HOMO (B2u) = -0.467470973562386  LUMO (Ag) = -0.105219411401096
cycle= 17 E= -75.3806068289574  delta_E= -8.53e-14  |g|= 5.3e-10  |ddm|= 9.03e-10
HOMO (B2u) = -0.467470973601855  LUMO (Ag) = -0.105219411390989
cycle= 18 E= -75.3806068289574  delta_E= 1.42e-14  |g|= 3.24e-10  |ddm|= 4.57e-10
HOMO (B2u) = -0.467470973565546  LUMO (Ag) = -0.105219411341533
cycle= 19 E= -75.3806068289573  delta_E= 7.11e-14  |g|= 1.12e-10  |ddm|= 7.7e-10
HOMO (B2u) = -0.467470973562428  LUMO (Ag) = -0.105219411337319
cycle= 20 E= -75.3806068289574  delta_E= -5.68e-14  |g|= 9.61e-11  |ddm|= 4.39e-11
HOMO (B2u) = -0.467470973564964  LUMO (Ag) = -0.105219411337359
cycle= 21 E= -75.3806068289575  delta_E= -7.11e-14  |g|= 8.08e-11  |ddm|= 3.66e-11
HOMO (B2u) = -0.467470973565445  LUMO (Ag) = -0.105219411336002
cycle= 22 E= -75.3806068289574  delta_E= 2.84e-14  |g|= 6.7e-11  |ddm|= 3.22e-11
HOMO (B2u) = -0.467470973566047  LUMO (Ag) = -0.105219411334899
cycle= 23 E= -75.3806068289574  delta_E=    0  |g|= 5.54e-11  |ddm|= 3.57e-11
HOMO (B3u) = -0.467470973570296  LUMO (Ag) = -0.105219411332077
Extra cycle  E= -75.3806068289573  delta_E= 1.14e-13  |g|= 1.52e-11  |ddm|= 6.07e-11
converged SCF energy = -75.3806068289573

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpxaf4ze6o
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5432350452005  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5633378815483  dE = -0.020102836  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5798666745112  dE = -0.016528793  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0508  |maxRot[o]|=0.0765
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5891764418764  dE = -0.0093097674  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0302  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5958196610637  dE = -0.0066432192  S^2 = 0.0000000
               |grad[o]|=0.0699  |ddm|=0.0111  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6011966185216  dE = -0.0053769575  S^2 = 0.0000000
               |grad[o]|=0.0557  |ddm|=0.00578  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.605656983182  dE = -0.0044603647  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00393  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6092561924977  dE = -0.0035992093  S^2 = 0.0000000
               |grad[o]|=0.034  |ddm|=0.00337  |maxRot[o]|=0.0797
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6118597709645  dE = -0.0026035785  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6135439050929  dE = -0.0016841341  S^2 = 0.0000000
               |grad[o]|=0.0171  |ddm|=0.00365  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.614387191295  dE = -0.0008432862  S^2 = 0.0000000
               |grad[o]|= 0.01  |ddm|=0.00384  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6145205407693  dE = -0.00013334947  S^2 = 0.0000000
               |grad[o]|=0.00374  |ddm|=0.00405  |maxRot[o]|= 0.04
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6145268325251  dE = -6.2917557e-06  S^2 = 0.0000000
               |grad[o]|=0.000953  |ddm|=0.0023  |maxRot[o]|=0.00978
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6145269498081  dE = -1.1728301e-07  S^2 = 0.0000000
               |grad[o]|=0.000186  |ddm|=0.000824  |maxRot[o]|=0.00121
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6145269527589  dE = -2.9507987e-09  S^2 = 0.0000000
               |grad[o]|=3.32e-05  |ddm|=0.000205  |maxRot[o]|=0.000182
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6145269528459  dE = -8.7084118e-11  S^2 = 0.0000000
               |grad[o]|=6.05e-06  |ddm|=4.46e-05  |maxRot[o]|=3.08e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6145269528483  dE = -2.3021585e-12  S^2 = 0.0000000
               |grad[o]|=1.09e-06  |ddm|=9.17e-06  |maxRot[o]|=5.64e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98576842 1.56903902 1.90400163 1.90400116 0.42663285 0.0993386
 0.0993385  0.01187982]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00276   0.00252   0.00000   0.00000  -0.00155
  0 C 2s       0.58703   0.49855   0.00000   0.00000  -0.39116
  0 C 3s      -0.05216   0.00914   0.00000   0.00000  -0.01848
  0 C 2px      0.00000   0.00000  -0.00000   0.70609   0.00000
  0 C 2py     -0.00000  -0.00000   0.70609   0.00000  -0.00000
  0 C 2pz      0.38514  -0.50131   0.00000  -0.00000   0.58739
  0 C 3px      0.00000  -0.00000  -0.00000  -0.01737  -0.00000
  0 C 3py      0.00000  -0.00000  -0.01737   0.00000  -0.00000
  0 C 3pz     -0.05093  -0.00632   0.00000   0.00000  -0.03868
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03373   0.00000  -0.00000
  0 C 3dz^2    0.04175   0.00318   0.00000   0.00000   0.01107
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03373  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00276  -0.00252   0.00000   0.00000  -0.00155
  1 C 2s       0.58703  -0.49855  -0.00000  -0.00000  -0.39116
  1 C 3s      -0.05216  -0.00914  -0.00000  -0.00000  -0.01848
  1 C 2px     -0.00000   0.00000   0.00000   0.70609   0.00000
  1 C 2py     -0.00000   0.00000   0.70609  -0.00000   0.00000
  1 C 2pz     -0.38514  -0.50131   0.00000  -0.00000  -0.58739
  1 C 3px     -0.00000  -0.00000   0.00000  -0.01737   0.00000
  1 C 3py      0.00000   0.00000  -0.01737  -0.00000   0.00000
  1 C 3pz      0.05093  -0.00632   0.00000   0.00000   0.03868
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.03373   0.00000  -0.00000
  1 C 3dz^2    0.04175  -0.00318  -0.00000   0.00000   0.01107
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03373  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00080
  0 C 2s       0.00000   0.00000   0.50039
  0 C 3s      -0.00000  -0.00000  -0.04369
  0 C 2px      0.70617   0.00000  -0.00000
  0 C 2py      0.00000   0.70617   0.00000
  0 C 2pz     -0.00000  -0.00000   0.49657
  0 C 3px     -0.02753   0.00000  -0.00000
  0 C 3py      0.00000  -0.02753  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00467
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03305
  0 C 3dxz    -0.02382   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00080
  1 C 2s       0.00000   0.00000  -0.50039
  1 C 3s       0.00000   0.00000   0.04369
  1 C 2px     -0.70617  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70617   0.00000
  1 C 2pz     -0.00000   0.00000   0.49657
  1 C 3px      0.02753  -0.00000   0.00000
  1 C 3py     -0.00000   0.02753  -0.00000
  1 C 3pz     -0.00000  -0.00000   0.00467
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03305
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99511402
<CAS-nat-orb|mo-hf>  4  4    0.99863346
<CAS-nat-orb|mo-hf>  5  5    0.99981869
<CAS-nat-orb|mo-hf>  6  6    0.99981869
<CAS-nat-orb|mo-hf>  7  7    0.98014678
<CAS-nat-orb|mo-hf>  8  8    0.92376839
<CAS-nat-orb|mo-hf>  9  9    0.92376829
<CAS-nat-orb|mo-hf>  10  10    0.44416418
<CAS-nat-orb|mo-hf>  10  17    0.59838638
<CAS-nat-orb|mo-hf>  10  20   -0.60893960
CASSCF energy = -75.6145269528483
CASCI E = -75.6145269528483  E(CI) = -18.0065822075075  S^2 = 0.0000000
Time cost =    217.592
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:03:38 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.217107585116 AA    0.000000000000   0.000000000000   2.300000000000 Bohr   0.0

nuclear repulsion = 15.6521739130435
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.15]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5684.30


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp8yi368io
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.5736679955661

WARN: Singularity detected in overlap matrix (condition number =  684). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.275669226345096  LUMO (Ag) = -0.189888551192397
cycle= 1 E= -75.3709156762751  delta_E= 0.203  |g|= 0.194  |ddm|=  1.5
HOMO (B3u) = -0.494059555931338  LUMO (Ag) = -0.14055768811163
cycle= 2 E= -75.3842064529923  delta_E= -0.0133  |g|= 0.0519  |ddm|= 0.217
HOMO (B3u) = -0.458318448325722  LUMO (Ag) = -0.104627267109313
cycle= 3 E= -75.3850020490568  delta_E= -0.000796  |g|= 0.00987  |ddm|= 0.0675
HOMO (B3u) = -0.460162695295053  LUMO (Ag) = -0.104859312382323
cycle= 4 E= -75.3850609582636  delta_E= -5.89e-05  |g|= 0.00188  |ddm|= 0.038
HOMO (B3u) = -0.46094626439044  LUMO (Ag) = -0.105848218108886
cycle= 5 E= -75.3850633096871  delta_E= -2.35e-06  |g|= 0.000188  |ddm|= 0.0127
HOMO (B2u) = -0.460927636332218  LUMO (Ag) = -0.105880739343785
cycle= 6 E= -75.3850633353856  delta_E= -2.57e-08  |g|= 2.43e-05  |ddm|= 0.00106
HOMO (B2u) = -0.460929625185355  LUMO (Ag) = -0.105890953720644
cycle= 7 E= -75.3850633357242  delta_E= -3.39e-10  |g|= 2.81e-06  |ddm|= 0.000195
HOMO (B2u) = -0.4609300550661  LUMO (Ag) = -0.105891268417322
cycle= 8 E= -75.3850633357272  delta_E= -3e-12  |g|= 1.94e-07  |ddm|= 3.21e-05
HOMO (B2u) = -0.460930071210988  LUMO (Ag) = -0.105891273497123
cycle= 9 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 1.06e-08  |ddm|= 5.6e-07
HOMO (B2u) = -0.46093006816967  LUMO (Ag) = -0.105891267979892
cycle= 10 E= -75.3850633357272  delta_E= -7.11e-14  |g|= 7.05e-09  |ddm|= 1.11e-08
HOMO (B2u) = -0.460930070689216  LUMO (Ag) = -0.105891270566815
cycle= 11 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 9.66e-10  |ddm|= 1.94e-08
HOMO (B2u) = -0.460930070833461  LUMO (Ag) = -0.105891270663752
cycle= 12 E= -75.3850633357272  delta_E=    0  |g|= 7.9e-10  |ddm|= 2.56e-09
HOMO (B2u) = -0.460930070808792  LUMO (Ag) = -0.105891270628535
cycle= 13 E= -75.3850633357272  delta_E= 7.11e-14  |g|= 6.4e-10  |ddm|= 7.08e-10
HOMO (B2u) = -0.460930070827132  LUMO (Ag) = -0.105891270646837
cycle= 14 E= -75.3850633357272  delta_E= -4.26e-14  |g|= 6.03e-10  |ddm|= 7.64e-10
HOMO (B2u) = -0.460930070827236  LUMO (Ag) = -0.105891270638936
cycle= 15 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 5.26e-10  |ddm|= 5.15e-10
HOMO (B2u) = -0.460930070802115  LUMO (Ag) = -0.105891270620551
cycle= 16 E= -75.3850633357272  delta_E= 5.68e-14  |g|= 4.65e-10  |ddm|= 4.68e-10
HOMO (B2u) = -0.46093007076264  LUMO (Ag) = -0.105891270622371
cycle= 17 E= -75.3850633357273  delta_E= -1.28e-13  |g|= 5.48e-10  |ddm|= 1.21e-09
HOMO (B2u) = -0.460930070795902  LUMO (Ag) = -0.105891270601703
cycle= 18 E= -75.3850633357273  delta_E= 1.42e-14  |g|= 3.05e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.460930070750205  LUMO (Ag) = -0.105891270547287
cycle= 19 E= -75.3850633357272  delta_E= 7.11e-14  |g|= 1.28e-10  |ddm|= 7.2e-10
HOMO (B2u) = -0.460930070747991  LUMO (Ag) = -0.105891270543401
cycle= 20 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 1.1e-10  |ddm|= 3.94e-11
HOMO (B2u) = -0.460930070751106  LUMO (Ag) = -0.105891270544071
cycle= 21 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 9.3e-11  |ddm|= 3.86e-11
HOMO (B2u) = -0.460930070752772  LUMO (Ag) = -0.105891270543992
cycle= 22 E= -75.3850633357272  delta_E= 8.53e-14  |g|= 7.86e-11  |ddm|= 2.77e-11
HOMO (B3u) = -0.46093007075419  LUMO (Ag) = -0.105891270543476
cycle= 23 E= -75.3850633357272  delta_E= -5.68e-14  |g|= 6.39e-11  |ddm|= 3.77e-11
HOMO (B3u) = -0.460930070755269  LUMO (Ag) = -0.105891270542822
cycle= 24 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 5.17e-11  |ddm|= 4.62e-11
HOMO (B3u) = -0.460930070756109  LUMO (Ag) = -0.105891270541844
cycle= 25 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 4.1e-11  |ddm|= 3.25e-11
HOMO (B3u) = -0.460930070757864  LUMO (Ag) = -0.105891270540604
cycle= 26 E= -75.3850633357273  delta_E= -5.68e-14  |g|= 2.64e-11  |ddm|= 3.16e-11
HOMO (B3u) = -0.460930070759844  LUMO (Ag) = -0.105891270541408
cycle= 27 E= -75.3850633357271  delta_E= 1.28e-13  |g|= 2.09e-11  |ddm|= 2.2e-11
HOMO (B3u) = -0.460930070759517  LUMO (Ag) = -0.105891270540482
cycle= 28 E= -75.3850633357272  delta_E= -8.53e-14  |g|= 1.73e-11  |ddm|= 9.03e-12
HOMO (B3u) = -0.460930070759135  LUMO (Ag) = -0.105891270539565
cycle= 29 E= -75.3850633357273  delta_E= -5.68e-14  |g|= 1.42e-11  |ddm|= 8e-12
HOMO (B3u) = -0.460930070758851  LUMO (Ag) = -0.105891270538798
cycle= 30 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 1.15e-11  |ddm|= 7.54e-12
HOMO (B3u) = -0.460930070758638  LUMO (Ag) = -0.10589127053814
cycle= 31 E= -75.3850633357272  delta_E= 1.14e-13  |g|= 9.12e-12  |ddm|= 6.85e-12
HOMO (B3u) = -0.460930070758512  LUMO (Ag) = -0.105891270537619
cycle= 32 E= -75.3850633357271  delta_E= 5.68e-14  |g|= 7.19e-12  |ddm|= 5.11e-12
HOMO (B3u) = -0.460930070758468  LUMO (Ag) = -0.105891270537234
cycle= 33 E= -75.3850633357272  delta_E= -8.53e-14  |g|= 5.67e-12  |ddm|= 3.3e-12
HOMO (B3u) = -0.460930070758478  LUMO (Ag) = -0.105891270536964
cycle= 34 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 4.56e-12  |ddm|= 1.98e-12
HOMO (B3u) = -0.460930070758487  LUMO (Ag) = -0.105891270536788
cycle= 35 E= -75.3850633357273  delta_E= -7.11e-14  |g|= 3.81e-12  |ddm|= 1.87e-12
HOMO (B3u) = -0.46093007075853  LUMO (Ag) = -0.105891270536658
cycle= 36 E= -75.3850633357271  delta_E= 1.99e-13  |g|= 3.12e-12  |ddm|= 2.27e-12
HOMO (B2u) = -0.460930070758564  LUMO (Ag) = -0.105891270536543
cycle= 37 E= -75.3850633357273  delta_E= -1.85e-13  |g|= 2.54e-12  |ddm|= 1.95e-12
HOMO (B2u) = -0.460930070758588  LUMO (Ag) = -0.105891270536442
cycle= 38 E= -75.3850633357272  delta_E= 7.11e-14  |g|= 2.06e-12  |ddm|= 1.67e-12
HOMO (B3u) = -0.460930070758604  LUMO (Ag) = -0.105891270536353
cycle= 39 E= -75.3850633357273  delta_E= -5.68e-14  |g|= 1.68e-12  |ddm|= 1.33e-12
HOMO (B3u) = -0.460930070758614  LUMO (Ag) = -0.105891270536279
cycle= 40 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 1.37e-12  |ddm|= 1.04e-12
HOMO (B3u) = -0.460930070758619  LUMO (Ag) = -0.105891270536216
cycle= 41 E= -75.3850633357272  delta_E= 7.11e-14  |g|= 1.13e-12  |ddm|= 8.25e-13
HOMO (B3u) = -0.460930070758622  LUMO (Ag) = -0.105891270536163
cycle= 42 E= -75.3850633357273  delta_E= -1.28e-13  |g|= 9.44e-13  |ddm|= 5.96e-13
HOMO (B3u) = -0.460930070758622  LUMO (Ag) = -0.105891270536118
cycle= 43 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 7.9e-13  |ddm|= 6.26e-13
HOMO (B3u) = -0.460930070758621  LUMO (Ag) = -0.105891270536078
cycle= 44 E= -75.3850633357273  delta_E= 5.68e-14  |g|= 6.47e-13  |ddm|= 5.61e-13
HOMO (B3u) = -0.460930070758621  LUMO (Ag) = -0.105891270536047
cycle= 45 E= -75.3850633357273  delta_E=    0  |g|= 5.38e-13  |ddm|= 3.64e-13
HOMO (B3u) = -0.460930070758628  LUMO (Ag) = -0.105891270535958
Extra cycle  E= -75.3850633357272  delta_E= 4.26e-14  |g|= 2.18e-13  |ddm|= 1.34e-12
converged SCF energy = -75.3850633357272

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp8yi368io
max_memory 4000 MB (current use 167 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5493989307648  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5700723750487  dE = -0.020673444  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5865706340659  dE = -0.016498259  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0532  |maxRot[o]|=0.0764
macro iter 3 (6 JK  0 micro), CASSCF E = -75.595832026017  dE = -0.009261392  S^2 = 0.0000000
               |grad[o]|=0.0881  |ddm|=0.0308  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6025808202102  dE = -0.0067487942  S^2 = 0.0000000
               |grad[o]|=0.069  |ddm|=0.0115  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6080431028839  dE = -0.0054622827  S^2 = 0.0000000
               |grad[o]|=0.0545  |ddm|=0.00631  |maxRot[o]|=0.0795
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6123313014589  dE = -0.0042881986  S^2 = 0.0000000
               |grad[o]|=0.0425  |ddm|=0.00445  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6155976436738  dE = -0.0032663422  S^2 = 0.0000000
               |grad[o]|=0.0324  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6179396574996  dE = -0.0023420138  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00362  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194238166342  dE = -0.0014841591  S^2 = 0.0000000
               |grad[o]|=0.016  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6201144309327  dE = -0.0006906143  S^2 = 0.0000000
               |grad[o]|=0.00899  |ddm|=0.0039  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201867175847  dE = -7.2286652e-05  S^2 = 0.0000000
               |grad[o]|=0.00281  |ddm|=0.00412  |maxRot[o]|=0.0333
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201877724459  dE = -1.0548612e-06  S^2 = 0.0000000
               |grad[o]|=0.00052  |ddm|=0.00202  |maxRot[o]|=0.00369
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201877958083  dE = -2.3362389e-08  S^2 = 0.0000000
               |grad[o]|=9.05e-05  |ddm|=0.000481  |maxRot[o]|=0.00051
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6201877964404  dE = -6.3209882e-10  S^2 = 0.0000000
               |grad[o]|=1.57e-05  |ddm|=0.000108  |maxRot[o]|=8.3e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6201877964596  dE = -1.9241497e-11  S^2 = 0.0000000
               |grad[o]|=2.92e-06  |ddm|=2.26e-05  |maxRot[o]|=1.42e-05
2-step CASSCF converged in 15 macro (76 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98500898 1.58412136 1.89795623 1.89795655 0.41151926 0.10541182
 0.10541195 0.01261384]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00317   0.00262   0.00000   0.00000  -0.00145
  0 C 2s       0.59002   0.50721   0.00000  -0.00000  -0.38673
  0 C 3s      -0.05064   0.00902   0.00000  -0.00000  -0.01545
  0 C 2px      0.00000  -0.00000  -0.00000   0.70621  -0.00000
  0 C 2py      0.00000   0.00000   0.70621  -0.00000  -0.00000
  0 C 2pz      0.38111  -0.49255   0.00000  -0.00000   0.59034
  0 C 3px      0.00000  -0.00000   0.00000  -0.01351   0.00000
  0 C 3py     -0.00000   0.00000  -0.01351   0.00000  -0.00000
  0 C 3pz     -0.04932  -0.00573   0.00000  -0.00000  -0.03961
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.03283   0.00000  -0.00000
  0 C 3dz^2    0.04041   0.00253   0.00000  -0.00000   0.01144
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03283   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00317  -0.00262   0.00000   0.00000  -0.00145
  1 C 2s       0.59002  -0.50721   0.00000   0.00000  -0.38673
  1 C 3s      -0.05064  -0.00902  -0.00000   0.00000  -0.01545
  1 C 2px     -0.00000   0.00000  -0.00000   0.70621  -0.00000
  1 C 2py      0.00000  -0.00000   0.70621  -0.00000   0.00000
  1 C 2pz     -0.38111  -0.49255   0.00000  -0.00000  -0.59034
  1 C 3px     -0.00000   0.00000   0.00000  -0.01351   0.00000
  1 C 3py     -0.00000  -0.00000  -0.01351   0.00000   0.00000
  1 C 3pz      0.04932  -0.00573   0.00000  -0.00000   0.03961
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03283  -0.00000  -0.00000
  1 C 3dz^2    0.04041  -0.00253  -0.00000   0.00000   0.01144
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03283  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00075
  0 C 2s      -0.00000   0.00000   0.49173
  0 C 3s      -0.00000   0.00000  -0.04330
  0 C 2px      0.70622  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70622   0.00000
  0 C 2pz     -0.00000  -0.00000   0.50534
  0 C 3px     -0.02618  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.02618   0.00000
  0 C 3pz     -0.00000   0.00000   0.00676
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02379   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.03024
  0 C 3dxz    -0.02379  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00075
  1 C 2s       0.00000  -0.00000  -0.49173
  1 C 3s       0.00000  -0.00000   0.04330
  1 C 2px     -0.70622   0.00000   0.00000
  1 C 2py      0.00000  -0.70622   0.00000
  1 C 2pz     -0.00000   0.00000   0.50534
  1 C 3px      0.02618   0.00000   0.00000
  1 C 3py      0.00000   0.02618  -0.00000
  1 C 3pz     -0.00000   0.00000   0.00676
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02379   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03024
  1 C 3dxz    -0.02379  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99486434
<CAS-nat-orb|mo-hf>  4  4    0.99859054
<CAS-nat-orb|mo-hf>  5  5    0.99980387
<CAS-nat-orb|mo-hf>  6  6    0.99980387
<CAS-nat-orb|mo-hf>  7  7    0.97957781
<CAS-nat-orb|mo-hf>  8  8    0.92972102
<CAS-nat-orb|mo-hf>  9  9    0.92972112
<CAS-nat-orb|mo-hf>  10  10    0.45886323
<CAS-nat-orb|mo-hf>  10  17    0.62354822
<CAS-nat-orb|mo-hf>  10  20   -0.57985787
CASSCF energy = -75.6201877964596
CASCI E = -75.6201877964596  E(CI) = -17.8576549918631  S^2 = 0.0000000
Time cost =    149.703
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:06:08 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.243566445662 AA    0.000000000000   0.000000000000   2.350000000000 Bohr   0.0

nuclear repulsion = 15.3191489361702
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.175]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      5790.62


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpjoo8jaaw
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.520080440469

WARN: Singularity detected in overlap matrix (condition number =  625). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.264198750943282  LUMO (Ag) = -0.186664127921807
cycle= 1 E= -75.372158499346  delta_E= 0.148  |g|= 0.198  |ddm|= 1.49
HOMO (B3u) = -0.488497893717001  LUMO (Ag) = -0.142939777698248
cycle= 2 E= -75.3860697595071  delta_E= -0.0139  |g|= 0.052  |ddm|= 0.225
HOMO (B2u) = -0.452348284546125  LUMO (Ag) = -0.10575687189714
cycle= 3 E= -75.3868762726883  delta_E= -0.000807  |g|= 0.00951  |ddm|= 0.0641
HOMO (B2u) = -0.453936921014673  LUMO (Ag) = -0.105452022681083
cycle= 4 E= -75.386930555089  delta_E= -5.43e-05  |g|= 0.00182  |ddm|= 0.034
HOMO (B2u) = -0.454699670412096  LUMO (Ag) = -0.106320748353528
cycle= 5 E= -75.3869327103432  delta_E= -2.16e-06  |g|= 0.00013  |ddm|= 0.0115
HOMO (B3u) = -0.454692197268595  LUMO (Ag) = -0.106342680679353
cycle= 6 E= -75.3869327222535  delta_E= -1.19e-08  |g|= 2.27e-05  |ddm|= 0.00104
HOMO (B2u) = -0.454694399587796  LUMO (Ag) = -0.106353370939739
cycle= 7 E= -75.3869327225933  delta_E= -3.4e-10  |g|= 3.04e-06  |ddm|= 8.49e-05
HOMO (B2u) = -0.454694907644852  LUMO (Ag) = -0.106353839610059
cycle= 8 E= -75.3869327225969  delta_E= -3.64e-12  |g|= 2.27e-07  |ddm|= 2.93e-05
HOMO (B2u) = -0.454694923997672  LUMO (Ag) = -0.106353843315668
cycle= 9 E= -75.3869327225969  delta_E= 2.84e-14  |g|= 1.18e-08  |ddm|= 9.54e-07
HOMO (B3u) = -0.454694921260255  LUMO (Ag) = -0.106353838499083
cycle= 10 E= -75.386932722597  delta_E= -8.53e-14  |g|= 6.13e-09  |ddm|= 1.63e-08
HOMO (B3u) = -0.454694923050318  LUMO (Ag) = -0.106353840252555
cycle= 11 E= -75.3869327225969  delta_E= 5.68e-14  |g|= 1.12e-09  |ddm|= 1.32e-08
HOMO (B3u) = -0.454694923183134  LUMO (Ag) = -0.106353840330184
cycle= 12 E= -75.386932722597  delta_E= -8.53e-14  |g|= 9.04e-10  |ddm|= 1.62e-09
HOMO (B3u) = -0.454694923150665  LUMO (Ag) = -0.106353840281163
cycle= 13 E= -75.386932722597  delta_E= 4.26e-14  |g|= 7.16e-10  |ddm|= 7.17e-10
HOMO (B3u) = -0.454694923167985  LUMO (Ag) = -0.106353840290871
cycle= 14 E= -75.386932722597  delta_E= -4.26e-14  |g|= 6.99e-10  |ddm|= 1.31e-09
HOMO (B3u) = -0.454694923166795  LUMO (Ag) = -0.106353840308865
cycle= 15 E= -75.386932722597  delta_E=    0  |g|= 6.17e-10  |ddm|= 9.5e-10
HOMO (B3u) = -0.454694923130661  LUMO (Ag) = -0.106353840279833
cycle= 16 E= -75.3869327225971  delta_E= -5.68e-14  |g|= 5.53e-10  |ddm|= 7.18e-10
HOMO (B3u) = -0.454694923091103  LUMO (Ag) = -0.106353840262913
cycle= 17 E= -75.3869327225971  delta_E= 2.84e-14  |g|= 5.81e-10  |ddm|= 1.14e-09
HOMO (B3u) = -0.454694923115507  LUMO (Ag) = -0.106353840230314
cycle= 18 E= -75.386932722597  delta_E= 8.53e-14  |g|= 2.92e-10  |ddm|= 6.61e-10
HOMO (B3u) = -0.45469492307488  LUMO (Ag) = -0.106353840179674
cycle= 19 E= -75.3869327225971  delta_E= -8.53e-14  |g|= 1.54e-10  |ddm|= 4.77e-10
HOMO (B3u) = -0.454694923074764  LUMO (Ag) = -0.10635384017683
cycle= 20 E= -75.3869327225971  delta_E=    0  |g|= 1.32e-10  |ddm|= 4e-11
HOMO (B3u) = -0.454694923078825  LUMO (Ag) = -0.106353840178086
cycle= 21 E= -75.386932722597  delta_E= 2.84e-14  |g|= 1.13e-10  |ddm|= 5.14e-11
HOMO (B3u) = -0.454694923081282  LUMO (Ag) = -0.106353840178676
cycle= 22 E= -75.386932722597  delta_E= 2.84e-14  |g|= 9.75e-11  |ddm|= 3.65e-11
HOMO (B3u) = -0.454694923082584  LUMO (Ag) = -0.106353840178357
cycle= 23 E= -75.3869327225971  delta_E= -1.14e-13  |g|= 8.04e-11  |ddm|= 4.18e-11
HOMO (B3u) = -0.454694923084042  LUMO (Ag) = -0.106353840176991
cycle= 24 E= -75.386932722597  delta_E= 1.42e-13  |g|= 6.38e-11  |ddm|= 5.85e-11
HOMO (B3u) = -0.454694923085107  LUMO (Ag) = -0.10635384017518
cycle= 25 E= -75.386932722597  delta_E= -2.84e-14  |g|= 4.87e-11  |ddm|= 3.92e-11
HOMO (B3u) = -0.454694923086497  LUMO (Ag) = -0.106353840173248
cycle= 26 E= -75.386932722597  delta_E= -4.26e-14  |g|= 3.32e-11  |ddm|= 2.75e-11
HOMO (B3u) = -0.454694923087876  LUMO (Ag) = -0.106353840173285
cycle= 27 E= -75.386932722597  delta_E= 5.68e-14  |g|= 2.69e-11  |ddm|= 1.36e-11
HOMO (B3u) = -0.45469492308747  LUMO (Ag) = -0.106353840172122
cycle= 28 E= -75.386932722597  delta_E= -4.26e-14  |g|= 2.26e-11  |ddm|= 1.01e-11
HOMO (B3u) = -0.454694923087046  LUMO (Ag) = -0.10635384017102
cycle= 29 E= -75.3869327225971  delta_E= -2.84e-14  |g|= 1.88e-11  |ddm|= 9.71e-12
HOMO (B3u) = -0.454694923086741  LUMO (Ag) = -0.106353840170088
cycle= 30 E= -75.386932722597  delta_E= 4.26e-14  |g|= 1.54e-11  |ddm|= 9.61e-12
HOMO (B3u) = -0.454694923086519  LUMO (Ag) = -0.106353840169267
cycle= 31 E= -75.3869327225971  delta_E= -7.11e-14  |g|= 1.24e-11  |ddm|= 9.36e-12
HOMO (B3u) = -0.4546949230864  LUMO (Ag) = -0.106353840168576
cycle= 32 E= -75.386932722597  delta_E= 1.14e-13  |g|= 9.78e-12  |ddm|= 7.78e-12
HOMO (B3u) = -0.454694923086367  LUMO (Ag) = -0.106353840168067
cycle= 33 E= -75.386932722597  delta_E= -4.26e-14  |g|= 7.78e-12  |ddm|= 5.24e-12
HOMO (B3u) = -0.454694923086383  LUMO (Ag) = -0.106353840167711
cycle= 34 E= -75.386932722597  delta_E= -2.84e-14  |g|= 6.33e-12  |ddm|= 3.61e-12
HOMO (B2u) = -0.454694923086399  LUMO (Ag) = -0.10635384016747
cycle= 35 E= -75.3869327225971  delta_E= -1.42e-14  |g|= 5.3e-12  |ddm|= 3.05e-12
HOMO (B2u) = -0.454694923086442  LUMO (Ag) = -0.106353840167284
cycle= 36 E= -75.386932722597  delta_E= 1.42e-14  |g|= 4.39e-12  |ddm|= 3.2e-12
HOMO (B2u) = -0.454694923086473  LUMO (Ag) = -0.106353840167116
cycle= 37 E= -75.3869327225971  delta_E= -1.42e-14  |g|= 3.62e-12  |ddm|= 2.77e-12
HOMO (B3u) = -0.454694923086493  LUMO (Ag) = -0.106353840166965
cycle= 38 E= -75.386932722597  delta_E= 1.42e-14  |g|= 2.97e-12  |ddm|= 2.37e-12
HOMO (B3u) = -0.454694923086505  LUMO (Ag) = -0.106353840166833
cycle= 39 E= -75.386932722597  delta_E= 1.42e-14  |g|= 2.43e-12  |ddm|= 1.88e-12
HOMO (B3u) = -0.454694923086513  LUMO (Ag) = -0.10635384016672
cycle= 40 E= -75.386932722597  delta_E= -1.42e-14  |g|= 2e-12  |ddm|= 1.59e-12
HOMO (B3u) = -0.454694923086516  LUMO (Ag) = -0.106353840166629
cycle= 41 E= -75.3869327225971  delta_E= -1.42e-14  |g|= 1.65e-12  |ddm|= 1.26e-12
HOMO (B2u) = -0.454694923086518  LUMO (Ag) = -0.106353840166552
cycle= 42 E= -75.3869327225971  delta_E= -2.84e-14  |g|= 1.38e-12  |ddm|= 9.77e-13
HOMO (B3u) = -0.454694923086517  LUMO (Ag) = -0.106353840166489
cycle= 43 E= -75.386932722597  delta_E= 5.68e-14  |g|= 1.15e-12  |ddm|= 8.61e-13
HOMO (B3u) = -0.454694923086517  LUMO (Ag) = -0.106353840166435
cycle= 44 E= -75.3869327225971  delta_E= -5.68e-14  |g|= 9.56e-13  |ddm|= 7.31e-13
HOMO (B3u) = -0.454694923086519  LUMO (Ag) = -0.10635384016639
cycle= 45 E= -75.386932722597  delta_E= 5.68e-14  |g|= 7.92e-13  |ddm|= 6.37e-13
HOMO (B3u) = -0.45469492308652  LUMO (Ag) = -0.106353840166352
cycle= 46 E= -75.3869327225971  delta_E= -2.84e-14  |g|= 6.57e-13  |ddm|= 4.84e-13
HOMO (B2u) = -0.454694923086523  LUMO (Ag) = -0.106353840166322
cycle= 47 E= -75.3869327225971  delta_E=    0  |g|= 5.47e-13  |ddm|= 3.87e-13
HOMO (B2u) = -0.454694923086533  LUMO (Ag) = -0.106353840166237
Extra cycle  E= -75.3869327225971  delta_E=    0  |g|= 2.22e-13  |ddm|= 1.19e-12
converged SCF energy = -75.3869327225971

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpjoo8jaaw
max_memory 4000 MB (current use 174 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5529956225484  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5742379004899  dE = -0.021242278  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5907013338555  dE = -0.016463433  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0556  |maxRot[o]|=0.078
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5999891087195  dE = -0.0092877749  S^2 = 0.0000000
               |grad[o]|=0.0873  |ddm|=0.0313  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066426342087  dE = -0.0066535255  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.012  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6117776285507  dE = -0.0051349943  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.00672  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6158213926924  dE = -0.0040437641  S^2 = 0.0000000
               |grad[o]|=0.042  |ddm|=0.00468  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6189156562424  dE = -0.0030942636  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00394  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6211353675479  dE = -0.0022197113  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00375  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6225338703795  dE = -0.0013985028  S^2 = 0.0000000
               |grad[o]|=0.0158  |ddm|=0.0038  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6231660457141  dE = -0.00063217533  S^2 = 0.0000000
               |grad[o]|=0.00875  |ddm|=0.00396  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6232125140774  dE = -4.6468363e-05  S^2 = 0.0000000
               |grad[o]|=0.00249  |ddm|=0.00421  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6232205425114  dE = -8.028434e-06  S^2 = 0.0000000
               |grad[o]|=0.00104  |ddm|=0.00126  |maxRot[o]|=0.0112
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6232206703334  dE = -1.2782196e-07  S^2 = 0.0000000
               |grad[o]|=0.000189  |ddm|=0.000799  |maxRot[o]|=0.00125
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6232206732061  dE = -2.8726816e-09  S^2 = 0.0000000
               |grad[o]|=3.19e-05  |ddm|=0.00018  |maxRot[o]|=0.000176
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6232206732839  dE = -7.7832851e-11  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=3.89e-05  |maxRot[o]|=2.9e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6232206732861  dE = -2.1742608e-12  S^2 = 0.0000000
               |grad[o]|=9.71e-07  |ddm|=7.82e-06  |maxRot[o]|=5.02e-06
2-step CASSCF converged in 16 macro (77 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98422464 1.59821723 1.89166097 1.89166128 0.39749232 0.11168503
 0.1116852  0.01337334]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00356   0.00273   0.00000   0.00000  -0.00136
  0 C 2s       0.59304   0.51564   0.00000   0.00000  -0.38216
  0 C 3s      -0.04903   0.00893   0.00000   0.00000  -0.01244
  0 C 2px      0.00000   0.00000  -0.00000   0.70632  -0.00000
  0 C 2py      0.00000  -0.00000   0.70632   0.00000  -0.00000
  0 C 2pz      0.37694  -0.48373   0.00000   0.00000   0.59331
  0 C 3px      0.00000   0.00000  -0.00000  -0.00987  -0.00000
  0 C 3py      0.00000  -0.00000  -0.00987  -0.00000   0.00000
  0 C 3pz     -0.04768  -0.00519   0.00000   0.00000  -0.04045
  0 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03194  -0.00000   0.00000
  0 C 3dz^2    0.03910   0.00193   0.00000   0.00000   0.01197
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03194  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00356  -0.00273   0.00000   0.00000  -0.00136
  1 C 2s       0.59304  -0.51564   0.00000   0.00000  -0.38216
  1 C 3s      -0.04903  -0.00893  -0.00000  -0.00000  -0.01244
  1 C 2px     -0.00000  -0.00000   0.00000   0.70632   0.00000
  1 C 2py     -0.00000   0.00000   0.70632   0.00000  -0.00000
  1 C 2pz     -0.37694  -0.48373   0.00000  -0.00000  -0.59331
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00987   0.00000
  1 C 3py     -0.00000   0.00000  -0.00987   0.00000  -0.00000
  1 C 3pz      0.04768  -0.00519   0.00000   0.00000   0.04045
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03194  -0.00000   0.00000
  1 C 3dz^2    0.03910  -0.00193  -0.00000  -0.00000   0.01197
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03194  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00071
  0 C 2s       0.00000   0.00000   0.48298
  0 C 3s       0.00000   0.00000  -0.04305
  0 C 2px      0.70627   0.00000  -0.00000
  0 C 2py     -0.00000   0.70627   0.00000
  0 C 2pz      0.00000   0.00000   0.51383
  0 C 3px     -0.02494   0.00000  -0.00000
  0 C 3py      0.00000  -0.02494   0.00000
  0 C 3pz     -0.00000   0.00000   0.00873
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02373   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02798
  0 C 3dxz    -0.02373   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00071
  1 C 2s       0.00000  -0.00000  -0.48298
  1 C 3s      -0.00000  -0.00000   0.04305
  1 C 2px     -0.70627  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70627  -0.00000
  1 C 2pz     -0.00000   0.00000   0.51383
  1 C 3px      0.02494  -0.00000   0.00000
  1 C 3py     -0.00000   0.02494  -0.00000
  1 C 3pz      0.00000   0.00000   0.00873
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02373   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02798
  1 C 3dxz    -0.02373   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99460039
<CAS-nat-orb|mo-hf>  4  4    0.99853697
<CAS-nat-orb|mo-hf>  5  5    0.99978677
<CAS-nat-orb|mo-hf>  6  6    0.99978677
<CAS-nat-orb|mo-hf>  7  7    0.97901221
<CAS-nat-orb|mo-hf>  8  8    0.93514178
<CAS-nat-orb|mo-hf>  9  9    0.93514186
<CAS-nat-orb|mo-hf>  10  10    0.47490967
<CAS-nat-orb|mo-hf>  10  17    0.64513932
<CAS-nat-orb|mo-hf>  10  20   -0.55018486
CASSCF energy = -75.6232206732861
CASCI E = -75.6232206732861  E(CI) = -17.7126744337438  S^2 = 0.0000000
Time cost =    785.662
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:19:13 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.270025306208 AA    0.000000000000   0.000000000000   2.400000000000 Bohr   0.0

nuclear repulsion = 15
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.2]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6341.78


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpv2q8u51c
max_memory 4000 MB (current use 174 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4681036266052

WARN: Singularity detected in overlap matrix (condition number =  573). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.253350702957072  LUMO (Ag) = -0.183612207324934
cycle= 1 E= -75.3711621684052  delta_E= 0.0969  |g|= 0.203  |ddm|= 1.48
HOMO (B3u) = -0.483102395155577  LUMO (Ag) = -0.14501405440387
cycle= 2 E= -75.3857253013104  delta_E= -0.0146  |g|= 0.052  |ddm|= 0.234
HOMO (B3u) = -0.446604227160941  LUMO (Ag) = -0.10662994003031
cycle= 3 E= -75.3865468682809  delta_E= -0.000822  |g|= 0.00932  |ddm|= 0.0615
HOMO (B3u) = -0.447990769174568  LUMO (Ag) = -0.105837943292173
cycle= 4 E= -75.3865987559146  delta_E= -5.19e-05  |g|= 0.00179  |ddm|= 0.0304
HOMO (B3u) = -0.448742110750614  LUMO (Ag) = -0.106605000995197
cycle= 5 E= -75.386600812118  delta_E= -2.06e-06  |g|= 7.74e-05  |ddm|= 0.0104
HOMO (B2u) = -0.448735377102866  LUMO (Ag) = -0.106607023368655
cycle= 6 E= -75.3866008154598  delta_E= -3.34e-09  |g|= 1.47e-05  |ddm|= 0.000795
HOMO (B2u) = -0.448736161720342  LUMO (Ag) = -0.106613403607852
cycle= 7 E= -75.3866008156198  delta_E= -1.6e-10  |g|= 2.92e-06  |ddm|= 4.96e-05
HOMO (B3u) = -0.44873672159591  LUMO (Ag) = -0.106614233435084
cycle= 8 E= -75.3866008156238  delta_E= -4.04e-12  |g|= 2.59e-07  |ddm|= 1.95e-05
HOMO (B2u) = -0.448736741737648  LUMO (Ag) = -0.106614252118867
cycle= 9 E= -75.3866008156237  delta_E= 5.68e-14  |g|= 1.3e-08  |ddm|= 1.45e-06
HOMO (B2u) = -0.448736740752135  LUMO (Ag) = -0.106614250133202
cycle= 10 E= -75.3866008156238  delta_E= -4.26e-14  |g|= 5.79e-09  |ddm|= 2.11e-08
HOMO (B2u) = -0.448736740306395  LUMO (Ag) = -0.106614249137751
cycle= 11 E= -75.3866008156238  delta_E= 1.42e-14  |g|= 1.21e-09  |ddm|= 1.29e-08
HOMO (B2u) = -0.448736740434189  LUMO (Ag) = -0.106614249219117
cycle= 12 E= -75.3866008156238  delta_E= -4.26e-14  |g|= 9.91e-10  |ddm|= 1.68e-09
HOMO (B2u) = -0.448736740403558  LUMO (Ag) = -0.106614249162436
cycle= 13 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 7.79e-10  |ddm|= 9.85e-10
HOMO (B2u) = -0.448736740434213  LUMO (Ag) = -0.106614249171284
cycle= 14 E= -75.3866008156238  delta_E=    0  |g|= 7.65e-10  |ddm|= 1.81e-09
HOMO (B2u) = -0.448736740438838  LUMO (Ag) = -0.106614249220637
cycle= 15 E= -75.3866008156238  delta_E= 1.42e-14  |g|= 6.89e-10  |ddm|= 1.26e-09
HOMO (B2u) = -0.448736740358601  LUMO (Ag) = -0.106614249170188
cycle= 16 E= -75.3866008156238  delta_E= 4.26e-14  |g|= 6.73e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.44873674033757  LUMO (Ag) = -0.106614249142606
cycle= 17 E= -75.3866008156237  delta_E= 8.53e-14  |g|= 6.33e-10  |ddm|= 9.4e-10
HOMO (B2u) = -0.448736740348933  LUMO (Ag) = -0.106614249099463
cycle= 18 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 3.13e-10  |ddm|= 8.01e-10
HOMO (B2u) = -0.448736740350845  LUMO (Ag) = -0.10661424907898
cycle= 19 E= -75.3866008156238  delta_E=    0  |g|= 1.76e-10  |ddm|= 3.32e-10
HOMO (B2u) = -0.448736740350421  LUMO (Ag) = -0.106614249075736
cycle= 20 E= -75.3866008156238  delta_E=    0  |g|= 1.52e-10  |ddm|= 4.76e-11
HOMO (B2u) = -0.448736740354125  LUMO (Ag) = -0.106614249076669
cycle= 21 E= -75.3866008156238  delta_E= -8.53e-14  |g|= 1.32e-10  |ddm|= 6.61e-11
HOMO (B2u) = -0.448736740355958  LUMO (Ag) = -0.106614249076928
cycle= 22 E= -75.3866008156238  delta_E= 4.26e-14  |g|= 1.16e-10  |ddm|= 4.35e-11
HOMO (B2u) = -0.448736740356247  LUMO (Ag) = -0.10661424907645
cycle= 23 E= -75.3866008156238  delta_E= -4.26e-14  |g|= 9.79e-11  |ddm|= 4.72e-11
HOMO (B2u) = -0.448736740357434  LUMO (Ag) = -0.106614249074531
cycle= 24 E= -75.3866008156238  delta_E= 8.53e-14  |g|= 7.89e-11  |ddm|= 6.72e-11
HOMO (B2u) = -0.448736740357505  LUMO (Ag) = -0.106614249070465
cycle= 25 E= -75.3866008156238  delta_E=    0  |g|= 5.88e-11  |ddm|= 4.53e-11
HOMO (B3u) = -0.448736740356621  LUMO (Ag) = -0.106614249062062
Extra cycle  E= -75.3866008156238  delta_E=    0  |g|= 1.9e-11  |ddm|= 7.39e-11
converged SCF energy = -75.3866008156238

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpv2q8u51c
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5544099472183  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5762198089569  dE = -0.021809862  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5926046135298  dE = -0.016384805  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0582  |maxRot[o]|=0.0788
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6014950261366  dE = -0.0088904126  S^2 = 0.0000000
               |grad[o]|=0.0866  |ddm|=0.0318  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6078328304609  dE = -0.0063378043  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.0122  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6127996763949  dE = -0.0049668459  S^2 = 0.0000000
               |grad[o]|=0.054  |ddm|=0.00702  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6167369243486  dE = -0.003937248  S^2 = 0.0000000
               |grad[o]|=0.0426  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6197643644026  dE = -0.0030274401  S^2 = 0.0000000
               |grad[o]|=0.0328  |ddm|=0.00419  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6219453386472  dE = -0.0021809742  S^2 = 0.0000000
               |grad[o]|=0.0241  |ddm|=0.0039  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6233253048386  dE = -0.0013799662  S^2 = 0.0000000
               |grad[o]|=0.0162  |ddm|=0.00389  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6239527364932  dE = -0.00062743165  S^2 = 0.0000000
               |grad[o]|=0.00898  |ddm|=0.00404  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6239994402993  dE = -4.6703806e-05  S^2 = 0.0000000
               |grad[o]|=0.00254  |ddm|=0.00433  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6240076588572  dE = -8.2185579e-06  S^2 = 0.0000000
               |grad[o]|=0.00105  |ddm|=0.00126  |maxRot[o]|=0.0113
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6240077853573  dE = -1.2650013e-07  S^2 = 0.0000000
               |grad[o]|=0.000189  |ddm|=0.000798  |maxRot[o]|=0.00123
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6240077881097  dE = -2.7523299e-09  S^2 = 0.0000000
               |grad[o]|=3.14e-05  |ddm|=0.000172  |maxRot[o]|=0.00017
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6240077881801  dE = -7.0400574e-11  S^2 = 0.0000000
               |grad[o]|=5.07e-06  |ddm|=3.62e-05  |maxRot[o]|=2.77e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6240077881817  dE = -1.6200374e-12  S^2 = 0.0000000
               |grad[o]|=9.39e-07  |ddm|=7.18e-06  |maxRot[o]|=4.69e-06
2-step CASSCF converged in 16 macro (77 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98341796 1.61142014 1.88510523 1.88510467 0.38447467 0.11816041
 0.11816044 0.01415649]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00394   0.00282   0.00000   0.00000  -0.00128
  0 C 2s       0.59610   0.52384   0.00000  -0.00000  -0.37748
  0 C 3s      -0.04733   0.00887   0.00000  -0.00000  -0.00946
  0 C 2px      0.00000  -0.00000  -0.00000   0.70639  -0.00000
  0 C 2py     -0.00000   0.00000   0.70639  -0.00000  -0.00000
  0 C 2pz      0.37264  -0.47485  -0.00000  -0.00000   0.59629
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00643  -0.00000
  0 C 3py     -0.00000   0.00000  -0.00643  -0.00000  -0.00000
  0 C 3pz     -0.04603  -0.00469   0.00000  -0.00000  -0.04119
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.03106  -0.00000  -0.00000
  0 C 3dz^2    0.03783   0.00135   0.00000  -0.00000   0.01265
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03106  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00394  -0.00282   0.00000   0.00000  -0.00128
  1 C 2s       0.59610  -0.52384  -0.00000   0.00000  -0.37748
  1 C 3s      -0.04733  -0.00887  -0.00000   0.00000  -0.00946
  1 C 2px      0.00000   0.00000   0.00000   0.70639   0.00000
  1 C 2py      0.00000  -0.00000   0.70639   0.00000   0.00000
  1 C 2pz     -0.37264  -0.47485  -0.00000  -0.00000  -0.59629
  1 C 3px     -0.00000   0.00000   0.00000  -0.00643   0.00000
  1 C 3py      0.00000  -0.00000  -0.00643   0.00000   0.00000
  1 C 3pz      0.04603  -0.00469   0.00000  -0.00000   0.04119
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.03106  -0.00000  -0.00000
  1 C 3dz^2    0.03783  -0.00135  -0.00000   0.00000   0.01265
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03106  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00067
  0 C 2s       0.00000   0.00000   0.47414
  0 C 3s      -0.00000   0.00000  -0.04292
  0 C 2px      0.70631  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70631  -0.00000
  0 C 2pz      0.00000  -0.00000   0.52207
  0 C 3px     -0.02380   0.00000   0.00000
  0 C 3py      0.00000  -0.02380  -0.00000
  0 C 3pz     -0.00000   0.00000   0.01059
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02366   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02618
  0 C 3dxz    -0.02366   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00067
  1 C 2s       0.00000  -0.00000  -0.47414
  1 C 3s       0.00000  -0.00000   0.04292
  1 C 2px     -0.70631  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70631   0.00000
  1 C 2pz     -0.00000  -0.00000   0.52207
  1 C 3px      0.02380   0.00000   0.00000
  1 C 3py      0.00000   0.02380   0.00000
  1 C 3pz     -0.00000   0.00000   0.01059
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02366  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02618
  1 C 3dxz    -0.02366  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99432403
<CAS-nat-orb|mo-hf>  4  4    0.99847304
<CAS-nat-orb|mo-hf>  5  5    0.99976738
<CAS-nat-orb|mo-hf>  6  6    0.99976738
<CAS-nat-orb|mo-hf>  7  7    0.97845223
<CAS-nat-orb|mo-hf>  8  8    0.94007729
<CAS-nat-orb|mo-hf>  9  9    0.94007723
<CAS-nat-orb|mo-hf>  10  10    0.49233326
<CAS-nat-orb|mo-hf>  10  17    0.66275081
<CAS-nat-orb|mo-hf>  10  20   -0.52046340
CASSCF energy = -75.6240077881817
CASCI E = -75.6240077881817  E(CI) = -17.5716139906845  S^2 = 0.0000000
Time cost =    647.088
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:30:01 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.296484166754 AA    0.000000000000   0.000000000000   2.450000000000 Bohr   0.0

nuclear repulsion = 14.6938775510204
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.225]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      6705.84


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpuqzt5pjp
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4178541557328

WARN: Singularity detected in overlap matrix (condition number =  525). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.243088233296001  LUMO (Ag) = -0.180721513540293
cycle= 1 E= -75.3682765376262  delta_E= 0.0496  |g|= 0.207  |ddm|= 1.47
HOMO (B2u) = -0.477856195390324  LUMO (Ag) = -0.146786594446604
cycle= 2 E= -75.3835137621145  delta_E= -0.0152  |g|= 0.0521  |ddm|= 0.243
HOMO (B3u) = -0.441063789154571  LUMO (Ag) = -0.107250630527326
cycle= 3 E= -75.3843533836984  delta_E= -0.00084  |g|= 0.00929  |ddm|= 0.0595
HOMO (B2u) = -0.442295646912938  LUMO (Ag) = -0.106015245128836
cycle= 4 E= -75.3844049545556  delta_E= -5.16e-05  |g|= 0.0018  |ddm|= 0.0274
HOMO (B2u) = -0.443045442143861  LUMO (Ag) = -0.106700546721389
cycle= 5 E= -75.3844070231975  delta_E= -2.07e-06  |g|= 7.54e-05  |ddm|= 0.0094
HOMO (B2u) = -0.443032060379306  LUMO (Ag) = -0.106682393250686
cycle= 6 E= -75.3844070255161  delta_E= -2.32e-09  |g|= 1.3e-05  |ddm|= 0.00058
HOMO (B3u) = -0.443029779172064  LUMO (Ag) = -0.106680098001417
cycle= 7 E= -75.3844070256075  delta_E= -9.13e-11  |g|= 1.64e-06  |ddm|= 2.88e-05
HOMO (B3u) = -0.44302971430508  LUMO (Ag) = -0.106679671912066
cycle= 8 E= -75.3844070256093  delta_E= -1.85e-12  |g|= 2.42e-07  |ddm|= 1.68e-05
HOMO (B3u) = -0.443029690448078  LUMO (Ag) = -0.106679577824021
cycle= 9 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 1.45e-08  |ddm|= 6.37e-07
HOMO (B2u) = -0.443029691481996  LUMO (Ag) = -0.106679578761618
cycle= 10 E= -75.3844070256094  delta_E= -2.84e-14  |g|= 7.82e-09  |ddm|= 1.24e-08
HOMO (B2u) = -0.443029688090178  LUMO (Ag) = -0.106679573957739
cycle= 11 E= -75.3844070256093  delta_E= 9.95e-14  |g|= 1.33e-09  |ddm|= 2.4e-08
HOMO (B3u) = -0.443029688173429  LUMO (Ag) = -0.10667957399741
cycle= 12 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 1.03e-09  |ddm|= 7.84e-10
HOMO (B3u) = -0.443029688157692  LUMO (Ag) = -0.106679573949066
cycle= 13 E= -75.3844070256093  delta_E= 1.42e-14  |g|= 8.08e-10  |ddm|= 7.93e-10
HOMO (B3u) = -0.443029688192928  LUMO (Ag) = -0.106679573943289
cycle= 14 E= -75.3844070256094  delta_E= -4.26e-14  |g|= 7.71e-10  |ddm|= 1.63e-09
HOMO (B3u) = -0.443029688178168  LUMO (Ag) = -0.106679573918896
cycle= 15 E= -75.3844070256094  delta_E= 1.42e-14  |g|= 6.85e-10  |ddm|= 1.78e-10
HOMO (B2u) = -0.443029688160261  LUMO (Ag) = -0.106679573897231
cycle= 16 E= -75.3844070256093  delta_E= 5.68e-14  |g|= 6.11e-10  |ddm|= 4.17e-10
HOMO (B2u) = -0.443029688050056  LUMO (Ag) = -0.10667957393377
cycle= 17 E= -75.3844070256094  delta_E= -5.68e-14  |g|= 7.87e-10  |ddm|= 5.87e-10
HOMO (B3u) = -0.443029688062361  LUMO (Ag) = -0.106679573857665
cycle= 18 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 4.08e-10  |ddm|= 7.24e-10
HOMO (B3u) = -0.443029688139612  LUMO (Ag) = -0.106679573882195
cycle= 19 E= -75.3844070256094  delta_E=    0  |g|= 1.85e-10  |ddm|= 5.24e-10
HOMO (B3u) = -0.44302968813976  LUMO (Ag) = -0.106679573878455
cycle= 20 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 1.58e-10  |ddm|= 6.29e-11
HOMO (B2u) = -0.443029688142296  LUMO (Ag) = -0.106679573877676
cycle= 21 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 1.36e-10  |ddm|= 6.5e-11
HOMO (B3u) = -0.44302968814359  LUMO (Ag) = -0.106679573876906
cycle= 22 E= -75.3844070256093  delta_E= 7.11e-14  |g|= 1.2e-10  |ddm|= 4.68e-11
HOMO (B2u) = -0.443029688143212  LUMO (Ag) = -0.106679573876169
cycle= 23 E= -75.3844070256094  delta_E= -4.26e-14  |g|= 1.02e-10  |ddm|= 3.89e-11
HOMO (B2u) = -0.443029688142307  LUMO (Ag) = -0.106679573875224
cycle= 24 E= -75.3844070256093  delta_E= 4.26e-14  |g|= 8.62e-11  |ddm|= 3.83e-11
HOMO (B3u) = -0.443029688141249  LUMO (Ag) = -0.106679573874426
cycle= 25 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 7.35e-11  |ddm|= 3e-11
HOMO (B3u) = -0.443029688139618  LUMO (Ag) = -0.106679573866728
cycle= 26 E= -75.3844070256094  delta_E=    0  |g|= 4.79e-11  |ddm|= 4.73e-11
HOMO (B3u) = -0.443029688137375  LUMO (Ag) = -0.106679573858956
Extra cycle  E= -75.3844070256094  delta_E= -2.84e-14  |g|= 1.68e-11  |ddm|= 7.15e-11
converged SCF energy = -75.3844070256094

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpuqzt5pjp
max_memory 4000 MB (current use 174 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5539827086567  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5763588276568  dE = -0.022376119  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5917604081543  dE = -0.01540158  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0607  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6003940095819  dE = -0.0086336014  S^2 = 0.0000000
               |grad[o]|=0.0877  |ddm|=0.031  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066572770495  dE = -0.0062632675  S^2 = 0.0000000
               |grad[o]|=0.0695  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6115944214041  dE = -0.0049371444  S^2 = 0.0000000
               |grad[o]|=0.0556  |ddm|=0.00767  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6155233554857  dE = -0.0039289341  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00552  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6185579745404  dE = -0.0030346191  S^2 = 0.0000000
               |grad[o]|=0.0341  |ddm|=0.00451  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6207573771663  dE = -0.0021994026  S^2 = 0.0000000
               |grad[o]|=0.0252  |ddm|=0.00407  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6221629721522  dE = -0.001405595  S^2 = 0.0000000
               |grad[o]|=0.017  |ddm|=0.00399  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6228190651097  dE = -0.00065609296  S^2 = 0.0000000
               |grad[o]|=0.00956  |ddm|=0.00414  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6228849777637  dE = -6.5912654e-05  S^2 = 0.0000000
               |grad[o]|=0.00284  |ddm|=0.00447  |maxRot[o]|=0.0322
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6228858554489  dE = -8.7768517e-07  S^2 = 0.0000000
               |grad[o]|=0.000486  |ddm|=0.00205  |maxRot[o]|=0.00324
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6228858734364  dE = -1.7987546e-08  S^2 = 0.0000000
               |grad[o]|=7.8e-05  |ddm|=0.000393  |maxRot[o]|=0.000423
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6228858738785  dE = -4.4205706e-10  S^2 = 0.0000000
               |grad[o]|=1.3e-05  |ddm|=8.3e-05  |maxRot[o]|=6.84e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6228858738919  dE = -1.3372414e-11  S^2 = 0.0000000
               |grad[o]|=2.1e-06  |ddm|=1.52e-05  |maxRot[o]|=1.1e-05
2-step CASSCF converged in 15 macro (76 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98259227 1.62382441 1.8782739  1.87827413 0.37239183 0.12484108
 0.12484116 0.01496122]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00430   0.00292   0.00000   0.00000  -0.00121
  0 C 2s       0.59918   0.53182   0.00000  -0.00000  -0.37268
  0 C 3s      -0.04557   0.00882   0.00000  -0.00000  -0.00652
  0 C 2px      0.00000  -0.00000  -0.00000   0.70645   0.00000
  0 C 2py      0.00000   0.00000   0.70645  -0.00000  -0.00000
  0 C 2pz      0.36821  -0.46590  -0.00000   0.00000   0.59928
  0 C 3px      0.00000  -0.00000   0.00000  -0.00317  -0.00000
  0 C 3py      0.00000   0.00000  -0.00317  -0.00000  -0.00000
  0 C 3pz     -0.04436  -0.00424   0.00000  -0.00000  -0.04182
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.03019  -0.00000  -0.00000
  0 C 3dz^2    0.03661   0.00082   0.00000  -0.00000   0.01349
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03019  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00430  -0.00292   0.00000   0.00000  -0.00121
  1 C 2s       0.59918  -0.53182   0.00000   0.00000  -0.37268
  1 C 3s      -0.04557  -0.00882  -0.00000   0.00000  -0.00652
  1 C 2px     -0.00000   0.00000  -0.00000   0.70645   0.00000
  1 C 2py     -0.00000  -0.00000   0.70645  -0.00000  -0.00000
  1 C 2pz     -0.36821  -0.46590   0.00000  -0.00000  -0.59928
  1 C 3px     -0.00000   0.00000   0.00000  -0.00317  -0.00000
  1 C 3py     -0.00000  -0.00000  -0.00317   0.00000   0.00000
  1 C 3pz      0.04436  -0.00424   0.00000  -0.00000   0.04182
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03019  -0.00000  -0.00000
  1 C 3dz^2    0.03661  -0.00082  -0.00000   0.00000   0.01349
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.03019   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00063
  0 C 2s      -0.00000   0.00000   0.46522
  0 C 3s      -0.00000   0.00000  -0.04289
  0 C 2px      0.70635  -0.00000  -0.00000
  0 C 2py      0.00000   0.70635   0.00000
  0 C 2pz     -0.00000  -0.00000   0.53006
  0 C 3px     -0.02272   0.00000  -0.00000
  0 C 3py      0.00000  -0.02272   0.00000
  0 C 3pz     -0.00000   0.00000   0.01231
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02357   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02477
  0 C 3dxz    -0.02357   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00063
  1 C 2s       0.00000  -0.00000  -0.46522
  1 C 3s       0.00000  -0.00000   0.04289
  1 C 2px     -0.70635  -0.00000   0.00000
  1 C 2py      0.00000  -0.70635  -0.00000
  1 C 2pz     -0.00000   0.00000   0.53006
  1 C 3px      0.02272  -0.00000   0.00000
  1 C 3py     -0.00000   0.02272  -0.00000
  1 C 3pz     -0.00000   0.00000   0.01231
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02357   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02477
  1 C 3dxz    -0.02357   0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99403732
<CAS-nat-orb|mo-hf>  4  4    0.99839929
<CAS-nat-orb|mo-hf>  5  5    0.99974564
<CAS-nat-orb|mo-hf>  6  6    0.99974564
<CAS-nat-orb|mo-hf>  7  7    0.97790001
<CAS-nat-orb|mo-hf>  8  8    0.94457120
<CAS-nat-orb|mo-hf>  9  9    0.94457124
<CAS-nat-orb|mo-hf>  10  10    0.51114043
<CAS-nat-orb|mo-hf>  10  17    0.67613269
<CAS-nat-orb|mo-hf>  10  18   -0.49120198
CASSCF energy = -75.6228858738919
CASCI E = -75.6228858738919  E(CI) = -17.4344344810947  S^2 = 0.0000000
Time cost =    239.103
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:34:00 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.322943027300 AA    0.000000000000   0.000000000000   2.500000000000 Bohr   0.0

nuclear repulsion = 14.4
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.25]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7263.61


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmppshbm4vo
max_memory 4000 MB (current use 174 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.3694175262293

WARN: Singularity detected in overlap matrix (condition number =  483). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.23337660812262  LUMO (Ag) = -0.177980136770163
cycle= 1 E= -75.3638092539421  delta_E= 0.00561  |g|= 0.211  |ddm|= 1.47
HOMO (B3u) = -0.472745514482945  LUMO (Ag) = -0.148264279814741
cycle= 2 E= -75.3797344374882  delta_E= -0.0159  |g|= 0.0521  |ddm|= 0.252
HOMO (B3u) = -0.435707130637767  LUMO (Ag) = -0.107623543297932
cycle= 3 E= -75.3805941182358  delta_E= -0.00086  |g|= 0.00941  |ddm|= 0.058
HOMO (B2u) = -0.43682644742338  LUMO (Ag) = -0.105984728580028
cycle= 4 E= -75.3806472395887  delta_E= -5.31e-05  |g|= 0.00184  |ddm|= 0.0247
HOMO (B3u) = -0.437581210136123  LUMO (Ag) = -0.106606422286034
cycle= 5 E= -75.3806494262655  delta_E= -2.19e-06  |g|= 0.000123  |ddm|= 0.0084
HOMO (B3u) = -0.437555273305048  LUMO (Ag) = -0.106565393729152
cycle= 6 E= -75.3806494342396  delta_E= -7.97e-09  |g|= 2.47e-05  |ddm|= 0.000449
HOMO (B2u) = -0.437550531930243  LUMO (Ag) = -0.106557643143738
cycle= 7 E= -75.3806494346656  delta_E= -4.26e-10  |g|= 3.1e-06  |ddm|= 0.000106
HOMO (B3u) = -0.43755064258682  LUMO (Ag) = -0.106557057009377
cycle= 8 E= -75.3806494346709  delta_E= -5.23e-12  |g|= 3.13e-07  |ddm|= 2.83e-05
HOMO (B3u) = -0.437550627656561  LUMO (Ag) = -0.106556986157518
cycle= 9 E= -75.380649434671  delta_E= -1.28e-13  |g|= 1.55e-08  |ddm|= 1.79e-06
HOMO (B3u) = -0.437550624651403  LUMO (Ag) = -0.106556982907061
cycle= 10 E= -75.3806494346711  delta_E= -7.11e-14  |g|= 1.93e-09  |ddm|= 3.86e-08
HOMO (B3u) = -0.43755062478024  LUMO (Ag) = -0.106556982982817
cycle= 11 E= -75.3806494346711  delta_E= -2.84e-14  |g|= 1.07e-09  |ddm|= 2.21e-09
HOMO (B3u) = -0.437550625017927  LUMO (Ag) = -0.106556983191541
cycle= 12 E= -75.380649434671  delta_E= 8.53e-14  |g|= 9.86e-10  |ddm|= 1.7e-09
HOMO (B3u) = -0.437550624986431  LUMO (Ag) = -0.106556983144874
cycle= 13 E= -75.380649434671  delta_E= 1.42e-14  |g|= 7.72e-10  |ddm|= 7.36e-10
HOMO (B2u) = -0.437550624987066  LUMO (Ag) = -0.106556983115223
cycle= 14 E= -75.3806494346709  delta_E= 4.26e-14  |g|= 6.86e-10  |ddm|= 1.14e-09
HOMO (B3u) = -0.437550624979832  LUMO (Ag) = -0.106556983104237
cycle= 15 E= -75.380649434671  delta_E= -2.84e-14  |g|= 5.97e-10  |ddm|= 5.74e-10
HOMO (B2u) = -0.4375506249722  LUMO (Ag) = -0.106556983130709
cycle= 16 E= -75.380649434671  delta_E=    0  |g|= 5.63e-10  |ddm|= 8.69e-10
HOMO (B3u) = -0.437550624903745  LUMO (Ag) = -0.106556983105386
cycle= 17 E= -75.380649434671  delta_E= -5.68e-14  |g|= 6.09e-10  |ddm|= 7.77e-10
HOMO (B2u) = -0.437550624889816  LUMO (Ag) = -0.106556983016552
cycle= 18 E= -75.3806494346711  delta_E= -5.68e-14  |g|= 2.01e-10  |ddm|= 9.04e-10
HOMO (B2u) = -0.437550624887783  LUMO (Ag) = -0.106556983009412
cycle= 19 E= -75.380649434671  delta_E= 8.53e-14  |g|= 1.59e-10  |ddm|= 1.05e-10
HOMO (B3u) = -0.437550624886698  LUMO (Ag) = -0.106556983005798
cycle= 20 E= -75.380649434671  delta_E= 2.84e-14  |g|= 1.38e-10  |ddm|= 5.43e-11
HOMO (B2u) = -0.437550624892011  LUMO (Ag) = -0.106556983007984
cycle= 21 E= -75.380649434671  delta_E=    0  |g|= 1.15e-10  |ddm|= 7.55e-11
HOMO (B3u) = -0.437550624896088  LUMO (Ag) = -0.10655698300968
cycle= 22 E= -75.3806494346711  delta_E= -1.14e-13  |g|= 9.78e-11  |ddm|= 6.22e-11
HOMO (B3u) = -0.437550624898343  LUMO (Ag) = -0.106556983011032
cycle= 23 E= -75.3806494346709  delta_E= 1.42e-13  |g|= 8.2e-11  |ddm|= 3.85e-11
HOMO (B3u) = -0.437550624900007  LUMO (Ag) = -0.106556983011847
cycle= 24 E= -75.3806494346709  delta_E=    0  |g|= 6.79e-11  |ddm|= 3.09e-11
HOMO (B3u) = -0.43755062490102  LUMO (Ag) = -0.106556983005108
Extra cycle  E= -75.3806494346709  delta_E=    0  |g|= 2.2e-11  |ddm|= 8.42e-11
converged SCF energy = -75.3806494346709

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmppshbm4vo
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5520156742905  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5749557691936  dE = -0.022940095  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5893075599877  dE = -0.014351791  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0633  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5977719040463  dE = -0.0084643441  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0299  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6039893910598  dE = -0.006217487  S^2 = 0.0000000
               |grad[o]|=0.071  |ddm|=0.0135  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6089055501003  dE = -0.004916159  S^2 = 0.0000000
               |grad[o]|=0.0571  |ddm|=0.00833  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6128209543737  dE = -0.0039154043  S^2 = 0.0000000
               |grad[o]|=0.0454  |ddm|=0.00602  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6158466050362  dE = -0.0030256507  S^2 = 0.0000000
               |grad[o]|=0.0352  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6180396311143  dE = -0.0021930261  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194395133805  dE = -0.0013998823  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00412  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6200886537404  dE = -0.00064914036  S^2 = 0.0000000
               |grad[o]|=0.00981  |ddm|=0.00428  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201507320497  dE = -6.2078309e-05  S^2 = 0.0000000
               |grad[o]|=0.00282  |ddm|=0.00468  |maxRot[o]|=0.0311
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201515477165  dE = -8.1566678e-07  S^2 = 0.0000000
               |grad[o]|=0.000473  |ddm|=0.00207  |maxRot[o]|=0.00307
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201515643291  dE = -1.661256e-08  S^2 = 0.0000000
               |grad[o]|=7.49e-05  |ddm|=0.000374  |maxRot[o]|=0.000396
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6201515647232  dE = -3.9413806e-10  S^2 = 0.0000000
               |grad[o]|=1.22e-05  |ddm|=7.4e-05  |maxRot[o]|=6.42e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.620151564741  dE = -1.7763568e-11  S^2 = 0.0000000
               |grad[o]|=2.58e-06  |ddm|=1.82e-05  |maxRot[o]|=1.12e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98175021 1.63550776 1.8711556  1.87115624 0.3611846  0.13173008
 0.1317302  0.01578531]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00465   0.00301   0.00000   0.00000  -0.00114
  0 C 2s       0.60227   0.53958  -0.00000  -0.00000  -0.36778
  0 C 3s      -0.04374   0.00880  -0.00000  -0.00000  -0.00363
  0 C 2px      0.00000  -0.00000  -0.00000   0.70650  -0.00000
  0 C 2py      0.00000   0.00000   0.70650  -0.00000   0.00000
  0 C 2pz      0.36367  -0.45689  -0.00000  -0.00000   0.60227
  0 C 3px      0.00000  -0.00000   0.00000  -0.00009   0.00000
  0 C 3py     -0.00000   0.00000  -0.00009  -0.00000   0.00000
  0 C 3pz     -0.04268  -0.00383  -0.00000  -0.00000  -0.04233
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.02932  -0.00000   0.00000
  0 C 3dz^2    0.03544   0.00032  -0.00000  -0.00000   0.01448
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02932   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00465  -0.00301   0.00000   0.00000  -0.00114
  1 C 2s       0.60227  -0.53958   0.00000   0.00000  -0.36778
  1 C 3s      -0.04374  -0.00880   0.00000   0.00000  -0.00363
  1 C 2px     -0.00000   0.00000  -0.00000   0.70650  -0.00000
  1 C 2py      0.00000  -0.00000   0.70650   0.00000  -0.00000
  1 C 2pz     -0.36367  -0.45689  -0.00000   0.00000  -0.60227
  1 C 3px     -0.00000   0.00000   0.00000  -0.00009   0.00000
  1 C 3py     -0.00000  -0.00000  -0.00009   0.00000  -0.00000
  1 C 3pz      0.04268  -0.00383  -0.00000  -0.00000   0.04233
  1 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000  -0.02932  -0.00000   0.00000
  1 C 3dz^2    0.03544  -0.00032   0.00000   0.00000   0.01448
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02932  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s      -0.00000  -0.00000   0.45623
  0 C 3s      -0.00000  -0.00000  -0.04293
  0 C 2px      0.70638   0.00000  -0.00000
  0 C 2py      0.00000   0.70638  -0.00000
  0 C 2pz      0.00000  -0.00000   0.53783
  0 C 3px     -0.02172   0.00000  -0.00000
  0 C 3py      0.00000  -0.02172  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01389
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02345  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02369
  0 C 3dxz    -0.02345   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s       0.00000   0.00000  -0.45623
  1 C 3s       0.00000   0.00000   0.04293
  1 C 2px     -0.70638  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70638   0.00000
  1 C 2pz      0.00000  -0.00000   0.53783
  1 C 3px      0.02172  -0.00000   0.00000
  1 C 3py     -0.00000   0.02172   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01389
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02345  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02369
  1 C 3dxz    -0.02345   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99374273
<CAS-nat-orb|mo-hf>  4  4    0.99831642
<CAS-nat-orb|mo-hf>  5  5    0.99972153
<CAS-nat-orb|mo-hf>  6  6    0.99972153
<CAS-nat-orb|mo-hf>  7  7    0.97735853
<CAS-nat-orb|mo-hf>  8  8    0.94866393
<CAS-nat-orb|mo-hf>  9  9    0.94866398
<CAS-nat-orb|mo-hf>  10  10    0.53130849
<CAS-nat-orb|mo-hf>  10  17    0.68518248
<CAS-nat-orb|mo-hf>  10  18   -0.46282807
CASSCF energy = -75.620151564741
CASCI E = -75.620151564741  E(CI) = -17.3010863052875  S^2 = 0.0000000
Time cost =    226.626
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:37:46 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.349401887846 AA    0.000000000000   0.000000000000   2.550000000000 Bohr   0.0

nuclear repulsion = 14.1176470588235
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.275]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7538.63


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpsf34vruf
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.322852658808

WARN: Singularity detected in overlap matrix (condition number =  444). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.224183141291852  LUMO (Ag) = -0.175375833613539
cycle= 1 E= -75.3580302281757  delta_E= -0.0352  |g|= 0.215  |ddm|= 1.46
HOMO (B3u) = -0.467759172708487  LUMO (Ag) = -0.14945475379878
cycle= 2 E= -75.3746497165005  delta_E= -0.0166  |g|= 0.0521  |ddm|= 0.26
HOMO (B3u) = -0.430516793980391  LUMO (Ag) = -0.107753824209474
cycle= 3 E= -75.3755305907904  delta_E= -0.000881  |g|= 0.00966  |ddm|= 0.0568
HOMO (B3u) = -0.431561534231314  LUMO (Ag) = -0.105750596270451
cycle= 4 E= -75.3755868789759  delta_E= -5.63e-05  |g|= 0.00191  |ddm|= 0.0225
HOMO (B2u) = -0.432324246357026  LUMO (Ag) = -0.106325540767305
cycle= 5 E= -75.3755892675815  delta_E= -2.39e-06  |g|= 0.000174  |ddm|= 0.00743
HOMO (B3u) = -0.432284401985624  LUMO (Ag) = -0.106263967776659
cycle= 6 E= -75.3755892854561  delta_E= -1.79e-08  |g|= 3.01e-05  |ddm|= 0.000369
HOMO (B2u) = -0.432278729183658  LUMO (Ag) = -0.106254488809739
cycle= 7 E= -75.3755892860987  delta_E= -6.43e-10  |g|= 3.64e-06  |ddm|= 0.000169
HOMO (B3u) = -0.432278901425315  LUMO (Ag) = -0.106253945307327
cycle= 8 E= -75.3755892861055  delta_E= -6.82e-12  |g|= 3.45e-07  |ddm|= 2.86e-05
HOMO (B2u) = -0.432278883343966  LUMO (Ag) = -0.10625387117171
cycle= 9 E= -75.3755892861055  delta_E= 4.26e-14  |g|= 1.65e-08  |ddm|= 2.14e-06
HOMO (B2u) = -0.432278879789835  LUMO (Ag) = -0.10625386864663
cycle= 10 E= -75.3755892861055  delta_E= -1.42e-14  |g|= 2.15e-09  |ddm|= 4.37e-08
HOMO (B3u) = -0.43227887985706  LUMO (Ag) = -0.106253868618828
cycle= 11 E= -75.3755892861056  delta_E= -9.95e-14  |g|= 1.22e-09  |ddm|= 2.26e-09
HOMO (B3u) = -0.432278880151768  LUMO (Ag) = -0.106253868891095
cycle= 12 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 1.11e-09  |ddm|= 9.93e-10
HOMO (B3u) = -0.432278880107165  LUMO (Ag) = -0.106253868836526
cycle= 13 E= -75.3755892861056  delta_E= -7.11e-14  |g|= 8.7e-10  |ddm|= 8.08e-10
HOMO (B2u) = -0.432278880095434  LUMO (Ag) = -0.10625386879402
cycle= 14 E= -75.3755892861056  delta_E= -1.42e-14  |g|= 7.5e-10  |ddm|= 1e-09
HOMO (B3u) = -0.432278880081998  LUMO (Ag) = -0.106253868781011
cycle= 15 E= -75.3755892861055  delta_E= 7.11e-14  |g|= 6.68e-10  |ddm|= 7.64e-10
HOMO (B3u) = -0.432278880080252  LUMO (Ag) = -0.106253868818908
cycle= 16 E= -75.3755892861055  delta_E= -1.42e-14  |g|= 6.31e-10  |ddm|= 1.11e-09
HOMO (B3u) = -0.432278880013137  LUMO (Ag) = -0.106253868781029
cycle= 17 E= -75.3755892861056  delta_E= -4.26e-14  |g|= 6.62e-10  |ddm|= 7.48e-10
HOMO (B3u) = -0.432278879979176  LUMO (Ag) = -0.106253868676178
cycle= 18 E= -75.3755892861055  delta_E= 2.84e-14  |g|= 2.29e-10  |ddm|= 1.04e-09
HOMO (B3u) = -0.432278879978717  LUMO (Ag) = -0.106253868669528
cycle= 19 E= -75.3755892861056  delta_E= -8.53e-14  |g|= 1.8e-10  |ddm|= 1.32e-10
HOMO (B3u) = -0.432278879978508  LUMO (Ag) = -0.106253868666405
cycle= 20 E= -75.3755892861056  delta_E= 5.68e-14  |g|= 1.56e-10  |ddm|= 8.28e-11
HOMO (B3u) = -0.432278879985156  LUMO (Ag) = -0.106253868669711
cycle= 21 E= -75.3755892861055  delta_E= 4.26e-14  |g|= 1.29e-10  |ddm|= 8.78e-11
HOMO (B2u) = -0.432278879990318  LUMO (Ag) = -0.106253868672178
cycle= 22 E= -75.3755892861055  delta_E= 1.42e-14  |g|= 1.09e-10  |ddm|= 7.4e-11
HOMO (B2u) = -0.432278879993521  LUMO (Ag) = -0.106253868674264
cycle= 23 E= -75.3755892861055  delta_E= -1.42e-14  |g|= 9.22e-11  |ddm|= 5.23e-11
HOMO (B2u) = -0.432278879995721  LUMO (Ag) = -0.106253868675191
cycle= 24 E= -75.3755892861055  delta_E=    0  |g|= 7.61e-11  |ddm|= 3.88e-11
HOMO (B3u) = -0.432278879997382  LUMO (Ag) = -0.106253868668138
Extra cycle  E= -75.3755892861055  delta_E= 4.26e-14  |g|= 2.47e-11  |ddm|= 9.4e-11
converged SCF energy = -75.3755892861055

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpsf34vruf
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5487757489226  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5722752947469  dE = -0.023499546  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5857503411532  dE = -0.013475046  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0659  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5940452830232  dE = -0.0082949419  S^2 = 0.0000000
               |grad[o]|=0.0897  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.600204946914  dE = -0.0061596639  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0141  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6050819970447  dE = -0.0048770501  S^2 = 0.0000000
               |grad[o]|=0.0582  |ddm|=0.00893  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6089574825413  dE = -0.0038754855  S^2 = 0.0000000
               |grad[o]|=0.0463  |ddm|=0.00649  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6119399769005  dE = -0.0029824944  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00515  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6140852962078  dE = -0.0021453193  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00446  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6154329698254  dE = -0.0013476736  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6160256616855  dE = -0.00059269186  S^2 = 0.0000000
               |grad[o]|=0.00954  |ddm|=0.00447  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6160629697539  dE = -3.7308068e-05  S^2 = 0.0000000
               |grad[o]|=0.00234  |ddm|=0.00498  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6160660554682  dE = -3.0857143e-06  S^2 = 0.0000000
               |grad[o]|=0.000716  |ddm|=0.00145  |maxRot[o]|=0.00665
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6160661048717  dE = -4.9403567e-08  S^2 = 0.0000000
               |grad[o]|=0.000124  |ddm|=0.000551  |maxRot[o]|=0.000718
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6160661059023  dE = -1.0305854e-09  S^2 = 0.0000000
               |grad[o]|=1.96e-05  |ddm|=9.67e-05  |maxRot[o]|=9.86e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6160661059281  dE = -2.5806912e-11  S^2 = 0.0000000
               |grad[o]|=3.01e-06  |ddm|=1.91e-05  |maxRot[o]|=1.56e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98089624 1.64657015 1.86373182 1.86373136 0.35078076 0.13883165
 0.1388318  0.01662623]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00498   0.00310   0.00000   0.00000  -0.00109
  0 C 2s       0.60537   0.54713  -0.00000   0.00000  -0.36277
  0 C 3s      -0.04187   0.00880  -0.00000  -0.00000  -0.00080
  0 C 2px      0.00000  -0.00000   0.00000   0.70653  -0.00000
  0 C 2py      0.00000  -0.00000   0.70653  -0.00000   0.00000
  0 C 2pz      0.35902  -0.44783   0.00000   0.00000   0.60525
  0 C 3px     -0.00000   0.00000   0.00000   0.00282   0.00000
  0 C 3py     -0.00000   0.00000   0.00282   0.00000   0.00000
  0 C 3pz     -0.04100  -0.00346  -0.00000  -0.00000  -0.04273
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.02846  -0.00000   0.00000
  0 C 3dz^2    0.03432  -0.00016  -0.00000  -0.00000   0.01561
  0 C 3dxz    -0.00000   0.00000   0.00000   0.02846   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00498  -0.00310   0.00000   0.00000  -0.00109
  1 C 2s       0.60537  -0.54713   0.00000   0.00000  -0.36277
  1 C 3s      -0.04187  -0.00880   0.00000   0.00000  -0.00080
  1 C 2px      0.00000  -0.00000  -0.00000   0.70653  -0.00000
  1 C 2py      0.00000  -0.00000   0.70653  -0.00000  -0.00000
  1 C 2pz     -0.35902  -0.44783   0.00000   0.00000  -0.60525
  1 C 3px     -0.00000   0.00000  -0.00000   0.00282   0.00000
  1 C 3py     -0.00000   0.00000   0.00282   0.00000  -0.00000
  1 C 3pz      0.04100  -0.00346  -0.00000  -0.00000   0.04273
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02846  -0.00000   0.00000
  1 C 3dz^2    0.03432   0.00016   0.00000  -0.00000   0.01561
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.02846  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s       0.00000  -0.00000   0.44717
  0 C 3s       0.00000   0.00000  -0.04302
  0 C 2px      0.70642  -0.00000   0.00000
  0 C 2py      0.00000   0.70642   0.00000
  0 C 2pz      0.00000   0.00000   0.54537
  0 C 3px     -0.02076  -0.00000   0.00000
  0 C 3py     -0.00000  -0.02076   0.00000
  0 C 3pz      0.00000   0.00000   0.01534
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02331   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02287
  0 C 3dxz    -0.02331  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000  -0.00000  -0.44717
  1 C 3s      -0.00000  -0.00000   0.04302
  1 C 2px     -0.70642   0.00000  -0.00000
  1 C 2py      0.00000  -0.70642   0.00000
  1 C 2pz      0.00000  -0.00000   0.54537
  1 C 3px      0.02076   0.00000  -0.00000
  1 C 3py     -0.00000   0.02076  -0.00000
  1 C 3pz      0.00000  -0.00000   0.01534
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02331   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02287
  1 C 3dxz    -0.02331  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99344302
<CAS-nat-orb|mo-hf>  4  4    0.99822555
<CAS-nat-orb|mo-hf>  5  5    0.99969500
<CAS-nat-orb|mo-hf>  6  6    0.99969500
<CAS-nat-orb|mo-hf>  7  7    0.97683028
<CAS-nat-orb|mo-hf>  8  8    0.95239327
<CAS-nat-orb|mo-hf>  9  9    0.95239324
<CAS-nat-orb|mo-hf>  10  10    0.55278427
<CAS-nat-orb|mo-hf>  10  17    0.68990826
<CAS-nat-orb|mo-hf>  10  18   -0.43567179
CASSCF energy = -75.6160661059281
CASCI E = -75.6160661059281  E(CI) = -17.1715111507649  S^2 = 0.0000000
Time cost =    395.297
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:44:22 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.375860748392 AA    0.000000000000   0.000000000000   2.600000000000 Bohr   0.0

nuclear repulsion = 13.8461538461538
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.3]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      8082.76


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpnhezmhq7
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.278195813693

WARN: Singularity detected in overlap matrix (condition number =  409). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.215477115824915  LUMO (Ag) = -0.172896295276615
cycle= 1 E= -75.3511756370242  delta_E= -0.073  |g|= 0.218  |ddm|= 1.45
HOMO (B3u) = -0.462888168119374  LUMO (Ag) = -0.150366392380424
cycle= 2 E= -75.3684890547636  delta_E= -0.0173  |g|= 0.0521  |ddm|= 0.268
HOMO (B3u) = -0.425477509345154  LUMO (Ag) = -0.10764731951226
cycle= 3 E= -75.369391499486  delta_E= -0.000902  |g|= 0.00999  |ddm|= 0.056
HOMO (B3u) = -0.426482502338425  LUMO (Ag) = -0.105320428216433
cycle= 4 E= -75.3694522894418  delta_E= -6.08e-05  |g|= 0.002  |ddm|= 0.0206
HOMO (B3u) = -0.427253849930311  LUMO (Ag) = -0.105864709294582
cycle= 5 E= -75.3694549331516  delta_E= -2.64e-06  |g|= 0.000217  |ddm|= 0.00651
HOMO (B2u) = -0.427202128961971  LUMO (Ag) = -0.105788865113736
cycle= 6 E= -75.3694549621127  delta_E= -2.9e-08  |g|= 3.29e-05  |ddm|= 0.000392
HOMO (B3u) = -0.427195922281584  LUMO (Ag) = -0.105778621503333
cycle= 7 E= -75.3694549628766  delta_E= -7.64e-10  |g|= 4.04e-06  |ddm|= 0.000193
HOMO (B2u) = -0.427196084833623  LUMO (Ag) = -0.105778048731894
cycle= 8 E= -75.3694549628848  delta_E= -8.19e-12  |g|= 3.71e-07  |ddm|= 2.79e-05
HOMO (B2u) = -0.427196062616153  LUMO (Ag) = -0.10577796601358
cycle= 9 E= -75.3694549628848  delta_E= -5.68e-14  |g|= 1.75e-08  |ddm|= 2.3e-06
HOMO (B2u) = -0.427196058477427  LUMO (Ag) = -0.105777964390645
cycle= 10 E= -75.3694549628848  delta_E= 1.42e-14  |g|= 2.34e-09  |ddm|= 4.88e-08
HOMO (B3u) = -0.427196058562089  LUMO (Ag) = -0.105777964346711
cycle= 11 E= -75.3694549628849  delta_E= -4.26e-14  |g|= 1.41e-09  |ddm|= 1.97e-09
HOMO (B3u) = -0.427196058860191  LUMO (Ag) = -0.105777964639553
cycle= 12 E= -75.3694549628848  delta_E= 4.26e-14  |g|= 1.25e-09  |ddm|= 5.62e-10
HOMO (B3u) = -0.427196058812224  LUMO (Ag) = -0.105777964579179
cycle= 13 E= -75.3694549628848  delta_E= 4.26e-14  |g|= 9.72e-10  |ddm|= 1.1e-09
HOMO (B3u) = -0.427196058793961  LUMO (Ag) = -0.105777964532471
cycle= 14 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 8.2e-10  |ddm|= 1.01e-09
HOMO (B3u) = -0.427196058773615  LUMO (Ag) = -0.105777964512761
cycle= 15 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 7.32e-10  |ddm|= 7.7e-10
HOMO (B2u) = -0.427196058779532  LUMO (Ag) = -0.105777964557919
cycle= 16 E= -75.3694549628848  delta_E=    0  |g|= 6.84e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.427196058708052  LUMO (Ag) = -0.105777964510331
cycle= 17 E= -75.3694549628848  delta_E= 5.68e-14  |g|= 7.13e-10  |ddm|= 7.06e-10
HOMO (B3u) = -0.427196058653779  LUMO (Ag) = -0.105777964390354
cycle= 18 E= -75.3694549628848  delta_E=    0  |g|= 2.57e-10  |ddm|= 1.18e-09
HOMO (B2u) = -0.427196058654354  LUMO (Ag) = -0.105777964384073
cycle= 19 E= -75.3694549628848  delta_E=    0  |g|= 2.04e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.427196058656243  LUMO (Ag) = -0.105777964382459
cycle= 20 E= -75.3694549628847  delta_E= 4.26e-14  |g|= 1.73e-10  |ddm|= 1.17e-10
HOMO (B2u) = -0.427196058664108  LUMO (Ag) = -0.105777964386702
cycle= 21 E= -75.3694549628848  delta_E= -9.95e-14  |g|= 1.43e-10  |ddm|= 1.05e-10
HOMO (B3u) = -0.427196058670192  LUMO (Ag) = -0.1057779643899
cycle= 22 E= -75.3694549628847  delta_E= 1.14e-13  |g|= 1.2e-10  |ddm|= 8.45e-11
HOMO (B3u) = -0.427196058674313  LUMO (Ag) = -0.105777964392635
cycle= 23 E= -75.3694549628848  delta_E= -9.95e-14  |g|= 1.01e-10  |ddm|= 6.33e-11
HOMO (B3u) = -0.427196058677154  LUMO (Ag) = -0.105777964393977
cycle= 24 E= -75.3694549628848  delta_E= 1.42e-14  |g|= 8.29e-11  |ddm|= 4.77e-11
HOMO (B3u) = -0.427196058680089  LUMO (Ag) = -0.105777964393601
cycle= 25 E= -75.3694549628848  delta_E=    0  |g|= 6.33e-11  |ddm|= 3.74e-11
HOMO (B3u) = -0.427196058678615  LUMO (Ag) = -0.1057779643852
Extra cycle  E= -75.3694549628849  delta_E= -7.11e-14  |g|= 2.06e-11  |ddm|= 7.89e-11
converged SCF energy = -75.3694549628849

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpnhezmhq7
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5444984241914  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5681594686607  dE = -0.023661044  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0785
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5810819888407  dE = -0.01292252  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0676  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5892771745199  dE = -0.0081951857  S^2 = 0.0000000
               |grad[o]|=0.0906  |ddm|=0.0288  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5954033818031  dE = -0.0061262073  S^2 = 0.0000000
               |grad[o]|=0.0731  |ddm|=0.0147  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.600247513424  dE = -0.0048441316  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00955  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6040772524966  dE = -0.0038297391  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.00694  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6070010066259  dE = -0.0029237541  S^2 = 0.0000000
               |grad[o]|=0.0361  |ddm|=0.00545  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6090752023635  dE = -0.0020741957  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00465  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6103412344161  dE = -0.0012660321  S^2 = 0.0000000
               |grad[o]|=0.0172  |ddm|=0.00445  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6107871865149  dE = -0.0004459521  S^2 = 0.0000000
               |grad[o]|=0.00888  |ddm|=0.00473  |maxRot[o]|= 0.06
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6108585913579  dE = -7.1404843e-05  S^2 = 0.0000000
               |grad[o]|=0.00316  |ddm|=0.00398  |maxRot[o]|=0.0329
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6108594686037  dE = -8.772458e-07  S^2 = 0.0000000
               |grad[o]|=0.0005  |ddm|=0.00241  |maxRot[o]|=0.00309
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6108594862081  dE = -1.7604364e-08  S^2 = 0.0000000
               |grad[o]|=7.67e-05  |ddm|=0.000366  |maxRot[o]|=0.000384
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6108594866081  dE = -3.9996451e-10  S^2 = 0.0000000
               |grad[o]|=1.26e-05  |ddm|=6.64e-05  |maxRot[o]|=6.02e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.6108594866192  dE = -1.1098678e-11  S^2 = 0.0000000
               |grad[o]|=2.08e-06  |ddm|=1.32e-05  |maxRot[o]|=1.01e-05
2-step CASSCF converged in 15 macro (74 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98003344 1.65708287 1.85598555 1.85598498 0.341134   0.14614893
 0.14614874 0.01748149]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00530   0.00319   0.00000   0.00000  -0.00104
  0 C 2s       0.60847   0.55448  -0.00000  -0.00000  -0.35767
  0 C 3s      -0.03996   0.00882  -0.00000  -0.00000   0.00198
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655  -0.00000
  0 C 2py     -0.00000   0.00000   0.70655  -0.00000   0.00000
  0 C 2pz      0.35425  -0.43870  -0.00000  -0.00000   0.60822
  0 C 3px     -0.00000  -0.00000   0.00000   0.00558  -0.00000
  0 C 3py     -0.00000   0.00000   0.00558   0.00000   0.00000
  0 C 3pz     -0.03931  -0.00314  -0.00000  -0.00000  -0.04299
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02761   0.00000   0.00000
  0 C 3dz^2    0.03326  -0.00060  -0.00000  -0.00000   0.01688
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02761  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00530  -0.00319   0.00000   0.00000  -0.00104
  1 C 2s       0.60847  -0.55448   0.00000  -0.00000  -0.35767
  1 C 3s      -0.03996  -0.00882   0.00000   0.00000   0.00198
  1 C 2px     -0.00000   0.00000  -0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000  -0.00000
  1 C 2pz     -0.35425  -0.43870  -0.00000   0.00000  -0.60822
  1 C 3px      0.00000   0.00000   0.00000   0.00558   0.00000
  1 C 3py      0.00000  -0.00000   0.00558   0.00000  -0.00000
  1 C 3pz      0.03931  -0.00314  -0.00000  -0.00000   0.04299
  1 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02761  -0.00000   0.00000
  1 C 3dz^2    0.03326   0.00060   0.00000   0.00000   0.01688
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02761  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00051
  0 C 2s      -0.00000  -0.00000   0.43805
  0 C 3s      -0.00000  -0.00000  -0.04314
  0 C 2px      0.70645   0.00000   0.00000
  0 C 2py      0.00000   0.70645  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55270
  0 C 3px     -0.01985   0.00000   0.00000
  0 C 3py      0.00000  -0.01985  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01664
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02315  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02225
  0 C 3dxz    -0.02315   0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00051
  1 C 2s      -0.00000   0.00000  -0.43805
  1 C 3s       0.00000   0.00000   0.04314
  1 C 2px     -0.70645  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70645   0.00000
  1 C 2pz      0.00000  -0.00000   0.55270
  1 C 3px      0.01985  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01985   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01664
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02315  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02225
  1 C 3dxz    -0.02315   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99314132
<CAS-nat-orb|mo-hf>  4  4    0.99812795
<CAS-nat-orb|mo-hf>  5  5    0.99966602
<CAS-nat-orb|mo-hf>  6  6    0.99966602
<CAS-nat-orb|mo-hf>  7  7    0.97631889
<CAS-nat-orb|mo-hf>  8  8    0.95579308
<CAS-nat-orb|mo-hf>  9  9    0.95579302
<CAS-nat-orb|mo-hf>  10  10    0.57545984
<CAS-nat-orb|mo-hf>  10  17    0.69042018
<CAS-nat-orb|mo-hf>  10  18   -0.40995044
CASSCF energy = -75.6108594866192
CASCI E = -75.6108594866192  E(CI) = -17.0456439489893  S^2 = 0.0000000
Time cost =    241.428
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:48:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.402319608938 AA    0.000000000000   0.000000000000   2.650000000000 Bohr   0.0

nuclear repulsion = 13.5849056603774
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.325]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      8574.71


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpczp65prf
max_memory 4000 MB (current use 174 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.2354639903452

WARN: Singularity detected in overlap matrix (condition number =  377). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.207229697178327  LUMO (Ag) = -0.170529385107338
cycle= 1 E= -75.3434515147688  delta_E= -0.108  |g|= 0.222  |ddm|= 1.45
HOMO (B3u) = -0.458125308046684  LUMO (Ag) = -0.15100828823549
cycle= 2 E= -75.3614525114844  delta_E= -0.018  |g|= 0.052  |ddm|= 0.276
HOMO (B3u) = -0.420576044882482  LUMO (Ag) = -0.107310756967326
cycle= 3 E= -75.3623762459038  delta_E= -0.000924  |g|= 0.0104  |ddm|= 0.0554
HOMO (B2u) = -0.421573778613678  LUMO (Ag) = -0.104704594692271
cycle= 4 E= -75.3624425687672  delta_E= -6.63e-05  |g|= 0.00208  |ddm|= 0.019
HOMO (B2u) = -0.422353066342065  LUMO (Ag) = -0.105232949169251
cycle= 5 E= -75.3624454885392  delta_E= -2.92e-06  |g|= 0.000251  |ddm|= 0.00568
HOMO (B3u) = -0.422292447876755  LUMO (Ag) = -0.105149049472672
cycle= 6 E= -75.3624455277623  delta_E= -3.92e-08  |g|= 3.5e-05  |ddm|= 0.000464
HOMO (B3u) = -0.422285778696184  LUMO (Ag) = -0.105138173661532
cycle= 7 E= -75.3624455286169  delta_E= -8.55e-10  |g|= 4.37e-06  |ddm|= 0.0002
HOMO (B2u) = -0.422285894464508  LUMO (Ag) = -0.105137535804999
cycle= 8 E= -75.3624455286267  delta_E= -9.76e-12  |g|= 3.96e-07  |ddm|= 2.7e-05
HOMO (B2u) = -0.422285868761349  LUMO (Ag) = -0.105137442523297
cycle= 9 E= -75.3624455286266  delta_E= 7.11e-14  |g|= 1.83e-08  |ddm|= 2.34e-06
HOMO (B3u) = -0.422285864047109  LUMO (Ag) = -0.105137442034636
cycle= 10 E= -75.3624455286268  delta_E= -1.14e-13  |g|= 2.5e-09  |ddm|= 5.4e-08
HOMO (B3u) = -0.422285864208527  LUMO (Ag) = -0.105137442035494
cycle= 11 E= -75.3624455286268  delta_E= -2.84e-14  |g|= 1.63e-09  |ddm|= 2.05e-09
HOMO (B3u) = -0.422285864471723  LUMO (Ag) = -0.105137442316613
cycle= 12 E= -75.3624455286267  delta_E= 4.26e-14  |g|= 1.38e-09  |ddm|= 8.32e-10
HOMO (B2u) = -0.422285864412725  LUMO (Ag) = -0.105137442239536
cycle= 13 E= -75.3624455286268  delta_E= -7.11e-14  |g|= 1.08e-09  |ddm|= 1.18e-09
HOMO (B2u) = -0.422285864387665  LUMO (Ag) = -0.105137442189747
cycle= 14 E= -75.3624455286267  delta_E= 8.53e-14  |g|= 9.02e-10  |ddm|= 9.99e-10
HOMO (B3u) = -0.422285864372426  LUMO (Ag) = -0.105137442174055
cycle= 15 E= -75.3624455286268  delta_E= -4.26e-14  |g|= 7.9e-10  |ddm|= 8.85e-10
HOMO (B3u) = -0.422285864381245  LUMO (Ag) = -0.105137442221668
cycle= 16 E= -75.3624455286267  delta_E= 7.11e-14  |g|= 7.32e-10  |ddm|= 1.35e-09
HOMO (B2u) = -0.422285864307752  LUMO (Ag) = -0.105137442168066
cycle= 17 E= -75.3624455286268  delta_E= -7.11e-14  |g|= 7.58e-10  |ddm|= 6.02e-10
HOMO (B2u) = -0.422285864233274  LUMO (Ag) = -0.105137442035322
cycle= 18 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 2.85e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.422285864234515  LUMO (Ag) = -0.105137442029283
cycle= 19 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 2.28e-10  |ddm|= 1.9e-10
HOMO (B2u) = -0.422285864239093  LUMO (Ag) = -0.105137442029672
cycle= 20 E= -75.3624455286268  delta_E= 4.26e-14  |g|= 1.9e-10  |ddm|= 1.38e-10
HOMO (B3u) = -0.422285864248055  LUMO (Ag) = -0.105137442034751
cycle= 21 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 1.55e-10  |ddm|= 1.19e-10
HOMO (B2u) = -0.422285864254686  LUMO (Ag) = -0.105137442038545
cycle= 22 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 1.29e-10  |ddm|= 9.57e-11
HOMO (B2u) = -0.422285864259383  LUMO (Ag) = -0.105137442041758
cycle= 23 E= -75.3624455286267  delta_E= 5.68e-14  |g|= 1.08e-10  |ddm|= 7.55e-11
HOMO (B2u) = -0.422285864262907  LUMO (Ag) = -0.105137442043748
cycle= 24 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 8.88e-11  |ddm|= 5.69e-11
HOMO (B3u) = -0.422285864266459  LUMO (Ag) = -0.105137442044012
cycle= 25 E= -75.3624455286268  delta_E= 2.84e-14  |g|= 6.82e-11  |ddm|= 3.99e-11
HOMO (B3u) = -0.42228586426841  LUMO (Ag) = -0.105137442042106
cycle= 26 E= -75.3624455286268  delta_E= -2.84e-14  |g|= 4.57e-11  |ddm|= 4.5e-11
HOMO (B2u) = -0.422285864267618  LUMO (Ag) = -0.105137442040175
cycle= 27 E= -75.3624455286268  delta_E=    0  |g|= 3.77e-11  |ddm|= 1.56e-11
HOMO (B3u) = -0.422285864264528  LUMO (Ag) = -0.105137442033378
Extra cycle  E= -75.3624455286267  delta_E= 5.68e-14  |g|= 1.26e-11  |ddm|= 4.54e-11
converged SCF energy = -75.3624455286267

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpczp65prf
max_memory 4000 MB (current use 176 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5393906023641  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5630104601594  dE = -0.023619858  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0764
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5755661726229  dE = -0.012555712  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0687  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5837036694586  dE = -0.0081374968  S^2 = 0.0000000
               |grad[o]|=0.0914  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5898080852827  dE = -0.0061044158  S^2 = 0.0000000
               |grad[o]|=0.0739  |ddm|=0.0154  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5946166481761  dE = -0.0048085629  S^2 = 0.0000000
               |grad[o]|=0.0596  |ddm|=0.0101  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5983876151654  dE = -0.003770967  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00736  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6012309234086  dE = -0.0028433082  S^2 = 0.0000000
               |grad[o]|=0.036  |ddm|=0.00571  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6032054515099  dE = -0.0019745281  S^2 = 0.0000000
               |grad[o]|=0.0259  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.604356132751  dE = -0.0011506812  S^2 = 0.0000000
               |grad[o]|=0.0165  |ddm|=0.00467  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6047080782069  dE = -0.00035194546  S^2 = 0.0000000
               |grad[o]|=0.00777  |ddm|=0.00509  |maxRot[o]|= 0.06
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6047337091184  dE = -2.5630912e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00437  |maxRot[o]|=0.0194
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6047340656797  dE = -3.5656124e-07  S^2 = 0.0000000
               |grad[o]|=0.000329  |ddm|=0.0016  |maxRot[o]|=0.00185
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6047340727529  dE = -7.0732398e-09  S^2 = 0.0000000
               |grad[o]|=5.38e-05  |ddm|=0.000237  |maxRot[o]|=0.00024
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6047340729172  dE = -1.643059e-10  S^2 = 0.0000000
               |grad[o]|=7.44e-06  |ddm|=3.84e-05  |maxRot[o]|=3.68e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6047340729272  dE = -9.9475983e-12  S^2 = 0.0000000
               |grad[o]|=2.27e-06  |ddm|=1.32e-05  |maxRot[o]|=6.59e-06
2-step CASSCF converged in 15 macro (74 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97916617 1.66712587 1.84789575 1.84789479 0.33219718 0.15368596
 0.15368589 0.01834841]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00560   0.00327   0.00000   0.00000  -0.00099
  0 C 2s       0.61156   0.56162   0.00000  -0.00000  -0.35247
  0 C 3s      -0.03803   0.00886   0.00000  -0.00000   0.00469
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py     -0.00000   0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34937  -0.42951  -0.00000  -0.00000   0.61119
  0 C 3px     -0.00000   0.00000  -0.00000   0.00818   0.00000
  0 C 3py     -0.00000   0.00000   0.00818  -0.00000  -0.00000
  0 C 3pz     -0.03762  -0.00286   0.00000  -0.00000  -0.04310
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.02675  -0.00000  -0.00000
  0 C 3dz^2    0.03225  -0.00101   0.00000  -0.00000   0.01829
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02675   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00560  -0.00327   0.00000   0.00000  -0.00099
  1 C 2s       0.61156  -0.56162  -0.00000   0.00000  -0.35247
  1 C 3s      -0.03803  -0.00886  -0.00000   0.00000   0.00469
  1 C 2px      0.00000  -0.00000   0.00000   0.70655  -0.00000
  1 C 2py     -0.00000  -0.00000   0.70655   0.00000   0.00000
  1 C 2pz     -0.34937  -0.42951  -0.00000  -0.00000  -0.61119
  1 C 3px      0.00000   0.00000   0.00000   0.00818  -0.00000
  1 C 3py      0.00000  -0.00000   0.00818  -0.00000   0.00000
  1 C 3pz      0.03762  -0.00286   0.00000  -0.00000   0.04310
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02675  -0.00000  -0.00000
  1 C 3dz^2    0.03225   0.00101   0.00000   0.00000   0.01829
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02675   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00047
  0 C 2s      -0.00000   0.00000   0.42887
  0 C 3s       0.00000   0.00000  -0.04326
  0 C 2px      0.70648   0.00000  -0.00000
  0 C 2py     -0.00000   0.70648  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55983
  0 C 3px     -0.01896   0.00000   0.00000
  0 C 3py      0.00000  -0.01896  -0.00000
  0 C 3pz      0.00000   0.00000   0.01780
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02297  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02181
  0 C 3dxz    -0.02297   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00047
  1 C 2s      -0.00000  -0.00000  -0.42887
  1 C 3s      -0.00000  -0.00000   0.04326
  1 C 2px     -0.70648  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70648   0.00000
  1 C 2pz      0.00000  -0.00000   0.55983
  1 C 3px      0.01896  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01896   0.00000
  1 C 3pz     -0.00000   0.00000   0.01780
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02297  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02181
  1 C 3dxz    -0.02297   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99284124
<CAS-nat-orb|mo-hf>  4  4    0.99802529
<CAS-nat-orb|mo-hf>  5  5    0.99963455
<CAS-nat-orb|mo-hf>  6  6    0.99963455
<CAS-nat-orb|mo-hf>  7  7    0.97582852
<CAS-nat-orb|mo-hf>  8  8    0.95889494
<CAS-nat-orb|mo-hf>  9  9    0.95889489
<CAS-nat-orb|mo-hf>  10  10    0.59917818
<CAS-nat-orb|mo-hf>  10  17    0.68689328
CASSCF energy = -75.6047340729272
CASCI E = -75.6047340729272  E(CI) = -16.923413925886  S^2 = 0.0000000
Time cost =    266.493
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:52:49 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.428778469484 AA    0.000000000000   0.000000000000   2.700000000000 Bohr   0.0

nuclear repulsion = 13.3333333333333
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.35]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9178.09


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpfov72sxj
max_memory 4000 MB (current use 176 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1946578857085

WARN: Singularity detected in overlap matrix (condition number =  348). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.199413840928996  LUMO (Ag) = -0.168263344015825
cycle= 1 E= -75.3350369843806  delta_E= -0.14  |g|= 0.225  |ddm|= 1.44
HOMO (B3u) = -0.453464888109061  LUMO (Ag) = -0.151390240663929
cycle= 2 E= -75.3537139122307  delta_E= -0.0187  |g|= 0.0519  |ddm|= 0.284
HOMO (B2u) = -0.415801083744364  LUMO (Ag) = -0.106751931948699
cycle= 3 E= -75.3546580860938  delta_E= -0.000944  |g|= 0.0108  |ddm|= 0.0549
HOMO (B3u) = -0.416822160762627  LUMO (Ag) = -0.103915433790314
cycle= 4 E= -75.3547306562047  delta_E= -7.26e-05  |g|= 0.00215  |ddm|= 0.0177
HOMO (B2u) = -0.417607675822702  LUMO (Ag) = -0.104440258456576
cycle= 5 E= -75.3547338450163  delta_E= -3.19e-06  |g|= 0.000277  |ddm|= 0.00497
HOMO (B2u) = -0.41754102175863  LUMO (Ag) = -0.104353293703209
cycle= 6 E= -75.3547338927567  delta_E= -4.77e-08  |g|= 3.68e-05  |ddm|= 0.000534
HOMO (B3u) = -0.417533919980043  LUMO (Ag) = -0.104341804406663
cycle= 7 E= -75.3547338936913  delta_E= -9.35e-10  |g|= 4.65e-06  |ddm|= 0.000197
HOMO (B3u) = -0.417533963921608  LUMO (Ag) = -0.104341084871154
cycle= 8 E= -75.3547338937026  delta_E= -1.12e-11  |g|= 4.19e-07  |ddm|= 2.62e-05
HOMO (B3u) = -0.417533935669423  LUMO (Ag) = -0.104340979663944
cycle= 9 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 1.9e-08  |ddm|= 2.29e-06
HOMO (B3u) = -0.417533930414546  LUMO (Ag) = -0.104340980550984
cycle= 10 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 2.65e-09  |ddm|= 5.91e-08
HOMO (B3u) = -0.417533930825622  LUMO (Ag) = -0.104340980821099
cycle= 11 E= -75.3547338937027  delta_E= -1.14e-13  |g|= 2e-09  |ddm|= 1.54e-09
HOMO (B3u) = -0.417533930889197  LUMO (Ag) = -0.104340980881842
cycle= 12 E= -75.3547338937026  delta_E= 8.53e-14  |g|= 1.5e-09  |ddm|= 2.16e-09
HOMO (B3u) = -0.417533930829426  LUMO (Ag) = -0.104340980796228
cycle= 13 E= -75.3547338937026  delta_E=    0  |g|= 1.18e-09  |ddm|= 1.33e-09
HOMO (B3u) = -0.417533930794452  LUMO (Ag) = -0.104340980739382
cycle= 14 E= -75.3547338937026  delta_E= 1.42e-14  |g|= 9.84e-10  |ddm|= 9.45e-10
HOMO (B3u) = -0.417533930774632  LUMO (Ag) = -0.104340980717587
cycle= 15 E= -75.3547338937026  delta_E= -4.26e-14  |g|= 8.54e-10  |ddm|= 7.75e-10
HOMO (B3u) = -0.417533930784678  LUMO (Ag) = -0.104340980767504
cycle= 16 E= -75.3547338937025  delta_E= 8.53e-14  |g|= 7.88e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.417533930717722  LUMO (Ag) = -0.104340980715307
cycle= 17 E= -75.3547338937026  delta_E= -8.53e-14  |g|= 8.02e-10  |ddm|= 3.95e-10
HOMO (B2u) = -0.417533930623845  LUMO (Ag) = -0.104340980573107
cycle= 18 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 3.17e-10  |ddm|= 1.48e-09
HOMO (B2u) = -0.417533930625532  LUMO (Ag) = -0.104340980567325
cycle= 19 E= -75.3547338937026  delta_E= 2.84e-14  |g|= 2.57e-10  |ddm|= 2.19e-10
HOMO (B2u) = -0.417533930636103  LUMO (Ag) = -0.104340980572432
cycle= 20 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 2.07e-10  |ddm|= 1.76e-10
HOMO (B2u) = -0.417533930645914  LUMO (Ag) = -0.104340980578142
cycle= 21 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 1.69e-10  |ddm|= 1.31e-10
HOMO (B2u) = -0.417533930653093  LUMO (Ag) = -0.104340980582533
cycle= 22 E= -75.3547338937026  delta_E=    0  |g|= 1.4e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.417533930658217  LUMO (Ag) = -0.104340980586161
cycle= 23 E= -75.3547338937027  delta_E= -8.53e-14  |g|= 1.16e-10  |ddm|= 8.5e-11
HOMO (B3u) = -0.417533930662174  LUMO (Ag) = -0.104340980588721
cycle= 24 E= -75.3547338937027  delta_E= -2.84e-14  |g|= 9.52e-11  |ddm|= 6.87e-11
HOMO (B2u) = -0.417533930666071  LUMO (Ag) = -0.104340980589477
cycle= 25 E= -75.3547338937025  delta_E= 1.42e-13  |g|= 7.34e-11  |ddm|= 4.61e-11
HOMO (B3u) = -0.41753393066832  LUMO (Ag) = -0.10434098058816
cycle= 26 E= -75.3547338937025  delta_E=    0  |g|= 4.99e-11  |ddm|= 5.07e-11
HOMO (B3u) = -0.417533930663493  LUMO (Ag) = -0.104340980579028
Extra cycle  E= -75.3547338937026  delta_E= -1.42e-14  |g|= 1.62e-11  |ddm|= 6.27e-11
converged SCF energy = -75.3547338937026

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpfov72sxj
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.533632921519  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.557029859301  dE = -0.023396938  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0768
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5693666525338  dE = -0.012336793  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0694  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5774849618821  dE = -0.0081183093  S^2 = 0.0000000
               |grad[o]|=0.0922  |ddm|=0.0294  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5835779169523  dE = -0.0060929551  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0162  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5883468964893  dE = -0.0047689795  S^2 = 0.0000000
               |grad[o]|=0.0599  |ddm|=0.0107  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5920450999901  dE = -0.0036982035  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00775  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5947857838725  dE = -0.0027406839  S^2 = 0.0000000
               |grad[o]|=0.0356  |ddm|=0.00594  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5966321676927  dE = -0.0018463838  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00502  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5976345635041  dE = -0.0010023958  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00495  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5978367086503  dE = -0.00020214515  S^2 = 0.0000000
               |grad[o]|=0.00622  |ddm|=0.00558  |maxRot[o]|= 0.04
macro iter 11 (3 JK  0 micro), CASSCF E = -75.597867096195  dE = -3.0387545e-05  S^2 = 0.0000000
               |grad[o]|=0.00217  |ddm|=0.00321  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5978677929633  dE = -6.9676825e-07  S^2 = 0.0000000
               |grad[o]|=0.000398  |ddm|=0.00173  |maxRot[o]|=0.00283
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5978678057743  dE = -1.2811086e-08  S^2 = 0.0000000
               |grad[o]|=6.59e-05  |ddm|=0.000311  |maxRot[o]|=0.000323
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5978678060434  dE = -2.6905411e-10  S^2 = 0.0000000
               |grad[o]|=1.02e-05  |ddm|=4.86e-05  |maxRot[o]|=4.75e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5978678060504  dE = -7.0059514e-12  S^2 = 0.0000000
               |grad[o]|=1.58e-06  |ddm|=8.75e-06  |maxRot[o]|=7.7e-06
2-step CASSCF converged in 15 macro (72 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97829963 1.67678201 1.83943619 1.83943573 0.32392972 0.16144639
 0.16144632 0.01922401]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00588   0.00336   0.00000   0.00000  -0.00095
  0 C 2s       0.61465   0.56857  -0.00000  -0.00000  -0.34718
  0 C 3s      -0.03607   0.00891  -0.00000   0.00000   0.00734
  0 C 2px      0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py      0.00000  -0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34438  -0.42027   0.00000   0.00000   0.61414
  0 C 3px      0.00000   0.00000  -0.00000   0.01064   0.00000
  0 C 3py      0.00000  -0.00000   0.01064   0.00000  -0.00000
  0 C 3pz     -0.03594  -0.00262  -0.00000   0.00000  -0.04307
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.02590   0.00000  -0.00000
  0 C 3dz^2    0.03130  -0.00139  -0.00000   0.00000   0.01982
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02590   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00588  -0.00336   0.00000   0.00000  -0.00095
  1 C 2s       0.61465  -0.56857   0.00000  -0.00000  -0.34718
  1 C 3s      -0.03607  -0.00891   0.00000  -0.00000   0.00734
  1 C 2px      0.00000  -0.00000   0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000   0.00000
  1 C 2pz     -0.34438  -0.42027   0.00000   0.00000  -0.61414
  1 C 3px     -0.00000   0.00000   0.00000   0.01064  -0.00000
  1 C 3py     -0.00000   0.00000   0.01064  -0.00000   0.00000
  1 C 3pz      0.03594  -0.00262  -0.00000   0.00000   0.04307
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02590   0.00000  -0.00000
  1 C 3dz^2    0.03130   0.00139   0.00000  -0.00000   0.01982
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02590   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00044
  0 C 2s      -0.00000  -0.00000   0.41964
  0 C 3s       0.00000  -0.00000  -0.04337
  0 C 2px      0.70651  -0.00000   0.00000
  0 C 2py     -0.00000   0.70651  -0.00000
  0 C 2pz      0.00000  -0.00000   0.56675
  0 C 3px     -0.01810  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01810  -0.00000
  0 C 3pz      0.00000  -0.00000   0.01881
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02276  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02148
  0 C 3dxz    -0.02276  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00044
  1 C 2s      -0.00000   0.00000  -0.41964
  1 C 3s      -0.00000   0.00000   0.04337
  1 C 2px     -0.70651   0.00000   0.00000
  1 C 2py      0.00000  -0.70651   0.00000
  1 C 2pz     -0.00000   0.00000   0.56675
  1 C 3px      0.01810   0.00000  -0.00000
  1 C 3py      0.00000   0.01810   0.00000
  1 C 3pz      0.00000  -0.00000   0.01881
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02276  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02148
  1 C 3dxz    -0.02276  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99254642
<CAS-nat-orb|mo-hf>  4  4    0.99791955
<CAS-nat-orb|mo-hf>  5  5    0.99960057
<CAS-nat-orb|mo-hf>  6  6    0.99960057
<CAS-nat-orb|mo-hf>  7  7    0.97536358
<CAS-nat-orb|mo-hf>  8  8    0.96172750
<CAS-nat-orb|mo-hf>  9  9    0.96172748
<CAS-nat-orb|mo-hf>  10  10    0.62371856
<CAS-nat-orb|mo-hf>  10  17    0.67956522
CASSCF energy = -75.5978678060504
CASCI E = -75.5978678060504  E(CI) = -16.8047461472215  S^2 = 0.0000000
Time cost =    281.781
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:57:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.455237330030 AA    0.000000000000   0.000000000000   2.750000000000 Bohr   0.0

nuclear repulsion = 13.0909090909091
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.375]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      9690.38


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpxjdcn6xd
max_memory 4000 MB (current use 174 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1557644738047

WARN: Singularity detected in overlap matrix (condition number =  321). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.19200419727189  LUMO (Ag) = -0.16608696150487
cycle= 1 E= -75.3260871697504  delta_E= -0.17  |g|= 0.228  |ddm|= 1.44
HOMO (B3u) = -0.448902413635199  LUMO (Ag) = -0.151522743525041
cycle= 2 E= -75.3454236890815  delta_E= -0.0193  |g|= 0.0517  |ddm|= 0.291
HOMO (B2u) = -0.411143114796125  LUMO (Ag) = -0.105979877749066
cycle= 3 E= -75.3463869604458  delta_E= -0.000963  |g|= 0.0112  |ddm|= 0.0546
HOMO (B2u) = -0.412216378156835  LUMO (Ag) = -0.102966454342322
cycle= 4 E= -75.3464661736963  delta_E= -7.92e-05  |g|= 0.00221  |ddm|= 0.0168
HOMO (B2u) = -0.413005500150534  LUMO (Ag) = -0.103497081119967
cycle= 5 E= -75.3464696035283  delta_E= -3.43e-06  |g|= 0.000295  |ddm|= 0.00439
HOMO (B3u) = -0.412935226123342  LUMO (Ag) = -0.103410770619274
cycle= 6 E= -75.3464696577874  delta_E= -5.43e-08  |g|= 3.83e-05  |ddm|= 0.000585
HOMO (B3u) = -0.412927742673202  LUMO (Ag) = -0.103398722647751
cycle= 7 E= -75.346469658793  delta_E= -1.01e-09  |g|= 4.88e-06  |ddm|= 0.00019
HOMO (B3u) = -0.412927696344284  LUMO (Ag) = -0.103397915940729
cycle= 8 E= -75.3464696588055  delta_E= -1.25e-11  |g|= 4.41e-07  |ddm|= 2.55e-05
HOMO (B2u) = -0.412927666372068  LUMO (Ag) = -0.1033977975372
cycle= 9 E= -75.3464696588055  delta_E= 4.26e-14  |g|= 1.96e-08  |ddm|= 2.16e-06
HOMO (B3u) = -0.412927660626367  LUMO (Ag) = -0.10339780002929
cycle= 10 E= -75.3464696588056  delta_E= -1.14e-13  |g|= 2.79e-09  |ddm|= 6.4e-08
HOMO (B3u) = -0.412927661254346  LUMO (Ag) = -0.103397800547658
cycle= 11 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 2.27e-09  |ddm|= 1.8e-09
HOMO (B3u) = -0.412927661143677  LUMO (Ag) = -0.103397800408828
cycle= 12 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 1.62e-09  |ddm|= 2.56e-09
HOMO (B2u) = -0.41292766109832  LUMO (Ag) = -0.103397800323991
cycle= 13 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 1.29e-09  |ddm|= 1.58e-09
HOMO (B2u) = -0.412927661060721  LUMO (Ag) = -0.103397800268894
cycle= 14 E= -75.3464696588057  delta_E= -1.42e-13  |g|= 1.06e-09  |ddm|= 1e-09
HOMO (B3u) = -0.412927661039749  LUMO (Ag) = -0.103397800245314
cycle= 15 E= -75.3464696588055  delta_E= 1.42e-13  |g|= 9.1e-10  |ddm|= 6.98e-10
HOMO (B2u) = -0.412927661045622  LUMO (Ag) = -0.103397800288551
cycle= 16 E= -75.3464696588055  delta_E= -2.84e-14  |g|= 8.36e-10  |ddm|= 1.29e-09
HOMO (B2u) = -0.412927660984962  LUMO (Ag) = -0.103397800239564
cycle= 17 E= -75.3464696588055  delta_E= 7.11e-14  |g|= 8.37e-10  |ddm|= 2.12e-10
HOMO (B2u) = -0.412927660873058  LUMO (Ag) = -0.1033978000916
cycle= 18 E= -75.3464696588055  delta_E= -4.26e-14  |g|= 3.44e-10  |ddm|= 1.65e-09
HOMO (B2u) = -0.412927660874902  LUMO (Ag) = -0.103397800085918
cycle= 19 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 2.81e-10  |ddm|= 2.47e-10
HOMO (B2u) = -0.412927660889661  LUMO (Ag) = -0.103397800094492
cycle= 20 E= -75.3464696588055  delta_E= -2.84e-14  |g|= 2.21e-10  |ddm|= 1.97e-10
HOMO (B2u) = -0.412927660899911  LUMO (Ag) = -0.103397800100526
cycle= 21 E= -75.3464696588055  delta_E= -2.84e-14  |g|= 1.81e-10  |ddm|= 1.45e-10
HOMO (B2u) = -0.412927660907417  LUMO (Ag) = -0.10339780010549
cycle= 22 E= -75.3464696588055  delta_E=    0  |g|= 1.48e-10  |ddm|= 1.12e-10
HOMO (B2u) = -0.412927660912916  LUMO (Ag) = -0.103397800109566
cycle= 23 E= -75.3464696588055  delta_E=    0  |g|= 1.22e-10  |ddm|= 9.19e-11
HOMO (B2u) = -0.412927660917464  LUMO (Ag) = -0.103397800112921
cycle= 24 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 1e-10  |ddm|= 7.84e-11
HOMO (B2u) = -0.412927660921724  LUMO (Ag) = -0.103397800114417
cycle= 25 E= -75.3464696588055  delta_E= -5.68e-14  |g|= 7.74e-11  |ddm|= 5.42e-11
HOMO (B2u) = -0.412927660924322  LUMO (Ag) = -0.103397800113906
cycle= 26 E= -75.3464696588055  delta_E=    0  |g|= 5.33e-11  |ddm|= 5.67e-11
HOMO (B3u) = -0.412927660918834  LUMO (Ag) = -0.103397800104408
Extra cycle  E= -75.3464696588055  delta_E= 2.84e-14  |g|= 1.7e-11  |ddm|= 6.98e-11
converged SCF energy = -75.3464696588055

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpxjdcn6xd
max_memory 4000 MB (current use 176 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5273817495039  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5505812895242  dE = -0.02319954  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0789
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5627423957475  dE = -0.012161106  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5708416789258  dE = -0.0080992832  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0298  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5769114255592  dE = -0.0060697466  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0169  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5816202918572  dE = -0.0047088663  S^2 = 0.0000000
               |grad[o]|=0.0598  |ddm|=0.0112  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.585218014267  dE = -0.0035977224  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.00806  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5878220968984  dE = -0.0026040826  S^2 = 0.0000000
               |grad[o]|=0.0347  |ddm|=0.00612  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5895016097381  dE = -0.0016795128  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5903141997754  dE = -0.00081259004  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.00535  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5904157790264  dE = -0.00010157925  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.00625  |maxRot[o]|=0.0374
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5904169954665  dE = -1.2164401e-06  S^2 = 0.0000000
               |grad[o]|=0.000611  |ddm|=0.00344  |maxRot[o]|=0.00344
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5904170207646  dE = -2.5298093e-08  S^2 = 0.0000000
               |grad[o]|=9.15e-05  |ddm|=0.000453  |maxRot[o]|=0.000415
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5904170213119  dE = -5.4730265e-10  S^2 = 0.0000000
               |grad[o]|=1.51e-05  |ddm|=6.86e-05  |maxRot[o]|=6.34e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5904170213271  dE = -1.5234036e-11  S^2 = 0.0000000
               |grad[o]|=2.37e-06  |ddm|=1.28e-05  |maxRot[o]|=1.1e-05
2-step CASSCF converged in 14 macro (69 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97743796 1.68610721 1.83058145 1.83058041 0.31631683 0.16943524
 0.16943537 0.02010553]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00615   0.00344   0.00000   0.00000  -0.00091
  0 C 2s       0.61773   0.57533   0.00000  -0.00000  -0.34180
  0 C 3s      -0.03411   0.00898  -0.00000  -0.00000   0.00990
  0 C 2px      0.00000  -0.00000  -0.00000   0.70654  -0.00000
  0 C 2py     -0.00000   0.00000   0.70654  -0.00000  -0.00000
  0 C 2pz      0.33928  -0.41097  -0.00000  -0.00000   0.61707
  0 C 3px     -0.00000  -0.00000   0.00000   0.01297  -0.00000
  0 C 3py      0.00000  -0.00000   0.01297   0.00000  -0.00000
  0 C 3pz     -0.03426  -0.00242  -0.00000  -0.00000  -0.04286
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02505   0.00000  -0.00000
  0 C 3dz^2    0.03040  -0.00175  -0.00000  -0.00000   0.02149
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02505  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00615  -0.00344   0.00000   0.00000  -0.00091
  1 C 2s       0.61773  -0.57533  -0.00000   0.00000  -0.34180
  1 C 3s      -0.03411  -0.00898   0.00000   0.00000   0.00990
  1 C 2px      0.00000   0.00000  -0.00000   0.70654  -0.00000
  1 C 2py      0.00000   0.00000   0.70654  -0.00000   0.00000
  1 C 2pz     -0.33928  -0.41097  -0.00000   0.00000  -0.61707
  1 C 3px     -0.00000   0.00000   0.00000   0.01297   0.00000
  1 C 3py      0.00000  -0.00000   0.01297  -0.00000   0.00000
  1 C 3pz      0.03426  -0.00242  -0.00000  -0.00000   0.04286
  1 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02505   0.00000  -0.00000
  1 C 3dz^2    0.03040   0.00175   0.00000   0.00000   0.02149
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02505  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s      -0.00000   0.00000   0.41035
  0 C 3s      -0.00000  -0.00000  -0.04345
  0 C 2px      0.70654   0.00000  -0.00000
  0 C 2py     -0.00000   0.70654  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.57349
  0 C 3px     -0.01725  -0.00000   0.00000
  0 C 3py     -0.00000  -0.01725  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01967
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02253  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02125
  0 C 3dxz    -0.02253  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.41035
  1 C 3s       0.00000   0.00000   0.04345
  1 C 2px     -0.70654   0.00000  -0.00000
  1 C 2py      0.00000  -0.70654   0.00000
  1 C 2pz      0.00000   0.00000   0.57349
  1 C 3px      0.01725  -0.00000   0.00000
  1 C 3py      0.00000   0.01725   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01967
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02253  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02125
  1 C 3dxz    -0.02253   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99226092
<CAS-nat-orb|mo-hf>  4  4    0.99781292
<CAS-nat-orb|mo-hf>  5  5    0.99956408
<CAS-nat-orb|mo-hf>  6  6    0.99956408
<CAS-nat-orb|mo-hf>  7  7    0.97493010
<CAS-nat-orb|mo-hf>  8  8    0.96431698
<CAS-nat-orb|mo-hf>  9  9    0.96431697
<CAS-nat-orb|mo-hf>  10  10    0.64879987
<CAS-nat-orb|mo-hf>  10  17    0.66873221
CASSCF energy = -75.5904170213271
CASCI E = -75.5904170213271  E(CI) = -16.6895622816504  S^2 = 0.0000000
Time cost =    261.935
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:01:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.481696190576 AA    0.000000000000   0.000000000000   2.800000000000 Bohr   0.0

nuclear repulsion = 12.8571428571429
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.4]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10142.02


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpgj03rklr
max_memory 4000 MB (current use 176 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1187592585641

WARN: Singularity detected in overlap matrix (condition number =  297). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.184977014444633  LUMO (Ag) = -0.163989710542375
cycle= 1 E= -75.3167358242476  delta_E= -0.198  |g|= 0.231  |ddm|= 1.44
HOMO (B2u) = -0.444434359277166  LUMO (Ag) = -0.151416963696342
cycle= 2 E= -75.3367114409983  delta_E= -0.02  |g|= 0.0515  |ddm|= 0.298
HOMO (B2u) = -0.406594326641874  LUMO (Ag) = -0.105005000614386
cycle= 3 E= -75.3376920455643  delta_E= -0.000981  |g|= 0.0117  |ddm|= 0.0545
HOMO (B3u) = -0.407746719644286  LUMO (Ag) = -0.101871698894467
cycle= 4 E= -75.3377779901322  delta_E= -8.59e-05  |g|= 0.00225  |ddm|= 0.0162
HOMO (B3u) = -0.408536003811462  LUMO (Ag) = -0.102414153547261
cycle= 5 E= -75.3377816192103  delta_E= -3.63e-06  |g|= 0.000309  |ddm|= 0.00396
HOMO (B3u) = -0.408464040126319  LUMO (Ag) = -0.102331174534055
cycle= 6 E= -75.3377816780684  delta_E= -5.89e-08  |g|= 3.95e-05  |ddm|= 0.000618
HOMO (B3u) = -0.408456256018866  LUMO (Ag) = -0.102318677176295
cycle= 7 E= -75.3377816791324  delta_E= -1.06e-09  |g|= 5.06e-06  |ddm|= 0.00018
HOMO (B3u) = -0.408456106236037  LUMO (Ag) = -0.102317785563299
cycle= 8 E= -75.337781679146  delta_E= -1.36e-11  |g|= 4.62e-07  |ddm|= 2.48e-05
HOMO (B3u) = -0.408456075143895  LUMO (Ag) = -0.102317652725592
cycle= 9 E= -75.3377816791461  delta_E= -9.95e-14  |g|= 2.02e-08  |ddm|= 1.99e-06
HOMO (B3u) = -0.408456068963824  LUMO (Ag) = -0.102317657025672
cycle= 10 E= -75.3377816791461  delta_E= -4.26e-14  |g|= 2.92e-09  |ddm|= 6.88e-08
HOMO (B3u) = -0.408456069762542  LUMO (Ag) = -0.102317657747787
cycle= 11 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 2.42e-09  |ddm|= 2.47e-09
HOMO (B3u) = -0.408456069541911  LUMO (Ag) = -0.102317657475913
cycle= 12 E= -75.3377816791461  delta_E= 4.26e-14  |g|= 1.71e-09  |ddm|= 2.62e-09
HOMO (B3u) = -0.408456069497233  LUMO (Ag) = -0.102317657374319
cycle= 13 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 1.39e-09  |ddm|= 1.56e-09
HOMO (B3u) = -0.408456069460693  LUMO (Ag) = -0.102317657325753
cycle= 14 E= -75.3377816791461  delta_E=    0  |g|= 1.14e-09  |ddm|= 1.09e-09
HOMO (B3u) = -0.40845606943704  LUMO (Ag) = -0.102317657300276
cycle= 15 E= -75.337781679146  delta_E= 1.14e-13  |g|= 9.7e-10  |ddm|= 6.23e-10
HOMO (B3u) = -0.40845606943435  LUMO (Ag) = -0.102317657333227
cycle= 16 E= -75.3377816791461  delta_E= -5.68e-14  |g|= 8.96e-10  |ddm|= 1.15e-09
HOMO (B3u) = -0.408456069387434  LUMO (Ag) = -0.102317657293552
cycle= 17 E= -75.3377816791461  delta_E= -5.68e-14  |g|= 8.67e-10  |ddm|= 9.07e-11
HOMO (B3u) = -0.40845606925961  LUMO (Ag) = -0.102317657143958
cycle= 18 E= -75.337781679146  delta_E= 1.14e-13  |g|= 3.66e-10  |ddm|= 1.82e-09
HOMO (B2u) = -0.408456069261373  LUMO (Ag) = -0.102317657138262
cycle= 19 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 3e-10  |ddm|= 2.73e-10
HOMO (B3u) = -0.408456069278699  LUMO (Ag) = -0.102317657149117
cycle= 20 E= -75.337781679146  delta_E= 1.14e-13  |g|= 2.36e-10  |ddm|= 2.07e-10
HOMO (B3u) = -0.408456069289466  LUMO (Ag) = -0.102317657155503
cycle= 21 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 1.93e-10  |ddm|= 1.53e-10
HOMO (B3u) = -0.408456069297028  LUMO (Ag) = -0.102317657160995
cycle= 22 E= -75.337781679146  delta_E= 2.84e-14  |g|= 1.57e-10  |ddm|= 1.19e-10
HOMO (B3u) = -0.408456069302726  LUMO (Ag) = -0.102317657165506
cycle= 23 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 1.28e-10  |ddm|= 9.79e-11
HOMO (B3u) = -0.408456069307766  LUMO (Ag) = -0.102317657169692
cycle= 24 E= -75.3377816791461  delta_E= 5.68e-14  |g|= 1.05e-10  |ddm|= 8.81e-11
HOMO (B3u) = -0.408456069312194  LUMO (Ag) = -0.102317657171835
cycle= 25 E= -75.337781679146  delta_E= 2.84e-14  |g|= 8.08e-11  |ddm|= 6.46e-11
HOMO (B2u) = -0.408456069315164  LUMO (Ag) = -0.102317657172309
cycle= 26 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 5.64e-11  |ddm|= 6.32e-11
HOMO (B3u) = -0.408456069313832  LUMO (Ag) = -0.102317657169861
cycle= 27 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 4.58e-11  |ddm|= 2.27e-11
HOMO (B3u) = -0.408456069312356  LUMO (Ag) = -0.102317657167542
cycle= 28 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 3.7e-11  |ddm|= 1.74e-11
HOMO (B2u) = -0.408456069311359  LUMO (Ag) = -0.102317657165919
cycle= 29 E= -75.337781679146  delta_E= 9.95e-14  |g|= 3e-11  |ddm|= 1.35e-11
HOMO (B2u) = -0.408456069310632  LUMO (Ag) = -0.102317657164713
cycle= 30 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 2.43e-11  |ddm|= 1.08e-11
HOMO (B3u) = -0.40845606931014  LUMO (Ag) = -0.102317657163795
cycle= 31 E= -75.3377816791461  delta_E=    0  |g|= 1.95e-11  |ddm|= 8.68e-12
HOMO (B2u) = -0.408456069309835  LUMO (Ag) = -0.102317657161914
Extra cycle  E= -75.3377816791461  delta_E= 2.84e-14  |g|= 6.45e-12  |ddm|= 2.33e-11
converged SCF energy = -75.3377816791461

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpgj03rklr
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5207710561401  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5435858178721  dE = -0.022814762  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5556863536553  dE = -0.012100536  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5638012283035  dE = -0.0081148746  S^2 = 0.0000000
               |grad[o]|=0.0929  |ddm|=0.0305  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5698554857252  dE = -0.0060542574  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0176  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5744974578817  dE = -0.0046419722  S^2 = 0.0000000
               |grad[o]|=0.0595  |ddm|=0.0117  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5779785033128  dE = -0.0034810454  S^2 = 0.0000000
               |grad[o]|=0.0458  |ddm|=0.00833  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5804227194733  dE = -0.0024442162  S^2 = 0.0000000
               |grad[o]|=0.0334  |ddm|=0.00629  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5819072097379  dE = -0.0014844903  S^2 = 0.0000000
               |grad[o]|=0.0219  |ddm|=0.00549  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5824311518785  dE = -0.00052394214  S^2 = 0.0000000
               |grad[o]|=0.0112  |ddm|=0.00592  |maxRot[o]|= 0.06
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5825178886291  dE = -8.6736751e-05  S^2 = 0.0000000
               |grad[o]|=0.00395  |ddm|=0.00526  |maxRot[o]|=0.0339
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5825189143668  dE = -1.0257377e-06  S^2 = 0.0000000
               |grad[o]|=0.00057  |ddm|=0.00341  |maxRot[o]|=0.00308
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5825189359808  dE = -2.1613999e-08  S^2 = 0.0000000
               |grad[o]|=8.53e-05  |ddm|=0.000437  |maxRot[o]|=0.000367
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5825189364279  dE = -4.470877e-10  S^2 = 0.0000000
               |grad[o]|=1.4e-05  |ddm|=6.12e-05  |maxRot[o]|=5.56e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5825189364314  dE = -3.524292e-12  S^2 = 0.0000000
               |grad[o]|=1.99e-06  |ddm|=1.03e-05  |maxRot[o]|=9.54e-06
2-step CASSCF converged in 14 macro (68 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97658606 1.69515621 1.82129742 1.82129801 0.3093552  0.17765826
 0.17765866 0.02099018]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00641   0.00352   0.00000   0.00000  -0.00088
  0 C 2s       0.62079   0.58190   0.00000  -0.00000  -0.33633
  0 C 3s      -0.03214   0.00906   0.00000  -0.00000   0.01238
  0 C 2px     -0.00000   0.00000  -0.00000   0.70653   0.00000
  0 C 2py      0.00000  -0.00000   0.70653   0.00000  -0.00000
  0 C 2pz      0.33407  -0.40161   0.00000   0.00000   0.61999
  0 C 3px     -0.00000  -0.00000  -0.00000   0.01517  -0.00000
  0 C 3py      0.00000  -0.00000   0.01517   0.00000  -0.00000
  0 C 3pz     -0.03258  -0.00225   0.00000   0.00000  -0.04249
  0 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02420   0.00000  -0.00000
  0 C 3dz^2    0.02955  -0.00209   0.00000  -0.00000   0.02326
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.02420  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00641  -0.00352   0.00000   0.00000  -0.00088
  1 C 2s       0.62079  -0.58190  -0.00000  -0.00000  -0.33633
  1 C 3s      -0.03214  -0.00906  -0.00000   0.00000   0.01238
  1 C 2px      0.00000   0.00000   0.00000   0.70653   0.00000
  1 C 2py     -0.00000   0.00000   0.70653   0.00000  -0.00000
  1 C 2pz     -0.33407  -0.40161   0.00000  -0.00000  -0.61999
  1 C 3px      0.00000  -0.00000   0.00000   0.01517  -0.00000
  1 C 3py     -0.00000   0.00000   0.01517  -0.00000   0.00000
  1 C 3pz      0.03258  -0.00225   0.00000  -0.00000   0.04249
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02420   0.00000  -0.00000
  1 C 3dz^2    0.02955   0.00209  -0.00000   0.00000   0.02326
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02420   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000   0.00000   0.40101
  0 C 3s      -0.00000  -0.00000  -0.04346
  0 C 2px      0.70657  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70657   0.00000
  0 C 2pz     -0.00000   0.00000   0.58004
  0 C 3px     -0.01641  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01641  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02037
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02228  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02106
  0 C 3dxz    -0.02228  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s       0.00000   0.00000  -0.40101
  1 C 3s       0.00000  -0.00000   0.04346
  1 C 2px     -0.70657   0.00000   0.00000
  1 C 2py      0.00000  -0.70657   0.00000
  1 C 2pz     -0.00000   0.00000   0.58004
  1 C 3px      0.01641   0.00000   0.00000
  1 C 3py      0.00000   0.01641  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02037
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02228   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02106
  1 C 3dxz    -0.02228  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99198874
<CAS-nat-orb|mo-hf>  4  4    0.99770782
<CAS-nat-orb|mo-hf>  5  5    0.99952508
<CAS-nat-orb|mo-hf>  6  6    0.99952508
<CAS-nat-orb|mo-hf>  7  7    0.97453484
<CAS-nat-orb|mo-hf>  8  8    0.96668730
<CAS-nat-orb|mo-hf>  9  9    0.96668736
<CAS-nat-orb|mo-hf>  10  10    0.67408746
<CAS-nat-orb|mo-hf>  10  17    0.65475223
CASSCF energy = -75.5825189364314
CASCI E = -75.5825189364314  E(CI) = -16.5777815975583  S^2 = 0.0000000
Time cost =    244.223
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:05:57 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.508155051122 AA    0.000000000000   0.000000000000   2.850000000000 Bohr   0.0

nuclear repulsion = 12.6315789473684
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.425]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10471.05


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpxsdi0mld
max_memory 4000 MB (current use 174 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0836082427711

WARN: Singularity detected in overlap matrix (condition number =  275). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.178310042866846  LUMO (Ag) = -0.161961845746925
cycle= 1 E= -75.3070977055452  delta_E= -0.223  |g|= 0.234  |ddm|= 1.43
HOMO (B2u) = -0.440057963112903  LUMO (Ag) = -0.151084704136087
cycle= 2 E= -75.3276882495978  delta_E= -0.0206  |g|= 0.0513  |ddm|= 0.304
HOMO (B2u) = -0.402148496278865  LUMO (Ag) = -0.103839161942737
cycle= 3 E= -75.3286840635262  delta_E= -0.000996  |g|= 0.0121  |ddm|= 0.0544
HOMO (B2u) = -0.403404739232162  LUMO (Ag) = -0.10064529467541
cycle= 4 E= -75.3287765426505  delta_E= -9.25e-05  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.404190054526263  LUMO (Ag) = -0.101202470957946
cycle= 5 E= -75.3287803215959  delta_E= -3.78e-06  |g|= 0.000318  |ddm|= 0.00364
HOMO (B2u) = -0.404117903551404  LUMO (Ag) = -0.101124705066536
cycle= 6 E= -75.3287803833538  delta_E= -6.18e-08  |g|= 4.04e-05  |ddm|= 0.000637
HOMO (B2u) = -0.404109925173547  LUMO (Ag) = -0.101111910622259
cycle= 7 E= -75.3287803844586  delta_E= -1.1e-09  |g|= 5.18e-06  |ddm|= 0.000169
HOMO (B2u) = -0.4041096639687  LUMO (Ag) = -0.101110942652333
cycle= 8 E= -75.3287803844733  delta_E= -1.46e-11  |g|= 4.83e-07  |ddm|= 2.4e-05
HOMO (B3u) = -0.404109632109882  LUMO (Ag) = -0.101110794247838
cycle= 9 E= -75.3287803844734  delta_E= -1.14e-13  |g|= 2.07e-08  |ddm|= 1.8e-06
HOMO (B2u) = -0.404109625552915  LUMO (Ag) = -0.101110800522627
cycle= 10 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 3.06e-09  |ddm|= 7.31e-08
HOMO (B2u) = -0.40410962647197  LUMO (Ag) = -0.101110801398535
cycle= 11 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 2.51e-09  |ddm|= 3.11e-09
HOMO (B2u) = -0.404109626201609  LUMO (Ag) = -0.101110801058638
cycle= 12 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 1.79e-09  |ddm|= 2.71e-09
HOMO (B2u) = -0.404109626163897  LUMO (Ag) = -0.101110800945879
cycle= 13 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 1.48e-09  |ddm|= 1.6e-09
HOMO (B2u) = -0.404109626115953  LUMO (Ag) = -0.101110800888829
cycle= 14 E= -75.3287803844733  delta_E= 1.42e-14  |g|= 1.23e-09  |ddm|= 9.94e-10
HOMO (B2u) = -0.40410962608966  LUMO (Ag) = -0.101110800862321
cycle= 15 E= -75.3287803844734  delta_E= -7.11e-14  |g|= 1.04e-09  |ddm|= 6.13e-10
HOMO (B2u) = -0.404109626085112  LUMO (Ag) = -0.10111080088874
cycle= 16 E= -75.3287803844733  delta_E= 8.53e-14  |g|= 9.48e-10  |ddm|= 1.08e-09
HOMO (B2u) = -0.404109626047519  LUMO (Ag) = -0.10111080085625
cycle= 17 E= -75.3287803844733  delta_E= -1.42e-14  |g|= 8.95e-10  |ddm|= 2.18e-10
HOMO (B2u) = -0.404109625906486  LUMO (Ag) = -0.101110800709382
cycle= 18 E= -75.3287803844734  delta_E= -7.11e-14  |g|= 3.85e-10  |ddm|= 1.99e-09
HOMO (B2u) = -0.404109625907977  LUMO (Ag) = -0.101110800703583
cycle= 19 E= -75.3287803844733  delta_E= 1.14e-13  |g|= 3.16e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.404109625926526  LUMO (Ag) = -0.101110800715775
cycle= 20 E= -75.3287803844733  delta_E=    0  |g|= 2.5e-10  |ddm|= 2.16e-10
HOMO (B2u) = -0.404109625937811  LUMO (Ag) = -0.101110800722488
cycle= 21 E= -75.3287803844734  delta_E= -8.53e-14  |g|= 2.04e-10  |ddm|= 1.59e-10
HOMO (B2u) = -0.404109625945539  LUMO (Ag) = -0.101110800728569
cycle= 22 E= -75.3287803844735  delta_E= -8.53e-14  |g|= 1.66e-10  |ddm|= 1.23e-10
HOMO (B2u) = -0.404109625951271  LUMO (Ag) = -0.101110800733467
cycle= 23 E= -75.3287803844733  delta_E= 1.14e-13  |g|= 1.35e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.404109625956676  LUMO (Ag) = -0.10111080073845
cycle= 24 E= -75.3287803844734  delta_E= -2.84e-14  |g|= 1.09e-10  |ddm|= 9.76e-11
HOMO (B3u) = -0.40410962596132  LUMO (Ag) = -0.101110800741476
cycle= 25 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 8.4e-11  |ddm|= 7.46e-11
HOMO (B3u) = -0.404109625964657  LUMO (Ag) = -0.101110800743059
cycle= 26 E= -75.3287803844734  delta_E= -2.84e-14  |g|= 5.92e-11  |ddm|= 7.01e-11
HOMO (B3u) = -0.404109625963265  LUMO (Ag) = -0.101110800740647
cycle= 27 E= -75.3287803844734  delta_E= -2.84e-14  |g|= 4.81e-11  |ddm|= 2.47e-11
HOMO (B3u) = -0.404109625961694  LUMO (Ag) = -0.101110800738322
cycle= 28 E= -75.3287803844734  delta_E= 4.26e-14  |g|= 3.88e-11  |ddm|= 1.88e-11
HOMO (B3u) = -0.404109625960618  LUMO (Ag) = -0.101110800736731
cycle= 29 E= -75.3287803844734  delta_E= -1.42e-14  |g|= 3.14e-11  |ddm|= 1.47e-11
HOMO (B3u) = -0.404109625959821  LUMO (Ag) = -0.101110800735584
cycle= 30 E= -75.3287803844734  delta_E= -2.84e-14  |g|= 2.52e-11  |ddm|= 1.17e-11
HOMO (B3u) = -0.40410962595928  LUMO (Ag) = -0.101110800734741
cycle= 31 E= -75.3287803844733  delta_E= 8.53e-14  |g|= 2.02e-11  |ddm|= 9.4e-12
HOMO (B3u) = -0.404109625958938  LUMO (Ag) = -0.10111080073411
cycle= 32 E= -75.3287803844733  delta_E= -1.42e-14  |g|= 1.61e-11  |ddm|= 7.48e-12
HOMO (B3u) = -0.404109625958752  LUMO (Ag) = -0.101110800733623
cycle= 33 E= -75.3287803844733  delta_E= 1.42e-14  |g|= 1.26e-11  |ddm|= 5.95e-12
HOMO (B3u) = -0.404109625958708  LUMO (Ag) = -0.101110800733319
cycle= 34 E= -75.3287803844733  delta_E= -2.84e-14  |g|= 9.95e-12  |ddm|= 4.63e-12
HOMO (B3u) = -0.404109625958769  LUMO (Ag) = -0.101110800733173
cycle= 35 E= -75.3287803844734  delta_E= -9.95e-14  |g|= 8.07e-12  |ddm|= 3.41e-12
HOMO (B3u) = -0.404109625958794  LUMO (Ag) = -0.101110800733037
cycle= 36 E= -75.3287803844734  delta_E= 4.26e-14  |g|= 6.54e-12  |ddm|= 2.84e-12
HOMO (B3u) = -0.404109625958785  LUMO (Ag) = -0.101110800732904
cycle= 37 E= -75.3287803844734  delta_E=    0  |g|= 5.28e-12  |ddm|= 2.32e-12
HOMO (B3u) = -0.404109625958592  LUMO (Ag) = -0.101110800732341
Extra cycle  E= -75.3287803844734  delta_E= 2.84e-14  |g|= 1.78e-12  |ddm|= 6.94e-12
converged SCF energy = -75.3287803844734

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpxsdi0mld
max_memory 4000 MB (current use 176 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5139143945431  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5362301908142  dE = -0.022315796  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5483398809821  dE = -0.01210969  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0695  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5564887719879  dE = -0.008148891  S^2 = 0.0000000
               |grad[o]|=0.0932  |ddm|=0.0312  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5625262374713  dE = -0.0060374655  S^2 = 0.0000000
               |grad[o]|=0.0747  |ddm|=0.0183  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5670881352968  dE = -0.0045618978  S^2 = 0.0000000
               |grad[o]|=0.0588  |ddm|=0.0122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5704313549279  dE = -0.0033432196  S^2 = 0.0000000
               |grad[o]|=0.0446  |ddm|=0.00858  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5726887962904  dE = -0.0022574414  S^2 = 0.0000000
               |grad[o]|=0.0317  |ddm|=0.00647  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5739475221514  dE = -0.0012587259  S^2 = 0.0000000
               |grad[o]|=0.0197  |ddm|=0.00591  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5742840857051  dE = -0.00033656355  S^2 = 0.0000000
               |grad[o]|=0.00857  |ddm|=0.00674  |maxRot[o]|= 0.06
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5742936841767  dE = -9.5984717e-06  S^2 = 0.0000000
               |grad[o]|=0.00138  |ddm|=0.00615  |maxRot[o]|=0.0106
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5742938473245  dE = -1.6314773e-07  S^2 = 0.0000000
               |grad[o]|=0.00024  |ddm|=0.00135  |maxRot[o]|=0.00105
macro iter 12 (3 JK  0 micro), CASSCF E = -75.574293850464  dE = -3.1395615e-09  S^2 = 0.0000000
               |grad[o]|=3.74e-05  |ddm|=0.000171  |maxRot[o]|=0.00015
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5742938505334  dE = -6.933476e-11  S^2 = 0.0000000
               |grad[o]|=4.73e-06  |ddm|=2.25e-05  |maxRot[o]|=2.25e-05
2-step CASSCF converged in 13 macro (65 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97574992 1.70399847 1.81154522 1.81154426 0.30304426 0.18612138
 0.1861214  0.02187509]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00665   0.00360   0.00000   0.00000  -0.00085
  0 C 2s       0.62384   0.58827  -0.00000   0.00000  -0.33076
  0 C 3s      -0.03017   0.00916   0.00000   0.00000   0.01475
  0 C 2px      0.00000  -0.00000  -0.00000   0.70651  -0.00000
  0 C 2py      0.00000  -0.00000   0.70651  -0.00000   0.00000
  0 C 2pz      0.32876  -0.39221   0.00000  -0.00000   0.62289
  0 C 3px      0.00000  -0.00000   0.00000   0.01725  -0.00000
  0 C 3py      0.00000  -0.00000   0.01725   0.00000   0.00000
  0 C 3pz     -0.03092  -0.00212   0.00000   0.00000  -0.04192
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02335   0.00000   0.00000
  0 C 3dz^2    0.02875  -0.00240   0.00000   0.00000   0.02515
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02335  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00665  -0.00360   0.00000   0.00000  -0.00085
  1 C 2s       0.62384  -0.58827  -0.00000  -0.00000  -0.33076
  1 C 3s      -0.03017  -0.00916  -0.00000  -0.00000   0.01475
  1 C 2px     -0.00000   0.00000  -0.00000   0.70651   0.00000
  1 C 2py     -0.00000   0.00000   0.70651  -0.00000  -0.00000
  1 C 2pz     -0.32876  -0.39221  -0.00000   0.00000  -0.62289
  1 C 3px     -0.00000   0.00000   0.00000   0.01725   0.00000
  1 C 3py     -0.00000   0.00000   0.01725   0.00000  -0.00000
  1 C 3pz      0.03092  -0.00212   0.00000   0.00000   0.04192
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02335  -0.00000   0.00000
  1 C 3dz^2    0.02875   0.00240  -0.00000  -0.00000   0.02515
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02335  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00033
  0 C 2s       0.00000  -0.00000   0.39163
  0 C 3s       0.00000   0.00000  -0.04339
  0 C 2px      0.70659   0.00000   0.00000
  0 C 2py      0.00000   0.70659   0.00000
  0 C 2pz      0.00000   0.00000   0.58640
  0 C 3px     -0.01557   0.00000   0.00000
  0 C 3py      0.00000  -0.01557   0.00000
  0 C 3pz      0.00000  -0.00000   0.02090
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02201   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02090
  0 C 3dxz    -0.02201   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00033
  1 C 2s       0.00000   0.00000  -0.39163
  1 C 3s      -0.00000  -0.00000   0.04339
  1 C 2px     -0.70659  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70659  -0.00000
  1 C 2pz      0.00000   0.00000   0.58640
  1 C 3px      0.01557  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01557  -0.00000
  1 C 3pz      0.00000   0.00000   0.02090
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02201   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02090
  1 C 3dxz    -0.02201   0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99173412
<CAS-nat-orb|mo-hf>  4  4    0.99760703
<CAS-nat-orb|mo-hf>  5  5    0.99948360
<CAS-nat-orb|mo-hf>  6  6    0.99948359
<CAS-nat-orb|mo-hf>  7  7    0.97418543
<CAS-nat-orb|mo-hf>  8  8    0.96886035
<CAS-nat-orb|mo-hf>  9  9    0.96886034
<CAS-nat-orb|mo-hf>  10  10    0.69921469
<CAS-nat-orb|mo-hf>  10  15   -0.63804094
CASSCF energy = -75.5742938505334
CASCI E = -75.5742938505334  E(CI) = -16.4693217945525  S^2 = 0.0000000
Time cost =    207.236
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:09:25 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.534613911668 AA    0.000000000000   0.000000000000   2.900000000000 Bohr   0.0

nuclear repulsion = 12.4137931034483
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.45]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     10657.98


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpmclrq2d1
max_memory 4000 MB (current use 176 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0502696488693

WARN: Singularity detected in overlap matrix (condition number =  255). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.171982441441624  LUMO (Ag) = -0.159994465911487
cycle= 1 E= -75.2972707224472  delta_E= -0.247  |g|= 0.236  |ddm|= 1.43
HOMO (B3u) = -0.435771051837408  LUMO (Ag) = -0.150538347855669
cycle= 2 E= -75.3184487790456  delta_E= -0.0212  |g|= 0.051  |ddm|= 0.31
HOMO (B3u) = -0.397800865131721  LUMO (Ag) = -0.102495692949928
cycle= 3 E= -75.3194573772646  delta_E= -0.00101  |g|= 0.0124  |ddm|= 0.0544
HOMO (B2u) = -0.399183030564801  LUMO (Ag) = -0.0993011615665493
cycle= 4 E= -75.3195559425281  delta_E= -9.86e-05  |g|= 0.00229  |ddm|= 0.0157
HOMO (B3u) = -0.399959753294003  LUMO (Ag) = -0.0998732578136634
cycle= 5 E= -75.3195598190019  delta_E= -3.88e-06  |g|= 0.000323  |ddm|= 0.00343
HOMO (B3u) = -0.39988856745649  LUMO (Ag) = -0.099801991693926
cycle= 6 E= -75.3195598822274  delta_E= -6.32e-08  |g|= 4.09e-05  |ddm|= 0.000646
HOMO (B3u) = -0.399880517827685  LUMO (Ag) = -0.0997890778931013
cycle= 7 E= -75.3195598833514  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000156
HOMO (B3u) = -0.399880142870897  LUMO (Ag) = -0.0997880477227833
cycle= 8 E= -75.319559883367  delta_E= -1.56e-11  |g|= 5.02e-07  |ddm|= 2.32e-05
HOMO (B3u) = -0.399880110368995  LUMO (Ag) = -0.0997878828347872
cycle= 9 E= -75.319559883367  delta_E= -2.84e-14  |g|= 2.12e-08  |ddm|= 1.59e-06
HOMO (B3u) = -0.39988010348895  LUMO (Ag) = -0.099787891204586
cycle= 10 E= -75.319559883367  delta_E= 5.68e-14  |g|= 3.19e-09  |ddm|= 7.71e-08
HOMO (B2u) = -0.399880104501737  LUMO (Ag) = -0.0997878922046052
cycle= 11 E= -75.319559883367  delta_E= 2.84e-14  |g|= 2.56e-09  |ddm|= 3.76e-09
HOMO (B3u) = -0.3998801042019  LUMO (Ag) = -0.0997878918241326
cycle= 12 E= -75.319559883367  delta_E= -5.68e-14  |g|= 1.87e-09  |ddm|= 2.62e-09
HOMO (B3u) = -0.3998801041695  LUMO (Ag) = -0.0997878916913075
cycle= 13 E= -75.319559883367  delta_E= 2.84e-14  |g|= 1.58e-09  |ddm|= 1.58e-09
HOMO (B2u) = -0.399880104126448  LUMO (Ag) = -0.0997878916467185
cycle= 14 E= -75.3195598833671  delta_E= -8.53e-14  |g|= 1.31e-09  |ddm|= 1.08e-09
HOMO (B3u) = -0.399880104099344  LUMO (Ag) = -0.0997878916237404
cycle= 15 E= -75.3195598833671  delta_E= -2.84e-14  |g|= 1.11e-09  |ddm|= 6.95e-10
HOMO (B3u) = -0.399880104088563  LUMO (Ag) = -0.0997878916356517
cycle= 16 E= -75.319559883367  delta_E= 5.68e-14  |g|= 9.99e-10  |ddm|= 9.16e-10
HOMO (B3u) = -0.399880104057797  LUMO (Ag) = -0.0997878916090108
cycle= 17 E= -75.319559883367  delta_E= 2.84e-14  |g|= 9.25e-10  |ddm|= 3.25e-10
HOMO (B3u) = -0.399880103906762  LUMO (Ag) = -0.0997878914692033
cycle= 18 E= -75.319559883367  delta_E= 2.84e-14  |g|= 4.03e-10  |ddm|= 2.15e-09
HOMO (B3u) = -0.399880103907834  LUMO (Ag) = -0.0997878914632216
cycle= 19 E= -75.319559883367  delta_E= -2.84e-14  |g|= 3.3e-10  |ddm|= 3.17e-10
HOMO (B3u) = -0.399880103926897  LUMO (Ag) = -0.0997878914762066
cycle= 20 E= -75.319559883367  delta_E= -2.84e-14  |g|= 2.63e-10  |ddm|= 2.22e-10
HOMO (B3u) = -0.399880103938436  LUMO (Ag) = -0.099787891483061
cycle= 21 E= -75.319559883367  delta_E= 8.53e-14  |g|= 2.17e-10  |ddm|= 1.64e-10
HOMO (B3u) = -0.399880103945862  LUMO (Ag) = -0.0997878914896374
cycle= 22 E= -75.319559883367  delta_E= -2.84e-14  |g|= 1.75e-10  |ddm|= 1.3e-10
HOMO (B3u) = -0.399880103951579  LUMO (Ag) = -0.0997878914949655
cycle= 23 E= -75.3195598833671  delta_E= -8.53e-14  |g|= 1.42e-10  |ddm|= 1.08e-10
HOMO (B3u) = -0.399880103957385  LUMO (Ag) = -0.0997878915007694
cycle= 24 E= -75.3195598833671  delta_E=    0  |g|= 1.14e-10  |ddm|= 1.04e-10
HOMO (B3u) = -0.399880103962241  LUMO (Ag) = -0.0997878915048118
cycle= 25 E= -75.319559883367  delta_E= 1.14e-13  |g|= 8.74e-11  |ddm|= 8.41e-11
HOMO (B3u) = -0.399880103965917  LUMO (Ag) = -0.0997878915075901
cycle= 26 E= -75.319559883367  delta_E= -8.53e-14  |g|= 6.23e-11  |ddm|= 7.74e-11
HOMO (B3u) = -0.39988010396451  LUMO (Ag) = -0.0997878915053053
cycle= 27 E= -75.3195598833671  delta_E= -2.84e-14  |g|= 5.07e-11  |ddm|= 2.68e-11
HOMO (B3u) = -0.399880103962882  LUMO (Ag) = -0.09978789150306
cycle= 28 E= -75.319559883367  delta_E= 1.14e-13  |g|= 4.1e-11  |ddm|= 2.02e-11
HOMO (B3u) = -0.399880103961743  LUMO (Ag) = -0.0997878915015541
cycle= 29 E= -75.319559883367  delta_E= -5.68e-14  |g|= 3.31e-11  |ddm|= 1.6e-11
HOMO (B3u) = -0.399880103960874  LUMO (Ag) = -0.0997878915005048
cycle= 30 E= -75.319559883367  delta_E= -2.84e-14  |g|= 2.65e-11  |ddm|= 1.28e-11
HOMO (B3u) = -0.399880103960276  LUMO (Ag) = -0.099787891499752
cycle= 31 E= -75.3195598833671  delta_E= -5.68e-14  |g|= 2.11e-11  |ddm|= 1.03e-11
HOMO (B3u) = -0.399880103959892  LUMO (Ag) = -0.0997878914992199
cycle= 32 E= -75.3195598833671  delta_E=    0  |g|= 1.67e-11  |ddm|= 8.15e-12
HOMO (B3u) = -0.399880103959711  LUMO (Ag) = -0.09978789149839
Extra cycle  E= -75.319559883367  delta_E= 1.14e-13  |g|= 5.45e-12  |ddm|= 1.9e-11
converged SCF energy = -75.319559883367

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpmclrq2d1
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5069071999528  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5287942623679  dE = -0.021887062  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.72  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5408991693837  dE = -0.012104907  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0689  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5490639029586  dE = -0.0081647336  S^2 = 0.0000000
               |grad[o]|=0.093  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5550610059882  dE = -0.005997103  S^2 = 0.0000000
               |grad[o]|=0.0741  |ddm|=0.0189  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5595129978643  dE = -0.0044519919  S^2 = 0.0000000
               |grad[o]|=0.0577  |ddm|=0.0126  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5626837707573  dE = -0.0031707729  S^2 = 0.0000000
               |grad[o]|=0.043  |ddm|=0.00882  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5647161334022  dE = -0.0020323626  S^2 = 0.0000000
               |grad[o]|=0.0294  |ddm|=0.00676  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5657087101237  dE = -0.00099257672  S^2 = 0.0000000
               |grad[o]|=0.0169  |ddm|=0.00658  |maxRot[o]|=0.0799
macro iter 9 (4 JK  0 micro), CASSCF E = -75.565845329849  dE = -0.00013661973  S^2 = 0.0000000
               |grad[o]|=0.00539  |ddm|=0.00791  |maxRot[o]|= 0.04
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5658470539865  dE = -1.7241375e-06  S^2 = 0.0000000
               |grad[o]|=0.000739  |ddm|=0.00486  |maxRot[o]|=0.00387
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5658470909477  dE = -3.6961183e-08  S^2 = 0.0000000
               |grad[o]|=0.000114  |ddm|=0.000648  |maxRot[o]|=0.000437
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5658470916858  dE = -7.3808337e-10  S^2 = 0.0000000
               |grad[o]|=1.91e-05  |ddm|=8.13e-05  |maxRot[o]|=6.69e-05
macro iter 13 (3 JK  0 micro), CASSCF E = -75.565847091702  dE = -1.6228796e-11  S^2 = 0.0000000
               |grad[o]|=2.73e-06  |ddm|=1.31e-05  |maxRot[o]|=1.18e-05
2-step CASSCF converged in 13 macro (64 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97493415 1.71266198 1.80127968 1.80128063 0.2974251  0.1948301
 0.19483039 0.02275797]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00688   0.00368   0.00000   0.00000  -0.00082
  0 C 2s       0.62688   0.59446  -0.00000  -0.00000  -0.32511
  0 C 3s      -0.02821   0.00928  -0.00000  -0.00000   0.01701
  0 C 2px      0.00000  -0.00000  -0.00000   0.70649   0.00000
  0 C 2py     -0.00000  -0.00000   0.70649  -0.00000   0.00000
  0 C 2pz      0.32333  -0.38275   0.00000  -0.00000   0.62577
  0 C 3px      0.00000  -0.00000   0.00000   0.01921   0.00000
  0 C 3py     -0.00000   0.00000   0.01921   0.00000  -0.00000
  0 C 3pz     -0.02927  -0.00203  -0.00000  -0.00000  -0.04115
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02251   0.00000  -0.00000
  0 C 3dz^2    0.02800  -0.00269  -0.00000  -0.00000   0.02714
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02251   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00688  -0.00368   0.00000   0.00000  -0.00082
  1 C 2s       0.62688  -0.59446   0.00000   0.00000  -0.32511
  1 C 3s      -0.02821  -0.00928   0.00000   0.00000   0.01701
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70649  -0.00000
  1 C 2py      0.00000  -0.00000   0.70649  -0.00000   0.00000
  1 C 2pz     -0.32333  -0.38275  -0.00000  -0.00000  -0.62577
  1 C 3px     -0.00000   0.00000   0.00000   0.01921  -0.00000
  1 C 3py      0.00000  -0.00000   0.01921   0.00000  -0.00000
  1 C 3pz      0.02927  -0.00203  -0.00000  -0.00000   0.04115
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02251  -0.00000  -0.00000
  1 C 3dz^2    0.02800   0.00269  -0.00000   0.00000   0.02714
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02251   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.38221
  0 C 3s      -0.00000  -0.00000  -0.04321
  0 C 2px      0.70662  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70662  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.59260
  0 C 3px     -0.01471  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01471  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02126
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02171  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02074
  0 C 3dxz    -0.02171  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.38221
  1 C 3s       0.00000   0.00000   0.04321
  1 C 2px     -0.70662   0.00000   0.00000
  1 C 2py      0.00000  -0.70662   0.00000
  1 C 2pz     -0.00000  -0.00000   0.59260
  1 C 3px      0.01471   0.00000   0.00000
  1 C 3py      0.00000   0.01471   0.00000
  1 C 3pz     -0.00000  -0.00000   0.02126
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02171  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02074
  1 C 3dxz    -0.02171  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99150096
<CAS-nat-orb|mo-hf>  4  4    0.99751312
<CAS-nat-orb|mo-hf>  5  5    0.99943968
<CAS-nat-orb|mo-hf>  6  6    0.99943968
<CAS-nat-orb|mo-hf>  7  7    0.97389130
<CAS-nat-orb|mo-hf>  8  8    0.97085576
<CAS-nat-orb|mo-hf>  9  9    0.97085580
<CAS-nat-orb|mo-hf>  10  10    0.72379474
<CAS-nat-orb|mo-hf>  10  14   -0.61908421
CASSCF energy = -75.565847091702
CASCI E = -75.565847091702  E(CI) = -16.3640995525053  S^2 = 0.0000000
Time cost =    318.424
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:14:43 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.561072772214 AA    0.000000000000   0.000000000000   2.950000000000 Bohr   0.0

nuclear repulsion = 12.2033898305085
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.475]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     11061.91


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpe5h7n9lh
max_memory 4000 MB (current use 174 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0186954217207

WARN: Singularity detected in overlap matrix (condition number =  236). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.165974687131635  LUMO (Ag) = -0.158079543422895
cycle= 1 E= -75.2873378760354  delta_E= -0.269  |g|= 0.239  |ddm|= 1.43
HOMO (B3u) = -0.431571893819984  LUMO (Ag) = -0.149790781563184
cycle= 2 E= -75.3090731833374  delta_E= -0.0217  |g|= 0.0507  |ddm|= 0.316
HOMO (B2u) = -0.393547996937857  LUMO (Ag) = -0.100989331184848
cycle= 3 E= -75.3100918952135  delta_E= -0.00102  |g|= 0.0127  |ddm|= 0.0544
HOMO (B3u) = -0.39507505412911  LUMO (Ag) = -0.0978528282721971
cycle= 4 E= -75.3101958879617  delta_E= -0.000104  |g|= 0.00229  |ddm|= 0.0157
HOMO (B3u) = -0.395838291352907  LUMO (Ag) = -0.0984379062399655
cycle= 5 E= -75.3101998099164  delta_E= -3.92e-06  |g|= 0.000326  |ddm|= 0.00328
HOMO (B2u) = -0.3957689454445  LUMO (Ag) = -0.0983739814936226
cycle= 6 E= -75.3101998734465  delta_E= -6.35e-08  |g|= 4.1e-05  |ddm|= 0.000649
HOMO (B3u) = -0.395760954503399  LUMO (Ag) = -0.0983611341563391
cycle= 7 E= -75.3101998745662  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000143
HOMO (B3u) = -0.395760469633681  LUMO (Ag) = -0.0983600611975495
cycle= 8 E= -75.3101998745821  delta_E= -1.59e-11  |g|= 5.2e-07  |ddm|= 2.23e-05
HOMO (B2u) = -0.395760436404884  LUMO (Ag) = -0.0983598792416474
cycle= 9 E= -75.3101998745822  delta_E= -7.11e-14  |g|= 2.17e-08  |ddm|= 1.39e-06
HOMO (B3u) = -0.395760429248385  LUMO (Ag) = -0.0983598897706416
cycle= 10 E= -75.3101998745821  delta_E= 7.11e-14  |g|= 3.33e-09  |ddm|= 8.05e-08
HOMO (B3u) = -0.395760430304136  LUMO (Ag) = -0.0983598908369099
cycle= 11 E= -75.3101998745822  delta_E= -8.53e-14  |g|= 2.6e-09  |ddm|= 4.09e-09
HOMO (B3u) = -0.395760430028107  LUMO (Ag) = -0.0983598904797366
cycle= 12 E= -75.3101998745823  delta_E= -1.14e-13  |g|= 1.93e-09  |ddm|= 2.77e-09
HOMO (B3u) = -0.395760430002556  LUMO (Ag) = -0.0983598903276781
cycle= 13 E= -75.3101998745822  delta_E= 9.95e-14  |g|= 1.68e-09  |ddm|= 1.58e-09
HOMO (B3u) = -0.395760429957168  LUMO (Ag) = -0.0983598902855991
cycle= 14 E= -75.3101998745822  delta_E= 4.26e-14  |g|= 1.39e-09  |ddm|= 1.05e-09
HOMO (B3u) = -0.395760429928719  LUMO (Ag) = -0.0983598902667159
cycle= 15 E= -75.3101998745822  delta_E=    0  |g|= 1.19e-09  |ddm|= 8.01e-10
HOMO (B3u) = -0.395760429920272  LUMO (Ag) = -0.0983598902715134
cycle= 16 E= -75.3101998745822  delta_E=    0  |g|= 1.05e-09  |ddm|= 8.37e-10
HOMO (B3u) = -0.395760429891974  LUMO (Ag) = -0.0983598902481687
cycle= 17 E= -75.3101998745821  delta_E= 2.84e-14  |g|= 9.59e-10  |ddm|= 3.86e-10
HOMO (B3u) = -0.39576042973451  LUMO (Ag) = -0.0983598901195317
cycle= 18 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 4.21e-10  |ddm|= 2.31e-09
HOMO (B3u) = -0.395760429735042  LUMO (Ag) = -0.098359890113291
cycle= 19 E= -75.3101998745822  delta_E= -7.11e-14  |g|= 3.44e-10  |ddm|= 3.34e-10
HOMO (B3u) = -0.39576042975363  LUMO (Ag) = -0.0983598901263567
cycle= 20 E= -75.3101998745823  delta_E= -5.68e-14  |g|= 2.78e-10  |ddm|= 2.31e-10
HOMO (B3u) = -0.395760429765384  LUMO (Ag) = -0.0983598901333076
cycle= 21 E= -75.3101998745822  delta_E= 8.53e-14  |g|= 2.3e-10  |ddm|= 1.69e-10
HOMO (B3u) = -0.395760429772475  LUMO (Ag) = -0.0983598901403576
cycle= 22 E= -75.3101998745822  delta_E= 2.84e-14  |g|= 1.86e-10  |ddm|= 1.35e-10
HOMO (B3u) = -0.395760429777979  LUMO (Ag) = -0.0983598901460532
cycle= 23 E= -75.3101998745822  delta_E= -2.84e-14  |g|= 1.5e-10  |ddm|= 1.13e-10
HOMO (B2u) = -0.395760429783946  LUMO (Ag) = -0.0983598901525288
cycle= 24 E= -75.3101998745822  delta_E=    0  |g|= 1.19e-10  |ddm|= 1.11e-10
HOMO (B3u) = -0.395760429789077  LUMO (Ag) = -0.0983598901577837
cycle= 25 E= -75.3101998745822  delta_E= -1.42e-14  |g|= 9.16e-11  |ddm|= 9.3e-11
HOMO (B3u) = -0.395760429793058  LUMO (Ag) = -0.0983598901618006
cycle= 26 E= -75.3101998745822  delta_E= 4.26e-14  |g|= 6.58e-11  |ddm|= 8.5e-11
HOMO (B3u) = -0.395760429791687  LUMO (Ag) = -0.0983598901597293
cycle= 27 E= -75.3101998745823  delta_E= -8.53e-14  |g|= 5.37e-11  |ddm|= 2.89e-11
HOMO (B2u) = -0.395760429790051  LUMO (Ag) = -0.0983598901576454
cycle= 28 E= -75.3101998745822  delta_E= 1.14e-13  |g|= 4.36e-11  |ddm|= 2.17e-11
HOMO (B2u) = -0.39576042978886  LUMO (Ag) = -0.0983598901562577
cycle= 29 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 3.53e-11  |ddm|= 1.73e-11
HOMO (B2u) = -0.395760429787927  LUMO (Ag) = -0.0983598901553376
cycle= 30 E= -75.3101998745822  delta_E=    0  |g|= 2.81e-11  |ddm|= 1.4e-11
HOMO (B3u) = -0.395760429786634  LUMO (Ag) = -0.0983598901538419
Extra cycle  E= -75.3101998745822  delta_E= 5.68e-14  |g|= 9.01e-12  |ddm|= 3.51e-11
converged SCF energy = -75.3101998745822

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpe5h7n9lh
max_memory 4000 MB (current use 176 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4998295378019  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5213335335806  dE = -0.021503996  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5334161381999  dE = -0.012082605  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0682  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5415789229072  dE = -0.0081627847  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0323  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5475124010106  dE = -0.0059334781  S^2 = 0.0000000
               |grad[o]|=0.0732  |ddm|=0.0196  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.551825725734  dE = -0.0043133247  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0131  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5547913705203  dE = -0.0029656448  S^2 = 0.0000000
               |grad[o]|=0.0409  |ddm|=0.00918  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5565626349574  dE = -0.0017712644  S^2 = 0.0000000
               |grad[o]|=0.0267  |ddm|=0.00732  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5571750232566  dE = -0.0006123883  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00767  |maxRot[o]|= 0.06
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5572696087177  dE = -9.4585461e-05  S^2 = 0.0000000
               |grad[o]|=0.00458  |ddm|=0.00702  |maxRot[o]|=0.0325
macro iter 10 (3 JK  0 micro), CASSCF E = -75.55727072122  dE = -1.1125023e-06  S^2 = 0.0000000
               |grad[o]|=0.000629  |ddm|=0.00451  |maxRot[o]|=0.00289
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5572707457967  dE = -2.4576707e-08  S^2 = 0.0000000
               |grad[o]|=9.69e-05  |ddm|=0.000585  |maxRot[o]|=0.000339
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5572707462855  dE = -4.8879656e-10  S^2 = 0.0000000
               |grad[o]|=1.64e-05  |ddm|=7.43e-05  |maxRot[o]|=4.96e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5572707462967  dE = -1.1155521e-11  S^2 = 0.0000000
               |grad[o]|=2.45e-06  |ddm|=1.14e-05  |maxRot[o]|=8.68e-06
2-step CASSCF converged in 13 macro (62 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97414482 1.72120466 1.79044226 1.79044094 0.29254404 0.20379322
 0.20379325 0.02363682]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00710   0.00377   0.00000   0.00000  -0.00079
  0 C 2s       0.62989   0.60047   0.00000   0.00000  -0.31937
  0 C 3s      -0.02627   0.00941  -0.00000   0.00000   0.01911
  0 C 2px     -0.00000   0.00000   0.00000   0.70646  -0.00000
  0 C 2py      0.00000  -0.00000   0.70646   0.00000  -0.00000
  0 C 2pz      0.31779  -0.37325   0.00000   0.00000   0.62862
  0 C 3px     -0.00000   0.00000  -0.00000   0.02107  -0.00000
  0 C 3py      0.00000  -0.00000   0.02107  -0.00000  -0.00000
  0 C 3pz     -0.02764  -0.00196  -0.00000   0.00000  -0.04016
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02166  -0.00000  -0.00000
  0 C 3dz^2    0.02729  -0.00296  -0.00000   0.00000   0.02921
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02166  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00710  -0.00377   0.00000   0.00000  -0.00079
  1 C 2s       0.62989  -0.60047   0.00000  -0.00000  -0.31937
  1 C 3s      -0.02627  -0.00941  -0.00000  -0.00000   0.01911
  1 C 2px      0.00000   0.00000   0.00000   0.70646   0.00000
  1 C 2py      0.00000   0.00000   0.70646   0.00000   0.00000
  1 C 2pz     -0.31779  -0.37325   0.00000   0.00000  -0.62862
  1 C 3px      0.00000  -0.00000  -0.00000   0.02107   0.00000
  1 C 3py     -0.00000   0.00000   0.02107   0.00000   0.00000
  1 C 3pz      0.02764  -0.00196   0.00000   0.00000   0.04016
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02166  -0.00000  -0.00000
  1 C 3dz^2    0.02729   0.00296  -0.00000  -0.00000   0.02921
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02166  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00027
  0 C 2s       0.00000   0.00000   0.37274
  0 C 3s       0.00000  -0.00000  -0.04290
  0 C 2px      0.70665  -0.00000   0.00000
  0 C 2py     -0.00000   0.70665   0.00000
  0 C 2pz      0.00000  -0.00000   0.59862
  0 C 3px     -0.01384   0.00000   0.00000
  0 C 3py      0.00000  -0.01384  -0.00000
  0 C 3pz      0.00000  -0.00000   0.02142
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02139  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02055
  0 C 3dxz    -0.02139   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00027
  1 C 2s      -0.00000   0.00000  -0.37274
  1 C 3s      -0.00000   0.00000   0.04290
  1 C 2px     -0.70665   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70665   0.00000
  1 C 2pz      0.00000   0.00000   0.59862
  1 C 3px      0.01384   0.00000  -0.00000
  1 C 3py      0.00000   0.01384   0.00000
  1 C 3pz      0.00000  -0.00000   0.02142
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02139  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02055
  1 C 3dxz    -0.02139  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99129326
<CAS-nat-orb|mo-hf>  4  4    0.99742902
<CAS-nat-orb|mo-hf>  5  5    0.99939339
<CAS-nat-orb|mo-hf>  6  6    0.99939339
<CAS-nat-orb|mo-hf>  7  7    0.97366309
<CAS-nat-orb|mo-hf>  8  8    0.97269186
<CAS-nat-orb|mo-hf>  9  9    0.97269185
<CAS-nat-orb|mo-hf>  10  10    0.74746745
<CAS-nat-orb|mo-hf>  10  14   -0.59840371
CASSCF energy = -75.5572707462967
CASCI E = -75.5572707462967  E(CI) = -16.2620310686448  S^2 = 0.0000000
Time cost =    186.491
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:17:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.587531632760 AA    0.000000000000   0.000000000000   3.000000000000 Bohr   0.0

nuclear repulsion = 12
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.5]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     11526.23


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpk8ew11zv
max_memory 4000 MB (current use 176 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9888325390205

WARN: Singularity detected in overlap matrix (condition number =  219). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.16026848860678  LUMO (Ag) = -0.156209924431072
cycle= 1 E= -75.2773690146387  delta_E= -0.289  |g|= 0.241  |ddm|= 1.43
HOMO (B2u) = -0.427459076932468  LUMO (Ag) = -0.148855300078026
cycle= 2 E= -75.2996288397617  delta_E= -0.0223  |g|= 0.0503  |ddm|= 0.321
HOMO (B3u) = -0.389387614274558  LUMO (Ag) = -0.099336073697242
cycle= 3 E= -75.3006548036907  delta_E= -0.00103  |g|= 0.013  |ddm|= 0.0545
HOMO (B2u) = -0.391075001807692  LUMO (Ag) = -0.0963133132876635
cycle= 4 E= -75.3007634017489  delta_E= -0.000109  |g|= 0.00228  |ddm|= 0.0159
HOMO (B2u) = -0.391819817512153  LUMO (Ag) = -0.0969078799501817
cycle= 5 E= -75.3007673195955  delta_E= -3.92e-06  |g|= 0.000327  |ddm|= 0.00318
HOMO (B2u) = -0.391752968347542  LUMO (Ag) = -0.096851802087953
cycle= 6 E= -75.3007673825197  delta_E= -6.29e-08  |g|= 4.07e-05  |ddm|= 0.000647
HOMO (B2u) = -0.39174516367823  LUMO (Ag) = -0.0968392001457734
cycle= 7 E= -75.3007673836115  delta_E= -1.09e-09  |g|= 5.16e-06  |ddm|= 0.00013
HOMO (B2u) = -0.391744579298895  LUMO (Ag) = -0.0968381087429695
cycle= 8 E= -75.3007673836275  delta_E= -1.6e-11  |g|= 5.37e-07  |ddm|= 2.12e-05
HOMO (B2u) = -0.391744545069372  LUMO (Ag) = -0.0968379095780896
cycle= 9 E= -75.3007673836276  delta_E= -9.95e-14  |g|= 2.23e-08  |ddm|= 1.2e-06
HOMO (B3u) = -0.391744537674297  LUMO (Ag) = -0.0968379222718539
cycle= 10 E= -75.3007673836276  delta_E=    0  |g|= 3.48e-09  |ddm|= 8.33e-08
HOMO (B3u) = -0.391744538795834  LUMO (Ag) = -0.0968379234294464
cycle= 11 E= -75.3007673836276  delta_E=    0  |g|= 2.62e-09  |ddm|= 4.63e-09
HOMO (B3u) = -0.391744538515913  LUMO (Ag) = -0.0968379230673844
cycle= 12 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 1.99e-09  |ddm|= 2.59e-09
HOMO (B3u) = -0.391744538504666  LUMO (Ag) = -0.0968379229058467
cycle= 13 E= -75.3007673836276  delta_E=    0  |g|= 1.76e-09  |ddm|= 1.66e-09
HOMO (B3u) = -0.391744538455682  LUMO (Ag) = -0.0968379228636286
cycle= 14 E= -75.3007673836276  delta_E= 2.84e-14  |g|= 1.47e-09  |ddm|= 9.97e-10
HOMO (B2u) = -0.391744538422498  LUMO (Ag) = -0.0968379228448963
cycle= 15 E= -75.3007673836276  delta_E= 1.42e-14  |g|= 1.27e-09  |ddm|= 8.87e-10
HOMO (B3u) = -0.391744538401586  LUMO (Ag) = -0.0968379228357427
cycle= 16 E= -75.3007673836276  delta_E=    0  |g|= 1.14e-09  |ddm|= 6.85e-10
HOMO (B3u) = -0.391744538389929  LUMO (Ag) = -0.0968379228223839
cycle= 17 E= -75.3007673836275  delta_E= 1.42e-14  |g|= 1e-09  |ddm|= 4.97e-10
HOMO (B2u) = -0.39174453822974  LUMO (Ag) = -0.0968379227085874
cycle= 18 E= -75.3007673836276  delta_E= -4.26e-14  |g|= 4.4e-10  |ddm|= 2.45e-09
HOMO (B2u) = -0.391744538229686  LUMO (Ag) = -0.0968379227021052
cycle= 19 E= -75.3007673836277  delta_E= -9.95e-14  |g|= 3.6e-10  |ddm|= 3.48e-10
HOMO (B3u) = -0.391744538248111  LUMO (Ag) = -0.0968379227155031
cycle= 20 E= -75.3007673836277  delta_E= 2.84e-14  |g|= 2.95e-10  |ddm|= 2.31e-10
HOMO (B2u) = -0.391744538259923  LUMO (Ag) = -0.0968379227224788
cycle= 21 E= -75.3007673836277  delta_E=    0  |g|= 2.47e-10  |ddm|= 1.72e-10
HOMO (B2u) = -0.39174453826667  LUMO (Ag) = -0.0968379227299633
cycle= 22 E= -75.3007673836277  delta_E= -2.84e-14  |g|= 2e-10  |ddm|= 1.38e-10
HOMO (B2u) = -0.391744538271912  LUMO (Ag) = -0.0968379227360049
cycle= 23 E= -75.3007673836275  delta_E= 1.42e-13  |g|= 1.62e-10  |ddm|= 1.17e-10
HOMO (B2u) = -0.39174453827785  LUMO (Ag) = -0.0968379227429937
cycle= 24 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 1.28e-10  |ddm|= 1.16e-10
HOMO (B2u) = -0.391744538282641  LUMO (Ag) = -0.0968379227485302
cycle= 25 E= -75.3007673836276  delta_E= -8.53e-14  |g|= 9.73e-11  |ddm|= 1.01e-10
HOMO (B2u) = -0.391744538286843  LUMO (Ag) = -0.0968379227537053
cycle= 26 E= -75.3007673836276  delta_E= 1.42e-14  |g|= 7.05e-11  |ddm|= 9.21e-11
HOMO (B2u) = -0.391744538285516  LUMO (Ag) = -0.0968379227518497
cycle= 27 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 5.8e-11  |ddm|= 3.07e-11
HOMO (B2u) = -0.39174453828388  LUMO (Ag) = -0.0968379227499252
cycle= 28 E= -75.3007673836276  delta_E= 4.26e-14  |g|= 4.74e-11  |ddm|= 2.31e-11
HOMO (B2u) = -0.391744538282657  LUMO (Ag) = -0.0968379227486637
cycle= 29 E= -75.3007673836276  delta_E= 2.84e-14  |g|= 3.85e-11  |ddm|= 1.85e-11
HOMO (B2u) = -0.391744538281678  LUMO (Ag) = -0.0968379227478721
cycle= 30 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 3.07e-11  |ddm|= 1.53e-11
HOMO (B2u) = -0.391744538280995  LUMO (Ag) = -0.0968379227473579
cycle= 31 E= -75.3007673836276  delta_E= 1.42e-14  |g|= 2.44e-11  |ddm|= 1.25e-11
HOMO (B2u) = -0.391744538280547  LUMO (Ag) = -0.0968379227470584
cycle= 32 E= -75.3007673836276  delta_E= -4.26e-14  |g|= 1.93e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.391744538280275  LUMO (Ag) = -0.0968379227468755
cycle= 33 E= -75.3007673836276  delta_E= 5.68e-14  |g|= 1.52e-11  |ddm|= 7.59e-12
HOMO (B2u) = -0.391744538280153  LUMO (Ag) = -0.0968379227467953
cycle= 34 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 1.21e-11  |ddm|= 5.4e-12
HOMO (B2u) = -0.391744538280161  LUMO (Ag) = -0.0968379227467849
cycle= 35 E= -75.3007673836275  delta_E= 5.68e-14  |g|= 9.87e-12  |ddm|= 3.58e-12
HOMO (B2u) = -0.39174453828014  LUMO (Ag) = -0.0968379227467728
cycle= 36 E= -75.3007673836277  delta_E= -1.14e-13  |g|= 8.03e-12  |ddm|= 2.91e-12
HOMO (B3u) = -0.391744538280092  LUMO (Ag) = -0.0968379227467533
cycle= 37 E= -75.3007673836276  delta_E= 8.53e-14  |g|= 6.5e-12  |ddm|= 2.34e-12
HOMO (B2u) = -0.391744538280032  LUMO (Ag) = -0.0968379227467275
cycle= 38 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 5.23e-12  |ddm|= 1.89e-12
HOMO (B3u) = -0.39174453827997  LUMO (Ag) = -0.0968379227466937
cycle= 39 E= -75.3007673836277  delta_E= -1.56e-13  |g|= 4.21e-12  |ddm|= 1.5e-12
HOMO (B3u) = -0.391744538279908  LUMO (Ag) = -0.0968379227466541
cycle= 40 E= -75.3007673836276  delta_E= 1.28e-13  |g|= 3.38e-12  |ddm|= 1.19e-12
HOMO (B3u) = -0.391744538279849  LUMO (Ag) = -0.0968379227466116
cycle= 41 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 2.73e-12  |ddm|= 9.55e-13
HOMO (B3u) = -0.391744538279796  LUMO (Ag) = -0.0968379227465702
cycle= 42 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 2.21e-12  |ddm|= 7.73e-13
HOMO (B2u) = -0.391744538279752  LUMO (Ag) = -0.0968379227465353
cycle= 43 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 1.8e-12  |ddm|= 6.4e-13
HOMO (B2u) = -0.391744538279716  LUMO (Ag) = -0.0968379227465097
cycle= 44 E= -75.3007673836276  delta_E= 4.26e-14  |g|= 1.45e-12  |ddm|= 5.14e-13
HOMO (B3u) = -0.391744538279689  LUMO (Ag) = -0.0968379227464925
cycle= 45 E= -75.3007673836275  delta_E= 4.26e-14  |g|= 1.18e-12  |ddm|= 4.26e-13
HOMO (B3u) = -0.391744538279668  LUMO (Ag) = -0.0968379227464798
cycle= 46 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 9.51e-13  |ddm|= 3.48e-13
HOMO (B2u) = -0.391744538279651  LUMO (Ag) = -0.0968379227464696
cycle= 47 E= -75.3007673836275  delta_E= 1.42e-14  |g|= 7.69e-13  |ddm|= 2.77e-13
HOMO (B2u) = -0.391744538279638  LUMO (Ag) = -0.096837922746462
cycle= 48 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 6.25e-13  |ddm|= 2.29e-13
HOMO (B3u) = -0.391744538279627  LUMO (Ag) = -0.0968379227464556
cycle= 49 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 5.06e-13  |ddm|= 1.98e-13
HOMO (B3u) = -0.391744538279617  LUMO (Ag) = -0.0968379227464503
cycle= 50 E= -75.3007673836275  delta_E= 8.53e-14  |g|= 4.11e-13  |ddm|= 1.53e-13
SCF not converged.
SCF energy = -75.3007673836275

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpk8ew11zv
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4927493145095  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5138848570109  dE = -0.021135543  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5259228808068  dE = -0.012038024  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5340673145621  dE = -0.0081444338  S^2 = 0.0000000
               |grad[o]|=0.0918  |ddm|=0.0329  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5399163566853  dE = -0.0058490421  S^2 = 0.0000000
               |grad[o]|=0.0719  |ddm|=0.0206  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5440667830672  dE = -0.0041504264  S^2 = 0.0000000
               |grad[o]|=0.0544  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5467996670403  dE = -0.002732884  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00993  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.548278320708  dE = -0.0014786537  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00842  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5486404656313  dE = -0.00036214492  S^2 = 0.0000000
               |grad[o]|=0.00986  |ddm|=0.00938  |maxRot[o]|= 0.06
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5486450984633  dE = -4.632832e-06  S^2 = 0.0000000
               |grad[o]|=0.00124  |ddm|=0.0088  |maxRot[o]|=0.00593
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5486452003137  dE = -1.0185039e-07  S^2 = 0.0000000
               |grad[o]|=0.000216  |ddm|=0.00137  |maxRot[o]|=0.00062
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5486452023076  dE = -1.9939534e-09  S^2 = 0.0000000
               |grad[o]|=3.57e-05  |ddm|=0.000184  |maxRot[o]|=8.97e-05
macro iter 12 (3 JK  0 micro), CASSCF E = -75.548645202353  dE = -4.5332627e-11  S^2 = 0.0000000
               |grad[o]|=5.19e-06  |ddm|=2.78e-05  |maxRot[o]|=1.6e-05
2-step CASSCF converged in 12 macro (59 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97338733 1.72966171 1.77895355 1.77895233 0.28849582 0.21301943
 0.21301931 0.02451051]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00731   0.00385   0.00000   0.00000  -0.00077
  0 C 2s       0.63288   0.60630   0.00000  -0.00000  -0.31355
  0 C 3s      -0.02435   0.00955  -0.00000  -0.00000   0.02103
  0 C 2px      0.00000  -0.00000  -0.00000   0.70643  -0.00000
  0 C 2py     -0.00000   0.00000   0.70643   0.00000  -0.00000
  0 C 2pz      0.31214  -0.36370  -0.00000  -0.00000   0.63146
  0 C 3px      0.00000  -0.00000  -0.00000   0.02283  -0.00000
  0 C 3py      0.00000  -0.00000   0.02283   0.00000  -0.00000
  0 C 3pz     -0.02602  -0.00192  -0.00000  -0.00000  -0.03894
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02081   0.00000  -0.00000
  0 C 3dz^2    0.02662  -0.00320  -0.00000  -0.00000   0.03135
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02081  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00731  -0.00385   0.00000   0.00000  -0.00077
  1 C 2s       0.63288  -0.60630   0.00000   0.00000  -0.31355
  1 C 3s      -0.02435  -0.00955   0.00000   0.00000   0.02103
  1 C 2px     -0.00000   0.00000   0.00000   0.70643   0.00000
  1 C 2py      0.00000   0.00000   0.70643  -0.00000   0.00000
  1 C 2pz     -0.31214  -0.36370   0.00000   0.00000  -0.63146
  1 C 3px     -0.00000   0.00000   0.00000   0.02283   0.00000
  1 C 3py      0.00000  -0.00000   0.02283  -0.00000   0.00000
  1 C 3pz      0.02602  -0.00192  -0.00000  -0.00000   0.03894
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02081   0.00000  -0.00000
  1 C 3dz^2    0.02662   0.00320   0.00000   0.00000   0.03135
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02081  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s       0.00000   0.00000   0.36324
  0 C 3s      -0.00000   0.00000  -0.04243
  0 C 2px      0.70668   0.00000  -0.00000
  0 C 2py     -0.00000   0.70668  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.60447
  0 C 3px     -0.01294  -0.00000   0.00000
  0 C 3py      0.00000  -0.01294   0.00000
  0 C 3pz     -0.00000   0.00000   0.02137
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02104   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02031
  0 C 3dxz    -0.02104  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000  -0.00000  -0.36324
  1 C 3s       0.00000  -0.00000   0.04243
  1 C 2px     -0.70668   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70668  -0.00000
  1 C 2pz      0.00000   0.00000   0.60447
  1 C 3px      0.01294  -0.00000   0.00000
  1 C 3py      0.00000   0.01294  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02137
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02104   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02031
  1 C 3dxz    -0.02104   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99111461
<CAS-nat-orb|mo-hf>  4  4    0.99735746
<CAS-nat-orb|mo-hf>  5  5    0.99934482
<CAS-nat-orb|mo-hf>  6  6    0.99934482
<CAS-nat-orb|mo-hf>  7  7    0.97351400
<CAS-nat-orb|mo-hf>  8  8    0.97438519
<CAS-nat-orb|mo-hf>  9  9    0.97438516
<CAS-nat-orb|mo-hf>  10  10    0.76990744
<CAS-nat-orb|mo-hf>  10  14   -0.57655943
CASSCF energy = -75.548645202353
CASCI E = -75.548645202353  E(CI) = -16.163032725908  S^2 = 0.0000000
Time cost =     88.529
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:19:18 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.613990493306 AA    0.000000000000   0.000000000000   3.050000000000 Bohr   0.0

nuclear repulsion = 11.8032786885246
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.525]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     11575.95


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp436rg_b6
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9606241516019

WARN: Singularity detected in overlap matrix (condition number =  203). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.154846704479716  LUMO (Ag) = -0.154379304561516

WARN: Ag LUMO -0.154379304561516 < system HOMO -0.154846704479716


WARN: B2u HOMO -0.154846704479716 > system LUMO -0.154379304561516


WARN: B3u HOMO -0.154846704479716 > system LUMO -0.154379304561516

cycle= 1 E= -75.2674224197194  delta_E= -0.307  |g|= 0.242  |ddm|= 1.42
HOMO (B3u) = -0.423431408188683  LUMO (Ag) = -0.147745494594372
cycle= 2 E= -75.2901719236938  delta_E= -0.0227  |g|= 0.0499  |ddm|= 0.326
HOMO (B2u) = -0.385318413495457  LUMO (Ag) = -0.0975529483033098
cycle= 3 E= -75.2912021417109  delta_E= -0.00103  |g|= 0.0132  |ddm|= 0.0546
HOMO (B3u) = -0.387177687087388  LUMO (Ag) = -0.0946950408357176
cycle= 4 E= -75.291314408399  delta_E= -0.000112  |g|= 0.00225  |ddm|= 0.0161
HOMO (B2u) = -0.387899311052257  LUMO (Ag) = -0.0952945928883278
cycle= 5 E= -75.2913182764059  delta_E= -3.87e-06  |g|= 0.000326  |ddm|= 0.00311
HOMO (B3u) = -0.387835444387874  LUMO (Ag) = -0.0952466102829206
cycle= 6 E= -75.2913183380417  delta_E= -6.16e-08  |g|= 4.01e-05  |ddm|= 0.000644
HOMO (B3u) = -0.387827943274183  LUMO (Ag) = -0.0952344140423366
cycle= 7 E= -75.2913183390841  delta_E= -1.04e-09  |g|= 5.01e-06  |ddm|= 0.000118
HOMO (B3u) = -0.387827276401274  LUMO (Ag) = -0.0952333329362507
cycle= 8 E= -75.2913183390996  delta_E= -1.56e-11  |g|= 5.51e-07  |ddm|= 1.99e-05
HOMO (B3u) = -0.387827240724834  LUMO (Ag) = -0.095233116988804
cycle= 9 E= -75.2913183390998  delta_E= -1.56e-13  |g|= 2.29e-08  |ddm|= 1.04e-06
HOMO (B3u) = -0.387827233118364  LUMO (Ag) = -0.0952331317889693
cycle= 10 E= -75.2913183390998  delta_E= 4.26e-14  |g|= 3.63e-09  |ddm|= 8.55e-08
HOMO (B3u) = -0.387827234291159  LUMO (Ag) = -0.0952331330214404
cycle= 11 E= -75.2913183390998  delta_E= -1.42e-14  |g|= 2.64e-09  |ddm|= 5.05e-09
HOMO (B3u) = -0.387827234009969  LUMO (Ag) = -0.0952331326582959
cycle= 12 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 2.05e-09  |ddm|= 2.38e-09
HOMO (B3u) = -0.387827234017244  LUMO (Ag) = -0.0952331324924012
cycle= 13 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 1.85e-09  |ddm|= 1.76e-09
HOMO (B3u) = -0.387827233970916  LUMO (Ag) = -0.0952331324569916
cycle= 14 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 1.55e-09  |ddm|= 9.87e-10
HOMO (B3u) = -0.387827233948743  LUMO (Ag) = -0.0952331324596885
cycle= 15 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 1.35e-09  |ddm|= 1.05e-09
HOMO (B3u) = -0.387827233907007  LUMO (Ag) = -0.0952331324190585
cycle= 16 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 1.21e-09  |ddm|= 4.03e-10
HOMO (B3u) = -0.387827233900506  LUMO (Ag) = -0.0952331324084349
cycle= 17 E= -75.2913183390997  delta_E=    0  |g|= 1.05e-09  |ddm|= 5.32e-10
HOMO (B3u) = -0.387827233741218  LUMO (Ag) = -0.0952331323123442
cycle= 18 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 4.6e-10  |ddm|= 2.57e-09
HOMO (B3u) = -0.38782723374055  LUMO (Ag) = -0.0952331323055759
cycle= 19 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 3.76e-10  |ddm|= 3.58e-10
HOMO (B2u) = -0.387827233758577  LUMO (Ag) = -0.0952331323190825
cycle= 20 E= -75.2913183390997  delta_E= 7.11e-14  |g|= 3.11e-10  |ddm|= 2.31e-10
HOMO (B2u) = -0.387827233770216  LUMO (Ag) = -0.0952331323259752
cycle= 21 E= -75.2913183390998  delta_E= -7.11e-14  |g|= 2.63e-10  |ddm|= 1.75e-10
HOMO (B2u) = -0.38782723377646  LUMO (Ag) = -0.0952331323338177
cycle= 22 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 2.14e-10  |ddm|= 1.41e-10
HOMO (B2u) = -0.387827233781412  LUMO (Ag) = -0.0952331323401964
cycle= 23 E= -75.2913183390997  delta_E= 1.14e-13  |g|= 1.74e-10  |ddm|= 1.2e-10
HOMO (B2u) = -0.38782723378754  LUMO (Ag) = -0.0952331323477039
cycle= 24 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 1.37e-10  |ddm|= 1.15e-10
HOMO (B2u) = -0.387827233792199  LUMO (Ag) = -0.0952331323538767
cycle= 25 E= -75.2913183390998  delta_E= -8.53e-14  |g|= 1.04e-10  |ddm|= 1.07e-10
HOMO (B2u) = -0.387827233796527  LUMO (Ag) = -0.0952331323601005
cycle= 26 E= -75.2913183390999  delta_E= -8.53e-14  |g|= 7.54e-11  |ddm|= 9.84e-11
HOMO (B2u) = -0.38782723379525  LUMO (Ag) = -0.0952331323584801
cycle= 27 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 6.23e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.387827233793624  LUMO (Ag) = -0.0952331323567352
cycle= 28 E= -75.2913183390997  delta_E= 1.71e-13  |g|= 5.13e-11  |ddm|= 2.43e-11
HOMO (B2u) = -0.387827233792374  LUMO (Ag) = -0.0952331323556126
cycle= 29 E= -75.2913183390998  delta_E= -1.14e-13  |g|= 4.18e-11  |ddm|= 1.97e-11
HOMO (B2u) = -0.387827233791342  LUMO (Ag) = -0.0952331323549456
cycle= 30 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 3.34e-11  |ddm|= 1.63e-11
HOMO (B2u) = -0.387827233790613  LUMO (Ag) = -0.0952331323545377
cycle= 31 E= -75.2913183390998  delta_E= 1.42e-14  |g|= 2.66e-11  |ddm|= 1.34e-11
HOMO (B3u) = -0.387827233790128  LUMO (Ag) = -0.0952331323543379
cycle= 32 E= -75.2913183390998  delta_E= 1.42e-14  |g|= 2.1e-11  |ddm|= 1.1e-11
HOMO (B3u) = -0.387827233789835  LUMO (Ag) = -0.0952331323542615
cycle= 33 E= -75.2913183390998  delta_E= -1.42e-14  |g|= 1.65e-11  |ddm|= 8.37e-12
HOMO (B3u) = -0.387827233789693  LUMO (Ag) = -0.0952331323542608
cycle= 34 E= -75.2913183390998  delta_E= 5.68e-14  |g|= 1.32e-11  |ddm|= 5.91e-12
HOMO (B3u) = -0.387827233789681  LUMO (Ag) = -0.0952331323542936
cycle= 35 E= -75.2913183390998  delta_E= -4.26e-14  |g|= 1.09e-11  |ddm|= 3.81e-12
HOMO (B2u) = -0.387827233789643  LUMO (Ag) = -0.0952331323543208
cycle= 36 E= -75.2913183390998  delta_E= -1.42e-14  |g|= 8.88e-12  |ddm|= 3.09e-12
HOMO (B2u) = -0.387827233789581  LUMO (Ag) = -0.0952331323543367
cycle= 37 E= -75.2913183390997  delta_E= 7.11e-14  |g|= 7.21e-12  |ddm|= 2.52e-12
HOMO (B2u) = -0.38782723378951  LUMO (Ag) = -0.0952331323543431
cycle= 38 E= -75.2913183390997  delta_E= 5.68e-14  |g|= 5.81e-12  |ddm|= 2.04e-12
HOMO (B2u) = -0.38782723378944  LUMO (Ag) = -0.095233132354337
cycle= 39 E= -75.2913183390997  delta_E= -5.68e-14  |g|= 4.68e-12  |ddm|= 1.62e-12
HOMO (B2u) = -0.387827233789371  LUMO (Ag) = -0.0952331323543214
cycle= 40 E= -75.2913183390997  delta_E=    0  |g|= 3.78e-12  |ddm|= 1.27e-12
HOMO (B3u) = -0.387827233789127  LUMO (Ag) = -0.0952331323542227
Extra cycle  E= -75.2913183390997  delta_E=    0  |g|= 1.32e-12  |ddm|= 3.41e-12
converged SCF energy = -75.2913183390997

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp436rg_b6
max_memory 4000 MB (current use 174 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4857258490142  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5064676419817  dE = -0.020741793  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.68  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5184322052024  dE = -0.011964563  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0656  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5265434762868  dE = -0.0081112711  S^2 = 0.0000000
               |grad[o]|=0.0908  |ddm|=0.0339  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.532292831032  dE = -0.0057493547  S^2 = 0.0000000
               |grad[o]|=0.0705  |ddm|=0.0223  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5362657422627  dE = -0.0039729112  S^2 = 0.0000000
               |grad[o]|=0.0523  |ddm|=0.0155  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5387478296759  dE = -0.0024820874  S^2 = 0.0000000
               |grad[o]|=0.0357  |ddm|=0.0116  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5399094903046  dE = -0.0011616606  S^2 = 0.0000000
               |grad[o]|=0.0201  |ddm|=0.0105  |maxRot[o]|=0.0799
macro iter 8 (4 JK  0 micro), CASSCF E = -75.540038813821  dE = -0.00012932352  S^2 = 0.0000000
               |grad[o]|=0.00582  |ddm|=0.0121  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5400404965111  dE = -1.6826901e-06  S^2 = 0.0000000
               |grad[o]|=0.000811  |ddm|=0.00672  |maxRot[o]|=0.00294
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5400405390561  dE = -4.2544968e-08  S^2 = 0.0000000
               |grad[o]|=0.000142  |ddm|=0.00102  |maxRot[o]|=0.000305
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5400405400971  dE = -1.0409877e-09  S^2 = 0.0000000
               |grad[o]|=2.61e-05  |ddm|=0.000167  |maxRot[o]|=3.46e-05
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5400405401292  dE = -3.2073899e-11  S^2 = 0.0000000
               |grad[o]|=4.43e-06  |ddm|=2.92e-05  |maxRot[o]|=5.26e-06
2-step CASSCF converged in 12 macro (58 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97266784 1.73807347 1.76671877 1.76671799 0.28541952 0.22251184
 0.22251147 0.02537909]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00752   0.00393   0.00000   0.00000  -0.00075
  0 C 2s       0.63584   0.61195  -0.00000  -0.00000  -0.30764
  0 C 3s      -0.02245   0.00972   0.00000   0.00000   0.02272
  0 C 2px     -0.00000   0.00000  -0.00000   0.70640   0.00000
  0 C 2py     -0.00000   0.00000   0.70640  -0.00000   0.00000
  0 C 2pz      0.30639  -0.35411   0.00000   0.00000   0.63428
  0 C 3px     -0.00000  -0.00000  -0.00000   0.02449   0.00000
  0 C 3py     -0.00000   0.00000   0.02449  -0.00000   0.00000
  0 C 3pz     -0.02442  -0.00191   0.00000   0.00000  -0.03747
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.01996  -0.00000   0.00000
  0 C 3dz^2    0.02599  -0.00343   0.00000   0.00000   0.03354
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.01996   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00752  -0.00393   0.00000   0.00000  -0.00075
  1 C 2s       0.63584  -0.61195  -0.00000  -0.00000  -0.30764
  1 C 3s      -0.02245  -0.00972  -0.00000  -0.00000   0.02272
  1 C 2px     -0.00000   0.00000   0.00000   0.70640  -0.00000
  1 C 2py      0.00000  -0.00000   0.70640   0.00000   0.00000
  1 C 2pz     -0.30639  -0.35411  -0.00000   0.00000  -0.63428
  1 C 3px      0.00000  -0.00000   0.00000   0.02449  -0.00000
  1 C 3py      0.00000  -0.00000   0.02449   0.00000  -0.00000
  1 C 3pz      0.02442  -0.00191   0.00000   0.00000   0.03747
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.01996  -0.00000   0.00000
  1 C 3dz^2    0.02599   0.00343  -0.00000  -0.00000   0.03354
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.01996   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.35370
  0 C 3s       0.00000   0.00000  -0.04177
  0 C 2px      0.70670  -0.00000   0.00000
  0 C 2py     -0.00000   0.70670  -0.00000
  0 C 2pz      0.00000  -0.00000   0.61017
  0 C 3px     -0.01201   0.00000   0.00000
  0 C 3py      0.00000  -0.01201  -0.00000
  0 C 3pz      0.00000   0.00000   0.02109
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02067  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01998
  0 C 3dxz    -0.02067   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s      -0.00000  -0.00000  -0.35370
  1 C 3s      -0.00000  -0.00000   0.04177
  1 C 2px     -0.70670  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70670   0.00000
  1 C 2pz      0.00000  -0.00000   0.61017
  1 C 3px      0.01201   0.00000  -0.00000
  1 C 3py      0.00000   0.01201   0.00000
  1 C 3pz      0.00000   0.00000   0.02109
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02067  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.01998
  1 C 3dxz    -0.02067  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99096816
<CAS-nat-orb|mo-hf>  4  4    0.99730114
<CAS-nat-orb|mo-hf>  5  5    0.99929409
<CAS-nat-orb|mo-hf>  6  6    0.99929408
<CAS-nat-orb|mo-hf>  7  7    0.97345971
<CAS-nat-orb|mo-hf>  8  8    0.97595061
<CAS-nat-orb|mo-hf>  9  9    0.97595057
<CAS-nat-orb|mo-hf>  10  10    0.79085172
<CAS-nat-orb|mo-hf>  10  14   -0.55412006
CASSCF energy = -75.5400405401292
CASCI E = -75.5400405401292  E(CI) = -16.067021349501  S^2 = 0.0000000
Time cost =    375.453
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:25:34 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.640449353852 AA    0.000000000000   0.000000000000   3.100000000000 Bohr   0.0

nuclear repulsion = 11.6129032258065
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.55]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     11978.17


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp7fsz6ih7
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9340105731017

WARN: Singularity detected in overlap matrix (condition number =  188). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.14969326640479  LUMO (B3u) = -0.14969326640479

WARN: B2u HOMO -0.14969326640479 > system LUMO -0.14969326640479

cycle= 1 E= -75.3573845713053  delta_E= -0.423  |g|= 0.265  |ddm|= 1.55
HOMO (B2u) = -0.413310367291846  LUMO (B3u) = -0.0846696262312566
cycle= 2 E= -75.3843760014416  delta_E= -0.027  |g|= 0.0539  |ddm|= 0.354
HOMO (B2u) = -0.373182146511251  LUMO (B3u) = -0.0395668514335554
cycle= 3 E= -75.3858456567449  delta_E= -0.00147  |g|= 0.018  |ddm|= 0.0717
HOMO (B2u) = -0.377721327859488  LUMO (B3u) = -0.0440841679310594
cycle= 4 E= -75.3860530258635  delta_E= -0.000207  |g|= 0.000721  |ddm|= 0.0382
HOMO (B2u) = -0.377699771169466  LUMO (B3u) = -0.0442008432276665
cycle= 5 E= -75.3860532373451  delta_E= -2.11e-07  |g|= 8.07e-05  |ddm|= 0.00144
HOMO (B2u) = -0.377674560909572  LUMO (B3u) = -0.0441740446286854
cycle= 6 E= -75.3860532409994  delta_E= -3.65e-09  |g|= 1.32e-05  |ddm|= 0.000134
HOMO (B2u) = -0.377672848926073  LUMO (B3u) = -0.0441758015090456
cycle= 7 E= -75.3860532411127  delta_E= -1.13e-10  |g|= 1.86e-06  |ddm|= 3.43e-05
HOMO (B2u) = -0.377672100443054  LUMO (B3u) = -0.0441752784119435
cycle= 8 E= -75.3860532411148  delta_E= -2.15e-12  |g|= 1.02e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.377672134542211  LUMO (B3u) = -0.0441753126344491
cycle= 9 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 9.15e-09  |ddm|= 2.08e-07
HOMO (B2u) = -0.37767213542348  LUMO (B3u) = -0.0441753150830319
cycle= 10 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 5.29e-09  |ddm|= 8.76e-09
HOMO (B2u) = -0.37767213549174  LUMO (B3u) = -0.044175315131481
cycle= 11 E= -75.3860532411149  delta_E= -7.11e-14  |g|= 4.99e-09  |ddm|= 4.31e-09
HOMO (B2u) = -0.377672134119649  LUMO (B3u) = -0.0441753136887937
cycle= 12 E= -75.3860532411149  delta_E= 7.11e-14  |g|= 4.61e-09  |ddm|= 2.32e-09
HOMO (B2u) = -0.377672133903716  LUMO (B3u) = -0.0441753133841152
cycle= 13 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 8.94e-10  |ddm|= 7.69e-09
HOMO (B2u) = -0.377672133973451  LUMO (B3u) = -0.0441753134346479
cycle= 14 E= -75.3860532411149  delta_E=    0  |g|= 7.9e-10  |ddm|= 4.35e-10
HOMO (B2u) = -0.377672134141488  LUMO (B3u) = -0.0441753135504045
cycle= 15 E= -75.3860532411148  delta_E= 2.84e-14  |g|= 6.66e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.377672134097415  LUMO (B3u) = -0.0441753135970673
cycle= 16 E= -75.3860532411148  delta_E=    0  |g|= 7.82e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.377672134148814  LUMO (B3u) = -0.0441753136135133
cycle= 17 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 8.39e-10  |ddm|= 6.6e-10
HOMO (B2u) = -0.377672134162276  LUMO (B3u) = -0.0441753136099182
cycle= 18 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 5.71e-10  |ddm|= 5.55e-10
HOMO (B2u) = -0.377672134187553  LUMO (B3u) = -0.0441753136339929
cycle= 19 E= -75.3860532411149  delta_E= -1.42e-14  |g|= 4.44e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.377672134218971  LUMO (B3u) = -0.0441753136629101
cycle= 20 E= -75.386053241115  delta_E= -7.11e-14  |g|= 3.14e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.377672134234337  LUMO (B3u) = -0.0441753136725793
cycle= 21 E= -75.3860532411148  delta_E= 1.28e-13  |g|= 1.86e-10  |ddm|= 2.77e-10
HOMO (B2u) = -0.377672134234369  LUMO (B3u) = -0.0441753136702798
cycle= 22 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 1.62e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.37767213423421  LUMO (B3u) = -0.0441753136686002
cycle= 23 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 1.43e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.377672134231532  LUMO (B3u) = -0.0441753136668736
cycle= 24 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 1.3e-10  |ddm|= 5.92e-11
HOMO (B2u) = -0.377672134234446  LUMO (B3u) = -0.0441753136670337
cycle= 25 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 1.06e-10  |ddm|= 6.65e-11
HOMO (B2u) = -0.377672134236897  LUMO (B3u) = -0.0441753136680586
cycle= 26 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 7.86e-11  |ddm|= 6.24e-11
HOMO (B2u) = -0.377672134238192  LUMO (B3u) = -0.0441753136685353
cycle= 27 E= -75.3860532411149  delta_E= -2.84e-14  |g|= 6.05e-11  |ddm|= 4.29e-11
HOMO (B2u) = -0.377672134239312  LUMO (B3u) = -0.0441753136688936
cycle= 28 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 4.59e-11  |ddm|= 3.43e-11
HOMO (B2u) = -0.377672134240373  LUMO (B3u) = -0.0441753136693586
cycle= 29 E= -75.3860532411149  delta_E=    0  |g|= 3.55e-11  |ddm|= 2.51e-11
HOMO (B2u) = -0.377672134242989  LUMO (B3u) = -0.0441753136705763
Extra cycle  E= -75.3860532411149  delta_E=    0  |g|= 1.13e-11  |ddm|= 6.22e-11
converged SCF energy = -75.3860532411149

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp7fsz6ih7
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.476415949608  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.487239609641  dE = -0.01082366  S^2 = 0.0000000
               |grad[o]|=0.0774  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4972270887852  dE = -0.0099874791  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0605  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5063987161804  dE = -0.0091716274  S^2 = 0.0000000
               |grad[o]|=0.0682  |ddm|=0.0991  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.514381819236  dE = -0.0079831031  S^2 = 0.0000000
               |grad[o]|=0.0667  |ddm|=0.194  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5204922499874  dE = -0.0061104308  S^2 = 0.0000000
               |grad[o]|=0.0614  |ddm|=0.222  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5243786184552  dE = -0.0038863685  S^2 = 0.0000000
               |grad[o]|=0.048  |ddm|=0.157  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.5257534212498  dE = -0.0013748028  S^2 = 0.0000000
               |grad[o]|=0.0286  |ddm|=  0.1  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5259733308403  dE = -0.00021990959  S^2 = 0.0000000
               |grad[o]|=0.0122  |ddm|=0.0931  |maxRot[o]|=0.0188
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5262794794928  dE = -0.00030614865  S^2 = 0.0000000
               |grad[o]|=0.0118  |ddm|=0.171  |maxRot[o]|=0.00855
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5272581202479  dE = -0.00097864076  S^2 = 0.0000000
               |grad[o]|=0.022  |ddm|=0.309  |maxRot[o]|=0.019
macro iter 11 (4 JK  0 micro), CASSCF E = -75.5294134844043  dE = -0.0021553642  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.465  |maxRot[o]|=0.0329
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5311332621347  dE = -0.0017197777  S^2 = 0.0000000
               |grad[o]|=0.0308  |ddm|=0.348  |maxRot[o]|= 0.04
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5314667402081  dE = -0.00033347807  S^2 = 0.0000000
               |grad[o]|=0.0126  |ddm|=0.107  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.531514459139  dE = -4.7718931e-05  S^2 = 0.0000000
               |grad[o]|=0.00437  |ddm|=0.0224  |maxRot[o]|=0.00856
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5315175887222  dE = -3.1295831e-06  S^2 = 0.0000000
               |grad[o]|=0.00109  |ddm|=0.00794  |maxRot[o]|=0.00211
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5315177947158  dE = -2.0599366e-07  S^2 = 0.0000000
               |grad[o]|=0.000288  |ddm|=0.00204  |maxRot[o]|=0.000518
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5315178084863  dE = -1.3770517e-08  S^2 = 0.0000000
               |grad[o]|=7.68e-05  |ddm|=0.000533  |maxRot[o]|=0.000129
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5315178094244  dE = -9.3804431e-10  S^2 = 0.0000000
               |grad[o]|=2.05e-05  |ddm|=0.00014  |maxRot[o]|=3.33e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.531517809487  dE = -6.2598815e-11  S^2 = 0.0000000
               |grad[o]|=5.47e-06  |ddm|=3.78e-05  |maxRot[o]|=8.79e-06
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5315178094906  dE = -3.623768e-12  S^2 = 0.0000000
               |grad[o]|=1.41e-06  |ddm|=9.82e-06  |maxRot[o]|=2.34e-06
2-step CASSCF converged in 20 macro (80 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97199268 1.74648642 0.28354296 1.75359769 1.75359611 0.2322697
 0.23226976 0.02624468]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00771   0.00402  -0.00073   0.00000   0.00000
  0 C 2s       0.63877   0.61742  -0.30165   0.00000   0.00000
  0 C 3s      -0.02059   0.00990   0.02411   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.70637
  0 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  0 C 2pz      0.30053  -0.34447   0.63708  -0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000   0.02607
  0 C 3py      0.00000  -0.00000   0.00000   0.02607  -0.00000
  0 C 3pz     -0.02284  -0.00193  -0.03571   0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000   0.01911  -0.00000
  0 C 3dz^2    0.02539  -0.00363   0.03576   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000   0.01911
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00771  -0.00402  -0.00073   0.00000   0.00000
  1 C 2s       0.63877  -0.61742  -0.30165  -0.00000  -0.00000
  1 C 3s      -0.02059  -0.00990   0.02411  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000   0.00000   0.70637
  1 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  1 C 2pz     -0.30053  -0.34447  -0.63708  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000   0.02607
  1 C 3py      0.00000  -0.00000  -0.00000   0.02607  -0.00000
  1 C 3pz      0.02284  -0.00193   0.03571   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01911   0.00000
  1 C 3dz^2    0.02539   0.00363   0.03576  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000  -0.01911
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s       0.00000   0.00000   0.34413
  0 C 3s       0.00000   0.00000  -0.04088
  0 C 2px      0.00000   0.70673   0.00000
  0 C 2py      0.70673   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.61571
  0 C 3px      0.00000  -0.01104   0.00000
  0 C 3py     -0.01104   0.00000   0.00000
  0 C 3pz      0.00000   0.00000   0.02055
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.02028   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01955
  0 C 3dxz     0.00000  -0.02028   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.34413
  1 C 3s      -0.00000  -0.00000   0.04088
  1 C 2px     -0.00000  -0.70673  -0.00000
  1 C 2py     -0.70673  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.61571
  1 C 3px     -0.00000   0.01104  -0.00000
  1 C 3py      0.01104  -0.00000  -0.00000
  1 C 3pz      0.00000   0.00000   0.02055
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.02028   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.01955
  1 C 3dxz     0.00000  -0.02028   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99970732
<CAS-nat-orb|mo-hf>  4  4    0.99969115
<CAS-nat-orb|mo-hf>  5  5    0.99206275
<CAS-nat-orb|mo-hf>  6  6    0.99749856
<CAS-nat-orb|mo-hf>  7  7    0.98939317
<CAS-nat-orb|mo-hf>  8  8    0.97289816
<CAS-nat-orb|mo-hf>  9  9    0.95779871
<CAS-nat-orb|mo-hf>  10  10    0.87337001
<CAS-nat-orb|mo-hf>  10  12   -0.42886300
CASSCF energy = -75.5315178094906
CASCI E = -75.5315178094906  E(CI) = -15.9739146589108  S^2 = 0.0000000
Time cost =    610.181
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:35:44 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.666908214398 AA    0.000000000000   0.000000000000   3.150000000000 Bohr   0.0

nuclear repulsion = 11.4285714285714
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.575]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     12770.94


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpa5gl_gbc
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9089301361996

WARN: Singularity detected in overlap matrix (condition number =  175). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.144793107119775  LUMO (B3u) = -0.144793107119776

WARN: B2u HOMO -0.144793107119775 > system LUMO -0.144793107119776

cycle= 1 E= -75.3499635205345  delta_E= -0.441  |g|= 0.262  |ddm|= 1.54
HOMO (B2u) = -0.407994029365034  LUMO (B3u) = -0.0815659278261169
cycle= 2 E= -75.3765746590879  delta_E= -0.0266  |g|= 0.0534  |ddm|= 0.353
HOMO (B2u) = -0.368435737958923  LUMO (B3u) = -0.0370562210896302
cycle= 3 E= -75.3780458200466  delta_E= -0.00147  |g|= 0.0181  |ddm|= 0.0711
HOMO (B2u) = -0.372975542135577  LUMO (B3u) = -0.041556201776843
cycle= 4 E= -75.3782577251018  delta_E= -0.000212  |g|= 0.000712  |ddm|= 0.0382
HOMO (B2u) = -0.372986320268991  LUMO (B3u) = -0.0417075409102719
cycle= 5 E= -75.3782579293203  delta_E= -2.04e-07  |g|= 8.31e-05  |ddm|= 0.00134
HOMO (B2u) = -0.372958407634992  LUMO (B3u) = -0.0416782676150335
cycle= 6 E= -75.3782579331955  delta_E= -3.88e-09  |g|= 1.36e-05  |ddm|= 0.000138
HOMO (B2u) = -0.372956778075022  LUMO (B3u) = -0.0416799724229747
cycle= 7 E= -75.3782579333153  delta_E= -1.2e-10  |g|= 1.9e-06  |ddm|= 3.4e-05
HOMO (B2u) = -0.372956024408665  LUMO (B3u) = -0.0416794932468851
cycle= 8 E= -75.3782579333177  delta_E= -2.36e-12  |g|= 1.05e-07  |ddm|= 4.17e-06
HOMO (B2u) = -0.372956052024358  LUMO (B3u) = -0.0416795190610665
cycle= 9 E= -75.3782579333177  delta_E= -4.26e-14  |g|= 8.21e-09  |ddm|= 2.09e-07
HOMO (B2u) = -0.37295605294442  LUMO (B3u) = -0.0416795215542276
cycle= 10 E= -75.3782579333177  delta_E= 7.11e-14  |g|= 4.91e-09  |ddm|= 8.05e-09
HOMO (B2u) = -0.372956052901277  LUMO (B3u) = -0.041679521486337
cycle= 11 E= -75.3782579333176  delta_E= 2.84e-14  |g|= 4.53e-09  |ddm|= 4.17e-09
HOMO (B2u) = -0.372956051584176  LUMO (B3u) = -0.0416795201014233
cycle= 12 E= -75.3782579333177  delta_E= -8.53e-14  |g|= 4.18e-09  |ddm|= 2.1e-09
HOMO (B2u) = -0.372956051860072  LUMO (B3u) = -0.0416795203494529
cycle= 13 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 3.58e-09  |ddm|= 9.58e-10
HOMO (B2u) = -0.372956051442545  LUMO (B3u) = -0.0416795198746586
cycle= 14 E= -75.3782579333178  delta_E= -5.68e-14  |g|= 6.87e-10  |ddm|= 5.81e-09
HOMO (B2u) = -0.372956051678719  LUMO (B3u) = -0.0416795200413938
cycle= 15 E= -75.3782579333177  delta_E= 7.11e-14  |g|= 6.54e-10  |ddm|= 1.57e-09
HOMO (B2u) = -0.372956051604069  LUMO (B3u) = -0.0416795200818019
cycle= 16 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 8e-10  |ddm|= 1.64e-09
HOMO (B2u) = -0.372956051656225  LUMO (B3u) = -0.0416795200907128
cycle= 17 E= -75.3782579333177  delta_E=    0  |g|= 8.1e-10  |ddm|= 7.4e-10
HOMO (B2u) = -0.372956051662947  LUMO (B3u) = -0.0416795200819559
cycle= 18 E= -75.3782579333177  delta_E=    0  |g|= 5.76e-10  |ddm|= 4.36e-10
HOMO (B2u) = -0.372956051684887  LUMO (B3u) = -0.0416795201033578
cycle= 19 E= -75.3782579333176  delta_E= 2.84e-14  |g|= 4.86e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.372956051711185  LUMO (B3u) = -0.0416795201278744
cycle= 20 E= -75.3782579333177  delta_E= -7.11e-14  |g|= 3.79e-10  |ddm|= 1.94e-10
HOMO (B2u) = -0.372956051722224  LUMO (B3u) = -0.0416795201340998
cycle= 21 E= -75.3782579333176  delta_E= 7.11e-14  |g|= 2.58e-10  |ddm|= 2.18e-10
HOMO (B2u) = -0.372956051734031  LUMO (B3u) = -0.0416795201426461
cycle= 22 E= -75.3782579333176  delta_E=    0  |g|= 1.57e-10  |ddm|= 1.95e-10
HOMO (B2u) = -0.372956051733238  LUMO (B3u) = -0.0416795201402766
cycle= 23 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 1.49e-10  |ddm|= 5.82e-11
HOMO (B2u) = -0.372956051729242  LUMO (B3u) = -0.0416795201380389
cycle= 24 E= -75.3782579333176  delta_E= 2.84e-14  |g|= 1.38e-10  |ddm|= 5.99e-11
HOMO (B2u) = -0.37295605173215  LUMO (B3u) = -0.0416795201379882
cycle= 25 E= -75.3782579333178  delta_E= -1.14e-13  |g|= 1.13e-10  |ddm|= 6.49e-11
HOMO (B2u) = -0.372956051734062  LUMO (B3u) = -0.0416795201385781
cycle= 26 E= -75.3782579333177  delta_E= 7.11e-14  |g|= 8.79e-11  |ddm|= 5.32e-11
HOMO (B2u) = -0.37295605173502  LUMO (B3u) = -0.0416795201387534
cycle= 27 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 7.07e-11  |ddm|= 3.75e-11
HOMO (B2u) = -0.372956051735882  LUMO (B3u) = -0.0416795201388619
cycle= 28 E= -75.3782579333177  delta_E= -5.68e-14  |g|= 5.47e-11  |ddm|= 3.39e-11
HOMO (B2u) = -0.372956051736758  LUMO (B3u) = -0.0416795201391087
cycle= 29 E= -75.3782579333178  delta_E= -4.26e-14  |g|= 4.19e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.372956051737369  LUMO (B3u) = -0.0416795201392999
cycle= 30 E= -75.3782579333177  delta_E= 5.68e-14  |g|= 3.33e-11  |ddm|= 1.96e-11
HOMO (B2u) = -0.372956051737817  LUMO (B3u) = -0.0416795201394942
cycle= 31 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 2.85e-11  |ddm|= 1.23e-11
HOMO (B2u) = -0.372956051738144  LUMO (B3u) = -0.0416795201396044
cycle= 32 E= -75.3782579333176  delta_E= 8.53e-14  |g|= 2.36e-11  |ddm|= 1.18e-11
HOMO (B2u) = -0.372956051738565  LUMO (B3u) = -0.0416795201397135
cycle= 33 E= -75.3782579333177  delta_E= -9.95e-14  |g|= 1.89e-11  |ddm|= 1.09e-11
HOMO (B2u) = -0.372956051738853  LUMO (B3u) = -0.0416795201397993
cycle= 34 E= -75.3782579333177  delta_E= 7.11e-14  |g|= 1.51e-11  |ddm|= 8.72e-12
HOMO (B2u) = -0.372956051739068  LUMO (B3u) = -0.0416795201398593
cycle= 35 E= -75.3782579333177  delta_E=    0  |g|= 1.22e-11  |ddm|= 6.86e-12
HOMO (B2u) = -0.372956051739609  LUMO (B3u) = -0.0416795201399662
Extra cycle  E= -75.3782579333177  delta_E= -2.84e-14  |g|= 4.24e-12  |ddm|= 1.85e-11
converged SCF energy = -75.3782579333177

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpa5gl_gbc
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4725934895912  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.483738543246  dE = -0.011145054  S^2 = 0.0000000
               |grad[o]|=0.0791  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4938627006696  dE = -0.010124157  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0567  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5028935336852  dE = -0.009030833  S^2 = 0.0000000
               |grad[o]|=0.0659  |ddm|=0.0667  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5105630063477  dE = -0.0076694727  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5162482933873  dE = -0.005685287  S^2 = 0.0000000
               |grad[o]|=0.051  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5197013968115  dE = -0.0034531034  S^2 = 0.0000000
               |grad[o]|=0.0355  |ddm|=0.0366  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.521073330959  dE = -0.0013719341  S^2 = 0.0000000
               |grad[o]|=0.0178  |ddm|=0.0634  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5215988184393  dE = -0.00052548748  S^2 = 0.0000000
               |grad[o]|=0.0113  |ddm|=0.115  |maxRot[o]|= 0.02
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5222374490381  dE = -0.0006386306  S^2 = 0.0000000
               |grad[o]|=0.0104  |ddm|=0.0771  |maxRot[o]|=0.033
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5226563533804  dE = -0.00041890434  S^2 = 0.0000000
               |grad[o]|=0.00749  |ddm|=0.064  |maxRot[o]|=0.0335
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5227995203822  dE = -0.000143167  S^2 = 0.0000000
               |grad[o]|=0.00438  |ddm|=0.0306  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5228528705783  dE = -5.3350196e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.0113  |maxRot[o]|=0.0144
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5228636275608  dE = -1.0756982e-05  S^2 = 0.0000000
               |grad[o]|=0.00112  |ddm|=0.00642  |maxRot[o]|=0.00668
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5228655523389  dE = -1.9247781e-06  S^2 = 0.0000000
               |grad[o]|=0.000479  |ddm|=0.00263  |maxRot[o]|=0.00287
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5228658806957  dE = -3.2835685e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.00108  |maxRot[o]|=0.00119
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5228659357624  dE = -5.5066693e-08  S^2 = 0.0000000
               |grad[o]|=8.2e-05  |ddm|=0.000438  |maxRot[o]|=0.000488
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5228659449375  dE = -9.175082e-09  S^2 = 0.0000000
               |grad[o]|=3.35e-05  |ddm|=0.000178  |maxRot[o]|=0.000199
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5228659464735  dE = -1.5360087e-09  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.23e-05  |maxRot[o]|=8.09e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.5228659467353  dE = -2.6177815e-10  S^2 = 0.0000000
               |grad[o]|=5.53e-06  |ddm|=2.94e-05  |maxRot[o]|=3.29e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5228659467818  dE = -4.6512127e-11  S^2 = 0.0000000
               |grad[o]|=2.25e-06  |ddm|=1.19e-05  |maxRot[o]|=1.33e-05
2-step CASSCF converged in 20 macro (77 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96757995 1.92636359 1.90257312 1.85304912 0.08669295 0.15330618
 0.05997838 0.05045671]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00942   0.00931  -0.00604   0.00000   0.00000
  0 C 2s       0.58733   0.63316  -0.39276   0.00000  -0.00000
  0 C 3s      -0.02996   0.01840  -0.05304   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69586
  0 C 2py      0.00000   0.00000   0.00000   0.70455   0.00000
  0 C 2pz      0.38981  -0.31366   0.58451   0.00000  -0.00000
  0 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05174
  0 C 3py      0.00000  -0.00000   0.00000   0.04283  -0.00000
  0 C 3pz     -0.02787  -0.00316  -0.00116   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.04212  -0.00000
  0 C 3dz^2    0.03630  -0.01553   0.03447   0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000  -0.11447
 0 C 3dx2-y2  -0.00196   0.00750  -0.00750   0.00000  -0.00000
  1 C 1s       0.00942  -0.00931  -0.00604   0.00000   0.00000
  1 C 2s       0.58733  -0.63316  -0.39276  -0.00000  -0.00000
  1 C 3s      -0.02996  -0.01840  -0.05304  -0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69586
  1 C 2py     -0.00000   0.00000  -0.00000   0.70455   0.00000
  1 C 2pz     -0.38981  -0.31366  -0.58451  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000   0.00000  -0.05174
  1 C 3py     -0.00000  -0.00000  -0.00000   0.04283  -0.00000
  1 C 3pz      0.02787  -0.00316   0.00116   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.04212   0.00000
  1 C 3dz^2    0.03630   0.01553   0.03447  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000   0.11447
 1 C 3dx2-y2  -0.00196  -0.00750  -0.00750   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s       0.00000  -0.00000   0.31126
  0 C 3s       0.00000   0.00000   0.04123
  0 C 2px     -0.00000   0.69686   0.00000
  0 C 2py      0.70644  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.62985
  0 C 3px     -0.00000   0.00767   0.00000
  0 C 3py     -0.02723  -0.00000   0.00000
  0 C 3pz      0.00000   0.00000  -0.05999
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.01434   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000   0.01543
  0 C 3dxz    -0.00000  -0.11967   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02938
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s      -0.00000  -0.00000  -0.31126
  1 C 3s      -0.00000  -0.00000  -0.04123
  1 C 2px     -0.00000  -0.69686  -0.00000
  1 C 2py     -0.70644   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.62985
  1 C 3px      0.00000  -0.00767  -0.00000
  1 C 3py      0.02723   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.05999
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01434  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.01543
  1 C 3dxz    -0.00000  -0.11967   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02938
<CAS-nat-orb|mo-hf>  3  3    0.98488177
<CAS-nat-orb|mo-hf>  4  4    0.99976478
<CAS-nat-orb|mo-hf>  5  5    0.98488756
<CAS-nat-orb|mo-hf>  6  6    0.99934351
<CAS-nat-orb|mo-hf>  7  7    0.94550984
<CAS-nat-orb|mo-hf>  8  8    0.96719800
<CAS-nat-orb|mo-hf>  9  9    0.95784087
<CAS-nat-orb|mo-hf>  10  10    0.82549313
<CAS-nat-orb|mo-hf>  10  11   -0.53364519
CASSCF energy = -75.5228659467818
CASCI E = -75.5228659467818  E(CI) = -15.8845981664485  S^2 = 0.0000000
Time cost =    308.841
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:40:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.693367074944 AA    0.000000000000   0.000000000000   3.200000000000 Bohr   0.0

nuclear repulsion = 11.25
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.6]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     13402.01


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpm00y7pre
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8853199307072

WARN: Singularity detected in overlap matrix (condition number =  163). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.140132093357863  LUMO (B3u) = -0.140132093357863

WARN: B2u HOMO -0.140132093357863 > system LUMO -0.140132093357863

cycle= 1 E= -75.3423788059563  delta_E= -0.457  |g|= 0.259  |ddm|= 1.53
HOMO (B2u) = -0.40283437414125  LUMO (B3u) = -0.0785386739836416
cycle= 2 E= -75.3685959970364  delta_E= -0.0262  |g|= 0.053  |ddm|= 0.353
HOMO (B2u) = -0.363851731217671  LUMO (B3u) = -0.0346304224365222
cycle= 3 E= -75.3700649559039  delta_E= -0.00147  |g|= 0.0182  |ddm|= 0.0704
HOMO (B2u) = -0.368389012587526  LUMO (B3u) = -0.0391108103436432
cycle= 4 E= -75.3702805696255  delta_E= -0.000216  |g|= 0.000703  |ddm|= 0.0381
HOMO (B2u) = -0.368430097958784  LUMO (B3u) = -0.0392945410036858
cycle= 5 E= -75.3702807668801  delta_E= -1.97e-07  |g|= 8.62e-05  |ddm|= 0.00125
HOMO (B2u) = -0.36839979074249  LUMO (B3u) = -0.0392632961118406
cycle= 6 E= -75.3702807710482  delta_E= -4.17e-09  |g|= 1.41e-05  |ddm|= 0.000143
HOMO (B2u) = -0.368398140839535  LUMO (B3u) = -0.0392648663308206
cycle= 7 E= -75.3702807711757  delta_E= -1.28e-10  |g|= 1.92e-06  |ddm|= 3.39e-05
HOMO (B2u) = -0.368397398349128  LUMO (B3u) = -0.0392644368518848
cycle= 8 E= -75.3702807711782  delta_E= -2.43e-12  |g|= 1.08e-07  |ddm|= 4.2e-06
HOMO (B2u) = -0.368397420522818  LUMO (B3u) = -0.0392644560500855
cycle= 9 E= -75.3702807711782  delta_E=    0  |g|= 7.49e-09  |ddm|= 2.14e-07
HOMO (B2u) = -0.368397421406613  LUMO (B3u) = -0.0392644585099725
cycle= 10 E= -75.3702807711782  delta_E= -4.26e-14  |g|= 4.69e-09  |ddm|= 7.64e-09
HOMO (B2u) = -0.368397421280186  LUMO (B3u) = -0.0392644583543743
cycle= 11 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 4.19e-09  |ddm|= 4.06e-09
HOMO (B2u) = -0.368397419986545  LUMO (B3u) = -0.0392644569932955
cycle= 12 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 3.87e-09  |ddm|= 1.94e-09
HOMO (B2u) = -0.368397420307999  LUMO (B3u) = -0.0392644572886039
cycle= 13 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 3.34e-09  |ddm|= 8.4e-10
HOMO (B2u) = -0.368397419921245  LUMO (B3u) = -0.0392644568734638
cycle= 14 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 5.28e-10  |ddm|= 5e-09
HOMO (B2u) = -0.368397420132732  LUMO (B3u) = -0.0392644570114026
cycle= 15 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 5.83e-10  |ddm|= 1.53e-09
HOMO (B2u) = -0.368397420046897  LUMO (B3u) = -0.0392644570358884
cycle= 16 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 7.21e-10  |ddm|= 1.54e-09
HOMO (B2u) = -0.368397420093508  LUMO (B3u) = -0.0392644570383211
cycle= 17 E= -75.3702807711781  delta_E= 5.68e-14  |g|= 7.08e-10  |ddm|= 7.34e-10
HOMO (B2u) = -0.368397420093881  LUMO (B3u) = -0.0392644570252443
cycle= 18 E= -75.3702807711782  delta_E= -7.11e-14  |g|= 5.03e-10  |ddm|= 3.46e-10
HOMO (B2u) = -0.368397420112668  LUMO (B3u) = -0.0392644570440808
cycle= 19 E= -75.3702807711782  delta_E= 1.42e-14  |g|= 4.32e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.368397420134459  LUMO (B3u) = -0.0392644570647877
cycle= 20 E= -75.3702807711782  delta_E= -4.26e-14  |g|= 3.41e-10  |ddm|= 1.43e-10
HOMO (B2u) = -0.368397420141452  LUMO (B3u) = -0.0392644570677961
cycle= 21 E= -75.3702807711782  delta_E=    0  |g|= 2.32e-10  |ddm|= 1.8e-10
HOMO (B2u) = -0.368397420150079  LUMO (B3u) = -0.0392644570740899
cycle= 22 E= -75.3702807711781  delta_E= 1.14e-13  |g|= 1.37e-10  |ddm|= 1.65e-10
HOMO (B2u) = -0.368397420149807  LUMO (B3u) = -0.0392644570721891
cycle= 23 E= -75.3702807711782  delta_E= -1.28e-13  |g|= 1.32e-10  |ddm|= 4.11e-11
HOMO (B2u) = -0.368397420145916  LUMO (B3u) = -0.0392644570700987
cycle= 24 E= -75.3702807711781  delta_E= 1.14e-13  |g|= 1.23e-10  |ddm|= 5.37e-11
HOMO (B2u) = -0.368397420148398  LUMO (B3u) = -0.0392644570698291
cycle= 25 E= -75.3702807711782  delta_E= -8.53e-14  |g|= 9.96e-11  |ddm|= 5.6e-11
HOMO (B2u) = -0.36839742014964  LUMO (B3u) = -0.0392644570699832
cycle= 26 E= -75.3702807711782  delta_E= 5.68e-14  |g|= 7.83e-11  |ddm|= 4.05e-11
HOMO (B2u) = -0.368397420150146  LUMO (B3u) = -0.0392644570698605
cycle= 27 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 6.41e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.368397420150628  LUMO (B3u) = -0.0392644570697269
cycle= 28 E= -75.3702807711781  delta_E= 7.11e-14  |g|= 5e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.368397420151193  LUMO (B3u) = -0.0392644570697687
cycle= 29 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 3.85e-11  |ddm|= 2.34e-11
HOMO (B2u) = -0.36839742015157  LUMO (B3u) = -0.0392644570697944
cycle= 30 E= -75.3702807711782  delta_E= 4.26e-14  |g|= 3.06e-11  |ddm|= 1.66e-11
HOMO (B2u) = -0.36839742015187  LUMO (B3u) = -0.0392644570698689
cycle= 31 E= -75.3702807711781  delta_E= 2.84e-14  |g|= 2.64e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.368397420152063  LUMO (B3u) = -0.0392644570698822
cycle= 32 E= -75.3702807711782  delta_E= -1.14e-13  |g|= 2.19e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.368397420152362  LUMO (B3u) = -0.0392644570699087
cycle= 33 E= -75.3702807711782  delta_E= 2.84e-14  |g|= 1.77e-11  |ddm|= 9.25e-12
HOMO (B2u) = -0.368397420152549  LUMO (B3u) = -0.0392644570699266
cycle= 34 E= -75.3702807711782  delta_E=    0  |g|= 1.43e-11  |ddm|= 7.3e-12
HOMO (B2u) = -0.36839742015299  LUMO (B3u) = -0.0392644570699117
Extra cycle  E= -75.3702807711782  delta_E=    0  |g|= 5.18e-12  |ddm|= 2.02e-11
converged SCF energy = -75.3702807711782

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpm00y7pre
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4686639234794  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4801659097197  dE = -0.011501986  S^2 = 0.0000000
               |grad[o]|=0.0808  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4904755225409  dE = -0.010309613  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0571  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4994469985016  dE = -0.008971476  S^2 = 0.0000000
               |grad[o]|=0.0646  |ddm|=0.0512  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5069095409451  dE = -0.0074625424  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0778  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5123640585544  dE = -0.0054545176  S^2 = 0.0000000
               |grad[o]|=0.0456  |ddm|=0.0796  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5156468201293  dE = -0.0032827616  S^2 = 0.0000000
               |grad[o]|=0.0301  |ddm|=0.0211  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5168779321711  dE = -0.001231112  S^2 = 0.0000000
               |grad[o]|=0.015  |ddm|=0.0787  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5176271585405  dE = -0.00074922637  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0722  |maxRot[o]|= 0.04
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5179500779147  dE = -0.00032291937  S^2 = 0.0000000
               |grad[o]|=0.00624  |ddm|=0.0442  |maxRot[o]|=0.0327
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5180290722484  dE = -7.8994334e-05  S^2 = 0.0000000
               |grad[o]|=0.00298  |ddm|=0.0185  |maxRot[o]|=0.0178
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5180431645368  dE = -1.4092288e-05  S^2 = 0.0000000
               |grad[o]|=0.00127  |ddm|=0.00708  |maxRot[o]|=0.0078
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5180453677531  dE = -2.2032164e-06  S^2 = 0.0000000
               |grad[o]|=0.000512  |ddm|=0.00271  |maxRot[o]|=0.00313
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5180456955227  dE = -3.2776953e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.00104  |maxRot[o]|=0.00122
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5180457433191  dE = -4.7796405e-08  S^2 = 0.0000000
               |grad[o]|=7.71e-05  |ddm|=0.000395  |maxRot[o]|=0.000466
macro iter 15 (2 JK  0 micro), CASSCF E = -75.518045750198  dE = -6.8789774e-09  S^2 = 0.0000000
               |grad[o]|=2.95e-05  |ddm|=0.00015  |maxRot[o]|=0.000178
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5180457511752  dE = -9.7712416e-10  S^2 = 0.0000000
               |grad[o]|=1.12e-05  |ddm|=5.71e-05  |maxRot[o]|=6.77e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5180457513066  dE = -1.3147883e-10  S^2 = 0.0000000
               |grad[o]|=4.24e-06  |ddm|=2.16e-05  |maxRot[o]|=2.54e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5180457513231  dE = -1.6413537e-11  S^2 = 0.0000000
               |grad[o]|=1.61e-06  |ddm|=8.17e-06  |maxRot[o]|=9.68e-06
2-step CASSCF converged in 18 macro (71 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9663057  1.92713079 1.90282925 1.84406996 0.08365691 0.16227412
 0.0596417  0.05409157]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00972   0.00945  -0.00589   0.00000   0.00000
  0 C 2s       0.59726   0.63748  -0.37752  -0.00000   0.00000
  0 C 3s      -0.02696   0.01811  -0.05147  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000  -0.00000   0.00000   0.69538
  0 C 2py     -0.00000   0.00000   0.00000   0.70451   0.00000
  0 C 2pz      0.37495  -0.30481   0.59459   0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.05355
  0 C 3py     -0.00000   0.00000   0.00000   0.04456  -0.00000
  0 C 3pz     -0.02582  -0.00292  -0.00005  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.04098  -0.00000
  0 C 3dz^2    0.03462  -0.01515   0.03455  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11653
 0 C 3dx2-y2  -0.00172   0.00737  -0.00749  -0.00000   0.00000
  1 C 1s       0.00972  -0.00945  -0.00589   0.00000   0.00000
  1 C 2s       0.59726  -0.63748  -0.37752  -0.00000   0.00000
  1 C 3s      -0.02696  -0.01811  -0.05147   0.00000   0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69538
  1 C 2py      0.00000  -0.00000   0.00000   0.70451   0.00000
  1 C 2pz     -0.37495  -0.30481  -0.59459  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00000  -0.05355
  1 C 3py      0.00000  -0.00000  -0.00000   0.04456  -0.00000
  1 C 3pz      0.02582  -0.00292   0.00005  -0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.04098   0.00000
  1 C 3dz^2    0.03462   0.01515   0.03455   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000  -0.00000   0.00000   0.11653
 1 C 3dx2-y2  -0.00172  -0.00737  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s      -0.00000   0.00000   0.30262
  0 C 3s      -0.00000   0.00000   0.04028
  0 C 2px      0.00000   0.69699  -0.00000
  0 C 2py      0.70653   0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.63446
  0 C 3px      0.00000   0.00537   0.00000
  0 C 3py     -0.02507   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05718
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01392   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01415
  0 C 3dxz     0.00000  -0.11904   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02809
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000   0.00000  -0.30262
  1 C 3s       0.00000  -0.00000  -0.04028
  1 C 2px     -0.00000  -0.69699  -0.00000
  1 C 2py     -0.70653  -0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.63446
  1 C 3px     -0.00000  -0.00537   0.00000
  1 C 3py      0.02507  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.05718
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.01392   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01415
  1 C 3dxz     0.00000  -0.11904  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02809
<CAS-nat-orb|mo-hf>  3  3    0.98713996
<CAS-nat-orb|mo-hf>  4  4    0.99975825
<CAS-nat-orb|mo-hf>  5  5    0.98714928
<CAS-nat-orb|mo-hf>  6  6    0.99929981
<CAS-nat-orb|mo-hf>  7  7    0.94370155
<CAS-nat-orb|mo-hf>  8  8    0.96917400
<CAS-nat-orb|mo-hf>  9  9    0.95823418
<CAS-nat-orb|mo-hf>  10  10    0.84381041
<CAS-nat-orb|mo-hf>  10  11   -0.50815317
CASSCF energy = -75.5180457513231
CASCI E = -75.5180457513231  E(CI) = -15.8005832192871  S^2 = 0.0000000
Time cost =    353.233
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:46:46 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.719825935490 AA    0.000000000000   0.000000000000   3.250000000000 Bohr   0.0

nuclear repulsion = 11.0769230769231
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.625]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     13971.91


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpjdzjp2zz
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8631164371269

WARN: Singularity detected in overlap matrix (condition number =  151). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.135696963446161  LUMO (B3u) = -0.13569696344616

WARN: B2u HOMO -0.135696963446161 > system LUMO -0.13569696344616

cycle= 1 E= -75.3346710578886  delta_E= -0.472  |g|= 0.257  |ddm|= 1.52
HOMO (B2u) = -0.397829563278945  LUMO (B3u) = -0.0755897093543533
cycle= 2 E= -75.360485940034  delta_E= -0.0258  |g|= 0.0524  |ddm|= 0.352
HOMO (B2u) = -0.35942419421082  LUMO (B3u) = -0.032286636697359
cycle= 3 E= -75.3619492644577  delta_E= -0.00146  |g|= 0.0182  |ddm|= 0.0697
HOMO (B2u) = -0.363955951245313  LUMO (B3u) = -0.0367454491314079
cycle= 4 E= -75.3621677667453  delta_E= -0.000219  |g|= 0.000695  |ddm|= 0.0379
HOMO (B2u) = -0.364024863853047  LUMO (B3u) = -0.0369588213878721
cycle= 5 E= -75.3621679575039  delta_E= -1.91e-07  |g|= 8.98e-05  |ddm|= 0.00116
HOMO (B2u) = -0.363992517085415  LUMO (B3u) = -0.0369261206635524
cycle= 6 E= -75.3621679620312  delta_E= -4.53e-09  |g|= 1.46e-05  |ddm|= 0.000149
HOMO (B2u) = -0.36399078224593  LUMO (B3u) = -0.036927515256083
cycle= 7 E= -75.3621679621673  delta_E= -1.36e-10  |g|= 1.94e-06  |ddm|= 3.41e-05
HOMO (B2u) = -0.363990060624868  LUMO (B3u) = -0.0369271360120104
cycle= 8 E= -75.3621679621697  delta_E= -2.37e-12  |g|= 1.11e-07  |ddm|= 4.19e-06
HOMO (B2u) = -0.363990078365928  LUMO (B3u) = -0.0369271500516773
cycle= 9 E= -75.3621679621697  delta_E= -4.26e-14  |g|= 7.05e-09  |ddm|= 2.21e-07
HOMO (B2u) = -0.363990079134708  LUMO (B3u) = -0.036927152402942
cycle= 10 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 4.68e-09  |ddm|= 7.45e-09
HOMO (B2u) = -0.363990078973964  LUMO (B3u) = -0.0369271522138597
cycle= 11 E= -75.3621679621697  delta_E= -4.26e-14  |g|= 4e-09  |ddm|= 4.01e-09
HOMO (B2u) = -0.36399007768323  LUMO (B3u) = -0.0369271508559778
cycle= 12 E= -75.3621679621698  delta_E= -4.26e-14  |g|= 3.68e-09  |ddm|= 1.85e-09
HOMO (B2u) = -0.363990078039725  LUMO (B3u) = -0.036927151190755
cycle= 13 E= -75.3621679621697  delta_E= 1.14e-13  |g|= 3.23e-09  |ddm|= 8.5e-10
HOMO (B2u) = -0.363990077657569  LUMO (B3u) = -0.036927150803598
cycle= 14 E= -75.3621679621696  delta_E= 2.84e-14  |g|= 4.12e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.363990077851645  LUMO (B3u) = -0.0369271509288062
cycle= 15 E= -75.3621679621697  delta_E= -7.11e-14  |g|= 5.37e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.363990077764625  LUMO (B3u) = -0.0369271509414497
cycle= 16 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 6.62e-10  |ddm|= 1.35e-09
HOMO (B2u) = -0.363990077806159  LUMO (B3u) = -0.0369271509397941
cycle= 17 E= -75.3621679621697  delta_E=    0  |g|= 6.49e-10  |ddm|= 7.18e-10
HOMO (B2u) = -0.363990077800331  LUMO (B3u) = -0.036927150923041
cycle= 18 E= -75.3621679621697  delta_E= 1.42e-14  |g|= 4.6e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.363990077815671  LUMO (B3u) = -0.0369271509392285
cycle= 19 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 3.99e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.363990077833274  LUMO (B3u) = -0.0369271509566603
cycle= 20 E= -75.3621679621696  delta_E= 9.95e-14  |g|= 3.18e-10  |ddm|= 1.18e-10
HOMO (B2u) = -0.363990077836366  LUMO (B3u) = -0.0369271509567448
cycle= 21 E= -75.3621679621697  delta_E= -8.53e-14  |g|= 2.17e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.363990077841876  LUMO (B3u) = -0.0369271509608763
cycle= 22 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 1.25e-10  |ddm|= 1.53e-10
HOMO (B2u) = -0.363990077841474  LUMO (B3u) = -0.0369271509589908
cycle= 23 E= -75.3621679621698  delta_E= -8.53e-14  |g|= 1.23e-10  |ddm|= 2.67e-11
HOMO (B2u) = -0.363990077837807  LUMO (B3u) = -0.0369271509570221
cycle= 24 E= -75.3621679621697  delta_E= 8.53e-14  |g|= 1.12e-10  |ddm|= 4.75e-11
HOMO (B2u) = -0.363990077839661  LUMO (B3u) = -0.0369271509564492
cycle= 25 E= -75.3621679621697  delta_E= -5.68e-14  |g|= 9.11e-11  |ddm|= 4.86e-11
HOMO (B2u) = -0.363990077840179  LUMO (B3u) = -0.0369271509561612
cycle= 26 E= -75.3621679621697  delta_E=    0  |g|= 7.24e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.363990077840799  LUMO (B3u) = -0.0369271509549974
Extra cycle  E= -75.3621679621697  delta_E= 2.84e-14  |g|= 2.55e-11  |ddm|= 8.82e-11
converged SCF energy = -75.3621679621697

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpjdzjp2zz
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.464653004534  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4765356118766  dE = -0.011882607  S^2 = 0.0000000
               |grad[o]|=0.0827  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4870504127983  dE = -0.010514801  S^2 = 0.0000000
               |grad[o]|=0.0737  |ddm|=0.0595  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4959877419097  dE = -0.0089373291  S^2 = 0.0000000
               |grad[o]|=0.0638  |ddm|=0.044  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5032500656419  dE = -0.0072623237  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.0592  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5084942261061  dE = -0.0052441605  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.0625  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5116033004843  dE = -0.0031090744  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5125684622512  dE = -0.00096516177  S^2 = 0.0000000
               |grad[o]|=0.0119  |ddm|=0.0749  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5130317828135  dE = -0.00046332056  S^2 = 0.0000000
               |grad[o]|=0.00731  |ddm|=0.0414  |maxRot[o]|=0.0388
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5131334897681  dE = -0.00010170695  S^2 = 0.0000000
               |grad[o]|=0.00337  |ddm|=0.0207  |maxRot[o]|= 0.02
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5131512581343  dE = -1.7768366e-05  S^2 = 0.0000000
               |grad[o]|=0.00142  |ddm|=0.00715  |maxRot[o]|=0.00888
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5131537359664  dE = -2.4778321e-06  S^2 = 0.0000000
               |grad[o]|=0.000543  |ddm|=0.00276  |maxRot[o]|=0.00337
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5131540649679  dE = -3.2900155e-07  S^2 = 0.0000000
               |grad[o]|=0.000202  |ddm|=0.000999  |maxRot[o]|=0.00124
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5131541079163  dE = -4.2948386e-08  S^2 = 0.0000000
               |grad[o]|=7.36e-05  |ddm|=0.000361  |maxRot[o]|=0.000449
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5131541134675  dE = -5.5512288e-09  S^2 = 0.0000000
               |grad[o]|=2.66e-05  |ddm|=0.00013  |maxRot[o]|=0.000162
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5131541141773  dE = -7.0980377e-10  S^2 = 0.0000000
               |grad[o]|=9.58e-06  |ddm|=4.67e-05  |maxRot[o]|=5.83e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5131541142658  dE = -8.8505203e-11  S^2 = 0.0000000
               |grad[o]|=3.46e-06  |ddm|=1.68e-05  |maxRot[o]|=2.1e-05
2-step CASSCF converged in 16 macro (65 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96506513 1.92787018 1.90242015 1.83461648 0.08106132 0.17170008
 0.05932555 0.0579411 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01001   0.00958  -0.00569   0.00000   0.00000
  0 C 2s       0.60769   0.64161  -0.36054  -0.00000   0.00000
  0 C 3s      -0.02394   0.01781  -0.04989  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69498
  0 C 2py     -0.00000   0.00000  -0.00000   0.70448  -0.00000
  0 C 2pz      0.35831  -0.29606   0.60517  -0.00000  -0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.05520
  0 C 3py     -0.00000   0.00000   0.00000   0.04615   0.00000
  0 C 3pz     -0.02386  -0.00271   0.00109  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03981  -0.00000
  0 C 3dz^2    0.03287  -0.01476   0.03469  -0.00000  -0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.11816
 0 C 3dx2-y2  -0.00145   0.00725  -0.00749   0.00000  -0.00000
  1 C 1s       0.01001  -0.00958  -0.00569   0.00000   0.00000
  1 C 2s       0.60769  -0.64161  -0.36054   0.00000   0.00000
  1 C 3s      -0.02394  -0.01781  -0.04989   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69498
  1 C 2py      0.00000  -0.00000   0.00000   0.70448   0.00000
  1 C 2pz     -0.35831  -0.29606  -0.60517  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05520
  1 C 3py      0.00000  -0.00000  -0.00000   0.04615   0.00000
  1 C 3pz      0.02386  -0.00271  -0.00109  -0.00000   0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03981  -0.00000
  1 C 3dz^2    0.03287   0.01476   0.03469   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11816
 1 C 3dx2-y2  -0.00145  -0.00725  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00052
  0 C 2s      -0.00000   0.00000   0.29408
  0 C 3s      -0.00000  -0.00000   0.03931
  0 C 2px      0.00000   0.69713  -0.00000
  0 C 2py      0.70661   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.63885
  0 C 3px      0.00000   0.00311  -0.00000
  0 C 3py     -0.02293   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05440
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01349   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.01292
  0 C 3dxz     0.00000  -0.11834  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02684
  1 C 1s       0.00000   0.00000   0.00052
  1 C 2s       0.00000   0.00000  -0.29408
  1 C 3s       0.00000   0.00000  -0.03931
  1 C 2px     -0.00000  -0.69713   0.00000
  1 C 2py     -0.70661  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.63885
  1 C 3px     -0.00000  -0.00311   0.00000
  1 C 3py      0.02293  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.05440
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01349   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.01292
  1 C 3dxz     0.00000  -0.11834  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02684
<CAS-nat-orb|mo-hf>  3  3    0.98958162
<CAS-nat-orb|mo-hf>  4  4    0.99975150
<CAS-nat-orb|mo-hf>  5  5    0.98959416
<CAS-nat-orb|mo-hf>  6  6    0.99925428
<CAS-nat-orb|mo-hf>  7  7    0.94209804
<CAS-nat-orb|mo-hf>  8  8    0.97102424
<CAS-nat-orb|mo-hf>  9  9    0.95858985
<CAS-nat-orb|mo-hf>  10  10    0.86001483
<CAS-nat-orb|mo-hf>  10  11   -0.48380369
CASSCF energy = -75.5131541142658
CASCI E = -75.5131541142658  E(CI) = -15.7189305753107  S^2 = 0.0000000
Time cost =    343.165
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:52:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.746284796036 AA    0.000000000000   0.000000000000   3.300000000000 Bohr   0.0

nuclear repulsion = 10.9090909090909
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.65]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     14461.71


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpzntdiy3y
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.842256067793

WARN: Singularity detected in overlap matrix (condition number =  141). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.131475269334874  LUMO (B3u) = -0.131475269334873

WARN: B2u HOMO -0.131475269334874 > system LUMO -0.131475269334873

cycle= 1 E= -75.3268751185369  delta_E= -0.485  |g|= 0.254  |ddm|= 1.52
HOMO (B2u) = -0.392977692990133  LUMO (B3u) = -0.0727206501017172
cycle= 2 E= -75.3522841088372  delta_E= -0.0254  |g|= 0.0519  |ddm|= 0.352
HOMO (B2u) = -0.355147584178279  LUMO (B3u) = -0.0300222920891309
cycle= 3 E= -75.3537386656222  delta_E= -0.00145  |g|= 0.0182  |ddm|= 0.0689
HOMO (B2u) = -0.359671017046591  LUMO (B3u) = -0.0344578300630357
cycle= 4 E= -75.3539592586541  delta_E= -0.000221  |g|= 0.000688  |ddm|= 0.0377
HOMO (B2u) = -0.359764894042611  LUMO (B3u) = -0.0346976899212325
cycle= 5 E= -75.3539594435199  delta_E= -1.85e-07  |g|= 9.37e-05  |ddm|= 0.00109
HOMO (B2u) = -0.359730880125602  LUMO (B3u) = -0.0346640305640362
cycle= 6 E= -75.3539594484633  delta_E= -4.94e-09  |g|= 1.51e-05  |ddm|= 0.000157
HOMO (B2u) = -0.359729026578317  LUMO (B3u) = -0.0346652386509569
cycle= 7 E= -75.3539594486084  delta_E= -1.45e-10  |g|= 1.94e-06  |ddm|= 3.44e-05
HOMO (B2u) = -0.359728331017221  LUMO (B3u) = -0.0346649076945234
cycle= 8 E= -75.3539594486109  delta_E= -2.47e-12  |g|= 1.14e-07  |ddm|= 4.16e-06
HOMO (B2u) = -0.359728345183667  LUMO (B3u) = -0.0346649176995452
cycle= 9 E= -75.3539594486109  delta_E=    0  |g|= 6.91e-09  |ddm|= 2.29e-07
HOMO (B2u) = -0.359728345818887  LUMO (B3u) = -0.0346649199382481
cycle= 10 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 4.83e-09  |ddm|= 7.44e-09
HOMO (B2u) = -0.359728345623764  LUMO (B3u) = -0.0346649197155934
cycle= 11 E= -75.3539594486108  delta_E=    0  |g|= 3.95e-09  |ddm|= 4.02e-09
HOMO (B2u) = -0.359728344324628  LUMO (B3u) = -0.0346649183510556
cycle= 12 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 3.62e-09  |ddm|= 1.86e-09
HOMO (B2u) = -0.359728344700679  LUMO (B3u) = -0.0346649187079881
cycle= 13 E= -75.3539594486108  delta_E= 4.26e-14  |g|= 3.21e-09  |ddm|= 9.29e-10
HOMO (B2u) = -0.359728344322766  LUMO (B3u) = -0.0346649183502918
cycle= 14 E= -75.3539594486109  delta_E= -9.95e-14  |g|= 3.93e-10  |ddm|= 4.6e-09
HOMO (B2u) = -0.359728344496079  LUMO (B3u) = -0.034664918455161
cycle= 15 E= -75.3539594486108  delta_E= 4.26e-14  |g|= 5.49e-10  |ddm|= 1.31e-09
HOMO (B2u) = -0.35972834440252  LUMO (B3u) = -0.03466491846097
cycle= 16 E= -75.3539594486108  delta_E= 7.11e-14  |g|= 6.5e-10  |ddm|= 1.26e-09
HOMO (B2u) = -0.359728344445211  LUMO (B3u) = -0.0346649184557645
cycle= 17 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 6.39e-10  |ddm|= 8.11e-10
HOMO (B2u) = -0.359728344433404  LUMO (B3u) = -0.0346649184359171
cycle= 18 E= -75.3539594486109  delta_E= -8.53e-14  |g|= 4.57e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.359728344445422  LUMO (B3u) = -0.0346649184497833
cycle= 19 E= -75.3539594486109  delta_E= 1.42e-14  |g|= 3.95e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.359728344459173  LUMO (B3u) = -0.034664918464453
cycle= 20 E= -75.3539594486109  delta_E=    0  |g|= 3.17e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.359728344458614  LUMO (B3u) = -0.0346649184619473
cycle= 21 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 2.19e-10  |ddm|= 1.63e-10
HOMO (B2u) = -0.359728344461016  LUMO (B3u) = -0.0346649184640404
cycle= 22 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 1.26e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.359728344460417  LUMO (B3u) = -0.0346649184621494
cycle= 23 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 1.24e-10  |ddm|= 1.77e-11
HOMO (B2u) = -0.359728344456517  LUMO (B3u) = -0.0346649184600698
cycle= 24 E= -75.3539594486108  delta_E=    0  |g|= 1.11e-10  |ddm|= 4.67e-11
HOMO (B2u) = -0.359728344457843  LUMO (B3u) = -0.0346649184591133
cycle= 25 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 9.04e-11  |ddm|= 4.75e-11
HOMO (B2u) = -0.359728344457601  LUMO (B3u) = -0.0346649184583848
cycle= 26 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 7.25e-11  |ddm|= 3.21e-11
HOMO (B2u) = -0.359728344457094  LUMO (B3u) = -0.0346649184576502
cycle= 27 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 6.08e-11  |ddm|= 2.13e-11
HOMO (B2u) = -0.359728344456739  LUMO (B3u) = -0.0346649184570248
cycle= 28 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 4.83e-11  |ddm|= 2.38e-11
HOMO (B2u) = -0.359728344456629  LUMO (B3u) = -0.0346649184566587
cycle= 29 E= -75.3539594486108  delta_E=    0  |g|= 3.76e-11  |ddm|= 2.11e-11
HOMO (B2u) = -0.35972834445638  LUMO (B3u) = -0.0346649184557664
Extra cycle  E= -75.3539594486108  delta_E= -2.84e-14  |g|= 1.41e-11  |ddm|= 4.84e-11
converged SCF energy = -75.3539594486108

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpzntdiy3y
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4605852262833  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4728649095986  dE = -0.012279683  S^2 = 0.0000000
               |grad[o]|=0.0845  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4835908921768  dE = -0.010725983  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0629  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4924933536915  dE = -0.0089024615  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.0412  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4995415975463  dE = -0.0070482439  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0503  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5045613523459  dE = -0.0050197548  S^2 = 0.0000000
               |grad[o]|=0.0383  |ddm|=0.0585  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5070403288406  dE = -0.0024789765  S^2 = 0.0000000
               |grad[o]|=0.0222  |ddm|=0.0398  |maxRot[o]|= 0.06
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5078465774012  dE = -0.00080624856  S^2 = 0.0000000
               |grad[o]|=0.0105  |ddm|=0.0554  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5081670994056  dE = -0.000320522  S^2 = 0.0000000
               |grad[o]|=0.00584  |ddm|=0.0262  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5082201129814  dE = -5.3013576e-05  S^2 = 0.0000000
               |grad[o]|=0.0024  |ddm|=0.0133  |maxRot[o]|=0.0153
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5082271260863  dE = -7.0131049e-06  S^2 = 0.0000000
               |grad[o]|=0.000905  |ddm|=0.00451  |maxRot[o]|=0.00572
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5082279839393  dE = -8.5785301e-07  S^2 = 0.0000000
               |grad[o]|=0.000325  |ddm|=0.00156  |maxRot[o]|=0.00202
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5082280860406  dE = -1.0210127e-07  S^2 = 0.0000000
               |grad[o]|=0.000114  |ddm|=0.000538  |maxRot[o]|=0.0007
macro iter 13 (2 JK  0 micro), CASSCF E = -75.508228098037  dE = -1.1996448e-08  S^2 = 0.0000000
               |grad[o]|=3.95e-05  |ddm|=0.000185  |maxRot[o]|=0.000241
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5082280994326  dE = -1.3956196e-09  S^2 = 0.0000000
               |grad[o]|=1.37e-05  |ddm|=6.4e-05  |maxRot[o]|=8.32e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5082280995928  dE = -1.6014212e-10  S^2 = 0.0000000
               |grad[o]|=4.71e-06  |ddm|=2.19e-05  |maxRot[o]|=2.86e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.508228099607  dE = -1.4239276e-11  S^2 = 0.0000000
               |grad[o]|=1.56e-06  |ddm|=7e-06  |maxRot[o]|=9.46e-06
2-step CASSCF converged in 16 macro (63 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96387359 1.92858695 1.90144122 1.82466897 0.07878278 0.18160432
 0.05902031 0.06202185]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01031   0.00970  -0.00544   0.00000   0.00000
  0 C 2s       0.61830   0.64554  -0.34208   0.00000  -0.00000
  0 C 3s      -0.02094   0.01752  -0.04828   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69463
  0 C 2py      0.00000  -0.00000   0.00000   0.70445   0.00000
  0 C 2pz      0.34017  -0.28744   0.61591   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.05672
  0 C 3py     -0.00000   0.00000   0.00000   0.04759  -0.00000
  0 C 3pz     -0.02200  -0.00251   0.00227   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.03863  -0.00000
  0 C 3dz^2    0.03108  -0.01437   0.03487   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.11945
 0 C 3dx2-y2  -0.00117   0.00712  -0.00747   0.00000  -0.00000
  1 C 1s       0.01031  -0.00970  -0.00544   0.00000   0.00000
  1 C 2s       0.61830  -0.64554  -0.34208   0.00000   0.00000
  1 C 3s      -0.02094  -0.01752  -0.04828  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69463
  1 C 2py      0.00000  -0.00000  -0.00000   0.70445   0.00000
  1 C 2pz     -0.34017  -0.28744  -0.61591   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.05672
  1 C 3py     -0.00000   0.00000  -0.00000   0.04759  -0.00000
  1 C 3pz      0.02200  -0.00251  -0.00227   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.03863   0.00000
  1 C 3dz^2    0.03108   0.01437   0.03487  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.11945
 1 C 3dx2-y2  -0.00117  -0.00712  -0.00747   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00049
  0 C 2s       0.00000  -0.00000   0.28563
  0 C 3s       0.00000  -0.00000   0.03833
  0 C 2px     -0.00000   0.69726  -0.00000
  0 C 2py      0.70668  -0.00000   0.00000
  0 C 2pz      0.00000  -0.00000   0.64303
  0 C 3px     -0.00000   0.00091  -0.00000
  0 C 3py     -0.02081  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.05165
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.01306  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.01176
  0 C 3dxz    -0.00000  -0.11759  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02562
  1 C 1s       0.00000   0.00000   0.00049
  1 C 2s      -0.00000   0.00000  -0.28563
  1 C 3s      -0.00000   0.00000  -0.03833
  1 C 2px      0.00000  -0.69726  -0.00000
  1 C 2py     -0.70668   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.64303
  1 C 3px      0.00000  -0.00091   0.00000
  1 C 3py      0.02081   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.05165
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01306  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.01176
  1 C 3dxz    -0.00000  -0.11759  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.02562
<CAS-nat-orb|mo-hf>  3  3    0.99201756
<CAS-nat-orb|mo-hf>  4  4    0.99974451
<CAS-nat-orb|mo-hf>  5  5    0.99203281
<CAS-nat-orb|mo-hf>  6  6    0.99920694
<CAS-nat-orb|mo-hf>  7  7    0.94066257
<CAS-nat-orb|mo-hf>  8  8    0.97275729
<CAS-nat-orb|mo-hf>  9  9    0.95891046
<CAS-nat-orb|mo-hf>  10  10    0.87431676
<CAS-nat-orb|mo-hf>  10  11   -0.46069473
CASSCF energy = -75.508228099607
CASCI E = -75.508228099607  E(CI) = -15.6395663675253  S^2 = 0.0000000
Time cost =    484.070
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:00:33 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.772743656582 AA    0.000000000000   0.000000000000   3.350000000000 Bohr   0.0

nuclear repulsion = 10.7462686567164
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.675]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     14954.75


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp83qek__n
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8226756263582

WARN: Singularity detected in overlap matrix (condition number =  131). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.127455322759627  LUMO (B3u) = -0.127455322759628

WARN: B2u HOMO -0.127455322759627 > system LUMO -0.127455322759628

cycle= 1 E= -75.3190207821597  delta_E= -0.496  |g|= 0.252  |ddm|= 1.51
HOMO (B2u) = -0.38827677967466  LUMO (B3u) = -0.0699328749080262
cycle= 2 E= -75.3440245529483  delta_E= -0.025  |g|= 0.0513  |ddm|= 0.351
HOMO (B2u) = -0.351016713810029  LUMO (B3u) = -0.0278350417389983
cycle= 3 E= -75.3454675220221  delta_E= -0.00144  |g|= 0.0181  |ddm|= 0.0681
HOMO (B2u) = -0.355529260678001  LUMO (B3u) = -0.032245880880217
cycle= 4 E= -75.3456894433558  delta_E= -0.000222  |g|= 0.000681  |ddm|= 0.0375
HOMO (B2u) = -0.355644927845468  LUMO (B3u) = -0.0325087452095942
cycle= 5 E= -75.3456896230235  delta_E= -1.8e-07  |g|= 9.78e-05  |ddm|= 0.00103
HOMO (B2u) = -0.355609613190059  LUMO (B3u) = -0.0324745833916054
cycle= 6 E= -75.3456896284285  delta_E= -5.41e-09  |g|= 1.56e-05  |ddm|= 0.000165
HOMO (B2u) = -0.355607628482637  LUMO (B3u) = -0.0324756124305648
cycle= 7 E= -75.3456896285829  delta_E= -1.54e-10  |g|= 1.94e-06  |ddm|= 3.47e-05
HOMO (B2u) = -0.355606961355026  LUMO (B3u) = -0.0324753268421873
cycle= 8 E= -75.3456896285854  delta_E= -2.56e-12  |g|= 1.17e-07  |ddm|= 4.13e-06
HOMO (B2u) = -0.355606972650442  LUMO (B3u) = -0.0324753336784406
cycle= 9 E= -75.3456896285853  delta_E= 1.14e-13  |g|= 7.02e-09  |ddm|= 2.39e-07
HOMO (B2u) = -0.355606973128452  LUMO (B3u) = -0.0324753357933438
cycle= 10 E= -75.3456896285855  delta_E= -1.42e-13  |g|= 5.11e-09  |ddm|= 7.54e-09
HOMO (B2u) = -0.355606972922101  LUMO (B3u) = -0.0324753355647659
cycle= 11 E= -75.3456896285854  delta_E= 8.53e-14  |g|= 4.02e-09  |ddm|= 4.14e-09
HOMO (B2u) = -0.355606971599796  LUMO (B3u) = -0.0324753341760653
cycle= 12 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 3.67e-09  |ddm|= 1.89e-09
HOMO (B2u) = -0.355606971984005  LUMO (B3u) = -0.0324753345458587
cycle= 13 E= -75.3456896285855  delta_E= -8.53e-14  |g|= 3.28e-09  |ddm|= 1.07e-09
HOMO (B2u) = -0.355606971978462  LUMO (B3u) = -0.0324753345651646
cycle= 14 E= -75.3456896285855  delta_E= 2.84e-14  |g|= 3.08e-09  |ddm|= 7.32e-10
HOMO (B2u) = -0.355606971764091  LUMO (B3u) = -0.0324753342956293
cycle= 15 E= -75.3456896285855  delta_E=    0  |g|= 7.16e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.355606971674186  LUMO (B3u) = -0.0324753342946194
cycle= 16 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 7.7e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.355606971704582  LUMO (B3u) = -0.0324753342894631
cycle= 17 E= -75.3456896285855  delta_E= -5.68e-14  |g|= 7.69e-10  |ddm|= 6.14e-10
HOMO (B2u) = -0.355606971687394  LUMO (B3u) = -0.0324753342673283
cycle= 18 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 5.86e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.355606971696382  LUMO (B3u) = -0.0324753342793342
cycle= 19 E= -75.3456896285854  delta_E=    0  |g|= 5.26e-10  |ddm|= 2.51e-10
HOMO (B2u) = -0.355606971707026  LUMO (B3u) = -0.032475334292072
cycle= 20 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 4.51e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.355606971703303  LUMO (B3u) = -0.032475334287599
cycle= 21 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 3.58e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.355606971703003  LUMO (B3u) = -0.0324753342880904
cycle= 22 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 2.68e-10  |ddm|= 1.69e-10
HOMO (B2u) = -0.355606971703312  LUMO (B3u) = -0.0324753342883327
cycle= 23 E= -75.3456896285854  delta_E= -5.68e-14  |g|= 1.73e-10  |ddm|= 1.82e-10
HOMO (B2u) = -0.355606971698461  LUMO (B3u) = -0.032475334285736
cycle= 24 E= -75.3456896285854  delta_E=    0  |g|= 1.54e-10  |ddm|= 5.83e-11
HOMO (B2u) = -0.355606971698413  LUMO (B3u) = -0.0324753342842458
cycle= 25 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 1.3e-10  |ddm|= 5.1e-11
HOMO (B2u) = -0.3556069716972  LUMO (B3u) = -0.0324753342829316
cycle= 26 E= -75.3456896285853  delta_E= 5.68e-14  |g|= 1.08e-10  |ddm|= 4.42e-11
HOMO (B2u) = -0.355606971695944  LUMO (B3u) = -0.032475334281722
cycle= 27 E= -75.3456896285854  delta_E= -5.68e-14  |g|= 9.28e-11  |ddm|= 3.29e-11
HOMO (B2u) = -0.355606971694922  LUMO (B3u) = -0.0324753342806672
cycle= 28 E= -75.3456896285855  delta_E= -5.68e-14  |g|= 7.61e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.355606971694214  LUMO (B3u) = -0.0324753342798987
cycle= 29 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 6.08e-11  |ddm|= 3.16e-11
HOMO (B2u) = -0.355606971693556  LUMO (B3u) = -0.0324753342792199
cycle= 30 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 4.82e-11  |ddm|= 2.62e-11
HOMO (B2u) = -0.355606971693066  LUMO (B3u) = -0.0324753342787099
cycle= 31 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 3.86e-11  |ddm|= 2.02e-11
HOMO (B2u) = -0.355606971692726  LUMO (B3u) = -0.0324753342783864
cycle= 32 E= -75.3456896285854  delta_E=    0  |g|= 3.26e-11  |ddm|= 1.3e-11
HOMO (B2u) = -0.355606971691862  LUMO (B3u) = -0.0324753342773774
Extra cycle  E= -75.3456896285854  delta_E= -2.84e-14  |g|= 1.25e-11  |ddm|= 4.29e-11
converged SCF energy = -75.3456896285854

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp83qek__n
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4564838553946  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4691733729363  dE = -0.012689518  S^2 = 0.0000000
               |grad[o]|=0.0865  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4801083821051  dE = -0.010935009  S^2 = 0.0000000
               |grad[o]|=0.0752  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4889631035533  dE = -0.0088547214  S^2 = 0.0000000
               |grad[o]|=0.0624  |ddm|=0.0406  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4957789712892  dE = -0.0068158677  S^2 = 0.0000000
               |grad[o]|=0.0491  |ddm|=0.0471  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5005605118449  dE = -0.0047815406  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.0609  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5027257962514  dE = -0.0021652844  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.0448  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5031948312489  dE = -0.000469035  S^2 = 0.0000000
               |grad[o]|=0.00722  |ddm|=0.0469  |maxRot[o]|= 0.04
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5032865778876  dE = -9.1746639e-05  S^2 = 0.0000000
               |grad[o]|=0.00309  |ddm|=0.0149  |maxRot[o]|= 0.02
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5032982747811  dE = -1.1696894e-05  S^2 = 0.0000000
               |grad[o]|=0.00115  |ddm|=0.00551  |maxRot[o]|=0.00744
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5032995997978  dE = -1.3250166e-06  S^2 = 0.0000000
               |grad[o]|=0.000405  |ddm|=0.00187  |maxRot[o]|=0.00253
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5032997456182  dE = -1.4582044e-07  S^2 = 0.0000000
               |grad[o]|=0.000138  |ddm|=0.000621  |maxRot[o]|=0.000845
macro iter 12 (2 JK  0 micro), CASSCF E = -75.5032997614882  dE = -1.587e-08  S^2 = 0.0000000
               |grad[o]|=4.59e-05  |ddm|=0.000206  |maxRot[o]|=0.000279
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5032997632074  dE = -1.7191724e-09  S^2 = 0.0000000
               |grad[o]|=1.52e-05  |ddm|=6.73e-05  |maxRot[o]|=9.2e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5032997633895  dE = -1.8212631e-10  S^2 = 0.0000000
               |grad[o]|=5.06e-06  |ddm|=2.27e-05  |maxRot[o]|=3.05e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5032997634144  dE = -2.4840574e-11  S^2 = 0.0000000
               |grad[o]|=1.69e-06  |ddm|=7.63e-06  |maxRot[o]|=1.01e-05
2-step CASSCF converged in 15 macro (59 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96274301 1.92928247 1.89992238 1.8142028  0.07676462 0.19201084
 0.05872205 0.06635183]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01059   0.00982  -0.00515   0.00000   0.00000
  0 C 2s       0.62877   0.64927  -0.32247   0.00000   0.00000
  0 C 3s      -0.01802   0.01723  -0.04662  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69435
  0 C 2py     -0.00000   0.00000  -0.00000   0.70442   0.00000
  0 C 2pz      0.32084  -0.27893   0.62651  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000  -0.05813
  0 C 3py     -0.00000   0.00000  -0.00000   0.04890  -0.00000
  0 C 3pz     -0.02026  -0.00235   0.00351  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03743  -0.00000
  0 C 3dz^2    0.02926  -0.01397   0.03504  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000  -0.12042
 0 C 3dx2-y2  -0.00088   0.00700  -0.00745  -0.00000   0.00000
  1 C 1s       0.01059  -0.00982  -0.00515   0.00000   0.00000
  1 C 2s       0.62877  -0.64927  -0.32247   0.00000  -0.00000
  1 C 3s      -0.01802  -0.01723  -0.04662   0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70442   0.00000
  1 C 2pz     -0.32084  -0.27893  -0.62651  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.05813
  1 C 3py      0.00000  -0.00000   0.00000   0.04890  -0.00000
  1 C 3pz      0.02026  -0.00235  -0.00351  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.03743   0.00000
  1 C 3dz^2    0.02926   0.01397   0.03504   0.00000  -0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12042
 1 C 3dx2-y2  -0.00088  -0.00700  -0.00745   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00046
  0 C 2s      -0.00000   0.00000   0.27729
  0 C 3s      -0.00000   0.00000   0.03734
  0 C 2px     -0.00000   0.69739   0.00000
  0 C 2py      0.70675   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.64700
  0 C 3px     -0.00000  -0.00124   0.00000
  0 C 3py     -0.01872   0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.04893
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01263  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01067
  0 C 3dxz     0.00000  -0.11680   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.02442
  1 C 1s       0.00000   0.00000   0.00046
  1 C 2s      -0.00000  -0.00000  -0.27729
  1 C 3s       0.00000  -0.00000  -0.03734
  1 C 2px     -0.00000  -0.69739  -0.00000
  1 C 2py     -0.70675   0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.64700
  1 C 3px      0.00000   0.00124  -0.00000
  1 C 3py      0.01872  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04893
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01263  -0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01067
  1 C 3dxz    -0.00000  -0.11680   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02442
<CAS-nat-orb|mo-hf>  3  3    0.99427993
<CAS-nat-orb|mo-hf>  4  4    0.99973720
<CAS-nat-orb|mo-hf>  5  5    0.99429720
<CAS-nat-orb|mo-hf>  6  6    0.99915774
<CAS-nat-orb|mo-hf>  7  7    0.93938547
<CAS-nat-orb|mo-hf>  8  8    0.97438152
<CAS-nat-orb|mo-hf>  9  9    0.95919913
<CAS-nat-orb|mo-hf>  10  10    0.88692941
<CAS-nat-orb|mo-hf>  10  11   -0.43885970
CASSCF energy = -75.5032997634144
CASCI E = -75.5032997634144  E(CI) = -15.5624178249739  S^2 = 0.0000000
Time cost =    478.320
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:08:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.799202517128 AA    0.000000000000   0.000000000000   3.400000000000 Bohr   0.0

nuclear repulsion = 10.5882352941176
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.7]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     15566.35


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpm6xfy8ph
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8043126951475

WARN: Singularity detected in overlap matrix (condition number =  122). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.123626145223849  LUMO (B3u) = -0.123626145223849

WARN: B2u HOMO -0.123626145223849 > system LUMO -0.123626145223849

cycle= 1 E= -75.3111334513161  delta_E= -0.507  |g|= 0.249  |ddm|=  1.5
HOMO (B2u) = -0.383724747851056  LUMO (B3u) = -0.0672275188573607
cycle= 2 E= -75.3357364104633  delta_E= -0.0246  |g|= 0.0507  |ddm|= 0.351
HOMO (B2u) = -0.347026718276068  LUMO (B3u) = -0.0257227421999432
cycle= 3 E= -75.337165289928  delta_E= -0.00143  |g|= 0.0181  |ddm|= 0.0673
HOMO (B2u) = -0.351526070447291  LUMO (B3u) = -0.0301077062023757
cycle= 4 E= -75.3373878233178  delta_E= -0.000223  |g|= 0.000675  |ddm|= 0.0372
HOMO (B2u) = -0.351660112314436  LUMO (B3u) = -0.0303898359337087
cycle= 5 E= -75.3373879985295  delta_E= -1.75e-07  |g|= 0.000102  |ddm|= 0.000975
HOMO (B2u) = -0.351623840121637  LUMO (B3u) = -0.0303555719623957
cycle= 6 E= -75.3373880044287  delta_E= -5.9e-09  |g|= 1.61e-05  |ddm|= 0.000173
HOMO (B2u) = -0.351621725064421  LUMO (B3u) = -0.0303564386936776
cycle= 7 E= -75.3373880045928  delta_E= -1.64e-10  |g|= 1.94e-06  |ddm|= 3.52e-05
HOMO (B2u) = -0.351621087023845  LUMO (B3u) = -0.0303561953011996
cycle= 8 E= -75.3373880045953  delta_E= -2.5e-12  |g|= 1.2e-07  |ddm|= 4.09e-06
HOMO (B2u) = -0.351621096028033  LUMO (B3u) = -0.0303561996522923
cycle= 9 E= -75.3373880045953  delta_E=    0  |g|= 7.3e-09  |ddm|= 2.5e-07
HOMO (B2u) = -0.351621096337519  LUMO (B3u) = -0.0303562016409784
cycle= 10 E= -75.3373880045952  delta_E= 5.68e-14  |g|= 5.48e-09  |ddm|= 7.67e-09
HOMO (B2u) = -0.351621096124651  LUMO (B3u) = -0.0303562014134634
cycle= 11 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 4.19e-09  |ddm|= 4.33e-09
HOMO (B2u) = -0.351621094785491  LUMO (B3u) = -0.0303562000105381
cycle= 12 E= -75.3373880045953  delta_E= -5.68e-14  |g|= 3.79e-09  |ddm|= 2e-09
HOMO (B2u) = -0.351621095168724  LUMO (B3u) = -0.0303562003841343
cycle= 13 E= -75.3373880045952  delta_E= 8.53e-14  |g|= 3.4e-09  |ddm|= 1.23e-09
HOMO (B2u) = -0.351621095129872  LUMO (B3u) = -0.0303562003623194
cycle= 14 E= -75.3373880045951  delta_E= 5.68e-14  |g|= 3.04e-09  |ddm|= 6.93e-10
HOMO (B2u) = -0.351621094932056  LUMO (B3u) = -0.030356200138318
cycle= 15 E= -75.3373880045952  delta_E= -5.68e-14  |g|= 7.9e-10  |ddm|= 4.8e-09
HOMO (B2u) = -0.351621094828889  LUMO (B3u) = -0.0303562001338855
cycle= 16 E= -75.3373880045952  delta_E=    0  |g|= 8.05e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.351621094865973  LUMO (B3u) = -0.0303562001249918
cycle= 17 E= -75.3373880045952  delta_E= -4.26e-14  |g|= 8.23e-10  |ddm|= 8.24e-10
HOMO (B2u) = -0.351621094843627  LUMO (B3u) = -0.0303562001009416
cycle= 18 E= -75.3373880045952  delta_E= 4.26e-14  |g|= 6.29e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.351621094849393  LUMO (B3u) = -0.0303562001110902
cycle= 19 E= -75.3373880045952  delta_E= -1.42e-14  |g|= 5.5e-10  |ddm|= 3.07e-10
HOMO (B2u) = -0.351621094856912  LUMO (B3u) = -0.0303562001220048
cycle= 20 E= -75.3373880045952  delta_E= 1.42e-14  |g|= 4.68e-10  |ddm|= 2.06e-10
HOMO (B2u) = -0.35162109485013  LUMO (B3u) = -0.0303562001156935
cycle= 21 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 3.7e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.351621094847086  LUMO (B3u) = -0.0303562001145369
cycle= 22 E= -75.3373880045953  delta_E= -8.53e-14  |g|= 2.74e-10  |ddm|= 1.96e-10
HOMO (B2u) = -0.351621094844434  LUMO (B3u) = -0.0303562001131761
cycle= 23 E= -75.3373880045952  delta_E= 7.11e-14  |g|= 1.83e-10  |ddm|= 1.88e-10
HOMO (B2u) = -0.351621094838947  LUMO (B3u) = -0.0303562001103489
cycle= 24 E= -75.3373880045953  delta_E= -8.53e-14  |g|= 1.61e-10  |ddm|= 6.43e-11
HOMO (B2u) = -0.351621094838502  LUMO (B3u) = -0.0303562001084844
cycle= 25 E= -75.3373880045952  delta_E= 7.11e-14  |g|= 1.36e-10  |ddm|= 5.73e-11
HOMO (B2u) = -0.351621094836494  LUMO (B3u) = -0.0303562001067911
cycle= 26 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 1.12e-10  |ddm|= 5.33e-11
HOMO (B2u) = -0.351621094834668  LUMO (B3u) = -0.0303562001053147
cycle= 27 E= -75.3373880045951  delta_E= 2.84e-14  |g|= 9.56e-11  |ddm|= 4.01e-11
HOMO (B2u) = -0.351621094833172  LUMO (B3u) = -0.0303562001040478
cycle= 28 E= -75.3373880045953  delta_E= -1.14e-13  |g|= 7.83e-11  |ddm|= 3.82e-11
HOMO (B2u) = -0.351621094832071  LUMO (B3u) = -0.0303562001031021
cycle= 29 E= -75.3373880045952  delta_E= 7.11e-14  |g|= 6.25e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.351621094831097  LUMO (B3u) = -0.0303562001022816
cycle= 30 E= -75.3373880045952  delta_E=    0  |g|= 4.96e-11  |ddm|= 2.81e-11
HOMO (B2u) = -0.351621094828886  LUMO (B3u) = -0.0303562001003539
Extra cycle  E= -75.3373880045952  delta_E= -1.42e-14  |g|= 1.88e-11  |ddm|= 6.8e-11
converged SCF energy = -75.3373880045952

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpm6xfy8ph
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4523708352865  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4654802673704  dE = -0.013109432  S^2 = 0.0000000
               |grad[o]|=0.0884  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4766184169963  dE = -0.01113815  S^2 = 0.0000000
               |grad[o]|=0.0759  |ddm|=0.0715  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4854060650747  dE = -0.0087876481  S^2 = 0.0000000
               |grad[o]|=0.0617  |ddm|=0.0413  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4919732081353  dE = -0.0065671431  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.048  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4965052075401  dE = -0.0045319994  S^2 = 0.0000000
               |grad[o]|=0.0318  |ddm|=0.0653  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4980364476445  dE = -0.0015312401  S^2 = 0.0000000
               |grad[o]|=0.0142  |ddm|=0.0476  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.498350847831  dE = -0.00031440019  S^2 = 0.0000000
               |grad[o]|=0.00565  |ddm|=0.0316  |maxRot[o]|=0.0358
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4983917552916  dE = -4.0907461e-05  S^2 = 0.0000000
               |grad[o]|=0.0021  |ddm|=0.0103  |maxRot[o]|=0.0138
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4983962080756  dE = -4.452784e-06  S^2 = 0.0000000
               |grad[o]|=0.000736  |ddm|=0.0033  |maxRot[o]|=0.00467
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4983966685695  dE = -4.6049382e-07  S^2 = 0.0000000
               |grad[o]|=0.000246  |ddm|=0.00107  |maxRot[o]|=0.00151
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4983967154179  dE = -4.6848484e-08  S^2 = 0.0000000
               |grad[o]|=7.99e-05  |ddm|=0.000342  |maxRot[o]|=0.000483
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4983967201882  dE = -4.7702144e-09  S^2 = 0.0000000
               |grad[o]|=2.57e-05  |ddm|=0.000109  |maxRot[o]|=0.000155
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4983967206664  dE = -4.7829474e-10  S^2 = 0.0000000
               |grad[o]|=8.2e-06  |ddm|=3.47e-05  |maxRot[o]|=4.91e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4983967207139  dE = -4.7407411e-11  S^2 = 0.0000000
               |grad[o]|=2.59e-06  |ddm|=1.1e-05  |maxRot[o]|=1.54e-05
2-step CASSCF converged in 14 macro (57 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96168427 1.92995961 1.89788677 1.80319402 0.07495279 0.20294448
 0.05842681 0.07095125]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01086   0.00993  -0.00483   0.00000   0.00000
  0 C 2s       0.63886   0.65282  -0.30204  -0.00000  -0.00000
  0 C 3s      -0.01519   0.01695  -0.04490  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69411
  0 C 2py      0.00000  -0.00000  -0.00000   0.70440   0.00000
  0 C 2pz      0.30069  -0.27056   0.63672  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.05943
  0 C 3py      0.00000  -0.00000  -0.00000   0.05007   0.00000
  0 C 3pz     -0.01863  -0.00220   0.00482  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03622   0.00000
  0 C 3dz^2    0.02743  -0.01357   0.03519  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.12113
 0 C 3dx2-y2  -0.00059   0.00688  -0.00742  -0.00000  -0.00000
  1 C 1s       0.01086  -0.00993  -0.00483   0.00000   0.00000
  1 C 2s       0.63886  -0.65282  -0.30204   0.00000  -0.00000
  1 C 3s      -0.01519  -0.01695  -0.04490   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69411
  1 C 2py     -0.00000   0.00000   0.00000   0.70440  -0.00000
  1 C 2pz     -0.30069  -0.27056  -0.63672  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.05943
  1 C 3py     -0.00000   0.00000   0.00000   0.05007  -0.00000
  1 C 3pz      0.01863  -0.00220  -0.00482  -0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03622   0.00000
  1 C 3dz^2    0.02743   0.01357   0.03519   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12113
 1 C 3dx2-y2  -0.00059  -0.00688  -0.00742   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00043
  0 C 2s      -0.00000  -0.00000   0.26907
  0 C 3s      -0.00000  -0.00000   0.03634
  0 C 2px      0.00000   0.69753  -0.00000
  0 C 2py      0.70681   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.65078
  0 C 3px      0.00000  -0.00334  -0.00000
  0 C 3py     -0.01665   0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04624
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01219   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00964
  0 C 3dxz     0.00000  -0.11596  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02324
  1 C 1s       0.00000   0.00000   0.00043
  1 C 2s       0.00000  -0.00000  -0.26907
  1 C 3s       0.00000   0.00000  -0.03634
  1 C 2px      0.00000  -0.69753   0.00000
  1 C 2py     -0.70681  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.65078
  1 C 3px     -0.00000   0.00334   0.00000
  1 C 3py      0.01665  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04624
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.01219   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00964
  1 C 3dxz     0.00000  -0.11596  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02324
<CAS-nat-orb|mo-hf>  3  3    0.99623595
<CAS-nat-orb|mo-hf>  4  4    0.99972951
<CAS-nat-orb|mo-hf>  5  5    0.99625438
<CAS-nat-orb|mo-hf>  6  6    0.99910667
<CAS-nat-orb|mo-hf>  7  7    0.93825029
<CAS-nat-orb|mo-hf>  8  8    0.97590449
<CAS-nat-orb|mo-hf>  9  9    0.95945853
<CAS-nat-orb|mo-hf>  10  10    0.89805646
<CAS-nat-orb|mo-hf>  10  11   -0.41828627
CASSCF energy = -75.4983967207139
CASCI E = -75.4983967207139  E(CI) = -15.4874144112172  S^2 = 0.0000000
Time cost =    203.624
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:11:55 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.825661377674 AA    0.000000000000   0.000000000000   3.450000000000 Bohr   0.0

nuclear repulsion = 10.4347826086957
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.725]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     15935.21


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpmh0crooc
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7871059587891

WARN: Singularity detected in overlap matrix (condition number =  114). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.119977421491999  LUMO (B3u) = -0.119977421491999

WARN: B2u HOMO -0.119977421491999 > system LUMO -0.119977421491999

cycle= 1 E= -75.3032347208423  delta_E= -0.516  |g|= 0.247  |ddm|=  1.5
HOMO (B2u) = -0.379319419622634  LUMO (B3u) = -0.0646054692258406
cycle= 2 E= -75.3274445047689  delta_E= -0.0242  |g|= 0.0501  |ddm|= 0.35
HOMO (B2u) = -0.343173022356372  LUMO (B3u) = -0.0236834315639871
cycle= 3 E= -75.3288571081841  delta_E= -0.00141  |g|= 0.018  |ddm|= 0.0664
HOMO (B2u) = -0.347657119428846  LUMO (B3u) = -0.0280415501187799
cycle= 4 E= -75.3290795920013  delta_E= -0.000222  |g|= 0.00067  |ddm|= 0.0369
HOMO (B2u) = -0.347805946692311  LUMO (B3u) = -0.028339020730597
cycle= 5 E= -75.3290797635008  delta_E= -1.71e-07  |g|= 0.000106  |ddm|= 0.000935
HOMO (B2u) = -0.347769025805503  LUMO (B3u) = -0.0283049912511377
cycle= 6 E= -75.3290797699134  delta_E= -6.41e-09  |g|= 1.65e-05  |ddm|= 0.000181
HOMO (B2u) = -0.347766788756667  LUMO (B3u) = -0.0283057158319196
cycle= 7 E= -75.3290797700874  delta_E= -1.74e-10  |g|= 1.94e-06  |ddm|= 3.58e-05
HOMO (B2u) = -0.347766179407148  LUMO (B3u) = -0.0283055115206024
cycle= 8 E= -75.3290797700898  delta_E= -2.33e-12  |g|= 1.22e-07  |ddm|= 4.05e-06
HOMO (B2u) = -0.347766186617925  LUMO (B3u) = -0.0283055139495833
cycle= 9 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 7.66e-09  |ddm|= 2.61e-07
HOMO (B2u) = -0.347766186754818  LUMO (B3u) = -0.02830551581549
cycle= 10 E= -75.3290797700898  delta_E= -4.26e-14  |g|= 5.89e-09  |ddm|= 7.8e-09
HOMO (B2u) = -0.347766186555341  LUMO (B3u) = -0.0283055156150402
cycle= 11 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 4.4e-09  |ddm|= 4.63e-09
HOMO (B2u) = -0.347766185193014  LUMO (B3u) = -0.0283055141900561
cycle= 12 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 3.94e-09  |ddm|= 2.13e-09
HOMO (B2u) = -0.34776618556575  LUMO (B3u) = -0.0283055145567679
cycle= 13 E= -75.3290797700899  delta_E= -8.53e-14  |g|= 3.55e-09  |ddm|= 1.35e-09
HOMO (B2u) = -0.347766185498155  LUMO (B3u) = -0.0283055145011522
cycle= 14 E= -75.3290797700899  delta_E= 2.84e-14  |g|= 3.06e-09  |ddm|= 9.45e-10
HOMO (B2u) = -0.347766185312365  LUMO (B3u) = -0.0283055143168778
cycle= 15 E= -75.3290797700899  delta_E= -1.42e-14  |g|= 8.7e-10  |ddm|= 5.07e-09
HOMO (B2u) = -0.347766185215012  LUMO (B3u) = -0.0283055143061942
cycle= 16 E= -75.3290797700898  delta_E= 4.26e-14  |g|= 8.64e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.34776618524142  LUMO (B3u) = -0.0283055142974715
cycle= 17 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 8.92e-10  |ddm|= 6.41e-10
HOMO (B2u) = -0.347766185214577  LUMO (B3u) = -0.0283055142721003
cycle= 18 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 6.84e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.347766185217267  LUMO (B3u) = -0.0283055142806665
cycle= 19 E= -75.3290797700898  delta_E=    0  |g|= 5.83e-10  |ddm|= 3.65e-10
HOMO (B2u) = -0.347766185222225  LUMO (B3u) = -0.0283055142902972
cycle= 20 E= -75.3290797700897  delta_E= 8.53e-14  |g|= 4.91e-10  |ddm|= 2.5e-10
HOMO (B2u) = -0.347766185212772  LUMO (B3u) = -0.0283055142825438
cycle= 21 E= -75.3290797700898  delta_E= -8.53e-14  |g|= 3.87e-10  |ddm|= 2.35e-10
HOMO (B2u) = -0.347766185207217  LUMO (B3u) = -0.0283055142799944
cycle= 22 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 2.84e-10  |ddm|= 2.23e-10
HOMO (B2u) = -0.347766185201991  LUMO (B3u) = -0.0283055142773466
cycle= 23 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 1.94e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.347766185195911  LUMO (B3u) = -0.0283055142743023
cycle= 24 E= -75.3290797700898  delta_E=    0  |g|= 1.7e-10  |ddm|= 7.07e-11
HOMO (B2u) = -0.347766185194318  LUMO (B3u) = -0.0283055142721274
cycle= 25 E= -75.3290797700898  delta_E=    0  |g|= 1.43e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.347766185191545  LUMO (B3u) = -0.0283055142701099
cycle= 26 E= -75.3290797700899  delta_E= -1.14e-13  |g|= 1.17e-10  |ddm|= 6.3e-11
HOMO (B2u) = -0.34776618518916  LUMO (B3u) = -0.0283055142684067
cycle= 27 E= -75.3290797700898  delta_E= 1.14e-13  |g|= 9.89e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.347766185187196  LUMO (B3u) = -0.0283055142669594
cycle= 28 E= -75.3290797700898  delta_E=    0  |g|= 8.06e-11  |ddm|= 4.27e-11
HOMO (B2u) = -0.347766185182253  LUMO (B3u) = -0.0283055142633877
Extra cycle  E= -75.3290797700899  delta_E= -5.68e-14  |g|= 2.97e-11  |ddm|= 1.17e-10
converged SCF energy = -75.3290797700899

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpmh0crooc
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4482666492426  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4618049986756  dE = -0.013538349  S^2 = 0.0000000
               |grad[o]|=0.0903  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4731372408985  dE = -0.011332242  S^2 = 0.0000000
               |grad[o]|=0.0766  |ddm|=0.0762  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4818347664694  dE = -0.0086975256  S^2 = 0.0000000
               |grad[o]|=0.0609  |ddm|=0.0424  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4881398056674  dE = -0.0063050392  S^2 = 0.0000000
               |grad[o]|=0.0447  |ddm|=0.0518  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4917456919929  dE = -0.0036058863  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.0696  |maxRot[o]|= 0.06
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4932311762364  dE = -0.0014854842  S^2 = 0.0000000
               |grad[o]|=0.014  |ddm|=0.0391  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.493507162889  dE = -0.00027598665  S^2 = 0.0000000
               |grad[o]|=0.00522  |ddm|=0.0263  |maxRot[o]|=0.034
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4935391201179  dE = -3.1957229e-05  S^2 = 0.0000000
               |grad[o]|=0.00188  |ddm|=0.00869  |maxRot[o]|=0.0124
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4935423354117  dE = -3.2152938e-06  S^2 = 0.0000000
               |grad[o]|=0.000641  |ddm|=0.00271  |maxRot[o]|=0.004
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4935426466092  dE = -3.111975e-07  S^2 = 0.0000000
               |grad[o]|=0.000207  |ddm|=0.000854  |maxRot[o]|=0.00125
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4935426764192  dE = -2.981001e-08  S^2 = 0.0000000
               |grad[o]|=6.54e-05  |ddm|=0.000266  |maxRot[o]|=0.000388
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4935426792612  dE = -2.8420573e-09  S^2 = 0.0000000
               |grad[o]|=2.04e-05  |ddm|=8.28e-05  |maxRot[o]|=0.00012
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4935426795292  dE = -2.6791724e-10  S^2 = 0.0000000
               |grad[o]|=6.32e-06  |ddm|=2.56e-05  |maxRot[o]|=3.72e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4935426795535  dE = -2.4357405e-11  S^2 = 0.0000000
               |grad[o]|=1.96e-06  |ddm|=7.9e-06  |maxRot[o]|=1.15e-05
2-step CASSCF converged in 14 macro (56 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96070609 1.93062246 1.89534328 1.79161505 0.07330624 0.21443249
 0.05813181 0.07584257]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01111   0.01003  -0.00449   0.00000   0.00000
  0 C 2s       0.64834   0.65619  -0.28117   0.00000   0.00000
  0 C 3s      -0.01251   0.01666  -0.04312  -0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69393
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439   0.00000
  0 C 2pz      0.28005  -0.26233   0.64632  -0.00000   0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06065
  0 C 3py      0.00000  -0.00000   0.00000   0.05111   0.00000
  0 C 3pz     -0.01714  -0.00207   0.00620  -0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.03500   0.00000
  0 C 3dz^2    0.02561  -0.01317   0.03529  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.12160
 0 C 3dx2-y2  -0.00030   0.00676  -0.00739   0.00000   0.00000
  1 C 1s       0.01111  -0.01003  -0.00449   0.00000   0.00000
  1 C 2s       0.64834  -0.65619  -0.28117   0.00000   0.00000
  1 C 3s      -0.01251  -0.01666  -0.04312   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69393
  1 C 2py     -0.00000   0.00000  -0.00000   0.70439  -0.00000
  1 C 2pz     -0.28005  -0.26233  -0.64632   0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000  -0.06065
  1 C 3py     -0.00000   0.00000   0.00000   0.05111  -0.00000
  1 C 3pz      0.01714  -0.00207  -0.00620  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03500   0.00000
  1 C 3dz^2    0.02561   0.01317   0.03529   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12160
 1 C 3dx2-y2  -0.00030  -0.00676  -0.00739  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s       0.00000   0.00000   0.26097
  0 C 3s      -0.00000   0.00000   0.03534
  0 C 2px     -0.00000   0.69766   0.00000
  0 C 2py      0.70686  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.65436
  0 C 3px     -0.00000  -0.00539  -0.00000
  0 C 3py     -0.01459  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04356
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01176  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00868
  0 C 3dxz    -0.00000  -0.11509   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02209
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.26097
  1 C 3s       0.00000  -0.00000  -0.03534
  1 C 2px      0.00000  -0.69766   0.00000
  1 C 2py     -0.70686   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.65436
  1 C 3px      0.00000   0.00539  -0.00000
  1 C 3py      0.01459   0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04356
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01176  -0.00000   0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00868
  1 C 3dxz    -0.00000  -0.11509   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02209
<CAS-nat-orb|mo-hf>  3  3    0.99779512
<CAS-nat-orb|mo-hf>  4  4    0.99972139
<CAS-nat-orb|mo-hf>  5  5    0.99781371
<CAS-nat-orb|mo-hf>  6  6    0.99905368
<CAS-nat-orb|mo-hf>  7  7    0.93724395
<CAS-nat-orb|mo-hf>  8  8    0.97733329
<CAS-nat-orb|mo-hf>  9  9    0.95969121
<CAS-nat-orb|mo-hf>  10  10    0.90788563
CASSCF energy = -75.4935426795535
CASCI E = -75.4935426795535  E(CI) = -15.4144875345159  S^2 = 0.0000000
Time cost =    342.091
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:17:37 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.852120238220 AA    0.000000000000   0.000000000000   3.500000000000 Bohr   0.0

nuclear repulsion = 10.2857142857143
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.75]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     16528.95


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp6stmb1il
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.770995471526

WARN: Singularity detected in overlap matrix (condition number =  106). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.116499456302711  LUMO (B3u) = -0.116499456302711

WARN: B2u HOMO -0.116499456302711 > system LUMO -0.116499456302711

cycle= 1 E= -75.2953428985397  delta_E= -0.524  |g|= 0.245  |ddm|= 1.49
HOMO (B2u) = -0.375058505355512  LUMO (B3u) = -0.06206736265383
cycle= 2 E= -75.3191698853078  delta_E= -0.0238  |g|= 0.0495  |ddm|= 0.35
HOMO (B2u) = -0.339451307241013  LUMO (B3u) = -0.0217153065240397
cycle= 3 E= -75.3205643325183  delta_E= -0.00139  |g|= 0.0179  |ddm|= 0.0655
HOMO (B2u) = -0.343918314413034  LUMO (B3u) = -0.0260457604373062
cycle= 4 E= -75.320786165773  delta_E= -0.000222  |g|= 0.000666  |ddm|= 0.0365
HOMO (B2u) = -0.344078228753202  LUMO (B3u) = -0.0263545301612762
cycle= 5 E= -75.3207863342661  delta_E= -1.68e-07  |g|= 0.00011  |ddm|= 0.000905
HOMO (B2u) = -0.34404092812384  LUMO (B3u) = -0.0263210064987908
cycle= 6 E= -75.3207863411989  delta_E= -6.93e-09  |g|= 1.7e-05  |ddm|= 0.000188
HOMO (B2u) = -0.344038581299418  LUMO (B3u) = -0.0263216091209578
cycle= 7 E= -75.3207863413827  delta_E= -1.84e-10  |g|= 1.93e-06  |ddm|= 3.63e-05
HOMO (B2u) = -0.344037999604701  LUMO (B3u) = -0.0263214409572387
cycle= 8 E= -75.3207863413852  delta_E= -2.44e-12  |g|= 1.24e-07  |ddm|= 4.02e-06
HOMO (B2u) = -0.344038005466922  LUMO (B3u) = -0.0263214419457729
cycle= 9 E= -75.3207863413852  delta_E=    0  |g|= 8.04e-09  |ddm|= 2.72e-07
HOMO (B2u) = -0.344038005447104  LUMO (B3u) = -0.0263214437138037
cycle= 10 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 6.27e-09  |ddm|= 7.9e-09
HOMO (B2u) = -0.344038005255218  LUMO (B3u) = -0.0263214435321988
cycle= 11 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 4.62e-09  |ddm|= 4.9e-09
HOMO (B2u) = -0.344038003880721  LUMO (B3u) = -0.0263214420966469
cycle= 12 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 4.1e-09  |ddm|= 2.26e-09
HOMO (B2u) = -0.344038004235356  LUMO (B3u) = -0.0263214424505621
cycle= 13 E= -75.3207863413852  delta_E= -8.53e-14  |g|= 3.7e-09  |ddm|= 1.48e-09
HOMO (B2u) = -0.344038004143523  LUMO (B3u) = -0.0263214423663543
cycle= 14 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 3.11e-09  |ddm|= 1.26e-09
HOMO (B2u) = -0.344038003955674  LUMO (B3u) = -0.026321442213845
cycle= 15 E= -75.3207863413851  delta_E=    0  |g|= 9.32e-10  |ddm|= 5.21e-09
HOMO (B2u) = -0.344038003857447  LUMO (B3u) = -0.0263214422031983
cycle= 16 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 9.06e-10  |ddm|= 1.22e-09
HOMO (B2u) = -0.344038003889636  LUMO (B3u) = -0.0263214421914748
cycle= 17 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 9.62e-10  |ddm|= 8.35e-10
HOMO (B2u) = -0.344038003858914  LUMO (B3u) = -0.0263214421654004
cycle= 18 E= -75.3207863413851  delta_E= 1.42e-13  |g|= 7.38e-10  |ddm|= 5.28e-10
HOMO (B2u) = -0.344038003858954  LUMO (B3u) = -0.0263214421728352
cycle= 19 E= -75.3207863413852  delta_E= -1.14e-13  |g|= 6.18e-10  |ddm|= 4.19e-10
HOMO (B2u) = -0.344038003861634  LUMO (B3u) = -0.0263214421815266
cycle= 20 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 5.16e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.344038003849857  LUMO (B3u) = -0.0263214421727716
cycle= 21 E= -75.3207863413851  delta_E=    0  |g|= 4.05e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.344038003842067  LUMO (B3u) = -0.0263214421691166
cycle= 22 E= -75.3207863413851  delta_E=    0  |g|= 2.96e-10  |ddm|= 2.48e-10
HOMO (B2u) = -0.344038003834592  LUMO (B3u) = -0.0263214421655022
cycle= 23 E= -75.3207863413851  delta_E=    0  |g|= 2.07e-10  |ddm|= 2.11e-10
HOMO (B2u) = -0.344038003828344  LUMO (B3u) = -0.0263214421623533
cycle= 24 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.8e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.344038003826415  LUMO (B3u) = -0.0263214421599114
cycle= 25 E= -75.3207863413851  delta_E= -5.68e-14  |g|= 1.51e-10  |ddm|= 6.72e-11
HOMO (B2u) = -0.344038003822989  LUMO (B3u) = -0.0263214421576387
cycle= 26 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.23e-10  |ddm|= 7.21e-11
HOMO (B2u) = -0.344038003820141  LUMO (B3u) = -0.0263214421557621
cycle= 27 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.03e-10  |ddm|= 5.5e-11
HOMO (B2u) = -0.344038003817798  LUMO (B3u) = -0.026321442154178
cycle= 28 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 8.35e-11  |ddm|= 4.72e-11
HOMO (B2u) = -0.344038003815988  LUMO (B3u) = -0.026321442152971
cycle= 29 E= -75.3207863413851  delta_E= -5.68e-14  |g|= 6.64e-11  |ddm|= 4.04e-11
HOMO (B2u) = -0.344038003814453  LUMO (B3u) = -0.0263214421519471
cycle= 30 E= -75.3207863413851  delta_E=    0  |g|= 5.26e-11  |ddm|= 3.23e-11
HOMO (B2u) = -0.344038003810776  LUMO (B3u) = -0.0263214421494515
Extra cycle  E= -75.3207863413851  delta_E=    0  |g|= 1.94e-11  |ddm|= 7.85e-11
converged SCF energy = -75.3207863413851

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp6stmb1il
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4441902032778  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4581664018809  dE = -0.013976199  S^2 = 0.0000000
               |grad[o]|=0.0923  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4696819209065  dE = -0.011515519  S^2 = 0.0000000
               |grad[o]|=0.0772  |ddm|=0.0811  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4782645461789  dE = -0.0085826253  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.0433  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4842992499753  dE = -0.0060347038  S^2 = 0.0000000
               |grad[o]|=0.0424  |ddm|=0.0579  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4876547162071  dE = -0.0033554662  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.0727  |maxRot[o]|=0.0598
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4884265086883  dE = -0.00077179248  S^2 = 0.0000000
               |grad[o]|=0.0102  |ddm|=0.0385  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4887230889616  dE = -0.00029658027  S^2 = 0.0000000
               |grad[o]|=0.00537  |ddm|=0.0131  |maxRot[o]|=0.0351
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4887546373468  dE = -3.1548385e-05  S^2 = 0.0000000
               |grad[o]|=0.00189  |ddm|=0.0083  |maxRot[o]|=0.0124
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4887576319221  dE = -2.9945753e-06  S^2 = 0.0000000
               |grad[o]|=0.000634  |ddm|=0.00254  |maxRot[o]|=0.00388
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4887579066453  dE = -2.7472329e-07  S^2 = 0.0000000
               |grad[o]|=0.000199  |ddm|=0.000782  |maxRot[o]|=0.00118
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4887579316398  dE = -2.4994421e-08  S^2 = 0.0000000
               |grad[o]|=6.16e-05  |ddm|=0.000238  |maxRot[o]|=0.000357
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4887579338976  dE = -2.2578774e-09  S^2 = 0.0000000
               |grad[o]|=1.87e-05  |ddm|=7.12e-05  |maxRot[o]|=0.000108
macro iter 13 (2 JK  0 micro), CASSCF E = -75.488757934101  dE = -2.0332891e-10  S^2 = 0.0000000
               |grad[o]|=5.64e-06  |ddm|=2.16e-05  |maxRot[o]|=3.22e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4887579341157  dE = -1.4765078e-11  S^2 = 0.0000000
               |grad[o]|=1.72e-06  |ddm|=6.52e-06  |maxRot[o]|=9.79e-06
2-step CASSCF converged in 14 macro (55 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95981388 1.93127285 1.8922826  1.77943942 0.07180263 0.22650183
 0.05783615 0.08105064]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01133   0.01013  -0.00414   0.00000   0.00000
  0 C 2s       0.65705   0.65938  -0.26022  -0.00000  -0.00000
  0 C 3s      -0.00998   0.01639  -0.04128   0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69378
  0 C 2py     -0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.25932  -0.25424   0.65514  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06179
  0 C 3py     -0.00000   0.00000   0.00000   0.05203   0.00000
  0 C 3pz     -0.01577  -0.00197   0.00765   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.03378   0.00000
  0 C 3dz^2    0.02382  -0.01278   0.03532  -0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000  -0.12186
 0 C 3dx2-y2  -0.00000   0.00665  -0.00734  -0.00000   0.00000
  1 C 1s       0.01133  -0.01013  -0.00414   0.00000   0.00000
  1 C 2s       0.65705  -0.65938  -0.26022  -0.00000  -0.00000
  1 C 3s      -0.00998  -0.01639  -0.04128   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69378
  1 C 2py     -0.00000   0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.25932  -0.25424  -0.65514  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06179
  1 C 3py      0.00000  -0.00000  -0.00000   0.05203  -0.00000
  1 C 3pz      0.01577  -0.00197  -0.00765  -0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03378   0.00000
  1 C 3dz^2    0.02382   0.01278   0.03532   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12186
 1 C 3dx2-y2  -0.00000  -0.00665  -0.00734  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000  -0.00000   0.25300
  0 C 3s      -0.00000   0.00000   0.03435
  0 C 2px     -0.00000   0.69779  -0.00000
  0 C 2py      0.70690   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.65775
  0 C 3px     -0.00000  -0.00738  -0.00000
  0 C 3py     -0.01256  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.04088
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01132  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00778
  0 C 3dxz    -0.00000  -0.11419   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02095
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s      -0.00000  -0.00000  -0.25300
  1 C 3s       0.00000   0.00000  -0.03435
  1 C 2px      0.00000  -0.69779  -0.00000
  1 C 2py     -0.70690   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.65775
  1 C 3px      0.00000   0.00738   0.00000
  1 C 3py      0.01256   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04088
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01132  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00778
  1 C 3dxz    -0.00000  -0.11419  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02095
<CAS-nat-orb|mo-hf>  3  3    0.99891158
<CAS-nat-orb|mo-hf>  4  4    0.99971276
<CAS-nat-orb|mo-hf>  5  5    0.99892917
<CAS-nat-orb|mo-hf>  6  6    0.99899872
<CAS-nat-orb|mo-hf>  7  7    0.93636098
<CAS-nat-orb|mo-hf>  8  8    0.97867429
<CAS-nat-orb|mo-hf>  9  9    0.95989986
<CAS-nat-orb|mo-hf>  10  10    0.91658565
CASSCF energy = -75.4887579341157
CASCI E = -75.4887579341157  E(CI) = -15.3435702378968  S^2 = 0.0000000
Time cost =     87.649
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:19:05 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.878579098766 AA    0.000000000000   0.000000000000   3.550000000000 Bohr   0.0

nuclear repulsion = 10.1408450704225
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.775]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     16897.19


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpj7ezgnkp
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.755922874727

WARN: Singularity detected in overlap matrix (condition number = 98.8). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.113183134036075  LUMO (B3u) = -0.113183134036076

WARN: B2u HOMO -0.113183134036075 > system LUMO -0.113183134036076

cycle= 1 E= -75.287473469352  delta_E= -0.532  |g|= 0.242  |ddm|= 1.48
HOMO (B2u) = -0.370939595595208  LUMO (B3u) = -0.0596135835397194
cycle= 2 E= -75.3109303175842  delta_E= -0.0235  |g|= 0.0489  |ddm|= 0.349
HOMO (B2u) = -0.335857476925404  LUMO (B3u) = -0.019816698095689
cycle= 3 E= -75.3123050204644  delta_E= -0.00137  |g|= 0.0178  |ddm|= 0.0646
HOMO (B2u) = -0.340305747412608  LUMO (B3u) = -0.0241187549333946
cycle= 4 E= -75.3125256665475  delta_E= -0.000221  |g|= 0.000662  |ddm|= 0.0362
HOMO (B2u) = -0.340473004463873  LUMO (B3u) = -0.024434731679539
cycle= 5 E= -75.3125258326696  delta_E= -1.66e-07  |g|= 0.000114  |ddm|= 0.000883
HOMO (B2u) = -0.340435552234747  LUMO (B3u) = -0.0244019229355888
cycle= 6 E= -75.3125258401168  delta_E= -7.45e-09  |g|= 1.75e-05  |ddm|= 0.000196
HOMO (B2u) = -0.340433109443011  LUMO (B3u) = -0.0244024220699413
cycle= 7 E= -75.3125258403104  delta_E= -1.94e-10  |g|= 1.93e-06  |ddm|= 3.69e-05
HOMO (B2u) = -0.34043255398707  LUMO (B3u) = -0.0244022873481274
cycle= 8 E= -75.3125258403128  delta_E= -2.42e-12  |g|= 1.26e-07  |ddm|= 4e-06
HOMO (B2u) = -0.340432558916938  LUMO (B3u) = -0.0244022873229934
cycle= 9 E= -75.3125258403128  delta_E=    0  |g|= 8.38e-09  |ddm|= 2.82e-07
HOMO (B2u) = -0.340432558756187  LUMO (B3u) = -0.0244022890141919
cycle= 10 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 6.6e-09  |ddm|= 7.96e-09
HOMO (B2u) = -0.340432558581137  LUMO (B3u) = -0.0244022888635751
cycle= 11 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 4.82e-09  |ddm|= 5.19e-09
HOMO (B2u) = -0.340432557195048  LUMO (B3u) = -0.0244022874170633
cycle= 12 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 4.25e-09  |ddm|= 2.39e-09
HOMO (B2u) = -0.340432557526998  LUMO (B3u) = -0.0244022877526807
cycle= 13 E= -75.3125258403129  delta_E=    0  |g|= 3.82e-09  |ddm|= 1.58e-09
HOMO (B2u) = -0.340432557414971  LUMO (B3u) = -0.0244022876441014
cycle= 14 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 3.17e-09  |ddm|= 1.55e-09
HOMO (B2u) = -0.340432557231899  LUMO (B3u) = -0.024402287521508
cycle= 15 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 9.91e-10  |ddm|= 5.61e-09
HOMO (B2u) = -0.34043255712633  LUMO (B3u) = -0.0244022875095587
cycle= 16 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 9.38e-10  |ddm|= 1.27e-09
HOMO (B2u) = -0.340432557162976  LUMO (B3u) = -0.0244022874951329
cycle= 17 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 1.02e-09  |ddm|= 1.01e-09
HOMO (B2u) = -0.340432557129218  LUMO (B3u) = -0.0244022874689512
cycle= 18 E= -75.3125258403129  delta_E= -1.42e-13  |g|= 7.85e-10  |ddm|= 5.81e-10
HOMO (B2u) = -0.340432557127081  LUMO (B3u) = -0.0244022874756768
cycle= 19 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 6.47e-10  |ddm|= 4.67e-10
HOMO (B2u) = -0.340432557128103  LUMO (B3u) = -0.0244022874839104
cycle= 20 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 5.36e-10  |ddm|= 3.24e-10
HOMO (B2u) = -0.340432557114532  LUMO (B3u) = -0.0244022874745705
cycle= 21 E= -75.3125258403128  delta_E= 2.84e-14  |g|= 4.2e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.340432557104917  LUMO (B3u) = -0.0244022874701219
cycle= 22 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 3.06e-10  |ddm|= 2.69e-10
HOMO (B2u) = -0.340432557095625  LUMO (B3u) = -0.0244022874658718
cycle= 23 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 2.16e-10  |ddm|= 2.24e-10
HOMO (B2u) = -0.340432557088889  LUMO (B3u) = -0.024402287462576
cycle= 24 E= -75.3125258403129  delta_E= -8.53e-14  |g|= 1.87e-10  |ddm|= 7.91e-11
HOMO (B2u) = -0.340432557086644  LUMO (B3u) = -0.024402287459926
cycle= 25 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 1.58e-10  |ddm|= 7.09e-11
HOMO (B2u) = -0.340432557082661  LUMO (B3u) = -0.0244022874574713
cycle= 26 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 1.28e-10  |ddm|= 7.97e-11
HOMO (B2u) = -0.340432557079416  LUMO (B3u) = -0.0244022874554751
cycle= 27 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 1.06e-10  |ddm|= 6.1e-11
HOMO (B2u) = -0.340432557076746  LUMO (B3u) = -0.0244022874537972
cycle= 28 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 8.58e-11  |ddm|= 5.09e-11
HOMO (B2u) = -0.340432557074663  LUMO (B3u) = -0.0244022874525121
cycle= 29 E= -75.3125258403128  delta_E=    0  |g|= 6.81e-11  |ddm|= 4.29e-11
HOMO (B2u) = -0.340432557069274  LUMO (B3u) = -0.0244022874491387
Extra cycle  E= -75.3125258403129  delta_E= -1.14e-13  |g|= 2.46e-11  |ddm|= 1.05e-10
converged SCF energy = -75.3125258403129

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpj7ezgnkp
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4401587585066  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4545821847276  dE = -0.014423426  S^2 = 0.0000000
               |grad[o]|=0.0942  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4662692480554  dE = -0.011687063  S^2 = 0.0000000
               |grad[o]|=0.0778  |ddm|=0.0861  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.474709954262  dE = -0.0084407062  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.0439  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4804719532713  dE = -0.005761999  S^2 = 0.0000000
               |grad[o]|= 0.04  |ddm|=0.0658  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4831435204773  dE = -0.0026715672  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.0737  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4838239796126  dE = -0.00068045914  S^2 = 0.0000000
               |grad[o]|=0.00925  |ddm|=0.0308  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.484037116035  dE = -0.00021313642  S^2 = 0.0000000
               |grad[o]|=0.00453  |ddm|=0.0109  |maxRot[o]|=0.0304
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4840577811658  dE = -2.0665131e-05  S^2 = 0.0000000
               |grad[o]|=0.00158  |ddm|=0.00643  |maxRot[o]|=0.0101
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4840596355542  dE = -1.8543884e-06  S^2 = 0.0000000
               |grad[o]|=0.000517  |ddm|=0.00195  |maxRot[o]|=0.00307
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4840597983765  dE = -1.6282233e-07  S^2 = 0.0000000
               |grad[o]|=0.000159  |ddm|=0.000592  |maxRot[o]|=0.000913
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4840598125418  dE = -1.4165323e-08  S^2 = 0.0000000
               |grad[o]|=4.79e-05  |ddm|=0.000176  |maxRot[o]|=0.00027
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4840598137745  dE = -1.2326353e-09  S^2 = 0.0000000
               |grad[o]|=1.43e-05  |ddm|=5.21e-05  |maxRot[o]|=7.95e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4840598138814  dE = -1.0692247e-10  S^2 = 0.0000000
               |grad[o]|=4.23e-06  |ddm|=1.54e-05  |maxRot[o]|=2.35e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4840598138906  dE = -9.194423e-12  S^2 = 0.0000000
               |grad[o]|=1.25e-06  |ddm|=4.55e-06  |maxRot[o]|=6.92e-06
2-step CASSCF converged in 14 macro (55 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95901066 1.93191387 1.88869909 1.76663822 0.07041579 0.23918108
 0.05753793 0.08660336]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01153   0.01022  -0.00378   0.00000   0.00000
  0 C 2s       0.66488   0.66240  -0.23954  -0.00000  -0.00000
  0 C 3s      -0.00763   0.01613  -0.03939  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69368
  0 C 2py      0.00000  -0.00000  -0.00000   0.70438  -0.00000
  0 C 2pz      0.23883  -0.24630   0.66308  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06285
  0 C 3py     -0.00000  -0.00000  -0.00000   0.05282  -0.00000
  0 C 3pz     -0.01454  -0.00188   0.00916  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.00000  -0.00000   0.03256  -0.00000
  0 C 3dz^2    0.02207  -0.01238   0.03528  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.12191
 0 C 3dx2-y2   0.00028   0.00654  -0.00728   0.00000  -0.00000
  1 C 1s       0.01153  -0.01022  -0.00378   0.00000   0.00000
  1 C 2s       0.66488  -0.66240  -0.23954   0.00000   0.00000
  1 C 3s      -0.00763  -0.01613  -0.03939   0.00000   0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69368
  1 C 2py      0.00000  -0.00000   0.00000   0.70438   0.00000
  1 C 2pz     -0.23883  -0.24630  -0.66308   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06285
  1 C 3py     -0.00000   0.00000   0.00000   0.05282   0.00000
  1 C 3pz      0.01454  -0.00188  -0.00916  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03256  -0.00000
  1 C 3dz^2    0.02207   0.01238   0.03528   0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12191
 1 C 3dx2-y2   0.00028  -0.00654  -0.00728   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00035
  0 C 2s      -0.00000  -0.00000   0.24517
  0 C 3s      -0.00000  -0.00000   0.03335
  0 C 2px     -0.00000   0.69791  -0.00000
  0 C 2py      0.70694   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.66096
  0 C 3px      0.00000  -0.00931  -0.00000
  0 C 3py     -0.01055  -0.00000   0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03822
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.01090  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00694
  0 C 3dxz     0.00000  -0.11326  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01984
  1 C 1s       0.00000   0.00000   0.00035
  1 C 2s       0.00000   0.00000  -0.24517
  1 C 3s       0.00000   0.00000  -0.03335
  1 C 2px     -0.00000  -0.69791  -0.00000
  1 C 2py     -0.70694   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.66096
  1 C 3px      0.00000   0.00931   0.00000
  1 C 3py      0.01055  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03822
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01090   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00694
  1 C 3dxz    -0.00000  -0.11326  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01984
<CAS-nat-orb|mo-hf>  3  3    0.99958549
<CAS-nat-orb|mo-hf>  4  4    0.99970353
<CAS-nat-orb|mo-hf>  5  5    0.99960080
<CAS-nat-orb|mo-hf>  6  6    0.99894173
<CAS-nat-orb|mo-hf>  7  7    0.93559187
<CAS-nat-orb|mo-hf>  8  8    0.97993346
<CAS-nat-orb|mo-hf>  9  9    0.96008674
<CAS-nat-orb|mo-hf>  10  10    0.92430540
CASSCF energy = -75.4840598138906
CASCI E = -75.4840598138906  E(CI) = -15.2745978907238  S^2 = 0.0000000
Time cost =    157.231
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:21:42 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.905037959312 AA    0.000000000000   0.000000000000   3.600000000000 Bohr   0.0

nuclear repulsion = 10
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.8]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     17157.34


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp8iknnxg0
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7418315703506

WARN: Singularity detected in overlap matrix (condition number = 92.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.110019881100111  LUMO (B3u) = -0.110019881100111

WARN: B2u HOMO -0.110019881100111 > system LUMO -0.110019881100111

cycle= 1 E= -75.2796395081188  delta_E= -0.538  |g|= 0.24  |ddm|= 1.48
HOMO (B2u) = -0.366960154497  LUMO (B3u) = -0.0572442637655629
cycle= 2 E= -75.3027407260662  delta_E= -0.0231  |g|= 0.0483  |ddm|= 0.349
HOMO (B2u) = -0.332387624443797  LUMO (B3u) = -0.0179860460523917
cycle= 3 E= -75.3040943705399  delta_E= -0.00135  |g|= 0.0177  |ddm|= 0.0637
HOMO (B2u) = -0.336815650622685  LUMO (B3u) = -0.02225899011479
cycle= 4 E= -75.3043133588737  delta_E= -0.000219  |g|= 0.000659  |ddm|= 0.0358
HOMO (B2u) = -0.336986521904541  LUMO (B3u) = -0.0225780980112825
cycle= 5 E= -75.3043135231659  delta_E= -1.64e-07  |g|= 0.000118  |ddm|= 0.000867
HOMO (B2u) = -0.336949107818827  LUMO (B3u) = -0.0225461573189904
cycle= 6 E= -75.304313531111  delta_E= -7.95e-09  |g|= 1.79e-05  |ddm|= 0.000202
HOMO (B2u) = -0.33694658310042  LUMO (B3u) = -0.0225465689188794
cycle= 7 E= -75.3043135313143  delta_E= -2.03e-10  |g|= 1.93e-06  |ddm|= 3.75e-05
HOMO (B2u) = -0.336946052255864  LUMO (B3u) = -0.0225464651749534
cycle= 8 E= -75.3043135313167  delta_E= -2.39e-12  |g|= 1.28e-07  |ddm|= 3.99e-06
HOMO (B2u) = -0.336946056653944  LUMO (B3u) = -0.0225464645227628
cycle= 9 E= -75.3043135313166  delta_E= 4.26e-14  |g|= 8.63e-09  |ddm|= 2.92e-07
HOMO (B2u) = -0.33694605635527  LUMO (B3u) = -0.0225464661393956
cycle= 10 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 6.89e-09  |ddm|= 7.94e-09
HOMO (B2u) = -0.336946056208951  LUMO (B3u) = -0.0225464660336787
cycle= 11 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 4.99e-09  |ddm|= 5.48e-09
HOMO (B2u) = -0.336946054828933  LUMO (B3u) = -0.0225464645957178
cycle= 12 E= -75.3043135313167  delta_E=    0  |g|= 4.37e-09  |ddm|= 2.54e-09
HOMO (B2u) = -0.336946055133751  LUMO (B3u) = -0.022546464907565
cycle= 13 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 3.93e-09  |ddm|= 1.64e-09
HOMO (B2u) = -0.336946055006219  LUMO (B3u) = -0.0225464647808091
cycle= 14 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 3.23e-09  |ddm|= 1.79e-09
HOMO (B2u) = -0.336946054816745  LUMO (B3u) = -0.0225464646819095
cycle= 15 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 1.03e-09  |ddm|= 5.76e-09
HOMO (B2u) = -0.336946054721716  LUMO (B3u) = -0.0225464646699928
cycle= 16 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 9.74e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.336946054755562  LUMO (B3u) = -0.0225464646547487
cycle= 17 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 1.07e-09  |ddm|= 1e-09
HOMO (B2u) = -0.336946054719665  LUMO (B3u) = -0.0225464646290261
cycle= 18 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 8.25e-10  |ddm|= 6.21e-10
HOMO (B2u) = -0.336946054715626  LUMO (B3u) = -0.0225464646352689
cycle= 19 E= -75.3043135313167  delta_E=    0  |g|= 6.73e-10  |ddm|= 5.08e-10
HOMO (B2u) = -0.336946054715343  LUMO (B3u) = -0.0225464646433115
cycle= 20 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 5.54e-10  |ddm|= 3.53e-10
HOMO (B2u) = -0.336946054700499  LUMO (B3u) = -0.0225464646338241
cycle= 21 E= -75.3043135313167  delta_E= -4.26e-14  |g|= 4.32e-10  |ddm|= 3.09e-10
HOMO (B2u) = -0.336946054689477  LUMO (B3u) = -0.0225464646289324
cycle= 22 E= -75.3043135313167  delta_E= 4.26e-14  |g|= 3.15e-10  |ddm|= 2.86e-10
HOMO (B2u) = -0.336946054678818  LUMO (B3u) = -0.0225464646243815
cycle= 23 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 2.24e-10  |ddm|= 2.37e-10
HOMO (B2u) = -0.336946054672091  LUMO (B3u) = -0.0225464646210518
cycle= 24 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 1.93e-10  |ddm|= 8.14e-11
HOMO (B2u) = -0.33694605466931  LUMO (B3u) = -0.0225464646182705
cycle= 25 E= -75.3043135313167  delta_E= -8.53e-14  |g|= 1.63e-10  |ddm|= 7.42e-11
HOMO (B2u) = -0.336946054664895  LUMO (B3u) = -0.0225464646157212
cycle= 26 E= -75.3043135313167  delta_E= 2.84e-14  |g|= 1.31e-10  |ddm|= 8.59e-11
HOMO (B2u) = -0.336946054661346  LUMO (B3u) = -0.0225464646136728
cycle= 27 E= -75.3043135313167  delta_E= 4.26e-14  |g|= 1.08e-10  |ddm|= 6.6e-11
HOMO (B2u) = -0.336946054658427  LUMO (B3u) = -0.0225464646119528
cycle= 28 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 8.7e-11  |ddm|= 5.4e-11
HOMO (B2u) = -0.336946054656134  LUMO (B3u) = -0.0225464646106308
cycle= 29 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 6.88e-11  |ddm|= 4.5e-11
HOMO (B2u) = -0.336946054654226  LUMO (B3u) = -0.0225464646095249
cycle= 30 E= -75.3043135313167  delta_E=    0  |g|= 5.44e-11  |ddm|= 3.55e-11
HOMO (B2u) = -0.33694605464959  LUMO (B3u) = -0.0225464646067777
Extra cycle  E= -75.3043135313167  delta_E= -2.84e-14  |g|= 1.95e-11  |ddm|= 8.62e-11
converged SCF energy = -75.3043135313167

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp8iknnxg0
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4361879187435  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4510691607446  dE = -0.014881242  S^2 = 0.0000000
               |grad[o]|=0.0962  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4629145321975  dE = -0.011845371  S^2 = 0.0000000
               |grad[o]|=0.0783  |ddm|=0.0912  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4711866391334  dE = -0.0082721069  S^2 = 0.0000000
               |grad[o]|=0.0578  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4766787942684  dE = -0.0054921551  S^2 = 0.0000000
               |grad[o]|=0.0375  |ddm|=0.075  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4787632077898  dE = -0.0020844135  S^2 = 0.0000000
               |grad[o]|=0.0178  |ddm|=0.0723  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4793231918275  dE = -0.00055998404  S^2 = 0.0000000
               |grad[o]|=0.00799  |ddm|=0.0239  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4794386335796  dE = -0.00011544175  S^2 = 0.0000000
               |grad[o]|=0.00353  |ddm|=0.00914  |maxRot[o]|= 0.02
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4794609801221  dE = -2.2346543e-05  S^2 = 0.0000000
               |grad[o]|=0.00158  |ddm|=0.00384  |maxRot[o]|=0.0105
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4794629087142  dE = -1.9285921e-06  S^2 = 0.0000000
               |grad[o]|=0.000536  |ddm|=0.00194  |maxRot[o]|=0.00314
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4794630725592  dE = -1.6384492e-07  S^2 = 0.0000000
               |grad[o]|=0.000164  |ddm|=0.000582  |maxRot[o]|=0.000918
macro iter 11 (3 JK  0 micro), CASSCF E = -75.479463086382  dE = -1.3822884e-08  S^2 = 0.0000000
               |grad[o]|=4.88e-05  |ddm|=0.000171  |maxRot[o]|=0.000267
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4794630875463  dE = -1.1642385e-09  S^2 = 0.0000000
               |grad[o]|=1.44e-05  |ddm|=5.01e-05  |maxRot[o]|=7.74e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4794630876437  dE = -9.7386987e-11  S^2 = 0.0000000
               |grad[o]|=4.2e-06  |ddm|=1.46e-05  |maxRot[o]|=2.25e-05
2-step CASSCF converged in 13 macro (52 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95829684 1.93254559 1.88457143 1.75318656 0.06913527 0.2524963
 0.05723697 0.09253104]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01171   0.01031  -0.00343   0.00000   0.00000
  0 C 2s       0.67180   0.66526  -0.21945   0.00000  -0.00000
  0 C 3s      -0.00547   0.01587  -0.03746   0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69361
  0 C 2py      0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.21892  -0.23851   0.67009   0.00000  -0.00000
  0 C 3px      0.00000   0.00000   0.00000   0.00000  -0.06384
  0 C 3py      0.00000   0.00000   0.00000   0.05350  -0.00000
  0 C 3pz     -0.01342  -0.00181   0.01074   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000   0.03134   0.00000
  0 C 3dz^2    0.02038  -0.01199   0.03514   0.00000   0.00000
  0 C 3dxz     0.00000   0.00000   0.00000  -0.00000  -0.12178
 0 C 3dx2-y2   0.00055   0.00643  -0.00721  -0.00000  -0.00000
  1 C 1s       0.01171  -0.01031  -0.00343   0.00000   0.00000
  1 C 2s       0.67180  -0.66526  -0.21945  -0.00000  -0.00000
  1 C 3s      -0.00547  -0.01587  -0.03746  -0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69361
  1 C 2py     -0.00000  -0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.21892  -0.23851  -0.67009   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06384
  1 C 3py     -0.00000  -0.00000  -0.00000   0.05350  -0.00000
  1 C 3pz      0.01342  -0.00181  -0.01074   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.03134   0.00000
  1 C 3dz^2    0.02038   0.01199   0.03514  -0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12178
 1 C 3dx2-y2   0.00055  -0.00643  -0.00721   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00032
  0 C 2s       0.00000  -0.00000   0.23748
  0 C 3s      -0.00000  -0.00000   0.03235
  0 C 2px      0.00000   0.69804  -0.00000
  0 C 2py      0.70698  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.66400
  0 C 3px     -0.00000  -0.01120  -0.00000
  0 C 3py     -0.00856  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03555
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01047  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00616
  0 C 3dxz    -0.00000  -0.11230  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01875
  1 C 1s       0.00000   0.00000   0.00032
  1 C 2s       0.00000  -0.00000  -0.23748
  1 C 3s       0.00000   0.00000  -0.03235
  1 C 2px      0.00000  -0.69804   0.00000
  1 C 2py     -0.70698   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66400
  1 C 3px     -0.00000   0.01120   0.00000
  1 C 3py      0.00856   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03555
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01047  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00616
  1 C 3dxz     0.00000  -0.11230  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01875
<CAS-nat-orb|mo-hf>  3  3    0.99985292
<CAS-nat-orb|mo-hf>  4  4    0.99969360
<CAS-nat-orb|mo-hf>  5  5    0.99986456
<CAS-nat-orb|mo-hf>  6  6    0.99888267
<CAS-nat-orb|mo-hf>  7  7    0.93493366
<CAS-nat-orb|mo-hf>  8  8    0.98111604
<CAS-nat-orb|mo-hf>  9  9    0.96025422
<CAS-nat-orb|mo-hf>  10  10    0.93117477
CASSCF energy = -75.4794630876437
CASCI E = -75.4794630876437  E(CI) = -15.207507530585  S^2 = 0.0000000
Time cost =    153.516
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:24:15 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.931496819858 AA    0.000000000000   0.000000000000   3.650000000000 Bohr   0.0

nuclear repulsion = 9.86301369863014
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.825]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     17478.90


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpsojabojy
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7286668554631

WARN: Singularity detected in overlap matrix (condition number = 86.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.107001630831573  LUMO (B3u) = -0.107001630831574

WARN: B2u HOMO -0.107001630831573 > system LUMO -0.107001630831574

cycle= 1 E= -75.2718520447977  delta_E= -0.543  |g|= 0.238  |ddm|= 1.48
HOMO (B2u) = -0.363117515186496  LUMO (B3u) = -0.0549592840356628
cycle= 2 E= -75.2946135925964  delta_E= -0.0228  |g|= 0.0477  |ddm|= 0.349
HOMO (B2u) = -0.329037998444987  LUMO (B3u) = -0.0162218724304514
cycle= 3 E= -75.2959451182036  delta_E= -0.00133  |g|= 0.0175  |ddm|= 0.0628
HOMO (B2u) = -0.333444355785577  LUMO (B3u) = -0.0204649331299238
cycle= 4 E= -75.296162044047  delta_E= -0.000217  |g|= 0.000656  |ddm|= 0.0354
HOMO (B2u) = -0.333615190019283  LUMO (B3u) = -0.0207831790531184
cycle= 5 E= -75.2961622069416  delta_E= -1.63e-07  |g|= 0.000121  |ddm|= 0.000855
HOMO (B2u) = -0.333577969876329  LUMO (B3u) = -0.0207522115134136
cycle= 6 E= -75.2961622153582  delta_E= -8.42e-09  |g|= 1.83e-05  |ddm|= 0.000208
HOMO (B2u) = -0.333575376692483  LUMO (B3u) = -0.020752548741815
cycle= 7 E= -75.2961622155709  delta_E= -2.13e-10  |g|= 1.93e-06  |ddm|= 3.81e-05
HOMO (B2u) = -0.333574868730757  LUMO (B3u) = -0.0207524737518779
cycle= 8 E= -75.2961622155733  delta_E= -2.39e-12  |g|= 1.29e-07  |ddm|= 4e-06
HOMO (B2u) = -0.333574872987142  LUMO (B3u) = -0.0207524728268707
cycle= 9 E= -75.2961622155732  delta_E= 8.53e-14  |g|= 8.8e-09  |ddm|= 3e-07
HOMO (B2u) = -0.333574872574531  LUMO (B3u) = -0.0207524743961084
cycle= 10 E= -75.2961622155733  delta_E= -7.11e-14  |g|= 7.1e-09  |ddm|= 7.86e-09
HOMO (B2u) = -0.333574872452964  LUMO (B3u) = -0.020752474328607
cycle= 11 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 5.12e-09  |ddm|= 5.68e-09
HOMO (B2u) = -0.33357487109691  LUMO (B3u) = -0.0207524729162064
cycle= 12 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 4.45e-09  |ddm|= 2.65e-09
HOMO (B2u) = -0.333574871371722  LUMO (B3u) = -0.0207524732021935
cycle= 13 E= -75.2961622155733  delta_E=    0  |g|= 3.99e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.333574871232094  LUMO (B3u) = -0.0207524730608966
cycle= 14 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 3.27e-09  |ddm|= 2e-09
HOMO (B2u) = -0.33357487104424  LUMO (B3u) = -0.0207524729848087
cycle= 15 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 1.05e-09  |ddm|= 6.09e-09
HOMO (B2u) = -0.333574870954578  LUMO (B3u) = -0.02075247297052
cycle= 16 E= -75.2961622155733  delta_E= -5.68e-14  |g|= 1e-09  |ddm|= 1.14e-09
HOMO (B2u) = -0.333574870983925  LUMO (B3u) = -0.0207524729551497
cycle= 17 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 1.1e-09  |ddm|= 9.38e-10
HOMO (B2u) = -0.333574870946802  LUMO (B3u) = -0.020752472930436
cycle= 18 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 8.51e-10  |ddm|= 6.48e-10
HOMO (B2u) = -0.333574870941588  LUMO (B3u) = -0.0207524729366567
cycle= 19 E= -75.2961622155733  delta_E=    0  |g|= 6.87e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.33357487094051  LUMO (B3u) = -0.0207524729447963
cycle= 20 E= -75.2961622155733  delta_E= -4.26e-14  |g|= 5.63e-10  |ddm|= 3.74e-10
HOMO (B2u) = -0.333574870924976  LUMO (B3u) = -0.0207524729356092
cycle= 21 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 4.38e-10  |ddm|= 3.23e-10
HOMO (B2u) = -0.333574870913062  LUMO (B3u) = -0.0207524729306121
cycle= 22 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 3.19e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.333574870901543  LUMO (B3u) = -0.0207524729260786
cycle= 23 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 2.28e-10  |ddm|= 2.46e-10
HOMO (B2u) = -0.333574870894635  LUMO (B3u) = -0.020752472922715
cycle= 24 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 1.96e-10  |ddm|= 8.27e-11
HOMO (B2u) = -0.333574870891357  LUMO (B3u) = -0.0207524729198813
cycle= 25 E= -75.2961622155733  delta_E= -5.68e-14  |g|= 1.66e-10  |ddm|= 7.68e-11
HOMO (B2u) = -0.333574870886648  LUMO (B3u) = -0.0207524729173258
cycle= 26 E= -75.2961622155733  delta_E= 4.26e-14  |g|= 1.33e-10  |ddm|= 9e-11
HOMO (B2u) = -0.333574870882897  LUMO (B3u) = -0.0207524729152916
cycle= 27 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 1.08e-10  |ddm|= 6.94e-11
HOMO (B2u) = -0.333574870879805  LUMO (B3u) = -0.0207524729135815
cycle= 28 E= -75.2961622155733  delta_E= -1.42e-14  |g|= 8.71e-11  |ddm|= 5.6e-11
HOMO (B2u) = -0.333574870877359  LUMO (B3u) = -0.0207524729122625
cycle= 29 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 6.87e-11  |ddm|= 4.62e-11
HOMO (B2u) = -0.333574870875334  LUMO (B3u) = -0.0207524729111638
cycle= 30 E= -75.2961622155732  delta_E= 8.53e-14  |g|= 5.42e-11  |ddm|= 3.63e-11
HOMO (B2u) = -0.333574870873811  LUMO (B3u) = -0.0207524729103532
cycle= 31 E= -75.2961622155734  delta_E= -1.85e-13  |g|= 4.38e-11  |ddm|= 2.65e-11
HOMO (B2u) = -0.333574870872724  LUMO (B3u) = -0.0207524729097463
cycle= 32 E= -75.2961622155733  delta_E= 7.11e-14  |g|= 3.61e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.33357487087186  LUMO (B3u) = -0.020752472909233
cycle= 33 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 2.96e-11  |ddm|= 1.63e-11
HOMO (B2u) = -0.333574870871086  LUMO (B3u) = -0.0207524729088053
cycle= 34 E= -75.2961622155733  delta_E=    0  |g|= 2.42e-11  |ddm|= 1.39e-11
HOMO (B2u) = -0.333574870868955  LUMO (B3u) = -0.0207524729075851
Extra cycle  E= -75.2961622155733  delta_E=    0  |g|= 8.8e-12  |ddm|= 3.75e-11
converged SCF energy = -75.2961622155733

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpsojabojy
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4322916655019  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4476417851217  dE = -0.01535012  S^2 = 0.0000000
               |grad[o]|=0.0982  |ddm|= 3.79  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4596313154446  dE = -0.01198953  S^2 = 0.0000000
               |grad[o]|=0.0787  |ddm|=0.0963  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.467708036028  dE = -0.0080767206  S^2 = 0.0000000
               |grad[o]|=0.0566  |ddm|=0.0425  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4729323362446  dE = -0.0052243002  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.0846  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4745134386383  dE = -0.0015811024  S^2 = 0.0000000
               |grad[o]|=0.0141  |ddm|=0.069  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4749250270422  dE = -0.0004115884  S^2 = 0.0000000
               |grad[o]|=0.00645  |ddm|=0.0178  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.474975596107  dE = -5.0569065e-05  S^2 = 0.0000000
               |grad[o]|=0.00239  |ddm|=0.00767  |maxRot[o]|=0.0157
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4749799280372  dE = -4.3319302e-06  S^2 = 0.0000000
               |grad[o]|=0.00081  |ddm|=0.00276  |maxRot[o]|=0.00471
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4749802891726  dE = -3.6113536e-07  S^2 = 0.0000000
               |grad[o]|=0.000249  |ddm|=0.00084  |maxRot[o]|=0.00136
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4749803191  dE = -2.9927406e-08  S^2 = 0.0000000
               |grad[o]|=7.39e-05  |ddm|=0.000248  |maxRot[o]|=0.000392
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4749803215773  dE = -2.4772788e-09  S^2 = 0.0000000
               |grad[o]|=2.16e-05  |ddm|=7.21e-05  |maxRot[o]|=0.000112
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4749803217822  dE = -2.0492052e-10  S^2 = 0.0000000
               |grad[o]|=6.26e-06  |ddm|=2.09e-05  |maxRot[o]|=3.23e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4749803217992  dE = -1.7024604e-11  S^2 = 0.0000000
               |grad[o]|=1.81e-06  |ddm|=6.02e-06  |maxRot[o]|=9.28e-06
2-step CASSCF converged in 13 macro (51 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95767231 1.93317369 1.87988783 1.73905658 0.0679361  0.26647505
 0.056932   0.09886644]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01187   0.01040  -0.00309   0.00000   0.00000
  0 C 2s       0.67780   0.66796  -0.20019  -0.00000  -0.00000
  0 C 3s      -0.00350   0.01562  -0.03551  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69358
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439  -0.00000
  0 C 2pz      0.19981  -0.23087   0.67619  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06476
  0 C 3py      0.00000  -0.00000  -0.00000   0.05406  -0.00000
  0 C 3pz     -0.01243  -0.00176   0.01236  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03012  -0.00000
  0 C 3dz^2    0.01877  -0.01161   0.03492  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.12148
 0 C 3dx2-y2   0.00081   0.00633  -0.00713   0.00000   0.00000
  1 C 1s       0.01187  -0.01040  -0.00309   0.00000   0.00000
  1 C 2s       0.67780  -0.66796  -0.20019   0.00000   0.00000
  1 C 3s      -0.00350  -0.01562  -0.03551   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69358
  1 C 2py     -0.00000   0.00000   0.00000   0.70439   0.00000
  1 C 2pz     -0.19981  -0.23087  -0.67619  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06476
  1 C 3py     -0.00000   0.00000   0.00000   0.05406   0.00000
  1 C 3pz      0.01243  -0.00176  -0.01236  -0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03012  -0.00000
  1 C 3dz^2    0.01877   0.01161   0.03492   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12148
 1 C 3dx2-y2   0.00081  -0.00633  -0.00713  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.22994
  0 C 3s      -0.00000  -0.00000   0.03135
  0 C 2px     -0.00000   0.69817  -0.00000
  0 C 2py      0.70700  -0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.66687
  0 C 3px      0.00000  -0.01303  -0.00000
  0 C 3py     -0.00659   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03288
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01006   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00544
  0 C 3dxz     0.00000  -0.11131  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01768
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.22994
  1 C 3s       0.00000   0.00000  -0.03135
  1 C 2px     -0.00000  -0.69817   0.00000
  1 C 2py     -0.70700  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66687
  1 C 3px     -0.00000   0.01303   0.00000
  1 C 3py      0.00659   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03288
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01006   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00544
  1 C 3dxz     0.00000  -0.11131  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01768
<CAS-nat-orb|mo-hf>  3  3    0.99977693
<CAS-nat-orb|mo-hf>  4  4    0.99968291
<CAS-nat-orb|mo-hf>  5  5    0.99978338
<CAS-nat-orb|mo-hf>  6  6    0.99882147
<CAS-nat-orb|mo-hf>  7  7    0.93437311
<CAS-nat-orb|mo-hf>  8  8    0.98222688
<CAS-nat-orb|mo-hf>  9  9    0.96040421
<CAS-nat-orb|mo-hf>  10  10    0.93730552
CASSCF energy = -75.4749803217992
CASCI E = -75.4749803217992  E(CI) = -15.1422389244405  S^2 = 0.0000000
Time cost =    502.143
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:32:38 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.957955680404 AA    0.000000000000   0.000000000000   3.700000000000 Bohr   0.0

nuclear repulsion = 9.72972972972973
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.85]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     18034.59


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmp596rp5lg
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7163760223708

WARN: Singularity detected in overlap matrix (condition number = 80.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.104120790735628  LUMO (B3u) = -0.104120790735628

WARN: B2u HOMO -0.104120790735628 > system LUMO -0.104120790735628

cycle= 1 E= -75.2641203852923  delta_E= -0.548  |g|= 0.236  |ddm|= 1.47
HOMO (B2u) = -0.359408877513719  LUMO (B3u) = -0.0527582771899447
cycle= 2 E= -75.2865593123333  delta_E= -0.0224  |g|= 0.0471  |ddm|= 0.348
HOMO (B2u) = -0.325804970810899  LUMO (B3u) = -0.0145227547118889
cycle= 3 E= -75.2878678904738  delta_E= -0.00131  |g|= 0.0174  |ddm|= 0.0619
HOMO (B2u) = -0.330188258882718  LUMO (B3u) = -0.0187350374973014
cycle= 4 E= -75.2880824131579  delta_E= -0.000215  |g|= 0.000653  |ddm|= 0.035
HOMO (B2u) = -0.330355542534977  LUMO (B3u) = -0.019048577280892
cycle= 5 E= -75.288082574972  delta_E= -1.62e-07  |g|= 0.000124  |ddm|= 0.000847
HOMO (B2u) = -0.33031864363084  LUMO (B3u) = -0.0190186484174843
cycle= 6 E= -75.2880825838255  delta_E= -8.85e-09  |g|= 1.86e-05  |ddm|= 0.000214
HOMO (B2u) = -0.330315994378314  LUMO (B3u) = -0.0190189216398515
cycle= 7 E= -75.288082584047  delta_E= -2.21e-10  |g|= 1.93e-06  |ddm|= 3.86e-05
HOMO (B2u) = -0.330315507539101  LUMO (B3u) = -0.0190188734083559
cycle= 8 E= -75.2880825840493  delta_E= -2.37e-12  |g|= 1.29e-07  |ddm|= 4.01e-06
HOMO (B2u) = -0.330315512036518  LUMO (B3u) = -0.0190188725353905
cycle= 9 E= -75.2880825840494  delta_E= -7.11e-14  |g|= 8.84e-09  |ddm|= 3.07e-07
HOMO (B2u) = -0.33031551151506  LUMO (B3u) = -0.0190188740600878
cycle= 10 E= -75.2880825840493  delta_E= 7.11e-14  |g|= 7.23e-09  |ddm|= 7.7e-09
HOMO (B2u) = -0.330315511434366  LUMO (B3u) = -0.0190188740493973
cycle= 11 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 5.19e-09  |ddm|= 5.87e-09
HOMO (B2u) = -0.330315510116961  LUMO (B3u) = -0.0190188726786339
cycle= 12 E= -75.2880825840493  delta_E= -1.42e-14  |g|= 4.48e-09  |ddm|= 2.78e-09
HOMO (B2u) = -0.330315510361527  LUMO (B3u) = -0.0190188729363894
cycle= 13 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 4.02e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.330315510214254  LUMO (B3u) = -0.0190188727855602
cycle= 14 E= -75.2880825840494  delta_E= -8.53e-14  |g|= 3.28e-09  |ddm|= 2.15e-09
HOMO (B2u) = -0.330315510028999  LUMO (B3u) = -0.0190188727302581
cycle= 15 E= -75.2880825840493  delta_E= 8.53e-14  |g|= 1.06e-09  |ddm|= 6.34e-09
HOMO (B2u) = -0.330315509940734  LUMO (B3u) = -0.0190188727155125
cycle= 16 E= -75.2880825840493  delta_E= -5.68e-14  |g|= 9.94e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.330315509970086  LUMO (B3u) = -0.0190188726985773
cycle= 17 E= -75.2880825840493  delta_E=    0  |g|= 1.11e-09  |ddm|= 1e-09
HOMO (B2u) = -0.330315509932705  LUMO (B3u) = -0.0190188726753406
cycle= 18 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 8.61e-10  |ddm|= 6.58e-10
HOMO (B2u) = -0.330315509926699  LUMO (B3u) = -0.0190188726817605
cycle= 19 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 6.9e-10  |ddm|= 5.6e-10
HOMO (B2u) = -0.330315509925306  LUMO (B3u) = -0.0190188726902738
cycle= 20 E= -75.2880825840493  delta_E= 4.26e-14  |g|= 5.63e-10  |ddm|= 3.88e-10
HOMO (B2u) = -0.330315509909673  LUMO (B3u) = -0.019018872681769
cycle= 21 E= -75.2880825840493  delta_E= -5.68e-14  |g|= 4.37e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.330315509897369  LUMO (B3u) = -0.0190188726770229
cycle= 22 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 3.17e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.330315509885464  LUMO (B3u) = -0.019018872672822
cycle= 23 E= -75.2880825840493  delta_E= 4.26e-14  |g|= 2.27e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.330315509878504  LUMO (B3u) = -0.0190188726694862
cycle= 24 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 1.96e-10  |ddm|= 8.25e-11
HOMO (B2u) = -0.330315509875085  LUMO (B3u) = -0.0190188726666692
cycle= 25 E= -75.2880825840494  delta_E= -7.11e-14  |g|= 1.65e-10  |ddm|= 7.64e-11
HOMO (B2u) = -0.330315509870245  LUMO (B3u) = -0.0190188726642002
cycle= 26 E= -75.2880825840493  delta_E= 8.53e-14  |g|= 1.32e-10  |ddm|= 9.2e-11
HOMO (B2u) = -0.330315509866417  LUMO (B3u) = -0.0190188726622509
cycle= 27 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 1.07e-10  |ddm|= 7.12e-11
HOMO (B2u) = -0.330315509863257  LUMO (B3u) = -0.0190188726606034
cycle= 28 E= -75.2880825840493  delta_E=    0  |g|= 8.59e-11  |ddm|= 5.68e-11
HOMO (B2u) = -0.330315509855131  LUMO (B3u) = -0.0190188726564443
Extra cycle  E= -75.2880825840493  delta_E= 2.84e-14  |g|= 2.94e-11  |ddm|= 1.45e-10
converged SCF energy = -75.2880825840493

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmp596rp5lg
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4284824270344  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4443133541932  dE = -0.015830927  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|= 3.78  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4564312005314  dE = -0.012117846  S^2 = 0.0000000
               |grad[o]|=0.079  |ddm|=0.101  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4642866715352  dE = -0.007855471  S^2 = 0.0000000
               |grad[o]|=0.0552  |ddm|=0.0402  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4683743861291  dE = -0.0040877146  S^2 = 0.0000000
               |grad[o]|=0.032  |ddm|=0.0939  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4701448490488  dE = -0.0017704629  S^2 = 0.0000000
               |grad[o]|=0.0156  |ddm|=0.0559  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4705677128545  dE = -0.00042286381  S^2 = 0.0000000
               |grad[o]|=0.00657  |ddm|=0.0184  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4706176210692  dE = -4.9908215e-05  S^2 = 0.0000000
               |grad[o]|=0.00242  |ddm|=0.00761  |maxRot[o]|=0.0156
macro iter 8 (3 JK  0 micro), CASSCF E = -75.470621817114  dE = -4.1960448e-06  S^2 = 0.0000000
               |grad[o]|=0.000823  |ddm|=0.00269  |maxRot[o]|=0.00463
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4706221621622  dE = -3.4504815e-07  S^2 = 0.0000000
               |grad[o]|=0.000251  |ddm|=0.000815  |maxRot[o]|=0.00133
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4706221904068  dE = -2.8244656e-08  S^2 = 0.0000000
               |grad[o]|=7.44e-05  |ddm|=0.00024  |maxRot[o]|=0.000379
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4706221927127  dE = -2.3058675e-09  S^2 = 0.0000000
               |grad[o]|=2.17e-05  |ddm|=6.94e-05  |maxRot[o]|=0.000108
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4706221929015  dE = -1.8877699e-10  S^2 = 0.0000000
               |grad[o]|=6.23e-06  |ddm|=2.01e-05  |maxRot[o]|=3.08e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4706221929169  dE = -1.5447199e-11  S^2 = 0.0000000
               |grad[o]|=1.79e-06  |ddm|=5.75e-06  |maxRot[o]|=8.82e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95713289 1.93379643 1.87461992 1.72422801 0.06681526 0.28113864
 0.05662336 0.10564549]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01200   0.01047  -0.00276   0.00000   0.00000
  0 C 2s       0.68293   0.67051  -0.18198   0.00000  -0.00000
  0 C 3s      -0.00172   0.01539  -0.03356   0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69358
  0 C 2py     -0.00000   0.00000  -0.00000   0.70441   0.00000
  0 C 2pz      0.18173  -0.22338   0.68140   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06561
  0 C 3py     -0.00000   0.00000  -0.00000   0.05451   0.00000
  0 C 3pz     -0.01154  -0.00172   0.01401   0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02892  -0.00000
  0 C 3dz^2    0.01723  -0.01123   0.03460   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.12102
 0 C 3dx2-y2   0.00106   0.00623  -0.00705   0.00000   0.00000
  1 C 1s       0.01200  -0.01047  -0.00276   0.00000   0.00000
  1 C 2s       0.68293  -0.67051  -0.18198   0.00000  -0.00000
  1 C 3s      -0.00172  -0.01539  -0.03356  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69358
  1 C 2py      0.00000  -0.00000  -0.00000   0.70441   0.00000
  1 C 2pz     -0.18173  -0.22338  -0.68140   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06561
  1 C 3py      0.00000  -0.00000   0.00000   0.05451  -0.00000
  1 C 3pz      0.01154  -0.00172  -0.01401   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02892   0.00000
  1 C 3dz^2    0.01723   0.01123   0.03460  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12102
 1 C 3dx2-y2   0.00106  -0.00623  -0.00705   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00028
  0 C 2s       0.00000  -0.00000   0.22254
  0 C 3s       0.00000  -0.00000   0.03036
  0 C 2px     -0.00000   0.69830  -0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.66959
  0 C 3px     -0.00000  -0.01481   0.00000
  0 C 3py     -0.00465   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.03021
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00965   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00477
  0 C 3dxz    -0.00000  -0.11029  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01664
  1 C 1s       0.00000   0.00000   0.00028
  1 C 2s      -0.00000   0.00000  -0.22254
  1 C 3s      -0.00000   0.00000  -0.03036
  1 C 2px      0.00000  -0.69830  -0.00000
  1 C 2py     -0.70703  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66959
  1 C 3px      0.00000   0.01481   0.00000
  1 C 3py      0.00465   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.03021
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00965  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00477
  1 C 3dxz    -0.00000  -0.11029  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01664
<CAS-nat-orb|mo-hf>  3  3    0.99943449
<CAS-nat-orb|mo-hf>  4  4    0.99967130
<CAS-nat-orb|mo-hf>  5  5    0.99943415
<CAS-nat-orb|mo-hf>  6  6    0.99875809
<CAS-nat-orb|mo-hf>  7  7    0.93391056
<CAS-nat-orb|mo-hf>  8  8    0.98327030
<CAS-nat-orb|mo-hf>  9  9    0.96053902
<CAS-nat-orb|mo-hf>  10  10    0.94279395
CASSCF energy = -75.4706221929169
CASCI E = -75.4706221929169  E(CI) = -15.0787332351371  S^2 = 0.0000000
Time cost =    185.570
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:35:43 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.984414540950 AA    0.000000000000   0.000000000000   3.750000000000 Bohr   0.0

nuclear repulsion = 9.6
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.875]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     18715.46


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpod5_jg3v
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7049084284725

WARN: Singularity detected in overlap matrix (condition number = 75.6). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.101370211913452  LUMO (B3u) = -0.101370211913451

WARN: B2u HOMO -0.101370211913452 > system LUMO -0.101370211913451

cycle= 1 E= -75.2564523906343  delta_E= -0.552  |g|= 0.234  |ddm|= 1.47
HOMO (B2u) = -0.355831308623931  LUMO (B3u) = -0.0506406338501552
cycle= 2 E= -75.2785865089974  delta_E= -0.0221  |g|= 0.0465  |ddm|= 0.348
HOMO (B2u) = -0.322685006141469  LUMO (B3u) = -0.0128872994795377
cycle= 3 E= -75.2798715208091  delta_E= -0.00129  |g|= 0.0172  |ddm|= 0.061
HOMO (B2u) = -0.327043790963025  LUMO (B3u) = -0.0170677233110581
cycle= 4 E= -75.2800833606865  delta_E= -0.000212  |g|= 0.000651  |ddm|= 0.0346
HOMO (B2u) = -0.327204207243868  LUMO (B3u) = -0.0173729266447958
cycle= 5 E= -75.280083521623  delta_E= -1.61e-07  |g|= 0.000127  |ddm|= 0.00084
HOMO (B2u) = -0.327167734029073  LUMO (B3u) = -0.0173440705847772
cycle= 6 E= -75.2800835308717  delta_E= -9.25e-09  |g|= 1.89e-05  |ddm|= 0.000218
HOMO (B2u) = -0.327165039753318  LUMO (B3u) = -0.0173442874866667
cycle= 7 E= -75.2800835311012  delta_E= -2.29e-10  |g|= 1.94e-06  |ddm|= 3.91e-05
HOMO (B2u) = -0.327164572283918  LUMO (B3u) = -0.0173442642259032
cycle= 8 E= -75.2800835311035  delta_E= -2.3e-12  |g|= 1.3e-07  |ddm|= 4.03e-06
HOMO (B2u) = -0.327164577390822  LUMO (B3u) = -0.0173442637009174
cycle= 9 E= -75.2800835311035  delta_E= -8.53e-14  |g|= 8.76e-09  |ddm|= 3.12e-07
HOMO (B2u) = -0.327164576784046  LUMO (B3u) = -0.0173442652096213
cycle= 10 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 7.27e-09  |ddm|= 7.49e-09
HOMO (B2u) = -0.327164576737507  LUMO (B3u) = -0.0173442652407943
cycle= 11 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 5.21e-09  |ddm|= 5.89e-09
HOMO (B2u) = -0.327164575482595  LUMO (B3u) = -0.0173442639356574
cycle= 12 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 4.47e-09  |ddm|= 2.86e-09
HOMO (B2u) = -0.327164575694768  LUMO (B3u) = -0.0173442641642309
cycle= 13 E= -75.2800835311036  delta_E= -8.53e-14  |g|= 4e-09  |ddm|= 1.73e-09
HOMO (B2u) = -0.327164575241001  LUMO (B3u) = -0.0173442639313995
cycle= 14 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 9.56e-10  |ddm|= 7.34e-09
HOMO (B2u) = -0.327164575348837  LUMO (B3u) = -0.0173442639679634
cycle= 15 E= -75.2800835311035  delta_E=    0  |g|= 9.67e-10  |ddm|= 1.36e-09
HOMO (B2u) = -0.327164575274691  LUMO (B3u) = -0.0173442639511764
cycle= 16 E= -75.2800835311035  delta_E=    0  |g|= 9.32e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.327164575295708  LUMO (B3u) = -0.0173442639367225
cycle= 17 E= -75.2800835311036  delta_E= -8.53e-14  |g|= 1.03e-09  |ddm|= 7.82e-10
HOMO (B2u) = -0.327164575258548  LUMO (B3u) = -0.0173442639152443
cycle= 18 E= -75.2800835311035  delta_E= 8.53e-14  |g|= 7.76e-10  |ddm|= 6.6e-10
HOMO (B2u) = -0.327164575252135  LUMO (B3u) = -0.0173442639221678
cycle= 19 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 6.03e-10  |ddm|= 5.75e-10
HOMO (B2u) = -0.327164575250323  LUMO (B3u) = -0.0173442639310973
cycle= 20 E= -75.2800835311035  delta_E= -5.68e-14  |g|= 4.74e-10  |ddm|= 4.02e-10
HOMO (B2u) = -0.327164575234637  LUMO (B3u) = -0.0173442639235528
cycle= 21 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 3.48e-10  |ddm|= 3.4e-10
HOMO (B2u) = -0.327164575221931  LUMO (B3u) = -0.0173442639192378
cycle= 22 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 2.28e-10  |ddm|= 3.09e-10
HOMO (B2u) = -0.327164575218981  LUMO (B3u) = -0.0173442639164645
cycle= 23 E= -75.2800835311036  delta_E= 5.68e-14  |g|= 2.02e-10  |ddm|= 7.25e-11
HOMO (B2u) = -0.327164575212582  LUMO (B3u) = -0.0173442639133714
cycle= 24 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 1.73e-10  |ddm|= 7.56e-11
HOMO (B2u) = -0.327164575209119  LUMO (B3u) = -0.0173442639108147
cycle= 25 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 1.44e-10  |ddm|= 7.31e-11
HOMO (B2u) = -0.327164575204638  LUMO (B3u) = -0.0173442639086111
cycle= 26 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 1.13e-10  |ddm|= 8.65e-11
HOMO (B2u) = -0.327164575201216  LUMO (B3u) = -0.0173442639069132
cycle= 27 E= -75.2800835311036  delta_E=    0  |g|= 9.07e-11  |ddm|= 6.55e-11
HOMO (B2u) = -0.327164575192786  LUMO (B3u) = -0.0173442639024925
Extra cycle  E= -75.2800835311036  delta_E= -2.84e-14  |g|= 3.1e-11  |ddm|= 1.54e-10
converged SCF energy = -75.2800835311036

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpod5_jg3v
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4247711667705  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4410961607628  dE = -0.016324994  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4533243763556  dE = -0.012228216  S^2 = 0.0000000
               |grad[o]|=0.0793  |ddm|=0.107  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4609348681542  dE = -0.0076104918  S^2 = 0.0000000
               |grad[o]|=0.0537  |ddm|=0.0363  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4644374668709  dE = -0.0035025987  S^2 = 0.0000000
               |grad[o]|=0.029  |ddm|=0.102  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4660330713147  dE = -0.0015956044  S^2 = 0.0000000
               |grad[o]|=0.0144  |ddm|=0.0465  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4663655365184  dE = -0.0003324652  S^2 = 0.0000000
               |grad[o]|=0.00576  |ddm|=0.0163  |maxRot[o]|=0.0375
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4663950794207  dE = -2.9542902e-05  S^2 = 0.0000000
               |grad[o]|=0.00202  |ddm|=0.00671  |maxRot[o]|=0.0121
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4663975357625  dE = -2.4563418e-06  S^2 = 0.0000000
               |grad[o]|=0.000663  |ddm|=0.00206  |maxRot[o]|=0.00353
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4663977370562  dE = -2.0129373e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.000624  |maxRot[o]|=0.00101
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4663977534853  dE = -1.6429084e-08  S^2 = 0.0000000
               |grad[o]|=5.9e-05  |ddm|=0.000183  |maxRot[o]|=0.000287
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4663977548322  dE = -1.346919e-09  S^2 = 0.0000000
               |grad[o]|=1.71e-05  |ddm|=5.31e-05  |maxRot[o]|=8.13e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4663977549443  dE = -1.1210943e-10  S^2 = 0.0000000
               |grad[o]|=4.95e-06  |ddm|=1.52e-05  |maxRot[o]|=2.35e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4663977549536  dE = -9.2512664e-12  S^2 = 0.0000000
               |grad[o]|=1.43e-06  |ddm|=4.49e-06  |maxRot[o]|=6.65e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95667457 1.9344164  1.86874334 1.70868175 0.06576131 0.29650692
 0.0563102  0.1129055 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01211   0.01055  -0.00246   0.00000   0.00000
  0 C 2s       0.68726   0.67292  -0.16495  -0.00000  -0.00000
  0 C 3s      -0.00012   0.01517  -0.03163  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69361
  0 C 2py      0.00000  -0.00000  -0.00000   0.70443  -0.00000
  0 C 2pz      0.16481  -0.21605   0.68580   0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06639
  0 C 3py      0.00000  -0.00000  -0.00000   0.05485  -0.00000
  0 C 3pz     -0.01075  -0.00170   0.01569  -0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02772  -0.00000
  0 C 3dz^2    0.01579  -0.01087   0.03419  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.12041
 0 C 3dx2-y2   0.00128   0.00613  -0.00696   0.00000  -0.00000
  1 C 1s       0.01211  -0.01055  -0.00246   0.00000   0.00000
  1 C 2s       0.68726  -0.67292  -0.16495   0.00000   0.00000
  1 C 3s      -0.00012  -0.01517  -0.03163   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69361
  1 C 2py      0.00000  -0.00000  -0.00000   0.70443   0.00000
  1 C 2pz     -0.16481  -0.21605  -0.68580   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.06639
  1 C 3py     -0.00000   0.00000   0.00000   0.05485   0.00000
  1 C 3pz      0.01075  -0.00170  -0.01569  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02772  -0.00000
  1 C 3dz^2    0.01579   0.01087   0.03419   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.12041
 1 C 3dx2-y2   0.00128  -0.00613  -0.00696   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00026
  0 C 2s      -0.00000  -0.00000   0.21528
  0 C 3s      -0.00000  -0.00000   0.02936
  0 C 2px     -0.00000   0.69842   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67214
  0 C 3px      0.00000  -0.01654  -0.00000
  0 C 3py     -0.00273  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02753
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00925   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00414
  0 C 3dxz     0.00000  -0.10923   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01562
  1 C 1s       0.00000   0.00000   0.00026
  1 C 2s       0.00000   0.00000  -0.21528
  1 C 3s       0.00000   0.00000  -0.02936
  1 C 2px     -0.00000  -0.69842   0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.67214
  1 C 3px      0.00000   0.01654  -0.00000
  1 C 3py      0.00273  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02753
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00925   0.00000   0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00414
  1 C 3dxz    -0.00000  -0.10923   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01562
<CAS-nat-orb|mo-hf>  3  3    0.99890662
<CAS-nat-orb|mo-hf>  4  4    0.99965866
<CAS-nat-orb|mo-hf>  5  5    0.99889779
<CAS-nat-orb|mo-hf>  6  6    0.99869247
<CAS-nat-orb|mo-hf>  7  7    0.93353913
<CAS-nat-orb|mo-hf>  8  8    0.98425021
<CAS-nat-orb|mo-hf>  9  9    0.96066028
<CAS-nat-orb|mo-hf>  10  10    0.94772193
CASSCF energy = -75.4663977549536
CASCI E = -75.4663977549536  E(CI) = -15.0169341303923  S^2 = 0.0000000
Time cost =    248.562
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:39:52 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.010873401496 AA    0.000000000000   0.000000000000   3.800000000000 Bohr   0.0

nuclear repulsion = 9.47368421052632
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     18979.73


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpujt4_rox
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6942155395781

WARN: Singularity detected in overlap matrix (condition number = 70.9). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0987431605477896  LUMO (B3u) = -0.0987431605477894

WARN: B2u HOMO -0.0987431605477896 > system LUMO -0.0987431605477894

cycle= 1 E= -75.2488547171612  delta_E= -0.555  |g|= 0.232  |ddm|= 1.46
HOMO (B2u) = -0.352381746665136  LUMO (B3u) = -0.0486055106897032
cycle= 2 E= -75.2707023112209  delta_E= -0.0218  |g|= 0.046  |ddm|= 0.348
HOMO (B2u) = -0.319674633980572  LUMO (B3u) = -0.0113141174561864
cycle= 3 E= -75.2719633258624  delta_E= -0.00126  |g|= 0.0171  |ddm|= 0.0602
HOMO (B2u) = -0.324007395733244  LUMO (B3u) = -0.0154613624878779
cycle= 4 E= -75.2721722602516  delta_E= -0.000209  |g|= 0.000648  |ddm|= 0.0343
HOMO (B2u) = -0.32415788074313  LUMO (B3u) = -0.0157548749526153
cycle= 5 E= -75.2721724204055  delta_E= -1.6e-07  |g|= 0.000129  |ddm|= 0.000835
HOMO (B2u) = -0.324121920212104  LUMO (B3u) = -0.0157271018699664
cycle= 6 E= -75.2721724300014  delta_E= -9.6e-09  |g|= 1.92e-05  |ddm|= 0.000222
HOMO (B2u) = -0.324119190447211  LUMO (B3u) = -0.0157272676284082
cycle= 7 E= -75.2721724302383  delta_E= -2.37e-10  |g|= 1.95e-06  |ddm|= 3.95e-05
HOMO (B2u) = -0.324118740620184  LUMO (B3u) = -0.0157272677303692
cycle= 8 E= -75.2721724302407  delta_E= -2.36e-12  |g|= 1.3e-07  |ddm|= 4.06e-06
HOMO (B2u) = -0.324118746685161  LUMO (B3u) = -0.0157272678197189
cycle= 9 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 8.56e-09  |ddm|= 3.15e-07
HOMO (B2u) = -0.324118745997353  LUMO (B3u) = -0.0157272693135612
cycle= 10 E= -75.2721724302408  delta_E= -2.84e-14  |g|= 7.23e-09  |ddm|= 7.24e-09
HOMO (B2u) = -0.324118746006629  LUMO (B3u) = -0.0157272694126378
cycle= 11 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 5.15e-09  |ddm|= 5.93e-09
HOMO (B2u) = -0.324118744820872  LUMO (B3u) = -0.0157272681801599
cycle= 12 E= -75.2721724302408  delta_E= -4.26e-14  |g|= 4.4e-09  |ddm|= 2.95e-09
HOMO (B2u) = -0.324118745005803  LUMO (B3u) = -0.0157272683814157
cycle= 13 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 3.94e-09  |ddm|= 1.68e-09
HOMO (B2u) = -0.32411874456058  LUMO (B3u) = -0.0157272681655262
cycle= 14 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 9.13e-10  |ddm|= 7.36e-09
HOMO (B2u) = -0.324118744667978  LUMO (B3u) = -0.0157272682019656
cycle= 15 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 9.35e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.324118744591168  LUMO (B3u) = -0.0157272681874094
cycle= 16 E= -75.2721724302407  delta_E= -1.42e-14  |g|= 8.7e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.324118744616452  LUMO (B3u) = -0.0157272681692109
cycle= 17 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 9.98e-10  |ddm|= 9.93e-10
HOMO (B2u) = -0.324118744580856  LUMO (B3u) = -0.0157272681499968
cycle= 18 E= -75.2721724302407  delta_E= 1.42e-14  |g|= 7.54e-10  |ddm|= 6.37e-10
HOMO (B2u) = -0.324118744574943  LUMO (B3u) = -0.015727268157779
cycle= 19 E= -75.2721724302407  delta_E=    0  |g|= 5.82e-10  |ddm|= 5.74e-10
HOMO (B2u) = -0.324118744573836  LUMO (B3u) = -0.0157272681675963
cycle= 20 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 4.57e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.324118744559236  LUMO (B3u) = -0.0157272681614778
cycle= 21 E= -75.2721724302407  delta_E= 7.11e-14  |g|= 3.35e-10  |ddm|= 3.32e-10
HOMO (B2u) = -0.324118744547206  LUMO (B3u) = -0.0157272681580999
cycle= 22 E= -75.2721724302406  delta_E= 4.26e-14  |g|= 2.18e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.324118744544433  LUMO (B3u) = -0.015727268155456
cycle= 23 E= -75.2721724302407  delta_E= -9.95e-14  |g|= 1.93e-10  |ddm|= 6.88e-11
HOMO (B2u) = -0.324118744538231  LUMO (B3u) = -0.0157272681524917
cycle= 24 E= -75.2721724302407  delta_E= 1.42e-14  |g|= 1.65e-10  |ddm|= 7.26e-11
HOMO (B2u) = -0.324118744535119  LUMO (B3u) = -0.0157272681500452
cycle= 25 E= -75.2721724302408  delta_E= -7.11e-14  |g|= 1.38e-10  |ddm|= 6.72e-11
HOMO (B2u) = -0.324118744530837  LUMO (B3u) = -0.0157272681480844
cycle= 26 E= -75.2721724302408  delta_E= 4.26e-14  |g|= 1.08e-10  |ddm|= 8.37e-11
HOMO (B2u) = -0.324118744527586  LUMO (B3u) = -0.0157272681465821
cycle= 27 E= -75.2721724302407  delta_E= 1.42e-14  |g|= 8.7e-11  |ddm|= 6.36e-11
HOMO (B2u) = -0.324118744524969  LUMO (B3u) = -0.0157272681452985
cycle= 28 E= -75.2721724302408  delta_E= -1.42e-14  |g|= 6.91e-11  |ddm|= 4.83e-11
HOMO (B2u) = -0.324118744522977  LUMO (B3u) = -0.0157272681443211
cycle= 29 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 5.42e-11  |ddm|= 3.79e-11
HOMO (B2u) = -0.324118744521457  LUMO (B3u) = -0.0157272681435345
cycle= 30 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 4.29e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.324118744520471  LUMO (B3u) = -0.0157272681429949
cycle= 31 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 3.57e-11  |ddm|= 1.77e-11
HOMO (B2u) = -0.324118744519532  LUMO (B3u) = -0.0157272681425132
cycle= 32 E= -75.2721724302407  delta_E= 2.84e-14  |g|= 2.92e-11  |ddm|= 1.58e-11
HOMO (B2u) = -0.324118744518793  LUMO (B3u) = -0.0157272681421141
cycle= 33 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 2.38e-11  |ddm|= 1.37e-11
HOMO (B2u) = -0.32411874451814  LUMO (B3u) = -0.0157272681417895
cycle= 34 E= -75.2721724302408  delta_E= -2.84e-14  |g|= 1.93e-11  |ddm|= 1.16e-11
HOMO (B2u) = -0.324118744517628  LUMO (B3u) = -0.0157272681415267
cycle= 35 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 1.58e-11  |ddm|= 9e-12
HOMO (B2u) = -0.324118744517214  LUMO (B3u) = -0.0157272681413041
cycle= 36 E= -75.2721724302408  delta_E= -4.26e-14  |g|= 1.28e-11  |ddm|= 7.18e-12
HOMO (B2u) = -0.324118744516884  LUMO (B3u) = -0.0157272681411212
cycle= 37 E= -75.2721724302408  delta_E=    0  |g|= 1.04e-11  |ddm|= 5.67e-12
HOMO (B2u) = -0.324118744515988  LUMO (B3u) = -0.0157272681406163
Extra cycle  E= -75.2721724302407  delta_E= 2.84e-14  |g|= 3.86e-12  |ddm|= 1.52e-11
converged SCF energy = -75.2721724302407

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpujt4_rox
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4211674784893  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4380007566064  dE = -0.016833278  S^2 = 0.0000000
               |grad[o]|=0.104  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4503194901053  dE = -0.012318733  S^2 = 0.0000000
               |grad[o]|=0.0795  |ddm|=0.112  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4576628758688  dE = -0.0073433858  S^2 = 0.0000000
               |grad[o]|=0.052  |ddm|=0.0313  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4606478981278  dE = -0.0029850223  S^2 = 0.0000000
               |grad[o]|=0.0258  |ddm|=0.108  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4620547102406  dE = -0.0014068121  S^2 = 0.0000000
               |grad[o]|=0.0131  |ddm|=0.0375  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4622921063037  dE = -0.00023739606  S^2 = 0.0000000
               |grad[o]|=0.00495  |ddm|=0.0145  |maxRot[o]|=0.0323
macro iter 7 (3 JK  0 micro), CASSCF E = -75.462312784309  dE = -2.0678005e-05  S^2 = 0.0000000
               |grad[o]|=0.00178  |ddm|=0.00552  |maxRot[o]|=0.0101
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4623145068647  dE = -1.7225557e-06  S^2 = 0.0000000
               |grad[o]|=0.000579  |ddm|=0.00172  |maxRot[o]|=0.00294
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4623146489296  dE = -1.4206495e-07  S^2 = 0.0000000
               |grad[o]|=0.000174  |ddm|=0.000526  |maxRot[o]|=0.000839
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4623146606368  dE = -1.1707172e-08  S^2 = 0.0000000
               |grad[o]|=5.14e-05  |ddm|=0.000155  |maxRot[o]|=0.000239
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4623146616044  dE = -9.6756025e-10  S^2 = 0.0000000
               |grad[o]|=1.5e-05  |ddm|=4.51e-05  |maxRot[o]|=6.85e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4623146616921  dE = -8.7737817e-11  S^2 = 0.0000000
               |grad[o]|=4.32e-06  |ddm|=1.31e-05  |maxRot[o]|=1.93e-05
2-step CASSCF converged in 12 macro (48 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9562916  1.9350335  1.86223013 1.69240306 0.06476757 0.312595
 0.05599298 0.12068616]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01220   0.01062  -0.00217   0.00000   0.00000
  0 C 2s       0.69087   0.67520  -0.14918  -0.00000   0.00000
  0 C 3s       0.00130   0.01496  -0.02972  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69367
  0 C 2py      0.00000  -0.00000  -0.00000   0.70446   0.00000
  0 C 2pz      0.14914  -0.20886   0.68947  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06711
  0 C 3py      0.00000  -0.00000  -0.00000   0.05509  -0.00000
  0 C 3pz     -0.01004  -0.00168   0.01737  -0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02654   0.00000
  0 C 3dz^2    0.01444  -0.01051   0.03370  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.11966
 0 C 3dx2-y2   0.00150   0.00603  -0.00686  -0.00000  -0.00000
  1 C 1s       0.01220  -0.01062  -0.00217   0.00000   0.00000
  1 C 2s       0.69087  -0.67520  -0.14918   0.00000  -0.00000
  1 C 3s       0.00130  -0.01496  -0.02972   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69367
  1 C 2py     -0.00000   0.00000   0.00000   0.70446   0.00000
  1 C 2pz     -0.14914  -0.20886  -0.68947   0.00000   0.00000
  1 C 3px     -0.00000  -0.00000   0.00000   0.00000  -0.06711
  1 C 3py     -0.00000   0.00000   0.00000   0.05509  -0.00000
  1 C 3pz      0.01004  -0.00168  -0.01737  -0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02654   0.00000
  1 C 3dz^2    0.01444   0.01051   0.03370   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11966
 1 C 3dx2-y2   0.00150  -0.00603  -0.00686  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s      -0.00000   0.00000   0.20816
  0 C 3s      -0.00000   0.00000   0.02837
  0 C 2px     -0.00000   0.69855   0.00000
  0 C 2py      0.70705  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67455
  0 C 3px     -0.00000  -0.01822   0.00000
  0 C 3py     -0.00084  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.02485
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00885  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00357
  0 C 3dxz    -0.00000  -0.10813  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01462
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000   0.00000  -0.20816
  1 C 3s       0.00000  -0.00000  -0.02837
  1 C 2px      0.00000  -0.69855  -0.00000
  1 C 2py     -0.70705   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.67455
  1 C 3px      0.00000   0.01822  -0.00000
  1 C 3py      0.00084   0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.02485
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00885  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00357
  1 C 3dxz    -0.00000  -0.10813   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01462
<CAS-nat-orb|mo-hf>  3  3    0.99826978
<CAS-nat-orb|mo-hf>  4  4    0.99964484
<CAS-nat-orb|mo-hf>  5  5    0.99825063
<CAS-nat-orb|mo-hf>  6  6    0.99862457
<CAS-nat-orb|mo-hf>  7  7    0.93325604
<CAS-nat-orb|mo-hf>  8  8    0.98517025
<CAS-nat-orb|mo-hf>  9  9    0.96077010
<CAS-nat-orb|mo-hf>  10  10    0.95215926
CASSCF energy = -75.4623146616921
CASCI E = -75.4623146616921  E(CI) = -14.956787196597  S^2 = 0.0000000
Time cost =    224.704
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:43:36 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.037332262042 AA    0.000000000000   0.000000000000   3.850000000000 Bohr   0.0

nuclear repulsion = 9.35064935064935
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     19322.59


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpo15j3v2b
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6842509501291

WARN: Singularity detected in overlap matrix (condition number = 66.5). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0962332913313832  LUMO (B3u) = -0.0962332913313836

WARN: B2u HOMO -0.0962332913313832 > system LUMO -0.0962332913313836

cycle= 1 E= -75.2413330204141  delta_E= -0.557  |g|= 0.231  |ddm|= 1.46
HOMO (B2u) = -0.349057007799766  LUMO (B3u) = -0.046651841498527
cycle= 2 E= -75.2629125920112  delta_E= -0.0216  |g|= 0.0454  |ddm|= 0.348
HOMO (B2u) = -0.316770424633127  LUMO (B3u) = -0.00980180087757485
cycle= 3 E= -75.2641493459228  delta_E= -0.00124  |g|= 0.0169  |ddm|= 0.0593
HOMO (B2u) = -0.321075514288451  LUMO (B3u) = -0.0139142694602779
cycle= 4 E= -75.2643552043106  delta_E= -0.000206  |g|= 0.000645  |ddm|= 0.0339
HOMO (B2u) = -0.321213308623816  LUMO (B3u) = -0.0141930697532588
cycle= 5 E= -75.2643553636796  delta_E= -1.59e-07  |g|= 0.000131  |ddm|= 0.00083
HOMO (B2u) = -0.321177935176443  LUMO (B3u) = -0.0141663723644061
cycle= 6 E= -75.2643553735705  delta_E= -9.89e-09  |g|= 1.94e-05  |ddm|= 0.000225
HOMO (B2u) = -0.321175177873361  LUMO (B3u) = -0.0141664898415917
cycle= 7 E= -75.2643553738139  delta_E= -2.43e-10  |g|= 1.96e-06  |ddm|= 3.98e-05
HOMO (B2u) = -0.32117474398912  LUMO (B3u) = -0.0141665118435179
cycle= 8 E= -75.2643553738163  delta_E= -2.4e-12  |g|= 1.29e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.321174751334246  LUMO (B3u) = -0.0141665127831184
cycle= 9 E= -75.2643553738164  delta_E= -9.95e-14  |g|= 8.24e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.321174750586021  LUMO (B3u) = -0.0141665142914167
cycle= 10 E= -75.2643553738163  delta_E= 8.53e-14  |g|= 7.1e-09  |ddm|= 7e-09
HOMO (B2u) = -0.32117475064841  LUMO (B3u) = -0.0141665144468963
cycle= 11 E= -75.2643553738164  delta_E= -5.68e-14  |g|= 5.05e-09  |ddm|= 5.79e-09
HOMO (B2u) = -0.321174749547543  LUMO (B3u) = -0.0141665133016678
cycle= 12 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 4.3e-09  |ddm|= 2.96e-09
HOMO (B2u) = -0.321174749705772  LUMO (B3u) = -0.0141665134763146
cycle= 13 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 3.84e-09  |ddm|= 1.62e-09
HOMO (B2u) = -0.321174749276086  LUMO (B3u) = -0.0141665132807131
cycle= 14 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 8.46e-10  |ddm|= 7.27e-09
HOMO (B2u) = -0.321174749384413  LUMO (B3u) = -0.0141665133175784
cycle= 15 E= -75.2643553738163  delta_E= -5.68e-14  |g|= 8.86e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.321174749314228  LUMO (B3u) = -0.0141665133002179
cycle= 16 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 8.32e-10  |ddm|= 1.09e-09
HOMO (B2u) = -0.321174749334067  LUMO (B3u) = -0.0141665132830429
cycle= 17 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 9.5e-10  |ddm|= 8.65e-10
HOMO (B2u) = -0.321174749300876  LUMO (B3u) = -0.0141665132663264
cycle= 18 E= -75.2643553738164  delta_E= -8.53e-14  |g|= 7.19e-10  |ddm|= 5.96e-10
HOMO (B2u) = -0.321174749296385  LUMO (B3u) = -0.0141665132753543
cycle= 19 E= -75.2643553738163  delta_E= 9.95e-14  |g|= 5.53e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.321174749296467  LUMO (B3u) = -0.0141665132862518
cycle= 20 E= -75.2643553738163  delta_E= -7.11e-14  |g|= 4.34e-10  |ddm|= 3.85e-10
HOMO (B2u) = -0.321174749283509  LUMO (B3u) = -0.0141665132818992
cycle= 21 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 3.16e-10  |ddm|= 3.17e-10
HOMO (B2u) = -0.321174749272675  LUMO (B3u) = -0.0141665132797482
cycle= 22 E= -75.2643553738163  delta_E=    0  |g|= 2.05e-10  |ddm|= 2.88e-10
HOMO (B2u) = -0.321174749270219  LUMO (B3u) = -0.014166513277276
cycle= 23 E= -75.2643553738163  delta_E= -4.26e-14  |g|= 1.81e-10  |ddm|= 6.26e-11
HOMO (B2u) = -0.321174749264328  LUMO (B3u) = -0.0141665132744846
cycle= 24 E= -75.2643553738163  delta_E= 7.11e-14  |g|= 1.55e-10  |ddm|= 6.81e-11
HOMO (B2u) = -0.321174749261278  LUMO (B3u) = -0.0141665132723191
cycle= 25 E= -75.2643553738163  delta_E= -2.84e-14  |g|= 1.29e-10  |ddm|= 6.37e-11
HOMO (B2u) = -0.321174749257336  LUMO (B3u) = -0.014166513270684
cycle= 26 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 1.01e-10  |ddm|= 7.87e-11
HOMO (B2u) = -0.321174749254358  LUMO (B3u) = -0.0141665132694381
cycle= 27 E= -75.2643553738163  delta_E= -5.68e-14  |g|= 8.15e-11  |ddm|= 6.01e-11
HOMO (B2u) = -0.321174749251937  LUMO (B3u) = -0.0141665132683409
cycle= 28 E= -75.2643553738163  delta_E= 2.84e-14  |g|= 6.48e-11  |ddm|= 4.53e-11
HOMO (B2u) = -0.321174749250079  LUMO (B3u) = -0.0141665132674935
cycle= 29 E= -75.2643553738163  delta_E=    0  |g|= 5.07e-11  |ddm|= 3.54e-11
HOMO (B2u) = -0.321174749245488  LUMO (B3u) = -0.0141665132652682
Extra cycle  E= -75.2643553738163  delta_E= 2.84e-14  |g|= 1.78e-11  |ddm|= 8.22e-11
converged SCF energy = -75.2643553738163

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpo15j3v2b
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4176796778921  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4350360693864  dE = -0.017356391  S^2 = 0.0000000
               |grad[o]|=0.106  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4474226988146  dE = -0.012386629  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.117  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4544788059292  dE = -0.0070561071  S^2 = 0.0000000
               |grad[o]|=0.0502  |ddm|=0.0257  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4570100430816  dE = -0.0025312372  S^2 = 0.0000000
               |grad[o]|=0.0225  |ddm|= 0.11  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4582120424848  dE = -0.0012019994  S^2 = 0.0000000
               |grad[o]|=0.0117  |ddm|=0.0293  |maxRot[o]|=0.0599
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4583431399263  dE = -0.00013109744  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.013  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4583762943602  dE = -3.3154434e-05  S^2 = 0.0000000
               |grad[o]|=0.00212  |ddm|=0.00331  |maxRot[o]|=0.0127
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4583790907346  dE = -2.7963744e-06  S^2 = 0.0000000
               |grad[o]|=0.000733  |ddm|=0.00214  |maxRot[o]|=0.00372
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4583793249553  dE = -2.3422072e-07  S^2 = 0.0000000
               |grad[o]|=0.000228  |ddm|=0.000666  |maxRot[o]|=0.00107
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4583793444848  dE = -1.952948e-08  S^2 = 0.0000000
               |grad[o]|=6.8e-05  |ddm|=0.0002  |maxRot[o]|=0.000307
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4583793461193  dE = -1.6345041e-09  S^2 = 0.0000000
               |grad[o]|=2e-05  |ddm|=5.91e-05  |maxRot[o]|=8.82e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4583793462597  dE = -1.4043167e-10  S^2 = 0.0000000
               |grad[o]|=5.87e-06  |ddm|=1.72e-05  |maxRot[o]|=2.55e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4583793462634  dE = -3.623768e-12  S^2 = 0.0000000
               |grad[o]|=1.7e-06  |ddm|=4.77e-06  |maxRot[o]|=7.43e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95597942 1.93565101 1.85505357 1.67538719 0.06382152 0.32940982
 0.05567107 0.12902641]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01228   0.01069  -0.00190   0.00000   0.00000
  0 C 2s       0.69385   0.67734  -0.13470  -0.00000  -0.00000
  0 C 3s       0.00257   0.01477  -0.02786  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69376
  0 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  0 C 2pz      0.13475  -0.20184   0.69251   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06778
  0 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  0 C 3pz     -0.00941  -0.00168   0.01906  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02538  -0.00000
  0 C 3dz^2    0.01317  -0.01016   0.03314  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.11878
 0 C 3dx2-y2   0.00169   0.00594  -0.00676   0.00000  -0.00000
  1 C 1s       0.01228  -0.01069  -0.00190   0.00000   0.00000
  1 C 2s       0.69385  -0.67734  -0.13470   0.00000  -0.00000
  1 C 3s       0.00257  -0.01477  -0.02786  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69376
  1 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  1 C 2pz     -0.13475  -0.20184  -0.69251  -0.00000  -0.00000
  1 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06778
  1 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  1 C 3pz      0.00941  -0.00168  -0.01906   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.02538   0.00000
  1 C 3dz^2    0.01317   0.01016   0.03314  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11878
 1 C 3dx2-y2   0.00169  -0.00594  -0.00676  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.20120
  0 C 3s      -0.00000  -0.00000   0.02738
  0 C 2px     -0.00000   0.69868  -0.00000
  0 C 2py      0.70706  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.67682
  0 C 3px     -0.00000  -0.01985  -0.00000
  0 C 3py      0.00101  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02216
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00847   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00304
  0 C 3dxz    -0.00000  -0.10700  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01365
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s       0.00000   0.00000  -0.20120
  1 C 3s       0.00000   0.00000  -0.02738
  1 C 2px      0.00000  -0.69868   0.00000
  1 C 2py     -0.70706   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67682
  1 C 3px      0.00000   0.01985   0.00000
  1 C 3py     -0.00101   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02216
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00847  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00304
  1 C 3dxz    -0.00000  -0.10700  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01365
<CAS-nat-orb|mo-hf>  3  3    0.99758995
<CAS-nat-orb|mo-hf>  4  4    0.99962978
<CAS-nat-orb|mo-hf>  5  5    0.99755853
<CAS-nat-orb|mo-hf>  6  6    0.99855438
<CAS-nat-orb|mo-hf>  7  7    0.93305005
<CAS-nat-orb|mo-hf>  8  8    0.98603349
<CAS-nat-orb|mo-hf>  9  9    0.96086979
<CAS-nat-orb|mo-hf>  10  10    0.95616481
CASSCF energy = -75.4583793462634
CASCI E = -75.4583793462634  E(CI) = -14.8982403377179  S^2 = 0.0000000
Time cost =    234.502
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:47:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.063791122588 AA    0.000000000000   0.000000000000   3.900000000000 Bohr   0.0

nuclear repulsion = 9.23076923076923
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     19831.96


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpd1837t5v
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6749703835052

WARN: Singularity detected in overlap matrix (condition number = 62.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0938346227346638  LUMO (B3u) = -0.0938346227346634

WARN: B2u HOMO -0.0938346227346638 > system LUMO -0.0938346227346634

cycle= 1 E= -75.2338921256662  delta_E= -0.559  |g|= 0.229  |ddm|= 1.46
HOMO (B2u) = -0.345853796512398  LUMO (B3u) = -0.0447783510681946
cycle= 2 E= -75.2552221736389  delta_E= -0.0213  |g|= 0.0449  |ddm|= 0.347
HOMO (B2u) = -0.313968969330058  LUMO (B3u) = -0.00834890411120062
cycle= 3 E= -75.2564345511741  delta_E= -0.00121  |g|= 0.0167  |ddm|= 0.0585
HOMO (B2u) = -0.318244577067682  LUMO (B3u) = -0.0124246975036483
cycle= 4 E= -75.256637209921  delta_E= -0.000203  |g|= 0.000641  |ddm|= 0.0335
HOMO (B2u) = -0.318367270990408  LUMO (B3u) = -0.0126861477138963
cycle= 5 E= -75.2566373684187  delta_E= -1.58e-07  |g|= 0.000132  |ddm|= 0.000824
HOMO (B2u) = -0.318332550664858  LUMO (B3u) = -0.012660506782998
cycle= 6 E= -75.2566373785486  delta_E= -1.01e-08  |g|= 1.96e-05  |ddm|= 0.000227
HOMO (B2u) = -0.318329772186372  LUMO (B3u) = -0.0126605767315261
cycle= 7 E= -75.2566373787974  delta_E= -2.49e-10  |g|= 1.98e-06  |ddm|= 4.01e-05
HOMO (B2u) = -0.318329352566612  LUMO (B3u) = -0.0126606192769658
cycle= 8 E= -75.2566373788  delta_E= -2.59e-12  |g|= 1.29e-07  |ddm|= 4.15e-06
HOMO (B2u) = -0.318329361478583  LUMO (B3u) = -0.0126606212717042
cycle= 9 E= -75.2566373787999  delta_E= 1.14e-13  |g|= 7.84e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.318329360674068  LUMO (B3u) = -0.0126606228000817
cycle= 10 E= -75.2566373788  delta_E= -1.14e-13  |g|= 6.91e-09  |ddm|= 6.79e-09
HOMO (B2u) = -0.318329360806498  LUMO (B3u) = -0.0126606230300989
cycle= 11 E= -75.2566373788  delta_E= -5.68e-14  |g|= 4.88e-09  |ddm|= 5.63e-09
HOMO (B2u) = -0.318329359796772  LUMO (B3u) = -0.0126606219767142
cycle= 12 E= -75.2566373788  delta_E= 5.68e-14  |g|= 4.15e-09  |ddm|= 2.93e-09
HOMO (B2u) = -0.318329359932329  LUMO (B3u) = -0.0126606221275901
cycle= 13 E= -75.2566373788  delta_E= -2.84e-14  |g|= 3.71e-09  |ddm|= 1.53e-09
HOMO (B2u) = -0.318329359525074  LUMO (B3u) = -0.0126606219552751
cycle= 14 E= -75.2566373788  delta_E=    0  |g|= 7.6e-10  |ddm|= 7.09e-09
HOMO (B2u) = -0.318329359627948  LUMO (B3u) = -0.012660621988232
cycle= 15 E= -75.2566373788  delta_E= 2.84e-14  |g|= 8.15e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.318329359559872  LUMO (B3u) = -0.0126606219794053
cycle= 16 E= -75.2566373788  delta_E=    0  |g|= 7.33e-10  |ddm|= 8.25e-10
HOMO (B2u) = -0.318329359584569  LUMO (B3u) = -0.0126606219560496
cycle= 17 E= -75.2566373788  delta_E=    0  |g|= 8.83e-10  |ddm|= 1.15e-09
HOMO (B2u) = -0.318329359554421  LUMO (B3u) = -0.0126606219419953
cycle= 18 E= -75.2566373788  delta_E=    0  |g|= 6.7e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.318329359551794  LUMO (B3u) = -0.0126606219524404
cycle= 19 E= -75.2566373787999  delta_E= 5.68e-14  |g|= 5.12e-10  |ddm|= 5.28e-10
HOMO (B2u) = -0.318329359553569  LUMO (B3u) = -0.0126606219646456
cycle= 20 E= -75.2566373788  delta_E= -8.53e-14  |g|= 4.02e-10  |ddm|= 3.62e-10
HOMO (B2u) = -0.318329359542698  LUMO (B3u) = -0.0126606219622895
cycle= 21 E= -75.2566373788  delta_E= 5.68e-14  |g|= 2.91e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.318329359533477  LUMO (B3u) = -0.0126606219616099
cycle= 22 E= -75.2566373788  delta_E= -8.53e-14  |g|= 1.86e-10  |ddm|= 2.67e-10
HOMO (B2u) = -0.318329359531403  LUMO (B3u) = -0.0126606219593394
cycle= 23 E= -75.2566373788  delta_E= 2.84e-14  |g|= 1.65e-10  |ddm|= 5.47e-11
HOMO (B2u) = -0.31832935952617  LUMO (B3u) = -0.0126606219569
cycle= 24 E= -75.2566373788  delta_E= 5.68e-14  |g|= 1.4e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.318329359523765  LUMO (B3u) = -0.0126606219548835
cycle= 25 E= -75.2566373788  delta_E=    0  |g|= 1.18e-10  |ddm|= 5.42e-11
HOMO (B2u) = -0.318329359520321  LUMO (B3u) = -0.0126606219536406
cycle= 26 E= -75.2566373788  delta_E= -5.68e-14  |g|= 9.24e-11  |ddm|= 7.12e-11
HOMO (B2u) = -0.318329359517742  LUMO (B3u) = -0.0126606219527019
cycle= 27 E= -75.2566373788  delta_E= 2.84e-14  |g|= 7.47e-11  |ddm|= 5.46e-11
HOMO (B2u) = -0.318329359515619  LUMO (B3u) = -0.0126606219518246
cycle= 28 E= -75.2566373788  delta_E=    0  |g|= 5.95e-11  |ddm|= 4.08e-11
HOMO (B2u) = -0.318329359510553  LUMO (B3u) = -0.0126606219495494
Extra cycle  E= -75.2566373788  delta_E=    0  |g|= 2.09e-11  |ddm|= 9.5e-11
converged SCF energy = -75.2566373788

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpd1837t5v
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4143148843351  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4322089312408  dE = -0.017894047  S^2 = 0.0000000
               |grad[o]|=0.108  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.444639010191  dE = -0.012430079  S^2 = 0.0000000
               |grad[o]|=0.0797  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4513833169246  dE = -0.0067443067  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.0218  |maxRot[o]|=0.0798
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4535226116646  dE = -0.0021392947  S^2 = 0.0000000
               |grad[o]|=0.0191  |ddm|=0.109  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.454305171361  dE = -0.0007825597  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0227  |maxRot[o]|= 0.04
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4545713698985  dE = -0.00026619854  S^2 = 0.0000000
               |grad[o]|=0.00524  |ddm|=0.00808  |maxRot[o]|=0.0333
macro iter 7 (3 JK  0 micro), CASSCF E = -75.454594923569  dE = -2.3553671e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00574  |maxRot[o]|=0.0107
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4545969674346  dE = -2.0438657e-06  S^2 = 0.0000000
               |grad[o]|=0.000657  |ddm|=0.00185  |maxRot[o]|=0.00315
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4545971430655  dE = -1.7563084e-07  S^2 = 0.0000000
               |grad[o]|=0.000203  |ddm|=0.000583  |maxRot[o]|=0.000913
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4545971581098  dE = -1.5044307e-08  S^2 = 0.0000000
               |grad[o]|=6.12e-05  |ddm|=0.000176  |maxRot[o]|=0.000266
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4545971593832  dE = -1.2734489e-09  S^2 = 0.0000000
               |grad[o]|=1.83e-05  |ddm|=5.27e-05  |maxRot[o]|=7.71e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.454597159491  dE = -1.0773249e-10  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=1.57e-05  |maxRot[o]|=2.24e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4545971594996  dE = -8.5975671e-12  S^2 = 0.0000000
               |grad[o]|=1.57e-06  |ddm|=4.58e-06  |maxRot[o]|=6.58e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95573076 1.93626698 1.84718162 1.65763445 0.06292257 0.34695114
 0.05534507 0.13796741]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01234   0.01075  -0.00166   0.00000   0.00000
  0 C 2s       0.69629   0.67936  -0.12152  -0.00000  -0.00000
  0 C 3s       0.00370   0.01459  -0.02605   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69387
  0 C 2py     -0.00000   0.00000   0.00000   0.70453  -0.00000
  0 C 2pz      0.12164  -0.19495   0.69500  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06838
  0 C 3py     -0.00000   0.00000  -0.00000   0.05527   0.00000
  0 C 3pz     -0.00884  -0.00169   0.02073   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02424   0.00000
  0 C 3dz^2    0.01200  -0.00982   0.03250   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.11777
 0 C 3dx2-y2   0.00188   0.00585  -0.00666  -0.00000  -0.00000
  1 C 1s       0.01234  -0.01075  -0.00166   0.00000   0.00000
  1 C 2s       0.69629  -0.67936  -0.12152  -0.00000   0.00000
  1 C 3s       0.00370  -0.01459  -0.02605  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69387
  1 C 2py      0.00000  -0.00000   0.00000   0.70453  -0.00000
  1 C 2pz     -0.12164  -0.19495  -0.69500  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06838
  1 C 3py      0.00000  -0.00000  -0.00000   0.05527   0.00000
  1 C 3pz      0.00884  -0.00169  -0.02073   0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.02424  -0.00000
  1 C 3dz^2    0.01200   0.00982   0.03250  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.11777
 1 C 3dx2-y2   0.00188  -0.00585  -0.00666   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00021
  0 C 2s      -0.00000  -0.00000   0.19437
  0 C 3s       0.00000  -0.00000   0.02640
  0 C 2px     -0.00000   0.69881  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.67895
  0 C 3px      0.00000  -0.02144   0.00000
  0 C 3py      0.00283  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01949
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00809  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00255
  0 C 3dxz     0.00000  -0.10583   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01271
  1 C 1s       0.00000   0.00000   0.00021
  1 C 2s      -0.00000   0.00000  -0.19437
  1 C 3s       0.00000   0.00000  -0.02640
  1 C 2px     -0.00000  -0.69881  -0.00000
  1 C 2py     -0.70705  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67895
  1 C 3px      0.00000   0.02144   0.00000
  1 C 3py     -0.00283  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01949
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00809  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00255
  1 C 3dxz    -0.00000  -0.10583  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.01271
<CAS-nat-orb|mo-hf>  3  3    0.99692136
<CAS-nat-orb|mo-hf>  4  4    0.99961325
<CAS-nat-orb|mo-hf>  5  5    0.99687558
<CAS-nat-orb|mo-hf>  6  6    0.99848189
<CAS-nat-orb|mo-hf>  7  7    0.93292275
<CAS-nat-orb|mo-hf>  8  8    0.98684296
<CAS-nat-orb|mo-hf>  9  9    0.96096128
<CAS-nat-orb|mo-hf>  10  10    0.95978892
CASSCF energy = -75.4545971594996
CASCI E = -75.4545971594996  E(CI) = -14.8412429814242  S^2 = 0.0000000
Time cost =    241.839
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:51:33 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.090249983134 AA    0.000000000000   0.000000000000   3.950000000000 Bohr   0.0

nuclear repulsion = 9.11392405063291
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     20362.69


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpkhj8ntcw
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6663316753772

WARN: Singularity detected in overlap matrix (condition number = 58.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0915415140147806  LUMO (B3u) = -0.0915415140147811

WARN: B2u HOMO -0.0915415140147806 > system LUMO -0.0915415140147811

cycle= 1 E= -75.2265361682301  delta_E= -0.56  |g|= 0.228  |ddm|= 1.46
HOMO (B2u) = -0.342768719019988  LUMO (B3u) = -0.0429835717594437
cycle= 2 E= -75.2476350005993  delta_E= -0.0211  |g|= 0.0444  |ddm|= 0.347
HOMO (B2u) = -0.311266865337975  LUMO (B3u) = -0.00695392831511111
cycle= 3 E= -75.2488230162567  delta_E= -0.00119  |g|= 0.0166  |ddm|= 0.0577
HOMO (B2u) = -0.315511002797546  LUMO (B3u) = -0.0109908406189049
cycle= 4 E= -75.24902239302  delta_E= -0.000199  |g|= 0.000637  |ddm|= 0.0332
HOMO (B2u) = -0.31561657306683  LUMO (B3u) = -0.0112327274277412
cycle= 5 E= -75.2490225504907  delta_E= -1.57e-07  |g|= 0.000134  |ddm|= 0.000817
HOMO (B2u) = -0.315582567140402  LUMO (B3u) = -0.0112081163367541
cycle= 6 E= -75.2490225608018  delta_E= -1.03e-08  |g|= 1.98e-05  |ddm|= 0.000228
HOMO (B2u) = -0.315579772310318  LUMO (B3u) = -0.0112081376157161
cycle= 7 E= -75.2490225610551  delta_E= -2.53e-10  |g|= 2e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.315579365287568  LUMO (B3u) = -0.011208199412945
cycle= 8 E= -75.2490225610576  delta_E= -2.5e-12  |g|= 1.29e-07  |ddm|= 4.21e-06
HOMO (B2u) = -0.315579376014567  LUMO (B3u) = -0.0112082026370456
cycle= 9 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 7.39e-09  |ddm|= 3.13e-07
HOMO (B2u) = -0.315579375158317  LUMO (B3u) = -0.0112082041979041
cycle= 10 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 6.69e-09  |ddm|= 6.7e-09
HOMO (B2u) = -0.315579375370415  LUMO (B3u) = -0.0112082045085025
cycle= 11 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 4.7e-09  |ddm|= 5.38e-09
HOMO (B2u) = -0.315579374456195  LUMO (B3u) = -0.0112082035521409
cycle= 12 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 3.99e-09  |ddm|= 2.87e-09
HOMO (B2u) = -0.315579374574262  LUMO (B3u) = -0.0112082036830349
cycle= 13 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 3.56e-09  |ddm|= 1.42e-09
HOMO (B2u) = -0.315579374205035  LUMO (B3u) = -0.0112082035344556
cycle= 14 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 7.09e-10  |ddm|= 6.53e-09
HOMO (B2u) = -0.315579374303713  LUMO (B3u) = -0.0112082035701757
cycle= 15 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 7.46e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.315579374235867  LUMO (B3u) = -0.0112082035595202
cycle= 16 E= -75.2490225610576  delta_E=    0  |g|= 6.58e-10  |ddm|= 8.71e-10
HOMO (B2u) = -0.315579374257515  LUMO (B3u) = -0.0112082035348593
cycle= 17 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 8.09e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.315579374230991  LUMO (B3u) = -0.0112082035234922
cycle= 18 E= -75.2490225610576  delta_E=    0  |g|= 6.15e-10  |ddm|= 4.65e-10
HOMO (B2u) = -0.315579374230803  LUMO (B3u) = -0.0112082035355344
cycle= 19 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 4.69e-10  |ddm|= 4.87e-10
HOMO (B2u) = -0.315579374234715  LUMO (B3u) = -0.0112082035492171
cycle= 20 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 3.69e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.315579374226397  LUMO (B3u) = -0.0112082035490173
cycle= 21 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 2.66e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.315579374219221  LUMO (B3u) = -0.011208203549981
cycle= 22 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 1.68e-10  |ddm|= 2.4e-10
HOMO (B2u) = -0.31557937421742  LUMO (B3u) = -0.0112082035480931
cycle= 23 E= -75.2490225610576  delta_E=    0  |g|= 1.48e-10  |ddm|= 4.96e-11
HOMO (B2u) = -0.315579374212549  LUMO (B3u) = -0.0112082035458863
cycle= 24 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 1.26e-10  |ddm|= 5.57e-11
HOMO (B2u) = -0.315579374210539  LUMO (B3u) = -0.0112082035441965
cycle= 25 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 1.06e-10  |ddm|= 4.69e-11
HOMO (B2u) = -0.31557937420768  LUMO (B3u) = -0.0112082035434034
cycle= 26 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 8.31e-11  |ddm|= 6.17e-11
HOMO (B2u) = -0.315579374205555  LUMO (B3u) = -0.0112082035428148
cycle= 27 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 6.75e-11  |ddm|= 4.77e-11
HOMO (B2u) = -0.315579374203759  LUMO (B3u) = -0.01120820354219
cycle= 28 E= -75.2490225610576  delta_E=    0  |g|= 5.4e-11  |ddm|= 3.55e-11
HOMO (B2u) = -0.315579374199407  LUMO (B3u) = -0.0112082035404631
Extra cycle  E= -75.2490225610575  delta_E= 5.68e-14  |g|= 1.92e-11  |ddm|= 8.23e-11
converged SCF energy = -75.2490225610575

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpkhj8ntcw
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4110790881554  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.429526072552  dE = -0.018446984  S^2 = 0.0000000
               |grad[o]|= 0.11  |ddm|= 3.74  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4419549870795  dE = -0.012428915  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.127  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4482968221584  dE = -0.0063418351  S^2 = 0.0000000
               |grad[o]|=0.0462  |ddm|=0.0237  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4501430171612  dE = -0.001846195  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.104  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4507876396856  dE = -0.00064462252  S^2 = 0.0000000
               |grad[o]|=0.00867  |ddm|=0.0182  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4509297658622  dE = -0.00014212618  S^2 = 0.0000000
               |grad[o]|=0.00428  |ddm|=0.00737  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4509686911438  dE = -3.8925282e-05  S^2 = 0.0000000
               |grad[o]|=0.00227  |ddm|=0.00337  |maxRot[o]|=0.0135
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4509721356548  dE = -3.444511e-06  S^2 = 0.0000000
               |grad[o]|=0.000835  |ddm|=0.00232  |maxRot[o]|=0.00406
macro iter 9 (3 JK  0 micro), CASSCF E = -75.450972441234  dE = -3.0557921e-07  S^2 = 0.0000000
               |grad[o]|=0.000269  |ddm|=0.000751  |maxRot[o]|=0.0012
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4509724682703  dE = -2.7036336e-08  S^2 = 0.0000000
               |grad[o]|=8.26e-05  |ddm|=0.000234  |maxRot[o]|=0.000351
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4509724706799  dE = -2.4095925e-09  S^2 = 0.0000000
               |grad[o]|=2.5e-05  |ddm|=7.12e-05  |maxRot[o]|=0.000104
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4509724708868  dE = -2.0692426e-10  S^2 = 0.0000000
               |grad[o]|=7.49e-06  |ddm|=2.18e-05  |maxRot[o]|=3.08e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4509724709117  dE = -2.4868996e-11  S^2 = 0.0000000
               |grad[o]|=2.29e-06  |ddm|=6.43e-06  |maxRot[o]|=8.97e-06
2-step CASSCF converged in 13 macro (48 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95553917 1.93688266 1.83858342 1.63915689 0.06206762 0.36520863
 0.05501491 0.1475467 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01239   0.01081  -0.00143   0.00000   0.00000
  0 C 2s       0.69827   0.68127  -0.10961  -0.00000   0.00000
  0 C 3s       0.00470   0.01443  -0.02431  -0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000   0.00000   0.69401
  0 C 2py     -0.00000  -0.00000  -0.00000   0.70457   0.00000
  0 C 2pz      0.10978  -0.18822   0.69702  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  0 C 3py     -0.00000   0.00000   0.00000   0.05523   0.00000
  0 C 3pz     -0.00833  -0.00170   0.02237  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02312   0.00000
  0 C 3dz^2    0.01091  -0.00949   0.03179  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000  -0.00000  -0.11663
 0 C 3dx2-y2   0.00204   0.00576  -0.00656   0.00000  -0.00000
  1 C 1s       0.01239  -0.01081  -0.00143   0.00000   0.00000
  1 C 2s       0.69827  -0.68127  -0.10961   0.00000  -0.00000
  1 C 3s       0.00470  -0.01443  -0.02431   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69401
  1 C 2py      0.00000  -0.00000   0.00000   0.70457  -0.00000
  1 C 2pz     -0.10978  -0.18822  -0.69702   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  1 C 3py      0.00000   0.00000   0.00000   0.05523   0.00000
  1 C 3pz      0.00833  -0.00170  -0.02237  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000  -0.02312  -0.00000
  1 C 3dz^2    0.01091   0.00949   0.03179   0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000   0.00000   0.11663
 1 C 3dx2-y2   0.00204  -0.00576  -0.00656   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s      -0.00000   0.00000   0.18769
  0 C 3s       0.00000  -0.00000   0.02542
  0 C 2px      0.00000   0.69895  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.68096
  0 C 3px      0.00000  -0.02298  -0.00000
  0 C 3py      0.00461   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01682
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00772   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00210
  0 C 3dxz     0.00000  -0.10461  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01180
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.18769
  1 C 3s       0.00000   0.00000  -0.02542
  1 C 2px     -0.00000  -0.69895   0.00000
  1 C 2py     -0.70705  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.68096
  1 C 3px     -0.00000   0.02298   0.00000
  1 C 3py     -0.00461  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01682
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00772  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00210
  1 C 3dxz     0.00000  -0.10461  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01180
<CAS-nat-orb|mo-hf>  3  3    0.99630523
<CAS-nat-orb|mo-hf>  4  4    0.99959512
<CAS-nat-orb|mo-hf>  5  5    0.99624282
<CAS-nat-orb|mo-hf>  6  6    0.99840712
<CAS-nat-orb|mo-hf>  7  7    0.93287017
<CAS-nat-orb|mo-hf>  8  8    0.98760133
<CAS-nat-orb|mo-hf>  9  9    0.96104580
<CAS-nat-orb|mo-hf>  10  10    0.96307389
CASSCF energy = -75.4509724709117
CASCI E = -75.4509724709117  E(CI) = -14.7857465824136  S^2 = 0.0000000
Time cost =    345.558
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:57:18 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.116708843680 AA    0.000000000000   0.000000000000   4.000000000000 Bohr   0.0

nuclear repulsion = 9
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 2.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     20905.57


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpxmlows6i
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.65829474285

WARN: Singularity detected in overlap matrix (condition number = 55.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0893486438705836  LUMO (B3u) = -0.0893486438705835

WARN: B2u HOMO -0.0893486438705836 > system LUMO -0.0893486438705835

cycle= 1 E= -75.2192687068769  delta_E= -0.561  |g|= 0.226  |ddm|= 1.45
HOMO (B2u) = -0.339798299416295  LUMO (B3u) = -0.0412658624563717
cycle= 2 E= -75.240154283596  delta_E= -0.0209  |g|= 0.0439  |ddm|= 0.347
HOMO (B2u) = -0.308660706394016  LUMO (B3u) = -0.00561531074292506
cycle= 3 E= -75.2413180659383  delta_E= -0.00116  |g|= 0.0164  |ddm|= 0.0569
HOMO (B2u) = -0.312871203858108  LUMO (B3u) = -0.00961084060265049
cycle= 4 E= -75.2415141140049  delta_E= -0.000196  |g|= 0.000633  |ddm|= 0.0328
HOMO (B2u) = -0.312958040513246  LUMO (B3u) = -0.00983140550670118
cycle= 5 E= -75.2415142702404  delta_E= -1.56e-07  |g|= 0.000135  |ddm|= 0.00081
HOMO (B2u) = -0.312924808517804  LUMO (B3u) = -0.00980779398985976
cycle= 6 E= -75.2415142806734  delta_E= -1.04e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.31292200071528  LUMO (B3u) = -0.00980776379454773
cycle= 7 E= -75.2415142809299  delta_E= -2.56e-10  |g|= 2.02e-06  |ddm|= 4.04e-05
HOMO (B2u) = -0.31292160462226  LUMO (B3u) = -0.0098078435741971
cycle= 8 E= -75.2415142809324  delta_E= -2.53e-12  |g|= 1.28e-07  |ddm|= 4.27e-06
HOMO (B2u) = -0.312921617365531  LUMO (B3u) = -0.00980784817126035
cycle= 9 E= -75.2415142809325  delta_E= -5.68e-14  |g|= 6.97e-09  |ddm|= 3.09e-07
HOMO (B2u) = -0.312921616457301  LUMO (B3u) = -0.00980784977061664
cycle= 10 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 6.48e-09  |ddm|= 6.78e-09
HOMO (B2u) = -0.312921616767765  LUMO (B3u) = -0.00980785018162444
cycle= 11 E= -75.2415142809324  delta_E=    0  |g|= 4.52e-09  |ddm|= 5.13e-09
HOMO (B2u) = -0.312921615945198  LUMO (B3u) = -0.00980784931543737
cycle= 12 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 3.83e-09  |ddm|= 2.76e-09
HOMO (B2u) = -0.312921616048579  LUMO (B3u) = -0.00980784942796063
cycle= 13 E= -75.2415142809324  delta_E= 4.26e-14  |g|= 3.44e-09  |ddm|= 1.28e-09
HOMO (B2u) = -0.312921615711762  LUMO (B3u) = -0.00980784930682306
cycle= 14 E= -75.2415142809325  delta_E= -7.11e-14  |g|= 6.03e-10  |ddm|= 6.18e-09
HOMO (B2u) = -0.312921615819737  LUMO (B3u) = -0.00980784934698471
cycle= 15 E= -75.2415142809324  delta_E= 5.68e-14  |g|= 6.91e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615748214  LUMO (B3u) = -0.00980784933453178
cycle= 16 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 5.81e-10  |ddm|= 9.48e-10
HOMO (B2u) = -0.312921615768285  LUMO (B3u) = -0.00980784930664828
cycle= 17 E= -75.2415142809325  delta_E=    0  |g|= 7.32e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615745695  LUMO (B3u) = -0.00980784929792325
cycle= 18 E= -75.2415142809325  delta_E=    0  |g|= 5.57e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.312921615748269  LUMO (B3u) = -0.00980784931167001
cycle= 19 E= -75.2415142809325  delta_E=    0  |g|= 4.24e-10  |ddm|= 4.39e-10
HOMO (B2u) = -0.312921615754739  LUMO (B3u) = -0.00980784932703772
cycle= 20 E= -75.2415142809325  delta_E=    0  |g|= 3.34e-10  |ddm|= 2.91e-10
HOMO (B2u) = -0.312921615749239  LUMO (B3u) = -0.009807849329118
cycle= 21 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 2.39e-10  |ddm|= 2.3e-10
HOMO (B2u) = -0.312921615744366  LUMO (B3u) = -0.00980784933188064
cycle= 22 E= -75.2415142809324  delta_E= 1.14e-13  |g|= 1.48e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.31292161574318  LUMO (B3u) = -0.00980784933026232
cycle= 23 E= -75.2415142809325  delta_E= -1.28e-13  |g|= 1.31e-10  |ddm|= 3.98e-11
HOMO (B2u) = -0.312921615738653  LUMO (B3u) = -0.00980784932824845
cycle= 24 E= -75.2415142809325  delta_E= -1.42e-14  |g|= 1.11e-10  |ddm|= 5.14e-11
HOMO (B2u) = -0.31292161573719  LUMO (B3u) = -0.00980784932685723
cycle= 25 E= -75.2415142809324  delta_E= 1.14e-13  |g|= 9.33e-11  |ddm|= 3.98e-11
HOMO (B2u) = -0.312921615735015  LUMO (B3u) = -0.00980784932655441
cycle= 26 E= -75.2415142809325  delta_E= -4.26e-14  |g|= 7.37e-11  |ddm|= 5.04e-11
HOMO (B2u) = -0.312921615733423  LUMO (B3u) = -0.00980784932634494
cycle= 27 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 6.07e-11  |ddm|= 3.92e-11
HOMO (B2u) = -0.312921615732017  LUMO (B3u) = -0.00980784932598872
cycle= 28 E= -75.2415142809325  delta_E= -5.68e-14  |g|= 4.9e-11  |ddm|= 2.9e-11
HOMO (B2u) = -0.312921615730895  LUMO (B3u) = -0.0098078493256685
cycle= 29 E= -75.2415142809325  delta_E= -4.26e-14  |g|= 3.83e-11  |ddm|= 2.31e-11
HOMO (B2u) = -0.312921615730032  LUMO (B3u) = -0.00980784932536277
cycle= 30 E= -75.2415142809325  delta_E= 5.68e-14  |g|= 3.03e-11  |ddm|= 1.69e-11
HOMO (B2u) = -0.312921615729483  LUMO (B3u) = -0.00980784932512105
cycle= 31 E= -75.2415142809325  delta_E=    0  |g|= 2.52e-11  |ddm|= 1.06e-11
HOMO (B2u) = -0.312921615727636  LUMO (B3u) = -0.00980784932443782
Extra cycle  E= -75.2415142809325  delta_E=    0  |g|= 9.38e-12  |ddm|= 3.39e-11
converged SCF energy = -75.2415142809325

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpxmlows6i
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4079772031596  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4269928701511  dE = -0.019015667  S^2 = 0.0000000
               |grad[o]|=0.112  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4392401163887  dE = -0.012247246  S^2 = 0.0000000
               |grad[o]|=0.0794  |ddm|=0.133  |maxRot[o]|=0.079
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4451921759373  dE = -0.0059520595  S^2 = 0.0000000
               |grad[o]|=0.0445  |ddm|=0.0301  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4468428193113  dE = -0.0016506434  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.0981  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4473888812606  dE = -0.00054606195  S^2 = 0.0000000
               |grad[o]|=0.0077  |ddm|=0.0155  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.44749231508  dE = -0.00010343382  S^2 = 0.0000000
               |grad[o]|=0.00362  |ddm|=0.00704  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4475072129747  dE = -1.4897895e-05  S^2 = 0.0000000
               |grad[o]|=0.00159  |ddm|=0.00339  |maxRot[o]|=0.00836
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4475085952738  dE = -1.3822991e-06  S^2 = 0.0000000
               |grad[o]|=0.000559  |ddm|=0.00151  |maxRot[o]|=0.00253
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4475087228391  dE = -1.2756534e-07  S^2 = 0.0000000
               |grad[o]|=0.000179  |ddm|=0.000495  |maxRot[o]|=0.000757
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4475087345609  dE = -1.1721738e-08  S^2 = 0.0000000
               |grad[o]|=5.56e-05  |ddm|=0.000156  |maxRot[o]|=0.000227
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4475087356465  dE = -1.0856098e-09  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=4.8e-05  |maxRot[o]|=6.85e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4475087357395  dE = -9.2995833e-11  S^2 = 0.0000000
               |grad[o]|=5.27e-06  |ddm|=1.47e-05  |maxRot[o]|=2.04e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95539885 1.93749708 1.8292365  1.61997882 0.06124694 0.38415954
 0.05468074 0.15780153]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01243   0.01086  -0.00123   0.00000   0.00000
  0 C 2s       0.69987   0.68306  -0.09890  -0.00000   0.00000
  0 C 3s       0.00559   0.01429  -0.02264   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.69417
  0 C 2py      0.00000  -0.00000  -0.00000   0.70461   0.00000
  0 C 2pz      0.09912  -0.18163   0.69866   0.00000   0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.06942
  0 C 3py      0.00000  -0.00000  -0.00000   0.05510   0.00000
  0 C 3pz     -0.00787  -0.00173   0.02398   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02202   0.00000
  0 C 3dz^2    0.00990  -0.00917   0.03103   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.11537
 0 C 3dx2-y2   0.00220   0.00568  -0.00646   0.00000   0.00000
  1 C 1s       0.01243  -0.01086  -0.00123   0.00000   0.00000
  1 C 2s       0.69987  -0.68306  -0.09890  -0.00000   0.00000
  1 C 3s       0.00559  -0.01429  -0.02264  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000  -0.00000  -0.00000   0.69417
  1 C 2py     -0.00000   0.00000   0.00000   0.70461  -0.00000
  1 C 2pz     -0.09912  -0.18163  -0.69866   0.00000   0.00000
  1 C 3px      0.00000   0.00000  -0.00000  -0.00000  -0.06942
  1 C 3py     -0.00000   0.00000   0.00000   0.05510  -0.00000
  1 C 3pz      0.00787  -0.00173  -0.02398   0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02202  -0.00000
  1 C 3dz^2    0.00990   0.00917   0.03103  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000   0.11537
 1 C 3dx2-y2   0.00220  -0.00568  -0.00646  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00018
  0 C 2s      -0.00000  -0.00000   0.18114
  0 C 3s      -0.00000   0.00000   0.02444
  0 C 2px      0.00000   0.69909   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.68284
  0 C 3px     -0.00000  -0.02448   0.00000
  0 C 3py      0.00635  -0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.01417
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00736   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00169
  0 C 3dxz    -0.00000  -0.10334   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01092
  1 C 1s       0.00000   0.00000   0.00018
  1 C 2s       0.00000  -0.00000  -0.18114
  1 C 3s       0.00000  -0.00000  -0.02444
  1 C 2px      0.00000  -0.69909  -0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.68284
  1 C 3px     -0.00000   0.02448  -0.00000
  1 C 3py     -0.00635  -0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01417
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00736   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00169
  1 C 3dxz     0.00000  -0.10334   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01092
<CAS-nat-orb|mo-hf>  3  3    0.99576781
<CAS-nat-orb|mo-hf>  4  4    0.99957524
<CAS-nat-orb|mo-hf>  5  5    0.99568632
<CAS-nat-orb|mo-hf>  6  6    0.99833014
<CAS-nat-orb|mo-hf>  7  7    0.93288519
<CAS-nat-orb|mo-hf>  8  8    0.98831105
<CAS-nat-orb|mo-hf>  9  9    0.96112500
<CAS-nat-orb|mo-hf>  10  10    0.96605593
CASSCF energy = -75.4475087357395
CASCI E = -75.4475087357395  E(CI) = -14.7317045576554  S^2 = 0.0000000
Time cost =    278.099
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:01:56 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.143167704226 AA    0.000000000000   0.000000000000   4.050000000000 Bohr   0.0

nuclear repulsion = 8.88888888888889
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     21539.89


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpix136n1u
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.650821541947

WARN: Singularity detected in overlap matrix (condition number = 52.1). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0872509906487013  LUMO (B3u) = -0.0872509906487014

WARN: B2u HOMO -0.0872509906487013 > system LUMO -0.0872509906487014

cycle= 1 E= -75.2120928138537  delta_E= -0.561  |g|= 0.225  |ddm|= 1.45
HOMO (B2u) = -0.336938998033695  LUMO (B3u) = -0.0396234294723665
cycle= 2 E= -75.2327826177341  delta_E= -0.0207  |g|= 0.0434  |ddm|= 0.347
HOMO (B2u) = -0.306147078592025  LUMO (B3u) = -0.00433141905845596
cycle= 3 E= -75.2339223949765  delta_E= -0.00114  |g|= 0.0162  |ddm|= 0.0561
HOMO (B2u) = -0.310321597199802  LUMO (B3u) = -0.00828279864970776
cycle= 4 E= -75.2341150976661  delta_E= -0.000193  |g|= 0.000629  |ddm|= 0.0325
HOMO (B2u) = -0.310388518956864  LUMO (B3u) = -0.00848075571953598
cycle= 5 E= -75.2341152524229  delta_E= -1.55e-07  |g|= 0.000135  |ddm|= 0.000802
HOMO (B2u) = -0.310356121170237  LUMO (B3u) = -0.00845811286980673
cycle= 6 E= -75.2341152629183  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.31035330246065  LUMO (B3u) = -0.00845802697819696
cycle= 7 E= -75.2341152631768  delta_E= -2.59e-10  |g|= 2.04e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.310352915622179  LUMO (B3u) = -0.00845812345203891
cycle= 8 E= -75.2341152631794  delta_E= -2.6e-12  |g|= 1.28e-07  |ddm|= 4.34e-06
HOMO (B2u) = -0.31035293053634  LUMO (B3u) = -0.0084581295366692
cycle= 9 E= -75.2341152631795  delta_E= -7.11e-14  |g|= 6.65e-09  |ddm|= 3.04e-07
HOMO (B2u) = -0.310352929581623  LUMO (B3u) = -0.00845813119704574
cycle= 10 E= -75.2341152631795  delta_E= 5.68e-14  |g|= 6.3e-09  |ddm|= 7.03e-09
HOMO (B2u) = -0.310352929988231  LUMO (B3u) = -0.00845813169560546
cycle= 11 E= -75.2341152631795  delta_E=    0  |g|= 4.39e-09  |ddm|= 4.7e-09
HOMO (B2u) = -0.310352929258077  LUMO (B3u) = -0.00845813092350679
cycle= 12 E= -75.2341152631795  delta_E= -5.68e-14  |g|= 3.72e-09  |ddm|= 2.69e-09
HOMO (B2u) = -0.310352929350422  LUMO (B3u) = -0.00845813101898559
cycle= 13 E= -75.2341152631795  delta_E= 2.84e-14  |g|= 3.35e-09  |ddm|= 1.1e-09
HOMO (B2u) = -0.310352929050709  LUMO (B3u) = -0.00845813092930931
cycle= 14 E= -75.2341152631794  delta_E= 5.68e-14  |g|= 5.26e-10  |ddm|= 5.83e-09
HOMO (B2u) = -0.310352929162649  LUMO (B3u) = -0.00845813096843402
cycle= 15 E= -75.2341152631795  delta_E= -2.84e-14  |g|= 6.38e-10  |ddm|= 1.08e-09
HOMO (B2u) = -0.310352929091136  LUMO (B3u) = -0.00845813096091695
cycle= 16 E= -75.2341152631795  delta_E= -5.68e-14  |g|= 5.34e-10  |ddm|= 8.95e-10
HOMO (B2u) = -0.310352929110658  LUMO (B3u) = -0.00845813092685597
cycle= 17 E= -75.2341152631795  delta_E= 5.68e-14  |g|= 6.72e-10  |ddm|= 1.33e-09
HOMO (B2u) = -0.310352929092129  LUMO (B3u) = -0.00845813092060069
cycle= 18 E= -75.2341152631795  delta_E= -1.42e-14  |g|= 5.12e-10  |ddm|= 3e-10
HOMO (B2u) = -0.310352929097954  LUMO (B3u) = -0.00845813093616916
cycle= 19 E= -75.2341152631795  delta_E= 1.42e-14  |g|= 3.89e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.310352929107132  LUMO (B3u) = -0.00845813095331739
cycle= 20 E= -75.2341152631795  delta_E=    0  |g|= 3.09e-10  |ddm|= 2.49e-10
HOMO (B2u) = -0.310352929104635  LUMO (B3u) = -0.0084581309576913
cycle= 21 E= -75.2341152631794  delta_E= 2.84e-14  |g|= 2.19e-10  |ddm|= 1.93e-10
HOMO (B2u) = -0.310352929102233  LUMO (B3u) = -0.008458130962334
cycle= 22 E= -75.2341152631795  delta_E= -2.84e-14  |g|= 1.34e-10  |ddm|= 1.79e-10
HOMO (B2u) = -0.310352929101648  LUMO (B3u) = -0.00845813096090168
cycle= 23 E= -75.2341152631795  delta_E=    0  |g|= 1.19e-10  |ddm|= 3.44e-11
HOMO (B2u) = -0.310352929097727  LUMO (B3u) = -0.00845813095923518
cycle= 24 E= -75.2341152631794  delta_E= 2.84e-14  |g|= 9.99e-11  |ddm|= 4.72e-11
HOMO (B2u) = -0.310352929096907  LUMO (B3u) = -0.00845813095804712
cycle= 25 E= -75.2341152631794  delta_E= 2.84e-14  |g|= 8.43e-11  |ddm|= 3.79e-11
HOMO (B2u) = -0.310352929095488  LUMO (B3u) = -0.00845813095825834
cycle= 26 E= -75.2341152631795  delta_E= -7.11e-14  |g|= 6.71e-11  |ddm|= 3.85e-11
HOMO (B2u) = -0.310352929094484  LUMO (B3u) = -0.00845813095844369
cycle= 27 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 5.61e-11  |ddm|= 3.02e-11
HOMO (B2u) = -0.310352929093508  LUMO (B3u) = -0.00845813095836942
cycle= 28 E= -75.2341152631794  delta_E= -4.26e-14  |g|= 4.57e-11  |ddm|= 2.24e-11
HOMO (B2u) = -0.310352929092706  LUMO (B3u) = -0.00845813095825024
cycle= 29 E= -75.2341152631795  delta_E= -4.26e-14  |g|= 3.59e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.310352929092082  LUMO (B3u) = -0.00845813095808864
cycle= 30 E= -75.2341152631794  delta_E= 8.53e-14  |g|= 2.84e-11  |ddm|= 1.4e-11
HOMO (B2u) = -0.310352929091694  LUMO (B3u) = -0.00845813095793391
cycle= 31 E= -75.2341152631794  delta_E= -2.84e-14  |g|= 2.37e-11  |ddm|= 8.93e-12
HOMO (B2u) = -0.310352929091288  LUMO (B3u) = -0.0084581309578024
cycle= 32 E= -75.2341152631794  delta_E=    0  |g|= 1.95e-11  |ddm|= 7.95e-12
HOMO (B2u) = -0.310352929090202  LUMO (B3u) = -0.00845813095748049
Extra cycle  E= -75.2341152631794  delta_E= 5.68e-14  |g|= 7.46e-12  |ddm|= 2.29e-11
converged SCF energy = -75.2341152631794

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpix136n1u
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4050131046159  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4242837882276  dE = -0.019270684  S^2 = 0.0000000
               |grad[o]|=0.114  |ddm|= 3.72  |maxRot[o]|=0.0784
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4363857272441  dE = -0.012101939  S^2 = 0.0000000
               |grad[o]|=0.0799  |ddm|=0.135  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4421036047237  dE = -0.0057178775  S^2 = 0.0000000
               |grad[o]|=0.0439  |ddm|=0.0337  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4436293619235  dE = -0.0015257572  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.0939  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4441199084116  dE = -0.00049054649  S^2 = 0.0000000
               |grad[o]|=0.00716  |ddm|=0.0142  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4441997253274  dE = -7.9816916e-05  S^2 = 0.0000000
               |grad[o]|=0.00326  |ddm|=0.00696  |maxRot[o]|=0.019
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4442076744564  dE = -7.949129e-06  S^2 = 0.0000000
               |grad[o]|=0.00128  |ddm|=0.0033  |maxRot[o]|=0.00603
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4442084507924  dE = -7.7633592e-07  S^2 = 0.0000000
               |grad[o]|=0.000435  |ddm|=0.00116  |maxRot[o]|=0.00186
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4442085256887  dE = -7.4896306e-08  S^2 = 0.0000000
               |grad[o]|=0.00014  |ddm|=0.000383  |maxRot[o]|=0.000569
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4442085328941  dE = -7.2054149e-09  S^2 = 0.0000000
               |grad[o]|=4.42e-05  |ddm|=0.000122  |maxRot[o]|=0.000175
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4442085335819  dE = -6.87848e-10  S^2 = 0.0000000
               |grad[o]|=1.38e-05  |ddm|=3.84e-05  |maxRot[o]|=5.39e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4442085336481  dE = -6.6137318e-11  S^2 = 0.0000000
               |grad[o]|=4.29e-06  |ddm|=1.2e-05  |maxRot[o]|=1.66e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95530405 1.93811148 1.81911524 1.60013605 0.06045908 0.40376984
 0.05434302 0.16876124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01246   0.01091  -0.00105   0.00000   0.00000
  0 C 2s       0.70117   0.68475  -0.08932   0.00000   0.00000
  0 C 3s       0.00639   0.01416  -0.02106   0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69435
  0 C 2py      0.00000   0.00000  -0.00000   0.70466  -0.00000
  0 C 2pz      0.08959  -0.17518   0.69998   0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06986
  0 C 3py     -0.00000   0.00000   0.00000   0.05490   0.00000
  0 C 3pz     -0.00744  -0.00175   0.02554   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.02095   0.00000
  0 C 3dz^2    0.00897  -0.00886   0.03021   0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11401
 0 C 3dx2-y2   0.00234   0.00560  -0.00636   0.00000   0.00000
  1 C 1s       0.01246  -0.01091  -0.00105   0.00000   0.00000
  1 C 2s       0.70117  -0.68475  -0.08932   0.00000   0.00000
  1 C 3s       0.00639  -0.01416  -0.02106  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70466  -0.00000
  1 C 2pz     -0.08959  -0.17518  -0.69998   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000   0.00000  -0.06986
  1 C 3py      0.00000  -0.00000   0.00000   0.05490  -0.00000
  1 C 3pz      0.00744  -0.00175  -0.02554   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02095   0.00000
  1 C 3dz^2    0.00897   0.00886   0.03021  -0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11401
 1 C 3dx2-y2   0.00234  -0.00560  -0.00636  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00016
  0 C 2s       0.00000   0.00000   0.17473
  0 C 3s       0.00000   0.00000   0.02347
  0 C 2px     -0.00000   0.69923   0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68460
  0 C 3px     -0.00000  -0.02593  -0.00000
  0 C 3py      0.00804  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.01155
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00702  -0.00000  -0.00000
  0 C 3dz^2    0.00000   0.00000   0.00132
  0 C 3dxz    -0.00000  -0.10203   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01008
  1 C 1s       0.00000   0.00000   0.00016
  1 C 2s      -0.00000  -0.00000  -0.17473
  1 C 3s      -0.00000  -0.00000  -0.02347
  1 C 2px      0.00000  -0.69923   0.00000
  1 C 2py     -0.70703   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68460
  1 C 3px      0.00000   0.02593  -0.00000
  1 C 3py     -0.00804   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.01155
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00702   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00132
  1 C 3dxz    -0.00000  -0.10203   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01008
<CAS-nat-orb|mo-hf>  3  3    0.99532683
<CAS-nat-orb|mo-hf>  4  4    0.99955353
<CAS-nat-orb|mo-hf>  5  5    0.99522359
<CAS-nat-orb|mo-hf>  6  6    0.99825105
<CAS-nat-orb|mo-hf>  7  7    0.93296321
<CAS-nat-orb|mo-hf>  8  8    0.98897441
<CAS-nat-orb|mo-hf>  9  9    0.96119969
<CAS-nat-orb|mo-hf>  10  10    0.96876542
CASSCF energy = -75.4442085336481
CASCI E = -75.4442085336481  E(CI) = -14.6790716900883  S^2 = 0.0000000
Time cost =    194.247
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:05:11 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.169626564772 AA    0.000000000000   0.000000000000   4.100000000000 Bohr   0.0

nuclear repulsion = 8.78048780487805
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   2.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     22040.45


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpsdjbmzsu
max_memory 4000 MB (current use 175 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.643876015773

WARN: Singularity detected in overlap matrix (condition number = 49.2). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0852438140031949  LUMO (B3u) = -0.0852438140031952

WARN: B2u HOMO -0.0852438140031949 > system LUMO -0.0852438140031952

cycle= 1 E= -75.2050111450144  delta_E= -0.561  |g|= 0.224  |ddm|= 1.45
HOMO (B2u) = -0.334187231388073  LUMO (B3g) = -0.039845458884104
cycle= 2 E= -75.2255220782413  delta_E= -0.0205  |g|= 0.043  |ddm|= 0.347
HOMO (B2u) = -0.303722561565156  LUMO (B3g) = -0.00486882385407066
cycle= 3 E= -75.2266381654048  delta_E= -0.00112  |g|= 0.0161  |ddm|= 0.0554
HOMO (B2u) = -0.307858619678188  LUMO (B3g) = -0.00776666805283005
cycle= 4 E= -75.226827530681  delta_E= -0.000189  |g|= 0.000623  |ddm|= 0.0321
HOMO (B2u) = -0.307904877132324  LUMO (B3g) = -0.00791200473592966
cycle= 5 E= -75.2268276836983  delta_E= -1.53e-07  |g|= 0.000135  |ddm|= 0.000792
HOMO (B2u) = -0.307873376598218  LUMO (B3g) = -0.00787181864145039
cycle= 6 E= -75.2268276941976  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000228
HOMO (B2u) = -0.307870547891897  LUMO (B3g) = -0.0078692407619936
cycle= 7 E= -75.2268276944567  delta_E= -2.59e-10  |g|= 2.07e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.307870168621815  LUMO (B3g) = -0.00786899944460012
cycle= 8 E= -75.2268276944594  delta_E= -2.7e-12  |g|= 1.28e-07  |ddm|= 4.42e-06
HOMO (B2u) = -0.307870185809012  LUMO (B3g) = -0.0078690039010834
cycle= 9 E= -75.2268276944595  delta_E= -8.53e-14  |g|= 6.56e-09  |ddm|= 2.97e-07
HOMO (B2u) = -0.307870184795795  LUMO (B3g) = -0.00786900501441333
cycle= 10 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 6.26e-09  |ddm|= 7.51e-09
HOMO (B2u) = -0.307870185324593  LUMO (B3g) = -0.00786900549157314
cycle= 11 E= -75.2268276944594  delta_E= 5.68e-14  |g|= 4.35e-09  |ddm|= 4.41e-09
HOMO (B2u) = -0.307870184673277  LUMO (B3g) = -0.0078690046894027
cycle= 12 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 3.7e-09  |ddm|= 2.57e-09
HOMO (B2u) = -0.307870184756441  LUMO (B3g) = -0.00786900477074907
cycle= 13 E= -75.2268276944595  delta_E= 1.42e-14  |g|= 3.33e-09  |ddm|= 9.6e-10
HOMO (B2u) = -0.307870184502871  LUMO (B3g) = -0.00786900460316283
cycle= 14 E= -75.2268276944595  delta_E= -4.26e-14  |g|= 5.16e-10  |ddm|= 5.31e-09
HOMO (B2u) = -0.30787018461638  LUMO (B3g) = -0.00786900470666483
cycle= 15 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 6.33e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.307870184546939  LUMO (B3g) = -0.00786900464580995
cycle= 16 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 5.24e-10  |ddm|= 9.77e-10
HOMO (B2u) = -0.307870184560403  LUMO (B3g) = -0.00786900465955473
cycle= 17 E= -75.2268276944594  delta_E= 5.68e-14  |g|= 6.56e-10  |ddm|= 1.07e-09
HOMO (B2u) = -0.307870184545893  LUMO (B3g) = -0.00786900465078755
cycle= 18 E= -75.2268276944595  delta_E= -7.11e-14  |g|= 5.01e-10  |ddm|= 2.42e-10
HOMO (B2u) = -0.307870184554918  LUMO (B3g) = -0.00786900465773282
cycle= 19 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 3.82e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.307870184567141  LUMO (B3g) = -0.00786900467017151
cycle= 20 E= -75.2268276944595  delta_E= -1.42e-14  |g|= 3.04e-10  |ddm|= 2.09e-10
HOMO (B2u) = -0.307870184567735  LUMO (B3g) = -0.00786900467422277
cycle= 21 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 2.16e-10  |ddm|= 1.62e-10
HOMO (B2u) = -0.307870184567908  LUMO (B3g) = -0.00786900467899972
cycle= 22 E= -75.2268276944594  delta_E= 4.26e-14  |g|= 1.31e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.307870184567882  LUMO (B3g) = -0.00786900467984313
cycle= 23 E= -75.2268276944595  delta_E= -8.53e-14  |g|= 1.16e-10  |ddm|= 3.46e-11
HOMO (B2u) = -0.307870184564441  LUMO (B3g) = -0.00786900467793157
cycle= 24 E= -75.2268276944595  delta_E=    0  |g|= 9.8e-11  |ddm|= 4.85e-11
HOMO (B2u) = -0.307870184561673  LUMO (B3g) = -0.00786900467867727
Extra cycle  E= -75.2268276944594  delta_E= 5.68e-14  |g|= 3.38e-11  |ddm|= 1.04e-10
converged SCF energy = -75.2268276944594

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpsdjbmzsu
max_memory 4000 MB (current use 168 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.40218965556  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4214649606417  dE = -0.019275305  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4334658808327  dE = -0.01200092  S^2 = 0.0000000
               |grad[o]|=0.0809  |ddm|=0.135  |maxRot[o]|=0.0799
macro iter 3 (5 JK  0 micro), CASSCF E = -75.4382739601393  dE = -0.0048080793  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.0331  |maxRot[o]|= 0.06
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4401616771862  dE = -0.001887717  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.0842  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4408726065394  dE = -0.00071092935  S^2 = 0.0000000
               |grad[o]|=0.00949  |ddm|=0.0179  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4410249536785  dE = -0.00015234714  S^2 = 0.0000000
               |grad[o]|=0.0045  |ddm|=0.00833  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4410686424733  dE = -4.3688795e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.00376  |maxRot[o]|=0.0138
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4410730802275  dE = -4.4377542e-06  S^2 = 0.0000000
               |grad[o]|=0.000978  |ddm|=0.00262  |maxRot[o]|=0.00444
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4410735333521  dE = -4.531246e-07  S^2 = 0.0000000
               |grad[o]|=0.000336  |ddm|=0.000902  |maxRot[o]|=0.00139
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4410735792915  dE = -4.5939458e-08  S^2 = 0.0000000
               |grad[o]|=0.00011  |ddm|=0.0003  |maxRot[o]|=0.000438
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4410735839378  dE = -4.6462105e-09  S^2 = 0.0000000
               |grad[o]|=3.55e-05  |ddm|=9.77e-05  |maxRot[o]|=0.000139
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4410735844027  dE = -4.6499338e-10  S^2 = 0.0000000
               |grad[o]|=1.14e-05  |ddm|=3.12e-05  |maxRot[o]|=4.36e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4410735844491  dE = -4.6327386e-11  S^2 = 0.0000000
               |grad[o]|=3.63e-06  |ddm|=1e-05  |maxRot[o]|=1.38e-05
2-step CASSCF converged in 13 macro (47 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95524813 1.93872441 1.80820228 1.57967996 0.42398994 0.05970186
 0.05400188 0.18045154]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01248   0.01096  -0.00089   0.00000   0.00000
  0 C 2s       0.70221   0.68634  -0.08081   0.00000   0.00000
  0 C 3s       0.00710   0.01405  -0.01955  -0.00000   0.00000
  0 C 2px      0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 2py      0.00000  -0.00000   0.00000   0.70471   0.70701
  0 C 2pz      0.08112  -0.16887   0.70104   0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3py      0.00000  -0.00000   0.00000   0.05462   0.00967
  0 C 3pz     -0.00705  -0.00178   0.02705  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.01990   0.00668
  0 C 3dz^2    0.00810  -0.00856   0.02935  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.00000
 0 C 3dx2-y2   0.00247   0.00552  -0.00626   0.00000  -0.00000
  1 C 1s       0.01248  -0.01096  -0.00089   0.00000   0.00000
  1 C 2s       0.70221  -0.68634  -0.08081   0.00000   0.00000
  1 C 3s       0.00710  -0.01405  -0.01955  -0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 2py     -0.00000   0.00000  -0.00000   0.70471  -0.70701
  1 C 2pz     -0.08112  -0.16887  -0.70104   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3py     -0.00000   0.00000  -0.00000   0.05462  -0.00967
  1 C 3pz      0.00705  -0.00178  -0.02705   0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.01990   0.00668
  1 C 3dz^2    0.00810   0.00856   0.02935  -0.00000  -0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
 1 C 3dx2-y2   0.00247  -0.00552  -0.00626  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00015
  0 C 2s       0.00000   0.00000   0.16846
  0 C 3s       0.00000  -0.00000   0.02250
  0 C 2px      0.69455   0.69937   0.00000
  0 C 2py     -0.00000  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68626
  0 C 3px     -0.07025  -0.02735   0.00000
  0 C 3py     -0.00000   0.00000   0.00000
  0 C 3pz      0.00000  -0.00000  -0.00897
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00098
  0 C 3dxz    -0.11253  -0.10066   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00927
  1 C 1s       0.00000   0.00000   0.00015
  1 C 2s      -0.00000   0.00000  -0.16846
  1 C 3s      -0.00000  -0.00000  -0.02250
  1 C 2px      0.69455  -0.69937  -0.00000
  1 C 2py     -0.00000  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.68626
  1 C 3px     -0.07025   0.02735  -0.00000
  1 C 3py     -0.00000   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.00897
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00098
  1 C 3dxz     0.11253  -0.10066   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00927
<CAS-nat-orb|mo-hf>  3  3    0.99498963
<CAS-nat-orb|mo-hf>  4  4    0.99952982
<CAS-nat-orb|mo-hf>  5  5    0.99486173
<CAS-nat-orb|mo-hf>  6  6    0.99817000
<CAS-nat-orb|mo-hf>  7  7    0.98959359
<CAS-nat-orb|mo-hf>  8  8    0.93310195
<CAS-nat-orb|mo-hf>  9  9    0.96127102
<CAS-nat-orb|mo-hf>  10  10    0.97122875
CASSCF energy = -75.4410735844491
CASCI E = -75.4410735844491  E(CI) = -14.6278043064803  S^2 = 0.0000000
Time cost =    182.991
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-35.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:08:14 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.196085425318 AA    0.000000000000   0.000000000000   4.150000000000 Bohr   0.0

nuclear repulsion = 8.67469879518072
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     22210.45


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-dmrgscf/tmpyt25otpi
max_memory 4000 MB (current use 173 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6374240354882

WARN: Singularity detected in overlap matrix (condition number = 46.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0833226379096661  LUMO (B3u) = -0.0833226379096663

WARN: B2u HOMO -0.0833226379096661 > system LUMO -0.0833226379096663

cycle= 1 E= -75.1980259935244  delta_E= -0.561  |g|= 0.223  |ddm|= 1.45
HOMO (B2u) = -0.331539393004467  LUMO (B3g) = -0.0424794268999043
cycle= 2 E= -75.2183742970649  delta_E= -0.0203  |g|= 0.0426  |ddm|= 0.347
HOMO (B2u) = -0.301383734536958  LUMO (B3g) = -0.00782777517474422
cycle= 3 E= -75.2194670845425  delta_E= -0.00109  |g|= 0.0159  |ddm|= 0.0547
HOMO (B2u) = -0.305478746489497  LUMO (B3g) = -0.0107333088759263
cycle= 4 E= -75.2196531399389  delta_E= -0.000186  |g|= 0.000618  |ddm|= 0.0318
HOMO (B2u) = -0.305504012954428  LUMO (B3g) = -0.0108540193385382
cycle= 5 E= -75.2196532909579  delta_E= -1.51e-07  |g|= 0.000135  |ddm|= 0.000782
HOMO (B2u) = -0.305473477058597  LUMO (B3g) = -0.0108148524604071
cycle= 6 E= -75.2196533014041  delta_E= -1.04e-08  |g|= 1.98e-05  |ddm|= 0.000227
HOMO (B2u) = -0.30547063828728  LUMO (B3g) = -0.0108121741027694
cycle= 7 E= -75.2196533016626  delta_E= -2.58e-10  |g|= 2.1e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.305470264892489  LUMO (B3g) = -0.0108119322510769
cycle= 8 E= -75.2196533016653  delta_E= -2.73e-12  |g|= 1.29e-07  |ddm|= 4.5e-06
HOMO (B2u) = -0.305470284406483  LUMO (B3g) = -0.010811938162689
cycle= 9 E= -75.2196533016653  delta_E= -5.68e-14  |g|= 6.74e-09  |ddm|= 2.91e-07
HOMO (B2u) = -0.305470283327181  LUMO (B3g) = -0.0108119393051267
cycle= 10 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 6.37e-09  |ddm|= 8.17e-09
HOMO (B2u) = -0.305470283985965  LUMO (B3g) = -0.0108119399154141
cycle= 11 E= -75.2196533016654  delta_E= -4.26e-14  |g|= 4.44e-09  |ddm|= 4.14e-09
HOMO (B2u) = -0.305470283403764  LUMO (B3g) = -0.0108119391826639
cycle= 12 E= -75.2196533016653  delta_E= 5.68e-14  |g|= 3.79e-09  |ddm|= 2.46e-09
HOMO (B2u) = -0.305470283231271  LUMO (B3g) = -0.0108119391067131
cycle= 13 E= -75.2196533016653  delta_E=    0  |g|= 3.38e-10  |ddm|= 5.65e-09
HOMO (B2u) = -0.305470283280837  LUMO (B3g) = -0.0108119391356989
cycle= 14 E= -75.2196533016653  delta_E=    0  |g|= 4.47e-10  |ddm|= 6.62e-10
HOMO (B2u) = -0.305470283380746  LUMO (B3g) = -0.0108119392267815
cycle= 15 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 5.45e-10  |ddm|= 9.28e-10
HOMO (B2u) = -0.305470283318585  LUMO (B3g) = -0.0108119391708681
cycle= 16 E= -75.2196533016653  delta_E= -5.68e-14  |g|= 4.69e-10  |ddm|= 8.42e-10
HOMO (B2u) = -0.305470283328603  LUMO (B3g) = -0.0108119391822795
cycle= 17 E= -75.2196533016653  delta_E= 5.68e-14  |g|= 5.85e-10  |ddm|= 9.63e-10
HOMO (B2u) = -0.305470283317643  LUMO (B3g) = -0.0108119391767021
cycle= 18 E= -75.2196533016652  delta_E= 5.68e-14  |g|= 4.24e-10  |ddm|= 2.55e-10
HOMO (B2u) = -0.305470283329689  LUMO (B3g) = -0.0108119391863915
cycle= 19 E= -75.2196533016654  delta_E= -1.42e-13  |g|= 2.87e-10  |ddm|= 2.99e-10
HOMO (B2u) = -0.3054702833448  LUMO (B3g) = -0.0108119392016204
cycle= 20 E= -75.2196533016653  delta_E= 4.26e-14  |g|= 1.97e-10  |ddm|= 1.86e-10
HOMO (B2u) = -0.305470283348185  LUMO (B3g) = -0.0108119392084054
cycle= 21 E= -75.2196533016653  delta_E= 1.42e-14  |g|= 1.04e-10  |ddm|= 1.55e-10
HOMO (B2u) = -0.305470283348752  LUMO (B3g) = -0.0108119392083447
cycle= 22 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 1.02e-10  |ddm|= 1.96e-11
HOMO (B2u) = -0.305470283349378  LUMO (B3g) = -0.0108119392095811
cycle= 23 E= -75.2196533016653  delta_E= -2.84e-14  |g|= 8.99e-11  |ddm|= 3.46e-11
HOMO (B2u) = -0.305470283347021  LUMO (B3g) = -0.0108119392083782
cycle= 24 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 7.54e-11  |ddm|= 4.37e-11
HOMO (B2u) = -0.305470283347436  LUMO (B3g) = -0.0108119392095898
cycle= 25 E= -75.2196533016653  delta_E=    0  |g|= 6.17e-11  |ddm|= 3.41e-11
HOMO (B2u) = -0.305470283347997  LUMO (B3g) = -0.0108119392117248
Extra cycle  E= -75.2196533016653  delta_E= -4.26e-14  |g|= 1.94e-11  |ddm|= 6.49e-11
converged SCF energy = -75.2196533016653

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-dmrgscf/tmpyt25otpi
max_memory 4000 MB (current use 175 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-dmrgscf
integralFile           = /central/scratch/hczhai/st-07-01-dmrgscf/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-dmrgscf/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.399508725375  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4185114041769  dE = -0.019002679  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4305668436252  dE = -0.012055439  S^2 = 0.0000000
               |grad[o]|=0.0825  |ddm|=0.132  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4361439007794  dE = -0.0055770572  S^2 = 0.0000000
               |grad[o]|=0.0449  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4375519164292  dE = -0.0014080156  S^2 = 0.0000000
               |grad[o]|=0.013  |ddm|=0.0914  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4380256238664  dE = -0.00047370744  S^2 = 0.0000000
               |grad[o]|=0.00692  |ddm|=0.0133  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4380958438881  dE = -7.0220022e-05  S^2 = 0.0000000
               |grad[o]|=0.0032  |ddm|=0.00727  |maxRot[o]|=0.0175
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4381037763657  dE = -7.9324776e-06  S^2 = 0.0000000
               |grad[o]|=0.0013  |ddm|=0.00326  |maxRot[o]|=0.00586
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4381046435678  dE = -8.6720203e-07  S^2 = 0.0000000
               |grad[o]|=0.000463  |ddm|=0.00121  |maxRot[o]|=0.0019
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4381047367793  dE = -9.3211582e-08  S^2 = 0.0000000
               |grad[o]|=0.000156  |ddm|=0.000418  |maxRot[o]|=0.000616
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4381047467063  dE = -9.9269641e-09  S^2 = 0.0000000
               |grad[o]|=5.18e-05  |ddm|=0.00014  |maxRot[o]|=0.0002
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4381047477632  dE = -1.0569465e-09  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=4.62e-05  |maxRot[o]|=6.5e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.438104747875  dE = -1.1172574e-10  S^2 = 0.0000000
               |grad[o]|=5.58e-06  |ddm|=1.52e-05  |maxRot[o]|=2.12e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4381047478866  dE = -1.1667112e-11  S^2 = 0.0000000
               |grad[o]|=1.82e-06  |ddm|=4.99e-06  |maxRot[o]|=6.9e-06
2-step CASSCF converged in 13 macro (48 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95522558 1.93933508 1.79648698 1.55867498 0.44475735 0.05897222
 0.05365785 0.19288996]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01249   0.01101  -0.00075   0.00000   0.00000
  0 C 2s       0.70304   0.68783  -0.07328   0.00000   0.00000
  0 C 3s       0.00773   0.01395  -0.01813   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 2py     -0.00000   0.00000  -0.00000   0.70477   0.70699
  0 C 2pz      0.07361  -0.16270   0.70188  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3py      0.00000   0.00000  -0.00000   0.05427   0.01126
  0 C 3pz     -0.00668  -0.00182   0.02850   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.01889   0.00635
  0 C 3dz^2    0.00731  -0.00827   0.02845   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 0 C 3dx2-y2   0.00258   0.00545  -0.00616  -0.00000  -0.00000
  1 C 1s       0.01249  -0.01101  -0.00075   0.00000   0.00000
  1 C 2s       0.70304  -0.68783  -0.07328  -0.00000  -0.00000
  1 C 3s       0.00773  -0.01395  -0.01813  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 2py     -0.00000   0.00000   0.00000   0.70477  -0.70699
  1 C 2pz     -0.07361  -0.16270  -0.70188  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3py      0.00000  -0.00000  -0.00000   0.05427  -0.01126
  1 C 3pz      0.00668  -0.00182  -0.02850   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01889   0.00635
  1 C 3dz^2    0.00731   0.00827   0.02845   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 1 C 3dx2-y2   0.00258  -0.00545  -0.00616   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00014
  0 C 2s      -0.00000   0.00000   0.16232
  0 C 3s       0.00000  -0.00000   0.02153
  0 C 2px      0.69477   0.69952  -0.00000
  0 C 2py      0.00000  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.68780
  0 C 3px     -0.07060  -0.02872  -0.00000
  0 C 3py      0.00000   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00644
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00067
  0 C 3dxz    -0.11095  -0.09923  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00851
  1 C 1s       0.00000   0.00000   0.00014
  1 C 2s       0.00000   0.00000  -0.16232
  1 C 3s      -0.00000   0.00000  -0.02153
  1 C 2px      0.69477  -0.69952   0.00000
  1 C 2py      0.00000  -0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68780
  1 C 3px     -0.07060   0.02872   0.00000
  1 C 3py     -0.00000   0.00000   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00644
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00067
  1 C 3dxz     0.11095  -0.09923  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00851
<CAS-nat-orb|mo-hf>  3  3    0.99475642
<CAS-nat-orb|mo-hf>  4  4    0.99950402
<CAS-nat-orb|mo-hf>  5  5    0.99460067
<CAS-nat-orb|mo-hf>  6  6    0.99808720
<CAS-nat-orb|mo-hf>  7  7    0.99017070
<CAS-nat-orb|mo-hf>  8  8    0.93329646
<CAS-nat-orb|mo-hf>  9  9    0.96133984
<CAS-nat-orb|mo-hf>  10  10    0.97346862
CASSCF energy = -75.4381047478866
CASCI E = -75.4381047478866  E(CI) = -14.5778600953519  S^2 = 0.0000000
Time cost =    220.915
