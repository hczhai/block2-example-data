#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:04:01 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.952518979656 AA    0.000000000000   0.000000000000   1.800000000000 Bohr   0.0

nuclear repulsion = 20
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  0.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:       154.83


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp5_aosfxz
max_memory 4000 MB (current use 254 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.1366469280558

WARN: Singularity detected in overlap matrix (condition number = 1.91e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.411563442743741  LUMO (Ag) = -0.232616164544876
cycle= 1 E= -75.1160073846339  delta_E= 1.02  |g|= 0.175  |ddm|= 1.65
HOMO (B1u) = -0.462886704875275  LUMO (Ag) = -0.099017704864389
cycle= 2 E= -75.1270298311364  delta_E= -0.011  |g|= 0.057  |ddm|= 0.233
HOMO (B1u) = -0.43800078024347  LUMO (Ag) = -0.0789293202815927
cycle= 3 E= -75.1282984729017  delta_E= -0.00127  |g|= 0.0157  |ddm|= 0.191
HOMO (B1u) = -0.440879448397979  LUMO (Ag) = -0.0869420301347706
cycle= 4 E= -75.1284487654917  delta_E= -0.00015  |g|= 0.00222  |ddm|= 0.0862
HOMO (B1u) = -0.441380240119147  LUMO (Ag) = -0.0882782976431994
cycle= 5 E= -75.1284520756329  delta_E= -3.31e-06  |g|= 0.000419  |ddm|= 0.0158
HOMO (B1u) = -0.441351661772559  LUMO (Ag) = -0.0881933274529131
cycle= 6 E= -75.1284521927704  delta_E= -1.17e-07  |g|= 2.77e-05  |ddm|= 0.00246
HOMO (B1u) = -0.441354048137818  LUMO (Ag) = -0.0881978149646882
cycle= 7 E= -75.1284521931898  delta_E= -4.19e-10  |g|= 1.77e-06  |ddm|= 0.000613
HOMO (B1u) = -0.441354076509803  LUMO (Ag) = -0.0881971474462794
cycle= 8 E= -75.128452193191  delta_E= -1.14e-12  |g|= 1.61e-07  |ddm|= 3.45e-05
HOMO (B1u) = -0.441354065704665  LUMO (Ag) = -0.0881971923699278
cycle= 9 E= -75.128452193191  delta_E= 1.42e-14  |g|= 1.18e-08  |ddm|= 1.67e-06
HOMO (B1u) = -0.441354065628109  LUMO (Ag) = -0.0881971880060475
cycle= 10 E= -75.128452193191  delta_E= -5.68e-14  |g|= 5.49e-09  |ddm|= 1.02e-07
HOMO (B1u) = -0.441354065563395  LUMO (Ag) = -0.088197187494668
cycle= 11 E= -75.128452193191  delta_E= 4.26e-14  |g|= 6.58e-10  |ddm|= 4.13e-08
HOMO (B1u) = -0.441354065553637  LUMO (Ag) = -0.088197187470781
cycle= 12 E= -75.128452193191  delta_E= 2.84e-14  |g|= 4.43e-10  |ddm|= 1.36e-09
HOMO (B1u) = -0.441354065555471  LUMO (Ag) = -0.0881971875205221
cycle= 13 E= -75.128452193191  delta_E= -8.53e-14  |g|= 3.7e-10  |ddm|= 1.25e-09
HOMO (B1u) = -0.441354065532896  LUMO (Ag) = -0.0881971874638086
cycle= 14 E= -75.128452193191  delta_E=    0  |g|= 3.3e-10  |ddm|= 2.31e-09
HOMO (B1u) = -0.441354065498961  LUMO (Ag) = -0.0881971874066356
cycle= 15 E= -75.128452193191  delta_E=    0  |g|= 4.02e-10  |ddm|= 4.91e-09
HOMO (B1u) = -0.441354065493311  LUMO (Ag) = -0.0881971874732278
cycle= 16 E= -75.128452193191  delta_E= 5.68e-14  |g|= 4.37e-10  |ddm|= 1.12e-08
HOMO (B1u) = -0.441354065533411  LUMO (Ag) = -0.0881971875092258
cycle= 17 E= -75.128452193191  delta_E= -5.68e-14  |g|= 4.4e-10  |ddm|= 3.66e-10
HOMO (B1u) = -0.441354065581548  LUMO (Ag) = -0.0881971875248523
cycle= 18 E= -75.1284521931909  delta_E= 9.95e-14  |g|= 1.77e-10  |ddm|= 3.91e-09
HOMO (B1u) = -0.441354065573002  LUMO (Ag) = -0.0881971875100321
cycle= 19 E= -75.128452193191  delta_E= -1.42e-14  |g|= 6.49e-11  |ddm|= 1.06e-09
HOMO (B1u) = -0.441354065569599  LUMO (Ag) = -0.0881971875061501
cycle= 20 E= -75.128452193191  delta_E= -7.11e-14  |g|= 5.4e-11  |ddm|= 5.64e-11
HOMO (B1u) = -0.441354065566768  LUMO (Ag) = -0.0881971875034696
cycle= 21 E= -75.128452193191  delta_E= 1.42e-14  |g|= 4.84e-11  |ddm|= 2.68e-11
HOMO (B1u) = -0.441354065566063  LUMO (Ag) = -0.0881971875011165
cycle= 22 E= -75.128452193191  delta_E= 5.68e-14  |g|= 4.33e-11  |ddm|= 1.99e-11
HOMO (B1u) = -0.441354065565563  LUMO (Ag) = -0.0881971875007334
cycle= 23 E= -75.128452193191  delta_E= -4.26e-14  |g|= 4.33e-11  |ddm|= 3.27e-11
HOMO (B1u) = -0.441354065563091  LUMO (Ag) = -0.0881971874982832
cycle= 24 E= -75.128452193191  delta_E= -1.42e-14  |g|= 4.02e-11  |ddm|= 1.91e-10
HOMO (B1u) = -0.441354065559873  LUMO (Ag) = -0.0881971874913039
cycle= 25 E= -75.1284521931909  delta_E= 7.11e-14  |g|= 2.79e-11  |ddm|= 1.31e-10
HOMO (B1u) = -0.441354065557419  LUMO (Ag) = -0.0881971874858342
cycle= 26 E= -75.128452193191  delta_E= -4.26e-14  |g|= 1.6e-11  |ddm|= 1.38e-10
HOMO (B1u) = -0.44135406555735  LUMO (Ag) = -0.0881971874853608
cycle= 27 E= -75.1284521931911  delta_E= -8.53e-14  |g|= 1.2e-11  |ddm|= 2.96e-11
HOMO (B1u) = -0.441354065557699  LUMO (Ag) = -0.088197187485548
cycle= 28 E= -75.1284521931911  delta_E= 1.42e-14  |g|= 1.05e-11  |ddm|= 4.97e-12
HOMO (B1u) = -0.441354065557999  LUMO (Ag) = -0.0881971874856487
cycle= 29 E= -75.1284521931911  delta_E= -1.42e-14  |g|= 9.13e-12  |ddm|= 4.09e-12
HOMO (B1u) = -0.441354065558263  LUMO (Ag) = -0.088197187485644
cycle= 30 E= -75.1284521931911  delta_E= 1.42e-14  |g|= 7.76e-12  |ddm|= 4.27e-12
HOMO (B1u) = -0.44135406555848  LUMO (Ag) = -0.0881971874856419
cycle= 31 E= -75.128452193191  delta_E= 8.53e-14  |g|= 6.59e-12  |ddm|= 3.53e-12
HOMO (B1u) = -0.441354065558648  LUMO (Ag) = -0.0881971874855406
cycle= 32 E= -75.128452193191  delta_E= 1.42e-14  |g|= 5.24e-12  |ddm|= 3.99e-12
HOMO (B1u) = -0.441354065558758  LUMO (Ag) = -0.0881971874853221
cycle= 33 E= -75.128452193191  delta_E= -2.84e-14  |g|= 3.96e-12  |ddm|= 9.81e-12
HOMO (B1u) = -0.441354065558762  LUMO (Ag) = -0.0881971874851023
cycle= 34 E= -75.1284521931911  delta_E= -8.53e-14  |g|= 3.11e-12  |ddm|= 5.8e-12
HOMO (B1u) = -0.44135406555871  LUMO (Ag) = -0.0881971874849213
cycle= 35 E= -75.128452193191  delta_E= 8.53e-14  |g|= 2.64e-12  |ddm|= 1.72e-12
HOMO (B1u) = -0.441354065558678  LUMO (Ag) = -0.0881971874847741
cycle= 36 E= -75.128452193191  delta_E= -4.26e-14  |g|= 2.26e-12  |ddm|= 1.14e-12
HOMO (B1u) = -0.441354065558658  LUMO (Ag) = -0.0881971874846513
cycle= 37 E= -75.128452193191  delta_E= 7.11e-14  |g|= 1.92e-12  |ddm|= 1.11e-12
HOMO (B1u) = -0.441354065558648  LUMO (Ag) = -0.0881971874845481
cycle= 38 E= -75.1284521931911  delta_E= -1.14e-13  |g|= 1.61e-12  |ddm|= 1.13e-12
HOMO (B1u) = -0.441354065558644  LUMO (Ag) = -0.0881971874844636
cycle= 39 E= -75.128452193191  delta_E= 2.84e-14  |g|= 1.33e-12  |ddm|= 1.11e-12
HOMO (B1u) = -0.441354065558646  LUMO (Ag) = -0.0881971874843961
cycle= 40 E= -75.128452193191  delta_E=    0  |g|= 1.1e-12  |ddm|= 9.42e-13
HOMO (B1u) = -0.441354065558685  LUMO (Ag) = -0.0881971874842521
Extra cycle  E= -75.128452193191  delta_E= 2.84e-14  |g|= 4.49e-13  |ddm|= 2.72e-12
converged SCF energy = -75.128452193191

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp5_aosfxz
max_memory 4000 MB (current use 259 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.2773851266801  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.2921612552913  dE = -0.014776129  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3054533418287  dE = -0.013292087  S^2 = 0.0000000
               |grad[o]|=0.122  |ddm|=0.0317  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3171665948222  dE = -0.011713253  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|=0.022  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3257563368025  dE = -0.008589742  S^2 = 0.0000000
               |grad[o]|=0.0806  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3312100882397  dE = -0.0054537514  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.00664  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3353808805676  dE = -0.0041707923  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3388115062486  dE = -0.0034306257  S^2 = 0.0000000
               |grad[o]|=0.0423  |ddm|=0.00197  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3416937899056  dE = -0.0028822837  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.00139  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.3441068760492  dE = -0.0024130861  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.00119  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.3460868947903  dE = -0.0019800187  S^2 = 0.0000000
               |grad[o]|=0.023  |ddm|=0.00138  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.3476533580233  dE = -0.0015664632  S^2 = 0.0000000
               |grad[o]|=0.0181  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.3488207494789  dE = -0.0011673915  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00222  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.3496021914645  dE = -0.00078144199  S^2 = 0.0000000
               |grad[o]|=0.00962  |ddm|=0.00269  |maxRot[o]|=0.0799
macro iter 14 (6 JK  0 micro), CASSCF E = -75.3500076019281  dE = -0.00040541046  S^2 = 0.0000000
               |grad[o]|=0.00596  |ddm|=0.00323  |maxRot[o]|=0.0799
macro iter 15 (4 JK  0 micro), CASSCF E = -75.3500690559467  dE = -6.1454019e-05  S^2 = 0.0000000
               |grad[o]|=0.00259  |ddm|=0.004  |maxRot[o]|=0.0356
macro iter 16 (3 JK  0 micro), CASSCF E = -75.3500711296791  dE = -2.0737324e-06  S^2 = 0.0000000
               |grad[o]|=0.000771  |ddm|=0.00302  |maxRot[o]|=0.0056
macro iter 17 (3 JK  0 micro), CASSCF E = -75.3500712273195  dE = -9.7640381e-08  S^2 = 0.0000000
               |grad[o]|=0.000204  |ddm|=0.00102  |maxRot[o]|=0.00111
macro iter 18 (3 JK  0 micro), CASSCF E = -75.3500712324683  dE = -5.148749e-09  S^2 = 0.0000000
               |grad[o]|=5.3e-05  |ddm|=0.000289  |maxRot[o]|=0.000238
macro iter 19 (3 JK  0 micro), CASSCF E = -75.350071232753  dE = -2.8472869e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=6.97e-05  |maxRot[o]|=5.33e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.3500712327692  dE = -1.6171953e-11  S^2 = 0.0000000
               |grad[o]|=3.36e-06  |ddm|=1.72e-05  |maxRot[o]|=1.23e-05
2-step CASSCF converged in 20 macro (102 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99117055 1.9483733  1.94837323 1.38207917 0.61632491 0.05352421
 0.05352413 0.0066305 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00026   0.00000   0.00000   0.00156  -0.00335
  0 C 2s       0.56540   0.00000  -0.00000   0.40871  -0.42139
  0 C 3s      -0.05874   0.00000  -0.00000   0.01072  -0.04347
  0 C 2px     -0.00000  -0.00000   0.70297  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70297  -0.00000  -0.00000  -0.00000
  0 C 2pz      0.41246   0.00000  -0.00000  -0.57668   0.56528
  0 C 3px      0.00000   0.00000  -0.06368  -0.00000   0.00000
  0 C 3py     -0.00000  -0.06368   0.00000  -0.00000  -0.00000
  0 C 3pz     -0.06271   0.00000  -0.00000  -0.01322  -0.02762
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.04218   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.05310   0.00000  -0.00000   0.01011   0.01522
  0 C 3dxz    -0.00000   0.00000   0.04218  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s      -0.00026   0.00000   0.00000  -0.00156  -0.00335
  1 C 2s       0.56540  -0.00000   0.00000  -0.40871  -0.42139
  1 C 3s      -0.05874  -0.00000   0.00000  -0.01072  -0.04347
  1 C 2px      0.00000  -0.00000   0.70297   0.00000  -0.00000
  1 C 2py      0.00000   0.70297  -0.00000   0.00000   0.00000
  1 C 2pz     -0.41246   0.00000   0.00000  -0.57668  -0.56528
  1 C 3px      0.00000  -0.00000  -0.06368   0.00000   0.00000
  1 C 3py      0.00000  -0.06368   0.00000   0.00000   0.00000
  1 C 3pz      0.06271   0.00000  -0.00000  -0.01322   0.02762
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.04218  -0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.05310  -0.00000   0.00000  -0.01011   0.01522
  1 C 3dxz    -0.00000   0.00000  -0.04218  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00117
  0 C 2s      -0.00000   0.00000   0.57006
  0 C 3s      -0.00000   0.00000  -0.05590
  0 C 2px      0.70510  -0.00000  -0.00000
  0 C 2py      0.00000   0.70510   0.00000
  0 C 2pz     -0.00000   0.00000   0.40146
  0 C 3px     -0.04754  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04754   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01218
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02390   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.10289
  0 C 3dxz    -0.02390  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00117
  1 C 2s       0.00000  -0.00000  -0.57006
  1 C 3s       0.00000  -0.00000   0.05590
  1 C 2px     -0.70510   0.00000   0.00000
  1 C 2py      0.00000  -0.70510  -0.00000
  1 C 2pz     -0.00000   0.00000   0.40146
  1 C 3px      0.04754   0.00000   0.00000
  1 C 3py      0.00000   0.04754  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01218
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02390   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.10289
  1 C 3dxz    -0.02390  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99656097
<CAS-nat-orb|mo-hf>  4  4    0.99984847
<CAS-nat-orb|mo-hf>  5  5    0.99984847
<CAS-nat-orb|mo-hf>  6  6    0.99856152
<CAS-nat-orb|mo-hf>  7  7    0.98495368
<CAS-nat-orb|mo-hf>  8  8    0.83784467
<CAS-nat-orb|mo-hf>  8  15   -0.54092854
<CAS-nat-orb|mo-hf>  9  9    0.83784453
<CAS-nat-orb|mo-hf>  9  16   -0.54092872
<CAS-nat-orb|mo-hf>  10  20   -0.80017035
CASSCF energy = -75.3500712327692
CASCI E = -75.3500712327692  E(CI) = -19.5186694186714  S^2 = 0.0000000
......production of RDMs took       2.36 sec
......reading the RDM took          0.46 sec
......production of RDMs took      29.57 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.73 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000001
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000236898
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000062573
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001712517
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000181253
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0001082579
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0002359649
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000786550
HMAT symm error =    0.0346152452
E(MRCI) - E(ref) = -0.1007598969531074 DC = -0.003713875330274897
E(WickICMRCISD)   = -75.45083112972226  E_corr_ci = -0.1007598969531074
E(WickICMRCISD+Q) = -75.45454500505254  E_corr_ci = -0.1044737722833823
Time cost =   2856.931
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:51:38 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.978977840202 AA    0.000000000000   0.000000000000   1.850000000000 Bohr   0.0

nuclear repulsion = 19.4594594594595
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     46731.05


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpr9mjzqc5
max_memory 4000 MB (current use 8393 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.0853308429702

WARN: Singularity detected in overlap matrix (condition number = 1.7e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.413580977369314  LUMO (Ag) = -0.227598981995077
cycle= 1 E= -75.172693617241  delta_E= 0.913  |g|= 0.173  |ddm|= 1.63
HOMO (B1u) = -0.471112350140236  LUMO (Ag) = -0.104670423689865
cycle= 2 E= -75.1835008238031  delta_E= -0.0108  |g|= 0.0557  |ddm|= 0.215
HOMO (B1u) = -0.445209609873391  LUMO (Ag) = -0.0826198965911246
cycle= 3 E= -75.1846477232622  delta_E= -0.00115  |g|= 0.0156  |ddm|= 0.166
HOMO (B1u) = -0.447439744130488  LUMO (Ag) = -0.0899048584713121
cycle= 4 E= -75.1847993820882  delta_E= -0.000152  |g|= 0.00222  |ddm|= 0.0841
HOMO (B1u) = -0.447984981890543  LUMO (Ag) = -0.0913127106239855
cycle= 5 E= -75.1848027365253  delta_E= -3.35e-06  |g|= 0.00041  |ddm|= 0.016
HOMO (B1u) = -0.447956467884101  LUMO (Ag) = -0.0912347091259185
cycle= 6 E= -75.18480284832  delta_E= -1.12e-07  |g|= 2.74e-05  |ddm|= 0.00219
HOMO (B1u) = -0.447959917478171  LUMO (Ag) = -0.0912398214370498
cycle= 7 E= -75.184802848724  delta_E= -4.04e-10  |g|= 1.64e-06  |ddm|= 0.00057
HOMO (B1u) = -0.447959903825145  LUMO (Ag) = -0.091239251118185
cycle= 8 E= -75.184802848725  delta_E= -9.38e-13  |g|= 1.46e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.447959899406515  LUMO (Ag) = -0.0912392910101838
cycle= 9 E= -75.184802848725  delta_E=    0  |g|= 1.12e-08  |ddm|= 1.31e-06
HOMO (B1u) = -0.447959898995552  LUMO (Ag) = -0.0912392858238231
cycle= 10 E= -75.184802848725  delta_E=    0  |g|= 5.77e-09  |ddm|= 8.36e-08
HOMO (B1u) = -0.44795989906096  LUMO (Ag) = -0.0912392856583272
cycle= 11 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 6.42e-10  |ddm|= 4.21e-08
HOMO (B1u) = -0.447959899110057  LUMO (Ag) = -0.091239285722377
cycle= 12 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 4.38e-10  |ddm|= 1.82e-09
HOMO (B1u) = -0.447959899095924  LUMO (Ag) = -0.0912392857451299
cycle= 13 E= -75.1848028487249  delta_E= -2.84e-14  |g|= 3.45e-10  |ddm|= 8.36e-10
HOMO (B1u) = -0.447959899057595  LUMO (Ag) = -0.0912392856766914
cycle= 14 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 3.4e-10  |ddm|= 1.68e-09
HOMO (B1u) = -0.447959899024746  LUMO (Ag) = -0.0912392856285203
cycle= 15 E= -75.1848028487248  delta_E= 5.68e-14  |g|= 3.87e-10  |ddm|= 4.34e-09
HOMO (B1u) = -0.447959899030258  LUMO (Ag) = -0.0912392857009416
cycle= 16 E= -75.1848028487249  delta_E= -8.53e-14  |g|= 4.3e-10  |ddm|= 9.23e-09
HOMO (B1u) = -0.447959899080265  LUMO (Ag) = -0.0912392857450303
cycle= 17 E= -75.184802848725  delta_E= -8.53e-14  |g|= 4.45e-10  |ddm|= 4.6e-10
HOMO (B1u) = -0.447959899143794  LUMO (Ag) = -0.0912392857743575
cycle= 18 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 2.02e-10  |ddm|= 3.46e-09
HOMO (B1u) = -0.447959899126029  LUMO (Ag) = -0.0912392857536385
cycle= 19 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 6.75e-11  |ddm|= 1.02e-09
HOMO (B1u) = -0.447959899121224  LUMO (Ag) = -0.0912392857486653
cycle= 20 E= -75.184802848725  delta_E= -5.68e-14  |g|= 5.56e-11  |ddm|= 5.82e-11
HOMO (B1u) = -0.447959899118643  LUMO (Ag) = -0.0912392857462666
cycle= 21 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 4.9e-11  |ddm|= 2.34e-11
HOMO (B1u) = -0.447959899117639  LUMO (Ag) = -0.0912392857438109
cycle= 22 E= -75.184802848725  delta_E= -2.84e-14  |g|= 4.44e-11  |ddm|= 2.15e-11
HOMO (B1u) = -0.447959899116703  LUMO (Ag) = -0.0912392857428609
cycle= 23 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 4.45e-11  |ddm|= 1.44e-11
HOMO (B1u) = -0.447959899113543  LUMO (Ag) = -0.0912392857391212
cycle= 24 E= -75.1848028487249  delta_E= -2.84e-14  |g|= 4.02e-11  |ddm|= 1.48e-10
HOMO (B1u) = -0.44795989911023  LUMO (Ag) = -0.0912392857319351
cycle= 25 E= -75.184802848725  delta_E= -5.68e-14  |g|= 2.82e-11  |ddm|= 1.15e-10
HOMO (B1u) = -0.447959899107716  LUMO (Ag) = -0.0912392857264658
cycle= 26 E= -75.1848028487249  delta_E= 8.53e-14  |g|= 1.6e-11  |ddm|= 1.21e-10
HOMO (B1u) = -0.447959899107811  LUMO (Ag) = -0.0912392857264965
cycle= 27 E= -75.184802848725  delta_E= -8.53e-14  |g|= 1.16e-11  |ddm|= 2.43e-11
HOMO (B1u) = -0.447959899108249  LUMO (Ag) = -0.0912392857268309
cycle= 28 E= -75.1848028487247  delta_E= 2.56e-13  |g|= 1.11e-11  |ddm|= 3.31e-12
HOMO (B1u) = -0.447959899108597  LUMO (Ag) = -0.0912392857270317
cycle= 29 E= -75.1848028487247  delta_E= 5.68e-14  |g|= 9.9e-12  |ddm|= 3.75e-12
HOMO (B1u) = -0.44795989910891  LUMO (Ag) = -0.091239285727149
cycle= 30 E= -75.1848028487246  delta_E= 2.84e-14  |g|= 8.46e-12  |ddm|= 4.79e-12
HOMO (B1u) = -0.447959899109165  LUMO (Ag) = -0.0912392857272425
cycle= 31 E= -75.1848028487246  delta_E=    0  |g|= 7.34e-12  |ddm|= 4.52e-12
HOMO (B1u) = -0.447959899109233  LUMO (Ag) = -0.0912392857265857
Extra cycle  E= -75.1848028487246  delta_E= 5.68e-14  |g|= 2.65e-12  |ddm|= 2.01e-11
converged SCF energy = -75.1848028487246

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpr9mjzqc5
max_memory 4000 MB (current use 8393 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.335087523525  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3504581939653  dE = -0.01537067  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.364212830074  dE = -0.013754636  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0333  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3762420195616  dE = -0.012029189  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|=0.0229  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3841411858206  dE = -0.0078991663  S^2 = 0.0000000
               |grad[o]|=0.0783  |ddm|=0.014  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3894311159856  dE = -0.0052899302  S^2 = 0.0000000
               |grad[o]|=0.0619  |ddm|=0.00584  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3935755778262  dE = -0.0041444618  S^2 = 0.0000000
               |grad[o]|=0.0506  |ddm|=0.0029  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3970215811432  dE = -0.0034460033  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.00186  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3999261731221  dE = -0.002904592  S^2 = 0.0000000
               |grad[o]|=0.0343  |ddm|=0.00135  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4023539081266  dE = -0.002427735  S^2 = 0.0000000
               |grad[o]|=0.0279  |ddm|=0.00128  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4043305997  dE = -0.0019766916  S^2 = 0.0000000
               |grad[o]|=0.0223  |ddm|=0.00152  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4058701161486  dE = -0.0015395164  S^2 = 0.0000000
               |grad[o]|=0.0173  |ddm|=0.00192  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4069826589891  dE = -0.0011125428  S^2 = 0.0000000
               |grad[o]|=0.0127  |ddm|=0.00237  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4076778327323  dE = -0.00069517374  S^2 = 0.0000000
               |grad[o]|=0.00858  |ddm|=0.00283  |maxRot[o]|=0.0799
macro iter 14 (5 JK  0 micro), CASSCF E = -75.4079300388897  dE = -0.00025220616  S^2 = 0.0000000
               |grad[o]|=0.00477  |ddm|=0.00337  |maxRot[o]|=0.0599
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4079624068774  dE = -3.2367988e-05  S^2 = 0.0000000
               |grad[o]|=0.002  |ddm|=0.00329  |maxRot[o]|= 0.02
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4079663328239  dE = -3.9259465e-06  S^2 = 0.0000000
               |grad[o]|=0.00083  |ddm|=0.00182  |maxRot[o]|=0.00728
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4079664730897  dE = -1.4026578e-07  S^2 = 0.0000000
               |grad[o]|=0.000219  |ddm|=0.00106  |maxRot[o]|=0.00138
macro iter 18 (4 JK  0 micro), CASSCF E = -75.4079664804424  dE = -7.3527247e-09  S^2 = 0.0000000
               |grad[o]|=5.52e-05  |ddm|=0.000309  |maxRot[o]|=0.000271
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4079664808342  dE = -3.918359e-10  S^2 = 0.0000000
               |grad[o]|=1.56e-05  |ddm|=7.16e-05  |maxRot[o]|=6.22e-05
macro iter 20 (3 JK  0 micro), CASSCF E = -75.4079664808547  dE = -2.0463631e-11  S^2 = 0.0000000
               |grad[o]|=3.76e-06  |ddm|=2.11e-05  |maxRot[o]|=1.17e-05
2-step CASSCF converged in 20 macro (102 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99071501 1.94427801 1.94427781 1.40690827 0.59110117 0.05781825
 0.05781802 0.00708346]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00011   0.00000   0.00000   0.00165  -0.00303
  0 C 2s       0.56693  -0.00000   0.00000   0.41981  -0.41934
  0 C 3s      -0.05883   0.00000   0.00000   0.01056  -0.04125
  0 C 2px      0.00000  -0.00000   0.70357  -0.00000  -0.00000
  0 C 2py      0.00000   0.70357  -0.00000   0.00000   0.00000
  0 C 2pz      0.41060   0.00000   0.00000  -0.56869   0.56692
  0 C 3px      0.00000  -0.00000  -0.05731  -0.00000  -0.00000
  0 C 3py      0.00000  -0.05731  -0.00000  -0.00000   0.00000
  0 C 3pz     -0.06180   0.00000   0.00000  -0.01234  -0.02899
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.04122  -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.05218   0.00000   0.00000   0.00930   0.01419
  0 C 3dxz     0.00000  -0.00000   0.04122  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
  1 C 1s      -0.00011   0.00000   0.00000  -0.00165  -0.00303
  1 C 2s       0.56693  -0.00000  -0.00000  -0.41981  -0.41934
  1 C 3s      -0.05883  -0.00000  -0.00000  -0.01056  -0.04125
  1 C 2px     -0.00000  -0.00000   0.70357   0.00000   0.00000
  1 C 2py     -0.00000   0.70357   0.00000   0.00000  -0.00000
  1 C 2pz     -0.41060  -0.00000   0.00000  -0.56869  -0.56692
  1 C 3px     -0.00000   0.00000  -0.05731   0.00000   0.00000
  1 C 3py     -0.00000  -0.05731   0.00000   0.00000  -0.00000
  1 C 3pz      0.06180   0.00000   0.00000  -0.01234   0.02899
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.04122  -0.00000  -0.00000   0.00000
  1 C 3dz^2    0.05218   0.00000  -0.00000  -0.00930   0.01419
  1 C 3dxz     0.00000  -0.00000  -0.04122  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00113
  0 C 2s       0.00000  -0.00000   0.56365
  0 C 3s       0.00000  -0.00000  -0.05372
  0 C 2px      0.70531   0.00000   0.00000
  0 C 2py      0.00000   0.70531   0.00000
  0 C 2pz      0.00000   0.00000   0.41389
  0 C 3px     -0.04437   0.00000   0.00000
  0 C 3py      0.00000  -0.04437   0.00000
  0 C 3pz      0.00000  -0.00000  -0.01152
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02384   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.08932
  0 C 3dxz    -0.02384   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00113
  1 C 2s      -0.00000  -0.00000  -0.56365
  1 C 3s      -0.00000   0.00000   0.05372
  1 C 2px     -0.70531  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70531  -0.00000
  1 C 2pz      0.00000  -0.00000   0.41389
  1 C 3px      0.04437  -0.00000  -0.00000
  1 C 3py     -0.00000   0.04437  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.01152
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02384   0.00000
  1 C 3dz^2   -0.00000   0.00000   0.08932
  1 C 3dxz    -0.02384   0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99647821
<CAS-nat-orb|mo-hf>  4  4    0.99985488
<CAS-nat-orb|mo-hf>  5  5    0.99985488
<CAS-nat-orb|mo-hf>  6  6    0.99860560
<CAS-nat-orb|mo-hf>  7  7    0.98449184
<CAS-nat-orb|mo-hf>  8  8    0.85083709
<CAS-nat-orb|mo-hf>  8  15   -0.52116379
<CAS-nat-orb|mo-hf>  9  9    0.85083680
<CAS-nat-orb|mo-hf>  9  16   -0.52116422
<CAS-nat-orb|mo-hf>  10  20   -0.78474255
CASSCF energy = -75.4079664808547
CASCI E = -75.4079664808547  E(CI) = -19.336696648096  S^2 = 0.0000000
......production of RDMs took       3.02 sec
......reading the RDM took          0.47 sec
......production of RDMs took      40.50 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.03 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000001
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000081999
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000021659
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001285095
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000144958
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000801230
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001736849
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000578950
HMAT symm error =    0.0238380676
E(MRCI) - E(ref) = -0.1011401770079203 DC = -0.003771987874731274
E(WickICMRCISD)   = -75.50910665786262  E_corr_ci = -0.1011401770079203
E(WickICMRCISD+Q) = -75.51287864573735  E_corr_ci = -0.1049121648826516
Time cost =   2955.218
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:40:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.005436700748 AA    0.000000000000   0.000000000000   1.900000000000 Bohr   0.0

nuclear repulsion = 18.9473684210526
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   0.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     91034.51


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp4rsn2sjq
max_memory 4000 MB (current use 8388 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.031041178399

WARN: Singularity detected in overlap matrix (condition number = 1.52e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.394985537155228  LUMO (Ag) = -0.222680456230754
cycle= 1 E= -75.2198455234798  delta_E= 0.811  |g|= 0.173  |ddm|= 1.61
HOMO (B1u) = -0.479415237903266  LUMO (Ag) = -0.109973136342065
cycle= 2 E= -75.2305447304664  delta_E= -0.0107  |g|= 0.0546  |ddm|= 0.201
HOMO (B1u) = -0.452535964635348  LUMO (Ag) = -0.0860888408725848
cycle= 3 E= -75.23159022107  delta_E= -0.00105  |g|= 0.0153  |ddm|= 0.145
HOMO (B1u) = -0.454103263824992  LUMO (Ag) = -0.0925462170063942
cycle= 4 E= -75.2317373690304  delta_E= -0.000147  |g|= 0.00222  |ddm|= 0.0805
HOMO (B1u) = -0.454675048897529  LUMO (Ag) = -0.09400587319759
cycle= 5 E= -75.2317407777115  delta_E= -3.41e-06  |g|= 0.0004  |ddm|= 0.0162
HOMO (B1u) = -0.45464663574983  LUMO (Ag) = -0.0939357427361181
cycle= 6 E= -75.231740884219  delta_E= -1.07e-07  |g|= 2.7e-05  |ddm|= 0.00191
HOMO (B1u) = -0.454651041484011  LUMO (Ag) = -0.0939413575689314
cycle= 7 E= -75.2317408846097  delta_E= -3.91e-10  |g|= 1.59e-06  |ddm|= 0.000529
HOMO (B1u) = -0.454650997156081  LUMO (Ag) = -0.0939408954912678
cycle= 8 E= -75.2317408846106  delta_E= -9.66e-13  |g|= 1.33e-07  |ddm|= 2.94e-05
HOMO (B1u) = -0.454650997886298  LUMO (Ag) = -0.0939409273864949
cycle= 9 E= -75.2317408846106  delta_E= 2.84e-14  |g|= 9.79e-09  |ddm|= 1.1e-06
HOMO (B1u) = -0.454650996884574  LUMO (Ag) = -0.0939409222283057
cycle= 10 E= -75.2317408846106  delta_E= 2.84e-14  |g|= 6.08e-09  |ddm|= 5.23e-08
HOMO (B1u) = -0.454650997076415  LUMO (Ag) = -0.093940922402734
cycle= 11 E= -75.2317408846106  delta_E= -2.84e-14  |g|= 6.37e-10  |ddm|= 4.13e-08
HOMO (B1u) = -0.454650997071842  LUMO (Ag) = -0.0939409223769582
cycle= 12 E= -75.2317408846106  delta_E=    0  |g|= 4.28e-10  |ddm|= 1.29e-09
HOMO (B1u) = -0.454650997117846  LUMO (Ag) = -0.0939409225016658
cycle= 13 E= -75.2317408846107  delta_E= -5.68e-14  |g|= 3.36e-10  |ddm|= 9.49e-10
HOMO (B1u) = -0.454650997077016  LUMO (Ag) = -0.0939409224367675
cycle= 14 E= -75.2317408846107  delta_E=    0  |g|= 3.39e-10  |ddm|= 7.14e-10
HOMO (B1u) = -0.454650997041849  LUMO (Ag) = -0.0939409223983254
cycle= 15 E= -75.2317408846107  delta_E= 1.42e-14  |g|= 3.66e-10  |ddm|= 3.37e-09
HOMO (B1u) = -0.454650997062124  LUMO (Ag) = -0.0939409224617964
cycle= 16 E= -75.2317408846107  delta_E= -4.26e-14  |g|= 3.85e-10  |ddm|= 5.53e-09
HOMO (B1u) = -0.454650997122843  LUMO (Ag) = -0.0939409225143688
cycle= 17 E= -75.2317408846106  delta_E= 8.53e-14  |g|= 4.28e-10  |ddm|= 7.07e-10
HOMO (B1u) = -0.454650997189805  LUMO (Ag) = -0.0939409225485738
cycle= 18 E= -75.2317408846106  delta_E= 1.42e-14  |g|= 2.28e-10  |ddm|= 2.6e-09
HOMO (B1u) = -0.454650997163367  LUMO (Ag) = -0.0939409225221581
cycle= 19 E= -75.2317408846107  delta_E= -9.95e-14  |g|= 7.15e-11  |ddm|= 9.44e-10
HOMO (B1u) = -0.454650997158146  LUMO (Ag) = -0.0939409225166855
cycle= 20 E= -75.2317408846107  delta_E=    0  |g|= 5.79e-11  |ddm|= 6.16e-11
HOMO (B1u) = -0.454650997140898  LUMO (Ag) = -0.0939409224899472
Extra cycle  E= -75.2317408846106  delta_E= 5.68e-14  |g|= 1.47e-11  |ddm|= 2.44e-10
converged SCF energy = -75.2317408846106

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp4rsn2sjq
max_memory 4000 MB (current use 8388 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3834026666715  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3993783188583  dE = -0.015975652  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4135812881823  dE = -0.014202969  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0352  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4257653436653  dE = -0.012184055  S^2 = 0.0000000
               |grad[o]|=0.0987  |ddm|=0.0239  |maxRot[o]|=0.0788
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4331103247064  dE = -0.007344981  S^2 = 0.0000000
               |grad[o]|=0.0761  |ddm|=0.0138  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4382667661324  dE = -0.0051564414  S^2 = 0.0000000
               |grad[o]|=0.0608  |ddm|=0.00523  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.442393986908  dE = -0.0041272208  S^2 = 0.0000000
               |grad[o]|=0.0498  |ddm|=0.00271  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4458545729674  dE = -0.0034605861  S^2 = 0.0000000
               |grad[o]|=0.041  |ddm|=0.00177  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4487750462219  dE = -0.0029204733  S^2 = 0.0000000
               |grad[o]|=0.0336  |ddm|=0.00136  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4512043521424  dE = -0.0024293059  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.0014  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4531589133646  dE = -0.0019545612  S^2 = 0.0000000
               |grad[o]|=0.0215  |ddm|=0.0017  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4546463623747  dE = -0.001487449  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4556728185162  dE = -0.0010264561  S^2 = 0.0000000
               |grad[o]|=0.0116  |ddm|=0.00257  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4562435543182  dE = -0.0005707358  S^2 = 0.0000000
               |grad[o]|=0.00729  |ddm|=0.00301  |maxRot[o]|=0.0799
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4563596908063  dE = -0.00011613649  S^2 = 0.0000000
               |grad[o]|=0.00332  |ddm|=0.00358  |maxRot[o]|= 0.04
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4563704186209  dE = -1.0727815e-05  S^2 = 0.0000000
               |grad[o]|=0.00122  |ddm|=0.00264  |maxRot[o]|=0.012
macro iter 16 (3 JK  0 micro), CASSCF E = -75.45637074665  dE = -3.2802907e-07  S^2 = 0.0000000
               |grad[o]|=0.000319  |ddm|=0.00144  |maxRot[o]|=0.00212
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4563707606427  dE = -1.399269e-08  S^2 = 0.0000000
               |grad[o]|=7.89e-05  |ddm|=0.000437  |maxRot[o]|=0.000387
macro iter 18 (4 JK  0 micro), CASSCF E = -75.4563707619015  dE = -1.2588401e-09  S^2 = 0.0000000
               |grad[o]|=2.14e-05  |ddm|=0.000102  |maxRot[o]|=9.72e-05
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4563707619388  dE = -3.7317704e-11  S^2 = 0.0000000
               |grad[o]|=7.14e-06  |ddm|=2.91e-05  |maxRot[o]|=1.3e-05
2-step CASSCF converged in 19 macro (98 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99022074 1.93998141 1.93998132 1.43110603 0.56650905 0.06231576
 0.06231569 0.00757   ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00012   0.00000   0.00000   0.00176  -0.00276
  0 C 2s       0.56879   0.00000   0.00000   0.43063  -0.41683
  0 C 3s      -0.05868   0.00000   0.00000   0.01038  -0.03881
  0 C 2px     -0.00000   0.00000   0.70409  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70409   0.00000   0.00000   0.00000
  0 C 2pz      0.40833   0.00000   0.00000  -0.56057   0.56889
  0 C 3px     -0.00000   0.00000  -0.05130  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.05130  -0.00000   0.00000  -0.00000
  0 C 3pz     -0.06076   0.00000  -0.00000  -0.01148  -0.03034
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.04026  -0.00000   0.00000  -0.00000
  0 C 3dz^2    0.05111   0.00000   0.00000   0.00848   0.01325
  0 C 3dxz    -0.00000   0.00000   0.04026  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00012   0.00000   0.00000  -0.00176  -0.00276
  1 C 2s       0.56879  -0.00000  -0.00000  -0.43063  -0.41683
  1 C 3s      -0.05868  -0.00000  -0.00000  -0.01038  -0.03881
  1 C 2px      0.00000  -0.00000   0.70409   0.00000   0.00000
  1 C 2py      0.00000   0.70409   0.00000   0.00000   0.00000
  1 C 2pz     -0.40833  -0.00000   0.00000  -0.56057  -0.56889
  1 C 3px      0.00000  -0.00000  -0.05130   0.00000   0.00000
  1 C 3py      0.00000  -0.05130   0.00000  -0.00000   0.00000
  1 C 3pz      0.06076   0.00000   0.00000  -0.01148   0.03034
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.04026  -0.00000   0.00000  -0.00000
  1 C 3dz^2    0.05111  -0.00000  -0.00000  -0.00848   0.01325
  1 C 3dxz    -0.00000   0.00000  -0.04026  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00109
  0 C 2s       0.00000   0.00000   0.55672
  0 C 3s      -0.00000   0.00000  -0.05173
  0 C 2px      0.70549  -0.00000   0.00000
  0 C 2py      0.00000   0.70549   0.00000
  0 C 2pz      0.00000  -0.00000   0.42574
  0 C 3px     -0.04149  -0.00000   0.00000
  0 C 3py     -0.00000  -0.04149   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01023
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02382   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.07763
  0 C 3dxz    -0.02382  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00109
  1 C 2s      -0.00000  -0.00000  -0.55672
  1 C 3s       0.00000  -0.00000   0.05173
  1 C 2px     -0.70549  -0.00000  -0.00000
  1 C 2py      0.00000  -0.70549   0.00000
  1 C 2pz      0.00000   0.00000   0.42574
  1 C 3px      0.04149   0.00000  -0.00000
  1 C 3py     -0.00000   0.04149  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01023
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.07763
  1 C 3dxz    -0.02382  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99637510
<CAS-nat-orb|mo-hf>  4  4    0.99985872
<CAS-nat-orb|mo-hf>  5  5    0.99985872
<CAS-nat-orb|mo-hf>  6  6    0.99864217
<CAS-nat-orb|mo-hf>  7  7    0.98400076
<CAS-nat-orb|mo-hf>  8  8    0.86287914
<CAS-nat-orb|mo-hf>  8  15   -0.50178788
<CAS-nat-orb|mo-hf>  9  9    0.86287908
<CAS-nat-orb|mo-hf>  9  16   -0.50178797
<CAS-nat-orb|mo-hf>  10  20   -0.76833495
CASSCF energy = -75.4563707619388
CASCI E = -75.4563707619388  E(CI) = -19.1577865225869  S^2 = 0.0000000
......production of RDMs took       2.53 sec
......reading the RDM took          0.44 sec
......production of RDMs took      98.19 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.93 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000174133
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000045995
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001219185
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000137911
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000765042
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001569161
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000523054
HMAT symm error =    0.0296704815
E(MRCI) - E(ref) = -0.1014975664437543 DC = -0.003827984489331145
E(WickICMRCISD)   = -75.55786832838258  E_corr_ci = -0.1014975664437543
E(WickICMRCISD+Q) = -75.56169631287192  E_corr_ci = -0.1053255509330854
Time cost =   3042.341
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:31:35 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.031895561294 AA    0.000000000000   0.000000000000   1.950000000000 Bohr   0.0

nuclear repulsion = 18.4615384615385
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    138382.66


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpv80i_g9k
max_memory 4000 MB (current use 8394 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9746920535549

WARN: Singularity detected in overlap matrix (condition number = 1.36e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.376946372482714  LUMO (Ag) = -0.217906597905051
cycle= 1 E= -75.2586399523512  delta_E= 0.716  |g|= 0.174  |ddm|=  1.6
HOMO (B1u) = -0.487753910327477  LUMO (Ag) = -0.11493850556452
cycle= 2 E= -75.2693410539255  delta_E= -0.0107  |g|= 0.0537  |ddm|= 0.193
HOMO (B1u) = -0.459920537702703  LUMO (Ag) = -0.0893203899470917
cycle= 3 E= -75.2703049843484  delta_E= -0.000964  |g|= 0.0148  |ddm|= 0.127
HOMO (B1u) = -0.46084545813185  LUMO (Ag) = -0.094899039815313
cycle= 4 E= -75.2704430756293  delta_E= -0.000138  |g|= 0.00223  |ddm|= 0.0758
HOMO (B1u) = -0.461426494056181  LUMO (Ag) = -0.0963896216507975
cycle= 5 E= -75.2704465290253  delta_E= -3.45e-06  |g|= 0.00039  |ddm|= 0.0164
HOMO (B1u) = -0.461398372411752  LUMO (Ag) = -0.0963285783601151
cycle= 6 E= -75.270446630032  delta_E= -1.01e-07  |g|= 2.67e-05  |ddm|= 0.00163
HOMO (B1u) = -0.461403601387683  LUMO (Ag) = -0.0963346266369837
cycle= 7 E= -75.2704466304109  delta_E= -3.79e-10  |g|= 1.62e-06  |ddm|= 0.000491
HOMO (B1u) = -0.461403547807355  LUMO (Ag) = -0.0963342779054539
cycle= 8 E= -75.2704466304119  delta_E= -1.02e-12  |g|= 1.22e-07  |ddm|= 2.97e-05
HOMO (B1u) = -0.461403551923599  LUMO (Ag) = -0.0963343022387094
cycle= 9 E= -75.2704466304118  delta_E= 4.26e-14  |g|= 8.39e-09  |ddm|= 9.29e-07
HOMO (B1u) = -0.461403550344583  LUMO (Ag) = -0.0963342976552105
cycle= 10 E= -75.2704466304119  delta_E= -1.42e-14  |g|= 6.38e-09  |ddm|= 2.4e-08
HOMO (B1u) = -0.461403550640218  LUMO (Ag) = -0.096334298127982
cycle= 11 E= -75.2704466304118  delta_E= 2.84e-14  |g|= 6.23e-10  |ddm|= 3.92e-08
HOMO (B1u) = -0.461403550656425  LUMO (Ag) = -0.0963342981381211
cycle= 12 E= -75.2704466304119  delta_E= -4.26e-14  |g|= 4.14e-10  |ddm|= 1.28e-09
HOMO (B1u) = -0.461403550671604  LUMO (Ag) = -0.0963342982119645
cycle= 13 E= -75.2704466304119  delta_E= -1.42e-14  |g|= 3.39e-10  |ddm|= 4.86e-10
HOMO (B1u) = -0.461403550622954  LUMO (Ag) = -0.0963342981468165
cycle= 14 E= -75.2704466304119  delta_E= 2.84e-14  |g|= 3.56e-10  |ddm|= 3.17e-10
HOMO (B1u) = -0.461403550574539  LUMO (Ag) = -0.096334298118238
cycle= 15 E= -75.2704466304119  delta_E= -2.84e-14  |g|= 3.81e-10  |ddm|= 1.5e-09
HOMO (B1u) = -0.46140355063151  LUMO (Ag) = -0.096334298178031
cycle= 16 E= -75.2704466304119  delta_E= 2.84e-14  |g|= 3.41e-10  |ddm|= 1.67e-09
HOMO (B1u) = -0.461403550697668  LUMO (Ag) = -0.0963342982338945
cycle= 17 E= -75.2704466304119  delta_E=    0  |g|= 4.14e-10  |ddm|= 8.7e-10
HOMO (B1u) = -0.461403550757025  LUMO (Ag) = -0.0963342982649217
cycle= 18 E= -75.270446630412  delta_E= -9.95e-14  |g|= 2.49e-10  |ddm|= 1.74e-09
HOMO (B1u) = -0.461403550722952  LUMO (Ag) = -0.0963342982337741
cycle= 19 E= -75.2704466304118  delta_E= 1.56e-13  |g|= 7.48e-11  |ddm|= 8.42e-10
HOMO (B1u) = -0.461403550718248  LUMO (Ag) = -0.0963342982287087
cycle= 20 E= -75.2704466304119  delta_E= -5.68e-14  |g|= 6.23e-11  |ddm|= 5.46e-11
HOMO (B1u) = -0.461403550714611  LUMO (Ag) = -0.096334298225299
cycle= 21 E= -75.2704466304119  delta_E=    0  |g|= 5.61e-11  |ddm|= 2.8e-11
HOMO (B1u) = -0.461403550704094  LUMO (Ag) = -0.0963342982038717
Extra cycle  E= -75.2704466304119  delta_E= -5.68e-14  |g|= 1.66e-11  |ddm|= 2.5e-10
converged SCF energy = -75.2704466304119

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpv80i_g9k
max_memory 4000 MB (current use 8394 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4235309439023  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4401092624098  dE = -0.016578319  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4547501985848  dE = -0.014640936  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0372  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4667159136163  dE = -0.011965715  S^2 = 0.0000000
               |grad[o]|=0.0972  |ddm|=0.0249  |maxRot[o]|=0.0768
macro iter 4 (6 JK  0 micro), CASSCF E = -75.473712258795  dE = -0.0069963452  S^2 = 0.0000000
               |grad[o]|=0.0746  |ddm|=0.0134  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4788049263524  dE = -0.0050926676  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.00488  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4829459326779  dE = -0.0041410063  S^2 = 0.0000000
               |grad[o]|=0.0492  |ddm|=0.00261  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4864361575754  dE = -0.0034902249  S^2 = 0.0000000
               |grad[o]|=0.0404  |ddm|=0.00172  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4893784958749  dE = -0.0029423383  S^2 = 0.0000000
               |grad[o]|=0.0329  |ddm|=0.00143  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4918065096643  dE = -0.0024280138  S^2 = 0.0000000
               |grad[o]|=0.0264  |ddm|=0.00157  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4937283511023  dE = -0.0019218414  S^2 = 0.0000000
               |grad[o]|=0.0205  |ddm|=0.00194  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4951451778586  dE = -0.0014168268  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00236  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4960589334901  dE = -0.00091375563  S^2 = 0.0000000
               |grad[o]|=0.0103  |ddm|=0.00279  |maxRot[o]|=0.0799
macro iter 13 (5 JK  0 micro), CASSCF E = -75.4964162240582  dE = -0.00035729057  S^2 = 0.0000000
               |grad[o]|=0.00583  |ddm|=0.00322  |maxRot[o]|=0.0599
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4964898775036  dE = -7.3653445e-05  S^2 = 0.0000000
               |grad[o]|=0.00261  |ddm|=0.00297  |maxRot[o]|=0.0348
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4964915866643  dE = -1.7091607e-06  S^2 = 0.0000000
               |grad[o]|=0.000642  |ddm|=0.00247  |maxRot[o]|=0.00496
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4964916468339  dE = -6.0169526e-08  S^2 = 0.0000000
               |grad[o]|=0.000154  |ddm|=0.000806  |maxRot[o]|=0.000856
macro iter 17 (4 JK  0 micro), CASSCF E = -75.4964916504806  dE = -3.6467469e-09  S^2 = 0.0000000
               |grad[o]|=3.72e-05  |ddm|=0.000211  |maxRot[o]|=0.000163
macro iter 18 (3 JK  0 micro), CASSCF E = -75.496491650584  dE = -1.0341239e-10  S^2 = 0.0000000
               |grad[o]|=7.36e-06  |ddm|=5.08e-05  |maxRot[o]|=3.49e-05
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4964916505893  dE = -5.3006488e-12  S^2 = 0.0000000
               |grad[o]|=2.03e-06  |ddm|=1.17e-05  |maxRot[o]|=6.69e-06
2-step CASSCF converged in 19 macro (97 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98968842 1.9354812  1.93548131 1.4543614  0.54286911 0.06701425
 0.06701431 0.00808999]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00041   0.00000   0.00000   0.00186  -0.00251
  0 C 2s       0.57092   0.00000   0.00000   0.44116  -0.41394
  0 C 3s      -0.05831   0.00000  -0.00000   0.01019  -0.03618
  0 C 2px      0.00000   0.00000   0.70454  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70454   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40572  -0.00000  -0.00000  -0.55236   0.57112
  0 C 3px      0.00000  -0.00000  -0.04561  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04561  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05958   0.00000  -0.00000  -0.01065  -0.03168
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.03931  -0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04991   0.00000  -0.00000   0.00767   0.01244
  0 C 3dxz     0.00000  -0.00000   0.03931  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00041   0.00000   0.00000  -0.00186  -0.00251
  1 C 2s       0.57092  -0.00000   0.00000  -0.44116  -0.41394
  1 C 3s      -0.05831  -0.00000   0.00000  -0.01019  -0.03618
  1 C 2px     -0.00000   0.00000   0.70454  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70454   0.00000   0.00000   0.00000
  1 C 2pz     -0.40572  -0.00000   0.00000  -0.55236  -0.57112
  1 C 3px     -0.00000  -0.00000  -0.04561   0.00000   0.00000
  1 C 3py      0.00000  -0.04561  -0.00000   0.00000   0.00000
  1 C 3pz      0.05958   0.00000   0.00000  -0.01065   0.03168
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03931   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04991  -0.00000  -0.00000  -0.00767   0.01244
  1 C 3dxz     0.00000   0.00000  -0.03931  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00105
  0 C 2s       0.00000   0.00000   0.54938
  0 C 3s      -0.00000  -0.00000  -0.04995
  0 C 2px      0.70564  -0.00000   0.00000
  0 C 2py     -0.00000   0.70564   0.00000
  0 C 2pz      0.00000  -0.00000   0.43709
  0 C 3px     -0.03887  -0.00000   0.00000
  0 C 3py     -0.00000  -0.03887  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.00850
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02381   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.06762
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00105
  1 C 2s       0.00000   0.00000  -0.54938
  1 C 3s      -0.00000   0.00000   0.04995
  1 C 2px     -0.70564   0.00000  -0.00000
  1 C 2py      0.00000  -0.70564  -0.00000
  1 C 2pz     -0.00000   0.00000   0.43709
  1 C 3px      0.03887   0.00000  -0.00000
  1 C 3py      0.00000   0.03887  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.00850
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02381   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.06762
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99625189
<CAS-nat-orb|mo-hf>  4  4    0.99986004
<CAS-nat-orb|mo-hf>  5  5    0.99986004
<CAS-nat-orb|mo-hf>  6  6    0.99867026
<CAS-nat-orb|mo-hf>  7  7    0.98348638
<CAS-nat-orb|mo-hf>  8  8    0.87399690
<CAS-nat-orb|mo-hf>  8  15   -0.48288166
<CAS-nat-orb|mo-hf>  9  9    0.87399699
<CAS-nat-orb|mo-hf>  9  16   -0.48288152
<CAS-nat-orb|mo-hf>  10  17    0.40709993
<CAS-nat-orb|mo-hf>  10  20   -0.75070514
CASSCF energy = -75.4964916505893
CASCI E = -75.4964916505893  E(CI) = -18.9821892359958  S^2 = 0.0000000
......production of RDMs took       1.94 sec
......reading the RDM took          0.41 sec
......production of RDMs took      72.96 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.33 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000142734
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000037701
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001478155
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000182805
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000911572
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001973328
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000657776
HMAT symm error =    0.0194296925
E(MRCI) - E(ref) = -0.1018337041284241 DC = -0.003881941916473231
E(WickICMRCISD)   = -75.59832535471774  E_corr_ci = -0.1018337041284241
E(WickICMRCISD+Q) = -75.60220729663422  E_corr_ci = -0.1057156460448973
Time cost =   3021.168
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:21:56 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.058354421840 AA    0.000000000000   0.000000000000   2.000000000000 Bohr   0.0

nuclear repulsion = 18
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 1.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    183808.29


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmprplv_uzz
max_memory 4000 MB (current use 8396 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9170535172816

WARN: Singularity detected in overlap matrix (condition number = 1.22e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.359902883841541  LUMO (Ag) = -0.213307043039728
cycle= 1 E= -75.2901241201449  delta_E= 0.627  |g|= 0.175  |ddm|= 1.58
HOMO (B1u) = -0.496094054564504  LUMO (Ag) = -0.119573071329233
cycle= 2 E= -75.3009349666093  delta_E= -0.0108  |g|= 0.0531  |ddm|= 0.188
HOMO (B1u) = -0.467321073254813  LUMO (Ag) = -0.0923011554436151
cycle= 3 E= -75.3018357121932  delta_E= -0.000901  |g|= 0.0141  |ddm|= 0.113
HOMO (B1u) = -0.467647600574111  LUMO (Ag) = -0.0969889779106467
cycle= 4 E= -75.3019617797125  delta_E= -0.000126  |g|= 0.00222  |ddm|= 0.0704
HOMO (B1u) = -0.468220968325748  LUMO (Ag) = -0.0984869419679114
cycle= 5 E= -75.3019652459277  delta_E= -3.47e-06  |g|= 0.000378  |ddm|= 0.0164
HOMO (B1u) = -0.468193490312786  LUMO (Ag) = -0.0984366742323402
cycle= 6 E= -75.3019653408538  delta_E= -9.49e-08  |g|= 2.64e-05  |ddm|= 0.00134
HOMO (B1u) = -0.468199393066117  LUMO (Ag) = -0.0984431261473197
cycle= 7 E= -75.3019653412215  delta_E= -3.68e-10  |g|= 1.72e-06  |ddm|= 0.000455
HOMO (B1u) = -0.468199353870882  LUMO (Ag) = -0.098442890784737
cycle= 8 E= -75.3019653412227  delta_E= -1.22e-12  |g|= 1.15e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.468199359870447  LUMO (Ag) = -0.0984429094364471
cycle= 9 E= -75.3019653412227  delta_E= 1.42e-14  |g|= 7.48e-09  |ddm|= 7.76e-07
HOMO (B1u) = -0.4681993578502  LUMO (Ag) = -0.0984429054950346
cycle= 10 E= -75.3019653412227  delta_E= -1.42e-14  |g|= 6.67e-09  |ddm|= 7.66e-09
HOMO (B1u) = -0.46819935819627  LUMO (Ag) = -0.0984429061772303
cycle= 11 E= -75.3019653412227  delta_E= 2.84e-14  |g|= 6.05e-10  |ddm|= 3.47e-08
HOMO (B1u) = -0.468199358177825  LUMO (Ag) = -0.0984429061457359
cycle= 12 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 3.83e-10  |ddm|= 1.62e-09
HOMO (B1u) = -0.468199358249336  LUMO (Ag) = -0.0984429062804847
cycle= 13 E= -75.3019653412227  delta_E= -8.53e-14  |g|= 3.49e-10  |ddm|= 2.01e-10
HOMO (B1u) = -0.4681993581867  LUMO (Ag) = -0.0984429062151477
cycle= 14 E= -75.3019653412227  delta_E= 4.26e-14  |g|= 3.58e-10  |ddm|= 7.2e-10
HOMO (B1u) = -0.468199358149058  LUMO (Ag) = -0.0984429062034102
cycle= 15 E= -75.3019653412227  delta_E= 1.42e-14  |g|= 3.77e-10  |ddm|= 3.87e-10
HOMO (B1u) = -0.468199358214599  LUMO (Ag) = -0.098442906243677
cycle= 16 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 2.98e-10  |ddm|= 8.77e-10
HOMO (B1u) = -0.468199358285043  LUMO (Ag) = -0.0984429063011113
cycle= 17 E= -75.3019653412226  delta_E= 5.68e-14  |g|= 4.07e-10  |ddm|= 9.51e-10
HOMO (B1u) = -0.468199358332422  LUMO (Ag) = -0.0984429063251926
cycle= 18 E= -75.3019653412227  delta_E= -4.26e-14  |g|= 2.62e-10  |ddm|= 1.08e-09
HOMO (B1u) = -0.468199358291859  LUMO (Ag) = -0.0984429062903817
cycle= 19 E= -75.3019653412226  delta_E= 8.53e-14  |g|= 7.26e-11  |ddm|= 7.04e-10
HOMO (B1u) = -0.468199358287233  LUMO (Ag) = -0.0984429062852037
cycle= 20 E= -75.3019653412227  delta_E= -1.28e-13  |g|= 6.08e-11  |ddm|= 5.25e-11
HOMO (B1u) = -0.468199358283489  LUMO (Ag) = -0.098442906281351
cycle= 21 E= -75.3019653412226  delta_E= 8.53e-14  |g|= 5.64e-11  |ddm|= 1.95e-11
HOMO (B1u) = -0.468199358282719  LUMO (Ag) = -0.0984429062787663
cycle= 22 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 4.95e-11  |ddm|= 3.87e-11
HOMO (B1u) = -0.468199358281443  LUMO (Ag) = -0.0984429062752551
cycle= 23 E= -75.3019653412227  delta_E= -1.42e-13  |g|= 4.36e-11  |ddm|= 7.85e-11
HOMO (B1u) = -0.468199358279728  LUMO (Ag) = -0.0984429062691371
cycle= 24 E= -75.3019653412227  delta_E=    0  |g|= 3.66e-11  |ddm|= 7.5e-11
HOMO (B1u) = -0.468199358278618  LUMO (Ag) = -0.0984429062634033
Extra cycle  E= -75.3019653412226  delta_E= 9.95e-14  |g|= 1.06e-11  |ddm|= 1.3e-10
converged SCF energy = -75.3019653412226

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmprplv_uzz
max_memory 4000 MB (current use 8396 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4565254955835  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4737022764209  dE = -0.017176781  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4887727731234  dE = -0.015070497  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0393  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.500289465586  dE = -0.011516692  S^2 = 0.0000000
               |grad[o]|=0.0957  |ddm|=0.0259  |maxRot[o]|=0.0795
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5070713854019  dE = -0.0067819198  S^2 = 0.0000000
               |grad[o]|=0.0736  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5121496775716  dE = -0.0050782922  S^2 = 0.0000000
               |grad[o]|=0.0594  |ddm|=0.00472  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5163277967248  dE = -0.0041781192  S^2 = 0.0000000
               |grad[o]|=0.0487  |ddm|=0.00258  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5198580737642  dE = -0.003530277  S^2 = 0.0000000
               |grad[o]|=0.0398  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5228214717522  dE = -0.002963398  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5252380577966  dE = -0.002416586  S^2 = 0.0000000
               |grad[o]|=0.0255  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5271072497574  dE = -0.001869192  S^2 = 0.0000000
               |grad[o]|=0.0195  |ddm|=0.00221  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5284243189409  dE = -0.0013170692  S^2 = 0.0000000
               |grad[o]|=0.0139  |ddm|=0.00263  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5291861870555  dE = -0.00076186811  S^2 = 0.0000000
               |grad[o]|=0.00884  |ddm|=0.00303  |maxRot[o]|=0.0798
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5293597023533  dE = -0.0001735153  S^2 = 0.0000000
               |grad[o]|=0.00413  |ddm|=0.00348  |maxRot[o]|= 0.04
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5293893921311  dE = -2.9689778e-05  S^2 = 0.0000000
               |grad[o]|=0.00175  |ddm|=0.00233  |maxRot[o]|=0.0199
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5293900606677  dE = -6.6853661e-07  S^2 = 0.0000000
               |grad[o]|=0.000422  |ddm|=0.00169  |maxRot[o]|=0.00304
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5293900835468  dE = -2.2879107e-08  S^2 = 0.0000000
               |grad[o]|=9.85e-05  |ddm|=0.000522  |maxRot[o]|=0.000505
macro iter 17 (4 JK  0 micro), CASSCF E = -75.5293900853978  dE = -1.8509922e-09  S^2 = 0.0000000
               |grad[o]|=2.92e-05  |ddm|=0.000129  |maxRot[o]|=0.000103
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5293900854447  dE = -4.6910031e-11  S^2 = 0.0000000
               |grad[o]|=7.22e-06  |ddm|=2.25e-05  |maxRot[o]|=1.27e-05
2-step CASSCF converged in 18 macro (92 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98911931 1.93077492 1.93077469 1.47651695 0.52034779 0.07191173
 0.07191148 0.00864313]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00076   0.00000   0.00000   0.00197  -0.00230
  0 C 2s       0.57327  -0.00000  -0.00000   0.45141  -0.41073
  0 C 3s      -0.05772  -0.00000   0.00000   0.00999  -0.03341
  0 C 2px     -0.00000   0.00000   0.70492   0.00000   0.00000
  0 C 2py     -0.00000   0.70492   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40282  -0.00000   0.00000  -0.54404   0.57355
  0 C 3px     -0.00000   0.00000  -0.04022   0.00000  -0.00000
  0 C 3py      0.00000  -0.04022  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05831  -0.00000   0.00000  -0.00984  -0.03298
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.03836   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04862  -0.00000   0.00000   0.00687   0.01178
  0 C 3dxz    -0.00000   0.00000   0.03836   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00076   0.00000   0.00000  -0.00197  -0.00230
  1 C 2s       0.57327   0.00000  -0.00000  -0.45141  -0.41073
  1 C 3s      -0.05772   0.00000  -0.00000  -0.00999  -0.03341
  1 C 2px      0.00000  -0.00000   0.70492  -0.00000   0.00000
  1 C 2py      0.00000   0.70492   0.00000   0.00000  -0.00000
  1 C 2pz     -0.40282   0.00000   0.00000  -0.54404  -0.57355
  1 C 3px      0.00000  -0.00000  -0.04022  -0.00000  -0.00000
  1 C 3py      0.00000  -0.04022  -0.00000   0.00000   0.00000
  1 C 3pz      0.05831  -0.00000   0.00000  -0.00984   0.03298
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03836   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04862   0.00000  -0.00000  -0.00687   0.01178
  1 C 3dxz    -0.00000   0.00000  -0.03836   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00101
  0 C 2s      -0.00000  -0.00000   0.54172
  0 C 3s       0.00000  -0.00000  -0.04839
  0 C 2px      0.70576   0.00000   0.00000
  0 C 2py      0.00000   0.70576  -0.00000
  0 C 2pz     -0.00000   0.00000   0.44796
  0 C 3px     -0.03649  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03649  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00649
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02381  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.05909
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00101
  1 C 2s      -0.00000   0.00000  -0.54172
  1 C 3s      -0.00000   0.00000   0.04839
  1 C 2px     -0.70576   0.00000   0.00000
  1 C 2py      0.00000  -0.70576  -0.00000
  1 C 2pz      0.00000   0.00000   0.44796
  1 C 3px      0.03649   0.00000  -0.00000
  1 C 3py     -0.00000   0.03649   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00649
  1 C 3dxy    -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02381  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.05909
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99610896
<CAS-nat-orb|mo-hf>  4  4    0.99985893
<CAS-nat-orb|mo-hf>  5  5    0.99985893
<CAS-nat-orb|mo-hf>  6  6    0.99868926
<CAS-nat-orb|mo-hf>  7  7    0.98295350
<CAS-nat-orb|mo-hf>  8  8    0.88422791
<CAS-nat-orb|mo-hf>  8  15   -0.46451001
<CAS-nat-orb|mo-hf>  9  9    0.88422777
<CAS-nat-orb|mo-hf>  9  16   -0.46451027
<CAS-nat-orb|mo-hf>  10  17    0.44059970
<CAS-nat-orb|mo-hf>  10  20   -0.73158913
CASSCF energy = -75.5293900854447
CASCI E = -75.5293900854447  E(CI) = -18.8101054812133  S^2 = 0.0000000
......production of RDMs took       2.69 sec
......reading the RDM took          0.55 sec
......production of RDMs took      30.86 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.47 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000067513
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000017833
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001082531
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000134538
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000665513
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001495437
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000498479
HMAT symm error =    0.0414948135
E(MRCI) - E(ref) = -0.1021505992286365 DC = -0.003934014318397503
E(WickICMRCISD)   = -75.63154068467338  E_corr_ci = -0.1021505992286365
E(WickICMRCISD+Q) = -75.63547469899179  E_corr_ci = -0.106084613547034
Time cost =   2788.170
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:08:24 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.084813282386 AA    0.000000000000   0.000000000000   2.050000000000 Bohr   0.0

nuclear repulsion = 17.5609756097561
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    228276.45


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpk3xybp40
max_memory 4000 MB (current use 8388 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8587717717965

WARN: Singularity detected in overlap matrix (condition number = 1.1e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.343801090949931  LUMO (Ag) = -0.208899636382795
cycle= 1 E= -75.3152287127073  delta_E= 0.544  |g|= 0.177  |ddm|= 1.56
HOMO (B1u) = -0.504407518465331  LUMO (Ag) = -0.123879990102774
cycle= 2 E= -75.326251581953  delta_E= -0.011  |g|= 0.0526  |ddm|= 0.188
HOMO (B1u) = -0.474708360691125  LUMO (Ag) = -0.0950218080877935
cycle= 3 E= -75.3271055696138  delta_E= -0.000854  |g|= 0.0134  |ddm|= 0.101
HOMO (B1u) = -0.474494822450148  LUMO (Ag) = -0.0988363835418916
cycle= 4 E= -75.3272181663453  delta_E= -0.000113  |g|= 0.00221  |ddm|= 0.0646
HOMO (B1u) = -0.475044448091171  LUMO (Ag) = -0.100314895198609
cycle= 5 E= -75.3272215916786  delta_E= -3.43e-06  |g|= 0.000363  |ddm|= 0.0164
HOMO (B1u) = -0.475018098728987  LUMO (Ag) = -0.100277615221357
cycle= 6 E= -75.3272216794877  delta_E= -8.78e-08  |g|= 2.61e-05  |ddm|= 0.00103
HOMO (B1u) = -0.475024517384062  LUMO (Ag) = -0.100284470661359
cycle= 7 E= -75.3272216798442  delta_E= -3.56e-10  |g|= 1.87e-06  |ddm|= 0.000419
HOMO (B1u) = -0.475024512000407  LUMO (Ag) = -0.100284344431205
cycle= 8 E= -75.3272216798456  delta_E= -1.42e-12  |g|= 1.12e-07  |ddm|= 3.22e-05
HOMO (B1u) = -0.475024518733667  LUMO (Ag) = -0.100284359326606
cycle= 9 E= -75.3272216798456  delta_E=    0  |g|= 7.12e-09  |ddm|= 6.36e-07
HOMO (B1u) = -0.475024516372406  LUMO (Ag) = -0.100284355800601
cycle= 10 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 6.88e-09  |ddm|= 8.6e-09
HOMO (B1u) = -0.475024518411257  LUMO (Ag) = -0.100284358870979
cycle= 11 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 5.9e-09  |ddm|= 2.94e-08
HOMO (B1u) = -0.47502451677225  LUMO (Ag) = -0.100284356674954
cycle= 12 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 5.27e-10  |ddm|= 7.3e-09
HOMO (B1u) = -0.475024516786975  LUMO (Ag) = -0.100284356796285
cycle= 13 E= -75.3272216798456  delta_E= -5.68e-14  |g|= 5.14e-10  |ddm|= 1.16e-09
HOMO (B1u) = -0.475024516697171  LUMO (Ag) = -0.100284356701326
cycle= 14 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 5.68e-10  |ddm|= 1.33e-09
HOMO (B1u) = -0.475024516687892  LUMO (Ag) = -0.100284356713633
cycle= 15 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 5.39e-10  |ddm|= 7.86e-10
HOMO (B1u) = -0.475024516721546  LUMO (Ag) = -0.100284356696744
cycle= 16 E= -75.3272216798457  delta_E= -1.14e-13  |g|= 4.35e-10  |ddm|= 4.09e-09
HOMO (B1u) = -0.475024516863632  LUMO (Ag) = -0.100284356808633
cycle= 17 E= -75.3272216798455  delta_E= 1.99e-13  |g|= 5.68e-10  |ddm|= 1.78e-09
HOMO (B1u) = -0.475024516900882  LUMO (Ag) = -0.100284356827834
cycle= 18 E= -75.3272216798456  delta_E= -1.14e-13  |g|= 4.14e-10  |ddm|= 6.15e-10
HOMO (B1u) = -0.47502451685605  LUMO (Ag) = -0.100284356793194
cycle= 19 E= -75.3272216798457  delta_E= -5.68e-14  |g|= 2.33e-10  |ddm|= 5.24e-10
HOMO (B1u) = -0.475024516880725  LUMO (Ag) = -0.100284356813854
cycle= 20 E= -75.3272216798456  delta_E= 1.14e-13  |g|= 9.92e-11  |ddm|= 2.28e-10
HOMO (B1u) = -0.47502451687624  LUMO (Ag) = -0.100284356809379
cycle= 21 E= -75.3272216798456  delta_E= -7.11e-14  |g|= 9.28e-11  |ddm|= 3.17e-11
HOMO (B1u) = -0.475024516875595  LUMO (Ag) = -0.100284356804496
cycle= 22 E= -75.3272216798456  delta_E= 4.26e-14  |g|= 8.18e-11  |ddm|= 9.72e-11
HOMO (B1u) = -0.475024516873796  LUMO (Ag) = -0.100284356797744
cycle= 23 E= -75.3272216798456  delta_E=    0  |g|= 7.1e-11  |ddm|= 1.6e-10
HOMO (B1u) = -0.475024516865124  LUMO (Ag) = -0.100284356774914
Extra cycle  E= -75.3272216798456  delta_E= -5.68e-14  |g|= 2.34e-11  |ddm|= 2.11e-10
converged SCF energy = -75.3272216798456

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpk3xybp40
max_memory 4000 MB (current use 8388 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4833111059062  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5010811240502  dE = -0.017770018  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5165754584881  dE = -0.015494334  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0415  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5274381013715  dE = -0.010862643  S^2 = 0.0000000
               |grad[o]|=0.0942  |ddm|=0.0269  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5341182018702  dE = -0.0066801005  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0121  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5392283075042  dE = -0.0051101056  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00475  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5434666952106  dE = -0.0042383877  S^2 = 0.0000000
               |grad[o]|=0.0483  |ddm|=0.00267  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5470469288635  dE = -0.0035802337  S^2 = 0.0000000
               |grad[o]|=0.0393  |ddm|=0.00189  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5500288114227  dE = -0.0029818826  S^2 = 0.0000000
               |grad[o]|=0.0315  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5524207857492  dE = -0.0023919743  S^2 = 0.0000000
               |grad[o]|=0.0246  |ddm|=0.0021  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5542124364647  dE = -0.0017916507  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.555393174804  dE = -0.0011807383  S^2 = 0.0000000
               |grad[o]|=0.0125  |ddm|=0.00293  |maxRot[o]|=0.0798
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5559528169972  dE = -0.00055964219  S^2 = 0.0000000
               |grad[o]|=0.0071  |ddm|=0.00332  |maxRot[o]|=0.0798
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5559944765629  dE = -4.1659566e-05  S^2 = 0.0000000
               |grad[o]|=0.00221  |ddm|=0.00383  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5559984890054  dE = -4.0124425e-06  S^2 = 0.0000000
               |grad[o]|=0.00082  |ddm|=0.00163  |maxRot[o]|=0.00754
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5559985877639  dE = -9.8758434e-08  S^2 = 0.0000000
               |grad[o]|=0.000181  |ddm|=0.000852  |maxRot[o]|=0.00113
macro iter 16 (4 JK  0 micro), CASSCF E = -75.5559985922054  dE = -4.4415742e-09  S^2 = 0.0000000
               |grad[o]|=4.32e-05  |ddm|=0.000229  |maxRot[o]|=0.000181
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5559985923264  dE = -1.2093437e-10  S^2 = 0.0000000
               |grad[o]|=7.82e-06  |ddm|=5.11e-05  |maxRot[o]|=3.83e-05
macro iter 18 (3 JK  0 micro), CASSCF E = -75.555998592333  dE = -6.5938366e-12  S^2 = 0.0000000
               |grad[o]|=1.56e-06  |ddm|=5.01e-06  |maxRot[o]|=6.03e-06
2-step CASSCF converged in 18 macro (91 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98851474 1.92585844 1.92585837 1.49745743 0.49906983 0.07700632
 0.07700619 0.00922867]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00113   0.00000   0.00000   0.00208  -0.00211
  0 C 2s       0.57579   0.00000  -0.00000   0.46137  -0.40723
  0 C 3s      -0.05693  -0.00000  -0.00000   0.00979  -0.03053
  0 C 2px     -0.00000   0.00000   0.70524  -0.00000   0.00000
  0 C 2py      0.00000   0.70524   0.00000  -0.00000  -0.00000
  0 C 2pz      0.39967   0.00000   0.00000  -0.53564   0.57613
  0 C 3px     -0.00000   0.00000  -0.03513  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03513   0.00000   0.00000  -0.00000
  0 C 3pz     -0.05695  -0.00000   0.00000  -0.00906  -0.03424
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.03742   0.00000   0.00000  -0.00000
  0 C 3dz^2    0.04728  -0.00000   0.00000   0.00608   0.01129
  0 C 3dxz    -0.00000   0.00000   0.03742  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00113   0.00000   0.00000  -0.00208  -0.00211
  1 C 2s       0.57579   0.00000  -0.00000  -0.46137  -0.40723
  1 C 3s      -0.05693   0.00000   0.00000  -0.00979  -0.03053
  1 C 2px      0.00000  -0.00000   0.70524   0.00000   0.00000
  1 C 2py      0.00000   0.70524  -0.00000  -0.00000   0.00000
  1 C 2pz     -0.39967   0.00000  -0.00000  -0.53564  -0.57613
  1 C 3px      0.00000  -0.00000  -0.03513   0.00000  -0.00000
  1 C 3py      0.00000  -0.03513  -0.00000   0.00000   0.00000
  1 C 3pz      0.05695  -0.00000  -0.00000  -0.00906   0.03424
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.03742   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04728  -0.00000   0.00000  -0.00608   0.01129
  1 C 3dxz    -0.00000   0.00000  -0.03742  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00097
  0 C 2s      -0.00000   0.00000   0.53380
  0 C 3s      -0.00000   0.00000  -0.04704
  0 C 2px      0.70587   0.00000  -0.00000
  0 C 2py      0.00000   0.70587   0.00000
  0 C 2pz     -0.00000  -0.00000   0.45840
  0 C 3px     -0.03434   0.00000  -0.00000
  0 C 3py      0.00000  -0.03434  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.00431
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.05187
  0 C 3dxz    -0.02382  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00097
  1 C 2s       0.00000  -0.00000  -0.53380
  1 C 3s       0.00000  -0.00000   0.04704
  1 C 2px     -0.70587   0.00000   0.00000
  1 C 2py     -0.00000  -0.70587   0.00000
  1 C 2pz      0.00000   0.00000   0.45840
  1 C 3px      0.03434  -0.00000   0.00000
  1 C 3py     -0.00000   0.03434   0.00000
  1 C 3pz     -0.00000   0.00000  -0.00431
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.05187
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99594658
<CAS-nat-orb|mo-hf>  4  4    0.99985545
<CAS-nat-orb|mo-hf>  5  5    0.99985545
<CAS-nat-orb|mo-hf>  6  6    0.99869864
<CAS-nat-orb|mo-hf>  7  7    0.98240655
<CAS-nat-orb|mo-hf>  8  8    0.89361614
<CAS-nat-orb|mo-hf>  8  15   -0.44672575
<CAS-nat-orb|mo-hf>  9  9    0.89361610
<CAS-nat-orb|mo-hf>  9  16   -0.44672583
<CAS-nat-orb|mo-hf>  10  17    0.47419762
<CAS-nat-orb|mo-hf>  10  20   -0.71074897
CASSCF energy = -75.555998592333
CASCI E = -75.555998592333  E(CI) = -18.641690800755  S^2 = 0.0000000
......production of RDMs took       3.31 sec
......reading the RDM took          0.47 sec
......production of RDMs took      31.47 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.78 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000187076
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000049413
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001036742
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000111285
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000657930
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001425874
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000475291
HMAT symm error =    0.0210268043
E(MRCI) - E(ref) = -0.1024507580085441 DC = -0.003984437475042263
E(WickICMRCISD)   = -75.6584493503415  E_corr_ci = -0.1024507580085441
E(WickICMRCISD+Q) = -75.66243378781654  E_corr_ci = -0.1064351954835863
Time cost =   2998.408
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:58:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.111272142932 AA    0.000000000000   0.000000000000   2.100000000000 Bohr   0.0

nuclear repulsion = 17.1428571428571
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    277363.11


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmph1pf9pmk
max_memory 4000 MB (current use 8396 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8003866027882

WARN: Singularity detected in overlap matrix (condition number =  999). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.32858894486889  LUMO (Ag) = -0.204693729619157
cycle= 1 E= -75.3347800230759  delta_E= 0.466  |g|= 0.18  |ddm|= 1.55
HOMO (B1u) = -0.512671455628693  LUMO (Ag) = -0.127860887413406
cycle= 2 E= -75.346109112634  delta_E= -0.0113  |g|= 0.0522  |ddm|= 0.19
HOMO (B1u) = -0.482062537885922  LUMO (Ag) = -0.097476944519184
cycle= 3 E= -75.3469306677087  delta_E= -0.000822  |g|= 0.0126  |ddm|= 0.0913
HOMO (B1u) = -0.481374466024948  LUMO (Ag) = -0.100457341704975
cycle= 4 E= -75.3470296424032  delta_E= -9.9e-05  |g|= 0.00217  |ddm|= 0.0587
HOMO (B1u) = -0.481886259872507  LUMO (Ag) = -0.101886818572125
cycle= 5 E= -75.3470329570725  delta_E= -3.31e-06  |g|= 0.000344  |ddm|= 0.0161
HOMO (B1u) = -0.481861583616576  LUMO (Ag) = -0.101865081893001
cycle= 6 E= -75.3470330362213  delta_E= -7.91e-08  |g|= 2.58e-05  |ddm|= 0.000729
HOMO (B1u) = -0.481868355987196  LUMO (Ag) = -0.101872367771491
cycle= 7 E= -75.3470330365669  delta_E= -3.46e-10  |g|= 2.05e-06  |ddm|= 0.000385
HOMO (B1u) = -0.481868395860479  LUMO (Ag) = -0.101872342919466
cycle= 8 E= -75.3470330365685  delta_E= -1.68e-12  |g|= 1.14e-07  |ddm|= 3.34e-05
HOMO (B1u) = -0.481868402323703  LUMO (Ag) = -0.101872355528156
cycle= 9 E= -75.3470330365685  delta_E= 2.84e-14  |g|= 7.18e-09  |ddm|= 5.08e-07
HOMO (B1u) = -0.481868399652581  LUMO (Ag) = -0.101872352083975
cycle= 10 E= -75.3470330365686  delta_E= -9.95e-14  |g|= 7.13e-09  |ddm|= 1.12e-08
HOMO (B1u) = -0.481868400187874  LUMO (Ag) = -0.10187235326224
cycle= 11 E= -75.3470330365686  delta_E= -1.42e-14  |g|= 6.89e-10  |ddm|= 1.92e-08
HOMO (B1u) = -0.481868400167163  LUMO (Ag) = -0.101872353238043
cycle= 12 E= -75.3470330365686  delta_E= 2.84e-14  |g|= 4.28e-10  |ddm|= 1.88e-09
HOMO (B1u) = -0.48186840019363  LUMO (Ag) = -0.101872353313131
cycle= 13 E= -75.3470330365686  delta_E=    0  |g|= 4.17e-10  |ddm|= 9.79e-10
HOMO (B1u) = -0.481868400173097  LUMO (Ag) = -0.101872353275869
cycle= 14 E= -75.3470330365685  delta_E= 8.53e-14  |g|= 3.67e-10  |ddm|= 1.28e-10
HOMO (B1u) = -0.481868400169247  LUMO (Ag) = -0.101872353281095
cycle= 15 E= -75.3470330365686  delta_E= -4.26e-14  |g|= 3.32e-10  |ddm|= 1.88e-10
HOMO (B1u) = -0.481868400196784  LUMO (Ag) = -0.101872353279107
cycle= 16 E= -75.3470330365686  delta_E= -2.84e-14  |g|= 2.86e-10  |ddm|= 1.66e-09
HOMO (B1u) = -0.481868400273185  LUMO (Ag) = -0.101872353333381
cycle= 17 E= -75.3470330365686  delta_E= -4.26e-14  |g|= 4.38e-10  |ddm|= 7.99e-10
HOMO (B1u) = -0.481868400301211  LUMO (Ag) = -0.101872353344063
cycle= 18 E= -75.3470330365686  delta_E= 4.26e-14  |g|= 2.9e-10  |ddm|= 3.37e-10
HOMO (B1u) = -0.481868400249901  LUMO (Ag) = -0.10187235330532
cycle= 19 E= -75.3470330365686  delta_E= 1.42e-14  |g|= 7.98e-11  |ddm|= 4.1e-10
HOMO (B1u) = -0.481868400246859  LUMO (Ag) = -0.101872353300952
cycle= 20 E= -75.3470330365686  delta_E=    0  |g|= 6.62e-11  |ddm|= 4.53e-11
HOMO (B1u) = -0.481868400243209  LUMO (Ag) = -0.101872353286215
Extra cycle  E= -75.3470330365686  delta_E=    0  |g|= 1.85e-11  |ddm|= 1.69e-10
converged SCF energy = -75.3470330365686

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmph1pf9pmk
max_memory 4000 MB (current use 8396 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5047007388544  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5230583899011  dE = -0.018357651  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5389743488818  dE = -0.015915959  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5492372330031  dE = -0.010262884  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.028  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.555844764685  dE = -0.0066075317  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5609981178399  dE = -0.0051533532  S^2 = 0.0000000
               |grad[o]|=0.0585  |ddm|=0.00486  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5652967728309  dE = -0.004298655  S^2 = 0.0000000
               |grad[o]|=0.0476  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5689147822834  dE = -0.0036180095  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5718913796566  dE = -0.0029765974  S^2 = 0.0000000
               |grad[o]|=0.0304  |ddm|=0.00212  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5742210210795  dE = -0.0023296414  S^2 = 0.0000000
               |grad[o]|=0.0232  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.575883190434  dE = -0.0016621694  S^2 = 0.0000000
               |grad[o]|=0.0166  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.576860442084  dE = -0.00097725165  S^2 = 0.0000000
               |grad[o]|=0.0106  |ddm|=0.00327  |maxRot[o]|=0.0798
macro iter 12 (5 JK  0 micro), CASSCF E = -75.5771322750623  dE = -0.00027183298  S^2 = 0.0000000
               |grad[o]|=0.00491  |ddm|=0.00368  |maxRot[o]|=0.0599
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5771370896574  dE = -4.8145951e-06  S^2 = 0.0000000
               |grad[o]|=0.00106  |ddm|=0.0034  |maxRot[o]|=0.00815
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5771372175538  dE = -1.278964e-07  S^2 = 0.0000000
               |grad[o]|=0.000228  |ddm|=0.00108  |maxRot[o]|=0.00122
macro iter 15 (4 JK  0 micro), CASSCF E = -75.5771372234019  dE = -5.8481362e-09  S^2 = 0.0000000
               |grad[o]|=5.05e-05  |ddm|=0.000271  |maxRot[o]|=0.000195
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5771372235454  dE = -1.4344437e-10  S^2 = 0.0000000
               |grad[o]|=9.34e-06  |ddm|=5.42e-05  |maxRot[o]|=3.55e-05
macro iter 17 (3 JK  0 micro), CASSCF E = -75.577137223552  dE = -6.65068e-12  S^2 = 0.0000000
               |grad[o]|=2.15e-06  |ddm|=1.24e-05  |maxRot[o]|=7.05e-06
2-step CASSCF converged in 17 macro (87 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98787579 1.92072813 1.92072838 1.51715864 0.47907    0.08229644
 0.08229649 0.00984613]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00153   0.00000   0.00000   0.00220  -0.00194
  0 C 2s       0.57846  -0.00000  -0.00000   0.47106  -0.40350
  0 C 3s      -0.05596  -0.00000  -0.00000   0.00960  -0.02757
  0 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  0 C 2py      0.00000   0.70551  -0.00000  -0.00000   0.00000
  0 C 2pz      0.39631   0.00000  -0.00000  -0.52717   0.57883
  0 C 3px     -0.00000   0.00000  -0.03031   0.00000  -0.00000
  0 C 3py      0.00000  -0.03031  -0.00000   0.00000   0.00000
  0 C 3pz     -0.05553  -0.00000  -0.00000  -0.00832  -0.03544
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.03648  -0.00000   0.00000   0.00000
  0 C 3dz^2    0.04590  -0.00000  -0.00000   0.00531   0.01098
  0 C 3dxz     0.00000   0.00000   0.03648   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00153   0.00000   0.00000  -0.00220  -0.00194
  1 C 2s       0.57846   0.00000   0.00000  -0.47106  -0.40350
  1 C 3s      -0.05596   0.00000   0.00000  -0.00960  -0.02757
  1 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70551  -0.00000  -0.00000  -0.00000
  1 C 2pz     -0.39631   0.00000   0.00000  -0.52717  -0.57883
  1 C 3px     -0.00000   0.00000  -0.03031  -0.00000   0.00000
  1 C 3py     -0.00000  -0.03031   0.00000  -0.00000  -0.00000
  1 C 3pz      0.05553  -0.00000  -0.00000  -0.00832   0.03544
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.03648  -0.00000   0.00000   0.00000
  1 C 3dz^2    0.04590   0.00000   0.00000  -0.00531   0.01098
  1 C 3dxz     0.00000  -0.00000  -0.03648   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00092
  0 C 2s       0.00000  -0.00000   0.52568
  0 C 3s      -0.00000   0.00000  -0.04590
  0 C 2px      0.70596  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70596  -0.00000
  0 C 2pz     -0.00000   0.00000   0.46846
  0 C 3px     -0.03238  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03238   0.00000
  0 C 3pz     -0.00000   0.00000  -0.00204
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02383   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.04579
  0 C 3dxz    -0.02383  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00092
  1 C 2s       0.00000  -0.00000  -0.52568
  1 C 3s       0.00000  -0.00000   0.04590
  1 C 2px     -0.70596   0.00000   0.00000
  1 C 2py      0.00000  -0.70596  -0.00000
  1 C 2pz     -0.00000  -0.00000   0.46846
  1 C 3px      0.03238   0.00000   0.00000
  1 C 3py      0.00000   0.03238   0.00000
  1 C 3pz      0.00000   0.00000  -0.00204
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02383  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04579
  1 C 3dxz    -0.02383  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99576518
<CAS-nat-orb|mo-hf>  4  4    0.99984965
<CAS-nat-orb|mo-hf>  5  5    0.99984965
<CAS-nat-orb|mo-hf>  6  6    0.99869802
<CAS-nat-orb|mo-hf>  7  7    0.98184922
<CAS-nat-orb|mo-hf>  8  8    0.90221124
<CAS-nat-orb|mo-hf>  8  15   -0.42956747
<CAS-nat-orb|mo-hf>  9  9    0.90221131
<CAS-nat-orb|mo-hf>  9  16   -0.42956735
<CAS-nat-orb|mo-hf>  10  10    0.40783679
<CAS-nat-orb|mo-hf>  10  17    0.50741117
<CAS-nat-orb|mo-hf>  10  20   -0.68802314
CASSCF energy = -75.577137223552
CASCI E = -75.577137223552  E(CI) = -18.4770625199486  S^2 = 0.0000000
......production of RDMs took       2.59 sec
......reading the RDM took          0.45 sec
......production of RDMs took      31.02 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.85 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000234144
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000061846
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001453027
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000175288
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000905844
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001899224
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000633075
HMAT symm error =    0.0240809764
E(MRCI) - E(ref) = -0.1027367720887469 DC = -0.004033489019794607
E(WickICMRCISD)   = -75.67987399564078  E_corr_ci = -0.1027367720887469
E(WickICMRCISD+Q) = -75.68390748466057  E_corr_ci = -0.1067702611085415
Time cost =   3058.666
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:49:22 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.137731003478 AA    0.000000000000   0.000000000000   2.150000000000 Bohr   0.0

nuclear repulsion = 16.7441860465116
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    325466.93


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmppn080lli
max_memory 4000 MB (current use 8388 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.742346402077

WARN: Singularity detected in overlap matrix (condition number =  905). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.314216447683401  LUMO (Ag) = -0.200692527520578
cycle= 1 E= -75.349511035823  delta_E= 0.393  |g|= 0.183  |ddm|= 1.54
HOMO (B3u) = -0.511968787672978  LUMO (Ag) = -0.131517049931572
cycle= 2 E= -75.361230819294  delta_E= -0.0117  |g|= 0.052  |ddm|= 0.195
HOMO (B2u) = -0.477859245905663  LUMO (Ag) = -0.099664307632512
cycle= 3 E= -75.3620321930707  delta_E= -0.000801  |g|= 0.0118  |ddm|= 0.0834
HOMO (B2u) = -0.480852254510821  LUMO (Ag) = -0.101863987618504
cycle= 4 E= -75.3621184017556  delta_E= -8.62e-05  |g|= 0.00212  |ddm|= 0.0529
HOMO (B3u) = -0.481684500444459  LUMO (Ag) = -0.103214149326984
cycle= 5 E= -75.3621215318461  delta_E= -3.13e-06  |g|= 0.000318  |ddm|= 0.0156
HOMO (B2u) = -0.481600836313231  LUMO (Ag) = -0.103210190493484
cycle= 6 E= -75.3621216003492  delta_E= -6.85e-08  |g|= 2.54e-05  |ddm|= 0.000515
HOMO (B2u) = -0.481601754909294  LUMO (Ag) = -0.103217967965927
cycle= 7 E= -75.3621216006849  delta_E= -3.36e-10  |g|= 2.23e-06  |ddm|= 0.00035
HOMO (B2u) = -0.48160198740666  LUMO (Ag) = -0.10321803452051
cycle= 8 E= -75.3621216006869  delta_E= -2.02e-12  |g|= 1.23e-07  |ddm|= 3.4e-05
HOMO (B2u) = -0.481601999517358  LUMO (Ag) = -0.103218045659584
cycle= 9 E= -75.362121600687  delta_E= -5.68e-14  |g|= 7.62e-09  |ddm|= 3.86e-07
HOMO (B3u) = -0.481601998065172  LUMO (Ag) = -0.103218041944468
cycle= 10 E= -75.3621216006869  delta_E= 8.53e-14  |g|= 7.43e-09  |ddm|= 1.11e-08
HOMO (B3u) = -0.481601999747066  LUMO (Ag) = -0.103218043391464
cycle= 11 E= -75.3621216006869  delta_E=    0  |g|= 6.97e-10  |ddm|= 1.25e-08
HOMO (B3u) = -0.481601999838111  LUMO (Ag) = -0.103218043447817
cycle= 12 E= -75.362121600687  delta_E= -1.14e-13  |g|= 4.94e-10  |ddm|= 2.23e-09
HOMO (B2u) = -0.481601999861622  LUMO (Ag) = -0.103218043480368
cycle= 13 E= -75.362121600687  delta_E= -4.26e-14  |g|= 4.81e-10  |ddm|= 1.52e-09
HOMO (B3u) = -0.481601999857516  LUMO (Ag) = -0.103218043468433
cycle= 14 E= -75.3621216006869  delta_E= 1.28e-13  |g|= 3.93e-10  |ddm|= 6.49e-10
HOMO (B3u) = -0.481601999868634  LUMO (Ag) = -0.103218043468031
cycle= 15 E= -75.362121600687  delta_E= -4.26e-14  |g|= 3.57e-10  |ddm|= 4.22e-10
HOMO (B3u) = -0.481601999841291  LUMO (Ag) = -0.103218043457583
cycle= 16 E= -75.362121600687  delta_E= -1.42e-14  |g|= 3.06e-10  |ddm|= 1.6e-09
HOMO (B3u) = -0.481601999854675  LUMO (Ag) = -0.103218043505538
cycle= 17 E= -75.362121600687  delta_E=    0  |g|= 4.61e-10  |ddm|= 6.95e-10
HOMO (B3u) = -0.481601999903114  LUMO (Ag) = -0.10321804351029
cycle= 18 E= -75.3621216006869  delta_E= 2.84e-14  |g|= 3e-10  |ddm|= 2.69e-10
HOMO (B3u) = -0.481601999880011  LUMO (Ag) = -0.103218043469277
cycle= 19 E= -75.362121600687  delta_E= -2.84e-14  |g|= 8.36e-11  |ddm|= 4.6e-10
HOMO (B3u) = -0.481601999875235  LUMO (Ag) = -0.103218043464456
cycle= 20 E= -75.3621216006869  delta_E= 4.26e-14  |g|= 7.18e-11  |ddm|= 4.74e-11
HOMO (B3u) = -0.481601999874252  LUMO (Ag) = -0.103218043462761
cycle= 21 E= -75.3621216006868  delta_E= 8.53e-14  |g|= 6.31e-11  |ddm|= 1.52e-11
HOMO (B3u) = -0.481601999872586  LUMO (Ag) = -0.103218043459745
cycle= 22 E= -75.3621216006869  delta_E= -9.95e-14  |g|= 5.25e-11  |ddm|= 6.22e-11
HOMO (B3u) = -0.481601999871144  LUMO (Ag) = -0.10321804345745
cycle= 23 E= -75.3621216006869  delta_E= 5.68e-14  |g|= 4.41e-11  |ddm|= 4.14e-11
HOMO (B3u) = -0.481601999869577  LUMO (Ag) = -0.10321804345526
cycle= 24 E= -75.3621216006868  delta_E= 5.68e-14  |g|= 3.87e-11  |ddm|= 5.73e-11
HOMO (B3u) = -0.481601999868688  LUMO (Ag) = -0.103218043453321
cycle= 25 E= -75.3621216006868  delta_E= -1.42e-14  |g|= 3.32e-11  |ddm|= 1.29e-11
HOMO (B3u) = -0.481601999869884  LUMO (Ag) = -0.103218043451912
cycle= 26 E= -75.3621216006868  delta_E= 4.26e-14  |g|= 2.02e-11  |ddm|= 2.44e-11
HOMO (B3u) = -0.481601999871867  LUMO (Ag) = -0.103218043452548
cycle= 27 E= -75.3621216006868  delta_E= -2.84e-14  |g|= 1.42e-11  |ddm|= 1.94e-11
HOMO (B3u) = -0.481601999872069  LUMO (Ag) = -0.103218043452275
cycle= 28 E= -75.3621216006867  delta_E= 8.53e-14  |g|= 1.2e-11  |ddm|= 6.03e-12
HOMO (B3u) = -0.48160199987213  LUMO (Ag) = -0.103218043451906
cycle= 29 E= -75.3621216006868  delta_E= -8.53e-14  |g|= 9.99e-12  |ddm|= 4.15e-12
HOMO (B3u) = -0.481601999872158  LUMO (Ag) = -0.103218043451539
cycle= 30 E= -75.3621216006869  delta_E= -2.84e-14  |g|= 8.16e-12  |ddm|= 7.6e-12
HOMO (B3u) = -0.481601999872179  LUMO (Ag) = -0.103218043451227
cycle= 31 E= -75.3621216006867  delta_E= 1.42e-13  |g|= 7.06e-12  |ddm|= 4.59e-12
HOMO (B3u) = -0.481601999872188  LUMO (Ag) = -0.103218043450944
cycle= 32 E= -75.3621216006861  delta_E= 6.25e-13  |g|= 1.32e-11  |ddm|= 2.1e-12
HOMO (B3u) = -0.481601999872164  LUMO (Ag) = -0.103218043450707
cycle= 33 E= -75.362121600686  delta_E= 5.68e-14  |g|= 1.18e-11  |ddm|= 1.99e-11
HOMO (B3u) = -0.48160199987211  LUMO (Ag) = -0.10321804345049
cycle= 34 E= -75.362121600686  delta_E= 8.53e-14  |g|= 1.06e-11  |ddm|= 1.94e-11
HOMO (B3u) = -0.481601999872017  LUMO (Ag) = -0.10321804345032
cycle= 35 E= -75.3621216006859  delta_E= 5.68e-14  |g|= 9.41e-12  |ddm|= 2.06e-11
HOMO (B3u) = -0.481601999871938  LUMO (Ag) = -0.103218043450183
cycle= 36 E= -75.362121600686  delta_E= -1.28e-13  |g|= 8.13e-12  |ddm|= 2.19e-11
HOMO (B3u) = -0.481601999871862  LUMO (Ag) = -0.103218043450047
cycle= 37 E= -75.362121600686  delta_E= 1.42e-14  |g|= 6.76e-12  |ddm|= 2.37e-11
HOMO (B3u) = -0.481601999871783  LUMO (Ag) = -0.103218043449911
cycle= 38 E= -75.362121600686  delta_E= -1.42e-14  |g|= 5.42e-12  |ddm|= 2.32e-11
HOMO (B3u) = -0.481601999871699  LUMO (Ag) = -0.10321804344979
cycle= 39 E= -75.3621216006861  delta_E= -4.26e-14  |g|= 4.06e-12  |ddm|= 2.4e-11
HOMO (B2u) = -0.481601999871612  LUMO (Ag) = -0.103218043449676
cycle= 40 E= -75.362121600686  delta_E= 8.53e-14  |g|= 2.8e-12  |ddm|= 2.61e-11
HOMO (B2u) = -0.481601999871557  LUMO (Ag) = -0.103218043449563
cycle= 41 E= -75.3621216006861  delta_E= -1.14e-13  |g|= 2.14e-12  |ddm|= 4.58e-12
HOMO (B2u) = -0.481601999871507  LUMO (Ag) = -0.103218043449458
cycle= 42 E= -75.3621216006858  delta_E= 2.98e-13  |g|= 2.96e-12  |ddm|= 2.7e-12
HOMO (B3u) = -0.481601999871449  LUMO (Ag) = -0.103218043449375
cycle= 43 E= -75.3621216006849  delta_E= 8.95e-13  |g|= 5.55e-12  |ddm|= 7.95e-13
HOMO (B3u) = -0.48160199987137  LUMO (Ag) = -0.103218043449289
cycle= 44 E= -75.362121600685  delta_E= -7.11e-14  |g|= 6.15e-12  |ddm|= 8.06e-12
HOMO (B3u) = -0.481601999871295  LUMO (Ag) = -0.103218043449218
cycle= 45 E= -75.3621216006849  delta_E= 7.11e-14  |g|= 5.73e-12  |ddm|= 1.08e-11
HOMO (B3u) = -0.481601999871223  LUMO (Ag) = -0.103218043449153
cycle= 46 E= -75.3621216006848  delta_E= 8.53e-14  |g|= 5.34e-12  |ddm|= 1.08e-11
HOMO (B3u) = -0.481601999871152  LUMO (Ag) = -0.103218043449094
cycle= 47 E= -75.3621216006848  delta_E= 2.84e-14  |g|= 4.77e-12  |ddm|= 1.09e-11
HOMO (B3u) = -0.481601999871083  LUMO (Ag) = -0.103218043449039
cycle= 48 E= -75.3621216006846  delta_E= 1.85e-13  |g|= 4.49e-12  |ddm|= 1.06e-11
HOMO (B2u) = -0.481601999871017  LUMO (Ag) = -0.103218043448988
cycle= 49 E= -75.3621216006845  delta_E= 5.68e-14  |g|= 4.02e-12  |ddm|= 1.08e-11
HOMO (B3u) = -0.481601999870948  LUMO (Ag) = -0.103218043448941
cycle= 50 E= -75.3621216006844  delta_E= 9.95e-14  |g|= 3.77e-12  |ddm|= 1.23e-11
SCF not converged.
SCF energy = -75.3621216006844

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmppn080lli
max_memory 4000 MB (current use 8388 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5214099234482  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5403499364111  dE = -0.018940013  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5566891541978  dE = -0.016339218  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.046  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5664484579373  dE = -0.0097593037  S^2 = 0.0000000
               |grad[o]|=0.091  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5730072745703  dE = -0.0065588166  S^2 = 0.0000000
               |grad[o]|=0.0715  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5782106867486  dE = -0.0052034122  S^2 = 0.0000000
               |grad[o]|=0.0576  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5825630314937  dE = -0.0043523447  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5861976368082  dE = -0.0036346053  S^2 = 0.0000000
               |grad[o]|=0.0372  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5891318419554  dE = -0.0029342051  S^2 = 0.0000000
               |grad[o]|=0.0289  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5913437922528  dE = -0.0022119503  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5928024617211  dE = -0.0014586695  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5934806911902  dE = -0.00067822947  S^2 = 0.0000000
               |grad[o]|=0.00812  |ddm|=0.00368  |maxRot[o]|=0.0798
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5935226099433  dE = -4.1918753e-05  S^2 = 0.0000000
               |grad[o]|=0.00228  |ddm|=0.00417  |maxRot[o]|= 0.02
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5935273558622  dE = -4.7459188e-06  S^2 = 0.0000000
               |grad[o]|=0.000866  |ddm|=0.00146  |maxRot[o]|=0.00833
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5935274551922  dE = -9.9330066e-08  S^2 = 0.0000000
               |grad[o]|=0.000176  |ddm|=0.000808  |maxRot[o]|=0.00113
macro iter 15 (4 JK  0 micro), CASSCF E = -75.5935274594477  dE = -4.2554689e-09  S^2 = 0.0000000
               |grad[o]|=4.32e-05  |ddm|=0.000207  |maxRot[o]|=0.000162
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5935274595322  dE = -8.4526164e-11  S^2 = 0.0000000
               |grad[o]|=7.59e-06  |ddm|=4.06e-05  |maxRot[o]|=2.8e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5935274595338  dE = -1.5347723e-12  S^2 = 0.0000000
               |grad[o]|=1.3e-06  |ddm|=5.01e-06  |maxRot[o]|=4.99e-06
2-step CASSCF converged in 17 macro (84 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98720391 1.53562802 1.91537967 1.91537961 0.46035066 0.08778182
 0.08778176 0.01049456]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00194   0.00231   0.00000   0.00000  -0.00179
  0 C 2s       0.58123   0.48048  -0.00000  -0.00000  -0.39956
  0 C 3s      -0.05483   0.00943  -0.00000  -0.00000  -0.02456
  0 C 2px      0.00000   0.00000   0.00000   0.70574   0.00000
  0 C 2py      0.00000  -0.00000   0.70574   0.00000   0.00000
  0 C 2pz      0.39276  -0.51862   0.00000  -0.00000   0.58162
  0 C 3px      0.00000   0.00000  -0.00000  -0.02575   0.00000
  0 C 3py     -0.00000   0.00000  -0.02575  -0.00000   0.00000
  0 C 3pz     -0.05404  -0.00761  -0.00000  -0.00000  -0.03659
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.03555  -0.00000   0.00000
  0 C 3dz^2    0.04451   0.00457  -0.00000  -0.00000   0.01083
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03555   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00194  -0.00231   0.00000   0.00000  -0.00179
  1 C 2s       0.58123  -0.48048   0.00000   0.00000  -0.39956
  1 C 3s      -0.05483  -0.00943   0.00000   0.00000  -0.02456
  1 C 2px      0.00000  -0.00000   0.00000   0.70574  -0.00000
  1 C 2py      0.00000  -0.00000   0.70574   0.00000  -0.00000
  1 C 2pz     -0.39276  -0.51862  -0.00000  -0.00000  -0.58162
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.02575  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02575  -0.00000  -0.00000
  1 C 3pz      0.05404  -0.00761  -0.00000  -0.00000   0.03659
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03555   0.00000   0.00000
  1 C 3dz^2    0.04451  -0.00457   0.00000   0.00000   0.01083
  1 C 3dxz     0.00000   0.00000   0.00000  -0.03555   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00088
  0 C 2s      -0.00000  -0.00000   0.51738
  0 C 3s      -0.00000  -0.00000  -0.04498
  0 C 2px      0.70604   0.00000  -0.00000
  0 C 2py      0.00000   0.70604  -0.00000
  0 C 2pz     -0.00000   0.00000   0.47816
  0 C 3px     -0.03061   0.00000  -0.00000
  0 C 3py      0.00000  -0.03061  -0.00000
  0 C 3pz     -0.00000   0.00000   0.00024
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.04072
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00088
  1 C 2s       0.00000  -0.00000  -0.51738
  1 C 3s       0.00000   0.00000   0.04498
  1 C 2px     -0.70604  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70604   0.00000
  1 C 2pz     -0.00000  -0.00000   0.47816
  1 C 3px      0.03061  -0.00000   0.00000
  1 C 3py     -0.00000   0.03061   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00024
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04072
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99556549
<CAS-nat-orb|mo-hf>  4  4    0.99868711
<CAS-nat-orb|mo-hf>  5  5    0.99984158
<CAS-nat-orb|mo-hf>  6  6    0.99984158
<CAS-nat-orb|mo-hf>  7  7    0.98128495
<CAS-nat-orb|mo-hf>  8  8    0.91006597
<CAS-nat-orb|mo-hf>  8  15   -0.41306114
<CAS-nat-orb|mo-hf>  9  9    0.91006599
<CAS-nat-orb|mo-hf>  9  16   -0.41306111
<CAS-nat-orb|mo-hf>  10  10    0.41868609
<CAS-nat-orb|mo-hf>  10  17    0.53963873
<CAS-nat-orb|mo-hf>  10  20   -0.66337408
CASSCF energy = -75.5935274595338
CASCI E = -75.5935274595338  E(CI) = -18.3163035050593  S^2 = 0.0000000
......production of RDMs took       2.26 sec
......reading the RDM took          0.45 sec
......production of RDMs took      29.83 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.23 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000191466
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000050573
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001288128
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000149074
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000806451
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001758114
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000586038
HMAT symm error =    0.0181087907
E(MRCI) - E(ref) = -0.1030111142581092 DC = -0.004081462290170972
E(WickICMRCISD)   = -75.69653857379187  E_corr_ci = -0.1030111142581092
E(WickICMRCISD+Q) = -75.70062003608204  E_corr_ci = -0.1070925765482801
Time cost =   2765.630
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 21:35:27 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.164189864024 AA    0.000000000000   0.000000000000   2.200000000000 Bohr   0.0

nuclear repulsion = 16.3636363636364
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.1]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    371775.11


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmppmd3we16
max_memory 4000 MB (current use 8388 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6850211082767

WARN: Singularity detected in overlap matrix (condition number =  823). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.300635738182937  LUMO (Ag) = -0.196894745039133
cycle= 1 E= -75.3600714434763  delta_E= 0.325  |g|= 0.186  |ddm|= 1.52
HOMO (B3u) = -0.505767689307348  LUMO (Ag) = -0.134850139116738
cycle= 2 E= -75.3722557388854  delta_E= -0.0122  |g|= 0.0519  |ddm|= 0.201
HOMO (B3u) = -0.471042686025419  LUMO (Ag) = -0.101583923798027
cycle= 3 E= -75.3730472275437  delta_E= -0.000791  |g|= 0.011  |ddm|= 0.0769
HOMO (B3u) = -0.473583831878466  LUMO (Ag) = -0.10306443620941
cycle= 4 E= -75.3731222408076  delta_E= -7.5e-05  |g|= 0.00204  |ddm|= 0.0475
HOMO (B2u) = -0.474409949766166  LUMO (Ag) = -0.104308159498409
cycle= 5 E= -75.3731251255  delta_E= -2.88e-06  |g|= 0.000283  |ddm|= 0.0148
HOMO (B2u) = -0.474348151042956  LUMO (Ag) = -0.104322379442281
cycle= 6 E= -75.3731251811964  delta_E= -5.57e-08  |g|= 2.51e-05  |ddm|= 0.000586
HOMO (B2u) = -0.474349388268691  LUMO (Ag) = -0.10433076431711
cycle= 7 E= -75.3731251815252  delta_E= -3.29e-10  |g|= 2.41e-06  |ddm|= 0.000311
HOMO (B2u) = -0.474349685667056  LUMO (Ag) = -0.104330912577451
cycle= 8 E= -75.3731251815275  delta_E= -2.25e-12  |g|= 1.4e-07  |ddm|= 3.41e-05
HOMO (B2u) = -0.474349699393743  LUMO (Ag) = -0.104330922331009
cycle= 9 E= -75.3731251815274  delta_E= 5.68e-14  |g|= 8.38e-09  |ddm|= 2.86e-07
HOMO (B2u) = -0.474349697428499  LUMO (Ag) = -0.104330918023848
cycle= 10 E= -75.3731251815275  delta_E= -5.68e-14  |g|= 7.66e-09  |ddm|= 1.05e-08
HOMO (B2u) = -0.474349699485501  LUMO (Ag) = -0.104330919909221
cycle= 11 E= -75.3731251815275  delta_E= 1.42e-14  |g|= 7.73e-10  |ddm|= 1.38e-08
HOMO (B2u) = -0.474349699588805  LUMO (Ag) = -0.104330919969954
cycle= 12 E= -75.3731251815275  delta_E=    0  |g|= 5.7e-10  |ddm|= 2.3e-09
HOMO (B2u) = -0.474349699607499  LUMO (Ag) = -0.10433092000694
cycle= 13 E= -75.3731251815274  delta_E= 9.95e-14  |g|= 5.32e-10  |ddm|= 8.58e-10
HOMO (B2u) = -0.474349699605719  LUMO (Ag) = -0.10433091999043
cycle= 14 E= -75.3731251815274  delta_E= -7.11e-14  |g|= 4.47e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.474349699620655  LUMO (Ag) = -0.104330919983788
cycle= 15 E= -75.3731251815275  delta_E= -2.84e-14  |g|= 4.06e-10  |ddm|= 4.6e-10
HOMO (B2u) = -0.474349699583949  LUMO (Ag) = -0.104330919972241
cycle= 16 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 3.48e-10  |ddm|= 1.48e-09
HOMO (B2u) = -0.474349699580121  LUMO (Ag) = -0.104330920005606
cycle= 17 E= -75.3731251815274  delta_E= 1.42e-14  |g|= 4.94e-10  |ddm|= 6.8e-10
HOMO (B2u) = -0.474349699624135  LUMO (Ag) = -0.104330920003903
cycle= 18 E= -75.3731251815274  delta_E= -1.42e-14  |g|= 3.15e-10  |ddm|= 3.54e-10
HOMO (B2u) = -0.474349699596378  LUMO (Ag) = -0.104330919959424
cycle= 19 E= -75.3731251815274  delta_E= 4.26e-14  |g|= 9.43e-11  |ddm|= 6.37e-10
HOMO (B2u) = -0.474349699592277  LUMO (Ag) = -0.104330919954833
cycle= 20 E= -75.3731251815274  delta_E= -5.68e-14  |g|= 8.1e-11  |ddm|= 4.64e-11
HOMO (B2u) = -0.474349699592258  LUMO (Ag) = -0.104330919953748
cycle= 21 E= -75.3731251815274  delta_E= 4.26e-14  |g|= 7.05e-11  |ddm|= 2.04e-11
HOMO (B2u) = -0.474349699592227  LUMO (Ag) = -0.104330919951833
cycle= 22 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 5.81e-11  |ddm|= 3.82e-11
HOMO (B2u) = -0.474349699591773  LUMO (Ag) = -0.104330919950036
cycle= 23 E= -75.3731251815273  delta_E= 5.68e-14  |g|= 4.86e-11  |ddm|= 4.31e-11
HOMO (B2u) = -0.474349699590991  LUMO (Ag) = -0.104330919948648
cycle= 24 E= -75.3731251815273  delta_E= 1.42e-14  |g|= 4.27e-11  |ddm|= 5.87e-11
HOMO (B2u) = -0.474349699590779  LUMO (Ag) = -0.104330919947174
cycle= 25 E= -75.3731251815274  delta_E= -1.42e-13  |g|= 3.59e-11  |ddm|= 1.55e-11
HOMO (B2u) = -0.474349699592248  LUMO (Ag) = -0.104330919945934
cycle= 26 E= -75.3731251815274  delta_E= 8.53e-14  |g|= 2.2e-11  |ddm|= 2.96e-11
HOMO (B3u) = -0.474349699594309  LUMO (Ag) = -0.104330919946681
cycle= 27 E= -75.3731251815273  delta_E= 2.84e-14  |g|= 1.58e-11  |ddm|= 2.28e-11
HOMO (B2u) = -0.474349699594338  LUMO (Ag) = -0.104330919946224
cycle= 28 E= -75.3731251815273  delta_E= 2.84e-14  |g|= 1.34e-11  |ddm|= 8.93e-12
HOMO (B3u) = -0.474349699594257  LUMO (Ag) = -0.104330919945706
cycle= 29 E= -75.3731251815273  delta_E= 4.26e-14  |g|= 1.13e-11  |ddm|= 7.48e-12
HOMO (B3u) = -0.474349699594182  LUMO (Ag) = -0.104330919945233
cycle= 30 E= -75.3731251815273  delta_E= -4.26e-14  |g|= 9.35e-12  |ddm|= 6.81e-12
HOMO (B3u) = -0.474349699594127  LUMO (Ag) = -0.104330919944857
cycle= 31 E= -75.373125181527  delta_E= 2.56e-13  |g|= 8.63e-12  |ddm|= 4.23e-12
HOMO (B3u) = -0.474349699594087  LUMO (Ag) = -0.104330919944582
cycle= 32 E= -75.3731251815264  delta_E= 6.54e-13  |g|= 1.07e-11  |ddm|= 2.83e-12
HOMO (B3u) = -0.474349699594064  LUMO (Ag) = -0.104330919944358
cycle= 33 E= -75.3731251815264  delta_E= -2.84e-14  |g|= 9.14e-12  |ddm|= 7.85e-12
HOMO (B3u) = -0.474349699594037  LUMO (Ag) = -0.104330919944187
cycle= 34 E= -75.3731251815264  delta_E= 5.68e-14  |g|= 8.1e-12  |ddm|= 6.14e-12
HOMO (B3u) = -0.474349699593978  LUMO (Ag) = -0.104330919944084
cycle= 35 E= -75.3731251815262  delta_E= 1.28e-13  |g|= 7.11e-12  |ddm|= 6.03e-12
HOMO (B3u) = -0.474349699593936  LUMO (Ag) = -0.104330919944015
cycle= 36 E= -75.3731251815262  delta_E= 1.42e-14  |g|= 6.34e-12  |ddm|= 4.73e-12
HOMO (B3u) = -0.474349699593891  LUMO (Ag) = -0.104330919943949
cycle= 37 E= -75.3731251815264  delta_E= -1.42e-13  |g|= 5.54e-12  |ddm|= 4.68e-12
HOMO (B3u) = -0.474349699593843  LUMO (Ag) = -0.104330919943894
cycle= 38 E= -75.3731251815263  delta_E= 8.53e-14  |g|= 4.97e-12  |ddm|= 4.18e-12
HOMO (B3u) = -0.474349699593787  LUMO (Ag) = -0.104330919943837
cycle= 39 E= -75.3731251815258  delta_E= 4.83e-13  |g|= 4.86e-12  |ddm|= 3.41e-12
HOMO (B3u) = -0.474349699593711  LUMO (Ag) = -0.104330919943762
cycle= 40 E= -75.3731251815259  delta_E= -1.14e-13  |g|= 3.7e-12  |ddm|= 6.34e-12
HOMO (B3u) = -0.474349699593655  LUMO (Ag) = -0.104330919943694
cycle= 41 E= -75.3731251815257  delta_E= 1.71e-13  |g|= 3.75e-12  |ddm|= 3.32e-12
HOMO (B3u) = -0.474349699593592  LUMO (Ag) = -0.10433091994362
cycle= 42 E= -75.3731251815255  delta_E= 2.13e-13  |g|= 4.52e-12  |ddm|= 3.85e-12
HOMO (B3u) = -0.47434969959353  LUMO (Ag) = -0.10433091994354
cycle= 43 E= -75.3731251815254  delta_E= 1.56e-13  |g|= 4.83e-12  |ddm|= 7.56e-12
HOMO (B3u) = -0.47434969959347  LUMO (Ag) = -0.10433091994346
cycle= 44 E= -75.3731251815252  delta_E= 2.13e-13  |g|= 5.3e-12  |ddm|= 7.57e-12
HOMO (B3u) = -0.474349699593413  LUMO (Ag) = -0.104330919943384
cycle= 45 E= -75.3731251815252  delta_E= -7.11e-14  |g|= 4.63e-12  |ddm|= 9.99e-12
HOMO (B3u) = -0.474349699593361  LUMO (Ag) = -0.104330919943311
cycle= 46 E= -75.3731251815251  delta_E= 8.53e-14  |g|= 4.08e-12  |ddm|= 9.52e-12
HOMO (B3u) = -0.474349699593324  LUMO (Ag) = -0.10433091994325
cycle= 47 E= -75.3731251815249  delta_E= 2.56e-13  |g|= 4.46e-12  |ddm|= 8.39e-12
HOMO (B3u) = -0.47434969959331  LUMO (Ag) = -0.104330919943193
cycle= 48 E= -75.3731251815249  delta_E=    0  |g|= 3.76e-12  |ddm|= 1.11e-11
HOMO (B3u) = -0.474349699593382  LUMO (Ag) = -0.104330919943144
Extra cycle  E= -75.3731251815247  delta_E= 1.56e-13  |g|= 7.97e-13  |ddm|= 4.54e-11
converged SCF energy = -75.3731251815247

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmppmd3we16
max_memory 4000 MB (current use 8388 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.53406922644  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5535870028216  dE = -0.019517776  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5700693269214  dE = -0.016482324  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0484  |maxRot[o]|=0.0784
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5795436432075  dE = -0.0094743163  S^2 = 0.0000000
               |grad[o]|=0.0899  |ddm|=0.0297  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5861233810624  dE = -0.0065797379  S^2 = 0.0000000
               |grad[o]|=0.0707  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5914066871014  dE = -0.005283306  S^2 = 0.0000000
               |grad[o]|=0.0568  |ddm|=0.00536  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5958184636733  dE = -0.0044117766  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=0.00348  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5994546486856  dE = -0.003636185  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6023099683167  dE = -0.0028553196  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.00296  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043446411868  dE = -0.0020346729  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6054817673883  dE = -0.0011371262  S^2 = 0.0000000
               |grad[o]|=0.012  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 11 (5 JK  0 micro), CASSCF E = -75.6057914250914  dE = -0.0003096577  S^2 = 0.0000000
               |grad[o]|=0.00551  |ddm|=0.00398  |maxRot[o]|=0.0599
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6058040706469  dE = -1.2645555e-05  S^2 = 0.0000000
               |grad[o]|=0.00133  |ddm|=0.00326  |maxRot[o]|=0.0137
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6058043166792  dE = -2.4603229e-07  S^2 = 0.0000000
               |grad[o]|=0.000277  |ddm|=0.00116  |maxRot[o]|=0.00176
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6058043246965  dE = -8.0173379e-09  S^2 = 0.0000000
               |grad[o]|=5.71e-05  |ddm|=0.000304  |maxRot[o]|=0.000262
macro iter 15 (3 JK  0 micro), CASSCF E = -75.605804325139  dE = -4.4242654e-10  S^2 = 0.0000000
               |grad[o]|=2.04e-05  |ddm|=6.86e-05  |maxRot[o]|=4.92e-05
macro iter 16 (3 JK  0 micro), CASSCF E = -75.6058043251496  dE = -1.0601298e-11  S^2 = 0.0000000
               |grad[o]|=2.88e-06  |ddm|=1.05e-05  |maxRot[o]|=6.21e-06
2-step CASSCF converged in 16 macro (80 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98650078 1.5529     1.90980632 1.90980663 0.44288892 0.0934623
 0.0934622  0.01117286]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00235   0.00241   0.00000   0.00000  -0.00166
  0 C 2s       0.58410   0.48964  -0.00000  -0.00000  -0.39544
  0 C 3s      -0.05356   0.00927  -0.00000  -0.00000  -0.02152
  0 C 2px     -0.00000   0.00000   0.00000   0.70593   0.00000
  0 C 2py      0.00000  -0.00000   0.70593  -0.00000  -0.00000
  0 C 2pz      0.38903  -0.51000   0.00000  -0.00000   0.58448
  0 C 3px     -0.00000   0.00000   0.00000  -0.02144   0.00000
  0 C 3py      0.00000  -0.00000  -0.02144  -0.00000  -0.00000
  0 C 3pz     -0.05250  -0.00695  -0.00000  -0.00000  -0.03768
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03464  -0.00000  -0.00000
  0 C 3dz^2    0.04312   0.00386  -0.00000  -0.00000   0.01086
  0 C 3dxz    -0.00000   0.00000   0.00000   0.03464   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00235  -0.00241   0.00000   0.00000  -0.00166
  1 C 2s       0.58410  -0.48964   0.00000   0.00000  -0.39544
  1 C 3s      -0.05356  -0.00927   0.00000   0.00000  -0.02152
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70593  -0.00000
  1 C 2py      0.00000   0.00000   0.70593   0.00000   0.00000
  1 C 2pz     -0.38903  -0.51000   0.00000  -0.00000  -0.58448
  1 C 3px      0.00000  -0.00000  -0.00000  -0.02144  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02144   0.00000   0.00000
  1 C 3pz      0.05250  -0.00695  -0.00000  -0.00000   0.03768
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03464  -0.00000  -0.00000
  1 C 3dz^2    0.04312  -0.00386   0.00000   0.00000   0.01086
  1 C 3dxz    -0.00000   0.00000   0.00000  -0.03464   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00084
  0 C 2s      -0.00000  -0.00000   0.50895
  0 C 3s      -0.00000  -0.00000  -0.04424
  0 C 2px      0.70611   0.00000  -0.00000
  0 C 2py      0.00000   0.70611  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.48752
  0 C 3px     -0.02900   0.00000  -0.00000
  0 C 3py      0.00000  -0.02900  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00249
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03651
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00084
  1 C 2s       0.00000   0.00000  -0.50895
  1 C 3s       0.00000   0.00000   0.04424
  1 C 2px     -0.70611  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70611   0.00000
  1 C 2pz     -0.00000   0.00000   0.48752
  1 C 3px      0.02900  -0.00000   0.00000
  1 C 3py     -0.00000   0.02900   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00249
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.03651
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99534813
<CAS-nat-orb|mo-hf>  4  4    0.99866563
<CAS-nat-orb|mo-hf>  5  5    0.99983126
<CAS-nat-orb|mo-hf>  6  6    0.99983126
<CAS-nat-orb|mo-hf>  7  7    0.98071670
<CAS-nat-orb|mo-hf>  8  8    0.91723383
<CAS-nat-orb|mo-hf>  9  9    0.91723388
<CAS-nat-orb|mo-hf>  10  10    0.43078380
<CAS-nat-orb|mo-hf>  10  17    0.57019896
<CAS-nat-orb|mo-hf>  10  20   -0.63691825
CASSCF energy = -75.6058043251496
CASCI E = -75.6058043251496  E(CI) = -18.1594673126213  S^2 = 0.0000000
......production of RDMs took       2.02 sec
......reading the RDM took          0.45 sec
......production of RDMs took      28.01 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.82 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000241400
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000063762
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001478842
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000153764
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000939510
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001990467
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000663489
HMAT symm error =    0.0151523369
E(MRCI) - E(ref) = -0.103276654801661 DC = -0.004128703995823363
E(WickICMRCISD)   = -75.70908097995122  E_corr_ci = -0.103276654801661
E(WickICMRCISD+Q) = -75.71320968394704  E_corr_ci = -0.1074053587974844
Time cost =   2661.667
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:19:49 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.190648724570 AA    0.000000000000   0.000000000000   2.250000000000 Bohr   0.0

nuclear repulsion = 16
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.125]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    415819.60


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp6owyev49
max_memory 4000 MB (current use 8394 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6287133444179

WARN: Singularity detected in overlap matrix (condition number =  749). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.2878011472914  LUMO (Ag) = -0.193295779361717
cycle= 1 E= -75.3670366286219  delta_E= 0.262  |g|= 0.19  |ddm|= 1.51
HOMO (B3u) = -0.499807889396643  LUMO (Ag) = -0.137862572577772
cycle= 2 E= -75.3797482358211  delta_E= -0.0127  |g|= 0.0519  |ddm|= 0.208
HOMO (B3u) = -0.46454022619521  LUMO (Ag) = -0.103237375699653
cycle= 3 E= -75.3805383397255  delta_E= -0.00079  |g|= 0.0104  |ddm|= 0.0716
HOMO (B3u) = -0.466699997579168  LUMO (Ag) = -0.104062742035947
cycle= 4 E= -75.3806041774367  delta_E= -6.58e-05  |g|= 0.00196  |ddm|= 0.0425
HOMO (B3u) = -0.467507612863157  LUMO (Ag) = -0.105181483870832
cycle= 5 E= -75.3806067875641  delta_E= -2.61e-06  |g|= 0.00024  |ddm|= 0.0138
HOMO (B3u) = -0.467469009904277  LUMO (Ag) = -0.105209990979466
cycle= 6 E= -75.3806068286268  delta_E= -4.11e-08  |g|= 2.47e-05  |ddm|= 0.000855
HOMO (B3u) = -0.467470595918401  LUMO (Ag) = -0.105219180794845
cycle= 7 E= -75.3806068289548  delta_E= -3.28e-10  |g|= 2.6e-06  |ddm|= 0.000264
HOMO (B3u) = -0.467470958375022  LUMO (Ag) = -0.105219406231852
cycle= 8 E= -75.3806068289575  delta_E= -2.73e-12  |g|= 1.64e-07  |ddm|= 3.35e-05
HOMO (B3u) = -0.467470973641787  LUMO (Ag) = -0.105219414001834
cycle= 9 E= -75.3806068289574  delta_E= 8.53e-14  |g|= 9.4e-09  |ddm|= 3.15e-07
HOMO (B3u) = -0.467470971058692  LUMO (Ag) = -0.105219408947957
cycle= 10 E= -75.3806068289575  delta_E= -1.14e-13  |g|= 7.6e-09  |ddm|= 1.06e-08
HOMO (B3u) = -0.467470973492029  LUMO (Ag) = -0.10521941134199
cycle= 11 E= -75.3806068289574  delta_E= 1.56e-13  |g|= 8.77e-10  |ddm|= 1.87e-08
HOMO (B3u) = -0.467470973606633  LUMO (Ag) = -0.105219411411532
cycle= 12 E= -75.3806068289574  delta_E= -1.42e-14  |g|= 6.81e-10  |ddm|= 2.27e-09
HOMO (B3u) = -0.467470973590792  LUMO (Ag) = -0.105219411386339
cycle= 13 E= -75.3806068289575  delta_E= -7.11e-14  |g|= 5.78e-10  |ddm|= 1.29e-09
HOMO (B2u) = -0.467470973609001  LUMO (Ag) = -0.105219411406847
cycle= 14 E= -75.3806068289574  delta_E= 4.26e-14  |g|= 5.17e-10  |ddm|= 2.14e-10
HOMO (B3u) = -0.467470973617555  LUMO (Ag) = -0.105219411398042
cycle= 15 E= -75.3806068289574  delta_E=    0  |g|= 4.54e-10  |ddm|= 4.7e-10
HOMO (B2u) = -0.467470973587528  LUMO (Ag) = -0.105219411378718
cycle= 16 E= -75.3806068289575  delta_E= -5.68e-14  |g|= 4e-10  |ddm|= 8.34e-10
HOMO (B3u) = -0.467470973563591  LUMO (Ag) = -0.105219411401248
cycle= 17 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 5.25e-10  |ddm|= 1.01e-09
HOMO (B3u) = -0.467470973603068  LUMO (Ag) = -0.105219411391121
cycle= 18 E= -75.3806068289575  delta_E= -5.68e-14  |g|= 3.18e-10  |ddm|= 4.58e-10
HOMO (B3u) = -0.467470973566575  LUMO (Ag) = -0.105219411341615
cycle= 19 E= -75.3806068289573  delta_E= 1.42e-13  |g|= 1.1e-10  |ddm|= 7.7e-10
HOMO (B3u) = -0.46747097356398  LUMO (Ag) = -0.105219411337602
cycle= 20 E= -75.3806068289574  delta_E= -1.14e-13  |g|= 9.38e-11  |ddm|= 3.83e-11
HOMO (B3u) = -0.467470973565744  LUMO (Ag) = -0.105219411337385
cycle= 21 E= -75.3806068289575  delta_E= -5.68e-14  |g|= 7.96e-11  |ddm|= 2.96e-11
HOMO (B2u) = -0.467470973565652  LUMO (Ag) = -0.105219411335878
cycle= 22 E= -75.3806068289574  delta_E= 1.42e-13  |g|= 6.65e-11  |ddm|= 3.96e-11
HOMO (B2u) = -0.467470973566284  LUMO (Ag) = -0.105219411334805
cycle= 23 E= -75.3806068289574  delta_E=    0  |g|= 5.46e-11  |ddm|= 3.46e-11
HOMO (B2u) = -0.467470973570426  LUMO (Ag) = -0.105219411332164
Extra cycle  E= -75.3806068289575  delta_E= -1.14e-13  |g|= 1.51e-11  |ddm|= 6.12e-11
converged SCF energy = -75.3806068289575

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp6owyev49
max_memory 4000 MB (current use 8394 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5432350452006  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5633269876799  dE = -0.020091942  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5798564290374  dE = -0.016529441  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0507  |maxRot[o]|=0.0764
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5891714790033  dE = -0.00931505  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0303  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5958163542739  dE = -0.0066448753  S^2 = 0.0000000
               |grad[o]|=0.0699  |ddm|=0.0111  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6011944129803  dE = -0.0053780587  S^2 = 0.0000000
               |grad[o]|=0.0557  |ddm|=0.00579  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6056552723584  dE = -0.0044608594  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00393  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6092550981722  dE = -0.0035998258  S^2 = 0.0000000
               |grad[o]|=0.034  |ddm|=0.00337  |maxRot[o]|=0.0797
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6118591159477  dE = -0.0026040178  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6135434946897  dE = -0.0016843787  S^2 = 0.0000000
               |grad[o]|=0.0171  |ddm|=0.00365  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6143869858534  dE = -0.00084349116  S^2 = 0.0000000
               |grad[o]|=0.00999  |ddm|=0.00384  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6145205027514  dE = -0.0001335169  S^2 = 0.0000000
               |grad[o]|=0.00373  |ddm|=0.00405  |maxRot[o]|= 0.04
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6145268297887  dE = -6.3270373e-06  S^2 = 0.0000000
               |grad[o]|=0.000948  |ddm|=0.0023  |maxRot[o]|=0.00981
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6145269484983  dE = -1.1870962e-07  S^2 = 0.0000000
               |grad[o]|=0.000187  |ddm|=0.000826  |maxRot[o]|=0.00121
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6145269526716  dE = -4.1732591e-09  S^2 = 0.0000000
               |grad[o]|=4.1e-05  |ddm|=0.000208  |maxRot[o]|=0.00018
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6145269528473  dE = -1.7574564e-10  S^2 = 0.0000000
               |grad[o]|=1.44e-05  |ddm|=4.51e-05  |maxRot[o]|=2.67e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6145269528483  dE = -9.5212727e-13  S^2 = 0.0000000
               |grad[o]|=1.14e-06  |ddm|=6.56e-06  |maxRot[o]|=3.21e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98576845 1.56903862 1.90400104 1.90400151 0.42663325 0.09933863
 0.09933873 0.01187979]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00276   0.00252   0.00000   0.00000  -0.00155
  0 C 2s       0.58703   0.49855   0.00000   0.00000  -0.39116
  0 C 3s      -0.05216   0.00914   0.00000   0.00000  -0.01848
  0 C 2px      0.00000   0.00000  -0.00000   0.70609   0.00000
  0 C 2py     -0.00000  -0.00000   0.70609   0.00000  -0.00000
  0 C 2pz      0.38514  -0.50131   0.00000  -0.00000   0.58739
  0 C 3px      0.00000  -0.00000  -0.00000  -0.01737  -0.00000
  0 C 3py      0.00000  -0.00000  -0.01737   0.00000  -0.00000
  0 C 3pz     -0.05093  -0.00632   0.00000   0.00000  -0.03868
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03373   0.00000  -0.00000
  0 C 3dz^2    0.04175   0.00318   0.00000   0.00000   0.01107
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03373  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00276  -0.00252   0.00000   0.00000  -0.00155
  1 C 2s       0.58703  -0.49855  -0.00000  -0.00000  -0.39116
  1 C 3s      -0.05216  -0.00914  -0.00000  -0.00000  -0.01848
  1 C 2px     -0.00000   0.00000   0.00000   0.70609   0.00000
  1 C 2py     -0.00000   0.00000   0.70609  -0.00000   0.00000
  1 C 2pz     -0.38514  -0.50131   0.00000  -0.00000  -0.58739
  1 C 3px     -0.00000  -0.00000   0.00000  -0.01737   0.00000
  1 C 3py      0.00000   0.00000  -0.01737  -0.00000   0.00000
  1 C 3pz      0.05093  -0.00632   0.00000   0.00000   0.03868
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.03373   0.00000  -0.00000
  1 C 3dz^2    0.04175  -0.00318  -0.00000   0.00000   0.01107
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03373  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00080
  0 C 2s       0.00000   0.00000   0.50039
  0 C 3s      -0.00000  -0.00000  -0.04369
  0 C 2px      0.70617   0.00000  -0.00000
  0 C 2py      0.00000   0.70617   0.00000
  0 C 2pz     -0.00000  -0.00000   0.49657
  0 C 3px     -0.02753   0.00000  -0.00000
  0 C 3py      0.00000  -0.02753  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00467
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03305
  0 C 3dxz    -0.02382   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00080
  1 C 2s       0.00000   0.00000  -0.50039
  1 C 3s       0.00000   0.00000   0.04369
  1 C 2px     -0.70617  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70617   0.00000
  1 C 2pz     -0.00000   0.00000   0.49657
  1 C 3px      0.02753  -0.00000   0.00000
  1 C 3py     -0.00000   0.02753  -0.00000
  1 C 3pz     -0.00000  -0.00000   0.00467
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03305
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99511401
<CAS-nat-orb|mo-hf>  4  4    0.99863346
<CAS-nat-orb|mo-hf>  5  5    0.99981869
<CAS-nat-orb|mo-hf>  6  6    0.99981869
<CAS-nat-orb|mo-hf>  7  7    0.98014677
<CAS-nat-orb|mo-hf>  8  8    0.92376834
<CAS-nat-orb|mo-hf>  9  9    0.92376844
<CAS-nat-orb|mo-hf>  10  10    0.44416383
<CAS-nat-orb|mo-hf>  10  17    0.59838661
<CAS-nat-orb|mo-hf>  10  20   -0.60893948
CASSCF energy = -75.6145269528483
CASCI E = -75.6145269528483  E(CI) = -18.006582200469  S^2 = 0.0000000
......production of RDMs took       2.85 sec
......reading the RDM took          0.64 sec
......production of RDMs took      29.16 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.73 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000095029
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000025100
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001196201
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000137973
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000744312
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001700230
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000566743
HMAT symm error =    0.0217824432
E(MRCI) - E(ref) = -0.1035356254186013 DC = -0.004175516855782284
E(WickICMRCISD)   = -75.71806257826685  E_corr_ci = -0.1035356254186013
E(WickICMRCISD+Q) = -75.72223809512263  E_corr_ci = -0.1077111422743836
Time cost =   2892.689
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:08:02 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.217107585116 AA    0.000000000000   0.000000000000   2.300000000000 Bohr   0.0

nuclear repulsion = 15.6521739130435
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.15]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    464605.50


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpdmbww5qg
max_memory 4000 MB (current use 8388 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.5736679955661

WARN: Singularity detected in overlap matrix (condition number =  684). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.275669226345096  LUMO (Ag) = -0.189888551192394
cycle= 1 E= -75.3709156762751  delta_E= 0.203  |g|= 0.194  |ddm|=  1.5
HOMO (B3u) = -0.494059555931335  LUMO (Ag) = -0.140557688111627
cycle= 2 E= -75.3842064529923  delta_E= -0.0133  |g|= 0.0519  |ddm|= 0.217
HOMO (B3u) = -0.458318448325722  LUMO (Ag) = -0.104627267109311
cycle= 3 E= -75.3850020490567  delta_E= -0.000796  |g|= 0.00987  |ddm|= 0.0675
HOMO (B2u) = -0.460162695295051  LUMO (Ag) = -0.10485931238232
cycle= 4 E= -75.3850609582636  delta_E= -5.89e-05  |g|= 0.00188  |ddm|= 0.038
HOMO (B3u) = -0.460946264390437  LUMO (Ag) = -0.105848218108884
cycle= 5 E= -75.3850633096871  delta_E= -2.35e-06  |g|= 0.000188  |ddm|= 0.0127
HOMO (B3u) = -0.460927636332218  LUMO (Ag) = -0.105880739343782
cycle= 6 E= -75.3850633353856  delta_E= -2.57e-08  |g|= 2.43e-05  |ddm|= 0.00106
HOMO (B3u) = -0.46092962518536  LUMO (Ag) = -0.105890953720659
cycle= 7 E= -75.3850633357242  delta_E= -3.39e-10  |g|= 2.81e-06  |ddm|= 0.000195
HOMO (B3u) = -0.460930055066112  LUMO (Ag) = -0.105891268417329
cycle= 8 E= -75.3850633357271  delta_E= -2.98e-12  |g|= 1.94e-07  |ddm|= 3.21e-05
HOMO (B3u) = -0.460930071210935  LUMO (Ag) = -0.105891273497098
cycle= 9 E= -75.3850633357272  delta_E= -5.68e-14  |g|= 1.06e-08  |ddm|= 5.6e-07
HOMO (B3u) = -0.460930068167933  LUMO (Ag) = -0.105891267976196
cycle= 10 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 7.04e-09  |ddm|= 1.11e-08
HOMO (B3u) = -0.460930070691163  LUMO (Ag) = -0.105891270569472
cycle= 11 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 9.69e-10  |ddm|= 1.93e-08
HOMO (B3u) = -0.460930070838339  LUMO (Ag) = -0.105891270680808
cycle= 12 E= -75.3850633357272  delta_E= 5.68e-14  |g|= 8.28e-10  |ddm|= 3.01e-09
HOMO (B3u) = -0.460930070808237  LUMO (Ag) = -0.105891270629901
cycle= 13 E= -75.3850633357272  delta_E=    0  |g|= 6.45e-10  |ddm|= 1.19e-09
HOMO (B3u) = -0.460930070826841  LUMO (Ag) = -0.105891270646854
cycle= 14 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 6.04e-10  |ddm|= 7.96e-10
HOMO (B3u) = -0.460930070827042  LUMO (Ag) = -0.105891270638897
cycle= 15 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 5.27e-10  |ddm|= 5.16e-10
HOMO (B3u) = -0.46093007079796  LUMO (Ag) = -0.105891270621308
cycle= 16 E= -75.3850633357272  delta_E=    0  |g|= 4.66e-10  |ddm|= 6.02e-10
HOMO (B3u) = -0.460930070761858  LUMO (Ag) = -0.105891270622215
cycle= 17 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 5.52e-10  |ddm|= 1.1e-09
HOMO (B3u) = -0.460930070795115  LUMO (Ag) = -0.105891270601554
cycle= 18 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 3.09e-10  |ddm|= 5.57e-10
HOMO (B3u) = -0.460930070749308  LUMO (Ag) = -0.105891270547112
cycle= 19 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 1.29e-10  |ddm|= 7.18e-10
HOMO (B3u) = -0.460930070747193  LUMO (Ag) = -0.105891270543288
cycle= 20 E= -75.3850633357272  delta_E=    0  |g|= 1.12e-10  |ddm|= 3.92e-11
HOMO (B3u) = -0.460930070750954  LUMO (Ag) = -0.105891270544174
cycle= 21 E= -75.3850633357271  delta_E= 8.53e-14  |g|= 9.36e-11  |ddm|= 4.9e-11
HOMO (B3u) = -0.460930070752633  LUMO (Ag) = -0.105891270544057
cycle= 22 E= -75.3850633357272  delta_E= -8.53e-14  |g|= 7.92e-11  |ddm|= 2.8e-11
HOMO (B3u) = -0.460930070754034  LUMO (Ag) = -0.105891270543524
cycle= 23 E= -75.3850633357271  delta_E= 8.53e-14  |g|= 6.47e-11  |ddm|= 3.75e-11
HOMO (B3u) = -0.460930070755095  LUMO (Ag) = -0.105891270542859
cycle= 24 E= -75.3850633357271  delta_E= -5.68e-14  |g|= 5.27e-11  |ddm|= 4.61e-11
HOMO (B3u) = -0.460930070756033  LUMO (Ag) = -0.105891270541848
cycle= 25 E= -75.3850633357272  delta_E= -5.68e-14  |g|= 4.19e-11  |ddm|= 2.83e-11
HOMO (B3u) = -0.460930070757789  LUMO (Ag) = -0.105891270540598
cycle= 26 E= -75.3850633357271  delta_E= 1.14e-13  |g|= 2.7e-11  |ddm|= 3.27e-11
HOMO (B3u) = -0.460930070759773  LUMO (Ag) = -0.105891270541394
cycle= 27 E= -75.3850633357271  delta_E= 2.84e-14  |g|= 2.14e-11  |ddm|= 2.32e-11
HOMO (B3u) = -0.460930070759448  LUMO (Ag) = -0.105891270540459
cycle= 28 E= -75.3850633357271  delta_E= -8.53e-14  |g|= 1.78e-11  |ddm|= 8.06e-12
HOMO (B3u) = -0.460930070759075  LUMO (Ag) = -0.105891270539541
cycle= 29 E= -75.3850633357272  delta_E= -8.53e-14  |g|= 1.45e-11  |ddm|= 7.93e-12
HOMO (B3u) = -0.460930070758806  LUMO (Ag) = -0.105891270538791
cycle= 30 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 1.19e-11  |ddm|= 9.33e-12
HOMO (B3u) = -0.46093007075861  LUMO (Ag) = -0.105891270538158
cycle= 31 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 9.54e-12  |ddm|= 8.74e-12
HOMO (B3u) = -0.460930070758497  LUMO (Ag) = -0.105891270537669
cycle= 32 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 7.62e-12  |ddm|= 7.23e-12
HOMO (B3u) = -0.460930070758464  LUMO (Ag) = -0.105891270537322
cycle= 33 E= -75.3850633357271  delta_E= 1.42e-14  |g|= 6.16e-12  |ddm|= 4.84e-12
HOMO (B3u) = -0.460930070758469  LUMO (Ag) = -0.105891270537085
cycle= 34 E= -75.3850633357264  delta_E= 7.53e-13  |g|= 7.23e-12  |ddm|= 2.31e-12
HOMO (B3u) = -0.460930070758433  LUMO (Ag) = -0.105891270536954
cycle= 35 E= -75.3850633357265  delta_E= -1.28e-13  |g|= 6.14e-12  |ddm|= 6.76e-12
HOMO (B3u) = -0.460930070758431  LUMO (Ag) = -0.105891270536864
cycle= 36 E= -75.3850633357264  delta_E= 1.42e-13  |g|= 5.56e-12  |ddm|= 7.83e-12
HOMO (B3u) = -0.46093007075841  LUMO (Ag) = -0.105891270536779
cycle= 37 E= -75.3850633357263  delta_E= 1.14e-13  |g|= 5.32e-12  |ddm|= 8.48e-12
HOMO (B3u) = -0.460930070758368  LUMO (Ag) = -0.105891270536691
cycle= 38 E= -75.3850633357263  delta_E=    0  |g|= 5.26e-12  |ddm|= 8.2e-12
HOMO (B3u) = -0.460930070758071  LUMO (Ag) = -0.105891270536246
Extra cycle  E= -75.3850633357263  delta_E= -2.84e-14  |g|= 1.41e-12  |ddm|= 5.21e-11
converged SCF energy = -75.3850633357263

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpdmbww5qg
max_memory 4000 MB (current use 8388 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5493989307682  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5700624304041  dE = -0.0206635  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5865625736575  dE = -0.016500143  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0532  |maxRot[o]|=0.0764
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5958278724742  dE = -0.0092652988  S^2 = 0.0000000
               |grad[o]|=0.0881  |ddm|=0.0308  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6025782751663  dE = -0.0067504027  S^2 = 0.0000000
               |grad[o]|=0.069  |ddm|=0.0115  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6080413814996  dE = -0.0054631063  S^2 = 0.0000000
               |grad[o]|=0.0545  |ddm|=0.00632  |maxRot[o]|=0.0795
macro iter 6 (6 JK  0 micro), CASSCF E = -75.612329641907  dE = -0.0042882604  S^2 = 0.0000000
               |grad[o]|=0.0425  |ddm|=0.00446  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6155964232374  dE = -0.0032667813  S^2 = 0.0000000
               |grad[o]|=0.0324  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6179389381281  dE = -0.0023425149  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00362  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194233957371  dE = -0.0014844576  S^2 = 0.0000000
               |grad[o]|=0.016  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6201142648621  dE = -0.00069086913  S^2 = 0.0000000
               |grad[o]|=0.00899  |ddm|=0.0039  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201867133788  dE = -7.2448517e-05  S^2 = 0.0000000
               |grad[o]|=0.0028  |ddm|=0.00412  |maxRot[o]|=0.0333
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201877710692  dE = -1.0576904e-06  S^2 = 0.0000000
               |grad[o]|=0.000516  |ddm|=0.00202  |maxRot[o]|=0.00371
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201877952079  dE = -2.4138714e-08  S^2 = 0.0000000
               |grad[o]|=9.22e-05  |ddm|=0.000481  |maxRot[o]|=0.000503
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6201877964234  dE = -1.2154402e-09  S^2 = 0.0000000
               |grad[o]|=2.62e-05  |ddm|=0.000111  |maxRot[o]|=9.43e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6201877964595  dE = -3.6152414e-11  S^2 = 0.0000000
               |grad[o]|=7.47e-06  |ddm|=1.85e-05  |maxRot[o]|=7.33e-06
2-step CASSCF converged in 15 macro (77 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98500901 1.58412241 1.89795628 1.8979566  0.41151822 0.10541178
 0.10541191 0.0126138 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00317   0.00262   0.00000   0.00000  -0.00145
  0 C 2s       0.59002   0.50721   0.00000  -0.00000  -0.38673
  0 C 3s      -0.05064   0.00902   0.00000  -0.00000  -0.01545
  0 C 2px      0.00000  -0.00000  -0.00000   0.70621  -0.00000
  0 C 2py      0.00000   0.00000   0.70621  -0.00000  -0.00000
  0 C 2pz      0.38111  -0.49255   0.00000  -0.00000   0.59034
  0 C 3px      0.00000  -0.00000   0.00000  -0.01351   0.00000
  0 C 3py     -0.00000   0.00000  -0.01351   0.00000  -0.00000
  0 C 3pz     -0.04932  -0.00573   0.00000  -0.00000  -0.03961
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.03283   0.00000  -0.00000
  0 C 3dz^2    0.04041   0.00253   0.00000  -0.00000   0.01144
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03283   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00317  -0.00262   0.00000   0.00000  -0.00145
  1 C 2s       0.59002  -0.50721   0.00000   0.00000  -0.38673
  1 C 3s      -0.05064  -0.00902  -0.00000   0.00000  -0.01545
  1 C 2px     -0.00000   0.00000  -0.00000   0.70621  -0.00000
  1 C 2py      0.00000  -0.00000   0.70621  -0.00000   0.00000
  1 C 2pz     -0.38111  -0.49255   0.00000  -0.00000  -0.59034
  1 C 3px     -0.00000   0.00000   0.00000  -0.01351   0.00000
  1 C 3py     -0.00000  -0.00000  -0.01351   0.00000   0.00000
  1 C 3pz      0.04932  -0.00573   0.00000  -0.00000   0.03961
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03283  -0.00000  -0.00000
  1 C 3dz^2    0.04041  -0.00253  -0.00000   0.00000   0.01144
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03283  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00075
  0 C 2s      -0.00000   0.00000   0.49173
  0 C 3s      -0.00000   0.00000  -0.04330
  0 C 2px      0.70622  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70622   0.00000
  0 C 2pz     -0.00000  -0.00000   0.50534
  0 C 3px     -0.02618  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.02618   0.00000
  0 C 3pz     -0.00000   0.00000   0.00676
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02379   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.03024
  0 C 3dxz    -0.02379  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00075
  1 C 2s       0.00000  -0.00000  -0.49173
  1 C 3s       0.00000  -0.00000   0.04330
  1 C 2px     -0.70622   0.00000   0.00000
  1 C 2py      0.00000  -0.70622   0.00000
  1 C 2pz     -0.00000   0.00000   0.50534
  1 C 3px      0.02618   0.00000   0.00000
  1 C 3py      0.00000   0.02618  -0.00000
  1 C 3pz     -0.00000   0.00000   0.00676
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02379   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03024
  1 C 3dxz    -0.02379  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99486439
<CAS-nat-orb|mo-hf>  4  4    0.99859055
<CAS-nat-orb|mo-hf>  5  5    0.99980387
<CAS-nat-orb|mo-hf>  6  6    0.99980387
<CAS-nat-orb|mo-hf>  7  7    0.97957779
<CAS-nat-orb|mo-hf>  8  8    0.92972100
<CAS-nat-orb|mo-hf>  9  9    0.92972110
<CAS-nat-orb|mo-hf>  10  10    0.45886290
<CAS-nat-orb|mo-hf>  10  17    0.62354822
<CAS-nat-orb|mo-hf>  10  20   -0.57985789
CASSCF energy = -75.6201877964595
CASCI E = -75.6201877964595  E(CI) = -17.857654995827  S^2 = 0.0000000
......production of RDMs took       2.41 sec
......reading the RDM took          0.47 sec
......production of RDMs took      30.18 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.24 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000054110
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000014292
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000849626
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000104777
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000523012
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001139800
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000379933
HMAT symm error =    0.0099859525
E(MRCI) - E(ref) = -0.1037908762265261 DC = -0.00422226697019594
E(WickICMRCISD)   = -75.72397867268606  E_corr_ci = -0.1037908762265261
E(WickICMRCISD+Q) = -75.72820093965626  E_corr_ci = -0.108013143196722
Time cost =   2788.810
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:54:30 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.243566445662 AA    0.000000000000   0.000000000000   2.350000000000 Bohr   0.0

nuclear repulsion = 15.3191489361702
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.175]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    509289.89


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp9ycxpsr2
max_memory 4000 MB (current use 8388 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.520080440469

WARN: Singularity detected in overlap matrix (condition number =  625). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.264198750943281  LUMO (Ag) = -0.186664127921807
cycle= 1 E= -75.3721584993459  delta_E= 0.148  |g|= 0.198  |ddm|= 1.49
HOMO (B3u) = -0.488497893717008  LUMO (Ag) = -0.142939777698254
cycle= 2 E= -75.3860697595072  delta_E= -0.0139  |g|= 0.052  |ddm|= 0.225
HOMO (B2u) = -0.452348284546127  LUMO (Ag) = -0.105756871897142
cycle= 3 E= -75.3868762726882  delta_E= -0.000807  |g|= 0.00951  |ddm|= 0.0641
HOMO (B2u) = -0.453936921014672  LUMO (Ag) = -0.105452022681083
cycle= 4 E= -75.3869305550891  delta_E= -5.43e-05  |g|= 0.00182  |ddm|= 0.034
HOMO (B2u) = -0.4546996704121  LUMO (Ag) = -0.106320748353531
cycle= 5 E= -75.3869327103433  delta_E= -2.16e-06  |g|= 0.00013  |ddm|= 0.0115
HOMO (B2u) = -0.454692197268591  LUMO (Ag) = -0.106342680679353
cycle= 6 E= -75.3869327222535  delta_E= -1.19e-08  |g|= 2.27e-05  |ddm|= 0.00104
HOMO (B3u) = -0.454694399587798  LUMO (Ag) = -0.106353370939731
cycle= 7 E= -75.3869327225934  delta_E= -3.4e-10  |g|= 3.04e-06  |ddm|= 8.49e-05
HOMO (B3u) = -0.454694907644864  LUMO (Ag) = -0.106353839610061
cycle= 8 E= -75.386932722597  delta_E= -3.61e-12  |g|= 2.27e-07  |ddm|= 2.93e-05
HOMO (B3u) = -0.454694923997378  LUMO (Ag) = -0.106353843315644
cycle= 9 E= -75.3869327225971  delta_E= -9.95e-14  |g|= 1.18e-08  |ddm|= 9.54e-07
HOMO (B3u) = -0.454694921257068  LUMO (Ag) = -0.106353838492752
cycle= 10 E= -75.386932722597  delta_E= 7.11e-14  |g|= 6.12e-09  |ddm|= 1.64e-08
HOMO (B3u) = -0.454694923053106  LUMO (Ag) = -0.106353840256013
cycle= 11 E= -75.386932722597  delta_E=    0  |g|= 1.13e-09  |ddm|= 1.31e-08
HOMO (B3u) = -0.454694923185177  LUMO (Ag) = -0.106353840334015
cycle= 12 E= -75.386932722597  delta_E= 2.84e-14  |g|= 9.16e-10  |ddm|= 1.69e-09
HOMO (B3u) = -0.454694923152614  LUMO (Ag) = -0.10635384028109
cycle= 13 E= -75.3869327225971  delta_E= -8.53e-14  |g|= 7.07e-10  |ddm|= 9.3e-10
HOMO (B3u) = -0.454694923167922  LUMO (Ag) = -0.10635384029078
cycle= 14 E= -75.3869327225971  delta_E= -8.53e-14  |g|= 6.99e-10  |ddm|= 1.25e-09
HOMO (B3u) = -0.454694923166705  LUMO (Ag) = -0.106353840308747
cycle= 15 E= -75.3869327225971  delta_E= 4.26e-14  |g|= 6.17e-10  |ddm|= 9.49e-10
HOMO (B3u) = -0.454694923134383  LUMO (Ag) = -0.106353840280398
cycle= 16 E= -75.3869327225971  delta_E= 1.42e-14  |g|= 5.53e-10  |ddm|= 5.93e-10
HOMO (B3u) = -0.454694923091051  LUMO (Ag) = -0.106353840262767
cycle= 17 E= -75.3869327225971  delta_E= -4.26e-14  |g|= 5.8e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.454694923115489  LUMO (Ag) = -0.106353840230181
cycle= 18 E= -75.386932722597  delta_E= 9.95e-14  |g|= 2.91e-10  |ddm|= 6.62e-10
HOMO (B3u) = -0.45469492307463  LUMO (Ag) = -0.106353840179431
cycle= 19 E= -75.386932722597  delta_E= -1.42e-14  |g|= 1.54e-10  |ddm|= 4.73e-10
HOMO (B3u) = -0.454694923074661  LUMO (Ag) = -0.106353840176675
cycle= 20 E= -75.386932722597  delta_E= 1.42e-14  |g|= 1.33e-10  |ddm|= 4.1e-11
HOMO (B3u) = -0.454694923078883  LUMO (Ag) = -0.106353840178033
cycle= 21 E= -75.386932722597  delta_E= 2.84e-14  |g|= 1.13e-10  |ddm|= 5.49e-11
HOMO (B3u) = -0.454694923081384  LUMO (Ag) = -0.106353840178701
cycle= 22 E= -75.386932722597  delta_E= 2.84e-14  |g|= 9.75e-11  |ddm|= 3.59e-11
HOMO (B2u) = -0.454694923082686  LUMO (Ag) = -0.106353840178386
cycle= 23 E= -75.3869327225969  delta_E= 9.95e-14  |g|= 8.05e-11  |ddm|= 4.14e-11
HOMO (B2u) = -0.454694923084145  LUMO (Ag) = -0.106353840177026
cycle= 24 E= -75.386932722597  delta_E= -9.95e-14  |g|= 6.38e-11  |ddm|= 5.82e-11
HOMO (B2u) = -0.454694923085147  LUMO (Ag) = -0.106353840175222
cycle= 25 E= -75.386932722597  delta_E= -2.84e-14  |g|= 4.88e-11  |ddm|= 4.28e-11
HOMO (B2u) = -0.454694923086528  LUMO (Ag) = -0.106353840173288
cycle= 26 E= -75.386932722597  delta_E= 1.42e-14  |g|= 3.33e-11  |ddm|= 2.75e-11
HOMO (B2u) = -0.454694923087892  LUMO (Ag) = -0.106353840173314
cycle= 27 E= -75.3869327225968  delta_E= 2.13e-13  |g|= 2.73e-11  |ddm|= 1.4e-11
HOMO (B2u) = -0.454694923087462  LUMO (Ag) = -0.106353840172129
cycle= 28 E= -75.3869327225969  delta_E= -8.53e-14  |g|= 2.3e-11  |ddm|= 1.07e-11
HOMO (B2u) = -0.454694923087019  LUMO (Ag) = -0.106353840171012
cycle= 29 E= -75.3869327225969  delta_E= -5.68e-14  |g|= 1.91e-11  |ddm|= 1.06e-11
HOMO (B2u) = -0.454694923086699  LUMO (Ag) = -0.106353840170074
cycle= 30 E= -75.3869327225969  delta_E= 1.42e-14  |g|= 1.56e-11  |ddm|= 1.12e-11
HOMO (B2u) = -0.454694923086464  LUMO (Ag) = -0.10635384016925
cycle= 31 E= -75.3869327225969  delta_E=    0  |g|= 1.28e-11  |ddm|= 1.15e-11
HOMO (B2u) = -0.454694923086332  LUMO (Ag) = -0.106353840167362
Extra cycle  E= -75.3869327225968  delta_E= 8.53e-14  |g|= 4.59e-12  |ddm|= 3.16e-11
converged SCF energy = -75.3869327225968

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp9ycxpsr2
max_memory 4000 MB (current use 8388 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5529956225487  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5742290470542  dE = -0.021233425  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5907012103413  dE = -0.016472163  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0556  |maxRot[o]|=0.078
macro iter 3 (6 JK  0 micro), CASSCF E = -75.599990129704  dE = -0.0092889194  S^2 = 0.0000000
               |grad[o]|=0.0873  |ddm|=0.0313  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066440843297  dE = -0.0066539546  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.012  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6117794056629  dE = -0.0051353213  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.00672  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6158225575415  dE = -0.0040431519  S^2 = 0.0000000
               |grad[o]|=0.042  |ddm|=0.00468  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.618916517366  dE = -0.0030939598  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00395  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6211360444137  dE = -0.002219527  S^2 = 0.0000000
               |grad[o]|=0.0235  |ddm|=0.00375  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.622534244659  dE = -0.0013982002  S^2 = 0.0000000
               |grad[o]|=0.0158  |ddm|=0.0038  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6231661133442  dE = -0.00063186869  S^2 = 0.0000000
               |grad[o]|=0.00874  |ddm|=0.00396  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6232125399936  dE = -4.6426649e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.00421  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6232205419479  dE = -8.0019544e-06  S^2 = 0.0000000
               |grad[o]|=0.00103  |ddm|=0.00125  |maxRot[o]|=0.0111
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6232206696267  dE = -1.276788e-07  S^2 = 0.0000000
               |grad[o]|=0.000188  |ddm|=0.000798  |maxRot[o]|=0.00125
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6232206732045  dE = -3.5777816e-09  S^2 = 0.0000000
               |grad[o]|=3.57e-05  |ddm|=0.000182  |maxRot[o]|=0.000178
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6232206732845  dE = -7.9950269e-11  S^2 = 0.0000000
               |grad[o]|=7.94e-06  |ddm|=3.68e-05  |maxRot[o]|=2.3e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6232206732852  dE = -6.9633188e-13  S^2 = 0.0000000
               |grad[o]|=1.25e-06  |ddm|=4.2e-06  |maxRot[o]|=3.15e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98422473 1.59822006 1.89166117 1.89166115 0.39748969 0.11168497
 0.11168493 0.0133733 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00356   0.00273   0.00000   0.00000  -0.00136
  0 C 2s       0.59304   0.51564   0.00000   0.00000  -0.38216
  0 C 3s      -0.04903   0.00893   0.00000   0.00000  -0.01244
  0 C 2px      0.00000   0.00000  -0.00000   0.70632  -0.00000
  0 C 2py      0.00000  -0.00000   0.70632   0.00000  -0.00000
  0 C 2pz      0.37694  -0.48373   0.00000   0.00000   0.59331
  0 C 3px      0.00000   0.00000  -0.00000  -0.00987  -0.00000
  0 C 3py      0.00000  -0.00000  -0.00987  -0.00000   0.00000
  0 C 3pz     -0.04768  -0.00519   0.00000   0.00000  -0.04045
  0 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03194  -0.00000   0.00000
  0 C 3dz^2    0.03910   0.00193   0.00000   0.00000   0.01197
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03194  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00356  -0.00273   0.00000   0.00000  -0.00136
  1 C 2s       0.59304  -0.51564   0.00000   0.00000  -0.38216
  1 C 3s      -0.04903  -0.00893  -0.00000  -0.00000  -0.01244
  1 C 2px     -0.00000  -0.00000   0.00000   0.70632   0.00000
  1 C 2py     -0.00000   0.00000   0.70632   0.00000  -0.00000
  1 C 2pz     -0.37694  -0.48373   0.00000  -0.00000  -0.59331
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00987   0.00000
  1 C 3py     -0.00000   0.00000  -0.00987   0.00000  -0.00000
  1 C 3pz      0.04768  -0.00519   0.00000   0.00000   0.04045
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03194  -0.00000   0.00000
  1 C 3dz^2    0.03910  -0.00193  -0.00000  -0.00000   0.01197
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03194  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00071
  0 C 2s       0.00000   0.00000   0.48298
  0 C 3s       0.00000   0.00000  -0.04305
  0 C 2px      0.70627   0.00000  -0.00000
  0 C 2py     -0.00000   0.70627   0.00000
  0 C 2pz      0.00000   0.00000   0.51383
  0 C 3px     -0.02494   0.00000  -0.00000
  0 C 3py      0.00000  -0.02494   0.00000
  0 C 3pz     -0.00000   0.00000   0.00873
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02373   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02798
  0 C 3dxz    -0.02373   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00071
  1 C 2s       0.00000  -0.00000  -0.48298
  1 C 3s      -0.00000  -0.00000   0.04305
  1 C 2px     -0.70627  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70627  -0.00000
  1 C 2pz     -0.00000   0.00000   0.51383
  1 C 3px      0.02494  -0.00000   0.00000
  1 C 3py     -0.00000   0.02494  -0.00000
  1 C 3pz      0.00000   0.00000   0.00873
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02373   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02798
  1 C 3dxz    -0.02373   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99460038
<CAS-nat-orb|mo-hf>  4  4    0.99853698
<CAS-nat-orb|mo-hf>  5  5    0.99978677
<CAS-nat-orb|mo-hf>  6  6    0.99978677
<CAS-nat-orb|mo-hf>  7  7    0.97901210
<CAS-nat-orb|mo-hf>  8  8    0.93514181
<CAS-nat-orb|mo-hf>  9  9    0.93514178
<CAS-nat-orb|mo-hf>  10  10    0.47490998
<CAS-nat-orb|mo-hf>  10  17    0.64513856
<CAS-nat-orb|mo-hf>  10  20   -0.55018538
CASSCF energy = -75.6232206732852
CASCI E = -75.6232206732852  E(CI) = -17.7126744233999  S^2 = 0.0000000
......production of RDMs took       2.21 sec
......reading the RDM took          0.47 sec
......production of RDMs took      28.51 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.58 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000115184
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000030424
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001198069
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000127772
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000753665
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001640768
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000546923
HMAT symm error =    0.0179177081
E(MRCI) - E(ref) = -0.1040448027925152 DC = -0.004269275778465392
E(WickICMRCISD)   = -75.72726547607769  E_corr_ci = -0.1040448027925152
E(WickICMRCISD+Q) = -75.73153475185616  E_corr_ci = -0.1083140785709805
Time cost =   2956.259
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 00:43:47 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.270025306208 AA    0.000000000000   0.000000000000   2.400000000000 Bohr   0.0

nuclear repulsion = 15
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.2]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    556987.14


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpxt_i_uxu
max_memory 4000 MB (current use 8396 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4681036266052

WARN: Singularity detected in overlap matrix (condition number =  573). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.253350702957071  LUMO (Ag) = -0.183612207324933
cycle= 1 E= -75.3711621684052  delta_E= 0.0969  |g|= 0.203  |ddm|= 1.48
HOMO (B3u) = -0.483102395155572  LUMO (Ag) = -0.145014054403864
cycle= 2 E= -75.3857253013105  delta_E= -0.0146  |g|= 0.052  |ddm|= 0.234
HOMO (B2u) = -0.446604227160941  LUMO (Ag) = -0.106629940030307
cycle= 3 E= -75.3865468682808  delta_E= -0.000822  |g|= 0.00932  |ddm|= 0.0615
HOMO (B3u) = -0.44799076917457  LUMO (Ag) = -0.105837943292174
cycle= 4 E= -75.3865987559146  delta_E= -5.19e-05  |g|= 0.00179  |ddm|= 0.0304
HOMO (B3u) = -0.448742110750612  LUMO (Ag) = -0.106605000995193
cycle= 5 E= -75.3866008121181  delta_E= -2.06e-06  |g|= 7.74e-05  |ddm|= 0.0104
HOMO (B2u) = -0.448735377102867  LUMO (Ag) = -0.106607023368654
cycle= 6 E= -75.3866008154598  delta_E= -3.34e-09  |g|= 1.47e-05  |ddm|= 0.000795
HOMO (B3u) = -0.448736161720342  LUMO (Ag) = -0.106613403607842
cycle= 7 E= -75.3866008156198  delta_E= -1.6e-10  |g|= 2.92e-06  |ddm|= 4.96e-05
HOMO (B3u) = -0.448736721595753  LUMO (Ag) = -0.10661423343487
cycle= 8 E= -75.3866008156237  delta_E= -3.96e-12  |g|= 2.59e-07  |ddm|= 1.95e-05
HOMO (B3u) = -0.448736741737759  LUMO (Ag) = -0.106614252118962
cycle= 9 E= -75.3866008156237  delta_E= 4.26e-14  |g|= 1.3e-08  |ddm|= 1.45e-06
HOMO (B3u) = -0.448736740751524  LUMO (Ag) = -0.106614250131367
cycle= 10 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 5.79e-09  |ddm|= 2.13e-08
HOMO (B3u) = -0.448736740319986  LUMO (Ag) = -0.106614249152993
cycle= 11 E= -75.3866008156238  delta_E= -4.26e-14  |g|= 1.24e-09  |ddm|= 1.24e-08
HOMO (B3u) = -0.448736740437401  LUMO (Ag) = -0.106614249218276
cycle= 12 E= -75.3866008156237  delta_E= 7.11e-14  |g|= 9.73e-10  |ddm|= 9.72e-10
HOMO (B3u) = -0.448736740404328  LUMO (Ag) = -0.106614249162894
cycle= 13 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 7.76e-10  |ddm|= 6.89e-10
HOMO (B3u) = -0.44873674043406  LUMO (Ag) = -0.106614249171016
cycle= 14 E= -75.3866008156238  delta_E= 1.42e-14  |g|= 7.65e-10  |ddm|= 1.78e-09
HOMO (B3u) = -0.44873674043865  LUMO (Ag) = -0.106614249220386
cycle= 15 E= -75.3866008156237  delta_E= 2.84e-14  |g|= 6.9e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.448736740358197  LUMO (Ag) = -0.106614249169878
cycle= 16 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 6.73e-10  |ddm|= 1.38e-09
HOMO (B3u) = -0.448736740337378  LUMO (Ag) = -0.106614249142488
cycle= 17 E= -75.3866008156237  delta_E= 7.11e-14  |g|= 6.33e-10  |ddm|= 9.34e-10
HOMO (B3u) = -0.448736740348743  LUMO (Ag) = -0.106614249099353
cycle= 18 E= -75.3866008156239  delta_E= -1.56e-13  |g|= 3.13e-10  |ddm|= 8.01e-10
HOMO (B3u) = -0.448736740350463  LUMO (Ag) = -0.106614249078725
cycle= 19 E= -75.3866008156238  delta_E= 9.95e-14  |g|= 1.76e-10  |ddm|= 3.28e-10
HOMO (B3u) = -0.448736740350676  LUMO (Ag) = -0.106614249075953
cycle= 20 E= -75.3866008156238  delta_E=    0  |g|= 1.52e-10  |ddm|= 5.47e-11
HOMO (B3u) = -0.448736740354209  LUMO (Ag) = -0.106614249076774
cycle= 21 E= -75.3866008156237  delta_E= 5.68e-14  |g|= 1.32e-10  |ddm|= 5.84e-11
HOMO (B3u) = -0.448736740356053  LUMO (Ag) = -0.106614249077039
cycle= 22 E= -75.3866008156237  delta_E= -2.84e-14  |g|= 1.16e-10  |ddm|= 4.3e-11
HOMO (B3u) = -0.448736740356319  LUMO (Ag) = -0.106614249076548
cycle= 23 E= -75.3866008156237  delta_E= 2.84e-14  |g|= 9.81e-11  |ddm|= 4.71e-11
HOMO (B3u) = -0.448736740357484  LUMO (Ag) = -0.106614249074614
cycle= 24 E= -75.3866008156237  delta_E=    0  |g|= 7.92e-11  |ddm|= 6.7e-11
HOMO (B3u) = -0.448736740356556  LUMO (Ag) = -0.106614249063653
Extra cycle  E= -75.3866008156237  delta_E= -4.26e-14  |g|= 2.58e-11  |ddm|= 1.01e-10
converged SCF energy = -75.3866008156237

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpxt_i_uxu
max_memory 4000 MB (current use 8396 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5544099472186  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.576212139435  dE = -0.021802192  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5926062291368  dE = -0.01639409  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0581  |maxRot[o]|=0.0789
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6014965894492  dE = -0.0088903603  S^2 = 0.0000000
               |grad[o]|=0.0866  |ddm|=0.0319  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6078348960793  dE = -0.0063383066  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.0122  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6128018721597  dE = -0.0049669761  S^2 = 0.0000000
               |grad[o]|=0.054  |ddm|=0.00703  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6167385513615  dE = -0.0039366792  S^2 = 0.0000000
               |grad[o]|=0.0426  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6197655962113  dE = -0.0030270448  S^2 = 0.0000000
               |grad[o]|=0.0328  |ddm|=0.00419  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6219462136258  dE = -0.0021806174  S^2 = 0.0000000
               |grad[o]|=0.0241  |ddm|=0.0039  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6233258202903  dE = -0.0013796067  S^2 = 0.0000000
               |grad[o]|=0.0162  |ddm|=0.00388  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6239528534227  dE = -0.00062703313  S^2 = 0.0000000
               |grad[o]|=0.00898  |ddm|=0.00404  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6239994853785  dE = -4.6631956e-05  S^2 = 0.0000000
               |grad[o]|=0.00253  |ddm|=0.00433  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6240076586899  dE = -8.1733113e-06  S^2 = 0.0000000
               |grad[o]|=0.00105  |ddm|=0.00127  |maxRot[o]|=0.0113
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6240077847723  dE = -1.2608248e-07  S^2 = 0.0000000
               |grad[o]|=0.000187  |ddm|=0.000797  |maxRot[o]|=0.00122
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6240077881029  dE = -3.3305696e-09  S^2 = 0.0000000
               |grad[o]|=3.42e-05  |ddm|=0.000172  |maxRot[o]|=0.000172
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6240077881796  dE = -7.6681772e-11  S^2 = 0.0000000
               |grad[o]|=8.17e-06  |ddm|=3.54e-05  |maxRot[o]|=2.2e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6240077881816  dE = -1.9895197e-12  S^2 = 0.0000000
               |grad[o]|=1.32e-06  |ddm|=6.64e-06  |maxRot[o]|=3.13e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98341795 1.61142026 1.88510477 1.88510533 0.38447454 0.11816034
 0.11816031 0.01415649]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00394   0.00282   0.00000   0.00000  -0.00128
  0 C 2s       0.59610   0.52384   0.00000  -0.00000  -0.37748
  0 C 3s      -0.04733   0.00887   0.00000  -0.00000  -0.00946
  0 C 2px      0.00000  -0.00000  -0.00000   0.70639  -0.00000
  0 C 2py     -0.00000   0.00000   0.70639  -0.00000  -0.00000
  0 C 2pz      0.37264  -0.47485  -0.00000  -0.00000   0.59629
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00643  -0.00000
  0 C 3py     -0.00000   0.00000  -0.00643  -0.00000  -0.00000
  0 C 3pz     -0.04603  -0.00469   0.00000  -0.00000  -0.04119
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.03106  -0.00000  -0.00000
  0 C 3dz^2    0.03783   0.00135   0.00000  -0.00000   0.01265
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03106  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00394  -0.00282   0.00000   0.00000  -0.00128
  1 C 2s       0.59610  -0.52384  -0.00000   0.00000  -0.37748
  1 C 3s      -0.04733  -0.00887  -0.00000   0.00000  -0.00946
  1 C 2px      0.00000   0.00000   0.00000   0.70639   0.00000
  1 C 2py      0.00000  -0.00000   0.70639   0.00000   0.00000
  1 C 2pz     -0.37264  -0.47485  -0.00000  -0.00000  -0.59629
  1 C 3px     -0.00000   0.00000   0.00000  -0.00643   0.00000
  1 C 3py      0.00000  -0.00000  -0.00643   0.00000   0.00000
  1 C 3pz      0.04603  -0.00469   0.00000  -0.00000   0.04119
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.03106  -0.00000  -0.00000
  1 C 3dz^2    0.03783  -0.00135  -0.00000   0.00000   0.01265
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03106  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00067
  0 C 2s       0.00000   0.00000   0.47414
  0 C 3s      -0.00000   0.00000  -0.04292
  0 C 2px      0.70631  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70631  -0.00000
  0 C 2pz      0.00000  -0.00000   0.52207
  0 C 3px     -0.02380   0.00000   0.00000
  0 C 3py      0.00000  -0.02380  -0.00000
  0 C 3pz     -0.00000   0.00000   0.01059
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02366   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02618
  0 C 3dxz    -0.02366   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00067
  1 C 2s       0.00000  -0.00000  -0.47414
  1 C 3s       0.00000  -0.00000   0.04292
  1 C 2px     -0.70631  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70631   0.00000
  1 C 2pz     -0.00000  -0.00000   0.52207
  1 C 3px      0.02380   0.00000   0.00000
  1 C 3py      0.00000   0.02380   0.00000
  1 C 3pz     -0.00000   0.00000   0.01059
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02366  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02618
  1 C 3dxz    -0.02366  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99432404
<CAS-nat-orb|mo-hf>  4  4    0.99847304
<CAS-nat-orb|mo-hf>  5  5    0.99976738
<CAS-nat-orb|mo-hf>  6  6    0.99976738
<CAS-nat-orb|mo-hf>  7  7    0.97845223
<CAS-nat-orb|mo-hf>  8  8    0.94007722
<CAS-nat-orb|mo-hf>  9  9    0.94007728
<CAS-nat-orb|mo-hf>  10  10    0.49233343
<CAS-nat-orb|mo-hf>  10  17    0.66275073
<CAS-nat-orb|mo-hf>  10  20   -0.52046337
CASSCF energy = -75.6240077881816
CASCI E = -75.6240077881816  E(CI) = -17.5716139909121  S^2 = 0.0000000
......production of RDMs took       5.03 sec
......reading the RDM took          0.46 sec
......production of RDMs took      53.15 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.15 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000054902
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000014502
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000783543
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000090026
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000487512
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001141279
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000380426
HMAT symm error =    0.0098934683
E(MRCI) - E(ref) = -0.1042998513463544 DC = -0.004316875517400236
E(WickICMRCISD)   = -75.72830763952794  E_corr_ci = -0.1042998513463544
E(WickICMRCISD+Q) = -75.73262451504534  E_corr_ci = -0.1086167268637547
Time cost =   2883.223
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 01:31:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.296484166754 AA    0.000000000000   0.000000000000   2.450000000000 Bohr   0.0

nuclear repulsion = 14.6938775510204
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.225]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    602247.90


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmprulrz9o4
max_memory 4000 MB (current use 8388 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4178541557328

WARN: Singularity detected in overlap matrix (condition number =  525). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.243088233296001  LUMO (Ag) = -0.180721513540292
cycle= 1 E= -75.3682765376263  delta_E= 0.0496  |g|= 0.207  |ddm|= 1.47
HOMO (B2u) = -0.477856195390327  LUMO (Ag) = -0.146786594446605
cycle= 2 E= -75.3835137621145  delta_E= -0.0152  |g|= 0.0521  |ddm|= 0.243
HOMO (B2u) = -0.441063789154574  LUMO (Ag) = -0.107250630527329
cycle= 3 E= -75.3843533836983  delta_E= -0.00084  |g|= 0.00929  |ddm|= 0.0595
HOMO (B2u) = -0.442295646912942  LUMO (Ag) = -0.106015245128841
cycle= 4 E= -75.3844049545557  delta_E= -5.16e-05  |g|= 0.0018  |ddm|= 0.0274
HOMO (B2u) = -0.443045442143855  LUMO (Ag) = -0.106700546721384
cycle= 5 E= -75.3844070231975  delta_E= -2.07e-06  |g|= 7.54e-05  |ddm|= 0.0094
HOMO (B3u) = -0.443032060379307  LUMO (Ag) = -0.106682393250684
cycle= 6 E= -75.3844070255161  delta_E= -2.32e-09  |g|= 1.3e-05  |ddm|= 0.00058
HOMO (B3u) = -0.443029779172082  LUMO (Ag) = -0.106680098001436
cycle= 7 E= -75.3844070256074  delta_E= -9.14e-11  |g|= 1.64e-06  |ddm|= 2.88e-05
HOMO (B2u) = -0.443029714305112  LUMO (Ag) = -0.106679671912371
cycle= 8 E= -75.3844070256093  delta_E= -1.85e-12  |g|= 2.42e-07  |ddm|= 1.68e-05
HOMO (B2u) = -0.443029690449364  LUMO (Ag) = -0.106679577828792
cycle= 9 E= -75.3844070256094  delta_E= -8.53e-14  |g|= 1.45e-08  |ddm|= 6.37e-07
HOMO (B2u) = -0.443029691481266  LUMO (Ag) = -0.106679578764971
cycle= 10 E= -75.3844070256094  delta_E= -7.11e-14  |g|= 7.83e-09  |ddm|= 1.24e-08
HOMO (B3u) = -0.44302968809759  LUMO (Ag) = -0.106679573968627
cycle= 11 E= -75.3844070256093  delta_E= 9.95e-14  |g|= 1.35e-09  |ddm|= 2.39e-08
HOMO (B3u) = -0.443029688180344  LUMO (Ag) = -0.106679573991998
cycle= 12 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 1e-09  |ddm|= 5.75e-10
HOMO (B3u) = -0.443029688159278  LUMO (Ag) = -0.106679573949154
cycle= 13 E= -75.3844070256094  delta_E=    0  |g|= 8.03e-10  |ddm|= 4.93e-10
HOMO (B2u) = -0.443029688192494  LUMO (Ag) = -0.106679573942763
cycle= 14 E= -75.3844070256093  delta_E= 9.95e-14  |g|= 7.7e-10  |ddm|= 1.61e-09
HOMO (B2u) = -0.443029688177654  LUMO (Ag) = -0.106679573918279
cycle= 15 E= -75.3844070256094  delta_E= -1.14e-13  |g|= 6.85e-10  |ddm|= 1.8e-10
HOMO (B3u) = -0.443029688159958  LUMO (Ag) = -0.106679573896859
cycle= 16 E= -75.3844070256094  delta_E= 1.42e-14  |g|= 6.1e-10  |ddm|= 4.14e-10
HOMO (B3u) = -0.443029688049667  LUMO (Ag) = -0.106679573933517
cycle= 17 E= -75.3844070256093  delta_E= 1.42e-14  |g|= 7.87e-10  |ddm|= 5.88e-10
HOMO (B3u) = -0.443029688062134  LUMO (Ag) = -0.106679573857409
cycle= 18 E= -75.3844070256094  delta_E= -4.26e-14  |g|= 4.09e-10  |ddm|= 7.25e-10
HOMO (B3u) = -0.443029688139514  LUMO (Ag) = -0.106679573881841
cycle= 19 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 1.85e-10  |ddm|= 5.25e-10
HOMO (B3u) = -0.443029688139996  LUMO (Ag) = -0.106679573878203
cycle= 20 E= -75.3844070256094  delta_E= 1.42e-14  |g|= 1.57e-10  |ddm|= 6.58e-11
HOMO (B3u) = -0.44302968814238  LUMO (Ag) = -0.106679573877668
cycle= 21 E= -75.3844070256094  delta_E= 2.84e-14  |g|= 1.36e-10  |ddm|= 5.73e-11
HOMO (B3u) = -0.443029688143706  LUMO (Ag) = -0.106679573876974
cycle= 22 E= -75.3844070256092  delta_E= 1.14e-13  |g|= 1.2e-10  |ddm|= 4.64e-11
HOMO (B3u) = -0.443029688143302  LUMO (Ag) = -0.106679573876223
cycle= 23 E= -75.3844070256092  delta_E= 1.42e-14  |g|= 1.02e-10  |ddm|= 3.87e-11
HOMO (B3u) = -0.443029688142368  LUMO (Ag) = -0.106679573875259
cycle= 24 E= -75.3844070256093  delta_E= -2.84e-14  |g|= 8.63e-11  |ddm|= 3.82e-11
HOMO (B3u) = -0.443029688141286  LUMO (Ag) = -0.106679573874444
cycle= 25 E= -75.3844070256093  delta_E=    0  |g|= 7.37e-11  |ddm|= 3.01e-11
HOMO (B3u) = -0.443029688136573  LUMO (Ag) = -0.106679573860742
Extra cycle  E= -75.3844070256092  delta_E= 2.84e-14  |g|= 2.58e-11  |ddm|= 9.55e-11
converged SCF energy = -75.3844070256092

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmprulrz9o4
max_memory 4000 MB (current use 8388 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5539827086622  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5763523954714  dE = -0.022369687  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5917534042895  dE = -0.015401009  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0607  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6003903624947  dE = -0.0086369582  S^2 = 0.0000000
               |grad[o]|=0.0877  |ddm|=0.031  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066555455683  dE = -0.0062651831  S^2 = 0.0000000
               |grad[o]|=0.0695  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6115936589418  dE = -0.0049381134  S^2 = 0.0000000
               |grad[o]|=0.0556  |ddm|=0.00767  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6155228056333  dE = -0.0039291467  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00553  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6185576167745  dE = -0.0030348111  S^2 = 0.0000000
               |grad[o]|=0.0341  |ddm|=0.00451  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6207571529027  dE = -0.0021995361  S^2 = 0.0000000
               |grad[o]|=0.0252  |ddm|=0.00407  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6221628799135  dE = -0.001405727  S^2 = 0.0000000
               |grad[o]|=0.017  |ddm|=0.00399  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6228190303294  dE = -0.00065615042  S^2 = 0.0000000
               |grad[o]|=0.00956  |ddm|=0.00414  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.62288497625  dE = -6.5945921e-05  S^2 = 0.0000000
               |grad[o]|=0.00283  |ddm|=0.00447  |maxRot[o]|=0.0322
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6228858545739  dE = -8.7832385e-07  S^2 = 0.0000000
               |grad[o]|=0.000486  |ddm|=0.00205  |maxRot[o]|=0.00325
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6228858730539  dE = -1.8479994e-08  S^2 = 0.0000000
               |grad[o]|=7.94e-05  |ddm|=0.000394  |maxRot[o]|=0.000414
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6228858738661  dE = -8.1219298e-10  S^2 = 0.0000000
               |grad[o]|=2.09e-05  |ddm|=8.49e-05  |maxRot[o]|=8.19e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6228858738916  dE = -2.5508484e-11  S^2 = 0.0000000
               |grad[o]|=5.75e-06  |ddm|=1.23e-05  |maxRot[o]|=5.91e-06
2-step CASSCF converged in 15 macro (77 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98259231 1.62382549 1.87827403 1.87827425 0.37239076 0.12484096
 0.12484103 0.01496118]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00430   0.00292   0.00000   0.00000  -0.00121
  0 C 2s       0.59918   0.53182   0.00000  -0.00000  -0.37268
  0 C 3s      -0.04557   0.00882   0.00000  -0.00000  -0.00652
  0 C 2px      0.00000  -0.00000  -0.00000   0.70645   0.00000
  0 C 2py      0.00000   0.00000   0.70645  -0.00000  -0.00000
  0 C 2pz      0.36821  -0.46590  -0.00000   0.00000   0.59928
  0 C 3px      0.00000  -0.00000   0.00000  -0.00317  -0.00000
  0 C 3py      0.00000   0.00000  -0.00317  -0.00000  -0.00000
  0 C 3pz     -0.04436  -0.00424   0.00000  -0.00000  -0.04182
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.03019  -0.00000  -0.00000
  0 C 3dz^2    0.03661   0.00082   0.00000  -0.00000   0.01349
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03019  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00430  -0.00292   0.00000   0.00000  -0.00121
  1 C 2s       0.59918  -0.53182   0.00000   0.00000  -0.37268
  1 C 3s      -0.04557  -0.00882  -0.00000   0.00000  -0.00652
  1 C 2px     -0.00000   0.00000  -0.00000   0.70645   0.00000
  1 C 2py     -0.00000  -0.00000   0.70645  -0.00000  -0.00000
  1 C 2pz     -0.36821  -0.46590   0.00000  -0.00000  -0.59928
  1 C 3px     -0.00000   0.00000   0.00000  -0.00317  -0.00000
  1 C 3py     -0.00000  -0.00000  -0.00317   0.00000   0.00000
  1 C 3pz      0.04436  -0.00424   0.00000  -0.00000   0.04182
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03019  -0.00000  -0.00000
  1 C 3dz^2    0.03661  -0.00082  -0.00000   0.00000   0.01349
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.03019   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00063
  0 C 2s      -0.00000   0.00000   0.46522
  0 C 3s      -0.00000   0.00000  -0.04289
  0 C 2px      0.70635  -0.00000  -0.00000
  0 C 2py      0.00000   0.70635   0.00000
  0 C 2pz     -0.00000  -0.00000   0.53006
  0 C 3px     -0.02272   0.00000  -0.00000
  0 C 3py      0.00000  -0.02272   0.00000
  0 C 3pz     -0.00000   0.00000   0.01231
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02357   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02477
  0 C 3dxz    -0.02357   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00063
  1 C 2s       0.00000  -0.00000  -0.46522
  1 C 3s       0.00000  -0.00000   0.04289
  1 C 2px     -0.70635  -0.00000   0.00000
  1 C 2py      0.00000  -0.70635  -0.00000
  1 C 2pz     -0.00000   0.00000   0.53006
  1 C 3px      0.02272  -0.00000   0.00000
  1 C 3py     -0.00000   0.02272  -0.00000
  1 C 3pz     -0.00000   0.00000   0.01231
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02357   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02477
  1 C 3dxz    -0.02357   0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99403737
<CAS-nat-orb|mo-hf>  4  4    0.99839931
<CAS-nat-orb|mo-hf>  5  5    0.99974564
<CAS-nat-orb|mo-hf>  6  6    0.99974564
<CAS-nat-orb|mo-hf>  7  7    0.97790000
<CAS-nat-orb|mo-hf>  8  8    0.94457118
<CAS-nat-orb|mo-hf>  9  9    0.94457122
<CAS-nat-orb|mo-hf>  10  10    0.51114068
<CAS-nat-orb|mo-hf>  10  17    0.67613239
<CAS-nat-orb|mo-hf>  10  18   -0.49120211
CASSCF energy = -75.6228858738916
CASCI E = -75.6228858738916  E(CI) = -17.4344344666046  S^2 = 0.0000000
......production of RDMs took       2.23 sec
......reading the RDM took          0.46 sec
......production of RDMs took      28.36 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.37 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000323378
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000085415
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001127656
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000120657
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000730105
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001362970
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000454323
HMAT symm error =    0.0120522008
E(MRCI) - E(ref) = -0.1045587876187284 DC = -0.004365419818404495
E(WickICMRCISD)   = -75.72744466151029  E_corr_ci = -0.1045587876187284
E(WickICMRCISD+Q) = -75.73181008132869  E_corr_ci = -0.1089242074371329
Time cost =   2789.329
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 02:18:19 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.322943027300 AA    0.000000000000   0.000000000000   2.500000000000 Bohr   0.0

nuclear repulsion = 14.4
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.25]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    648502.79


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpb7tx6a9l
max_memory 4000 MB (current use 8388 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.3694175262293

WARN: Singularity detected in overlap matrix (condition number =  483). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.23337660812262  LUMO (Ag) = -0.177980136770163
cycle= 1 E= -75.3638092539421  delta_E= 0.00561  |g|= 0.211  |ddm|= 1.47
HOMO (B3u) = -0.472745514482944  LUMO (Ag) = -0.148264279814741
cycle= 2 E= -75.3797344374882  delta_E= -0.0159  |g|= 0.0521  |ddm|= 0.252
HOMO (B2u) = -0.435707130637764  LUMO (Ag) = -0.10762354329793
cycle= 3 E= -75.3805941182358  delta_E= -0.00086  |g|= 0.00941  |ddm|= 0.058
HOMO (B2u) = -0.43682644742338  LUMO (Ag) = -0.105984728580028
cycle= 4 E= -75.3806472395887  delta_E= -5.31e-05  |g|= 0.00184  |ddm|= 0.0247
HOMO (B3u) = -0.437581210136121  LUMO (Ag) = -0.106606422286032
cycle= 5 E= -75.3806494262656  delta_E= -2.19e-06  |g|= 0.000123  |ddm|= 0.0084
HOMO (B3u) = -0.437555273305047  LUMO (Ag) = -0.106565393729154
cycle= 6 E= -75.3806494342396  delta_E= -7.97e-09  |g|= 2.47e-05  |ddm|= 0.000449
HOMO (B3u) = -0.437550531930258  LUMO (Ag) = -0.106557643143761
cycle= 7 E= -75.3806494346655  delta_E= -4.26e-10  |g|= 3.1e-06  |ddm|= 0.000106
HOMO (B2u) = -0.437550642586866  LUMO (Ag) = -0.106557057009268
cycle= 8 E= -75.380649434671  delta_E= -5.43e-12  |g|= 3.13e-07  |ddm|= 2.83e-05
HOMO (B3u) = -0.437550627656463  LUMO (Ag) = -0.106556986157319
cycle= 9 E= -75.380649434671  delta_E= 1.42e-14  |g|= 1.55e-08  |ddm|= 1.79e-06
HOMO (B2u) = -0.437550624651401  LUMO (Ag) = -0.106556982907058
cycle= 10 E= -75.380649434671  delta_E= -7.11e-14  |g|= 1.93e-09  |ddm|= 3.85e-08
HOMO (B2u) = -0.437550624780239  LUMO (Ag) = -0.106556982982804
cycle= 11 E= -75.380649434671  delta_E= 7.11e-14  |g|= 1.07e-09  |ddm|= 2.21e-09
HOMO (B2u) = -0.437550625017937  LUMO (Ag) = -0.106556983191543
cycle= 12 E= -75.3806494346711  delta_E= -9.95e-14  |g|= 9.86e-10  |ddm|= 1.7e-09
HOMO (B2u) = -0.43755062498644  LUMO (Ag) = -0.106556983144878
cycle= 13 E= -75.380649434671  delta_E= 8.53e-14  |g|= 7.72e-10  |ddm|= 7.35e-10
HOMO (B3u) = -0.437550624987075  LUMO (Ag) = -0.106556983115228
cycle= 14 E= -75.380649434671  delta_E= 1.42e-14  |g|= 6.86e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.437550624979848  LUMO (Ag) = -0.106556983104247
cycle= 15 E= -75.380649434671  delta_E= -7.11e-14  |g|= 5.97e-10  |ddm|= 5.75e-10
HOMO (B2u) = -0.437550624972201  LUMO (Ag) = -0.106556983130717
cycle= 16 E= -75.3806494346709  delta_E= 1.14e-13  |g|= 5.63e-10  |ddm|= 8.69e-10
HOMO (B3u) = -0.437550624903759  LUMO (Ag) = -0.106556983105396
cycle= 17 E= -75.3806494346711  delta_E= -1.71e-13  |g|= 6.09e-10  |ddm|= 7.77e-10
HOMO (B2u) = -0.437550624889816  LUMO (Ag) = -0.106556983016551
cycle= 18 E= -75.380649434671  delta_E= 8.53e-14  |g|= 2.01e-10  |ddm|= 9.04e-10
HOMO (B3u) = -0.437550624887783  LUMO (Ag) = -0.106556983009412
cycle= 19 E= -75.380649434671  delta_E= -2.84e-14  |g|= 1.59e-10  |ddm|= 1.05e-10
HOMO (B3u) = -0.437550624886698  LUMO (Ag) = -0.106556983005798
cycle= 20 E= -75.380649434671  delta_E= 7.11e-14  |g|= 1.38e-10  |ddm|= 5.43e-11
HOMO (B3u) = -0.43755062489201  LUMO (Ag) = -0.106556983007984
cycle= 21 E= -75.3806494346709  delta_E= 4.26e-14  |g|= 1.15e-10  |ddm|= 7.55e-11
HOMO (B3u) = -0.437550624896088  LUMO (Ag) = -0.10655698300968
cycle= 22 E= -75.380649434671  delta_E= -8.53e-14  |g|= 9.78e-11  |ddm|= 6.22e-11
HOMO (B3u) = -0.437550624898343  LUMO (Ag) = -0.106556983011033
cycle= 23 E= -75.380649434671  delta_E= 1.42e-14  |g|= 8.2e-11  |ddm|= 3.85e-11
HOMO (B3u) = -0.437550624900005  LUMO (Ag) = -0.106556983011851
cycle= 24 E= -75.380649434671  delta_E=    0  |g|= 6.8e-11  |ddm|= 3.11e-11
HOMO (B3u) = -0.437550624900992  LUMO (Ag) = -0.106556983005128
Extra cycle  E= -75.3806494346709  delta_E= 7.11e-14  |g|= 2.2e-11  |ddm|= 8.38e-11
converged SCF energy = -75.3806494346709

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpb7tx6a9l
max_memory 4000 MB (current use 8388 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5520156742906  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5749505591367  dE = -0.022934885  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5893012124498  dE = -0.014350653  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0632  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5977688165912  dE = -0.0084676041  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0299  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6039880943563  dE = -0.0062192778  S^2 = 0.0000000
               |grad[o]|=0.071  |ddm|=0.0135  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6089050842779  dE = -0.0049169899  S^2 = 0.0000000
               |grad[o]|=0.0571  |ddm|=0.00834  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6128207738997  dE = -0.0039156896  S^2 = 0.0000000
               |grad[o]|=0.0454  |ddm|=0.00603  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6158465880872  dE = -0.0030258142  S^2 = 0.0000000
               |grad[o]|=0.0352  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6180396497445  dE = -0.0021930617  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194395438651  dE = -0.0013998941  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00412  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6200886570633  dE = -0.0006491132  S^2 = 0.0000000
               |grad[o]|=0.00981  |ddm|=0.00428  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201507315124  dE = -6.2074449e-05  S^2 = 0.0000000
               |grad[o]|=0.00282  |ddm|=0.00468  |maxRot[o]|=0.0311
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201515469885  dE = -8.1547617e-07  S^2 = 0.0000000
               |grad[o]|=0.000473  |ddm|=0.00207  |maxRot[o]|=0.00308
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201515639994  dE = -1.701089e-08  S^2 = 0.0000000
               |grad[o]|=7.61e-05  |ddm|=0.000375  |maxRot[o]|=0.000388
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6201515647055  dE = -7.0605211e-10  S^2 = 0.0000000
               |grad[o]|=1.95e-05  |ddm|=7.56e-05  |maxRot[o]|=7.72e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6201515647411  dE = -3.558398e-11  S^2 = 0.0000000
               |grad[o]|=5.8e-06  |ddm|=1.97e-05  |maxRot[o]|=5.36e-06
2-step CASSCF converged in 15 macro (77 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98175021 1.63550568 1.87115526 1.87115612 0.36118663 0.13173034
 0.13173046 0.01578531]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00465   0.00301   0.00000   0.00000  -0.00114
  0 C 2s       0.60227   0.53958  -0.00000  -0.00000  -0.36778
  0 C 3s      -0.04374   0.00880  -0.00000  -0.00000  -0.00363
  0 C 2px      0.00000  -0.00000  -0.00000   0.70650  -0.00000
  0 C 2py      0.00000   0.00000   0.70650  -0.00000   0.00000
  0 C 2pz      0.36367  -0.45689  -0.00000  -0.00000   0.60226
  0 C 3px      0.00000  -0.00000   0.00000  -0.00009   0.00000
  0 C 3py     -0.00000   0.00000  -0.00009  -0.00000   0.00000
  0 C 3pz     -0.04268  -0.00383  -0.00000  -0.00000  -0.04233
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.02932  -0.00000   0.00000
  0 C 3dz^2    0.03544   0.00032  -0.00000  -0.00000   0.01448
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02932   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00465  -0.00301   0.00000   0.00000  -0.00114
  1 C 2s       0.60227  -0.53958   0.00000   0.00000  -0.36778
  1 C 3s      -0.04374  -0.00880   0.00000   0.00000  -0.00363
  1 C 2px     -0.00000   0.00000  -0.00000   0.70650  -0.00000
  1 C 2py      0.00000  -0.00000   0.70650   0.00000  -0.00000
  1 C 2pz     -0.36367  -0.45689  -0.00000   0.00000  -0.60226
  1 C 3px     -0.00000   0.00000   0.00000  -0.00009   0.00000
  1 C 3py     -0.00000  -0.00000  -0.00009   0.00000  -0.00000
  1 C 3pz      0.04268  -0.00383  -0.00000  -0.00000   0.04233
  1 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000  -0.02932  -0.00000   0.00000
  1 C 3dz^2    0.03544  -0.00032   0.00000   0.00000   0.01448
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02932  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s      -0.00000  -0.00000   0.45623
  0 C 3s      -0.00000  -0.00000  -0.04293
  0 C 2px      0.70638   0.00000  -0.00000
  0 C 2py      0.00000   0.70638  -0.00000
  0 C 2pz      0.00000  -0.00000   0.53783
  0 C 3px     -0.02172   0.00000  -0.00000
  0 C 3py      0.00000  -0.02172  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01389
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02345  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02369
  0 C 3dxz    -0.02345   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s       0.00000   0.00000  -0.45623
  1 C 3s       0.00000   0.00000   0.04293
  1 C 2px     -0.70638  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70638   0.00000
  1 C 2pz      0.00000  -0.00000   0.53783
  1 C 3px      0.02172  -0.00000   0.00000
  1 C 3py     -0.00000   0.02172   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01389
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02345  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02369
  1 C 3dxz    -0.02345   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99374270
<CAS-nat-orb|mo-hf>  4  4    0.99831642
<CAS-nat-orb|mo-hf>  5  5    0.99972153
<CAS-nat-orb|mo-hf>  6  6    0.99972153
<CAS-nat-orb|mo-hf>  7  7    0.97735855
<CAS-nat-orb|mo-hf>  8  8    0.94866400
<CAS-nat-orb|mo-hf>  9  9    0.94866407
<CAS-nat-orb|mo-hf>  10  10    0.53130920
<CAS-nat-orb|mo-hf>  10  17    0.68518175
<CAS-nat-orb|mo-hf>  10  18   -0.46282825
CASSCF energy = -75.6201515647411
CASCI E = -75.6201515647411  E(CI) = -17.3010862553994  S^2 = 0.0000000
......production of RDMs took       3.24 sec
......reading the RDM took          0.59 sec
......production of RDMs took      41.68 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.55 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000281446
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000074340
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000895964
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000094615
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000584590
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001056961
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000352320
HMAT symm error =    0.0061016965
E(MRCI) - E(ref) = -0.1048240008186951 DC = -0.004415222412189682
E(WickICMRCISD)   = -75.72497556555976  E_corr_ci = -0.1048240008186951
E(WickICMRCISD+Q) = -75.72939078797195  E_corr_ci = -0.1092392232308848
Time cost =   3404.046
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 03:15:03 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.349401887846 AA    0.000000000000   0.000000000000   2.550000000000 Bohr   0.0

nuclear repulsion = 14.1176470588235
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.275]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    697308.58


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmphmmsnrrv
max_memory 4000 MB (current use 8395 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.322852658808

WARN: Singularity detected in overlap matrix (condition number =  444). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.224183141291851  LUMO (Ag) = -0.175375833613537
cycle= 1 E= -75.3580302281757  delta_E= -0.0352  |g|= 0.215  |ddm|= 1.46
HOMO (B3u) = -0.467759172708484  LUMO (Ag) = -0.149454753798778
cycle= 2 E= -75.3746497165004  delta_E= -0.0166  |g|= 0.0521  |ddm|= 0.26
HOMO (B3u) = -0.43051679398039  LUMO (Ag) = -0.107753824209473
cycle= 3 E= -75.3755305907905  delta_E= -0.000881  |g|= 0.00966  |ddm|= 0.0568
HOMO (B3u) = -0.431561534231314  LUMO (Ag) = -0.105750596270451
cycle= 4 E= -75.375586878976  delta_E= -5.63e-05  |g|= 0.00191  |ddm|= 0.0225
HOMO (B3u) = -0.432324246357025  LUMO (Ag) = -0.106325540767304
cycle= 5 E= -75.3755892675815  delta_E= -2.39e-06  |g|= 0.000174  |ddm|= 0.00743
HOMO (B3u) = -0.432284401985618  LUMO (Ag) = -0.106263967776653
cycle= 6 E= -75.3755892854562  delta_E= -1.79e-08  |g|= 3.01e-05  |ddm|= 0.000369
HOMO (B3u) = -0.432278729183663  LUMO (Ag) = -0.106254488809749
cycle= 7 E= -75.3755892860987  delta_E= -6.43e-10  |g|= 3.64e-06  |ddm|= 0.000169
HOMO (B3u) = -0.432278901425334  LUMO (Ag) = -0.106253945307322
cycle= 8 E= -75.3755892861055  delta_E= -6.82e-12  |g|= 3.45e-07  |ddm|= 2.86e-05
HOMO (B3u) = -0.432278883343894  LUMO (Ag) = -0.106253871171358
cycle= 9 E= -75.3755892861056  delta_E= -7.11e-14  |g|= 1.65e-08  |ddm|= 2.14e-06
HOMO (B3u) = -0.432278879789833  LUMO (Ag) = -0.10625386864663
cycle= 10 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 2.15e-09  |ddm|= 4.37e-08
HOMO (B3u) = -0.432278879857054  LUMO (Ag) = -0.106253868618805
cycle= 11 E= -75.3755892861056  delta_E= -1.28e-13  |g|= 1.22e-09  |ddm|= 2.26e-09
HOMO (B3u) = -0.432278880151781  LUMO (Ag) = -0.1062538688911
cycle= 12 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 1.11e-09  |ddm|= 9.93e-10
HOMO (B3u) = -0.432278880104388  LUMO (Ag) = -0.106253868832283
cycle= 13 E= -75.3755892861056  delta_E= -1.14e-13  |g|= 8.75e-10  |ddm|= 7.61e-10
HOMO (B3u) = -0.432278880095663  LUMO (Ag) = -0.106253868794125
cycle= 14 E= -75.3755892861056  delta_E= 2.84e-14  |g|= 7.5e-10  |ddm|= 1.05e-09
HOMO (B3u) = -0.432278880082216  LUMO (Ag) = -0.106253868781101
cycle= 15 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 6.68e-10  |ddm|= 7.64e-10
HOMO (B3u) = -0.432278880089643  LUMO (Ag) = -0.106253868822494
cycle= 16 E= -75.3755892861055  delta_E= 2.84e-14  |g|= 6.2e-10  |ddm|= 1.23e-09
HOMO (B3u) = -0.432278880013176  LUMO (Ag) = -0.106253868780759
cycle= 17 E= -75.3755892861056  delta_E= -1.14e-13  |g|= 6.62e-10  |ddm|= 8.79e-10
HOMO (B3u) = -0.43227887997921  LUMO (Ag) = -0.106253868675898
cycle= 18 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 2.29e-10  |ddm|= 1.04e-09
HOMO (B3u) = -0.432278879978759  LUMO (Ag) = -0.106253868669243
cycle= 19 E= -75.3755892861056  delta_E= -5.68e-14  |g|= 1.8e-10  |ddm|= 1.33e-10
HOMO (B3u) = -0.432278879978558  LUMO (Ag) = -0.106253868666114
cycle= 20 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 1.56e-10  |ddm|= 8.29e-11
HOMO (B3u) = -0.432278879985215  LUMO (Ag) = -0.106253868669413
cycle= 21 E= -75.3755892861056  delta_E= -4.26e-14  |g|= 1.29e-10  |ddm|= 8.79e-11
HOMO (B2u) = -0.432278879990252  LUMO (Ag) = -0.106253868671841
cycle= 22 E= -75.3755892861056  delta_E= -1.42e-14  |g|= 1.09e-10  |ddm|= 7.49e-11
HOMO (B3u) = -0.432278879993466  LUMO (Ag) = -0.106253868673931
cycle= 23 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 9.17e-11  |ddm|= 5.23e-11
HOMO (B2u) = -0.432278879995674  LUMO (Ag) = -0.106253868674858
cycle= 24 E= -75.3755892861055  delta_E=    0  |g|= 7.55e-11  |ddm|= 3.9e-11
HOMO (B2u) = -0.432278879997426  LUMO (Ag) = -0.106253868668085
Extra cycle  E= -75.3755892861055  delta_E=    0  |g|= 2.45e-11  |ddm|= 9.37e-11
converged SCF energy = -75.3755892861055

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmphmmsnrrv
max_memory 4000 MB (current use 8395 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5487757489226  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5722713022276  dE = -0.023495553  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5857449317713  dE = -0.01347363  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0659  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5940429034179  dE = -0.0082979716  S^2 = 0.0000000
               |grad[o]|=0.0897  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6002041743323  dE = -0.0061612709  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0141  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6050818819098  dE = -0.0048777076  S^2 = 0.0000000
               |grad[o]|=0.0582  |ddm|=0.00894  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6089576814697  dE = -0.0038757996  S^2 = 0.0000000
               |grad[o]|=0.0463  |ddm|=0.00649  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6119401746613  dE = -0.0029824932  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00515  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6140855047753  dE = -0.0021453301  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00446  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6154331097038  dE = -0.0013476049  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6160256894751  dE = -0.00059257977  S^2 = 0.0000000
               |grad[o]|=0.00954  |ddm|=0.00447  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6160629770924  dE = -3.7287617e-05  S^2 = 0.0000000
               |grad[o]|=0.00234  |ddm|=0.00498  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.616066055036  dE = -3.0779435e-06  S^2 = 0.0000000
               |grad[o]|=0.00071  |ddm|=0.00145  |maxRot[o]|=0.00664
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6160661045158  dE = -4.9479837e-08  S^2 = 0.0000000
               |grad[o]|=0.000121  |ddm|=0.000549  |maxRot[o]|=0.000716
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6160661058704  dE = -1.3546355e-09  S^2 = 0.0000000
               |grad[o]|=2.27e-05  |ddm|=0.000101  |maxRot[o]|=9.64e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6160661059279  dE = -5.7426064e-11  S^2 = 0.0000000
               |grad[o]|=6.82e-06  |ddm|=1.86e-05  |maxRot[o]|=1.73e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98089629 1.64657004 1.86373099 1.86373155 0.35078072 0.13883206
 0.13883218 0.01662617]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00498   0.00310   0.00000   0.00000  -0.00109
  0 C 2s       0.60537   0.54713  -0.00000   0.00000  -0.36277
  0 C 3s      -0.04187   0.00880  -0.00000  -0.00000  -0.00080
  0 C 2px      0.00000  -0.00000   0.00000   0.70653  -0.00000
  0 C 2py      0.00000  -0.00000   0.70653  -0.00000   0.00000
  0 C 2pz      0.35902  -0.44783   0.00000   0.00000   0.60525
  0 C 3px     -0.00000   0.00000   0.00000   0.00282   0.00000
  0 C 3py     -0.00000   0.00000   0.00282   0.00000   0.00000
  0 C 3pz     -0.04100  -0.00346  -0.00000  -0.00000  -0.04273
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.02846  -0.00000   0.00000
  0 C 3dz^2    0.03432  -0.00015  -0.00000  -0.00000   0.01561
  0 C 3dxz    -0.00000   0.00000   0.00000   0.02846   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00498  -0.00310   0.00000   0.00000  -0.00109
  1 C 2s       0.60537  -0.54713   0.00000   0.00000  -0.36277
  1 C 3s      -0.04187  -0.00880   0.00000   0.00000  -0.00080
  1 C 2px      0.00000  -0.00000  -0.00000   0.70653  -0.00000
  1 C 2py      0.00000  -0.00000   0.70653  -0.00000  -0.00000
  1 C 2pz     -0.35902  -0.44783   0.00000   0.00000  -0.60525
  1 C 3px     -0.00000   0.00000  -0.00000   0.00282   0.00000
  1 C 3py     -0.00000   0.00000   0.00282   0.00000  -0.00000
  1 C 3pz      0.04100  -0.00346  -0.00000  -0.00000   0.04273
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02846  -0.00000   0.00000
  1 C 3dz^2    0.03432   0.00015   0.00000  -0.00000   0.01561
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.02846  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s       0.00000  -0.00000   0.44717
  0 C 3s       0.00000   0.00000  -0.04302
  0 C 2px      0.70642  -0.00000   0.00000
  0 C 2py      0.00000   0.70642   0.00000
  0 C 2pz      0.00000   0.00000   0.54537
  0 C 3px     -0.02076  -0.00000   0.00000
  0 C 3py     -0.00000  -0.02076   0.00000
  0 C 3pz      0.00000   0.00000   0.01534
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02331   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02287
  0 C 3dxz    -0.02331  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000  -0.00000  -0.44717
  1 C 3s      -0.00000  -0.00000   0.04302
  1 C 2px     -0.70642   0.00000  -0.00000
  1 C 2py      0.00000  -0.70642   0.00000
  1 C 2pz      0.00000  -0.00000   0.54537
  1 C 3px      0.02076   0.00000  -0.00000
  1 C 3py     -0.00000   0.02076  -0.00000
  1 C 3pz      0.00000  -0.00000   0.01534
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02331   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02287
  1 C 3dxz    -0.02331  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99344301
<CAS-nat-orb|mo-hf>  4  4    0.99822554
<CAS-nat-orb|mo-hf>  5  5    0.99969500
<CAS-nat-orb|mo-hf>  6  6    0.99969500
<CAS-nat-orb|mo-hf>  7  7    0.97683026
<CAS-nat-orb|mo-hf>  8  8    0.95239320
<CAS-nat-orb|mo-hf>  9  9    0.95239323
<CAS-nat-orb|mo-hf>  10  10    0.55278296
<CAS-nat-orb|mo-hf>  10  17    0.68990907
<CAS-nat-orb|mo-hf>  10  18   -0.43567160
CASSCF energy = -75.6160661059279
CASCI E = -75.6160661059279  E(CI) = -17.1715112018848  S^2 = 0.0000000
......production of RDMs took       2.48 sec
......reading the RDM took          0.45 sec
......production of RDMs took      54.05 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.42 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000076516
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000020211
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001026484
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000109168
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000644950
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001503548
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000501183
HMAT symm error =    0.0126008505
E(MRCI) - E(ref) = -0.1050980783137874 DC = -0.004466608874873643
E(WickICMRCISD)   = -75.72116418424164  E_corr_ci = -0.1050980783137874
E(WickICMRCISD+Q) = -75.72563079311652  E_corr_ci = -0.109564687188661
Time cost =   3111.510
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 04:06:55 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.375860748392 AA    0.000000000000   0.000000000000   2.600000000000 Bohr   0.0

nuclear repulsion = 13.8461538461538
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.3]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    748057.77


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpl2i__gq5
max_memory 4000 MB (current use 8398 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.2781958136929

WARN: Singularity detected in overlap matrix (condition number =  409). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.215477115824913  LUMO (Ag) = -0.172896295276616
cycle= 1 E= -75.3511756370242  delta_E= -0.073  |g|= 0.218  |ddm|= 1.45
HOMO (B2u) = -0.462888168119373  LUMO (Ag) = -0.150366392380427
cycle= 2 E= -75.3684890547635  delta_E= -0.0173  |g|= 0.0521  |ddm|= 0.268
HOMO (B2u) = -0.425477509345155  LUMO (Ag) = -0.107647319512264
cycle= 3 E= -75.3693914994859  delta_E= -0.000902  |g|= 0.00999  |ddm|= 0.056
HOMO (B2u) = -0.426482502338423  LUMO (Ag) = -0.105320428216435
cycle= 4 E= -75.3694522894417  delta_E= -6.08e-05  |g|= 0.002  |ddm|= 0.0206
HOMO (B3u) = -0.427253849930309  LUMO (Ag) = -0.105864709294584
cycle= 5 E= -75.3694549331516  delta_E= -2.64e-06  |g|= 0.000217  |ddm|= 0.00651
HOMO (B3u) = -0.427202128961969  LUMO (Ag) = -0.105788865113738
cycle= 6 E= -75.3694549621127  delta_E= -2.9e-08  |g|= 3.29e-05  |ddm|= 0.000392
HOMO (B3u) = -0.427195922281588  LUMO (Ag) = -0.105778621503342
cycle= 7 E= -75.3694549628765  delta_E= -7.64e-10  |g|= 4.04e-06  |ddm|= 0.000193
HOMO (B3u) = -0.427196084833618  LUMO (Ag) = -0.105778048731891
cycle= 8 E= -75.3694549628848  delta_E= -8.24e-12  |g|= 3.71e-07  |ddm|= 2.79e-05
HOMO (B3u) = -0.427196062616053  LUMO (Ag) = -0.105777966013369
cycle= 9 E= -75.3694549628848  delta_E=    0  |g|= 1.75e-08  |ddm|= 2.3e-06
HOMO (B3u) = -0.427196058477425  LUMO (Ag) = -0.105777964390646
cycle= 10 E= -75.3694549628848  delta_E= -5.68e-14  |g|= 2.34e-09  |ddm|= 4.88e-08
HOMO (B2u) = -0.427196058514628  LUMO (Ag) = -0.105777964290619
cycle= 11 E= -75.3694549628847  delta_E= 8.53e-14  |g|= 1.36e-09  |ddm|= 2.45e-09
HOMO (B3u) = -0.427196058862663  LUMO (Ag) = -0.105777964641119
cycle= 12 E= -75.3694549628848  delta_E= -5.68e-14  |g|= 1.25e-09  |ddm|= 7.34e-10
HOMO (B3u) = -0.427196058806567  LUMO (Ag) = -0.105777964571431
cycle= 13 E= -75.3694549628848  delta_E=    0  |g|= 9.8e-10  |ddm|= 9.66e-10
HOMO (B3u) = -0.427196058787384  LUMO (Ag) = -0.1057779645259
cycle= 14 E= -75.3694549628848  delta_E=    0  |g|= 8.26e-10  |ddm|= 9.73e-10
HOMO (B2u) = -0.42719605877482  LUMO (Ag) = -0.105777964513413
cycle= 15 E= -75.3694549628849  delta_E= -8.53e-14  |g|= 7.31e-10  |ddm|= 9.07e-10
HOMO (B2u) = -0.427196058780696  LUMO (Ag) = -0.105777964558761
cycle= 16 E= -75.3694549628848  delta_E= 1.14e-13  |g|= 6.83e-10  |ddm|= 1.29e-09
HOMO (B2u) = -0.427196058709539  LUMO (Ag) = -0.105777964511268
cycle= 17 E= -75.3694549628848  delta_E= -7.11e-14  |g|= 7.11e-10  |ddm|= 6.99e-10
HOMO (B2u) = -0.427196058655214  LUMO (Ag) = -0.105777964391221
cycle= 18 E= -75.3694549628848  delta_E= 1.42e-14  |g|= 2.55e-10  |ddm|= 1.18e-09
HOMO (B2u) = -0.427196058655752  LUMO (Ag) = -0.105777964384882
cycle= 19 E= -75.3694549628849  delta_E= -5.68e-14  |g|= 2.02e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.42719605865634  LUMO (Ag) = -0.105777964382243
cycle= 20 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 1.73e-10  |ddm|= 1.06e-10
HOMO (B2u) = -0.427196058664241  LUMO (Ag) = -0.105777964386517
cycle= 21 E= -75.3694549628848  delta_E= 5.68e-14  |g|= 1.42e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.427196058670115  LUMO (Ag) = -0.105777964389646
cycle= 22 E= -75.3694549628848  delta_E=    0  |g|= 1.19e-10  |ddm|= 8.64e-11
HOMO (B2u) = -0.427196058674124  LUMO (Ag) = -0.105777964392308
cycle= 23 E= -75.3694549628848  delta_E=    0  |g|= 1e-10  |ddm|= 6.61e-11
HOMO (B2u) = -0.42719605867701  LUMO (Ag) = -0.105777964393709
cycle= 24 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 8.26e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.427196058679983  LUMO (Ag) = -0.105777964393375
cycle= 25 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 6.32e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.427196058681602  LUMO (Ag) = -0.105777964390984
cycle= 26 E= -75.3694549628847  delta_E= 4.26e-14  |g|= 4.2e-11  |ddm|= 4.02e-11
HOMO (B2u) = -0.427196058681037  LUMO (Ag) = -0.10577796438934
cycle= 27 E= -75.3694549628846  delta_E= 9.95e-14  |g|= 3.5e-11  |ddm|= 1.33e-11
HOMO (B2u) = -0.427196058680384  LUMO (Ag) = -0.105777964387863
cycle= 28 E= -75.3694549628847  delta_E= -4.26e-14  |g|= 2.94e-11  |ddm|= 1.04e-11
HOMO (B2u) = -0.427196058679697  LUMO (Ag) = -0.105777964386447
cycle= 29 E= -75.3694549628845  delta_E= 1.56e-13  |g|= 2.46e-11  |ddm|= 9.17e-12
HOMO (B2u) = -0.427196058679231  LUMO (Ag) = -0.105777964385339
cycle= 30 E= -75.3694549628845  delta_E= 5.68e-14  |g|= 2.04e-11  |ddm|= 7.88e-12
HOMO (B2u) = -0.427196058678912  LUMO (Ag) = -0.105777964384437
cycle= 31 E= -75.3694549628845  delta_E= -2.84e-14  |g|= 1.68e-11  |ddm|= 6.87e-12
HOMO (B2u) = -0.427196058678727  LUMO (Ag) = -0.105777964383681
cycle= 32 E= -75.3694549628845  delta_E= -2.84e-14  |g|= 1.37e-11  |ddm|= 6.2e-12
HOMO (B2u) = -0.427196058678654  LUMO (Ag) = -0.105777964383069
cycle= 33 E= -75.3694549628842  delta_E= 2.84e-13  |g|= 1.14e-11  |ddm|= 5.39e-12
HOMO (B2u) = -0.427196058678673  LUMO (Ag) = -0.105777964382662
cycle= 34 E= -75.369454962884  delta_E= 2.56e-13  |g|= 9.05e-12  |ddm|= 5.76e-12
HOMO (B2u) = -0.427196058678717  LUMO (Ag) = -0.10577796438244
cycle= 35 E= -75.3694549628838  delta_E= 2.13e-13  |g|= 7.86e-12  |ddm|= 4.5e-12
HOMO (B2u) = -0.42719605867873  LUMO (Ag) = -0.105777964382237
cycle= 36 E= -75.3694549628834  delta_E= 4.12e-13  |g|= 7.43e-12  |ddm|= 3.55e-12
HOMO (B2u) = -0.427196058678704  LUMO (Ag) = -0.10577796438203
cycle= 37 E= -75.3694549628825  delta_E= 8.24e-13  |g|= 8.56e-12  |ddm|= 2.58e-12
HOMO (B2u) = -0.42719605867862  LUMO (Ag) = -0.105777964381811
cycle= 38 E= -75.3694549628826  delta_E= -5.68e-14  |g|= 7.16e-12  |ddm|= 4.33e-12
HOMO (B2u) = -0.427196058678525  LUMO (Ag) = -0.105777964381607
cycle= 39 E= -75.3694549628825  delta_E= 8.53e-14  |g|= 6.14e-12  |ddm|= 3.95e-12
HOMO (B2u) = -0.427196058678412  LUMO (Ag) = -0.105777964381397
cycle= 40 E= -75.3694549628826  delta_E= -8.53e-14  |g|= 5.2e-12  |ddm|= 4.72e-12
HOMO (B2u) = -0.427196058678298  LUMO (Ag) = -0.1057779643812
cycle= 41 E= -75.3694549628827  delta_E= -5.68e-14  |g|= 4.58e-12  |ddm|= 5.12e-12
HOMO (B2u) = -0.427196058678192  LUMO (Ag) = -0.105777964381022
cycle= 42 E= -75.3694549628827  delta_E= -4.26e-14  |g|= 3.51e-12  |ddm|= 7e-12
HOMO (B2u) = -0.427196058678093  LUMO (Ag) = -0.105777964380859
cycle= 43 E= -75.3694549628829  delta_E= -1.85e-13  |g|= 3.26e-12  |ddm|= 5.78e-12
HOMO (B2u) = -0.427196058678007  LUMO (Ag) = -0.105777964380704
cycle= 44 E= -75.3694549628829  delta_E= -1.42e-14  |g|= 2.91e-12  |ddm|= 5.96e-12
HOMO (B2u) = -0.427196058677939  LUMO (Ag) = -0.105777964380566
cycle= 45 E= -75.369454962883  delta_E= -9.95e-14  |g|= 3.04e-12  |ddm|= 6.06e-12
HOMO (B2u) = -0.42719605867791  LUMO (Ag) = -0.105777964380457
cycle= 46 E= -75.3694549628831  delta_E= -8.53e-14  |g|= 2.82e-12  |ddm|= 3.79e-12
HOMO (B2u) = -0.427196058677882  LUMO (Ag) = -0.105777964380346
cycle= 47 E= -75.3694549628833  delta_E= -1.85e-13  |g|= 3.42e-12  |ddm|= 4.78e-12
HOMO (B2u) = -0.427196058677869  LUMO (Ag) = -0.105777964380263
cycle= 48 E= -75.3694549628835  delta_E= -2.13e-13  |g|= 3.6e-12  |ddm|= 6.58e-12
HOMO (B2u) = -0.427196058677852  LUMO (Ag) = -0.105777964380192
cycle= 49 E= -75.3694549628835  delta_E=    0  |g|= 3.27e-12  |ddm|= 7.68e-12
HOMO (B2u) = -0.427196058677767  LUMO (Ag) = -0.105777964379991
Extra cycle  E= -75.3694549628835  delta_E=    0  |g|= 8.86e-13  |ddm|= 3.37e-11
converged SCF energy = -75.3694549628835

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpl2i__gq5
max_memory 4000 MB (current use 8398 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5444984241951  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5681729303062  dE = -0.023674506  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0785
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5810861650643  dE = -0.012913235  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0676  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5892815622391  dE = -0.0081953972  S^2 = 0.0000000
               |grad[o]|=0.0906  |ddm|=0.0287  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5954078084414  dE = -0.0061262462  S^2 = 0.0000000
               |grad[o]|=0.0731  |ddm|=0.0147  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6002514671513  dE = -0.0048436587  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00955  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6040806863514  dE = -0.0038292192  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.00694  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6070035233023  dE = -0.002922837  S^2 = 0.0000000
               |grad[o]|=0.0361  |ddm|=0.00545  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.609076972715  dE = -0.0020734494  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00465  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6103421977607  dE = -0.001265225  S^2 = 0.0000000
               |grad[o]|=0.0172  |ddm|=0.00445  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6107875292993  dE = -0.00044533154  S^2 = 0.0000000
               |grad[o]|=0.00887  |ddm|=0.00473  |maxRot[o]|= 0.06
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6108585947093  dE = -7.106541e-05  S^2 = 0.0000000
               |grad[o]|=0.00315  |ddm|=0.00398  |maxRot[o]|=0.0328
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6108594681549  dE = -8.7344556e-07  S^2 = 0.0000000
               |grad[o]|=0.000499  |ddm|=0.00241  |maxRot[o]|=0.00309
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6108594859766  dE = -1.7821677e-08  S^2 = 0.0000000
               |grad[o]|=7.69e-05  |ddm|=0.000368  |maxRot[o]|=0.000379
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6108594866039  dE = -6.2735239e-10  S^2 = 0.0000000
               |grad[o]|=1.76e-05  |ddm|=6.77e-05  |maxRot[o]|=7.05e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6108594866192  dE = -1.5234036e-11  S^2 = 0.0000000
               |grad[o]|=3.86e-06  |ddm|=1.18e-05  |maxRot[o]|=7.29e-06
2-step CASSCF converged in 15 macro (76 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98003346 1.65708329 1.85598501 1.85598557 0.34113361 0.1461487
 0.14614889 0.01748146]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00530   0.00319   0.00000   0.00000  -0.00104
  0 C 2s       0.60847   0.55448  -0.00000  -0.00000  -0.35767
  0 C 3s      -0.03996   0.00882  -0.00000  -0.00000   0.00198
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655  -0.00000
  0 C 2py     -0.00000   0.00000   0.70655  -0.00000   0.00000
  0 C 2pz      0.35425  -0.43870  -0.00000  -0.00000   0.60822
  0 C 3px     -0.00000  -0.00000   0.00000   0.00558  -0.00000
  0 C 3py     -0.00000   0.00000   0.00558   0.00000   0.00000
  0 C 3pz     -0.03931  -0.00314  -0.00000  -0.00000  -0.04299
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02761   0.00000   0.00000
  0 C 3dz^2    0.03326  -0.00060  -0.00000  -0.00000   0.01688
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02761  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00530  -0.00319   0.00000   0.00000  -0.00104
  1 C 2s       0.60847  -0.55448   0.00000  -0.00000  -0.35767
  1 C 3s      -0.03996  -0.00882   0.00000   0.00000   0.00198
  1 C 2px     -0.00000   0.00000  -0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000  -0.00000
  1 C 2pz     -0.35425  -0.43870  -0.00000   0.00000  -0.60822
  1 C 3px      0.00000   0.00000   0.00000   0.00558   0.00000
  1 C 3py      0.00000  -0.00000   0.00558   0.00000  -0.00000
  1 C 3pz      0.03931  -0.00314  -0.00000  -0.00000   0.04299
  1 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02761  -0.00000   0.00000
  1 C 3dz^2    0.03326   0.00060   0.00000   0.00000   0.01688
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02761  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00051
  0 C 2s      -0.00000  -0.00000   0.43805
  0 C 3s      -0.00000  -0.00000  -0.04314
  0 C 2px      0.70645   0.00000   0.00000
  0 C 2py      0.00000   0.70645  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55270
  0 C 3px     -0.01985   0.00000   0.00000
  0 C 3py      0.00000  -0.01985  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01664
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02315  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02225
  0 C 3dxz    -0.02315   0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00051
  1 C 2s      -0.00000   0.00000  -0.43805
  1 C 3s       0.00000   0.00000   0.04314
  1 C 2px     -0.70645  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70645   0.00000
  1 C 2pz      0.00000  -0.00000   0.55270
  1 C 3px      0.01985  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01985   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01664
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02315  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02225
  1 C 3dxz    -0.02315   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99314135
<CAS-nat-orb|mo-hf>  4  4    0.99812796
<CAS-nat-orb|mo-hf>  5  5    0.99966602
<CAS-nat-orb|mo-hf>  6  6    0.99966602
<CAS-nat-orb|mo-hf>  7  7    0.97631890
<CAS-nat-orb|mo-hf>  8  8    0.95579301
<CAS-nat-orb|mo-hf>  9  9    0.95579307
<CAS-nat-orb|mo-hf>  10  10    0.57546018
<CAS-nat-orb|mo-hf>  10  17    0.69041990
<CAS-nat-orb|mo-hf>  10  18   -0.40995049
CASSCF energy = -75.6108594866192
CASCI E = -75.6108594866192  E(CI) = -17.0456438779442  S^2 = 0.0000000
......production of RDMs took       2.62 sec
......reading the RDM took          0.54 sec
......production of RDMs took      46.96 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.26 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000015132
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000003997
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000856102
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000089353
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000537854
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001186422
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000395474
HMAT symm error =    0.0086190588
E(MRCI) - E(ref) = -0.1053834446868649 DC = -0.004519880644086635
E(WickICMRCISD)   = -75.71624293130603  E_corr_ci = -0.1053834446868649
E(WickICMRCISD+Q) = -75.72076281195011  E_corr_ci = -0.1099033253309515
Time cost =   2758.375
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 04:52:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.402319608938 AA    0.000000000000   0.000000000000   2.650000000000 Bohr   0.0

nuclear repulsion = 13.5849056603774
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.325]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    790674.75


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpzvykpgu4
max_memory 4000 MB (current use 8396 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.2354639903452

WARN: Singularity detected in overlap matrix (condition number =  377). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.207229697178326  LUMO (Ag) = -0.170529385107339
cycle= 1 E= -75.3434515147689  delta_E= -0.108  |g|= 0.222  |ddm|= 1.45
HOMO (B3u) = -0.458125308046684  LUMO (Ag) = -0.151008288235492
cycle= 2 E= -75.3614525114845  delta_E= -0.018  |g|= 0.052  |ddm|= 0.276
HOMO (B3u) = -0.420576044882481  LUMO (Ag) = -0.107310756967327
cycle= 3 E= -75.3623762459039  delta_E= -0.000924  |g|= 0.0104  |ddm|= 0.0554
HOMO (B3u) = -0.421573778613681  LUMO (Ag) = -0.104704594692276
cycle= 4 E= -75.3624425687673  delta_E= -6.63e-05  |g|= 0.00208  |ddm|= 0.019
HOMO (B3u) = -0.422353066342063  LUMO (Ag) = -0.105232949169249
cycle= 5 E= -75.3624454885392  delta_E= -2.92e-06  |g|= 0.000251  |ddm|= 0.00568
HOMO (B3u) = -0.422292447876755  LUMO (Ag) = -0.105149049472676
cycle= 6 E= -75.3624455277622  delta_E= -3.92e-08  |g|= 3.5e-05  |ddm|= 0.000464
HOMO (B2u) = -0.422285778696182  LUMO (Ag) = -0.105138173661531
cycle= 7 E= -75.362445528617  delta_E= -8.55e-10  |g|= 4.37e-06  |ddm|= 0.0002
HOMO (B2u) = -0.422285894464517  LUMO (Ag) = -0.105137535804997
cycle= 8 E= -75.3624455286266  delta_E= -9.63e-12  |g|= 3.96e-07  |ddm|= 2.7e-05
HOMO (B3u) = -0.422285868761296  LUMO (Ag) = -0.105137442523124
cycle= 9 E= -75.3624455286268  delta_E= -1.99e-13  |g|= 1.83e-08  |ddm|= 2.34e-06
HOMO (B2u) = -0.422285864047108  LUMO (Ag) = -0.105137442034634
cycle= 10 E= -75.3624455286268  delta_E= 5.68e-14  |g|= 2.5e-09  |ddm|= 5.4e-08
HOMO (B2u) = -0.422285864208524  LUMO (Ag) = -0.105137442035486
cycle= 11 E= -75.3624455286267  delta_E= 5.68e-14  |g|= 1.63e-09  |ddm|= 2.05e-09
HOMO (B2u) = -0.422285864471731  LUMO (Ag) = -0.105137442316619
cycle= 12 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 1.38e-09  |ddm|= 8.32e-10
HOMO (B3u) = -0.422285864412731  LUMO (Ag) = -0.105137442239544
cycle= 13 E= -75.3624455286267  delta_E= 1.42e-14  |g|= 1.08e-09  |ddm|= 1.18e-09
HOMO (B3u) = -0.422285864387668  LUMO (Ag) = -0.10513744218975
cycle= 14 E= -75.3624455286267  delta_E= 1.42e-14  |g|= 9.02e-10  |ddm|= 9.99e-10
HOMO (B3u) = -0.422285864372422  LUMO (Ag) = -0.105137442174053
cycle= 15 E= -75.3624455286268  delta_E= -9.95e-14  |g|= 7.9e-10  |ddm|= 8.85e-10
HOMO (B3u) = -0.42228586437712  LUMO (Ag) = -0.10513744221937
cycle= 16 E= -75.3624455286268  delta_E= 2.84e-14  |g|= 7.37e-10  |ddm|= 1.3e-09
HOMO (B3u) = -0.422285864307829  LUMO (Ag) = -0.105137442168198
cycle= 17 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 7.58e-10  |ddm|= 5.5e-10
HOMO (B3u) = -0.422285864233339  LUMO (Ag) = -0.105137442035447
cycle= 18 E= -75.3624455286268  delta_E=    0  |g|= 2.86e-10  |ddm|= 1.32e-09
HOMO (B3u) = -0.422285864234577  LUMO (Ag) = -0.105137442029409
cycle= 19 E= -75.3624455286268  delta_E= 5.68e-14  |g|= 2.28e-10  |ddm|= 1.9e-10
HOMO (B3u) = -0.42228586423915  LUMO (Ag) = -0.105137442029796
cycle= 20 E= -75.3624455286268  delta_E= -2.84e-14  |g|= 1.9e-10  |ddm|= 1.38e-10
HOMO (B3u) = -0.422285864248109  LUMO (Ag) = -0.105137442034876
cycle= 21 E= -75.3624455286268  delta_E= 2.84e-14  |g|= 1.56e-10  |ddm|= 1.19e-10
HOMO (B3u) = -0.422285864254738  LUMO (Ag) = -0.105137442038669
cycle= 22 E= -75.3624455286268  delta_E= -2.84e-14  |g|= 1.3e-10  |ddm|= 9.57e-11
HOMO (B3u) = -0.422285864259431  LUMO (Ag) = -0.105137442041884
cycle= 23 E= -75.3624455286267  delta_E= 5.68e-14  |g|= 1.08e-10  |ddm|= 7.55e-11
HOMO (B3u) = -0.422285864262953  LUMO (Ag) = -0.105137442043874
cycle= 24 E= -75.3624455286266  delta_E= 8.53e-14  |g|= 8.92e-11  |ddm|= 5.7e-11
HOMO (B3u) = -0.422285864266427  LUMO (Ag) = -0.105137442044012
cycle= 25 E= -75.3624455286266  delta_E= 4.26e-14  |g|= 6.86e-11  |ddm|= 4.05e-11
HOMO (B3u) = -0.422285864268376  LUMO (Ag) = -0.105137442042108
cycle= 26 E= -75.3624455286265  delta_E= 8.53e-14  |g|= 4.61e-11  |ddm|= 4.55e-11
HOMO (B3u) = -0.422285864267577  LUMO (Ag) = -0.105137442040172
cycle= 27 E= -75.3624455286264  delta_E= 9.95e-14  |g|= 3.83e-11  |ddm|= 1.63e-11
HOMO (B3u) = -0.422285864266687  LUMO (Ag) = -0.105137442038423
cycle= 28 E= -75.3624455286263  delta_E= 1.14e-13  |g|= 3.18e-11  |ddm|= 1.22e-11
HOMO (B3u) = -0.422285864265885  LUMO (Ag) = -0.105137442036873
cycle= 29 E= -75.3624455286262  delta_E= 7.11e-14  |g|= 2.64e-11  |ddm|= 1.02e-11
HOMO (B3u) = -0.422285864265327  LUMO (Ag) = -0.10513744203567
cycle= 30 E= -75.3624455286262  delta_E=    0  |g|= 2.19e-11  |ddm|= 8.67e-12
HOMO (B3u) = -0.422285864264706  LUMO (Ag) = -0.105137442032706
Extra cycle  E= -75.3624455286261  delta_E= 9.95e-14  |g|= 7.4e-12  |ddm|= 2.75e-11
converged SCF energy = -75.3624455286261

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpzvykpgu4
max_memory 4000 MB (current use 8396 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5393906023641  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5629975370737  dE = -0.023606935  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0764
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5755556069917  dE = -0.01255807  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0687  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5836978888134  dE = -0.0081422818  S^2 = 0.0000000
               |grad[o]|=0.0915  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5898048014471  dE = -0.0061069126  S^2 = 0.0000000
               |grad[o]|=0.0739  |ddm|=0.0155  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5946145711083  dE = -0.0048097697  S^2 = 0.0000000
               |grad[o]|=0.0596  |ddm|=0.0101  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5983864945649  dE = -0.0037719235  S^2 = 0.0000000
               |grad[o]|=0.0472  |ddm|=0.00736  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.601230145218  dE = -0.0028436507  S^2 = 0.0000000
               |grad[o]|=0.036  |ddm|=0.00571  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6032050743045  dE = -0.0019749291  S^2 = 0.0000000
               |grad[o]|=0.0259  |ddm|=0.00483  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043559988361  dE = -0.0011509245  S^2 = 0.0000000
               |grad[o]|=0.0165  |ddm|=0.00466  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6047080375014  dE = -0.00035203867  S^2 = 0.0000000
               |grad[o]|=0.00777  |ddm|=0.00509  |maxRot[o]|= 0.06
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6047337083172  dE = -2.5670816e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00436  |maxRot[o]|=0.0194
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6047340653385  dE = -3.5702129e-07  S^2 = 0.0000000
               |grad[o]|=0.000322  |ddm|=0.0016  |maxRot[o]|=0.00185
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6047340726251  dE = -7.2866726e-09  S^2 = 0.0000000
               |grad[o]|=5.01e-05  |ddm|=0.000237  |maxRot[o]|=0.000232
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6047340729171  dE = -2.919478e-10  S^2 = 0.0000000
               |grad[o]|=1.46e-05  |ddm|=3.6e-05  |maxRot[o]|=4.8e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6047340729271  dE = -9.9902309e-12  S^2 = 0.0000000
               |grad[o]|=3.88e-06  |ddm|=6.73e-06  |maxRot[o]|=3.47e-06
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97916645 1.66712983 1.84789509 1.84789498 0.33219448 0.15368537
 0.15368543 0.01834836]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00560   0.00327   0.00000   0.00000  -0.00099
  0 C 2s       0.61156   0.56162   0.00000  -0.00000  -0.35247
  0 C 3s      -0.03803   0.00886   0.00000  -0.00000   0.00469
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py     -0.00000   0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34937  -0.42951  -0.00000  -0.00000   0.61119
  0 C 3px     -0.00000   0.00000  -0.00000   0.00818   0.00000
  0 C 3py     -0.00000   0.00000   0.00818  -0.00000  -0.00000
  0 C 3pz     -0.03762  -0.00286   0.00000  -0.00000  -0.04310
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.02675  -0.00000  -0.00000
  0 C 3dz^2    0.03225  -0.00101   0.00000  -0.00000   0.01829
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02675   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00560  -0.00327   0.00000   0.00000  -0.00099
  1 C 2s       0.61156  -0.56162  -0.00000   0.00000  -0.35247
  1 C 3s      -0.03803  -0.00886  -0.00000   0.00000   0.00469
  1 C 2px      0.00000  -0.00000   0.00000   0.70655  -0.00000
  1 C 2py     -0.00000  -0.00000   0.70655   0.00000   0.00000
  1 C 2pz     -0.34937  -0.42951  -0.00000  -0.00000  -0.61119
  1 C 3px      0.00000   0.00000   0.00000   0.00818  -0.00000
  1 C 3py      0.00000  -0.00000   0.00818  -0.00000   0.00000
  1 C 3pz      0.03762  -0.00286   0.00000  -0.00000   0.04310
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02675  -0.00000  -0.00000
  1 C 3dz^2    0.03225   0.00101   0.00000   0.00000   0.01829
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02675   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00047
  0 C 2s      -0.00000   0.00000   0.42887
  0 C 3s       0.00000   0.00000  -0.04326
  0 C 2px      0.70648   0.00000  -0.00000
  0 C 2py      0.00000   0.70648  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55983
  0 C 3px     -0.01896   0.00000   0.00000
  0 C 3py      0.00000  -0.01896  -0.00000
  0 C 3pz      0.00000   0.00000   0.01780
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02297  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02181
  0 C 3dxz    -0.02297   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00047
  1 C 2s      -0.00000  -0.00000  -0.42887
  1 C 3s      -0.00000  -0.00000   0.04326
  1 C 2px     -0.70648  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70648   0.00000
  1 C 2pz      0.00000  -0.00000   0.55983
  1 C 3px      0.01896  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01896   0.00000
  1 C 3pz     -0.00000   0.00000   0.01780
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02297  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02181
  1 C 3dxz    -0.02297   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99284123
<CAS-nat-orb|mo-hf>  4  4    0.99802530
<CAS-nat-orb|mo-hf>  5  5    0.99963455
<CAS-nat-orb|mo-hf>  6  6    0.99963455
<CAS-nat-orb|mo-hf>  7  7    0.97582840
<CAS-nat-orb|mo-hf>  8  8    0.95889489
<CAS-nat-orb|mo-hf>  9  9    0.95889488
<CAS-nat-orb|mo-hf>  10  10    0.59917813
<CAS-nat-orb|mo-hf>  10  17    0.68689326
CASSCF energy = -75.6047340729271
CASCI E = -75.6047340729271  E(CI) = -16.9234138781712  S^2 = 0.0000000
......production of RDMs took       3.77 sec
......reading the RDM took          0.46 sec
......production of RDMs took      67.55 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.20 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000175609
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000046385
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000651920
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000067570
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000421901
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0000864601
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000288200
HMAT symm error =    0.0065636709
E(MRCI) - E(ref) = -0.1056826829174184 DC = -0.004575349308014919
E(WickICMRCISD)   = -75.71041675584451  E_corr_ci = -0.1056826829174184
E(WickICMRCISD+Q) = -75.71499210515252  E_corr_ci = -0.1102580322254334
Time cost =   3030.240
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 05:43:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.428778469484 AA    0.000000000000   0.000000000000   2.700000000000 Bohr   0.0

nuclear repulsion = 13.3333333333333
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.35]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    835558.01


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp5vjfksrc
max_memory 4000 MB (current use 8398 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1946578857084

WARN: Singularity detected in overlap matrix (condition number =  348). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.199413840928996  LUMO (Ag) = -0.168263344015825
cycle= 1 E= -75.3350369843805  delta_E= -0.14  |g|= 0.225  |ddm|= 1.44
HOMO (B3u) = -0.453464888109062  LUMO (Ag) = -0.151390240663931
cycle= 2 E= -75.3537139122306  delta_E= -0.0187  |g|= 0.0519  |ddm|= 0.284
HOMO (B2u) = -0.415801083744366  LUMO (Ag) = -0.106751931948702
cycle= 3 E= -75.3546580860939  delta_E= -0.000944  |g|= 0.0108  |ddm|= 0.0549
HOMO (B2u) = -0.416822160762624  LUMO (Ag) = -0.103915433790311
cycle= 4 E= -75.3547306562047  delta_E= -7.26e-05  |g|= 0.00215  |ddm|= 0.0177
HOMO (B3u) = -0.417607675822702  LUMO (Ag) = -0.104440258456578
cycle= 5 E= -75.3547338450163  delta_E= -3.19e-06  |g|= 0.000277  |ddm|= 0.00497
HOMO (B3u) = -0.417541021758629  LUMO (Ag) = -0.104353293703207
cycle= 6 E= -75.3547338927568  delta_E= -4.77e-08  |g|= 3.68e-05  |ddm|= 0.000534
HOMO (B3u) = -0.417533919980039  LUMO (Ag) = -0.104341804406659
cycle= 7 E= -75.3547338936913  delta_E= -9.35e-10  |g|= 4.65e-06  |ddm|= 0.000197
HOMO (B3u) = -0.417533963921616  LUMO (Ag) = -0.104341084871122
cycle= 8 E= -75.3547338937024  delta_E= -1.11e-11  |g|= 4.19e-07  |ddm|= 2.62e-05
HOMO (B3u) = -0.41753393566935  LUMO (Ag) = -0.104340979663722
cycle= 9 E= -75.3547338937025  delta_E= -1.14e-13  |g|= 1.9e-08  |ddm|= 2.29e-06
HOMO (B3u) = -0.417533930414545  LUMO (Ag) = -0.104340980550983
cycle= 10 E= -75.3547338937026  delta_E= -5.68e-14  |g|= 2.65e-09  |ddm|= 5.91e-08
HOMO (B2u) = -0.417533930814163  LUMO (Ag) = -0.104340980801866
cycle= 11 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 1.97e-09  |ddm|= 1.76e-09
HOMO (B3u) = -0.41753393089096  LUMO (Ag) = -0.104340980883098
cycle= 12 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 1.5e-09  |ddm|= 1.89e-09
HOMO (B2u) = -0.417533930830964  LUMO (Ag) = -0.104340980797967
cycle= 13 E= -75.3547338937026  delta_E= -8.53e-14  |g|= 1.18e-09  |ddm|= 1.33e-09
HOMO (B2u) = -0.417533930794492  LUMO (Ag) = -0.104340980739339
cycle= 14 E= -75.3547338937025  delta_E= 8.53e-14  |g|= 9.83e-10  |ddm|= 9.21e-10
HOMO (B2u) = -0.417533930774647  LUMO (Ag) = -0.104340980717534
cycle= 15 E= -75.3547338937025  delta_E= -5.68e-14  |g|= 8.53e-10  |ddm|= 7.74e-10
HOMO (B2u) = -0.417533930784768  LUMO (Ag) = -0.104340980767629
cycle= 16 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 7.87e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.417533930718007  LUMO (Ag) = -0.104340980715542
cycle= 17 E= -75.3547338937026  delta_E= -4.26e-14  |g|= 8.01e-10  |ddm|= 3.93e-10
HOMO (B2u) = -0.417533930624118  LUMO (Ag) = -0.104340980573331
cycle= 18 E= -75.3547338937025  delta_E= 1.14e-13  |g|= 3.17e-10  |ddm|= 1.48e-09
HOMO (B2u) = -0.417533930625805  LUMO (Ag) = -0.104340980567546
cycle= 19 E= -75.3547338937025  delta_E=    0  |g|= 2.56e-10  |ddm|= 2.19e-10
HOMO (B2u) = -0.417533930636065  LUMO (Ag) = -0.104340980572393
cycle= 20 E= -75.3547338937026  delta_E= -1.14e-13  |g|= 2.06e-10  |ddm|= 1.7e-10
HOMO (B2u) = -0.417533930645901  LUMO (Ag) = -0.104340980578134
cycle= 21 E= -75.3547338937025  delta_E= 1.14e-13  |g|= 1.69e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.417533930653113  LUMO (Ag) = -0.10434098058254
cycle= 22 E= -75.3547338937025  delta_E= -5.68e-14  |g|= 1.4e-10  |ddm|= 1.03e-10
HOMO (B2u) = -0.417533930658231  LUMO (Ag) = -0.104340980586167
cycle= 23 E= -75.3547338937026  delta_E= -5.68e-14  |g|= 1.16e-10  |ddm|= 8.49e-11
HOMO (B2u) = -0.417533930662181  LUMO (Ag) = -0.104340980588726
cycle= 24 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 9.52e-11  |ddm|= 6.86e-11
HOMO (B2u) = -0.417533930666073  LUMO (Ag) = -0.104340980589479
cycle= 25 E= -75.3547338937025  delta_E= 1.42e-13  |g|= 7.35e-11  |ddm|= 4.6e-11
HOMO (B2u) = -0.417533930668318  LUMO (Ag) = -0.104340980588157
cycle= 26 E= -75.3547338937023  delta_E= 1.42e-13  |g|= 5.01e-11  |ddm|= 5.08e-11
HOMO (B2u) = -0.417533930667265  LUMO (Ag) = -0.104340980585923
cycle= 27 E= -75.3547338937023  delta_E= 5.68e-14  |g|= 4.13e-11  |ddm|= 1.86e-11
HOMO (B2u) = -0.417533930666114  LUMO (Ag) = -0.104340980583871
cycle= 28 E= -75.3547338937023  delta_E= 2.84e-14  |g|= 3.39e-11  |ddm|= 1.39e-11
HOMO (B2u) = -0.417533930665237  LUMO (Ag) = -0.104340980582245
cycle= 29 E= -75.3547338937022  delta_E= 9.95e-14  |g|= 2.81e-11  |ddm|= 1.11e-11
HOMO (B2u) = -0.417533930664623  LUMO (Ag) = -0.104340980580997
cycle= 30 E= -75.354733893702  delta_E= 1.28e-13  |g|= 2.33e-11  |ddm|= 9.23e-12
HOMO (B2u) = -0.417533930664204  LUMO (Ag) = -0.104340980580017
cycle= 31 E= -75.354733893702  delta_E= 5.68e-14  |g|= 1.92e-11  |ddm|= 7.95e-12
HOMO (B2u) = -0.417533930663939  LUMO (Ag) = -0.104340980579205
cycle= 32 E= -75.3547338937019  delta_E= 5.68e-14  |g|= 1.58e-11  |ddm|= 7.02e-12
HOMO (B2u) = -0.417533930663801  LUMO (Ag) = -0.104340980578542
cycle= 33 E= -75.3547338937015  delta_E= 4.55e-13  |g|= 1.34e-11  |ddm|= 5.96e-12
HOMO (B2u) = -0.417533930663776  LUMO (Ag) = -0.104340980578099
cycle= 34 E= -75.3547338937012  delta_E= 2.84e-13  |g|= 1.15e-11  |ddm|= 5.53e-12
HOMO (B2u) = -0.417533930663806  LUMO (Ag) = -0.104340980577842
cycle= 35 E= -75.3547338937006  delta_E= 6.25e-13  |g|= 1.08e-11  |ddm|= 3.52e-12
HOMO (B2u) = -0.417533930663776  LUMO (Ag) = -0.104340980577563
cycle= 36 E= -75.3547338936996  delta_E= 9.66e-13  |g|= 1.1e-11  |ddm|= 3.5e-12
HOMO (B2u) = -0.417533930663681  LUMO (Ag) = -0.104340980577272
cycle= 37 E= -75.3547338936989  delta_E= 6.82e-13  |g|= 1.1e-11  |ddm|= 3.09e-12
HOMO (B2u) = -0.417533930663538  LUMO (Ag) = -0.104340980576976
cycle= 38 E= -75.3547338936985  delta_E= 4.41e-13  |g|= 9.91e-12  |ddm|= 3.76e-12
HOMO (B2u) = -0.417533930663364  LUMO (Ag) = -0.104340980576671
cycle= 39 E= -75.3547338936983  delta_E= 1.56e-13  |g|= 8.52e-12  |ddm|= 4.19e-12
HOMO (B2u) = -0.417533930663179  LUMO (Ag) = -0.104340980576376
cycle= 40 E= -75.3547338936983  delta_E= 4.26e-14  |g|= 7.2e-12  |ddm|= 4.63e-12
HOMO (B2u) = -0.417533930662994  LUMO (Ag) = -0.104340980576105
cycle= 41 E= -75.3547338936981  delta_E= 2.13e-13  |g|= 6.3e-12  |ddm|= 4.1e-12
HOMO (B2u) = -0.417533930662808  LUMO (Ag) = -0.104340980575858
cycle= 42 E= -75.354733893698  delta_E= 2.84e-14  |g|= 5.47e-12  |ddm|= 4.75e-12
HOMO (B2u) = -0.417533930662632  LUMO (Ag) = -0.104340980575638
cycle= 43 E= -75.3547338936972  delta_E= 7.96e-13  |g|= 5.96e-12  |ddm|= 2.8e-12
HOMO (B2u) = -0.417533930662458  LUMO (Ag) = -0.104340980575444
cycle= 44 E= -75.3547338936962  delta_E= 9.95e-13  |g|= 6.93e-12  |ddm|= 2.31e-12
HOMO (B2u) = -0.417533930662276  LUMO (Ag) = -0.104340980575264
cycle= 45 E= -75.3547338936952  delta_E= 1.05e-12  |g|= 1.27e-11  |ddm|= 1.8e-12
HOMO (B2u) = -0.417533930662073  LUMO (Ag) = -0.104340980575074
cycle= 46 E= -75.3547338936952  delta_E= -5.68e-14  |g|= 1.13e-11  |ddm|= 1.02e-11
HOMO (B2u) = -0.417533930661889  LUMO (Ag) = -0.104340980574898
cycle= 47 E= -75.3547338936952  delta_E= 8.53e-14  |g|= 9.78e-12  |ddm|= 1.07e-11
HOMO (B2u) = -0.417533930661708  LUMO (Ag) = -0.104340980574722
cycle= 48 E= -75.3547338936952  delta_E= -2.84e-14  |g|= 8.35e-12  |ddm|= 1.13e-11
HOMO (B2u) = -0.417533930661524  LUMO (Ag) = -0.104340980574536
cycle= 49 E= -75.3547338936951  delta_E= 8.53e-14  |g|= 7.07e-12  |ddm|= 1.19e-11
HOMO (B2u) = -0.417533930661351  LUMO (Ag) = -0.104340980574346
cycle= 50 E= -75.354733893695  delta_E= 7.11e-14  |g|= 5.83e-12  |ddm|= 1.31e-11
SCF not converged.
SCF energy = -75.354733893695

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp5vjfksrc
max_memory 4000 MB (current use 8398 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5336329215203  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5570159697811  dE = -0.023383048  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0767
macro iter 2 (6 JK  0 micro), CASSCF E = -75.569355230139  dE = -0.01233926  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0693  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5774785831027  dE = -0.008123353  S^2 = 0.0000000
               |grad[o]|=0.0922  |ddm|=0.0294  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5835741793733  dE = -0.0060955963  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0162  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5883444835065  dE = -0.0047703041  S^2 = 0.0000000
               |grad[o]|=0.0599  |ddm|=0.0107  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5920437676248  dE = -0.0036992841  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00775  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5947849401541  dE = -0.0027411725  S^2 = 0.0000000
               |grad[o]|=0.0356  |ddm|=0.00594  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5966317625486  dE = -0.0018468224  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00502  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5976344316745  dE = -0.0010026691  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00495  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5978366751261  dE = -0.00020224345  S^2 = 0.0000000
               |grad[o]|=0.00622  |ddm|=0.00558  |maxRot[o]|= 0.04
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5978670904779  dE = -3.0415352e-05  S^2 = 0.0000000
               |grad[o]|=0.00217  |ddm|=0.00321  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5978677925341  dE = -7.0205624e-07  S^2 = 0.0000000
               |grad[o]|=0.000396  |ddm|=0.00173  |maxRot[o]|=0.00284
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5978678056029  dE = -1.3068757e-08  S^2 = 0.0000000
               |grad[o]|=6.44e-05  |ddm|=0.000312  |maxRot[o]|=0.000323
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5978678060264  dE = -4.2348347e-10  S^2 = 0.0000000
               |grad[o]|=1.43e-05  |ddm|=4.96e-05  |maxRot[o]|=6.01e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5978678060471  dE = -2.0733637e-11  S^2 = 0.0000000
               |grad[o]|=3.49e-06  |ddm|=7.4e-06  |maxRot[o]|=1.25e-05
2-step CASSCF converged in 15 macro (73 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97829968 1.67678243 1.83943605 1.83943641 0.32392932 0.16144608
 0.16144608 0.01922395]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00588   0.00336   0.00000   0.00000  -0.00095
  0 C 2s       0.61465   0.56857  -0.00000  -0.00000  -0.34718
  0 C 3s      -0.03607   0.00891  -0.00000   0.00000   0.00734
  0 C 2px      0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py      0.00000  -0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34438  -0.42027   0.00000   0.00000   0.61414
  0 C 3px      0.00000   0.00000  -0.00000   0.01064   0.00000
  0 C 3py      0.00000  -0.00000   0.01064   0.00000  -0.00000
  0 C 3pz     -0.03594  -0.00262  -0.00000   0.00000  -0.04307
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.02590   0.00000  -0.00000
  0 C 3dz^2    0.03130  -0.00139  -0.00000   0.00000   0.01982
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02590   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00588  -0.00336   0.00000   0.00000  -0.00095
  1 C 2s       0.61465  -0.56857   0.00000  -0.00000  -0.34718
  1 C 3s      -0.03607  -0.00891   0.00000  -0.00000   0.00734
  1 C 2px      0.00000  -0.00000   0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000   0.00000
  1 C 2pz     -0.34438  -0.42027   0.00000   0.00000  -0.61414
  1 C 3px     -0.00000   0.00000   0.00000   0.01064  -0.00000
  1 C 3py     -0.00000   0.00000   0.01064  -0.00000   0.00000
  1 C 3pz      0.03594  -0.00262  -0.00000   0.00000   0.04307
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02590   0.00000  -0.00000
  1 C 3dz^2    0.03130   0.00139   0.00000  -0.00000   0.01982
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02590   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00044
  0 C 2s      -0.00000  -0.00000   0.41964
  0 C 3s       0.00000  -0.00000  -0.04337
  0 C 2px      0.70651  -0.00000   0.00000
  0 C 2py     -0.00000   0.70651  -0.00000
  0 C 2pz      0.00000  -0.00000   0.56675
  0 C 3px     -0.01810  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01810  -0.00000
  0 C 3pz      0.00000  -0.00000   0.01881
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02276  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02148
  0 C 3dxz    -0.02276  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00044
  1 C 2s      -0.00000   0.00000  -0.41964
  1 C 3s      -0.00000   0.00000   0.04337
  1 C 2px     -0.70651   0.00000   0.00000
  1 C 2py      0.00000  -0.70651   0.00000
  1 C 2pz     -0.00000   0.00000   0.56675
  1 C 3px      0.01810   0.00000  -0.00000
  1 C 3py      0.00000   0.01810   0.00000
  1 C 3pz      0.00000  -0.00000   0.01881
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02276  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02148
  1 C 3dxz    -0.02276  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99254645
<CAS-nat-orb|mo-hf>  4  4    0.99791956
<CAS-nat-orb|mo-hf>  5  5    0.99960057
<CAS-nat-orb|mo-hf>  6  6    0.99960057
<CAS-nat-orb|mo-hf>  7  7    0.97536360
<CAS-nat-orb|mo-hf>  8  8    0.96172744
<CAS-nat-orb|mo-hf>  9  9    0.96172746
<CAS-nat-orb|mo-hf>  10  10    0.62371776
<CAS-nat-orb|mo-hf>  10  17    0.67956595
CASSCF energy = -75.5978678060471
CASCI E = -75.5978678060471  E(CI) = -16.8047461411191  S^2 = 0.0000000
......production of RDMs took       4.96 sec
......reading the RDM took          0.46 sec
......production of RDMs took      78.67 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          8.95 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000033666
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000008892
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000317272
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000036416
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000197957
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0000488945
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000162982
HMAT symm error =    0.0047753929
E(MRCI) - E(ref) = -0.1059982321796866 DC = -0.004633307799151516
E(WickICMRCISD)   = -75.70386603822681  E_corr_ci = -0.1059982321796866
E(WickICMRCISD+Q) = -75.70849934602596  E_corr_ci = -0.1106315399788381
Time cost =   3347.884
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 06:39:11 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.455237330030 AA    0.000000000000   0.000000000000   2.750000000000 Bohr   0.0

nuclear repulsion = 13.0909090909091
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.375]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    881698.10


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpndzm_gvt
max_memory 4000 MB (current use 8396 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1557644738047

WARN: Singularity detected in overlap matrix (condition number =  321). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.19200419727189  LUMO (Ag) = -0.166086961504869
cycle= 1 E= -75.3260871697503  delta_E= -0.17  |g|= 0.228  |ddm|= 1.44
HOMO (B2u) = -0.448902413635198  LUMO (Ag) = -0.151522743525038
cycle= 2 E= -75.3454236890815  delta_E= -0.0193  |g|= 0.0517  |ddm|= 0.291
HOMO (B2u) = -0.411143114796123  LUMO (Ag) = -0.105979877749064
cycle= 3 E= -75.3463869604458  delta_E= -0.000963  |g|= 0.0112  |ddm|= 0.0546
HOMO (B3u) = -0.412216378156836  LUMO (Ag) = -0.102966454342322
cycle= 4 E= -75.3464661736964  delta_E= -7.92e-05  |g|= 0.00221  |ddm|= 0.0168
HOMO (B2u) = -0.413005500150536  LUMO (Ag) = -0.103497081119969
cycle= 5 E= -75.3464696035283  delta_E= -3.43e-06  |g|= 0.000295  |ddm|= 0.00439
HOMO (B3u) = -0.412935226123343  LUMO (Ag) = -0.103410770619273
cycle= 6 E= -75.3464696577874  delta_E= -5.43e-08  |g|= 3.83e-05  |ddm|= 0.000585
HOMO (B2u) = -0.4129277426732  LUMO (Ag) = -0.103398722647748
cycle= 7 E= -75.346469658793  delta_E= -1.01e-09  |g|= 4.88e-06  |ddm|= 0.00019
HOMO (B2u) = -0.412927696344276  LUMO (Ag) = -0.103397915940693
cycle= 8 E= -75.3464696588055  delta_E= -1.25e-11  |g|= 4.41e-07  |ddm|= 2.55e-05
HOMO (B2u) = -0.412927666372067  LUMO (Ag) = -0.103397797537191
cycle= 9 E= -75.3464696588055  delta_E=    0  |g|= 1.96e-08  |ddm|= 2.16e-06
HOMO (B2u) = -0.412927660626365  LUMO (Ag) = -0.103397800029288
cycle= 10 E= -75.3464696588056  delta_E= -1.14e-13  |g|= 2.79e-09  |ddm|= 6.4e-08
HOMO (B2u) = -0.412927661254343  LUMO (Ag) = -0.103397800547652
cycle= 11 E= -75.3464696588055  delta_E= 9.95e-14  |g|= 2.27e-09  |ddm|= 1.8e-09
HOMO (B2u) = -0.412927661143677  LUMO (Ag) = -0.103397800408825
cycle= 12 E= -75.3464696588056  delta_E= -7.11e-14  |g|= 1.62e-09  |ddm|= 2.56e-09
HOMO (B2u) = -0.412927661098319  LUMO (Ag) = -0.103397800323989
cycle= 13 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 1.29e-09  |ddm|= 1.58e-09
HOMO (B2u) = -0.412927661060721  LUMO (Ag) = -0.103397800268892
cycle= 14 E= -75.3464696588057  delta_E= -1.42e-13  |g|= 1.06e-09  |ddm|= 1e-09
HOMO (B2u) = -0.41292766103975  LUMO (Ag) = -0.103397800245314
cycle= 15 E= -75.3464696588056  delta_E= 9.95e-14  |g|= 9.1e-10  |ddm|= 6.98e-10
HOMO (B2u) = -0.412927661042114  LUMO (Ag) = -0.103397800286391
cycle= 16 E= -75.3464696588056  delta_E= -1.42e-14  |g|= 8.43e-10  |ddm|= 1.25e-09
HOMO (B2u) = -0.412927660985037  LUMO (Ag) = -0.103397800239682
cycle= 17 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 8.37e-10  |ddm|= 1.77e-10
HOMO (B2u) = -0.41292766087313  LUMO (Ag) = -0.103397800091716
cycle= 18 E= -75.3464696588056  delta_E= -5.68e-14  |g|= 3.44e-10  |ddm|= 1.65e-09
HOMO (B2u) = -0.412927660874971  LUMO (Ag) = -0.103397800086035
cycle= 19 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 2.81e-10  |ddm|= 2.47e-10
HOMO (B3u) = -0.412927660889728  LUMO (Ag) = -0.103397800094609
cycle= 20 E= -75.3464696588055  delta_E=    0  |g|= 2.22e-10  |ddm|= 1.97e-10
HOMO (B3u) = -0.412927660899975  LUMO (Ag) = -0.103397800100643
cycle= 21 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 1.81e-10  |ddm|= 1.45e-10
HOMO (B3u) = -0.412927660907479  LUMO (Ag) = -0.103397800105607
cycle= 22 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 1.49e-10  |ddm|= 1.12e-10
HOMO (B3u) = -0.412927660912976  LUMO (Ag) = -0.103397800109685
cycle= 23 E= -75.3464696588055  delta_E= 8.53e-14  |g|= 1.23e-10  |ddm|= 9.2e-11
HOMO (B3u) = -0.412927660917522  LUMO (Ag) = -0.103397800113041
cycle= 24 E= -75.3464696588056  delta_E= -5.68e-14  |g|= 1.01e-10  |ddm|= 7.84e-11
HOMO (B3u) = -0.412927660921703  LUMO (Ag) = -0.103397800114419
cycle= 25 E= -75.3464696588055  delta_E= 1.14e-13  |g|= 7.76e-11  |ddm|= 5.48e-11
HOMO (B3u) = -0.412927660924298  LUMO (Ag) = -0.1033978001139
cycle= 26 E= -75.3464696588053  delta_E= 1.42e-13  |g|= 5.36e-11  |ddm|= 5.72e-11
HOMO (B3u) = -0.412927660923069  LUMO (Ag) = -0.103397800111495
cycle= 27 E= -75.3464696588053  delta_E= -1.42e-14  |g|= 4.39e-11  |ddm|= 2.12e-11
HOMO (B3u) = -0.412927660921724  LUMO (Ag) = -0.103397800109243
cycle= 28 E= -75.3464696588051  delta_E= 1.85e-13  |g|= 3.58e-11  |ddm|= 1.61e-11
HOMO (B3u) = -0.412927660920781  LUMO (Ag) = -0.10339780010759
cycle= 29 E= -75.3464696588051  delta_E= 5.68e-14  |g|= 2.95e-11  |ddm|= 1.19e-11
HOMO (B3u) = -0.412927660920102  LUMO (Ag) = -0.10339780010633
cycle= 30 E= -75.346469658805  delta_E= 1.14e-13  |g|= 2.42e-11  |ddm|= 9.67e-12
HOMO (B3u) = -0.412927660919631  LUMO (Ag) = -0.103397800105347
cycle= 31 E= -75.3464696588048  delta_E= 1.71e-13  |g|= 1.99e-11  |ddm|= 8.27e-12
HOMO (B3u) = -0.412927660919327  LUMO (Ag) = -0.103397800104548
cycle= 32 E= -75.3464696588046  delta_E= 2.27e-13  |g|= 1.65e-11  |ddm|= 7.11e-12
HOMO (B3u) = -0.412927660919154  LUMO (Ag) = -0.103397800103891
cycle= 33 E= -75.3464696588044  delta_E= 2.27e-13  |g|= 1.41e-11  |ddm|= 6.31e-12
HOMO (B3u) = -0.412927660919105  LUMO (Ag) = -0.103397800103452
cycle= 34 E= -75.3464696588038  delta_E= 5.12e-13  |g|= 1.26e-11  |ddm|= 5.24e-12
HOMO (B3u) = -0.412927660919116  LUMO (Ag) = -0.103397800103194
cycle= 35 E= -75.3464696588031  delta_E= 7.39e-13  |g|= 1.2e-11  |ddm|= 3.83e-12
HOMO (B3u) = -0.41292766091906  LUMO (Ag) = -0.103397800102921
cycle= 36 E= -75.3464696588022  delta_E= 8.81e-13  |g|= 1.17e-11  |ddm|= 3.46e-12
HOMO (B3u) = -0.412927660918932  LUMO (Ag) = -0.10339780010262
cycle= 37 E= -75.3464696588013  delta_E= 9.66e-13  |g|= 1.27e-11  |ddm|= 3.39e-12
HOMO (B3u) = -0.412927660918743  LUMO (Ag) = -0.103397800102297
cycle= 38 E= -75.3464696588005  delta_E= 7.39e-13  |g|= 1.21e-11  |ddm|= 3.12e-12
HOMO (B3u) = -0.412927660918511  LUMO (Ag) = -0.103397800101959
cycle= 39 E= -75.3464696588003  delta_E= 1.71e-13  |g|= 1.04e-11  |ddm|= 4.14e-12
HOMO (B3u) = -0.412927660918268  LUMO (Ag) = -0.103397800101634
cycle= 40 E= -75.3464696588  delta_E= 2.98e-13  |g|= 8.85e-12  |ddm|= 4.43e-12
HOMO (B3u) = -0.41292766091802  LUMO (Ag) = -0.103397800101327
cycle= 41 E= -75.3464696587999  delta_E= 1.28e-13  |g|= 7.43e-12  |ddm|= 4.9e-12
HOMO (B3u) = -0.412927660917783  LUMO (Ag) = -0.103397800101045
cycle= 42 E= -75.3464696587999  delta_E= 2.84e-14  |g|= 6.42e-12  |ddm|= 4.85e-12
HOMO (B3u) = -0.412927660917566  LUMO (Ag) = -0.103397800100793
cycle= 43 E= -75.3464696587997  delta_E= 1.99e-13  |g|= 5.7e-12  |ddm|= 4.31e-12
HOMO (B3u) = -0.412927660917376  LUMO (Ag) = -0.103397800100575
cycle= 44 E= -75.3464696587991  delta_E= 6.25e-13  |g|= 6.09e-12  |ddm|= 3.05e-12
HOMO (B3u) = -0.412927660917204  LUMO (Ag) = -0.103397800100392
cycle= 45 E= -75.3464696587979  delta_E= 1.17e-12  |g|= 1.22e-11  |ddm|= 1.9e-12
HOMO (B3u) = -0.412927660917014  LUMO (Ag) = -0.103397800100204
cycle= 46 E= -75.3464696587978  delta_E= 5.68e-14  |g|= 1.09e-11  |ddm|= 9.73e-12
HOMO (B3u) = -0.412927660916862  LUMO (Ag) = -0.10339780010005
cycle= 47 E= -75.346469658798  delta_E= -1.28e-13  |g|= 9.62e-12  |ddm|= 9.72e-12
HOMO (B3u) = -0.412927660916722  LUMO (Ag) = -0.103397800099909
cycle= 48 E= -75.3464696587979  delta_E= 5.68e-14  |g|= 8.29e-12  |ddm|= 1.05e-11
HOMO (B3u) = -0.412927660916591  LUMO (Ag) = -0.103397800099773
cycle= 49 E= -75.3464696587979  delta_E= 1.42e-14  |g|= 6.83e-12  |ddm|= 1.13e-11
HOMO (B3u) = -0.412927660916458  LUMO (Ag) = -0.103397800099626
cycle= 50 E= -75.3464696587979  delta_E= -2.84e-14  |g|= 5.24e-12  |ddm|= 1.18e-11
SCF not converged.
SCF energy = -75.3464696587979

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpndzm_gvt
max_memory 4000 MB (current use 8396 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5273817495056  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.550567376779  dE = -0.023185627  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0789
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5627306637848  dE = -0.012163287  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5708350967081  dE = -0.0081044329  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0298  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.576907490014  dE = -0.0060723933  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0169  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5816177919831  dE = -0.004710302  S^2 = 0.0000000
               |grad[o]|=0.0598  |ddm|=0.0112  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5852166480513  dE = -0.0035988561  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.00806  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5878213075554  dE = -0.0026046595  S^2 = 0.0000000
               |grad[o]|=0.0347  |ddm|=0.00612  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5895012709155  dE = -0.0016799634  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5903141198196  dE = -0.0008128489  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.00535  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5904157781655  dE = -0.00010165835  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.00625  |maxRot[o]|=0.0374
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5904169951707  dE = -1.2170052e-06  S^2 = 0.0000000
               |grad[o]|=0.000613  |ddm|=0.00344  |maxRot[o]|=0.00344
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5904170206057  dE = -2.5434986e-08  S^2 = 0.0000000
               |grad[o]|=9.08e-05  |ddm|=0.000454  |maxRot[o]|=0.000414
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5904170213115  dE = -7.0579631e-10  S^2 = 0.0000000
               |grad[o]|=1.74e-05  |ddm|=6.53e-05  |maxRot[o]|=6.97e-05
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5904170213273  dE = -1.580247e-11  S^2 = 0.0000000
               |grad[o]|=3.39e-06  |ddm|=1.18e-05  |maxRot[o]|=7.78e-06
2-step CASSCF converged in 14 macro (71 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97743797 1.68610695 1.83058025 1.83058126 0.31631711 0.16943555
 0.16943539 0.02010551]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00615   0.00344   0.00000   0.00000  -0.00091
  0 C 2s       0.61773   0.57533   0.00000  -0.00000  -0.34180
  0 C 3s      -0.03411   0.00898  -0.00000  -0.00000   0.00990
  0 C 2px      0.00000  -0.00000  -0.00000   0.70654  -0.00000
  0 C 2py     -0.00000   0.00000   0.70654  -0.00000  -0.00000
  0 C 2pz      0.33928  -0.41097  -0.00000  -0.00000   0.61707
  0 C 3px     -0.00000  -0.00000   0.00000   0.01297  -0.00000
  0 C 3py      0.00000  -0.00000   0.01297   0.00000  -0.00000
  0 C 3pz     -0.03426  -0.00242  -0.00000  -0.00000  -0.04286
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02505   0.00000  -0.00000
  0 C 3dz^2    0.03040  -0.00175  -0.00000  -0.00000   0.02149
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02505  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00615  -0.00344   0.00000   0.00000  -0.00091
  1 C 2s       0.61773  -0.57533  -0.00000   0.00000  -0.34180
  1 C 3s      -0.03411  -0.00898   0.00000   0.00000   0.00990
  1 C 2px      0.00000   0.00000  -0.00000   0.70654  -0.00000
  1 C 2py      0.00000   0.00000   0.70654  -0.00000   0.00000
  1 C 2pz     -0.33928  -0.41097  -0.00000   0.00000  -0.61707
  1 C 3px     -0.00000   0.00000   0.00000   0.01297   0.00000
  1 C 3py      0.00000  -0.00000   0.01297  -0.00000   0.00000
  1 C 3pz      0.03426  -0.00242  -0.00000  -0.00000   0.04286
  1 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02505   0.00000  -0.00000
  1 C 3dz^2    0.03040   0.00175   0.00000   0.00000   0.02149
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02505  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s      -0.00000   0.00000   0.41035
  0 C 3s      -0.00000  -0.00000  -0.04345
  0 C 2px      0.70654   0.00000  -0.00000
  0 C 2py     -0.00000   0.70654  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.57349
  0 C 3px     -0.01725  -0.00000   0.00000
  0 C 3py     -0.00000  -0.01725  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01967
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02253  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02125
  0 C 3dxz    -0.02253  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.41035
  1 C 3s       0.00000   0.00000   0.04345
  1 C 2px     -0.70654   0.00000  -0.00000
  1 C 2py      0.00000  -0.70654   0.00000
  1 C 2pz      0.00000   0.00000   0.57349
  1 C 3px      0.01725  -0.00000   0.00000
  1 C 3py      0.00000   0.01725   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01967
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02253  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02125
  1 C 3dxz    -0.02253   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99226092
<CAS-nat-orb|mo-hf>  4  4    0.99781292
<CAS-nat-orb|mo-hf>  5  5    0.99956408
<CAS-nat-orb|mo-hf>  6  6    0.99956408
<CAS-nat-orb|mo-hf>  7  7    0.97493012
<CAS-nat-orb|mo-hf>  8  8    0.96431698
<CAS-nat-orb|mo-hf>  9  9    0.96431699
<CAS-nat-orb|mo-hf>  10  10    0.64879976
<CAS-nat-orb|mo-hf>  10  17    0.66873233
CASSCF energy = -75.5904170213273
CASCI E = -75.5904170213273  E(CI) = -16.6895622080545  S^2 = 0.0000000
......production of RDMs took       2.33 sec
......reading the RDM took          0.42 sec
......production of RDMs took      83.33 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.37 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000056756
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000014991
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000810543
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000092199
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000504982
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001123643
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000374548
HMAT symm error =    0.0076233877
E(MRCI) - E(ref) = -0.1063324562162933 DC = -0.004694033188795891
E(WickICMRCISD)   = -75.69674947754362  E_corr_ci = -0.1063324562162933
E(WickICMRCISD+Q) = -75.70144351073242  E_corr_ci = -0.1110264894050892
Time cost =   3158.487
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 07:31:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.481696190576 AA    0.000000000000   0.000000000000   2.800000000000 Bohr   0.0

nuclear repulsion = 12.8571428571429
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.4]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    929022.65


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp270kbzpw
max_memory 4000 MB (current use 8398 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1187592585641

WARN: Singularity detected in overlap matrix (condition number =  297). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.184977014444632  LUMO (Ag) = -0.163989710542373
cycle= 1 E= -75.3167358242476  delta_E= -0.198  |g|= 0.231  |ddm|= 1.44
HOMO (B3u) = -0.444434359277165  LUMO (Ag) = -0.151416963696338
cycle= 2 E= -75.3367114409982  delta_E= -0.02  |g|= 0.0515  |ddm|= 0.298
HOMO (B2u) = -0.406594326641876  LUMO (Ag) = -0.105005000614386
cycle= 3 E= -75.3376920455643  delta_E= -0.000981  |g|= 0.0117  |ddm|= 0.0545
HOMO (B3u) = -0.407746719644285  LUMO (Ag) = -0.101871698894465
cycle= 4 E= -75.3377779901322  delta_E= -8.59e-05  |g|= 0.00225  |ddm|= 0.0162
HOMO (B2u) = -0.408536003811461  LUMO (Ag) = -0.102414153547258
cycle= 5 E= -75.3377816192104  delta_E= -3.63e-06  |g|= 0.000309  |ddm|= 0.00396
HOMO (B3u) = -0.408464040126319  LUMO (Ag) = -0.102331174534053
cycle= 6 E= -75.3377816780684  delta_E= -5.89e-08  |g|= 3.95e-05  |ddm|= 0.000618
HOMO (B2u) = -0.408456256018869  LUMO (Ag) = -0.102318677176297
cycle= 7 E= -75.3377816791323  delta_E= -1.06e-09  |g|= 5.06e-06  |ddm|= 0.00018
HOMO (B3u) = -0.40845610623603  LUMO (Ag) = -0.102317785563311
cycle= 8 E= -75.337781679146  delta_E= -1.37e-11  |g|= 4.62e-07  |ddm|= 2.48e-05
HOMO (B2u) = -0.408456075143802  LUMO (Ag) = -0.102317652725201
cycle= 9 E= -75.337781679146  delta_E= 2.84e-14  |g|= 2.02e-08  |ddm|= 1.99e-06
HOMO (B3u) = -0.408456068963826  LUMO (Ag) = -0.102317657025672
cycle= 10 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 2.92e-09  |ddm|= 6.88e-08
HOMO (B3u) = -0.408456069755509  LUMO (Ag) = -0.10231765774182
cycle= 11 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 2.43e-09  |ddm|= 2.37e-09
HOMO (B3u) = -0.408456069552397  LUMO (Ag) = -0.102317657486114
cycle= 12 E= -75.3377816791461  delta_E= -1.42e-14  |g|= 1.71e-09  |ddm|= 2.85e-09
HOMO (B3u) = -0.408456069503525  LUMO (Ag) = -0.102317657383057
cycle= 13 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 1.38e-09  |ddm|= 1.53e-09
HOMO (B3u) = -0.408456069460314  LUMO (Ag) = -0.102317657325529
cycle= 14 E= -75.3377816791461  delta_E= 2.84e-14  |g|= 1.14e-09  |ddm|= 1e-09
HOMO (B3u) = -0.408456069436735  LUMO (Ag) = -0.102317657300138
cycle= 15 E= -75.3377816791461  delta_E=    0  |g|= 9.7e-10  |ddm|= 6.23e-10
HOMO (B3u) = -0.40845606943728  LUMO (Ag) = -0.102317657335113
cycle= 16 E= -75.337781679146  delta_E= 5.68e-14  |g|= 8.89e-10  |ddm|= 1.18e-09
HOMO (B3u) = -0.408456069387151  LUMO (Ag) = -0.10231765729339
cycle= 17 E= -75.3377816791461  delta_E= -1.14e-13  |g|= 8.67e-10  |ddm|= 8.47e-11
HOMO (B3u) = -0.408456069259322  LUMO (Ag) = -0.102317657143801
cycle= 18 E= -75.3377816791461  delta_E= 2.84e-14  |g|= 3.66e-10  |ddm|= 1.82e-09
HOMO (B3u) = -0.408456069261092  LUMO (Ag) = -0.102317657138117
cycle= 19 E= -75.3377816791461  delta_E=    0  |g|= 2.99e-10  |ddm|= 2.73e-10
HOMO (B3u) = -0.408456069278289  LUMO (Ag) = -0.102317657148925
cycle= 20 E= -75.337781679146  delta_E= 8.53e-14  |g|= 2.36e-10  |ddm|= 2.1e-10
HOMO (B3u) = -0.408456069289258  LUMO (Ag) = -0.102317657155447
cycle= 21 E= -75.3377816791461  delta_E= -4.26e-14  |g|= 1.92e-10  |ddm|= 1.51e-10
HOMO (B3u) = -0.408456069297003  LUMO (Ag) = -0.102317657160983
cycle= 22 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 1.57e-10  |ddm|= 1.18e-10
HOMO (B3u) = -0.408456069302697  LUMO (Ag) = -0.102317657165485
cycle= 23 E= -75.3377816791461  delta_E= -1.42e-14  |g|= 1.28e-10  |ddm|= 9.79e-11
HOMO (B3u) = -0.408456069307729  LUMO (Ag) = -0.102317657169658
cycle= 24 E= -75.337781679146  delta_E= 1.28e-13  |g|= 1.05e-10  |ddm|= 8.81e-11
HOMO (B3u) = -0.408456069312227  LUMO (Ag) = -0.102317657171908
cycle= 25 E= -75.337781679146  delta_E= -1.42e-14  |g|= 8.08e-11  |ddm|= 6.41e-11
HOMO (B3u) = -0.408456069315188  LUMO (Ag) = -0.10231765717237
cycle= 26 E= -75.337781679146  delta_E= 2.84e-14  |g|= 5.65e-11  |ddm|= 6.32e-11
HOMO (B3u) = -0.408456069313846  LUMO (Ag) = -0.102317657169912
cycle= 27 E= -75.337781679146  delta_E= -5.68e-14  |g|= 4.61e-11  |ddm|= 2.28e-11
HOMO (B3u) = -0.408456069312357  LUMO (Ag) = -0.102317657167573
cycle= 28 E= -75.3377816791458  delta_E= 2.13e-13  |g|= 3.75e-11  |ddm|= 1.75e-11
HOMO (B2u) = -0.408456069311334  LUMO (Ag) = -0.102317657165921
cycle= 29 E= -75.3377816791457  delta_E= 9.95e-14  |g|= 3.07e-11  |ddm|= 1.29e-11
HOMO (B2u) = -0.408456069310589  LUMO (Ag) = -0.1023176571647
cycle= 30 E= -75.3377816791457  delta_E= 1.42e-14  |g|= 2.52e-11  |ddm|= 1e-11
HOMO (B2u) = -0.408456069310079  LUMO (Ag) = -0.102317657163775
cycle= 31 E= -75.3377816791455  delta_E= 1.85e-13  |g|= 2.06e-11  |ddm|= 8.35e-12
HOMO (B2u) = -0.408456069309745  LUMO (Ag) = -0.102317657163044
cycle= 32 E= -75.3377816791453  delta_E= 1.99e-13  |g|= 1.7e-11  |ddm|= 6.99e-12
HOMO (B2u) = -0.408456069309552  LUMO (Ag) = -0.102317657162446
cycle= 33 E= -75.3377816791451  delta_E= 1.99e-13  |g|= 1.41e-11  |ddm|= 6.17e-12
HOMO (B2u) = -0.40845606930949  LUMO (Ag) = -0.102317657162036
cycle= 34 E= -75.3377816791446  delta_E= 4.69e-13  |g|= 1.23e-11  |ddm|= 4.86e-12
HOMO (B2u) = -0.408456069309506  LUMO (Ag) = -0.102317657161791
cycle= 35 E= -75.3377816791441  delta_E= 5.83e-13  |g|= 1.13e-11  |ddm|= 3.63e-12
HOMO (B2u) = -0.408456069309466  LUMO (Ag) = -0.102317657161531
cycle= 36 E= -75.3377816791432  delta_E= 8.81e-13  |g|= 1.13e-11  |ddm|= 3.12e-12
HOMO (B2u) = -0.408456069309358  LUMO (Ag) = -0.102317657161228
cycle= 37 E= -75.3377816791424  delta_E= 8.24e-13  |g|= 1.16e-11  |ddm|= 3.07e-12
HOMO (B2u) = -0.408456069309202  LUMO (Ag) = -0.10231765716091
cycle= 38 E= -75.3377816791413  delta_E= 1.02e-12  |g|= 1.74e-11  |ddm|= 2.62e-12
HOMO (B2u) = -0.408456069308987  LUMO (Ag) = -0.102317657160555
cycle= 39 E= -75.3377816791413  delta_E= 5.68e-14  |g|= 1.55e-11  |ddm|= 1.19e-11
HOMO (B2u) = -0.408456069308771  LUMO (Ag) = -0.102317657160219
cycle= 40 E= -75.3377816791412  delta_E= 8.53e-14  |g|= 1.35e-11  |ddm|= 1.29e-11
HOMO (B2u) = -0.408456069308561  LUMO (Ag) = -0.102317657159908
cycle= 41 E= -75.337781679141  delta_E= 1.56e-13  |g|= 1.15e-11  |ddm|= 1.25e-11
HOMO (B2u) = -0.408456069308355  LUMO (Ag) = -0.102317657159613
cycle= 42 E= -75.337781679141  delta_E= 2.84e-14  |g|= 9.59e-12  |ddm|= 1.46e-11
HOMO (B2u) = -0.408456069308165  LUMO (Ag) = -0.102317657159339
cycle= 43 E= -75.3377816791409  delta_E= 8.53e-14  |g|= 7.81e-12  |ddm|= 1.48e-11
HOMO (B2u) = -0.408456069308003  LUMO (Ag) = -0.102317657159104
cycle= 44 E= -75.3377816791409  delta_E= 4.26e-14  |g|= 6.06e-12  |ddm|= 1.51e-11
HOMO (B2u) = -0.40845606930788  LUMO (Ag) = -0.102317657158914
cycle= 45 E= -75.3377816791408  delta_E= 9.95e-14  |g|= 4.57e-12  |ddm|= 1.23e-11
HOMO (B2u) = -0.408456069307787  LUMO (Ag) = -0.102317657158737
cycle= 46 E= -75.3377816791409  delta_E= -1.56e-13  |g|= 3.68e-12  |ddm|= 1.12e-11
HOMO (B2u) = -0.408456069307751  LUMO (Ag) = -0.102317657158609
cycle= 47 E= -75.33778167914  delta_E= 9.66e-13  |g|= 5.57e-12  |ddm|= 1.59e-12
HOMO (B2u) = -0.408456069307679  LUMO (Ag) = -0.102317657158475
cycle= 48 E= -75.3377816791399  delta_E= 8.53e-14  |g|= 4.5e-12  |ddm|= 4.58e-12
HOMO (B2u) = -0.408456069307607  LUMO (Ag) = -0.102317657158339
cycle= 49 E= -75.3377816791398  delta_E= 8.53e-14  |g|= 3.64e-12  |ddm|= 3.88e-12
HOMO (B2u) = -0.40845606930754  LUMO (Ag) = -0.102317657158216
cycle= 50 E= -75.3377816791395  delta_E= 3.41e-13  |g|= 3.91e-12  |ddm|= 3.02e-12
SCF not converged.
SCF energy = -75.3377816791395

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp270kbzpw
max_memory 4000 MB (current use 8398 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5207710561412  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5435755559905  dE = -0.0228045  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5556765916918  dE = -0.012101036  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0699  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5637960000726  dE = -0.0081194084  S^2 = 0.0000000
               |grad[o]|=0.093  |ddm|=0.0305  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5698524603912  dE = -0.0060564603  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0176  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5744957561056  dE = -0.0046432957  S^2 = 0.0000000
               |grad[o]|=0.0595  |ddm|=0.0117  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5779777384788  dE = -0.0034819824  S^2 = 0.0000000
               |grad[o]|=0.0458  |ddm|=0.00834  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5804224270872  dE = -0.0024446886  S^2 = 0.0000000
               |grad[o]|=0.0334  |ddm|=0.00629  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5819071701025  dE = -0.001484743  S^2 = 0.0000000
               |grad[o]|=0.0219  |ddm|=0.00549  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5824311440381  dE = -0.00052397394  S^2 = 0.0000000
               |grad[o]|=0.0112  |ddm|=0.00592  |maxRot[o]|= 0.06
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5825178887642  dE = -8.6744726e-05  S^2 = 0.0000000
               |grad[o]|=0.00395  |ddm|=0.00527  |maxRot[o]|=0.0339
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5825189141503  dE = -1.0253861e-06  S^2 = 0.0000000
               |grad[o]|=0.000571  |ddm|=0.00341  |maxRot[o]|=0.00308
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5825189358437  dE = -2.1693396e-08  S^2 = 0.0000000
               |grad[o]|=8.42e-05  |ddm|=0.000435  |maxRot[o]|=0.000366
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5825189364267  dE = -5.8294347e-10  S^2 = 0.0000000
               |grad[o]|=1.62e-05  |ddm|=6.21e-05  |maxRot[o]|=6.09e-05
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5825189364378  dE = -1.1098678e-11  S^2 = 0.0000000
               |grad[o]|=3.07e-06  |ddm|=1.02e-05  |maxRot[o]|=7.04e-06
2-step CASSCF converged in 14 macro (70 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97658607 1.6951559  1.82129723 1.8212978  0.30935554 0.17765846
 0.17765884 0.02099016]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00641   0.00352   0.00000   0.00000  -0.00088
  0 C 2s       0.62079   0.58190   0.00000  -0.00000  -0.33633
  0 C 3s      -0.03214   0.00906   0.00000  -0.00000   0.01238
  0 C 2px     -0.00000   0.00000  -0.00000   0.70653   0.00000
  0 C 2py      0.00000  -0.00000   0.70653   0.00000  -0.00000
  0 C 2pz      0.33407  -0.40161   0.00000   0.00000   0.61999
  0 C 3px     -0.00000  -0.00000  -0.00000   0.01517  -0.00000
  0 C 3py      0.00000  -0.00000   0.01517   0.00000  -0.00000
  0 C 3pz     -0.03258  -0.00225   0.00000   0.00000  -0.04249
  0 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02420   0.00000  -0.00000
  0 C 3dz^2    0.02955  -0.00209   0.00000  -0.00000   0.02326
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.02420  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00641  -0.00352   0.00000   0.00000  -0.00088
  1 C 2s       0.62079  -0.58190  -0.00000  -0.00000  -0.33633
  1 C 3s      -0.03214  -0.00906  -0.00000   0.00000   0.01238
  1 C 2px      0.00000   0.00000   0.00000   0.70653   0.00000
  1 C 2py     -0.00000   0.00000   0.70653   0.00000  -0.00000
  1 C 2pz     -0.33407  -0.40161   0.00000  -0.00000  -0.61999
  1 C 3px      0.00000  -0.00000   0.00000   0.01517  -0.00000
  1 C 3py     -0.00000   0.00000   0.01517  -0.00000   0.00000
  1 C 3pz      0.03258  -0.00225   0.00000  -0.00000   0.04249
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02420   0.00000  -0.00000
  1 C 3dz^2    0.02955   0.00209  -0.00000   0.00000   0.02326
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02420   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000   0.00000   0.40101
  0 C 3s      -0.00000  -0.00000  -0.04346
  0 C 2px      0.70657  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70657   0.00000
  0 C 2pz     -0.00000   0.00000   0.58004
  0 C 3px     -0.01641  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01641  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02037
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02228  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02106
  0 C 3dxz    -0.02228  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s       0.00000   0.00000  -0.40101
  1 C 3s       0.00000  -0.00000   0.04346
  1 C 2px     -0.70657   0.00000   0.00000
  1 C 2py      0.00000  -0.70657   0.00000
  1 C 2pz     -0.00000   0.00000   0.58004
  1 C 3px      0.01641   0.00000   0.00000
  1 C 3py      0.00000   0.01641  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02037
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02228   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02106
  1 C 3dxz    -0.02228  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99198874
<CAS-nat-orb|mo-hf>  4  4    0.99770782
<CAS-nat-orb|mo-hf>  5  5    0.99952508
<CAS-nat-orb|mo-hf>  6  6    0.99952508
<CAS-nat-orb|mo-hf>  7  7    0.97453486
<CAS-nat-orb|mo-hf>  8  8    0.96668730
<CAS-nat-orb|mo-hf>  9  9    0.96668737
<CAS-nat-orb|mo-hf>  10  10    0.67408712
<CAS-nat-orb|mo-hf>  10  17    0.65475251
CASSCF energy = -75.5825189364378
CASCI E = -75.5825189364378  E(CI) = -16.5777815499749  S^2 = 0.0000000
......production of RDMs took       2.18 sec
......reading the RDM took          0.46 sec
......production of RDMs took      39.37 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.34 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000249681
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000065950
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001212420
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000124773
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000775955
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001607836
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000535945
HMAT symm error =    0.0081900693
E(MRCI) - E(ref) = -0.1066878728368295 DC = -0.004757818806721416
E(WickICMRCISD)   = -75.68920680927461  E_corr_ci = -0.1066878728368295
E(WickICMRCISD+Q) = -75.69396462808133  E_corr_ci = -0.1114456916435509
Time cost =   2895.367
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 08:20:05 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.508155051122 AA    0.000000000000   0.000000000000   2.850000000000 Bohr   0.0

nuclear repulsion = 12.6315789473684
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.425]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    975336.03


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmptxwliv_t
max_memory 4000 MB (current use 8396 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0836082427711

WARN: Singularity detected in overlap matrix (condition number =  275). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.178310042866845  LUMO (Ag) = -0.161961845746925
cycle= 1 E= -75.3070977055452  delta_E= -0.223  |g|= 0.234  |ddm|= 1.43
HOMO (B3u) = -0.440057963112902  LUMO (Ag) = -0.151084704136088
cycle= 2 E= -75.3276882495978  delta_E= -0.0206  |g|= 0.0513  |ddm|= 0.304
HOMO (B3u) = -0.402148496278863  LUMO (Ag) = -0.103839161942739
cycle= 3 E= -75.3286840635262  delta_E= -0.000996  |g|= 0.0121  |ddm|= 0.0544
HOMO (B2u) = -0.403404739232162  LUMO (Ag) = -0.100645294675413
cycle= 4 E= -75.3287765426504  delta_E= -9.25e-05  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.404190054526261  LUMO (Ag) = -0.101202470957948
cycle= 5 E= -75.3287803215959  delta_E= -3.78e-06  |g|= 0.000318  |ddm|= 0.00364
HOMO (B3u) = -0.404117903551407  LUMO (Ag) = -0.101124705066543
cycle= 6 E= -75.3287803833538  delta_E= -6.18e-08  |g|= 4.04e-05  |ddm|= 0.000637
HOMO (B3u) = -0.404109925173551  LUMO (Ag) = -0.101111910622266
cycle= 7 E= -75.3287803844586  delta_E= -1.1e-09  |g|= 5.18e-06  |ddm|= 0.000169
HOMO (B3u) = -0.404109663968695  LUMO (Ag) = -0.101110942652327
cycle= 8 E= -75.3287803844733  delta_E= -1.47e-11  |g|= 4.83e-07  |ddm|= 2.4e-05
HOMO (B2u) = -0.404109632109872  LUMO (Ag) = -0.101110794247811
cycle= 9 E= -75.3287803844733  delta_E= -8.53e-14  |g|= 2.07e-08  |ddm|= 1.8e-06
HOMO (B2u) = -0.404109625552919  LUMO (Ag) = -0.101110800522632
cycle= 10 E= -75.3287803844734  delta_E= -1.42e-14  |g|= 3.06e-09  |ddm|= 7.31e-08
HOMO (B3u) = -0.404109626471973  LUMO (Ag) = -0.101110801398539
cycle= 11 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 2.51e-09  |ddm|= 3.11e-09
HOMO (B2u) = -0.40410962620161  LUMO (Ag) = -0.101110801058642
cycle= 12 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 1.79e-09  |ddm|= 2.71e-09
HOMO (B2u) = -0.404109626163899  LUMO (Ag) = -0.101110800945883
cycle= 13 E= -75.3287803844733  delta_E= 4.26e-14  |g|= 1.48e-09  |ddm|= 1.6e-09
HOMO (B2u) = -0.404109626115955  LUMO (Ag) = -0.101110800888834
cycle= 14 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 1.23e-09  |ddm|= 9.94e-10
HOMO (B3u) = -0.404109626089659  LUMO (Ag) = -0.101110800862323
cycle= 15 E= -75.3287803844734  delta_E= -9.95e-14  |g|= 1.04e-09  |ddm|= 6.13e-10
HOMO (B3u) = -0.404109626087946  LUMO (Ag) = -0.101110800890432
cycle= 16 E= -75.3287803844733  delta_E= 1.42e-14  |g|= 9.42e-10  |ddm|= 1.1e-09
HOMO (B2u) = -0.404109626047447  LUMO (Ag) = -0.101110800856137
cycle= 17 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 8.95e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.404109625906414  LUMO (Ag) = -0.101110800709268
cycle= 18 E= -75.3287803844733  delta_E= -1.42e-14  |g|= 3.85e-10  |ddm|= 1.99e-09
HOMO (B2u) = -0.404109625907907  LUMO (Ag) = -0.101110800703469
cycle= 19 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 3.15e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.404109625926457  LUMO (Ag) = -0.101110800715659
cycle= 20 E= -75.3287803844733  delta_E= 5.68e-14  |g|= 2.49e-10  |ddm|= 2.16e-10
HOMO (B2u) = -0.404109625937743  LUMO (Ag) = -0.10111080072237
cycle= 21 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 2.04e-10  |ddm|= 1.59e-10
HOMO (B2u) = -0.404109625945472  LUMO (Ag) = -0.10111080072845
cycle= 22 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 1.66e-10  |ddm|= 1.23e-10
HOMO (B2u) = -0.404109625951205  LUMO (Ag) = -0.101110800733347
cycle= 23 E= -75.3287803844733  delta_E= 8.53e-14  |g|= 1.34e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.40410962595661  LUMO (Ag) = -0.101110800738328
cycle= 24 E= -75.3287803844733  delta_E= 1.42e-14  |g|= 1.09e-10  |ddm|= 9.77e-11
HOMO (B2u) = -0.404109625961328  LUMO (Ag) = -0.101110800741471
cycle= 25 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 8.4e-11  |ddm|= 7.43e-11
HOMO (B2u) = -0.404109625964662  LUMO (Ag) = -0.101110800743054
cycle= 26 E= -75.3287803844733  delta_E= 5.68e-14  |g|= 5.93e-11  |ddm|= 7.02e-11
HOMO (B2u) = -0.404109625963267  LUMO (Ag) = -0.101110800740642
cycle= 27 E= -75.3287803844731  delta_E= 1.99e-13  |g|= 4.85e-11  |ddm|= 2.48e-11
HOMO (B2u) = -0.404109625961681  LUMO (Ag) = -0.1011108007383
cycle= 28 E= -75.328780384473  delta_E= 1.14e-13  |g|= 3.94e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.404109625960587  LUMO (Ag) = -0.101110800736693
cycle= 29 E= -75.328780384473  delta_E= -2.84e-14  |g|= 3.23e-11  |ddm|= 1.38e-11
HOMO (B2u) = -0.404109625959766  LUMO (Ag) = -0.101110800735532
cycle= 30 E= -75.3287803844728  delta_E= 1.99e-13  |g|= 2.65e-11  |ddm|= 1.04e-11
HOMO (B3u) = -0.404109625959196  LUMO (Ag) = -0.101110800734673
cycle= 31 E= -75.3287803844727  delta_E= 1.42e-13  |g|= 2.18e-11  |ddm|= 8.51e-12
HOMO (B3u) = -0.404109625958816  LUMO (Ag) = -0.101110800734019
cycle= 32 E= -75.3287803844725  delta_E= 1.99e-13  |g|= 1.82e-11  |ddm|= 7.05e-12
HOMO (B2u) = -0.404109625958585  LUMO (Ag) = -0.101110800733492
cycle= 33 E= -75.328780384472  delta_E= 4.83e-13  |g|= 1.57e-11  |ddm|= 6.12e-12
HOMO (B2u) = -0.404109625958484  LUMO (Ag) = -0.101110800733118
cycle= 34 E= -75.3287803844714  delta_E= 6.11e-13  |g|= 1.44e-11  |ddm|= 5.17e-12
HOMO (B2u) = -0.404109625958463  LUMO (Ag) = -0.101110800732882
cycle= 35 E= -75.3287803844704  delta_E= 9.52e-13  |g|= 1.4e-11  |ddm|= 4.01e-12
HOMO (B3u) = -0.404109625958369  LUMO (Ag) = -0.101110800732626
cycle= 36 E= -75.3287803844699  delta_E= 5.83e-13  |g|= 1.3e-11  |ddm|= 4.01e-12
HOMO (B3u) = -0.404109625958226  LUMO (Ag) = -0.101110800732359
cycle= 37 E= -75.3287803844689  delta_E= 9.81e-13  |g|= 1.35e-11  |ddm|= 3.39e-12
HOMO (B2u) = -0.404109625958022  LUMO (Ag) = -0.101110800732064
cycle= 38 E= -75.328780384468  delta_E= 9.09e-13  |g|= 1.45e-11  |ddm|= 3.47e-12
HOMO (B3u) = -0.404109625957776  LUMO (Ag) = -0.10111080073175
cycle= 39 E= -75.3287803844671  delta_E= 8.38e-13  |g|= 1.45e-11  |ddm|= 3.24e-12
HOMO (B3u) = -0.404109625957494  LUMO (Ag) = -0.101110800731409
cycle= 40 E= -75.3287803844665  delta_E= 6.25e-13  |g|= 1.32e-11  |ddm|= 4.11e-12
HOMO (B2u) = -0.404109625957187  LUMO (Ag) = -0.101110800731073
cycle= 41 E= -75.3287803844657  delta_E= 8.38e-13  |g|= 1.22e-11  |ddm|= 3.99e-12
HOMO (B3u) = -0.404109625956862  LUMO (Ag) = -0.101110800730761
cycle= 42 E= -75.3287803844654  delta_E= 2.7e-13  |g|= 1.06e-11  |ddm|= 4.78e-12
HOMO (B2u) = -0.404109625956553  LUMO (Ag) = -0.10111080073047
cycle= 43 E= -75.3287803844648  delta_E= 5.83e-13  |g|= 1.01e-11  |ddm|= 3.92e-12
HOMO (B2u) = -0.404109625956273  LUMO (Ag) = -0.101110800730224
cycle= 44 E= -75.328780384464  delta_E= 8.53e-13  |g|= 9.92e-12  |ddm|= 2.94e-12
HOMO (B3u) = -0.404109625955977  LUMO (Ag) = -0.101110800729979
cycle= 45 E= -75.3287803844631  delta_E= 8.53e-13  |g|= 9.56e-12  |ddm|= 3.5e-12
HOMO (B3u) = -0.404109625955691  LUMO (Ag) = -0.101110800729737
cycle= 46 E= -75.328780384462  delta_E= 1.11e-12  |g|= 1.07e-11  |ddm|= 2.49e-12
HOMO (B3u) = -0.404109625955388  LUMO (Ag) = -0.101110800729487
cycle= 47 E= -75.3287803844609  delta_E= 1.12e-12  |g|= 1.42e-11  |ddm|= 2.56e-12
HOMO (B3u) = -0.404109625955074  LUMO (Ag) = -0.101110800729241
cycle= 48 E= -75.3287803844608  delta_E= 1.14e-13  |g|= 1.29e-11  |ddm|= 7.09e-12
HOMO (B3u) = -0.404109625954789  LUMO (Ag) = -0.101110800729002
cycle= 49 E= -75.3287803844608  delta_E= -7.11e-14  |g|= 1.15e-11  |ddm|= 9.05e-12
HOMO (B3u) = -0.404109625954533  LUMO (Ag) = -0.101110800728771
cycle= 50 E= -75.3287803844607  delta_E= 9.95e-14  |g|= 9.75e-12  |ddm|= 1.12e-11
SCF not converged.
SCF energy = -75.3287803844607

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmptxwliv_t
max_memory 4000 MB (current use 8396 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5139143945445  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5362176871123  dE = -0.022303293  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5483287995499  dE = -0.012111112  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0694  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5564826513852  dE = -0.0081538518  S^2 = 0.0000000
               |grad[o]|=0.0932  |ddm|=0.0313  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5625224414893  dE = -0.0060397901  S^2 = 0.0000000
               |grad[o]|=0.0747  |ddm|=0.0183  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5670860264653  dE = -0.004563585  S^2 = 0.0000000
               |grad[o]|=0.0588  |ddm|=0.0122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5704303794428  dE = -0.003344353  S^2 = 0.0000000
               |grad[o]|=0.0446  |ddm|=0.00858  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5726884494353  dE = -0.00225807  S^2 = 0.0000000
               |grad[o]|=0.0317  |ddm|=0.00647  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5739474748015  dE = -0.0012590254  S^2 = 0.0000000
               |grad[o]|=0.0197  |ddm|=0.0059  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5742840766656  dE = -0.00033660186  S^2 = 0.0000000
               |grad[o]|=0.00856  |ddm|=0.00674  |maxRot[o]|= 0.06
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5742936839157  dE = -9.60725e-06  S^2 = 0.0000000
               |grad[o]|=0.00138  |ddm|=0.00616  |maxRot[o]|=0.0106
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5742938471709  dE = -1.6325528e-07  S^2 = 0.0000000
               |grad[o]|=0.00023  |ddm|=0.00135  |maxRot[o]|=0.00105
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5742938504149  dE = -3.243926e-09  S^2 = 0.0000000
               |grad[o]|=3.41e-05  |ddm|=0.000171  |maxRot[o]|=0.000144
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5742938505331  dE = -1.1819168e-10  S^2 = 0.0000000
               |grad[o]|=8.36e-06  |ddm|=2.43e-05  |maxRot[o]|=2.84e-05
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5742938505364  dE = -3.3111291e-12  S^2 = 0.0000000
               |grad[o]|=2.14e-06  |ddm|=3.81e-06  |maxRot[o]|=2.39e-06
2-step CASSCF converged in 14 macro (69 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97574977 1.70399347 1.81154678 1.8115465  0.3030469  0.18612083
 0.18612067 0.02187507]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00665   0.00360   0.00000   0.00000  -0.00085
  0 C 2s       0.62384   0.58827  -0.00000   0.00000  -0.33076
  0 C 3s      -0.03017   0.00916   0.00000   0.00000   0.01475
  0 C 2px      0.00000  -0.00000  -0.00000   0.70651  -0.00000
  0 C 2py      0.00000  -0.00000   0.70651  -0.00000   0.00000
  0 C 2pz      0.32876  -0.39221   0.00000  -0.00000   0.62289
  0 C 3px      0.00000  -0.00000   0.00000   0.01725  -0.00000
  0 C 3py      0.00000  -0.00000   0.01725   0.00000   0.00000
  0 C 3pz     -0.03092  -0.00212   0.00000   0.00000  -0.04192
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02335   0.00000   0.00000
  0 C 3dz^2    0.02875  -0.00240   0.00000   0.00000   0.02515
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02335  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00665  -0.00360   0.00000   0.00000  -0.00085
  1 C 2s       0.62384  -0.58827  -0.00000  -0.00000  -0.33076
  1 C 3s      -0.03017  -0.00916  -0.00000  -0.00000   0.01475
  1 C 2px     -0.00000   0.00000  -0.00000   0.70651   0.00000
  1 C 2py     -0.00000   0.00000   0.70651  -0.00000  -0.00000
  1 C 2pz     -0.32876  -0.39221  -0.00000   0.00000  -0.62289
  1 C 3px     -0.00000   0.00000   0.00000   0.01725   0.00000
  1 C 3py     -0.00000   0.00000   0.01725   0.00000  -0.00000
  1 C 3pz      0.03092  -0.00212   0.00000   0.00000   0.04192
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02335  -0.00000   0.00000
  1 C 3dz^2    0.02875   0.00240  -0.00000  -0.00000   0.02515
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02335  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00033
  0 C 2s       0.00000  -0.00000   0.39163
  0 C 3s       0.00000   0.00000  -0.04339
  0 C 2px      0.70659   0.00000   0.00000
  0 C 2py      0.00000   0.70659   0.00000
  0 C 2pz      0.00000   0.00000   0.58640
  0 C 3px     -0.01557   0.00000   0.00000
  0 C 3py      0.00000  -0.01557   0.00000
  0 C 3pz      0.00000  -0.00000   0.02090
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02201   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02090
  0 C 3dxz    -0.02201   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00033
  1 C 2s       0.00000   0.00000  -0.39163
  1 C 3s      -0.00000  -0.00000   0.04339
  1 C 2px     -0.70659  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70659  -0.00000
  1 C 2pz      0.00000   0.00000   0.58640
  1 C 3px      0.01557  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01557  -0.00000
  1 C 3pz      0.00000   0.00000   0.02090
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02201   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02090
  1 C 3dxz    -0.02201   0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99173401
<CAS-nat-orb|mo-hf>  4  4    0.99760699
<CAS-nat-orb|mo-hf>  5  5    0.99948360
<CAS-nat-orb|mo-hf>  6  6    0.99948360
<CAS-nat-orb|mo-hf>  7  7    0.97418543
<CAS-nat-orb|mo-hf>  8  8    0.96886030
<CAS-nat-orb|mo-hf>  9  9    0.96886030
<CAS-nat-orb|mo-hf>  10  10    0.69921223
<CAS-nat-orb|mo-hf>  10  15   -0.63804367
CASSCF energy = -75.5742938505364
CASCI E = -75.5742938505364  E(CI) = -16.4693217807175  S^2 = 0.0000000
......production of RDMs took       4.11 sec
......reading the RDM took          0.49 sec
......production of RDMs took     405.82 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.27 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000217087
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000057340
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001043537
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000106805
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000668470
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001392335
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000464112
HMAT symm error =    0.0071148493
E(MRCI) - E(ref) = -0.1070670070591859 DC = -0.004824954130786586
E(WickICMRCISD)   = -75.68136085759555  E_corr_ci = -0.1070670070591859
E(WickICMRCISD+Q) = -75.68618581172633  E_corr_ci = -0.1118919611899725
Time cost =   3268.445
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 09:14:33 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.534613911668 AA    0.000000000000   0.000000000000   2.900000000000 Bohr   0.0

nuclear repulsion = 12.4137931034483
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.45]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1022352.32


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpzrk5gqv0
max_memory 4000 MB (current use 8398 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0502696488693

WARN: Singularity detected in overlap matrix (condition number =  255). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.171982441441623  LUMO (Ag) = -0.159994465911487
cycle= 1 E= -75.2972707224471  delta_E= -0.247  |g|= 0.236  |ddm|= 1.43
HOMO (B3u) = -0.435771051837407  LUMO (Ag) = -0.150538347855666
cycle= 2 E= -75.3184487790456  delta_E= -0.0212  |g|= 0.051  |ddm|= 0.31
HOMO (B2u) = -0.39780086513172  LUMO (Ag) = -0.102495692949927
cycle= 3 E= -75.3194573772646  delta_E= -0.00101  |g|= 0.0124  |ddm|= 0.0544
HOMO (B2u) = -0.399183030564798  LUMO (Ag) = -0.0993011615665471
cycle= 4 E= -75.3195559425281  delta_E= -9.86e-05  |g|= 0.00229  |ddm|= 0.0157
HOMO (B2u) = -0.399959753294004  LUMO (Ag) = -0.0998732578136651
cycle= 5 E= -75.3195598190019  delta_E= -3.88e-06  |g|= 0.000323  |ddm|= 0.00343
HOMO (B3u) = -0.399888567456491  LUMO (Ag) = -0.0998019916939259
cycle= 6 E= -75.3195598822274  delta_E= -6.32e-08  |g|= 4.09e-05  |ddm|= 0.000646
HOMO (B2u) = -0.399880517827686  LUMO (Ag) = -0.0997890778931016
cycle= 7 E= -75.3195598833514  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000156
HOMO (B3u) = -0.399880142870899  LUMO (Ag) = -0.0997880477227927
cycle= 8 E= -75.319559883367  delta_E= -1.55e-11  |g|= 5.02e-07  |ddm|= 2.32e-05
HOMO (B3u) = -0.399880110369041  LUMO (Ag) = -0.0997878828350397
cycle= 9 E= -75.319559883367  delta_E= 2.84e-14  |g|= 2.12e-08  |ddm|= 1.59e-06
HOMO (B3u) = -0.399880103488951  LUMO (Ag) = -0.0997878912045869
cycle= 10 E= -75.319559883367  delta_E= -2.84e-14  |g|= 3.19e-09  |ddm|= 7.71e-08
HOMO (B3u) = -0.399880104492774  LUMO (Ag) = -0.0997878921946702
cycle= 11 E= -75.319559883367  delta_E= -5.68e-14  |g|= 2.57e-09  |ddm|= 3.68e-09
HOMO (B3u) = -0.39988010419905  LUMO (Ag) = -0.0997878918212044
cycle= 12 E= -75.319559883367  delta_E= 2.84e-14  |g|= 1.87e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.399880104169367  LUMO (Ag) = -0.0997878916909738
cycle= 13 E= -75.319559883367  delta_E= -2.84e-14  |g|= 1.58e-09  |ddm|= 1.61e-09
HOMO (B2u) = -0.399880104126802  LUMO (Ag) = -0.0997878916470373
cycle= 14 E= -75.319559883367  delta_E=    0  |g|= 1.31e-09  |ddm|= 1.09e-09
HOMO (B2u) = -0.399880104099621  LUMO (Ag) = -0.0997878916239718
cycle= 15 E= -75.319559883367  delta_E= 8.53e-14  |g|= 1.11e-09  |ddm|= 6.96e-10
HOMO (B2u) = -0.39988010408625  LUMO (Ag) = -0.0997878916343568
cycle= 16 E= -75.319559883367  delta_E= -5.68e-14  |g|= 1.01e-09  |ddm|= 9.01e-10
HOMO (B2u) = -0.399880104058022  LUMO (Ag) = -0.0997878916092053
cycle= 17 E= -75.319559883367  delta_E=    0  |g|= 9.25e-10  |ddm|= 3.41e-10
HOMO (B2u) = -0.399880103906985  LUMO (Ag) = -0.0997878914693907
cycle= 18 E= -75.319559883367  delta_E= 5.68e-14  |g|= 4.03e-10  |ddm|= 2.15e-09
HOMO (B2u) = -0.399880103908048  LUMO (Ag) = -0.0997878914633991
cycle= 19 E= -75.3195598833671  delta_E= -1.42e-13  |g|= 3.3e-10  |ddm|= 3.17e-10
HOMO (B2u) = -0.399880103926961  LUMO (Ag) = -0.0997878914762784
cycle= 20 E= -75.3195598833671  delta_E=    0  |g|= 2.64e-10  |ddm|= 2.23e-10
HOMO (B2u) = -0.399880103938454  LUMO (Ag) = -0.0997878914831057
cycle= 21 E= -75.319559883367  delta_E= 1.14e-13  |g|= 2.17e-10  |ddm|= 1.65e-10
HOMO (B2u) = -0.399880103945878  LUMO (Ag) = -0.0997878914896904
cycle= 22 E= -75.319559883367  delta_E= -5.68e-14  |g|= 1.76e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.399880103951602  LUMO (Ag) = -0.0997878914950272
cycle= 23 E= -75.319559883367  delta_E=    0  |g|= 1.42e-10  |ddm|= 1.08e-10
HOMO (B2u) = -0.399880103957418  LUMO (Ag) = -0.0997878915008465
cycle= 24 E= -75.319559883367  delta_E=    0  |g|= 1.14e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.399880103962209  LUMO (Ag) = -0.0997878915047865
cycle= 25 E= -75.319559883367  delta_E=    0  |g|= 8.77e-11  |ddm|= 8.45e-11
HOMO (B2u) = -0.399880103960217  LUMO (Ag) = -0.0997878915001716
Extra cycle  E= -75.319559883367  delta_E= 2.84e-14  |g|= 2.66e-11  |ddm|= 1.54e-10
converged SCF energy = -75.319559883367

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpzrk5gqv0
max_memory 4000 MB (current use 8398 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5069071999532  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5287793153018  dE = -0.021872115  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.72  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5408869080838  dE = -0.012107593  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0689  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5490568342392  dE = -0.0081699262  S^2 = 0.0000000
               |grad[o]|=0.0931  |ddm|=0.0319  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.555056484944  dE = -0.0059996507  S^2 = 0.0000000
               |grad[o]|=0.0741  |ddm|=0.019  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.559510542073  dE = -0.0044540571  S^2 = 0.0000000
               |grad[o]|=0.0578  |ddm|=0.0126  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5626826699552  dE = -0.0031721279  S^2 = 0.0000000
               |grad[o]|=0.043  |ddm|=0.00883  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5647157869698  dE = -0.002033117  S^2 = 0.0000000
               |grad[o]|=0.0294  |ddm|=0.00676  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5657086776976  dE = -0.00099289073  S^2 = 0.0000000
               |grad[o]|=0.0169  |ddm|=0.00658  |maxRot[o]|=0.0799
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5658453333753  dE = -0.00013665568  S^2 = 0.0000000
               |grad[o]|=0.00539  |ddm|=0.00792  |maxRot[o]|= 0.04
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5658470538151  dE = -1.7204398e-06  S^2 = 0.0000000
               |grad[o]|=0.000741  |ddm|=0.00487  |maxRot[o]|=0.00387
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5658470908335  dE = -3.7018424e-08  S^2 = 0.0000000
               |grad[o]|=0.000113  |ddm|=0.000648  |maxRot[o]|=0.000437
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5658470916848  dE = -8.5127283e-10  S^2 = 0.0000000
               |grad[o]|=1.99e-05  |ddm|=8.17e-05  |maxRot[o]|=7.15e-05
macro iter 13 (3 JK  0 micro), CASSCF E = -75.565847091701  dE = -1.628564e-11  S^2 = 0.0000000
               |grad[o]|=3.76e-06  |ddm|=1.29e-05  |maxRot[o]|=7.42e-06
2-step CASSCF converged in 13 macro (65 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97493414 1.71266258 1.80127908 1.80128092 0.29742462 0.19483025
 0.19483045 0.02275796]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00688   0.00368   0.00000   0.00000  -0.00082
  0 C 2s       0.62688   0.59446  -0.00000  -0.00000  -0.32511
  0 C 3s      -0.02821   0.00928  -0.00000  -0.00000   0.01701
  0 C 2px      0.00000  -0.00000  -0.00000   0.70649   0.00000
  0 C 2py     -0.00000  -0.00000   0.70649  -0.00000   0.00000
  0 C 2pz      0.32333  -0.38275   0.00000  -0.00000   0.62576
  0 C 3px      0.00000  -0.00000   0.00000   0.01921   0.00000
  0 C 3py     -0.00000   0.00000   0.01921   0.00000  -0.00000
  0 C 3pz     -0.02927  -0.00203  -0.00000  -0.00000  -0.04115
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02251   0.00000  -0.00000
  0 C 3dz^2    0.02800  -0.00269  -0.00000  -0.00000   0.02714
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02251   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00688  -0.00368   0.00000   0.00000  -0.00082
  1 C 2s       0.62688  -0.59446   0.00000   0.00000  -0.32511
  1 C 3s      -0.02821  -0.00928   0.00000   0.00000   0.01701
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70649  -0.00000
  1 C 2py      0.00000  -0.00000   0.70649  -0.00000   0.00000
  1 C 2pz     -0.32333  -0.38275  -0.00000  -0.00000  -0.62576
  1 C 3px     -0.00000   0.00000   0.00000   0.01921  -0.00000
  1 C 3py      0.00000  -0.00000   0.01921   0.00000  -0.00000
  1 C 3pz      0.02927  -0.00203  -0.00000  -0.00000   0.04115
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02251  -0.00000  -0.00000
  1 C 3dz^2    0.02800   0.00269  -0.00000   0.00000   0.02714
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02251   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.38221
  0 C 3s      -0.00000  -0.00000  -0.04321
  0 C 2px      0.70662  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70662  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.59260
  0 C 3px     -0.01471  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01471  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02126
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02171  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02074
  0 C 3dxz    -0.02171  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.38221
  1 C 3s       0.00000   0.00000   0.04321
  1 C 2px     -0.70662   0.00000   0.00000
  1 C 2py      0.00000  -0.70662   0.00000
  1 C 2pz     -0.00000  -0.00000   0.59260
  1 C 3px      0.01471   0.00000   0.00000
  1 C 3py      0.00000   0.01471   0.00000
  1 C 3pz     -0.00000  -0.00000   0.02126
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02171  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02074
  1 C 3dxz    -0.02171  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99150087
<CAS-nat-orb|mo-hf>  4  4    0.99751311
<CAS-nat-orb|mo-hf>  5  5    0.99943968
<CAS-nat-orb|mo-hf>  6  6    0.99943968
<CAS-nat-orb|mo-hf>  7  7    0.97389117
<CAS-nat-orb|mo-hf>  8  8    0.97085574
<CAS-nat-orb|mo-hf>  9  9    0.97085579
<CAS-nat-orb|mo-hf>  10  10    0.72379453
<CAS-nat-orb|mo-hf>  10  14   -0.61908434
CASSCF energy = -75.565847091701
CASCI E = -75.565847091701  E(CI) = -16.3640995435818  S^2 = 0.0000000
......production of RDMs took       2.93 sec
......reading the RDM took          0.50 sec
......production of RDMs took      86.16 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.66 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000076481
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000020201
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000377163
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000040726
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000240018
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0000512780
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000170927
HMAT symm error =    0.0036692002
E(MRCI) - E(ref) = -0.1074722415431779 DC = -0.004895717475535237
E(WickICMRCISD)   = -75.67331933324422  E_corr_ci = -0.1074722415431779
E(WickICMRCISD+Q) = -75.67821505071976  E_corr_ci = -0.1123679590187132
Time cost =   3485.951
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 10:12:39 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.561072772214 AA    0.000000000000   0.000000000000   2.950000000000 Bohr   0.0

nuclear repulsion = 12.2033898305085
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.475]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1075953.84


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpdy1uxz3u
max_memory 4000 MB (current use 8396 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0186954217206

WARN: Singularity detected in overlap matrix (condition number =  236). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.165974687131634  LUMO (Ag) = -0.158079543422892
cycle= 1 E= -75.2873378760354  delta_E= -0.269  |g|= 0.239  |ddm|= 1.43
HOMO (B3u) = -0.431571893819984  LUMO (Ag) = -0.149790781563185
cycle= 2 E= -75.3090731833374  delta_E= -0.0217  |g|= 0.0507  |ddm|= 0.316
HOMO (B3u) = -0.393547996937856  LUMO (Ag) = -0.100989331184846
cycle= 3 E= -75.3100918952135  delta_E= -0.00102  |g|= 0.0127  |ddm|= 0.0544
HOMO (B3u) = -0.395075054129109  LUMO (Ag) = -0.0978528282721949
cycle= 4 E= -75.3101958879618  delta_E= -0.000104  |g|= 0.00229  |ddm|= 0.0157
HOMO (B3u) = -0.395838291352905  LUMO (Ag) = -0.0984379062399637
cycle= 5 E= -75.3101998099164  delta_E= -3.92e-06  |g|= 0.000326  |ddm|= 0.00328
HOMO (B3u) = -0.395768945444499  LUMO (Ag) = -0.0983739814936185
cycle= 6 E= -75.3101998734464  delta_E= -6.35e-08  |g|= 4.1e-05  |ddm|= 0.000649
HOMO (B3u) = -0.395760954503403  LUMO (Ag) = -0.0983611341563445
cycle= 7 E= -75.3101998745661  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000143
HOMO (B3u) = -0.395760469633685  LUMO (Ag) = -0.0983600611975554
cycle= 8 E= -75.310199874582  delta_E= -1.59e-11  |g|= 5.2e-07  |ddm|= 2.23e-05
HOMO (B3u) = -0.395760436404823  LUMO (Ag) = -0.0983598792412559
cycle= 9 E= -75.3101998745822  delta_E= -1.42e-13  |g|= 2.17e-08  |ddm|= 1.39e-06
HOMO (B3u) = -0.395760429248383  LUMO (Ag) = -0.0983598897706397
cycle= 10 E= -75.3101998745821  delta_E= 5.68e-14  |g|= 3.33e-09  |ddm|= 8.05e-08
HOMO (B3u) = -0.395760430313182  LUMO (Ag) = -0.0983598908473278
cycle= 11 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 2.6e-09  |ddm|= 4.16e-09
HOMO (B3u) = -0.395760430019763  LUMO (Ag) = -0.0983598904704316
cycle= 12 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 1.93e-09  |ddm|= 2.62e-09
HOMO (B3u) = -0.395760430010127  LUMO (Ag) = -0.0983598903379396
cycle= 13 E= -75.3101998745821  delta_E= 9.95e-14  |g|= 1.67e-09  |ddm|= 1.74e-09
HOMO (B3u) = -0.395760429956846  LUMO (Ag) = -0.0983598902854213
cycle= 14 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 1.39e-09  |ddm|= 9.68e-10
HOMO (B3u) = -0.395760429928458  LUMO (Ag) = -0.0983598902665723
cycle= 15 E= -75.3101998745823  delta_E= -5.68e-14  |g|= 1.19e-09  |ddm|= 8e-10
HOMO (B3u) = -0.395760429913514  LUMO (Ag) = -0.0983598902681461
cycle= 16 E= -75.3101998745821  delta_E= 1.71e-13  |g|= 1.06e-09  |ddm|= 8.03e-10
HOMO (B3u) = -0.395760429892041  LUMO (Ag) = -0.0983598902484902
cycle= 17 E= -75.3101998745822  delta_E= -1.56e-13  |g|= 9.59e-10  |ddm|= 4.23e-10
HOMO (B3u) = -0.395760429734567  LUMO (Ag) = -0.0983598901198581
cycle= 18 E= -75.3101998745822  delta_E= 4.26e-14  |g|= 4.21e-10  |ddm|= 2.31e-09
HOMO (B3u) = -0.395760429735099  LUMO (Ag) = -0.098359890113631
cycle= 19 E= -75.3101998745822  delta_E= -1.42e-14  |g|= 3.45e-10  |ddm|= 3.34e-10
HOMO (B3u) = -0.395760429753827  LUMO (Ag) = -0.0983598901268101
cycle= 20 E= -75.3101998745822  delta_E=    0  |g|= 2.78e-10  |ddm|= 2.29e-10
HOMO (B3u) = -0.395760429765423  LUMO (Ag) = -0.0983598901336986
cycle= 21 E= -75.3101998745822  delta_E= 4.26e-14  |g|= 2.31e-10  |ddm|= 1.7e-10
HOMO (B3u) = -0.395760429772695  LUMO (Ag) = -0.0983598901408026
cycle= 22 E= -75.3101998745823  delta_E= -8.53e-14  |g|= 1.87e-10  |ddm|= 1.33e-10
HOMO (B3u) = -0.395760429778192  LUMO (Ag) = -0.0983598901464971
cycle= 23 E= -75.3101998745822  delta_E= 8.53e-14  |g|= 1.51e-10  |ddm|= 1.13e-10
HOMO (B3u) = -0.395760429784151  LUMO (Ag) = -0.0983598901529704
cycle= 24 E= -75.3101998745822  delta_E= 1.42e-14  |g|= 1.2e-10  |ddm|= 1.11e-10
HOMO (B3u) = -0.395760429789064  LUMO (Ag) = -0.0983598901578732
cycle= 25 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 9.18e-11  |ddm|= 9.33e-11
HOMO (B3u) = -0.395760429793047  LUMO (Ag) = -0.0983598901618839
cycle= 26 E= -75.3101998745822  delta_E= 1.42e-14  |g|= 6.61e-11  |ddm|= 8.5e-11
HOMO (B3u) = -0.395760429791677  LUMO (Ag) = -0.0983598901598056
cycle= 27 E= -75.3101998745821  delta_E= 9.95e-14  |g|= 5.42e-11  |ddm|= 2.88e-11
HOMO (B3u) = -0.395760429790041  LUMO (Ag) = -0.0983598901577133
cycle= 28 E= -75.3101998745821  delta_E= -4.26e-14  |g|= 4.43e-11  |ddm|= 2.17e-11
HOMO (B3u) = -0.39576042978885  LUMO (Ag) = -0.0983598901563148
cycle= 29 E= -75.3101998745819  delta_E= 2.13e-13  |g|= 3.6e-11  |ddm|= 1.7e-11
HOMO (B3u) = -0.395760429787904  LUMO (Ag) = -0.0983598901553607
cycle= 30 E= -75.3101998745817  delta_E= 1.71e-13  |g|= 2.91e-11  |ddm|= 1.33e-11
HOMO (B3u) = -0.395760429787239  LUMO (Ag) = -0.0983598901546877
cycle= 31 E= -75.3101998745813  delta_E= 4.41e-13  |g|= 2.38e-11  |ddm|= 1.01e-11
HOMO (B3u) = -0.395760429786783  LUMO (Ag) = -0.0983598901542165
cycle= 32 E= -75.3101998745808  delta_E= 5.12e-13  |g|= 2.15e-11  |ddm|= 7.38e-12
HOMO (B3u) = -0.395760429786477  LUMO (Ag) = -0.0983598901538544
cycle= 33 E= -75.3101998745806  delta_E= 1.99e-13  |g|= 1.77e-11  |ddm|= 8.41e-12
HOMO (B3u) = -0.395760429786313  LUMO (Ag) = -0.0983598901536178
cycle= 34 E= -75.3101998745803  delta_E= 2.84e-13  |g|= 1.51e-11  |ddm|= 8.42e-12
HOMO (B3u) = -0.395760429786263  LUMO (Ag) = -0.0983598901534825
cycle= 35 E= -75.31019987458  delta_E= 3.13e-13  |g|= 1.32e-11  |ddm|= 8.95e-12
HOMO (B3u) = -0.395760429786167  LUMO (Ag) = -0.0983598901533285
cycle= 36 E= -75.3101998745798  delta_E= 2.27e-13  |g|= 1.16e-11  |ddm|= 9.34e-12
HOMO (B3u) = -0.39576042978603  LUMO (Ag) = -0.0983598901531536
cycle= 37 E= -75.3101998745796  delta_E= 1.99e-13  |g|= 1e-11  |ddm|= 9.26e-12
HOMO (B3u) = -0.395760429785879  LUMO (Ag) = -0.098359890152985
cycle= 38 E= -75.3101998745795  delta_E= 2.84e-14  |g|= 8.67e-12  |ddm|= 9.51e-12
HOMO (B3u) = -0.395760429785725  LUMO (Ag) = -0.0983598901528276
cycle= 39 E= -75.3101998745796  delta_E= -1.42e-14  |g|= 7.58e-12  |ddm|= 9.01e-12
HOMO (B3u) = -0.395760429785583  LUMO (Ag) = -0.0983598901526857
cycle= 40 E= -75.3101998745794  delta_E= 1.56e-13  |g|= 6.56e-12  |ddm|= 8.43e-12
HOMO (B3u) = -0.39576042978546  LUMO (Ag) = -0.0983598901525604
cycle= 41 E= -75.3101998745792  delta_E= 2.27e-13  |g|= 5.55e-12  |ddm|= 3.88e-12
HOMO (B3u) = -0.395760429785336  LUMO (Ag) = -0.0983598901524277
cycle= 42 E= -75.3101998745788  delta_E= 3.27e-13  |g|= 4.75e-12  |ddm|= 4.28e-12
HOMO (B3u) = -0.395760429785214  LUMO (Ag) = -0.0983598901522846
cycle= 43 E= -75.3101998745785  delta_E= 3.27e-13  |g|= 4.14e-12  |ddm|= 4.27e-12
HOMO (B3u) = -0.395760429785099  LUMO (Ag) = -0.0983598901521522
cycle= 44 E= -75.3101998745781  delta_E= 4.12e-13  |g|= 3.98e-12  |ddm|= 3.64e-12
HOMO (B3u) = -0.395760429784991  LUMO (Ag) = -0.098359890152035
cycle= 45 E= -75.3101998745777  delta_E= 4.41e-13  |g|= 4.11e-12  |ddm|= 3.3e-12
HOMO (B3u) = -0.395760429784874  LUMO (Ag) = -0.0983598901519076
cycle= 46 E= -75.3101998745771  delta_E= 5.4e-13  |g|= 4.51e-12  |ddm|= 2.86e-12
HOMO (B3u) = -0.395760429784741  LUMO (Ag) = -0.0983598901517638
cycle= 47 E= -75.3101998745766  delta_E= 5.54e-13  |g|= 4.73e-12  |ddm|= 2.75e-12
HOMO (B3u) = -0.39576042978459  LUMO (Ag) = -0.0983598901516043
cycle= 48 E= -75.3101998745759  delta_E= 6.39e-13  |g|= 5.19e-12  |ddm|= 2.12e-12
HOMO (B3u) = -0.395760429784412  LUMO (Ag) = -0.0983598901514208
cycle= 49 E= -75.310199874575  delta_E= 9.09e-13  |g|= 5.87e-12  |ddm|= 2.19e-12
HOMO (B3u) = -0.395760429784211  LUMO (Ag) = -0.0983598901512229
cycle= 50 E= -75.3101998745747  delta_E= 3.41e-13  |g|= 6.31e-12  |ddm|= 3.32e-12
SCF not converged.
SCF energy = -75.3101998745747

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpdy1uxz3u
max_memory 4000 MB (current use 8396 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4998295378015  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5213159082322  dE = -0.02148637  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5334030892124  dE = -0.012087181  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0681  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.54157105102  dE = -0.0081679618  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0324  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5475076686805  dE = -0.0059366177  S^2 = 0.0000000
               |grad[o]|=0.0732  |ddm|=0.0196  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5518232626572  dE = -0.004315594  S^2 = 0.0000000
               |grad[o]|=0.0563  |ddm|=0.0131  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5547903400443  dE = -0.0029670774  S^2 = 0.0000000
               |grad[o]|=0.0409  |ddm|=0.00919  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5565623680739  dE = -0.001772028  S^2 = 0.0000000
               |grad[o]|=0.0267  |ddm|=0.00731  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5571749708359  dE = -0.00061260276  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00767  |maxRot[o]|= 0.06
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5572696084419  dE = -9.4637606e-05  S^2 = 0.0000000
               |grad[o]|=0.00458  |ddm|=0.00702  |maxRot[o]|=0.0325
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5572707210388  dE = -1.1125969e-06  S^2 = 0.0000000
               |grad[o]|=0.00063  |ddm|=0.00452  |maxRot[o]|=0.00289
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5572707457273  dE = -2.4688518e-08  S^2 = 0.0000000
               |grad[o]|=9.64e-05  |ddm|=0.000587  |maxRot[o]|=0.000339
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5572707462611  dE = -5.3378812e-10  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=7.45e-05  |maxRot[o]|=4.85e-05
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5572707462971  dE = -3.6010306e-11  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=1.24e-05  |maxRot[o]|=9.48e-06
2-step CASSCF converged in 13 macro (64 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97414465 1.72120313 1.79044307 1.79044142 0.29254486 0.20379333
 0.20379267 0.02363686]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00710   0.00377   0.00000   0.00000  -0.00079
  0 C 2s       0.62989   0.60047   0.00000   0.00000  -0.31937
  0 C 3s      -0.02627   0.00941  -0.00000   0.00000   0.01911
  0 C 2px     -0.00000   0.00000   0.00000   0.70646  -0.00000
  0 C 2py      0.00000  -0.00000   0.70646  -0.00000  -0.00000
  0 C 2pz      0.31779  -0.37325   0.00000   0.00000   0.62862
  0 C 3px     -0.00000   0.00000  -0.00000   0.02107  -0.00000
  0 C 3py      0.00000  -0.00000   0.02107  -0.00000  -0.00000
  0 C 3pz     -0.02764  -0.00196  -0.00000   0.00000  -0.04016
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02166  -0.00000  -0.00000
  0 C 3dz^2    0.02729  -0.00296  -0.00000   0.00000   0.02921
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02166  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00710  -0.00377   0.00000   0.00000  -0.00079
  1 C 2s       0.62989  -0.60047   0.00000  -0.00000  -0.31937
  1 C 3s      -0.02627  -0.00941  -0.00000  -0.00000   0.01911
  1 C 2px      0.00000   0.00000  -0.00000   0.70646   0.00000
  1 C 2py      0.00000   0.00000   0.70646   0.00000   0.00000
  1 C 2pz     -0.31779  -0.37325   0.00000   0.00000  -0.62862
  1 C 3px      0.00000  -0.00000  -0.00000   0.02107   0.00000
  1 C 3py     -0.00000   0.00000   0.02107   0.00000   0.00000
  1 C 3pz      0.02764  -0.00196   0.00000   0.00000   0.04016
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02166  -0.00000  -0.00000
  1 C 3dz^2    0.02729   0.00296  -0.00000  -0.00000   0.02921
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02166  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00027
  0 C 2s       0.00000   0.00000   0.37274
  0 C 3s       0.00000  -0.00000  -0.04290
  0 C 2px      0.70665  -0.00000   0.00000
  0 C 2py     -0.00000   0.70665   0.00000
  0 C 2pz      0.00000  -0.00000   0.59862
  0 C 3px     -0.01384   0.00000   0.00000
  0 C 3py      0.00000  -0.01384  -0.00000
  0 C 3pz      0.00000  -0.00000   0.02142
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02139  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02055
  0 C 3dxz    -0.02139   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00027
  1 C 2s      -0.00000   0.00000  -0.37274
  1 C 3s      -0.00000   0.00000   0.04290
  1 C 2px     -0.70665   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70665   0.00000
  1 C 2pz      0.00000   0.00000   0.59862
  1 C 3px      0.01384   0.00000  -0.00000
  1 C 3py      0.00000   0.01384   0.00000
  1 C 3pz      0.00000  -0.00000   0.02142
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02139  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02055
  1 C 3dxz    -0.02139  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99129319
<CAS-nat-orb|mo-hf>  4  4    0.99742899
<CAS-nat-orb|mo-hf>  5  5    0.99939340
<CAS-nat-orb|mo-hf>  6  6    0.99939339
<CAS-nat-orb|mo-hf>  7  7    0.97366305
<CAS-nat-orb|mo-hf>  8  8    0.97269188
<CAS-nat-orb|mo-hf>  9  9    0.97269178
<CAS-nat-orb|mo-hf>  10  10    0.74746757
<CAS-nat-orb|mo-hf>  10  14   -0.59840356
CASSCF energy = -75.5572707462971
CASCI E = -75.5572707462971  E(CI) = -16.2620311781179  S^2 = 0.0000000
......production of RDMs took       4.44 sec
......reading the RDM took          0.45 sec
......production of RDMs took      80.97 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.46 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000222965
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000058893
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000764675
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000080324
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000496588
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001063777
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000354592
HMAT symm error =    0.0082497501
E(MRCI) - E(ref) = -0.1079061818224858 DC = -0.004970412695092958
E(WickICMRCISD)   = -75.66517692811958  E_corr_ci = -0.1079061818224858
E(WickICMRCISD+Q) = -75.67014734081467  E_corr_ci = -0.1128765945175788
Time cost =   2942.176
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 11:01:42 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.587531632760 AA    0.000000000000   0.000000000000   3.000000000000 Bohr   0.0

nuclear repulsion = 12
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.5]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1123067.44


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmptwmil_cd
max_memory 4000 MB (current use 8398 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9888325390205

WARN: Singularity detected in overlap matrix (condition number =  219). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.160268488606779  LUMO (Ag) = -0.156209924431071
cycle= 1 E= -75.2773690146387  delta_E= -0.289  |g|= 0.241  |ddm|= 1.43
HOMO (B3u) = -0.427459076932469  LUMO (Ag) = -0.148855300078026
cycle= 2 E= -75.2996288397617  delta_E= -0.0223  |g|= 0.0503  |ddm|= 0.321
HOMO (B3u) = -0.389387614274554  LUMO (Ag) = -0.0993360736972382
cycle= 3 E= -75.3006548036907  delta_E= -0.00103  |g|= 0.013  |ddm|= 0.0545
HOMO (B2u) = -0.391075001807691  LUMO (Ag) = -0.0963133132876637
cycle= 4 E= -75.3007634017489  delta_E= -0.000109  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.391819817512154  LUMO (Ag) = -0.0969078799501825
cycle= 5 E= -75.3007673195955  delta_E= -3.92e-06  |g|= 0.000327  |ddm|= 0.00318
HOMO (B2u) = -0.391752968347539  LUMO (Ag) = -0.0968518020879507
cycle= 6 E= -75.3007673825198  delta_E= -6.29e-08  |g|= 4.07e-05  |ddm|= 0.000647
HOMO (B2u) = -0.391745163678225  LUMO (Ag) = -0.0968392001457639
cycle= 7 E= -75.3007673836115  delta_E= -1.09e-09  |g|= 5.16e-06  |ddm|= 0.00013
HOMO (B3u) = -0.391744579298911  LUMO (Ag) = -0.0968381087429976
cycle= 8 E= -75.3007673836274  delta_E= -1.6e-11  |g|= 5.37e-07  |ddm|= 2.12e-05
HOMO (B3u) = -0.39174454506944  LUMO (Ag) = -0.0968379095785099
cycle= 9 E= -75.3007673836275  delta_E= -9.95e-14  |g|= 2.23e-08  |ddm|= 1.2e-06
HOMO (B2u) = -0.391744537674295  LUMO (Ag) = -0.0968379222718529
cycle= 10 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 3.48e-09  |ddm|= 8.33e-08
HOMO (B2u) = -0.391744538795801  LUMO (Ag) = -0.0968379234294149
cycle= 11 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 2.62e-09  |ddm|= 4.63e-09
HOMO (B2u) = -0.391744538505134  LUMO (Ag) = -0.0968379230550611
cycle= 12 E= -75.3007673836276  delta_E= 1.42e-14  |g|= 2e-09  |ddm|= 2.49e-09
HOMO (B2u) = -0.391744538507637  LUMO (Ag) = -0.0968379229094328
cycle= 13 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 1.76e-09  |ddm|= 1.79e-09
HOMO (B2u) = -0.391744538455928  LUMO (Ag) = -0.0968379228638535
cycle= 14 E= -75.3007673836276  delta_E= -8.53e-14  |g|= 1.47e-09  |ddm|= 9.69e-10
HOMO (B2u) = -0.391744538422684  LUMO (Ag) = -0.0968379228450548
cycle= 15 E= -75.3007673836275  delta_E= 8.53e-14  |g|= 1.27e-09  |ddm|= 8.88e-10
HOMO (B2u) = -0.391744538403576  LUMO (Ag) = -0.0968379228365828
cycle= 16 E= -75.3007673836275  delta_E=    0  |g|= 1.13e-09  |ddm|= 6.92e-10
HOMO (B2u) = -0.391744538389969  LUMO (Ag) = -0.0968379228223015
cycle= 17 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 1e-09  |ddm|= 4.87e-10
HOMO (B2u) = -0.391744538229784  LUMO (Ag) = -0.0968379227084984
cycle= 18 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 4.4e-10  |ddm|= 2.45e-09
HOMO (B2u) = -0.391744538229724  LUMO (Ag) = -0.0968379227020047
cycle= 19 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 3.6e-10  |ddm|= 3.48e-10
HOMO (B2u) = -0.391744538248144  LUMO (Ag) = -0.096837922715391
cycle= 20 E= -75.3007673836275  delta_E= 5.68e-14  |g|= 2.95e-10  |ddm|= 2.31e-10
HOMO (B2u) = -0.391744538259758  LUMO (Ag) = -0.096837922722271
cycle= 21 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 2.47e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.391744538266565  LUMO (Ag) = -0.0968379227297814
cycle= 22 E= -75.3007673836277  delta_E= -5.68e-14  |g|= 2e-10  |ddm|= 1.37e-10
HOMO (B2u) = -0.391744538271813  LUMO (Ag) = -0.0968379227358239
cycle= 23 E= -75.3007673836276  delta_E= 8.53e-14  |g|= 1.62e-10  |ddm|= 1.17e-10
HOMO (B2u) = -0.391744538277758  LUMO (Ag) = -0.0968379227428176
cycle= 24 E= -75.3007673836275  delta_E= 5.68e-14  |g|= 1.28e-10  |ddm|= 1.16e-10
HOMO (B2u) = -0.391744538282623  LUMO (Ag) = -0.0968379227484745
cycle= 25 E= -75.3007673836276  delta_E= -8.53e-14  |g|= 9.73e-11  |ddm|= 1.01e-10
HOMO (B2u) = -0.391744538286829  LUMO (Ag) = -0.0968379227536582
cycle= 26 E= -75.3007673836276  delta_E= 4.26e-14  |g|= 7.05e-11  |ddm|= 9.21e-11
HOMO (B2u) = -0.391744538285507  LUMO (Ag) = -0.0968379227518117
cycle= 27 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 5.82e-11  |ddm|= 3.07e-11
HOMO (B2u) = -0.391744538283875  LUMO (Ag) = -0.0968379227498969
cycle= 28 E= -75.3007673836275  delta_E= 9.95e-14  |g|= 4.78e-11  |ddm|= 2.3e-11
HOMO (B2u) = -0.391744538282652  LUMO (Ag) = -0.0968379227486394
cycle= 29 E= -75.3007673836272  delta_E= 2.7e-13  |g|= 3.89e-11  |ddm|= 1.85e-11
HOMO (B2u) = -0.391744538281657  LUMO (Ag) = -0.0968379227478246
cycle= 30 E= -75.3007673836269  delta_E= 2.56e-13  |g|= 3.12e-11  |ddm|= 1.47e-11
HOMO (B2u) = -0.391744538280955  LUMO (Ag) = -0.0968379227472789
cycle= 31 E= -75.3007673836268  delta_E= 1.85e-13  |g|= 2.52e-11  |ddm|= 1.12e-11
HOMO (B2u) = -0.391744538280476  LUMO (Ag) = -0.0968379227469292
cycle= 32 E= -75.3007673836263  delta_E= 4.69e-13  |g|= 2.05e-11  |ddm|= 8.39e-12
HOMO (B2u) = -0.391744538280158  LUMO (Ag) = -0.0968379227466704
cycle= 33 E= -75.3007673836257  delta_E= 6.11e-13  |g|= 1.85e-11  |ddm|= 6.06e-12
HOMO (B2u) = -0.391744538279969  LUMO (Ag) = -0.0968379227464918
cycle= 34 E= -75.3007673836253  delta_E= 3.55e-13  |g|= 1.54e-11  |ddm|= 6.85e-12
HOMO (B2u) = -0.391744538279892  LUMO (Ag) = -0.0968379227463644
cycle= 35 E= -75.3007673836249  delta_E= 4.26e-13  |g|= 1.35e-11  |ddm|= 6.69e-12
HOMO (B2u) = -0.391744538279766  LUMO (Ag) = -0.0968379227462088
cycle= 36 E= -75.3007673836245  delta_E= 3.84e-13  |g|= 1.2e-11  |ddm|= 6.62e-12
HOMO (B2u) = -0.391744538279599  LUMO (Ag) = -0.0968379227460201
cycle= 37 E= -75.3007673836241  delta_E= 3.69e-13  |g|= 1.04e-11  |ddm|= 7.09e-12
HOMO (B2u) = -0.391744538279409  LUMO (Ag) = -0.0968379227458095
cycle= 38 E= -75.3007673836238  delta_E= 3.84e-13  |g|= 8.93e-12  |ddm|= 6.8e-12
HOMO (B2u) = -0.391744538279207  LUMO (Ag) = -0.096837922745585
cycle= 39 E= -75.3007673836234  delta_E= 3.27e-13  |g|= 7.6e-12  |ddm|= 5.88e-12
HOMO (B2u) = -0.391744538279  LUMO (Ag) = -0.0968379227453607
cycle= 40 E= -75.3007673836231  delta_E= 3.55e-13  |g|= 6.39e-12  |ddm|= 4.96e-12
HOMO (B2u) = -0.391744538278798  LUMO (Ag) = -0.0968379227451391
cycle= 41 E= -75.3007673836224  delta_E= 6.68e-13  |g|= 5.8e-12  |ddm|= 3.61e-12
HOMO (B2u) = -0.391744538278604  LUMO (Ag) = -0.0968379227449224
cycle= 42 E= -75.3007673836216  delta_E= 7.82e-13  |g|= 8.07e-12  |ddm|= 1.61e-12
HOMO (B2u) = -0.391744538278388  LUMO (Ag) = -0.0968379227446921
cycle= 43 E= -75.3007673836215  delta_E= 1.42e-13  |g|= 7.38e-12  |ddm|= 6.41e-12
HOMO (B2u) = -0.391744538278193  LUMO (Ag) = -0.0968379227444821
cycle= 44 E= -75.3007673836214  delta_E= 9.95e-14  |g|= 6.54e-12  |ddm|= 6.89e-12
HOMO (B2u) = -0.391744538278021  LUMO (Ag) = -0.0968379227443036
cycle= 45 E= -75.3007673836215  delta_E= -7.11e-14  |g|= 5.9e-12  |ddm|= 6.76e-12
HOMO (B2u) = -0.391744538277869  LUMO (Ag) = -0.0968379227441481
cycle= 46 E= -75.3007673836214  delta_E= 2.84e-14  |g|= 5.35e-12  |ddm|= 6.74e-12
HOMO (B2u) = -0.391744538277734  LUMO (Ag) = -0.096837922744002
cycle= 47 E= -75.3007673836213  delta_E= 9.95e-14  |g|= 4.8e-12  |ddm|= 6.86e-12
HOMO (B2u) = -0.391744538277616  LUMO (Ag) = -0.0968379227438623
cycle= 48 E= -75.3007673836214  delta_E= -9.95e-14  |g|= 3.82e-12  |ddm|= 7.39e-12
HOMO (B2u) = -0.391744538277513  LUMO (Ag) = -0.0968379227437329
cycle= 49 E= -75.3007673836216  delta_E= -1.28e-13  |g|= 3.09e-12  |ddm|= 7.73e-12
HOMO (B2u) = -0.39174453827743  LUMO (Ag) = -0.0968379227436173
cycle= 50 E= -75.3007673836217  delta_E= -9.95e-14  |g|= 2.44e-12  |ddm|= 7.38e-12
SCF not converged.
SCF energy = -75.3007673836217

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmptwmil_cd
max_memory 4000 MB (current use 8398 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4927493145099  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5138643258637  dE = -0.021115011  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5259098512511  dE = -0.012045525  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5340594672431  dE = -0.008149616  S^2 = 0.0000000
               |grad[o]|=0.0918  |ddm|=0.0329  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5399122654594  dE = -0.0058527982  S^2 = 0.0000000
               |grad[o]|=0.072  |ddm|=0.0206  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5440647795777  dE = -0.0041525141  S^2 = 0.0000000
               |grad[o]|=0.0544  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5467989029049  dE = -0.0027341233  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00993  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.548278176059  dE = -0.0014792732  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00842  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5486404532946  dE = -0.00036227724  S^2 = 0.0000000
               |grad[o]|=0.00986  |ddm|=0.00939  |maxRot[o]|= 0.06
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5486450982923  dE = -4.6449977e-06  S^2 = 0.0000000
               |grad[o]|=0.00123  |ddm|=0.00881  |maxRot[o]|=0.00593
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5486452002603  dE = -1.0196796e-07  S^2 = 0.0000000
               |grad[o]|=0.000207  |ddm|=0.00137  |maxRot[o]|=0.000619
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5486452022817  dE = -2.0214088e-09  S^2 = 0.0000000
               |grad[o]|=3.39e-05  |ddm|=0.000185  |maxRot[o]|=8.81e-05
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5486452023544  dE = -7.2759576e-11  S^2 = 0.0000000
               |grad[o]|=6.7e-06  |ddm|=2.89e-05  |maxRot[o]|=1.69e-05
2-step CASSCF converged in 12 macro (60 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97338743 1.72966225 1.77895395 1.77895251 0.28849482 0.21301937
 0.21301917 0.0245105 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00731   0.00385   0.00000   0.00000  -0.00077
  0 C 2s       0.63288   0.60630   0.00000  -0.00000  -0.31355
  0 C 3s      -0.02435   0.00955  -0.00000  -0.00000   0.02103
  0 C 2px      0.00000  -0.00000  -0.00000   0.70643  -0.00000
  0 C 2py     -0.00000   0.00000   0.70643   0.00000  -0.00000
  0 C 2pz      0.31214  -0.36370  -0.00000  -0.00000   0.63146
  0 C 3px      0.00000  -0.00000  -0.00000   0.02283  -0.00000
  0 C 3py      0.00000  -0.00000   0.02283   0.00000  -0.00000
  0 C 3pz     -0.02602  -0.00192  -0.00000  -0.00000  -0.03894
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02081   0.00000  -0.00000
  0 C 3dz^2    0.02662  -0.00320  -0.00000  -0.00000   0.03135
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02081  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00731  -0.00385   0.00000   0.00000  -0.00077
  1 C 2s       0.63288  -0.60630   0.00000   0.00000  -0.31355
  1 C 3s      -0.02435  -0.00955   0.00000   0.00000   0.02103
  1 C 2px     -0.00000   0.00000   0.00000   0.70643   0.00000
  1 C 2py      0.00000   0.00000   0.70643  -0.00000   0.00000
  1 C 2pz     -0.31214  -0.36370   0.00000   0.00000  -0.63146
  1 C 3px     -0.00000   0.00000   0.00000   0.02283   0.00000
  1 C 3py      0.00000  -0.00000   0.02283  -0.00000   0.00000
  1 C 3pz      0.02602  -0.00192  -0.00000  -0.00000   0.03894
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02081   0.00000  -0.00000
  1 C 3dz^2    0.02662   0.00320   0.00000   0.00000   0.03135
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02081  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s       0.00000   0.00000   0.36324
  0 C 3s      -0.00000   0.00000  -0.04244
  0 C 2px      0.70668   0.00000  -0.00000
  0 C 2py     -0.00000   0.70668  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.60447
  0 C 3px     -0.01294  -0.00000   0.00000
  0 C 3py      0.00000  -0.01294   0.00000
  0 C 3pz     -0.00000   0.00000   0.02137
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02104   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02031
  0 C 3dxz    -0.02104  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000  -0.00000  -0.36324
  1 C 3s       0.00000  -0.00000   0.04244
  1 C 2px     -0.70668   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70668  -0.00000
  1 C 2pz      0.00000   0.00000   0.60447
  1 C 3px      0.01294  -0.00000   0.00000
  1 C 3py      0.00000   0.01294  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02137
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02104   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02031
  1 C 3dxz    -0.02104   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99111459
<CAS-nat-orb|mo-hf>  4  4    0.99735748
<CAS-nat-orb|mo-hf>  5  5    0.99934483
<CAS-nat-orb|mo-hf>  6  6    0.99934482
<CAS-nat-orb|mo-hf>  7  7    0.97351395
<CAS-nat-orb|mo-hf>  8  8    0.97438519
<CAS-nat-orb|mo-hf>  9  9    0.97438516
<CAS-nat-orb|mo-hf>  10  10    0.76990714
<CAS-nat-orb|mo-hf>  10  14   -0.57655981
CASSCF energy = -75.5486452023544
CASCI E = -75.5486452023544  E(CI) = -16.1630328802121  S^2 = 0.0000000
......production of RDMs took       2.56 sec
......reading the RDM took          0.63 sec
......production of RDMs took      29.52 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.28 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000079316
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000020950
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000595854
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000064488
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000375505
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0000914706
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000304902
HMAT symm error =    0.0060581859
E(MRCI) - E(ref) = -0.1083718462674028 DC = -0.005049390495457041
E(WickICMRCISD)   = -75.65701704862184  E_corr_ci = -0.1083718462674028
E(WickICMRCISD+Q) = -75.6620664391173  E_corr_ci = -0.1134212367628599
Time cost =   2591.273
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 11:44:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.613990493306 AA    0.000000000000   0.000000000000   3.050000000000 Bohr   0.0

nuclear repulsion = 11.8032786885246
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.525]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1167635.20


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpi53ltvtr
max_memory 4000 MB (current use 8390 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9606241516019

WARN: Singularity detected in overlap matrix (condition number =  203). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.154846704479715  LUMO (Ag) = -0.154379304561516

WARN: Ag LUMO -0.154379304561516 < system HOMO -0.154846704479715


WARN: B2u HOMO -0.154846704479715 > system LUMO -0.154379304561516


WARN: B3u HOMO -0.154846704479715 > system LUMO -0.154379304561516

cycle= 1 E= -75.2674224197194  delta_E= -0.307  |g|= 0.242  |ddm|= 1.42
HOMO (B2u) = -0.423431408188682  LUMO (Ag) = -0.147745494594373
cycle= 2 E= -75.2901719236938  delta_E= -0.0227  |g|= 0.0499  |ddm|= 0.326
HOMO (B3u) = -0.385318413495461  LUMO (Ag) = -0.0975529483033129
cycle= 3 E= -75.2912021417109  delta_E= -0.00103  |g|= 0.0132  |ddm|= 0.0546
HOMO (B3u) = -0.387177687087389  LUMO (Ag) = -0.094695040835718
cycle= 4 E= -75.291314408399  delta_E= -0.000112  |g|= 0.00225  |ddm|= 0.0161
HOMO (B2u) = -0.38789931105226  LUMO (Ag) = -0.0952945928883295
cycle= 5 E= -75.2913182764059  delta_E= -3.87e-06  |g|= 0.000326  |ddm|= 0.00311
HOMO (B2u) = -0.387835444387876  LUMO (Ag) = -0.0952466102829228
cycle= 6 E= -75.2913183380417  delta_E= -6.16e-08  |g|= 4.01e-05  |ddm|= 0.000644
HOMO (B3u) = -0.387827943274185  LUMO (Ag) = -0.0952344140423403
cycle= 7 E= -75.2913183390841  delta_E= -1.04e-09  |g|= 5.01e-06  |ddm|= 0.000118
HOMO (B3u) = -0.387827276401285  LUMO (Ag) = -0.0952333329362683
cycle= 8 E= -75.2913183390995  delta_E= -1.54e-11  |g|= 5.51e-07  |ddm|= 1.99e-05
HOMO (B3u) = -0.387827240724852  LUMO (Ag) = -0.0952331169888421
cycle= 9 E= -75.2913183390998  delta_E= -2.84e-13  |g|= 2.29e-08  |ddm|= 1.04e-06
HOMO (B3u) = -0.387827233118365  LUMO (Ag) = -0.0952331317889691
cycle= 10 E= -75.2913183390997  delta_E= 1.42e-13  |g|= 3.63e-09  |ddm|= 8.55e-08
HOMO (B3u) = -0.387827234291161  LUMO (Ag) = -0.0952331330214446
cycle= 11 E= -75.2913183390998  delta_E= -1.14e-13  |g|= 2.64e-09  |ddm|= 5.05e-09
HOMO (B3u) = -0.387827234014556  LUMO (Ag) = -0.0952331326637951
cycle= 12 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 2.05e-09  |ddm|= 2.41e-09
HOMO (B3u) = -0.387827234012783  LUMO (Ag) = -0.0952331324868721
cycle= 13 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 1.85e-09  |ddm|= 1.69e-09
HOMO (B3u) = -0.387827233970933  LUMO (Ag) = -0.0952331324569901
cycle= 14 E= -75.2913183390999  delta_E= -1.14e-13  |g|= 1.55e-09  |ddm|= 1.03e-09
HOMO (B3u) = -0.387827233948759  LUMO (Ag) = -0.0952331324596939
cycle= 15 E= -75.2913183390998  delta_E= 8.53e-14  |g|= 1.35e-09  |ddm|= 1.05e-09
HOMO (B3u) = -0.387827233907028  LUMO (Ag) = -0.0952331324190733
cycle= 16 E= -75.2913183390997  delta_E= 7.11e-14  |g|= 1.21e-09  |ddm|= 4.04e-10
HOMO (B3u) = -0.387827233900505  LUMO (Ag) = -0.0952331324084415
cycle= 17 E= -75.2913183390999  delta_E= -1.71e-13  |g|= 1.05e-09  |ddm|= 5.32e-10
HOMO (B3u) = -0.387827233741219  LUMO (Ag) = -0.0952331323123501
cycle= 18 E= -75.2913183390997  delta_E= 1.99e-13  |g|= 4.6e-10  |ddm|= 2.57e-09
HOMO (B3u) = -0.387827233740552  LUMO (Ag) = -0.0952331323055832
cycle= 19 E= -75.2913183390997  delta_E= -1.42e-14  |g|= 3.76e-10  |ddm|= 3.58e-10
HOMO (B3u) = -0.38782723375858  LUMO (Ag) = -0.0952331323190907
cycle= 20 E= -75.2913183390998  delta_E= -1.42e-13  |g|= 3.11e-10  |ddm|= 2.31e-10
HOMO (B3u) = -0.387827233770308  LUMO (Ag) = -0.0952331323260128
cycle= 21 E= -75.2913183390998  delta_E= 5.68e-14  |g|= 2.64e-10  |ddm|= 1.74e-10
HOMO (B3u) = -0.387827233776462  LUMO (Ag) = -0.0952331323338169
cycle= 22 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 2.14e-10  |ddm|= 1.42e-10
HOMO (B3u) = -0.387827233781413  LUMO (Ag) = -0.0952331323401955
cycle= 23 E= -75.2913183390997  delta_E= 1.71e-13  |g|= 1.74e-10  |ddm|= 1.2e-10
HOMO (B3u) = -0.387827233787543  LUMO (Ag) = -0.0952331323477051
cycle= 24 E= -75.2913183390997  delta_E= -5.68e-14  |g|= 1.37e-10  |ddm|= 1.15e-10
HOMO (B3u) = -0.387827233792202  LUMO (Ag) = -0.095233132353878
cycle= 25 E= -75.2913183390997  delta_E= -2.84e-14  |g|= 1.04e-10  |ddm|= 1.07e-10
HOMO (B3u) = -0.387827233796529  LUMO (Ag) = -0.0952331323601019
cycle= 26 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 7.55e-11  |ddm|= 9.84e-11
HOMO (B3u) = -0.387827233795252  LUMO (Ag) = -0.0952331323584802
cycle= 27 E= -75.2913183390998  delta_E=    0  |g|= 6.25e-11  |ddm|= 3.22e-11
HOMO (B3u) = -0.387827233789686  LUMO (Ag) = -0.0952331323541201
Extra cycle  E= -75.2913183390998  delta_E= 1.42e-14  |g|= 1.98e-11  |ddm|= 8.89e-11
converged SCF energy = -75.2913183390998

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpi53ltvtr
max_memory 4000 MB (current use 8390 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4857258490142  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5064440237511  dE = -0.020718175  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.68  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5184205875753  dE = -0.011976564  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0655  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5265374833724  dE = -0.0081168958  S^2 = 0.0000000
               |grad[o]|=0.0908  |ddm|=0.0339  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5322901948629  dE = -0.0057527115  S^2 = 0.0000000
               |grad[o]|=0.0705  |ddm|=0.0223  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5362645665271  dE = -0.0039743717  S^2 = 0.0000000
               |grad[o]|=0.0523  |ddm|=0.0155  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5387474751834  dE = -0.0024829087  S^2 = 0.0000000
               |grad[o]|=0.0357  |ddm|=0.0116  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5399094469672  dE = -0.0011619718  S^2 = 0.0000000
               |grad[o]|=0.0201  |ddm|=0.0105  |maxRot[o]|=0.0799
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5400388139254  dE = -0.00012936696  S^2 = 0.0000000
               |grad[o]|=0.00582  |ddm|=0.0121  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5400404965121  dE = -1.6825867e-06  S^2 = 0.0000000
               |grad[o]|=0.000811  |ddm|=0.00672  |maxRot[o]|=0.00294
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5400405390173  dE = -4.2505192e-08  S^2 = 0.0000000
               |grad[o]|=0.000141  |ddm|=0.00102  |maxRot[o]|=0.000305
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5400405400779  dE = -1.0605703e-09  S^2 = 0.0000000
               |grad[o]|=2.6e-05  |ddm|=0.000166  |maxRot[o]|=3.3e-05
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5400405401189  dE = -4.0984105e-11  S^2 = 0.0000000
               |grad[o]|=6.26e-06  |ddm|=3.01e-05  |maxRot[o]|=7.95e-06
macro iter 13 (3 JK  0 micro), CASSCF E = -75.54004054013  dE = -1.1169732e-11  S^2 = 0.0000000
               |grad[o]|=1.33e-06  |ddm|=6.81e-06  |maxRot[o]|=1.5e-06
2-step CASSCF converged in 13 macro (62 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97266798 1.73807552 1.76672213 1.76671796 0.28541775 0.22250966
 0.22250996 0.02537904]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00752   0.00393   0.00000   0.00000  -0.00075
  0 C 2s       0.63584   0.61195  -0.00000  -0.00000  -0.30764
  0 C 3s      -0.02245   0.00972   0.00000   0.00000   0.02272
  0 C 2px     -0.00000   0.00000  -0.00000   0.70640   0.00000
  0 C 2py     -0.00000   0.00000   0.70640  -0.00000   0.00000
  0 C 2pz      0.30639  -0.35411   0.00000   0.00000   0.63428
  0 C 3px     -0.00000  -0.00000  -0.00000   0.02449   0.00000
  0 C 3py     -0.00000   0.00000   0.02449  -0.00000   0.00000
  0 C 3pz     -0.02442  -0.00191   0.00000   0.00000  -0.03747
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.01996  -0.00000   0.00000
  0 C 3dz^2    0.02599  -0.00343   0.00000   0.00000   0.03354
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.01996   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00752  -0.00393   0.00000   0.00000  -0.00075
  1 C 2s       0.63584  -0.61195  -0.00000  -0.00000  -0.30764
  1 C 3s      -0.02245  -0.00972  -0.00000  -0.00000   0.02272
  1 C 2px     -0.00000   0.00000   0.00000   0.70640  -0.00000
  1 C 2py      0.00000  -0.00000   0.70640   0.00000   0.00000
  1 C 2pz     -0.30639  -0.35411  -0.00000   0.00000  -0.63428
  1 C 3px      0.00000  -0.00000   0.00000   0.02449  -0.00000
  1 C 3py      0.00000  -0.00000   0.02449   0.00000  -0.00000
  1 C 3pz      0.02442  -0.00191   0.00000   0.00000   0.03747
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.01996  -0.00000   0.00000
  1 C 3dz^2    0.02599   0.00343  -0.00000  -0.00000   0.03354
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.01996   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.35370
  0 C 3s       0.00000   0.00000  -0.04177
  0 C 2px      0.70670  -0.00000   0.00000
  0 C 2py     -0.00000   0.70670  -0.00000
  0 C 2pz      0.00000  -0.00000   0.61017
  0 C 3px     -0.01201   0.00000   0.00000
  0 C 3py      0.00000  -0.01201  -0.00000
  0 C 3pz      0.00000   0.00000   0.02109
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02067  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01998
  0 C 3dxz    -0.02067   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s      -0.00000  -0.00000  -0.35370
  1 C 3s      -0.00000  -0.00000   0.04177
  1 C 2px     -0.70670  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70670   0.00000
  1 C 2pz      0.00000  -0.00000   0.61017
  1 C 3px      0.01201   0.00000  -0.00000
  1 C 3py      0.00000   0.01201   0.00000
  1 C 3pz      0.00000   0.00000   0.02109
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02067  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.01998
  1 C 3dxz    -0.02067  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99096825
<CAS-nat-orb|mo-hf>  4  4    0.99730116
<CAS-nat-orb|mo-hf>  5  5    0.99929410
<CAS-nat-orb|mo-hf>  6  6    0.99929409
<CAS-nat-orb|mo-hf>  7  7    0.97345976
<CAS-nat-orb|mo-hf>  8  8    0.97595048
<CAS-nat-orb|mo-hf>  9  9    0.97595045
<CAS-nat-orb|mo-hf>  10  10    0.79085111
<CAS-nat-orb|mo-hf>  10  14   -0.55412106
CASSCF energy = -75.54004054013
CASCI E = -75.54004054013  E(CI) = -16.0670214627711  S^2 = 0.0000000
......production of RDMs took       5.63 sec
......reading the RDM took          0.55 sec
......production of RDMs took      42.53 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.02 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000314386
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000083040
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000970280
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000092864
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000640395
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001161547
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000387182
HMAT symm error =    0.0060821350
E(MRCI) - E(ref) = -0.108872891660198 DC = -0.005133083995536347
E(WickICMRCISD)   = -75.64891343179023  E_corr_ci = -0.108872891660198
E(WickICMRCISD+Q) = -75.65404651578577  E_corr_ci = -0.1140059756557343
Time cost =   2815.908
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 12:31:49 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.640449353852 AA    0.000000000000   0.000000000000   3.100000000000 Bohr   0.0

nuclear repulsion = 11.6129032258065
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.55]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1211645.68


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpdoc6ulh7
max_memory 4000 MB (current use 8614 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9340105731017

WARN: Singularity detected in overlap matrix (condition number =  188). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.149693266404789  LUMO (B3u) = -0.149693266404789

WARN: B2u HOMO -0.149693266404789 > system LUMO -0.149693266404789

cycle= 1 E= -75.3573845713054  delta_E= -0.423  |g|= 0.265  |ddm|= 1.55
HOMO (B2u) = -0.413310367291846  LUMO (B3u) = -0.0846696262312553
cycle= 2 E= -75.3843760014416  delta_E= -0.027  |g|= 0.0539  |ddm|= 0.354
HOMO (B2u) = -0.373182146511252  LUMO (B3u) = -0.0395668514335568
cycle= 3 E= -75.3858456567449  delta_E= -0.00147  |g|= 0.018  |ddm|= 0.0717
HOMO (B2u) = -0.377721327859491  LUMO (B3u) = -0.0440841679310619
cycle= 4 E= -75.3860530258635  delta_E= -0.000207  |g|= 0.000721  |ddm|= 0.0382
HOMO (B2u) = -0.377699771169469  LUMO (B3u) = -0.0442008432276683
cycle= 5 E= -75.3860532373451  delta_E= -2.11e-07  |g|= 8.07e-05  |ddm|= 0.00144
HOMO (B2u) = -0.377674560909568  LUMO (B3u) = -0.0441740446286822
cycle= 6 E= -75.3860532409994  delta_E= -3.65e-09  |g|= 1.32e-05  |ddm|= 0.000134
HOMO (B2u) = -0.377672848926058  LUMO (B3u) = -0.0441758015090624
cycle= 7 E= -75.3860532411127  delta_E= -1.13e-10  |g|= 1.86e-06  |ddm|= 3.43e-05
HOMO (B2u) = -0.377672100443066  LUMO (B3u) = -0.0441752784119647
cycle= 8 E= -75.3860532411149  delta_E= -2.2e-12  |g|= 1.02e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.377672134542525  LUMO (B3u) = -0.0441753126347232
cycle= 9 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 9.15e-09  |ddm|= 2.08e-07
HOMO (B2u) = -0.377672135428699  LUMO (B3u) = -0.0441753150892547
cycle= 10 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 5.28e-09  |ddm|= 8.76e-09
HOMO (B2u) = -0.377672135485103  LUMO (B3u) = -0.0441753151245478
cycle= 11 E= -75.3860532411149  delta_E=    0  |g|= 4.99e-09  |ddm|= 4.29e-09
HOMO (B2u) = -0.377672134122641  LUMO (B3u) = -0.0441753136925206
cycle= 12 E= -75.3860532411148  delta_E= 8.53e-14  |g|= 4.61e-09  |ddm|= 2.33e-09
HOMO (B2u) = -0.377672133903664  LUMO (B3u) = -0.0441753133840757
cycle= 13 E= -75.3860532411148  delta_E= 2.84e-14  |g|= 8.94e-10  |ddm|= 7.69e-09
HOMO (B2u) = -0.377672133973399  LUMO (B3u) = -0.0441753134346
cycle= 14 E= -75.3860532411149  delta_E= -8.53e-14  |g|= 7.9e-10  |ddm|= 4.35e-10
HOMO (B2u) = -0.377672134141507  LUMO (B3u) = -0.0441753135504147
cycle= 15 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 6.66e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.377672134097406  LUMO (B3u) = -0.0441753135970835
cycle= 16 E= -75.3860532411148  delta_E= 1.42e-14  |g|= 7.82e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.377672134148783  LUMO (B3u) = -0.0441753136135237
cycle= 17 E= -75.3860532411149  delta_E= -9.95e-14  |g|= 8.39e-10  |ddm|= 6.59e-10
HOMO (B2u) = -0.37767213416224  LUMO (B3u) = -0.0441753136099321
cycle= 18 E= -75.3860532411149  delta_E= 8.53e-14  |g|= 5.71e-10  |ddm|= 5.55e-10
HOMO (B2u) = -0.377672134187563  LUMO (B3u) = -0.0441753136340424
cycle= 19 E= -75.386053241115  delta_E= -1.14e-13  |g|= 4.44e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.377672134218925  LUMO (B3u) = -0.0441753136628927
cycle= 20 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 3.14e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.377672134234335  LUMO (B3u) = -0.0441753136725864
cycle= 21 E= -75.3860532411148  delta_E= 1.42e-13  |g|= 1.86e-10  |ddm|= 2.78e-10
HOMO (B2u) = -0.377672134234366  LUMO (B3u) = -0.0441753136702858
cycle= 22 E= -75.3860532411149  delta_E= -1.42e-13  |g|= 1.62e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.377672134234205  LUMO (B3u) = -0.0441753136686047
cycle= 23 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 1.43e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.377672134231527  LUMO (B3u) = -0.044175313666878
cycle= 24 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 1.3e-10  |ddm|= 5.92e-11
HOMO (B2u) = -0.377672134234441  LUMO (B3u) = -0.044175313667038
cycle= 25 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 1.06e-10  |ddm|= 6.65e-11
HOMO (B2u) = -0.377672134236894  LUMO (B3u) = -0.0441753136680629
cycle= 26 E= -75.3860532411149  delta_E= 4.26e-14  |g|= 7.85e-11  |ddm|= 6.23e-11
HOMO (B2u) = -0.37767213423819  LUMO (B3u) = -0.0441753136685394
cycle= 27 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 6.04e-11  |ddm|= 4.28e-11
HOMO (B2u) = -0.377672134239311  LUMO (B3u) = -0.0441753136688978
cycle= 28 E= -75.386053241115  delta_E= -8.53e-14  |g|= 4.57e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.377672134240372  LUMO (B3u) = -0.0441753136693607
cycle= 29 E= -75.386053241115  delta_E= 5.68e-14  |g|= 3.53e-11  |ddm|= 2.49e-11
HOMO (B2u) = -0.377672134241077  LUMO (B3u) = -0.0441753136697285
cycle= 30 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 2.96e-11  |ddm|= 1.52e-11
HOMO (B2u) = -0.377672134241626  LUMO (B3u) = -0.044175313670002
cycle= 31 E= -75.386053241115  delta_E= -2.84e-14  |g|= 2.44e-11  |ddm|= 1.32e-11
HOMO (B2u) = -0.377672134242058  LUMO (B3u) = -0.0441753136701948
cycle= 32 E= -75.3860532411149  delta_E= 5.68e-14  |g|= 1.98e-11  |ddm|= 1.16e-11
HOMO (B2u) = -0.37767213424253  LUMO (B3u) = -0.0441753136703631
cycle= 33 E= -75.3860532411148  delta_E= 8.53e-14  |g|= 1.54e-11  |ddm|= 1.05e-11
HOMO (B2u) = -0.377672134242864  LUMO (B3u) = -0.0441753136704918
cycle= 34 E= -75.3860532411146  delta_E= 1.99e-13  |g|= 1.17e-11  |ddm|= 8.56e-12
HOMO (B2u) = -0.377672134243104  LUMO (B3u) = -0.0441753136705743
cycle= 35 E= -75.3860532411145  delta_E= 8.53e-14  |g|= 9.08e-12  |ddm|= 6.39e-12
HOMO (B2u) = -0.377672134243286  LUMO (B3u) = -0.0441753136706219
cycle= 36 E= -75.3860532411144  delta_E= 1.14e-13  |g|= 7.08e-12  |ddm|= 5.11e-12
HOMO (B2u) = -0.377672134243424  LUMO (B3u) = -0.0441753136706502
cycle= 37 E= -75.3860532411142  delta_E= 2.27e-13  |g|= 6.12e-12  |ddm|= 3.56e-12
HOMO (B2u) = -0.377672134243519  LUMO (B3u) = -0.0441753136706549
cycle= 38 E= -75.3860532411137  delta_E= 4.83e-13  |g|= 6.07e-12  |ddm|= 2.46e-12
HOMO (B2u) = -0.377672134243569  LUMO (B3u) = -0.0441753136706251
cycle= 39 E= -75.3860532411133  delta_E= 3.69e-13  |g|= 6.24e-12  |ddm|= 2.98e-12
HOMO (B2u) = -0.377672134243581  LUMO (B3u) = -0.0441753136705613
cycle= 40 E= -75.3860532411132  delta_E= 1.71e-13  |g|= 5.93e-12  |ddm|= 3.22e-12
HOMO (B2u) = -0.377672134243563  LUMO (B3u) = -0.0441753136704729
cycle= 41 E= -75.3860532411127  delta_E= 4.55e-13  |g|= 6.54e-12  |ddm|= 2.57e-12
HOMO (B2u) = -0.377672134243501  LUMO (B3u) = -0.0441753136703465
cycle= 42 E= -75.3860532411124  delta_E= 3.41e-13  |g|= 7.13e-12  |ddm|= 2.74e-12
HOMO (B2u) = -0.3776721342434  LUMO (B3u) = -0.0441753136701874
cycle= 43 E= -75.3860532411121  delta_E= 2.56e-13  |g|= 6.26e-12  |ddm|= 3.3e-12
HOMO (B2u) = -0.377672134243276  LUMO (B3u) = -0.0441753136700104
cycle= 44 E= -75.3860532411117  delta_E= 4.69e-13  |g|= 6.83e-12  |ddm|= 2.42e-12
HOMO (B2u) = -0.377672134243106  LUMO (B3u) = -0.0441753136697902
cycle= 45 E= -75.3860532411116  delta_E= 7.11e-14  |g|= 5.54e-12  |ddm|= 3.91e-12
HOMO (B2u) = -0.377672134242939  LUMO (B3u) = -0.0441753136695765
cycle= 46 E= -75.3860532411115  delta_E= 5.68e-14  |g|= 4.77e-12  |ddm|= 3.95e-12
HOMO (B2u) = -0.377672134242795  LUMO (B3u) = -0.044175313669388
cycle= 47 E= -75.3860532411111  delta_E= 4.69e-13  |g|= 4.95e-12  |ddm|= 2.48e-12
HOMO (B2u) = -0.377672134242642  LUMO (B3u) = -0.0441753136691941
cycle= 48 E= -75.3860532411107  delta_E= 3.27e-13  |g|= 5.31e-12  |ddm|= 2.41e-12
HOMO (B2u) = -0.377672134242477  LUMO (B3u) = -0.0441753136689908
cycle= 49 E= -75.3860532411107  delta_E= 2.84e-14  |g|= 4.57e-12  |ddm|= 3.43e-12
HOMO (B2u) = -0.377672134242335  LUMO (B3u) = -0.0441753136688144
cycle= 50 E= -75.3860532411102  delta_E= 4.83e-13  |g|= 4.49e-12  |ddm|= 2.41e-12
SCF not converged.
SCF energy = -75.3860532411102

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpdoc6ulh7
max_memory 4000 MB (current use 8614 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4764159496087  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4872405393533  dE = -0.01082459  S^2 = 0.0000000
               |grad[o]|=0.0774  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4972333232123  dE = -0.0099927839  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0605  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5064112292996  dE = -0.0091779061  S^2 = 0.0000000
               |grad[o]|=0.0682  |ddm|=0.0993  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5143948427224  dE = -0.0079836134  S^2 = 0.0000000
               |grad[o]|=0.0667  |ddm|=0.195  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5205000868484  dE = -0.0061052441  S^2 = 0.0000000
               |grad[o]|=0.0613  |ddm|=0.223  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5243819102646  dE = -0.0038818234  S^2 = 0.0000000
               |grad[o]|=0.048  |ddm|=0.157  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.5257550693848  dE = -0.0013731591  S^2 = 0.0000000
               |grad[o]|=0.0286  |ddm|=  0.1  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5259763703338  dE = -0.00022130095  S^2 = 0.0000000
               |grad[o]|=0.0123  |ddm|=0.094  |maxRot[o]|=0.0187
macro iter 9 (3 JK  0 micro), CASSCF E = -75.526289469623  dE = -0.00031309929  S^2 = 0.0000000
               |grad[o]|=0.012  |ddm|=0.173  |maxRot[o]|=0.00867
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5272879883939  dE = -0.00099851877  S^2 = 0.0000000
               |grad[o]|=0.0223  |ddm|=0.312  |maxRot[o]|=0.0193
macro iter 11 (4 JK  0 micro), CASSCF E = -75.5294593654744  dE = -0.0021713771  S^2 = 0.0000000
               |grad[o]|=0.0352  |ddm|=0.467  |maxRot[o]|=0.033
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5311507177843  dE = -0.0016913523  S^2 = 0.0000000
               |grad[o]|=0.0305  |ddm|=0.343  |maxRot[o]|= 0.04
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5314728655688  dE = -0.00032214778  S^2 = 0.0000000
               |grad[o]|=0.0123  |ddm|=0.104  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5315148537024  dE = -4.1988134e-05  S^2 = 0.0000000
               |grad[o]|=0.00408  |ddm|=0.0221  |maxRot[o]|=0.00802
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5315176146209  dE = -2.7609184e-06  S^2 = 0.0000000
               |grad[o]|=0.00103  |ddm|=0.00743  |maxRot[o]|=0.00197
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5315177968732  dE = -1.8225231e-07  S^2 = 0.0000000
               |grad[o]|=0.000275  |ddm|=0.00192  |maxRot[o]|=0.000488
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5315178086547  dE = -1.1781566e-08  S^2 = 0.0000000
               |grad[o]|=6.85e-05  |ddm|=0.00051  |maxRot[o]|=0.000124
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5315178094356  dE = -7.8088647e-10  S^2 = 0.0000000
               |grad[o]|=1.85e-05  |ddm|=0.000128  |maxRot[o]|=3.1e-05
macro iter 19 (3 JK  0 micro), CASSCF E = -75.5315178094877  dE = -5.2125415e-11  S^2 = 0.0000000
               |grad[o]|=5.02e-06  |ddm|=3.41e-05  |maxRot[o]|=8.2e-06
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5315178094906  dE = -2.8848035e-12  S^2 = 0.0000000
               |grad[o]|=1.29e-06  |ddm|=8.67e-06  |maxRot[o]|=2.07e-06
2-step CASSCF converged in 20 macro (81 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97199268 1.74648651 0.28354267 1.75359787 1.75359626 0.23226963
 0.2322697  0.02624468]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00771   0.00402  -0.00073   0.00000   0.00000
  0 C 2s       0.63877   0.61742  -0.30165   0.00000   0.00000
  0 C 3s      -0.02059   0.00990   0.02411   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.70637
  0 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  0 C 2pz      0.30053  -0.34447   0.63708  -0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000   0.02607
  0 C 3py      0.00000  -0.00000   0.00000   0.02607  -0.00000
  0 C 3pz     -0.02284  -0.00193  -0.03571   0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000   0.01911  -0.00000
  0 C 3dz^2    0.02539  -0.00363   0.03576   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000   0.01911
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00771  -0.00402  -0.00073   0.00000   0.00000
  1 C 2s       0.63877  -0.61742  -0.30165  -0.00000  -0.00000
  1 C 3s      -0.02059  -0.00990   0.02411  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000   0.00000   0.70637
  1 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  1 C 2pz     -0.30053  -0.34447  -0.63708  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000   0.02607
  1 C 3py      0.00000  -0.00000  -0.00000   0.02607  -0.00000
  1 C 3pz      0.02284  -0.00193   0.03571   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01911   0.00000
  1 C 3dz^2    0.02539   0.00363   0.03576  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000  -0.01911
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s       0.00000   0.00000   0.34413
  0 C 3s       0.00000   0.00000  -0.04088
  0 C 2px      0.00000   0.70673   0.00000
  0 C 2py      0.70673   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.61571
  0 C 3px      0.00000  -0.01104   0.00000
  0 C 3py     -0.01104   0.00000   0.00000
  0 C 3pz      0.00000   0.00000   0.02055
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.02028   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01955
  0 C 3dxz     0.00000  -0.02028   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.34413
  1 C 3s      -0.00000  -0.00000   0.04088
  1 C 2px     -0.00000  -0.70673  -0.00000
  1 C 2py     -0.70673  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.61571
  1 C 3px     -0.00000   0.01104  -0.00000
  1 C 3py      0.01104  -0.00000  -0.00000
  1 C 3pz      0.00000   0.00000   0.02055
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.02028   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.01955
  1 C 3dxz     0.00000  -0.02028   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99970732
<CAS-nat-orb|mo-hf>  4  4    0.99969115
<CAS-nat-orb|mo-hf>  5  5    0.99206274
<CAS-nat-orb|mo-hf>  6  6    0.99749856
<CAS-nat-orb|mo-hf>  7  7    0.98939317
<CAS-nat-orb|mo-hf>  8  8    0.97289815
<CAS-nat-orb|mo-hf>  9  9    0.95779869
<CAS-nat-orb|mo-hf>  10  10    0.87337006
<CAS-nat-orb|mo-hf>  10  12   -0.42886290
CASSCF energy = -75.5315178094906
CASCI E = -75.5315178094906  E(CI) = -15.9739146799243  S^2 = 0.0000000
......production of RDMs took       2.23 sec
......reading the RDM took          0.45 sec
......production of RDMs took      27.58 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.07 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31459 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21539 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30467 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21539 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30467 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000202526
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21539 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30467 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000053494
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21539 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30467 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0001031690
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21539 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30467 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000108847
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21539 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30467 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000657550
pre mat (irabktpq1, rabctpqg*)   17003  21539 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30467 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21539      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21539      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21539    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21539   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21539   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21539  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21539  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21539  21539 symm error =    0.0001365962
pre mat (rabctpqg*, iabckpqg*)   21539  30467 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30467      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30467      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30467    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30467   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30467   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30467  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30467  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30467  21539 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30467  30467 symm error =    0.0000455321
HMAT symm error =    0.0060065958
E(MRCI) - E(ref) = -0.1094142349444525 DC = -0.005222069036808082
E(WickICMRCISD)   = -75.64093204443508  E_corr_ci = -0.1094142349444525
E(WickICMRCISD+Q) = -75.64615411347188  E_corr_ci = -0.1146363039812605
Time cost =   2582.161
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 13:14:51 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.666908214398 AA    0.000000000000   0.000000000000   3.150000000000 Bohr   0.0

nuclear repulsion = 11.4285714285714
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.575]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1254072.67


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpzj3lzfsv
max_memory 4000 MB (current use 8606 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9089301361996

WARN: Singularity detected in overlap matrix (condition number =  175). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.144793107119776  LUMO (B3u) = -0.144793107119776

WARN: B2u HOMO -0.144793107119776 > system LUMO -0.144793107119776

cycle= 1 E= -75.3499635205346  delta_E= -0.441  |g|= 0.262  |ddm|= 1.54
HOMO (B2u) = -0.407994029365037  LUMO (B3u) = -0.0815659278261189
cycle= 2 E= -75.3765746590878  delta_E= -0.0266  |g|= 0.0534  |ddm|= 0.353
HOMO (B2u) = -0.368435737958922  LUMO (B3u) = -0.0370562210896308
cycle= 3 E= -75.3780458200466  delta_E= -0.00147  |g|= 0.0181  |ddm|= 0.0711
HOMO (B2u) = -0.372975542135574  LUMO (B3u) = -0.0415562017768404
cycle= 4 E= -75.3782577251018  delta_E= -0.000212  |g|= 0.000712  |ddm|= 0.0382
HOMO (B2u) = -0.37298632026899  LUMO (B3u) = -0.0417075409102706
cycle= 5 E= -75.3782579293203  delta_E= -2.04e-07  |g|= 8.31e-05  |ddm|= 0.00134
HOMO (B2u) = -0.372958407634988  LUMO (B3u) = -0.0416782676150305
cycle= 6 E= -75.3782579331955  delta_E= -3.88e-09  |g|= 1.36e-05  |ddm|= 0.000138
HOMO (B2u) = -0.372956778075036  LUMO (B3u) = -0.0416799724229735
cycle= 7 E= -75.3782579333153  delta_E= -1.2e-10  |g|= 1.9e-06  |ddm|= 3.4e-05
HOMO (B2u) = -0.372956024408682  LUMO (B3u) = -0.0416794932468783
cycle= 8 E= -75.3782579333177  delta_E= -2.36e-12  |g|= 1.05e-07  |ddm|= 4.17e-06
HOMO (B2u) = -0.37295605202486  LUMO (B3u) = -0.0416795190615329
cycle= 9 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 8.21e-09  |ddm|= 2.09e-07
HOMO (B2u) = -0.372956052956151  LUMO (B3u) = -0.0416795215673734
cycle= 10 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 4.9e-09  |ddm|= 8.06e-09
HOMO (B2u) = -0.372956052899588  LUMO (B3u) = -0.0416795214844616
cycle= 11 E= -75.3782579333177  delta_E= -7.11e-14  |g|= 4.53e-09  |ddm|= 4.16e-09
HOMO (B2u) = -0.372956051584252  LUMO (B3u) = -0.0416795201015728
cycle= 12 E= -75.3782579333177  delta_E= 4.26e-14  |g|= 4.18e-09  |ddm|= 2.1e-09
HOMO (B2u) = -0.372956051455594  LUMO (B3u) = -0.0416795199045204
cycle= 13 E= -75.3782579333176  delta_E= 4.26e-14  |g|= 7.45e-10  |ddm|= 6.42e-09
HOMO (B2u) = -0.372956051505575  LUMO (B3u) = -0.0416795199393674
cycle= 14 E= -75.3782579333176  delta_E=    0  |g|= 6.37e-10  |ddm|= 3.44e-10
HOMO (B2u) = -0.372956051682258  LUMO (B3u) = -0.0416795200611513
cycle= 15 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 5.65e-10  |ddm|= 1.2e-09
HOMO (B2u) = -0.372956051619975  LUMO (B3u) = -0.0416795200925511
cycle= 16 E= -75.3782579333176  delta_E= 2.84e-14  |g|= 6.97e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.372956051666074  LUMO (B3u) = -0.0416795200994602
cycle= 17 E= -75.3782579333176  delta_E=    0  |g|= 7.14e-10  |ddm|= 6.65e-10
HOMO (B2u) = -0.372956051672836  LUMO (B3u) = -0.0416795200906297
cycle= 18 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 4.81e-10  |ddm|= 4.43e-10
HOMO (B2u) = -0.372956051694891  LUMO (B3u) = -0.0416795201120374
cycle= 19 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 3.77e-10  |ddm|= 2.62e-10
HOMO (B2u) = -0.372956051721211  LUMO (B3u) = -0.0416795201364588
cycle= 20 E= -75.3782579333176  delta_E= 5.68e-14  |g|= 2.65e-10  |ddm|= 2e-10
HOMO (B2u) = -0.372956051732298  LUMO (B3u) = -0.0416795201426071
cycle= 21 E= -75.3782579333177  delta_E= -4.26e-14  |g|= 1.52e-10  |ddm|= 2.27e-10
HOMO (B2u) = -0.372956051732463  LUMO (B3u) = -0.0416795201406799
cycle= 22 E= -75.3782579333178  delta_E= -8.53e-14  |g|= 1.33e-10  |ddm|= 6e-11
HOMO (B2u) = -0.37295605173233  LUMO (B3u) = -0.0416795201390882
cycle= 23 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 1.2e-10  |ddm|= 5.32e-11
HOMO (B2u) = -0.372956051729609  LUMO (B3u) = -0.0416795201375015
cycle= 24 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 1.1e-10  |ddm|= 5.13e-11
HOMO (B2u) = -0.372956051732419  LUMO (B3u) = -0.0416795201375896
cycle= 25 E= -75.3782579333177  delta_E=    0  |g|= 8.81e-11  |ddm|= 5.79e-11
HOMO (B2u) = -0.372956051737333  LUMO (B3u) = -0.0416795201391705
Extra cycle  E= -75.3782579333177  delta_E= -2.84e-14  |g|= 2.79e-11  |ddm|= 1.34e-10
converged SCF energy = -75.3782579333177

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpzj3lzfsv
max_memory 4000 MB (current use 8606 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.47259348959  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4837400648394  dE = -0.011146575  S^2 = 0.0000000
               |grad[o]|=0.0791  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4938692512142  dE = -0.010129186  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0566  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5029033629078  dE = -0.0090341117  S^2 = 0.0000000
               |grad[o]|=0.0659  |ddm|=0.0668  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5105744701356  dE = -0.0076711072  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.116  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5162548589576  dE = -0.0056803888  S^2 = 0.0000000
               |grad[o]|=0.051  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5197032282845  dE = -0.0034483693  S^2 = 0.0000000
               |grad[o]|=0.0355  |ddm|=0.0363  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.5210737911268  dE = -0.0013705628  S^2 = 0.0000000
               |grad[o]|=0.0177  |ddm|=0.0636  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5215990209724  dE = -0.00052522985  S^2 = 0.0000000
               |grad[o]|=0.0113  |ddm|=0.115  |maxRot[o]|= 0.02
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5222375907529  dE = -0.00063856978  S^2 = 0.0000000
               |grad[o]|=0.0104  |ddm|=0.0771  |maxRot[o]|=0.033
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5226564301036  dE = -0.00041883935  S^2 = 0.0000000
               |grad[o]|=0.0075  |ddm|=0.064  |maxRot[o]|=0.0335
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5227995243854  dE = -0.00014309428  S^2 = 0.0000000
               |grad[o]|=0.00438  |ddm|=0.0306  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5228528701269  dE = -5.3345742e-05  S^2 = 0.0000000
               |grad[o]|=0.00249  |ddm|=0.0113  |maxRot[o]|=0.0144
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5228636270997  dE = -1.0756973e-05  S^2 = 0.0000000
               |grad[o]|=0.00112  |ddm|=0.00642  |maxRot[o]|=0.00668
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5228655523937  dE = -1.925294e-06  S^2 = 0.0000000
               |grad[o]|=0.000477  |ddm|=0.00264  |maxRot[o]|=0.00287
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5228658807186  dE = -3.2832494e-07  S^2 = 0.0000000
               |grad[o]|=0.000198  |ddm|=0.00108  |maxRot[o]|=0.00119
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5228659357655  dE = -5.5046854e-08  S^2 = 0.0000000
               |grad[o]|=8.19e-05  |ddm|=0.000438  |maxRot[o]|=0.000488
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5228659449377  dE = -9.1722825e-09  S^2 = 0.0000000
               |grad[o]|=3.33e-05  |ddm|=0.000178  |maxRot[o]|=0.000199
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5228659464735  dE = -1.5357529e-09  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.23e-05  |maxRot[o]|=8.09e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.5228659467354  dE = -2.6187763e-10  S^2 = 0.0000000
               |grad[o]|=5.55e-06  |ddm|=2.93e-05  |maxRot[o]|=3.29e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.522865946782  dE = -4.6625814e-11  S^2 = 0.0000000
               |grad[o]|=2.26e-06  |ddm|=1.19e-05  |maxRot[o]|=1.33e-05
2-step CASSCF converged in 20 macro (78 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96757995 1.92636359 1.90257312 1.85304913 0.08669294 0.15330618
 0.05997837 0.05045671]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00942   0.00931  -0.00604   0.00000   0.00000
  0 C 2s       0.58733   0.63316  -0.39276   0.00000  -0.00000
  0 C 3s      -0.02996   0.01840  -0.05304   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69586
  0 C 2py      0.00000   0.00000   0.00000   0.70455   0.00000
  0 C 2pz      0.38981  -0.31366   0.58451   0.00000  -0.00000
  0 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05174
  0 C 3py      0.00000  -0.00000   0.00000   0.04283  -0.00000
  0 C 3pz     -0.02787  -0.00316  -0.00116   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.04212  -0.00000
  0 C 3dz^2    0.03630  -0.01553   0.03447   0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000  -0.11447
 0 C 3dx2-y2  -0.00196   0.00750  -0.00750   0.00000  -0.00000
  1 C 1s       0.00942  -0.00931  -0.00604   0.00000   0.00000
  1 C 2s       0.58733  -0.63316  -0.39276  -0.00000  -0.00000
  1 C 3s      -0.02996  -0.01840  -0.05304  -0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69586
  1 C 2py     -0.00000   0.00000  -0.00000   0.70455   0.00000
  1 C 2pz     -0.38981  -0.31366  -0.58451  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000   0.00000  -0.05174
  1 C 3py     -0.00000  -0.00000  -0.00000   0.04283  -0.00000
  1 C 3pz      0.02787  -0.00316   0.00116   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.04212   0.00000
  1 C 3dz^2    0.03630   0.01553   0.03447  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000   0.11447
 1 C 3dx2-y2  -0.00196  -0.00750  -0.00750   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s       0.00000  -0.00000   0.31126
  0 C 3s       0.00000   0.00000   0.04123
  0 C 2px     -0.00000   0.69686   0.00000
  0 C 2py      0.70644  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.62985
  0 C 3px     -0.00000   0.00767   0.00000
  0 C 3py     -0.02723  -0.00000   0.00000
  0 C 3pz      0.00000   0.00000  -0.05999
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.01434   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000   0.01543
  0 C 3dxz    -0.00000  -0.11967   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02938
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s      -0.00000  -0.00000  -0.31126
  1 C 3s      -0.00000  -0.00000  -0.04123
  1 C 2px     -0.00000  -0.69686  -0.00000
  1 C 2py     -0.70644   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.62985
  1 C 3px      0.00000  -0.00767  -0.00000
  1 C 3py      0.02723   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.05999
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01434  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.01543
  1 C 3dxz    -0.00000  -0.11967   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02938
<CAS-nat-orb|mo-hf>  3  3    0.98488178
<CAS-nat-orb|mo-hf>  4  4    0.99976478
<CAS-nat-orb|mo-hf>  5  5    0.98488756
<CAS-nat-orb|mo-hf>  6  6    0.99934351
<CAS-nat-orb|mo-hf>  7  7    0.94550983
<CAS-nat-orb|mo-hf>  8  8    0.96719800
<CAS-nat-orb|mo-hf>  9  9    0.95784087
<CAS-nat-orb|mo-hf>  10  10    0.82549313
<CAS-nat-orb|mo-hf>  10  11   -0.53364517
CASSCF energy = -75.522865946782
CASCI E = -75.522865946782  E(CI) = -15.884598258803  S^2 = 0.0000000
......production of RDMs took       3.10 sec
......reading the RDM took          0.56 sec
......production of RDMs took      27.82 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.61 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000030869
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000008154
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000765799
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000099091
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000467139
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0001075201
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000358400
HMAT symm error =    0.0148021850
E(MRCI) - E(ref) = -0.1137476803218789 DC = -0.00568539919872501
E(WickICMRCISD)   = -75.63661362710387  E_corr_ci = -0.1137476803218789
E(WickICMRCISD+Q) = -75.6422990263026  E_corr_ci = -0.1194330795206039
Time cost =   2606.367
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 13:58:17 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.693367074944 AA    0.000000000000   0.000000000000   3.200000000000 Bohr   0.0

nuclear repulsion = 11.25
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.6]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1297111.41


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpjcvgo7a8
max_memory 4000 MB (current use 8705 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8853199307072

WARN: Singularity detected in overlap matrix (condition number =  163). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.140132093357862  LUMO (B3u) = -0.140132093357862

WARN: B2u HOMO -0.140132093357862 > system LUMO -0.140132093357862

cycle= 1 E= -75.3423788059563  delta_E= -0.457  |g|= 0.259  |ddm|= 1.53
HOMO (B2u) = -0.402834374141249  LUMO (B3u) = -0.0785386739836394
cycle= 2 E= -75.3685959970364  delta_E= -0.0262  |g|= 0.053  |ddm|= 0.353
HOMO (B2u) = -0.363851731217672  LUMO (B3u) = -0.0346304224365227
cycle= 3 E= -75.3700649559039  delta_E= -0.00147  |g|= 0.0182  |ddm|= 0.0704
HOMO (B2u) = -0.368389012587524  LUMO (B3u) = -0.0391108103436429
cycle= 4 E= -75.3702805696255  delta_E= -0.000216  |g|= 0.000703  |ddm|= 0.0381
HOMO (B2u) = -0.368430097958785  LUMO (B3u) = -0.0392945410036866
cycle= 5 E= -75.37028076688  delta_E= -1.97e-07  |g|= 8.62e-05  |ddm|= 0.00125
HOMO (B2u) = -0.368399790742486  LUMO (B3u) = -0.0392632961118363
cycle= 6 E= -75.3702807710482  delta_E= -4.17e-09  |g|= 1.41e-05  |ddm|= 0.000143
HOMO (B2u) = -0.368398140839552  LUMO (B3u) = -0.0392648663308158
cycle= 7 E= -75.3702807711757  delta_E= -1.27e-10  |g|= 1.92e-06  |ddm|= 3.39e-05
HOMO (B2u) = -0.368397398349103  LUMO (B3u) = -0.0392644368518548
cycle= 8 E= -75.3702807711781  delta_E= -2.4e-12  |g|= 1.08e-07  |ddm|= 4.2e-06
HOMO (B2u) = -0.368397420522505  LUMO (B3u) = -0.0392644560498244
cycle= 9 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 7.49e-09  |ddm|= 2.14e-07
HOMO (B2u) = -0.368397421396854  LUMO (B3u) = -0.0392644584978844
cycle= 10 E= -75.3702807711782  delta_E=    0  |g|= 4.7e-09  |ddm|= 7.64e-09
HOMO (B2u) = -0.368397421278597  LUMO (B3u) = -0.0392644583523347
cycle= 11 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 4.19e-09  |ddm|= 4.06e-09
HOMO (B2u) = -0.368397419986852  LUMO (B3u) = -0.0392644569938277
cycle= 12 E= -75.3702807711782  delta_E= 8.53e-14  |g|= 3.87e-09  |ddm|= 1.95e-09
HOMO (B2u) = -0.368397420308937  LUMO (B3u) = -0.0392644572899772
cycle= 13 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 3.35e-09  |ddm|= 8.42e-10
HOMO (B2u) = -0.368397419921308  LUMO (B3u) = -0.0392644568735344
cycle= 14 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 5.28e-10  |ddm|= 5.01e-09
HOMO (B2u) = -0.368397420132909  LUMO (B3u) = -0.0392644570115384
cycle= 15 E= -75.3702807711782  delta_E=    0  |g|= 5.84e-10  |ddm|= 1.53e-09
HOMO (B2u) = -0.368397420047007  LUMO (B3u) = -0.0392644570360063
cycle= 16 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 7.22e-10  |ddm|= 1.54e-09
HOMO (B2u) = -0.368397420093639  LUMO (B3u) = -0.0392644570384185
cycle= 17 E= -75.3702807711782  delta_E= 4.26e-14  |g|= 7.09e-10  |ddm|= 7.35e-10
HOMO (B2u) = -0.368397420094008  LUMO (B3u) = -0.0392644570253418
cycle= 18 E= -75.3702807711781  delta_E= 2.84e-14  |g|= 5.03e-10  |ddm|= 3.46e-10
HOMO (B2u) = -0.368397420112672  LUMO (B3u) = -0.039264457044093
cycle= 19 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 4.32e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.368397420134434  LUMO (B3u) = -0.0392644570647819
cycle= 20 E= -75.3702807711782  delta_E=    0  |g|= 3.41e-10  |ddm|= 1.43e-10
HOMO (B2u) = -0.368397420141438  LUMO (B3u) = -0.0392644570677939
cycle= 21 E= -75.3702807711781  delta_E= 5.68e-14  |g|= 2.32e-10  |ddm|= 1.8e-10
HOMO (B2u) = -0.368397420150081  LUMO (B3u) = -0.0392644570740909
cycle= 22 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 1.37e-10  |ddm|= 1.65e-10
HOMO (B2u) = -0.368397420149809  LUMO (B3u) = -0.0392644570721904
cycle= 23 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 1.32e-10  |ddm|= 4.11e-11
HOMO (B2u) = -0.368397420145917  LUMO (B3u) = -0.0392644570701002
cycle= 24 E= -75.3702807711781  delta_E= 8.53e-14  |g|= 1.23e-10  |ddm|= 5.38e-11
HOMO (B2u) = -0.368397420148399  LUMO (B3u) = -0.0392644570698313
cycle= 25 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 9.98e-11  |ddm|= 5.61e-11
HOMO (B2u) = -0.368397420149641  LUMO (B3u) = -0.039264457069986
cycle= 26 E= -75.3702807711781  delta_E= 5.68e-14  |g|= 7.85e-11  |ddm|= 4.06e-11
HOMO (B2u) = -0.368397420150146  LUMO (B3u) = -0.0392644570698639
cycle= 27 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 6.42e-11  |ddm|= 2.78e-11
HOMO (B2u) = -0.368397420150628  LUMO (B3u) = -0.0392644570697296
cycle= 28 E= -75.3702807711781  delta_E= 1.42e-14  |g|= 5.01e-11  |ddm|= 2.78e-11
HOMO (B2u) = -0.368397420151192  LUMO (B3u) = -0.0392644570697694
cycle= 29 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 3.86e-11  |ddm|= 2.35e-11
HOMO (B2u) = -0.368397420151568  LUMO (B3u) = -0.0392644570697937
cycle= 30 E= -75.370280771178  delta_E= 1.28e-13  |g|= 3.08e-11  |ddm|= 1.66e-11
HOMO (B2u) = -0.368397420151862  LUMO (B3u) = -0.0392644570698643
cycle= 31 E= -75.370280771178  delta_E= 2.84e-14  |g|= 2.64e-11  |ddm|= 1.02e-11
HOMO (B2u) = -0.36839742015205  LUMO (B3u) = -0.0392644570698703
cycle= 32 E= -75.370280771178  delta_E= 4.26e-14  |g|= 2.21e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.368397420152338  LUMO (B3u) = -0.0392644570698856
cycle= 33 E= -75.3702807711777  delta_E= 2.42e-13  |g|= 1.8e-11  |ddm|= 9.14e-12
HOMO (B2u) = -0.368397420152509  LUMO (B3u) = -0.0392644570698863
cycle= 34 E= -75.3702807711774  delta_E= 3.41e-13  |g|= 1.48e-11  |ddm|= 7.16e-12
HOMO (B2u) = -0.368397420152619  LUMO (B3u) = -0.0392644570698621
cycle= 35 E= -75.3702807711771  delta_E= 2.84e-13  |g|= 1.25e-11  |ddm|= 5.7e-12
HOMO (B2u) = -0.368397420152683  LUMO (B3u) = -0.0392644570698116
cycle= 36 E= -75.3702807711768  delta_E= 2.98e-13  |g|= 1.11e-11  |ddm|= 4.97e-12
HOMO (B2u) = -0.368397420152707  LUMO (B3u) = -0.0392644570697413
cycle= 37 E= -75.3702807711763  delta_E= 4.69e-13  |g|= 9.89e-12  |ddm|= 4.16e-12
HOMO (B2u) = -0.36839742015269  LUMO (B3u) = -0.0392644570696463
cycle= 38 E= -75.3702807711758  delta_E= 5.68e-13  |g|= 8.91e-12  |ddm|= 3.39e-12
HOMO (B2u) = -0.368397420152635  LUMO (B3u) = -0.0392644570695222
cycle= 39 E= -75.3702807711754  delta_E= 3.69e-13  |g|= 8.49e-12  |ddm|= 2.91e-12
HOMO (B2u) = -0.368397420152551  LUMO (B3u) = -0.039264457069372
cycle= 40 E= -75.3702807711751  delta_E= 3.41e-13  |g|= 7.89e-12  |ddm|= 3.21e-12
HOMO (B2u) = -0.368397420152447  LUMO (B3u) = -0.0392644570692037
cycle= 41 E= -75.3702807711748  delta_E= 2.56e-13  |g|= 7.03e-12  |ddm|= 3.39e-12
HOMO (B2u) = -0.368397420152327  LUMO (B3u) = -0.0392644570690246
cycle= 42 E= -75.3702807711746  delta_E= 1.85e-13  |g|= 6.73e-12  |ddm|= 3.26e-12
HOMO (B2u) = -0.368397420152199  LUMO (B3u) = -0.0392644570688407
cycle= 43 E= -75.3702807711746  delta_E= 2.84e-14  |g|= 5.72e-12  |ddm|= 3.61e-12
HOMO (B2u) = -0.368397420152073  LUMO (B3u) = -0.0392644570686593
cycle= 44 E= -75.3702807711743  delta_E= 2.98e-13  |g|= 5.95e-12  |ddm|= 3.06e-12
HOMO (B2u) = -0.368397420151944  LUMO (B3u) = -0.0392644570684746
cycle= 45 E= -75.3702807711742  delta_E= 5.68e-14  |g|= 5.39e-12  |ddm|= 3.57e-12
HOMO (B2u) = -0.368397420151827  LUMO (B3u) = -0.0392644570683019
cycle= 46 E= -75.3702807711742  delta_E= 8.53e-14  |g|= 5.14e-12  |ddm|= 3.46e-12
HOMO (B2u) = -0.368397420151724  LUMO (B3u) = -0.0392644570681461
cycle= 47 E= -75.3702807711738  delta_E= 3.13e-13  |g|= 5.1e-12  |ddm|= 3.37e-12
HOMO (B2u) = -0.368397420151633  LUMO (B3u) = -0.0392644570680039
cycle= 48 E= -75.3702807711735  delta_E= 3.13e-13  |g|= 5.09e-12  |ddm|= 3.1e-12
HOMO (B2u) = -0.368397420151539  LUMO (B3u) = -0.0392644570678587
cycle= 49 E= -75.3702807711731  delta_E= 4.26e-13  |g|= 5.23e-12  |ddm|= 2.94e-12
HOMO (B2u) = -0.368397420151432  LUMO (B3u) = -0.0392644570677009
cycle= 50 E= -75.3702807711728  delta_E= 3.41e-13  |g|= 4.84e-12  |ddm|= 3.35e-12
SCF not converged.
SCF energy = -75.3702807711728

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpjcvgo7a8
max_memory 4000 MB (current use 8705 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4686639234808  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4801679751238  dE = -0.011504052  S^2 = 0.0000000
               |grad[o]|=0.0808  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4904827984378  dE = -0.010314823  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0569  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4994562161942  dE = -0.0089734178  S^2 = 0.0000000
               |grad[o]|=0.0646  |ddm|=0.0513  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5069181130852  dE = -0.0074618969  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0779  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5123693505005  dE = -0.0054512374  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=0.0794  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5156490123868  dE = -0.0032796619  S^2 = 0.0000000
               |grad[o]|=0.0301  |ddm|=0.021  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5168792683235  dE = -0.0012302559  S^2 = 0.0000000
               |grad[o]|=0.015  |ddm|=0.0787  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.517627952846  dE = -0.00074868452  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0721  |maxRot[o]|= 0.04
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5179503323416  dE = -0.0003223795  S^2 = 0.0000000
               |grad[o]|=0.00624  |ddm|=0.0442  |maxRot[o]|=0.0327
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5180291246604  dE = -7.8792319e-05  S^2 = 0.0000000
               |grad[o]|=0.00298  |ddm|=0.0185  |maxRot[o]|=0.0177
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5180431716693  dE = -1.4047009e-05  S^2 = 0.0000000
               |grad[o]|=0.00127  |ddm|=0.00706  |maxRot[o]|=0.00779
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5180453689781  dE = -2.1973088e-06  S^2 = 0.0000000
               |grad[o]|=0.000508  |ddm|=0.0027  |maxRot[o]|=0.00313
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5180456957243  dE = -3.2674616e-07  S^2 = 0.0000000
               |grad[o]|=0.000197  |ddm|=0.00103  |maxRot[o]|=0.00121
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5180457433475  dE = -4.7623161e-08  S^2 = 0.0000000
               |grad[o]|=7.68e-05  |ddm|=0.000394  |maxRot[o]|=0.000466
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5180457502021  dE = -6.854691e-09  S^2 = 0.0000000
               |grad[o]|=2.93e-05  |ddm|=0.00015  |maxRot[o]|=0.000178
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5180457511758  dE = -9.7361408e-10  S^2 = 0.0000000
               |grad[o]|=1.12e-05  |ddm|=5.7e-05  |maxRot[o]|=6.76e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5180457513068  dE = -1.3100987e-10  S^2 = 0.0000000
               |grad[o]|=4.23e-06  |ddm|=2.16e-05  |maxRot[o]|=2.54e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5180457513231  dE = -1.6314061e-11  S^2 = 0.0000000
               |grad[o]|=1.6e-06  |ddm|=8.15e-06  |maxRot[o]|=9.66e-06
2-step CASSCF converged in 18 macro (72 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9663057  1.92713079 1.90282926 1.84406997 0.0836569  0.16227412
 0.0596417  0.05409157]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00972   0.00945  -0.00589   0.00000   0.00000
  0 C 2s       0.59726   0.63748  -0.37752  -0.00000   0.00000
  0 C 3s      -0.02696   0.01811  -0.05147  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000  -0.00000   0.00000   0.69538
  0 C 2py     -0.00000   0.00000   0.00000   0.70451   0.00000
  0 C 2pz      0.37495  -0.30481   0.59459   0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.05355
  0 C 3py     -0.00000   0.00000   0.00000   0.04456  -0.00000
  0 C 3pz     -0.02582  -0.00292  -0.00005  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.04098  -0.00000
  0 C 3dz^2    0.03462  -0.01515   0.03455  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11653
 0 C 3dx2-y2  -0.00172   0.00737  -0.00749  -0.00000   0.00000
  1 C 1s       0.00972  -0.00945  -0.00589   0.00000   0.00000
  1 C 2s       0.59726  -0.63748  -0.37752  -0.00000   0.00000
  1 C 3s      -0.02696  -0.01811  -0.05147   0.00000   0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69538
  1 C 2py      0.00000  -0.00000   0.00000   0.70451  -0.00000
  1 C 2pz     -0.37495  -0.30481  -0.59459  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00000  -0.05355
  1 C 3py      0.00000  -0.00000  -0.00000   0.04456  -0.00000
  1 C 3pz      0.02582  -0.00292   0.00005  -0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.04098   0.00000
  1 C 3dz^2    0.03462   0.01515   0.03455   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000  -0.00000   0.00000   0.11653
 1 C 3dx2-y2  -0.00172  -0.00737  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s      -0.00000   0.00000   0.30262
  0 C 3s      -0.00000   0.00000   0.04028
  0 C 2px      0.00000   0.69699  -0.00000
  0 C 2py      0.70653   0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.63446
  0 C 3px      0.00000   0.00537   0.00000
  0 C 3py     -0.02507   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05718
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01392   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01415
  0 C 3dxz     0.00000  -0.11904   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02809
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000   0.00000  -0.30262
  1 C 3s       0.00000  -0.00000  -0.04028
  1 C 2px     -0.00000  -0.69699  -0.00000
  1 C 2py     -0.70653  -0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.63446
  1 C 3px     -0.00000  -0.00537   0.00000
  1 C 3py      0.02507  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.05718
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.01392   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01415
  1 C 3dxz     0.00000  -0.11904  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02809
<CAS-nat-orb|mo-hf>  3  3    0.98713996
<CAS-nat-orb|mo-hf>  4  4    0.99975825
<CAS-nat-orb|mo-hf>  5  5    0.98714928
<CAS-nat-orb|mo-hf>  6  6    0.99929981
<CAS-nat-orb|mo-hf>  7  7    0.94370155
<CAS-nat-orb|mo-hf>  8  8    0.96917400
<CAS-nat-orb|mo-hf>  9  9    0.95823418
<CAS-nat-orb|mo-hf>  10  10    0.84381041
<CAS-nat-orb|mo-hf>  10  11   -0.50815316
CASSCF energy = -75.5180457513231
CASCI E = -75.5180457513231  E(CI) = -15.8005832006271  S^2 = 0.0000000
......production of RDMs took       2.16 sec
......reading the RDM took          0.45 sec
......production of RDMs took      30.95 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.53 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000014465
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000003821
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000714082
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000089407
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000437813
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000978726
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000326242
HMAT symm error =    0.0138720267
E(MRCI) - E(ref) = -0.1138917265227946 DC = -0.005723407998981371
E(WickICMRCISD)   = -75.63193747784588  E_corr_ci = -0.1138917265227946
E(WickICMRCISD+Q) = -75.63766088584487  E_corr_ci = -0.1196151345217759
Time cost =   2602.734
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 14:41:40 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.719825935490 AA    0.000000000000   0.000000000000   3.250000000000 Bohr   0.0

nuclear repulsion = 11.0769230769231
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.625]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1340441.38


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp3wkw6d6v
max_memory 4000 MB (current use 8705 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8631164371269

WARN: Singularity detected in overlap matrix (condition number =  151). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.13569696344616  LUMO (B3u) = -0.13569696344616

WARN: B2u HOMO -0.13569696344616 > system LUMO -0.13569696344616

cycle= 1 E= -75.3346710578886  delta_E= -0.472  |g|= 0.257  |ddm|= 1.52
HOMO (B2u) = -0.397829563278946  LUMO (B3u) = -0.0755897093543543
cycle= 2 E= -75.360485940034  delta_E= -0.0258  |g|= 0.0524  |ddm|= 0.352
HOMO (B2u) = -0.359424194210821  LUMO (B3u) = -0.032286636697359
cycle= 3 E= -75.3619492644577  delta_E= -0.00146  |g|= 0.0182  |ddm|= 0.0697
HOMO (B2u) = -0.363955951245317  LUMO (B3u) = -0.0367454491314097
cycle= 4 E= -75.3621677667453  delta_E= -0.000219  |g|= 0.000695  |ddm|= 0.0379
HOMO (B2u) = -0.364024863853047  LUMO (B3u) = -0.0369588213878714
cycle= 5 E= -75.3621679575039  delta_E= -1.91e-07  |g|= 8.98e-05  |ddm|= 0.00116
HOMO (B2u) = -0.363992517085415  LUMO (B3u) = -0.0369261206635528
cycle= 6 E= -75.3621679620312  delta_E= -4.53e-09  |g|= 1.46e-05  |ddm|= 0.000149
HOMO (B2u) = -0.363990782245943  LUMO (B3u) = -0.0369275152560753
cycle= 7 E= -75.3621679621673  delta_E= -1.36e-10  |g|= 1.94e-06  |ddm|= 3.41e-05
HOMO (B2u) = -0.363990060624691  LUMO (B3u) = -0.0369271360119255
cycle= 8 E= -75.3621679621696  delta_E= -2.34e-12  |g|= 1.11e-07  |ddm|= 4.19e-06
HOMO (B2u) = -0.363990078365052  LUMO (B3u) = -0.0369271500510231
cycle= 9 E= -75.3621679621697  delta_E= -1.42e-13  |g|= 7.05e-09  |ddm|= 2.21e-07
HOMO (B2u) = -0.363990079133924  LUMO (B3u) = -0.0369271524019206
cycle= 10 E= -75.3621679621697  delta_E= 7.11e-14  |g|= 4.68e-09  |ddm|= 7.45e-09
HOMO (B2u) = -0.363990078969656  LUMO (B3u) = -0.0369271522093122
cycle= 11 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 4e-09  |ddm|= 4e-09
HOMO (B2u) = -0.363990077683332  LUMO (B3u) = -0.0369271508560225
cycle= 12 E= -75.3621679621697  delta_E=    0  |g|= 3.68e-09  |ddm|= 1.85e-09
HOMO (B2u) = -0.363990078039854  LUMO (B3u) = -0.0369271511908609
cycle= 13 E= -75.3621679621697  delta_E=    0  |g|= 3.23e-09  |ddm|= 8.5e-10
HOMO (B2u) = -0.36399007765768  LUMO (B3u) = -0.0369271508037113
cycle= 14 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 4.13e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.363990077851708  LUMO (B3u) = -0.0369271509288766
cycle= 15 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 5.37e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.36399007776467  LUMO (B3u) = -0.0369271509415074
cycle= 16 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 6.62e-10  |ddm|= 1.35e-09
HOMO (B2u) = -0.363990077806214  LUMO (B3u) = -0.036927150939841
cycle= 17 E= -75.3621679621697  delta_E= -4.26e-14  |g|= 6.49e-10  |ddm|= 7.18e-10
HOMO (B2u) = -0.363990077800378  LUMO (B3u) = -0.0369271509230861
cycle= 18 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 4.6e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.363990077815704  LUMO (B3u) = -0.0369271509392643
cycle= 19 E= -75.3621679621697  delta_E=    0  |g|= 3.99e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.363990077833269  LUMO (B3u) = -0.0369271509566507
cycle= 20 E= -75.3621679621697  delta_E=    0  |g|= 3.18e-10  |ddm|= 1.18e-10
HOMO (B2u) = -0.363990077836359  LUMO (B3u) = -0.0369271509567352
cycle= 21 E= -75.3621679621697  delta_E= 4.26e-14  |g|= 2.17e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.363990077841869  LUMO (B3u) = -0.0369271509608679
cycle= 22 E= -75.3621679621696  delta_E= 4.26e-14  |g|= 1.25e-10  |ddm|= 1.53e-10
HOMO (B2u) = -0.363990077841468  LUMO (B3u) = -0.0369271509589843
cycle= 23 E= -75.3621679621698  delta_E= -1.99e-13  |g|= 1.23e-10  |ddm|= 2.67e-11
HOMO (B2u) = -0.363990077837804  LUMO (B3u) = -0.0369271509570181
cycle= 24 E= -75.3621679621698  delta_E= 5.68e-14  |g|= 1.12e-10  |ddm|= 4.78e-11
HOMO (B2u) = -0.363990077839662  LUMO (B3u) = -0.0369271509564477
cycle= 25 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 9.11e-11  |ddm|= 4.87e-11
HOMO (B2u) = -0.363990077840184  LUMO (B3u) = -0.0369271509561633
cycle= 26 E= -75.3621679621698  delta_E= -2.84e-14  |g|= 7.24e-11  |ddm|= 3.25e-11
HOMO (B2u) = -0.363990077840201  LUMO (B3u) = -0.0369271509557396
cycle= 27 E= -75.3621679621698  delta_E=    0  |g|= 6.03e-11  |ddm|= 2.13e-11
HOMO (B2u) = -0.363990077840967  LUMO (B3u) = -0.0369271509550103
Extra cycle  E= -75.3621679621698  delta_E=    0  |g|= 2.17e-11  |ddm|= 7.56e-11
converged SCF energy = -75.3621679621698

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp3wkw6d6v
max_memory 4000 MB (current use 8705 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4646530045341  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4765381406302  dE = -0.011885136  S^2 = 0.0000000
               |grad[o]|=0.0827  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4870582692839  dE = -0.010520129  S^2 = 0.0000000
               |grad[o]|=0.0737  |ddm|=0.0593  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4959969238188  dE = -0.0089386545  S^2 = 0.0000000
               |grad[o]|=0.0638  |ddm|=0.0441  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5032579692824  dE = -0.0072610455  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.0593  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5084987533354  dE = -0.0052407841  S^2 = 0.0000000
               |grad[o]|=0.0416  |ddm|=0.0623  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5116053103402  dE = -0.003106557  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5125696295193  dE = -0.00096431918  S^2 = 0.0000000
               |grad[o]|=0.0119  |ddm|=0.0749  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5130320960254  dE = -0.00046246651  S^2 = 0.0000000
               |grad[o]|=0.00731  |ddm|=0.0414  |maxRot[o]|=0.0388
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5131336072386  dE = -0.00010151121  S^2 = 0.0000000
               |grad[o]|=0.00337  |ddm|=0.0206  |maxRot[o]|= 0.02
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5131512745914  dE = -1.7667353e-05  S^2 = 0.0000000
               |grad[o]|=0.00142  |ddm|=0.00714  |maxRot[o]|=0.00886
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5131537381215  dE = -2.4635301e-06  S^2 = 0.0000000
               |grad[o]|=0.00054  |ddm|=0.00275  |maxRot[o]|=0.00336
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5131540652688  dE = -3.2714736e-07  S^2 = 0.0000000
               |grad[o]|=0.000199  |ddm|=0.000997  |maxRot[o]|=0.00123
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5131541079563  dE = -4.2687432e-08  S^2 = 0.0000000
               |grad[o]|=7.29e-05  |ddm|=0.00036  |maxRot[o]|=0.000447
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5131541134723  dE = -5.5160001e-09  S^2 = 0.0000000
               |grad[o]|=2.64e-05  |ddm|=0.000129  |maxRot[o]|=0.000161
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5131541141778  dE = -7.0548367e-10  S^2 = 0.0000000
               |grad[o]|=9.54e-06  |ddm|=4.66e-05  |maxRot[o]|=5.81e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5131541142659  dE = -8.8107299e-11  S^2 = 0.0000000
               |grad[o]|=3.46e-06  |ddm|=1.68e-05  |maxRot[o]|=2.09e-05
2-step CASSCF converged in 16 macro (65 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96506513 1.92787019 1.90242017 1.83461645 0.08106129 0.17170011
 0.05932554 0.05794111]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01001   0.00958  -0.00569   0.00000   0.00000
  0 C 2s       0.60769   0.64161  -0.36054  -0.00000   0.00000
  0 C 3s      -0.02394   0.01781  -0.04989  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69498
  0 C 2py     -0.00000   0.00000  -0.00000   0.70448  -0.00000
  0 C 2pz      0.35831  -0.29606   0.60517  -0.00000  -0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.05520
  0 C 3py     -0.00000   0.00000   0.00000   0.04615   0.00000
  0 C 3pz     -0.02386  -0.00271   0.00109  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03981  -0.00000
  0 C 3dz^2    0.03287  -0.01476   0.03469  -0.00000  -0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.11816
 0 C 3dx2-y2  -0.00145   0.00725  -0.00749   0.00000  -0.00000
  1 C 1s       0.01001  -0.00958  -0.00569   0.00000   0.00000
  1 C 2s       0.60769  -0.64161  -0.36054   0.00000   0.00000
  1 C 3s      -0.02394  -0.01781  -0.04989   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69498
  1 C 2py      0.00000  -0.00000   0.00000   0.70448   0.00000
  1 C 2pz     -0.35831  -0.29606  -0.60517  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05520
  1 C 3py      0.00000  -0.00000  -0.00000   0.04615   0.00000
  1 C 3pz      0.02386  -0.00271  -0.00109  -0.00000   0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03981  -0.00000
  1 C 3dz^2    0.03287   0.01476   0.03469   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11816
 1 C 3dx2-y2  -0.00145  -0.00725  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00052
  0 C 2s      -0.00000   0.00000   0.29408
  0 C 3s      -0.00000  -0.00000   0.03931
  0 C 2px      0.00000   0.69713  -0.00000
  0 C 2py      0.70661   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.63885
  0 C 3px      0.00000   0.00311  -0.00000
  0 C 3py     -0.02293   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05440
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01349   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.01292
  0 C 3dxz     0.00000  -0.11834  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02684
  1 C 1s       0.00000   0.00000   0.00052
  1 C 2s       0.00000   0.00000  -0.29408
  1 C 3s       0.00000   0.00000  -0.03931
  1 C 2px     -0.00000  -0.69713   0.00000
  1 C 2py     -0.70661  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.63885
  1 C 3px     -0.00000  -0.00311   0.00000
  1 C 3py      0.02293  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.05440
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01349   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.01292
  1 C 3dxz     0.00000  -0.11834  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02684
<CAS-nat-orb|mo-hf>  3  3    0.98958164
<CAS-nat-orb|mo-hf>  4  4    0.99975150
<CAS-nat-orb|mo-hf>  5  5    0.98959418
<CAS-nat-orb|mo-hf>  6  6    0.99925429
<CAS-nat-orb|mo-hf>  7  7    0.94209803
<CAS-nat-orb|mo-hf>  8  8    0.97102423
<CAS-nat-orb|mo-hf>  9  9    0.95858984
<CAS-nat-orb|mo-hf>  10  10    0.86001481
<CAS-nat-orb|mo-hf>  10  11   -0.48380374
CASSCF energy = -75.5131541142659
CASCI E = -75.5131541142659  E(CI) = -15.7189307601241  S^2 = 0.0000000
......production of RDMs took       2.16 sec
......reading the RDM took          0.47 sec
......production of RDMs took      29.21 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.96 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000040694
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000010749
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000622091
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000080149
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000380206
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000924554
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000308185
HMAT symm error =    0.0118224633
E(MRCI) - E(ref) = -0.1140510491127742 DC = -0.005763259283093318
E(WickICMRCISD)   = -75.62720516337863  E_corr_ci = -0.1140510491127742
E(WickICMRCISD+Q) = -75.63296842266173  E_corr_ci = -0.1198143083958675
Time cost =   2517.388
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 15:23:37 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.746284796036 AA    0.000000000000   0.000000000000   3.300000000000 Bohr   0.0

nuclear repulsion = 10.9090909090909
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.65]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1382444.00


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpu7195gtf
max_memory 4000 MB (current use 8705 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8422560677929

WARN: Singularity detected in overlap matrix (condition number =  141). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.131475269334873  LUMO (B3u) = -0.131475269334873

WARN: B2u HOMO -0.131475269334873 > system LUMO -0.131475269334873

cycle= 1 E= -75.3268751185368  delta_E= -0.485  |g|= 0.254  |ddm|= 1.52
HOMO (B2u) = -0.392977692990135  LUMO (B3u) = -0.0727206501017197
cycle= 2 E= -75.3522841088372  delta_E= -0.0254  |g|= 0.0519  |ddm|= 0.352
HOMO (B2u) = -0.355147584178281  LUMO (B3u) = -0.0300222920891322
cycle= 3 E= -75.3537386656222  delta_E= -0.00145  |g|= 0.0182  |ddm|= 0.0689
HOMO (B2u) = -0.359671017046592  LUMO (B3u) = -0.0344578300630369
cycle= 4 E= -75.3539592586542  delta_E= -0.000221  |g|= 0.000688  |ddm|= 0.0377
HOMO (B2u) = -0.359764894042611  LUMO (B3u) = -0.0346976899212323
cycle= 5 E= -75.3539594435199  delta_E= -1.85e-07  |g|= 9.37e-05  |ddm|= 0.00109
HOMO (B2u) = -0.359730880125603  LUMO (B3u) = -0.0346640305640357
cycle= 6 E= -75.3539594484633  delta_E= -4.94e-09  |g|= 1.51e-05  |ddm|= 0.000157
HOMO (B2u) = -0.359729026578329  LUMO (B3u) = -0.0346652386509433
cycle= 7 E= -75.3539594486084  delta_E= -1.45e-10  |g|= 1.94e-06  |ddm|= 3.44e-05
HOMO (B2u) = -0.359728331016699  LUMO (B3u) = -0.0346649076942356
cycle= 8 E= -75.3539594486108  delta_E= -2.47e-12  |g|= 1.14e-07  |ddm|= 4.16e-06
HOMO (B2u) = -0.359728345182822  LUMO (B3u) = -0.0346649176989655
cycle= 9 E= -75.3539594486108  delta_E=    0  |g|= 6.92e-09  |ddm|= 2.29e-07
HOMO (B2u) = -0.359728345811295  LUMO (B3u) = -0.0346649199293697
cycle= 10 E= -75.3539594486108  delta_E=    0  |g|= 4.84e-09  |ddm|= 7.44e-09
HOMO (B2u) = -0.359728345628422  LUMO (B3u) = -0.0346649197213792
cycle= 11 E= -75.3539594486108  delta_E=    0  |g|= 3.95e-09  |ddm|= 4.04e-09
HOMO (B2u) = -0.359728344324567  LUMO (B3u) = -0.0346649183507518
cycle= 12 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 3.62e-09  |ddm|= 1.85e-09
HOMO (B2u) = -0.359728344700651  LUMO (B3u) = -0.0346649187076226
cycle= 13 E= -75.3539594486109  delta_E= -5.68e-14  |g|= 3.21e-09  |ddm|= 9.28e-10
HOMO (B2u) = -0.359728344323037  LUMO (B3u) = -0.0346649183510421
cycle= 14 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 3.93e-10  |ddm|= 4.6e-09
HOMO (B2u) = -0.359728344496119  LUMO (B3u) = -0.0346649184551793
cycle= 15 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 5.5e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.359728344402529  LUMO (B3u) = -0.0346649184609871
cycle= 16 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 6.5e-10  |ddm|= 1.26e-09
HOMO (B2u) = -0.35972834444523  LUMO (B3u) = -0.0346649184557793
cycle= 17 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 6.39e-10  |ddm|= 8.11e-10
HOMO (B2u) = -0.359728344433413  LUMO (B3u) = -0.0346649184359331
cycle= 18 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 4.57e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.359728344445349  LUMO (B3u) = -0.0346649184497288
cycle= 19 E= -75.3539594486108  delta_E= -4.26e-14  |g|= 3.95e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.359728344459183  LUMO (B3u) = -0.0346649184644592
cycle= 20 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 3.17e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.359728344458614  LUMO (B3u) = -0.034664918461953
cycle= 21 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 2.19e-10  |ddm|= 1.63e-10
HOMO (B2u) = -0.359728344461003  LUMO (B3u) = -0.0346649184640458
cycle= 22 E= -75.3539594486109  delta_E= -8.53e-14  |g|= 1.27e-10  |ddm|= 1.59e-10
HOMO (B2u) = -0.359728344460419  LUMO (B3u) = -0.0346649184621536
cycle= 23 E= -75.3539594486109  delta_E= 1.42e-14  |g|= 1.24e-10  |ddm|= 1.77e-11
HOMO (B2u) = -0.359728344456517  LUMO (B3u) = -0.0346649184600727
cycle= 24 E= -75.3539594486109  delta_E= 4.26e-14  |g|= 1.11e-10  |ddm|= 4.7e-11
HOMO (B2u) = -0.359728344457844  LUMO (B3u) = -0.0346649184591156
cycle= 25 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 9.05e-11  |ddm|= 4.76e-11
HOMO (B2u) = -0.359728344457601  LUMO (B3u) = -0.0346649184583866
cycle= 26 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 7.26e-11  |ddm|= 3.22e-11
HOMO (B2u) = -0.359728344457093  LUMO (B3u) = -0.0346649184576503
cycle= 27 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 6.1e-11  |ddm|= 2.14e-11
HOMO (B2u) = -0.359728344456736  LUMO (B3u) = -0.0346649184570218
cycle= 28 E= -75.3539594486109  delta_E= -5.68e-14  |g|= 4.86e-11  |ddm|= 2.39e-11
HOMO (B2u) = -0.359728344456624  LUMO (B3u) = -0.0346649184566529
cycle= 29 E= -75.3539594486109  delta_E= 2.84e-14  |g|= 3.78e-11  |ddm|= 2.12e-11
HOMO (B2u) = -0.359728344456491  LUMO (B3u) = -0.0346649184563495
cycle= 30 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 3.04e-11  |ddm|= 1.52e-11
HOMO (B2u) = -0.359728344456458  LUMO (B3u) = -0.0346649184561895
cycle= 31 E= -75.3539594486107  delta_E= 1.71e-13  |g|= 2.69e-11  |ddm|= 8.54e-12
HOMO (B2u) = -0.359728344456354  LUMO (B3u) = -0.0346649184559984
cycle= 32 E= -75.3539594486106  delta_E= 9.95e-14  |g|= 2.31e-11  |ddm|= 8.76e-12
HOMO (B2u) = -0.359728344456366  LUMO (B3u) = -0.0346649184558377
cycle= 33 E= -75.3539594486103  delta_E= 2.13e-13  |g|= 1.99e-11  |ddm|= 7.83e-12
HOMO (B2u) = -0.359728344456301  LUMO (B3u) = -0.0346649184556869
cycle= 34 E= -75.3539594486099  delta_E= 4.83e-13  |g|= 1.75e-11  |ddm|= 6.31e-12
HOMO (B2u) = -0.359728344456219  LUMO (B3u) = -0.0346649184555366
cycle= 35 E= -75.3539594486094  delta_E= 4.55e-13  |g|= 1.59e-11  |ddm|= 5.34e-12
HOMO (B2u) = -0.359728344456119  LUMO (B3u) = -0.0346649184553749
cycle= 36 E= -75.3539594486089  delta_E= 5.4e-13  |g|= 1.44e-11  |ddm|= 5.05e-12
HOMO (B2u) = -0.359728344456005  LUMO (B3u) = -0.0346649184552067
cycle= 37 E= -75.3539594486084  delta_E= 4.83e-13  |g|= 1.33e-11  |ddm|= 4.29e-12
HOMO (B2u) = -0.35972834445587  LUMO (B3u) = -0.0346649184550283
cycle= 38 E= -75.3539594486077  delta_E= 6.54e-13  |g|= 1.27e-11  |ddm|= 3.76e-12
HOMO (B2u) = -0.359728344455712  LUMO (B3u) = -0.0346649184548307
cycle= 39 E= -75.3539594486072  delta_E= 4.83e-13  |g|= 1.16e-11  |ddm|= 4e-12
HOMO (B2u) = -0.359728344455543  LUMO (B3u) = -0.0346649184546254
cycle= 40 E= -75.3539594486068  delta_E= 3.98e-13  |g|= 9.9e-12  |ddm|= 4.18e-12
HOMO (B2u) = -0.359728344455365  LUMO (B3u) = -0.0346649184544084
cycle= 41 E= -75.3539594486066  delta_E= 2.56e-13  |g|= 8.28e-12  |ddm|= 4.23e-12
HOMO (B2u) = -0.359728344455175  LUMO (B3u) = -0.0346649184541828
cycle= 42 E= -75.3539594486063  delta_E= 2.98e-13  |g|= 7.36e-12  |ddm|= 3.49e-12
HOMO (B2u) = -0.359728344454991  LUMO (B3u) = -0.034664918453961
cycle= 43 E= -75.3539594486061  delta_E= 1.85e-13  |g|= 6.55e-12  |ddm|= 3.45e-12
HOMO (B2u) = -0.359728344454816  LUMO (B3u) = -0.0346649184537467
cycle= 44 E= -75.3539594486057  delta_E= 4.55e-13  |g|= 6.28e-12  |ddm|= 2.67e-12
HOMO (B2u) = -0.359728344454635  LUMO (B3u) = -0.0346649184535258
cycle= 45 E= -75.3539594486054  delta_E= 2.27e-13  |g|= 5.83e-12  |ddm|= 3.11e-12
HOMO (B2u) = -0.359728344454466  LUMO (B3u) = -0.0346649184533132
cycle= 46 E= -75.353959448605  delta_E= 3.84e-13  |g|= 5.52e-12  |ddm|= 3.18e-12
HOMO (B2u) = -0.359728344454309  LUMO (B3u) = -0.0346649184531119
cycle= 47 E= -75.3539594486046  delta_E= 4.55e-13  |g|= 5.33e-12  |ddm|= 2.7e-12
HOMO (B2u) = -0.359728344454148  LUMO (B3u) = -0.0346649184529048
cycle= 48 E= -75.353959448604  delta_E= 5.68e-13  |g|= 5.09e-12  |ddm|= 2.76e-12
HOMO (B2u) = -0.359728344453985  LUMO (B3u) = -0.0346649184526947
cycle= 49 E= -75.3539594486037  delta_E= 2.98e-13  |g|= 5.06e-12  |ddm|= 3.01e-12
HOMO (B2u) = -0.35972834445382  LUMO (B3u) = -0.034664918452485
cycle= 50 E= -75.3539594486035  delta_E= 1.99e-13  |g|= 4.36e-12  |ddm|= 3.58e-12
SCF not converged.
SCF energy = -75.3539594486035

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpu7195gtf
max_memory 4000 MB (current use 8705 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4605852262859  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4728677550183  dE = -0.012282529  S^2 = 0.0000000
               |grad[o]|=0.0845  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4835984582753  dE = -0.010730703  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0627  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4925028379301  dE = -0.0089043797  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.0412  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4995495448622  dE = -0.0070467069  S^2 = 0.0000000
               |grad[o]|=0.0512  |ddm|=0.0504  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5045660816989  dE = -0.0050165368  S^2 = 0.0000000
               |grad[o]|=0.0382  |ddm|=0.0583  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5070424086244  dE = -0.0024763269  S^2 = 0.0000000
               |grad[o]|=0.0222  |ddm|=0.0398  |maxRot[o]|= 0.06
macro iter 7 (4 JK  0 micro), CASSCF E = -75.507847748817  dE = -0.00080534019  S^2 = 0.0000000
               |grad[o]|=0.0105  |ddm|=0.0554  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5081673379915  dE = -0.00031958917  S^2 = 0.0000000
               |grad[o]|=0.00584  |ddm|=0.0262  |maxRot[o]|=0.0343
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5082201455226  dE = -5.2807531e-05  S^2 = 0.0000000
               |grad[o]|=0.0024  |ddm|=0.0133  |maxRot[o]|=0.0152
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5082271294187  dE = -6.9838961e-06  S^2 = 0.0000000
               |grad[o]|=0.000905  |ddm|=0.0045  |maxRot[o]|=0.00571
macro iter 11 (3 JK  0 micro), CASSCF E = -75.508227984407  dE = -8.5498829e-07  S^2 = 0.0000000
               |grad[o]|=0.00032  |ddm|=0.00156  |maxRot[o]|=0.00201
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5082280860976  dE = -1.0169056e-07  S^2 = 0.0000000
               |grad[o]|=0.000113  |ddm|=0.000537  |maxRot[o]|=0.000697
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5082280980434  dE = -1.1945843e-08  S^2 = 0.0000000
               |grad[o]|=3.94e-05  |ddm|=0.000185  |maxRot[o]|=0.000241
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5082280994332  dE = -1.389779e-09  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=6.38e-05  |maxRot[o]|=8.29e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5082280995928  dE = -1.5961632e-10  S^2 = 0.0000000
               |grad[o]|=4.72e-06  |ddm|=2.19e-05  |maxRot[o]|=2.85e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.508228099607  dE = -1.4196644e-11  S^2 = 0.0000000
               |grad[o]|=1.58e-06  |ddm|=6.98e-06  |maxRot[o]|=9.45e-06
2-step CASSCF converged in 16 macro (64 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96387359 1.92858696 1.90144123 1.82466896 0.07878277 0.18160433
 0.05902031 0.06202185]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01031   0.00970  -0.00544   0.00000   0.00000
  0 C 2s       0.61830   0.64554  -0.34208   0.00000  -0.00000
  0 C 3s      -0.02094   0.01752  -0.04828   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69463
  0 C 2py      0.00000  -0.00000   0.00000   0.70445   0.00000
  0 C 2pz      0.34017  -0.28744   0.61591   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.05672
  0 C 3py     -0.00000   0.00000   0.00000   0.04759  -0.00000
  0 C 3pz     -0.02200  -0.00251   0.00227   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.03863  -0.00000
  0 C 3dz^2    0.03108  -0.01437   0.03487   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.11945
 0 C 3dx2-y2  -0.00117   0.00712  -0.00747   0.00000  -0.00000
  1 C 1s       0.01031  -0.00970  -0.00544   0.00000   0.00000
  1 C 2s       0.61830  -0.64554  -0.34208   0.00000   0.00000
  1 C 3s      -0.02094  -0.01752  -0.04828  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69463
  1 C 2py      0.00000  -0.00000  -0.00000   0.70445   0.00000
  1 C 2pz     -0.34017  -0.28744  -0.61591   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.05672
  1 C 3py     -0.00000   0.00000  -0.00000   0.04759  -0.00000
  1 C 3pz      0.02200  -0.00251  -0.00227   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.03863   0.00000
  1 C 3dz^2    0.03108   0.01437   0.03487  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.11945
 1 C 3dx2-y2  -0.00117  -0.00712  -0.00747   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00049
  0 C 2s       0.00000  -0.00000   0.28563
  0 C 3s       0.00000  -0.00000   0.03833
  0 C 2px     -0.00000   0.69726  -0.00000
  0 C 2py      0.70668  -0.00000   0.00000
  0 C 2pz      0.00000  -0.00000   0.64303
  0 C 3px     -0.00000   0.00091  -0.00000
  0 C 3py     -0.02081  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.05165
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.01306  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.01176
  0 C 3dxz    -0.00000  -0.11759  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02562
  1 C 1s       0.00000   0.00000   0.00049
  1 C 2s      -0.00000   0.00000  -0.28563
  1 C 3s      -0.00000   0.00000  -0.03833
  1 C 2px      0.00000  -0.69726  -0.00000
  1 C 2py     -0.70668   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.64303
  1 C 3px      0.00000  -0.00091   0.00000
  1 C 3py      0.02081   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.05165
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01306  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.01176
  1 C 3dxz    -0.00000  -0.11759  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.02562
<CAS-nat-orb|mo-hf>  3  3    0.99201757
<CAS-nat-orb|mo-hf>  4  4    0.99974451
<CAS-nat-orb|mo-hf>  5  5    0.99203281
<CAS-nat-orb|mo-hf>  6  6    0.99920694
<CAS-nat-orb|mo-hf>  7  7    0.94066257
<CAS-nat-orb|mo-hf>  8  8    0.97275729
<CAS-nat-orb|mo-hf>  9  9    0.95891046
<CAS-nat-orb|mo-hf>  10  10    0.87431675
<CAS-nat-orb|mo-hf>  10  11   -0.46069474
CASSCF energy = -75.508228099607
CASCI E = -75.508228099607  E(CI) = -15.6395664158294  S^2 = 0.0000000
......production of RDMs took       3.39 sec
......reading the RDM took          0.45 sec
......production of RDMs took      29.23 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.47 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000040637
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000010734
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000505646
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000065551
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000308994
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000757957
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000252652
HMAT symm error =    0.0113762487
E(MRCI) - E(ref) = -0.1142217868801652 DC = -0.005804524708481936
E(WickICMRCISD)   = -75.62244988648717  E_corr_ci = -0.1142217868801652
E(WickICMRCISD+Q) = -75.62825441119566  E_corr_ci = -0.1200263115886471
Time cost =   2596.139
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 16:06:54 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.772743656582 AA    0.000000000000   0.000000000000   3.350000000000 Bohr   0.0

nuclear repulsion = 10.7462686567164
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.675]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1425948.17


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp3ycvfo1n
max_memory 4000 MB (current use 8705 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8226756263582

WARN: Singularity detected in overlap matrix (condition number =  131). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.127455322759626  LUMO (B3u) = -0.127455322759626

WARN: B2u HOMO -0.127455322759626 > system LUMO -0.127455322759626

cycle= 1 E= -75.3190207821596  delta_E= -0.496  |g|= 0.252  |ddm|= 1.51
HOMO (B2u) = -0.38827677967466  LUMO (B3u) = -0.069932874908027
cycle= 2 E= -75.3440245529482  delta_E= -0.025  |g|= 0.0513  |ddm|= 0.351
HOMO (B2u) = -0.351016713810031  LUMO (B3u) = -0.0278350417390002
cycle= 3 E= -75.3454675220222  delta_E= -0.00144  |g|= 0.0181  |ddm|= 0.0681
HOMO (B2u) = -0.355529260677995  LUMO (B3u) = -0.0322458808802121
cycle= 4 E= -75.3456894433558  delta_E= -0.000222  |g|= 0.000681  |ddm|= 0.0375
HOMO (B2u) = -0.355644927845468  LUMO (B3u) = -0.0325087452095936
cycle= 5 E= -75.3456896230235  delta_E= -1.8e-07  |g|= 9.78e-05  |ddm|= 0.00103
HOMO (B2u) = -0.355609613190063  LUMO (B3u) = -0.0324745833916086
cycle= 6 E= -75.3456896284285  delta_E= -5.41e-09  |g|= 1.56e-05  |ddm|= 0.000165
HOMO (B2u) = -0.355607628482653  LUMO (B3u) = -0.0324756124305532
cycle= 7 E= -75.3456896285829  delta_E= -1.54e-10  |g|= 1.94e-06  |ddm|= 3.47e-05
HOMO (B2u) = -0.355606961354879  LUMO (B3u) = -0.0324753268421351
cycle= 8 E= -75.3456896285854  delta_E= -2.53e-12  |g|= 1.17e-07  |ddm|= 4.13e-06
HOMO (B2u) = -0.355606972649756  LUMO (B3u) = -0.0324753336780499
cycle= 9 E= -75.3456896285854  delta_E=    0  |g|= 7.02e-09  |ddm|= 2.39e-07
HOMO (B2u) = -0.355606973127071  LUMO (B3u) = -0.0324753357914219
cycle= 10 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 5.11e-09  |ddm|= 7.54e-09
HOMO (B2u) = -0.355606972919596  LUMO (B3u) = -0.0324753355623412
cycle= 11 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 4.03e-09  |ddm|= 4.14e-09
HOMO (B2u) = -0.355606971599852  LUMO (B3u) = -0.0324753341761098
cycle= 12 E= -75.3456896285854  delta_E=    0  |g|= 3.67e-09  |ddm|= 1.89e-09
HOMO (B2u) = -0.355606971984099  LUMO (B3u) = -0.0324753345459313
cycle= 13 E= -75.3456896285853  delta_E= 2.84e-14  |g|= 3.28e-09  |ddm|= 1.07e-09
HOMO (B2u) = -0.355606971978541  LUMO (B3u) = -0.0324753345652423
cycle= 14 E= -75.3456896285853  delta_E=    0  |g|= 3.08e-09  |ddm|= 7.32e-10
HOMO (B2u) = -0.35560697176414  LUMO (B3u) = -0.0324753342956816
cycle= 15 E= -75.3456896285854  delta_E= -5.68e-14  |g|= 7.16e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.355606971674219  LUMO (B3u) = -0.0324753342946617
cycle= 16 E= -75.3456896285853  delta_E= 5.68e-14  |g|= 7.7e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.355606971704629  LUMO (B3u) = -0.0324753342894964
cycle= 17 E= -75.3456896285854  delta_E= -8.53e-14  |g|= 7.69e-10  |ddm|= 6.14e-10
HOMO (B2u) = -0.355606971687433  LUMO (B3u) = -0.0324753342673643
cycle= 18 E= -75.3456896285853  delta_E= 1.42e-13  |g|= 5.86e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.35560697169639  LUMO (B3u) = -0.0324753342793525
cycle= 19 E= -75.3456896285855  delta_E= -1.71e-13  |g|= 5.26e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.355606971707022  LUMO (B3u) = -0.032475334292066
cycle= 20 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 4.51e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.355606971703299  LUMO (B3u) = -0.0324753342875934
cycle= 21 E= -75.3456896285855  delta_E= -2.84e-14  |g|= 3.58e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.355606971702999  LUMO (B3u) = -0.0324753342880864
cycle= 22 E= -75.3456896285854  delta_E= 8.53e-14  |g|= 2.68e-10  |ddm|= 1.69e-10
HOMO (B2u) = -0.355606971703309  LUMO (B3u) = -0.0324753342883293
cycle= 23 E= -75.3456896285855  delta_E= -8.53e-14  |g|= 1.73e-10  |ddm|= 1.82e-10
HOMO (B2u) = -0.35560697169846  LUMO (B3u) = -0.0324753342857336
cycle= 24 E= -75.3456896285855  delta_E=    0  |g|= 1.54e-10  |ddm|= 5.83e-11
HOMO (B2u) = -0.355606971698413  LUMO (B3u) = -0.0324753342842443
cycle= 25 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 1.3e-10  |ddm|= 5.11e-11
HOMO (B2u) = -0.3556069716972  LUMO (B3u) = -0.032475334282931
cycle= 26 E= -75.3456896285855  delta_E= -2.84e-14  |g|= 1.08e-10  |ddm|= 4.42e-11
HOMO (B2u) = -0.355606971695944  LUMO (B3u) = -0.0324753342817222
cycle= 27 E= -75.3456896285855  delta_E=    0  |g|= 9.28e-11  |ddm|= 3.29e-11
HOMO (B2u) = -0.355606971692845  LUMO (B3u) = -0.0324753342784689
Extra cycle  E= -75.3456896285855  delta_E=    0  |g|= 3.46e-11  |ddm|= 1.21e-10
converged SCF energy = -75.3456896285855

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp3ycvfo1n
max_memory 4000 MB (current use 8705 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4564838553942  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4691762964236  dE = -0.012692441  S^2 = 0.0000000
               |grad[o]|=0.0865  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.480114984424  dE = -0.010938688  S^2 = 0.0000000
               |grad[o]|=0.0752  |ddm|=0.0668  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4889721315012  dE = -0.0088571471  S^2 = 0.0000000
               |grad[o]|=0.0624  |ddm|=0.0407  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.495786433907  dE = -0.0068143024  S^2 = 0.0000000
               |grad[o]|=0.0491  |ddm|=0.0472  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5005650305714  dE = -0.0047785967  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.0607  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5027278757675  dE = -0.0021628452  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.0448  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.503195653625  dE = -0.00046777786  S^2 = 0.0000000
               |grad[o]|=0.0072  |ddm|=0.0469  |maxRot[o]|= 0.04
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5032868646248  dE = -9.1211e-05  S^2 = 0.0000000
               |grad[o]|=0.00309  |ddm|=0.0149  |maxRot[o]|= 0.02
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5032983068407  dE = -1.1442216e-05  S^2 = 0.0000000
               |grad[o]|=0.00115  |ddm|=0.0055  |maxRot[o]|=0.00736
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5032996034576  dE = -1.2966169e-06  S^2 = 0.0000000
               |grad[o]|=0.000397  |ddm|=0.00185  |maxRot[o]|=0.0025
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5032997460357  dE = -1.425781e-07  S^2 = 0.0000000
               |grad[o]|=0.000133  |ddm|=0.000615  |maxRot[o]|=0.000834
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5032997615435  dE = -1.5507737e-08  S^2 = 0.0000000
               |grad[o]|=4.5e-05  |ddm|=0.000203  |maxRot[o]|=0.000276
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5032997632064  dE = -1.6629258e-09  S^2 = 0.0000000
               |grad[o]|=1.49e-05  |ddm|=6.63e-05  |maxRot[o]|=9.07e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5032997633894  dE = -1.8303581e-10  S^2 = 0.0000000
               |grad[o]|=4.98e-06  |ddm|=2.24e-05  |maxRot[o]|=2.98e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5032997634143  dE = -2.4911628e-11  S^2 = 0.0000000
               |grad[o]|=1.67e-06  |ddm|=7.45e-06  |maxRot[o]|=1.02e-05
2-step CASSCF converged in 15 macro (60 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96274302 1.92928248 1.89992237 1.81420276 0.07676462 0.19201087
 0.05872204 0.06635183]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01059   0.00982  -0.00515   0.00000   0.00000
  0 C 2s       0.62877   0.64927  -0.32247   0.00000   0.00000
  0 C 3s      -0.01802   0.01723  -0.04662  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69435
  0 C 2py     -0.00000   0.00000  -0.00000   0.70442   0.00000
  0 C 2pz      0.32084  -0.27893   0.62651  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000  -0.05813
  0 C 3py     -0.00000   0.00000  -0.00000   0.04890  -0.00000
  0 C 3pz     -0.02026  -0.00235   0.00351  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03743  -0.00000
  0 C 3dz^2    0.02926  -0.01397   0.03504  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000  -0.12042
 0 C 3dx2-y2  -0.00088   0.00700  -0.00745  -0.00000   0.00000
  1 C 1s       0.01059  -0.00982  -0.00515   0.00000   0.00000
  1 C 2s       0.62877  -0.64927  -0.32247   0.00000  -0.00000
  1 C 3s      -0.01802  -0.01723  -0.04662   0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70442   0.00000
  1 C 2pz     -0.32084  -0.27893  -0.62651  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.05813
  1 C 3py      0.00000  -0.00000   0.00000   0.04890  -0.00000
  1 C 3pz      0.02026  -0.00235  -0.00351  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.03743   0.00000
  1 C 3dz^2    0.02926   0.01397   0.03504   0.00000  -0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12042
 1 C 3dx2-y2  -0.00088  -0.00700  -0.00745   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00046
  0 C 2s      -0.00000   0.00000   0.27729
  0 C 3s      -0.00000   0.00000   0.03734
  0 C 2px     -0.00000   0.69739   0.00000
  0 C 2py      0.70675   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.64700
  0 C 3px     -0.00000  -0.00124   0.00000
  0 C 3py     -0.01872   0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.04893
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01263  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01067
  0 C 3dxz     0.00000  -0.11680   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.02442
  1 C 1s       0.00000   0.00000   0.00046
  1 C 2s      -0.00000  -0.00000  -0.27729
  1 C 3s       0.00000  -0.00000  -0.03734
  1 C 2px     -0.00000  -0.69739  -0.00000
  1 C 2py     -0.70675   0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.64700
  1 C 3px      0.00000   0.00124  -0.00000
  1 C 3py      0.01872  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04893
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01263  -0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01067
  1 C 3dxz    -0.00000  -0.11680   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02442
<CAS-nat-orb|mo-hf>  3  3    0.99427995
<CAS-nat-orb|mo-hf>  4  4    0.99973720
<CAS-nat-orb|mo-hf>  5  5    0.99429722
<CAS-nat-orb|mo-hf>  6  6    0.99915774
<CAS-nat-orb|mo-hf>  7  7    0.93938548
<CAS-nat-orb|mo-hf>  8  8    0.97438151
<CAS-nat-orb|mo-hf>  9  9    0.95919912
<CAS-nat-orb|mo-hf>  10  10    0.88692940
<CAS-nat-orb|mo-hf>  10  11   -0.43885974
CASSCF energy = -75.5032997634143
CASCI E = -75.5032997634143  E(CI) = -15.5624179292323  S^2 = 0.0000000
......production of RDMs took       2.38 sec
......reading the RDM took          0.47 sec
......production of RDMs took      27.17 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.31 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000055917
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000014770
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000672086
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000086767
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000411088
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0001033354
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000344451
HMAT symm error =    0.0140605612
E(MRCI) - E(ref) = -0.1144016441876516 DC = -0.005846940197811653
E(WickICMRCISD)   = -75.617701407602  E_corr_ci = -0.1144016441876516
E(WickICMRCISD+Q) = -75.62354834779981  E_corr_ci = -0.1202485843854633
Time cost =   2546.480
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 16:49:20 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.799202517128 AA    0.000000000000   0.000000000000   3.400000000000 Bohr   0.0

nuclear repulsion = 10.5882352941176
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.7]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1468328.23


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmphibzaklp
max_memory 4000 MB (current use 8705 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8043126951475

WARN: Singularity detected in overlap matrix (condition number =  122). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.123626145223849  LUMO (B3u) = -0.123626145223849

WARN: B2u HOMO -0.123626145223849 > system LUMO -0.123626145223849

cycle= 1 E= -75.3111334513161  delta_E= -0.507  |g|= 0.249  |ddm|=  1.5
HOMO (B2u) = -0.383724747851056  LUMO (B3u) = -0.067227518857361
cycle= 2 E= -75.3357364104633  delta_E= -0.0246  |g|= 0.0507  |ddm|= 0.351
HOMO (B2u) = -0.34702671827607  LUMO (B3u) = -0.0257227421999451
cycle= 3 E= -75.3371652899279  delta_E= -0.00143  |g|= 0.0181  |ddm|= 0.0673
HOMO (B2u) = -0.351526070447294  LUMO (B3u) = -0.0301077062023778
cycle= 4 E= -75.3373878233177  delta_E= -0.000223  |g|= 0.000675  |ddm|= 0.0372
HOMO (B2u) = -0.351660112314438  LUMO (B3u) = -0.0303898359337106
cycle= 5 E= -75.3373879985294  delta_E= -1.75e-07  |g|= 0.000102  |ddm|= 0.000975
HOMO (B2u) = -0.351623840121636  LUMO (B3u) = -0.0303555719623948
cycle= 6 E= -75.3373880044287  delta_E= -5.9e-09  |g|= 1.61e-05  |ddm|= 0.000173
HOMO (B2u) = -0.351621725064433  LUMO (B3u) = -0.0303564386936762
cycle= 7 E= -75.3373880045928  delta_E= -1.64e-10  |g|= 1.94e-06  |ddm|= 3.52e-05
HOMO (B2u) = -0.351621087023887  LUMO (B3u) = -0.0303561953012176
cycle= 8 E= -75.3373880045952  delta_E= -2.39e-12  |g|= 1.2e-07  |ddm|= 4.09e-06
HOMO (B2u) = -0.351621096028511  LUMO (B3u) = -0.0303561996525376
cycle= 9 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 7.3e-09  |ddm|= 2.5e-07
HOMO (B2u) = -0.35162109633055  LUMO (B3u) = -0.0303562016325223
cycle= 10 E= -75.3373880045952  delta_E=    0  |g|= 5.49e-09  |ddm|= 7.66e-09
HOMO (B2u) = -0.351621096127623  LUMO (B3u) = -0.0303562014173202
cycle= 11 E= -75.3373880045952  delta_E=    0  |g|= 4.19e-09  |ddm|= 4.36e-09
HOMO (B2u) = -0.351621094785318  LUMO (B3u) = -0.0303562000104918
cycle= 12 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 3.79e-09  |ddm|= 1.99e-09
HOMO (B2u) = -0.351621095168739  LUMO (B3u) = -0.0303562003841395
cycle= 13 E= -75.3373880045952  delta_E=    0  |g|= 3.4e-09  |ddm|= 1.23e-09
HOMO (B2u) = -0.351621095129905  LUMO (B3u) = -0.0303562003623645
cycle= 14 E= -75.3373880045952  delta_E=    0  |g|= 3.05e-09  |ddm|= 6.93e-10
HOMO (B2u) = -0.351621094932123  LUMO (B3u) = -0.0303562001383801
cycle= 15 E= -75.3373880045951  delta_E= 5.68e-14  |g|= 7.9e-10  |ddm|= 4.8e-09
HOMO (B2u) = -0.35162109482892  LUMO (B3u) = -0.0303562001339381
cycle= 16 E= -75.3373880045952  delta_E= -5.68e-14  |g|= 8.05e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.351621094865993  LUMO (B3u) = -0.0303562001250379
cycle= 17 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 8.23e-10  |ddm|= 8.24e-10
HOMO (B2u) = -0.351621094843663  LUMO (B3u) = -0.0303562001009839
cycle= 18 E= -75.3373880045953  delta_E= -2.84e-14  |g|= 6.29e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.351621094849333  LUMO (B3u) = -0.0303562001110582
cycle= 19 E= -75.3373880045952  delta_E= 5.68e-14  |g|= 5.5e-10  |ddm|= 3.08e-10
HOMO (B2u) = -0.351621094856912  LUMO (B3u) = -0.030356200122013
cycle= 20 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 4.68e-10  |ddm|= 2.06e-10
HOMO (B2u) = -0.35162109485013  LUMO (B3u) = -0.0303562001156976
cycle= 21 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 3.7e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.351621094847086  LUMO (B3u) = -0.0303562001145413
cycle= 22 E= -75.3373880045952  delta_E= -1.42e-14  |g|= 2.74e-10  |ddm|= 1.96e-10
HOMO (B2u) = -0.351621094844433  LUMO (B3u) = -0.0303562001131803
cycle= 23 E= -75.3373880045953  delta_E= -4.26e-14  |g|= 1.83e-10  |ddm|= 1.88e-10
HOMO (B2u) = -0.351621094838947  LUMO (B3u) = -0.0303562001103526
cycle= 24 E= -75.3373880045951  delta_E= 1.14e-13  |g|= 1.61e-10  |ddm|= 6.43e-11
HOMO (B2u) = -0.351621094838502  LUMO (B3u) = -0.0303562001084888
cycle= 25 E= -75.3373880045952  delta_E= -8.53e-14  |g|= 1.36e-10  |ddm|= 5.73e-11
HOMO (B2u) = -0.351621094836495  LUMO (B3u) = -0.0303562001067954
cycle= 26 E= -75.3373880045952  delta_E=    0  |g|= 1.12e-10  |ddm|= 5.33e-11
HOMO (B2u) = -0.35162109483467  LUMO (B3u) = -0.0303562001053196
cycle= 27 E= -75.3373880045953  delta_E= -5.68e-14  |g|= 9.56e-11  |ddm|= 4.01e-11
HOMO (B2u) = -0.351621094833176  LUMO (B3u) = -0.0303562001040527
cycle= 28 E= -75.3373880045953  delta_E= 1.42e-14  |g|= 7.83e-11  |ddm|= 3.82e-11
HOMO (B2u) = -0.351621094832077  LUMO (B3u) = -0.0303562001031096
cycle= 29 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 6.25e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.351621094831106  LUMO (B3u) = -0.0303562001022915
cycle= 30 E= -75.3373880045952  delta_E= 1.42e-14  |g|= 4.97e-11  |ddm|= 2.81e-11
HOMO (B2u) = -0.351621094830381  LUMO (B3u) = -0.0303562001016806
cycle= 31 E= -75.3373880045952  delta_E= 4.26e-14  |g|= 4.01e-11  |ddm|= 2.12e-11
HOMO (B2u) = -0.351621094829874  LUMO (B3u) = -0.0303562001012693
cycle= 32 E= -75.3373880045951  delta_E= 1.14e-13  |g|= 3.43e-11  |ddm|= 1.42e-11
HOMO (B2u) = -0.351621094829538  LUMO (B3u) = -0.0303562001009195
cycle= 33 E= -75.3373880045947  delta_E= 3.55e-13  |g|= 2.93e-11  |ddm|= 1.23e-11
HOMO (B2u) = -0.351621094829189  LUMO (B3u) = -0.0303562001006154
cycle= 34 E= -75.3373880045945  delta_E= 1.99e-13  |g|= 2.52e-11  |ddm|= 1.03e-11
HOMO (B2u) = -0.35162109482889  LUMO (B3u) = -0.0303562001003522
cycle= 35 E= -75.3373880045943  delta_E= 1.85e-13  |g|= 2.19e-11  |ddm|= 8.66e-12
HOMO (B2u) = -0.351621094828627  LUMO (B3u) = -0.030356200100113
cycle= 36 E= -75.3373880045939  delta_E= 3.84e-13  |g|= 1.9e-11  |ddm|= 7.63e-12
HOMO (B2u) = -0.351621094828393  LUMO (B3u) = -0.0303562000998949
cycle= 37 E= -75.3373880045935  delta_E= 4.12e-13  |g|= 1.66e-11  |ddm|= 6.45e-12
HOMO (B2u) = -0.351621094828178  LUMO (B3u) = -0.0303562000996919
cycle= 38 E= -75.3373880045928  delta_E= 7.39e-13  |g|= 1.51e-11  |ddm|= 5.31e-12
HOMO (B2u) = -0.35162109482797  LUMO (B3u) = -0.0303562000994923
cycle= 39 E= -75.3373880045921  delta_E= 6.68e-13  |g|= 1.41e-11  |ddm|= 4.47e-12
HOMO (B2u) = -0.351621094827766  LUMO (B3u) = -0.0303562000992926
cycle= 40 E= -75.3373880045916  delta_E= 5.68e-13  |g|= 1.32e-11  |ddm|= 3.99e-12
HOMO (B2u) = -0.351621094827558  LUMO (B3u) = -0.0303562000990851
cycle= 41 E= -75.337388004591  delta_E= 5.12e-13  |g|= 1.17e-11  |ddm|= 4.11e-12
HOMO (B2u) = -0.351621094827347  LUMO (B3u) = -0.0303562000988725
cycle= 42 E= -75.3373880045907  delta_E= 3.84e-13  |g|= 9.69e-12  |ddm|= 4.29e-12
HOMO (B2u) = -0.351621094827131  LUMO (B3u) = -0.030356200098651
cycle= 43 E= -75.3373880045903  delta_E= 4.12e-13  |g|= 7.9e-12  |ddm|= 4.1e-12
HOMO (B2u) = -0.351621094826914  LUMO (B3u) = -0.0303562000984209
cycle= 44 E= -75.33738800459  delta_E= 2.56e-13  |g|= 6.57e-12  |ddm|= 3.81e-12
HOMO (B2u) = -0.351621094826696  LUMO (B3u) = -0.0303562000981855
cycle= 45 E= -75.3373880045898  delta_E= 2.13e-13  |g|= 5.22e-12  |ddm|= 4.08e-12
HOMO (B2u) = -0.351621094826487  LUMO (B3u) = -0.0303562000979541
cycle= 46 E= -75.3373880045895  delta_E= 2.42e-13  |g|= 4.67e-12  |ddm|= 3.2e-12
HOMO (B2u) = -0.351621094826285  LUMO (B3u) = -0.0303562000977287
cycle= 47 E= -75.3373880045892  delta_E= 3.27e-13  |g|= 4.74e-12  |ddm|= 2.77e-12
HOMO (B2u) = -0.351621094826094  LUMO (B3u) = -0.0303562000975099
cycle= 48 E= -75.3373880045887  delta_E= 5.54e-13  |g|= 5.06e-12  |ddm|= 2.8e-12
HOMO (B2u) = -0.351621094825915  LUMO (B3u) = -0.0303562000973023
cycle= 49 E= -75.3373880045882  delta_E= 4.55e-13  |g|= 5.39e-12  |ddm|= 2.74e-12
HOMO (B2u) = -0.351621094825742  LUMO (B3u) = -0.0303562000971008
cycle= 50 E= -75.3373880045879  delta_E= 3.27e-13  |g|= 5.04e-12  |ddm|= 3.12e-12
SCF not converged.
SCF energy = -75.3373880045879

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmphibzaklp
max_memory 4000 MB (current use 8705 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4523708352883  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.465482955385  dE = -0.01311212  S^2 = 0.0000000
               |grad[o]|=0.0884  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4766240914333  dE = -0.011141136  S^2 = 0.0000000
               |grad[o]|=0.0759  |ddm|=0.0711  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4854152083704  dE = -0.0087911169  S^2 = 0.0000000
               |grad[o]|=0.0617  |ddm|=0.0413  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4919810124942  dE = -0.0065658041  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.048  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.496509672267  dE = -0.0045286598  S^2 = 0.0000000
               |grad[o]|=0.0318  |ddm|=0.065  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4980385164112  dE = -0.0015288441  S^2 = 0.0000000
               |grad[o]|=0.0142  |ddm|=0.0476  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4983511494237  dE = -0.00031263301  S^2 = 0.0000000
               |grad[o]|=0.00563  |ddm|=0.0316  |maxRot[o]|=0.0357
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4983917874371  dE = -4.0638013e-05  S^2 = 0.0000000
               |grad[o]|=0.0021  |ddm|=0.0103  |maxRot[o]|=0.0138
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4983962110941  dE = -4.4236569e-06  S^2 = 0.0000000
               |grad[o]|=0.000734  |ddm|=0.00328  |maxRot[o]|=0.00466
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4983966689273  dE = -4.5783324e-07  S^2 = 0.0000000
               |grad[o]|=0.00024  |ddm|=0.00107  |maxRot[o]|=0.0015
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4983967154537  dE = -4.6526409e-08  S^2 = 0.0000000
               |grad[o]|=7.91e-05  |ddm|=0.000341  |maxRot[o]|=0.000481
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4983967201917  dE = -4.7380411e-09  S^2 = 0.0000000
               |grad[o]|=2.53e-05  |ddm|=0.000109  |maxRot[o]|=0.000154
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4983967206668  dE = -4.7504045e-10  S^2 = 0.0000000
               |grad[o]|=8.2e-06  |ddm|=3.45e-05  |maxRot[o]|=4.89e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4983967207138  dE = -4.705214e-11  S^2 = 0.0000000
               |grad[o]|=2.58e-06  |ddm|=1.1e-05  |maxRot[o]|=1.53e-05
2-step CASSCF converged in 14 macro (58 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96168427 1.92995961 1.89788678 1.80319403 0.07495278 0.20294447
 0.05842681 0.07095124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01086   0.00993  -0.00483   0.00000   0.00000
  0 C 2s       0.63886   0.65282  -0.30204  -0.00000  -0.00000
  0 C 3s      -0.01519   0.01695  -0.04490  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69411
  0 C 2py      0.00000  -0.00000  -0.00000   0.70440   0.00000
  0 C 2pz      0.30069  -0.27056   0.63672  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.05943
  0 C 3py      0.00000  -0.00000  -0.00000   0.05007   0.00000
  0 C 3pz     -0.01863  -0.00220   0.00482  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03622   0.00000
  0 C 3dz^2    0.02743  -0.01357   0.03519  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.12113
 0 C 3dx2-y2  -0.00059   0.00688  -0.00742  -0.00000  -0.00000
  1 C 1s       0.01086  -0.00993  -0.00483   0.00000   0.00000
  1 C 2s       0.63886  -0.65282  -0.30204   0.00000  -0.00000
  1 C 3s      -0.01519  -0.01695  -0.04490   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69411
  1 C 2py     -0.00000   0.00000   0.00000   0.70440  -0.00000
  1 C 2pz     -0.30069  -0.27056  -0.63672  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.05943
  1 C 3py     -0.00000   0.00000   0.00000   0.05007  -0.00000
  1 C 3pz      0.01863  -0.00220  -0.00482  -0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03622   0.00000
  1 C 3dz^2    0.02743   0.01357   0.03519   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12113
 1 C 3dx2-y2  -0.00059  -0.00688  -0.00742   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00043
  0 C 2s      -0.00000  -0.00000   0.26907
  0 C 3s      -0.00000  -0.00000   0.03634
  0 C 2px      0.00000   0.69753  -0.00000
  0 C 2py      0.70681   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.65078
  0 C 3px      0.00000  -0.00334  -0.00000
  0 C 3py     -0.01665   0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04624
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01219   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00964
  0 C 3dxz     0.00000  -0.11596  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02324
  1 C 1s       0.00000   0.00000   0.00043
  1 C 2s       0.00000  -0.00000  -0.26907
  1 C 3s       0.00000   0.00000  -0.03634
  1 C 2px      0.00000  -0.69753   0.00000
  1 C 2py     -0.70681  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.65078
  1 C 3px     -0.00000   0.00334   0.00000
  1 C 3py      0.01665  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04624
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.01219   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00964
  1 C 3dxz     0.00000  -0.11596  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02324
<CAS-nat-orb|mo-hf>  3  3    0.99623595
<CAS-nat-orb|mo-hf>  4  4    0.99972951
<CAS-nat-orb|mo-hf>  5  5    0.99625438
<CAS-nat-orb|mo-hf>  6  6    0.99910667
<CAS-nat-orb|mo-hf>  7  7    0.93825028
<CAS-nat-orb|mo-hf>  8  8    0.97590449
<CAS-nat-orb|mo-hf>  9  9    0.95945853
<CAS-nat-orb|mo-hf>  10  10    0.89805646
<CAS-nat-orb|mo-hf>  10  11   -0.41828628
CASSCF energy = -75.4983967207138
CASCI E = -75.4983967207138  E(CI) = -15.487414400886  S^2 = 0.0000000
......production of RDMs took       2.32 sec
......reading the RDM took          0.48 sec
......production of RDMs took      28.14 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.81 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000044788
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000011830
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000384492
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000048524
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000236769
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000614619
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000204873
HMAT symm error =    0.0122368129
E(MRCI) - E(ref) = -0.1145884980940366 DC = -0.00589026163158065
E(WickICMRCISD)   = -75.61298521880788  E_corr_ci = -0.1145884980940366
E(WickICMRCISD+Q) = -75.61887548043946  E_corr_ci = -0.1204787597256173
Time cost =   2569.241
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 17:32:09 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.825661377674 AA    0.000000000000   0.000000000000   3.450000000000 Bohr   0.0

nuclear repulsion = 10.4347826086957
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.725]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1511487.02


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmppfvejxur
max_memory 4000 MB (current use 8705 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7871059587891

WARN: Singularity detected in overlap matrix (condition number =  114). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.119977421491999  LUMO (B3u) = -0.119977421491999

WARN: B2u HOMO -0.119977421491999 > system LUMO -0.119977421491999

cycle= 1 E= -75.3032347208423  delta_E= -0.516  |g|= 0.247  |ddm|=  1.5
HOMO (B2u) = -0.379319419622633  LUMO (B3u) = -0.0646054692258414
cycle= 2 E= -75.3274445047689  delta_E= -0.0242  |g|= 0.0501  |ddm|= 0.35
HOMO (B2u) = -0.343173022356372  LUMO (B3u) = -0.023683431563987
cycle= 3 E= -75.3288571081842  delta_E= -0.00141  |g|= 0.018  |ddm|= 0.0664
HOMO (B2u) = -0.347657119428849  LUMO (B3u) = -0.0280415501187841
cycle= 4 E= -75.3290795920014  delta_E= -0.000222  |g|= 0.00067  |ddm|= 0.0369
HOMO (B2u) = -0.347805946692308  LUMO (B3u) = -0.0283390207305954
cycle= 5 E= -75.3290797635007  delta_E= -1.71e-07  |g|= 0.000106  |ddm|= 0.000935
HOMO (B2u) = -0.347769025805503  LUMO (B3u) = -0.0283049912511385
cycle= 6 E= -75.3290797699135  delta_E= -6.41e-09  |g|= 1.65e-05  |ddm|= 0.000181
HOMO (B2u) = -0.347766788756666  LUMO (B3u) = -0.028305715831914
cycle= 7 E= -75.3290797700874  delta_E= -1.74e-10  |g|= 1.94e-06  |ddm|= 3.58e-05
HOMO (B2u) = -0.347766179407151  LUMO (B3u) = -0.0283055115206176
cycle= 8 E= -75.3290797700898  delta_E= -2.44e-12  |g|= 1.22e-07  |ddm|= 4.05e-06
HOMO (B2u) = -0.347766186617913  LUMO (B3u) = -0.0283055139495732
cycle= 9 E= -75.3290797700899  delta_E= -4.26e-14  |g|= 7.66e-09  |ddm|= 2.61e-07
HOMO (B2u) = -0.347766186764335  LUMO (B3u) = -0.0283055158281058
cycle= 10 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 5.87e-09  |ddm|= 7.81e-09
HOMO (B2u) = -0.347766186555852  LUMO (B3u) = -0.0283055156158966
cycle= 11 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 4.4e-09  |ddm|= 4.6e-09
HOMO (B2u) = -0.347766185192962  LUMO (B3u) = -0.0283055141895845
cycle= 12 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 3.94e-09  |ddm|= 2.11e-09
HOMO (B2u) = -0.347766185565499  LUMO (B3u) = -0.0283055145569034
cycle= 13 E= -75.3290797700898  delta_E=    0  |g|= 3.55e-09  |ddm|= 1.37e-09
HOMO (B2u) = -0.347766185498123  LUMO (B3u) = -0.028305514500978
cycle= 14 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 3.06e-09  |ddm|= 9.43e-10
HOMO (B2u) = -0.347766185312149  LUMO (B3u) = -0.0283055143166806
cycle= 15 E= -75.3290797700898  delta_E= -4.26e-14  |g|= 8.69e-10  |ddm|= 5.07e-09
HOMO (B2u) = -0.347766185214835  LUMO (B3u) = -0.0283055143060312
cycle= 16 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 8.64e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.347766185241231  LUMO (B3u) = -0.0283055142973395
cycle= 17 E= -75.3290797700899  delta_E= -5.68e-14  |g|= 8.92e-10  |ddm|= 6.4e-10
HOMO (B2u) = -0.347766185214374  LUMO (B3u) = -0.0283055142719705
cycle= 18 E= -75.3290797700899  delta_E= 2.84e-14  |g|= 6.83e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.347766185217242  LUMO (B3u) = -0.0283055142806536
cycle= 19 E= -75.3290797700899  delta_E= -1.42e-14  |g|= 5.83e-10  |ddm|= 3.64e-10
HOMO (B2u) = -0.347766185222219  LUMO (B3u) = -0.0283055142902924
cycle= 20 E= -75.3290797700899  delta_E= 1.42e-14  |g|= 4.91e-10  |ddm|= 2.5e-10
HOMO (B2u) = -0.347766185212758  LUMO (B3u) = -0.028305514282547
cycle= 21 E= -75.3290797700899  delta_E=    0  |g|= 3.86e-10  |ddm|= 2.35e-10
HOMO (B2u) = -0.347766185207215  LUMO (B3u) = -0.0283055142799947
cycle= 22 E= -75.3290797700899  delta_E=    0  |g|= 2.84e-10  |ddm|= 2.23e-10
HOMO (B2u) = -0.34776618520198  LUMO (B3u) = -0.0283055142773448
cycle= 23 E= -75.3290797700899  delta_E=    0  |g|= 1.94e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.347766185195901  LUMO (B3u) = -0.0283055142743
cycle= 24 E= -75.3290797700899  delta_E= -2.84e-14  |g|= 1.7e-10  |ddm|= 7.06e-11
HOMO (B2u) = -0.347766185194308  LUMO (B3u) = -0.0283055142721244
cycle= 25 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 1.43e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.347766185191536  LUMO (B3u) = -0.0283055142701065
cycle= 26 E= -75.3290797700899  delta_E= -2.84e-14  |g|= 1.17e-10  |ddm|= 6.3e-11
HOMO (B2u) = -0.347766185189155  LUMO (B3u) = -0.0283055142684039
cycle= 27 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 9.88e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.347766185187192  LUMO (B3u) = -0.0283055142669582
cycle= 28 E= -75.3290797700899  delta_E= -9.95e-14  |g|= 8.05e-11  |ddm|= 4.27e-11
HOMO (B2u) = -0.347766185185697  LUMO (B3u) = -0.0283055142658668
cycle= 29 E= -75.3290797700899  delta_E=    0  |g|= 6.41e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.347766185181772  LUMO (B3u) = -0.0283055142630158
Extra cycle  E= -75.32907977009  delta_E= -2.84e-14  |g|= 2.38e-11  |ddm|= 9.24e-11
converged SCF energy = -75.32907977009

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmppfvejxur
max_memory 4000 MB (current use 8705 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4482666492426  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4618070962041  dE = -0.013540447  S^2 = 0.0000000
               |grad[o]|=0.0903  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4731420455806  dE = -0.011334949  S^2 = 0.0000000
               |grad[o]|=0.0766  |ddm|=0.0757  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4818436376911  dE = -0.0087015921  S^2 = 0.0000000
               |grad[o]|=0.0609  |ddm|=0.0424  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.488147977575  dE = -0.0063043399  S^2 = 0.0000000
               |grad[o]|=0.0447  |ddm|=0.0517  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4917508556004  dE = -0.003602878  S^2 = 0.0000000
               |grad[o]|=0.0284  |ddm|=0.0693  |maxRot[o]|= 0.06
macro iter 6 (5 JK  0 micro), CASSCF E = -75.493233419972  dE = -0.0014825644  S^2 = 0.0000000
               |grad[o]|=0.014  |ddm|=0.0391  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4935074486841  dE = -0.00027402871  S^2 = 0.0000000
               |grad[o]|=0.0052  |ddm|=0.0263  |maxRot[o]|=0.0339
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4935391472087  dE = -3.1698525e-05  S^2 = 0.0000000
               |grad[o]|=0.00188  |ddm|=0.00865  |maxRot[o]|=0.0123
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4935423378569  dE = -3.1906482e-06  S^2 = 0.0000000
               |grad[o]|=0.000638  |ddm|=0.00269  |maxRot[o]|=0.00399
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4935426468784  dE = -3.0902157e-07  S^2 = 0.0000000
               |grad[o]|=0.000201  |ddm|=0.000852  |maxRot[o]|=0.00124
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4935426764439  dE = -2.9565456e-08  S^2 = 0.0000000
               |grad[o]|=6.51e-05  |ddm|=0.000265  |maxRot[o]|=0.000387
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4935426792637  dE = -2.8197746e-09  S^2 = 0.0000000
               |grad[o]|=2.01e-05  |ddm|=8.25e-05  |maxRot[o]|=0.00012
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4935426795295  dE = -2.6578562e-10  S^2 = 0.0000000
               |grad[o]|=6.34e-06  |ddm|=2.54e-05  |maxRot[o]|=3.71e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4935426795536  dE = -2.4172664e-11  S^2 = 0.0000000
               |grad[o]|=1.95e-06  |ddm|=7.86e-06  |maxRot[o]|=1.14e-05
2-step CASSCF converged in 14 macro (57 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96070609 1.93062247 1.89534329 1.79161507 0.07330623 0.21443248
 0.0581318  0.07584257]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01111   0.01003  -0.00449   0.00000   0.00000
  0 C 2s       0.64834   0.65619  -0.28117   0.00000   0.00000
  0 C 3s      -0.01251   0.01666  -0.04312  -0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69393
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439   0.00000
  0 C 2pz      0.28005  -0.26233   0.64632  -0.00000   0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06065
  0 C 3py      0.00000  -0.00000   0.00000   0.05111   0.00000
  0 C 3pz     -0.01714  -0.00207   0.00620  -0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.03500   0.00000
  0 C 3dz^2    0.02561  -0.01317   0.03529  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.12160
 0 C 3dx2-y2  -0.00030   0.00676  -0.00739   0.00000   0.00000
  1 C 1s       0.01111  -0.01003  -0.00449   0.00000   0.00000
  1 C 2s       0.64834  -0.65619  -0.28117   0.00000   0.00000
  1 C 3s      -0.01251  -0.01666  -0.04312   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69393
  1 C 2py     -0.00000   0.00000  -0.00000   0.70439  -0.00000
  1 C 2pz     -0.28005  -0.26233  -0.64632   0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000  -0.06065
  1 C 3py     -0.00000   0.00000   0.00000   0.05111  -0.00000
  1 C 3pz      0.01714  -0.00207  -0.00620  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03500   0.00000
  1 C 3dz^2    0.02561   0.01317   0.03529   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12160
 1 C 3dx2-y2  -0.00030  -0.00676  -0.00739  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s       0.00000   0.00000   0.26097
  0 C 3s      -0.00000   0.00000   0.03534
  0 C 2px     -0.00000   0.69766   0.00000
  0 C 2py      0.70686  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.65436
  0 C 3px     -0.00000  -0.00539  -0.00000
  0 C 3py     -0.01459  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04356
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01176  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00868
  0 C 3dxz    -0.00000  -0.11509   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02209
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.26097
  1 C 3s       0.00000  -0.00000  -0.03534
  1 C 2px      0.00000  -0.69766   0.00000
  1 C 2py     -0.70686   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.65436
  1 C 3px      0.00000   0.00539  -0.00000
  1 C 3py      0.01459   0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04356
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01176  -0.00000   0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00868
  1 C 3dxz    -0.00000  -0.11509   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02209
<CAS-nat-orb|mo-hf>  3  3    0.99779512
<CAS-nat-orb|mo-hf>  4  4    0.99972139
<CAS-nat-orb|mo-hf>  5  5    0.99781371
<CAS-nat-orb|mo-hf>  6  6    0.99905368
<CAS-nat-orb|mo-hf>  7  7    0.93724394
<CAS-nat-orb|mo-hf>  8  8    0.97733329
<CAS-nat-orb|mo-hf>  9  9    0.95969121
<CAS-nat-orb|mo-hf>  10  10    0.90788563
CASSCF energy = -75.4935426795536
CASCI E = -75.4935426795536  E(CI) = -15.4144875230009  S^2 = 0.0000000
......production of RDMs took       2.12 sec
......reading the RDM took          0.44 sec
......production of RDMs took      27.11 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.26 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000052231
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000013796
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000899564
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000117371
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000548340
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0001278800
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000426267
HMAT symm error =    0.0172272118
E(MRCI) - E(ref) = -0.1147805502795336 DC = -0.005934277919045474
E(WickICMRCISD)   = -75.60832322983316  E_corr_ci = -0.1147805502795336
E(WickICMRCISD+Q) = -75.6142575077522  E_corr_ci = -0.1207148281985791
Time cost =   2861.178
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 18:19:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.852120238220 AA    0.000000000000   0.000000000000   3.500000000000 Bohr   0.0

nuclear repulsion = 10.2857142857143
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.75]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1559450.78


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmppf15737o
max_memory 4000 MB (current use 8705 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.770995471526

WARN: Singularity detected in overlap matrix (condition number =  106). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.116499456302711  LUMO (B3u) = -0.116499456302711

WARN: B2u HOMO -0.116499456302711 > system LUMO -0.116499456302711

cycle= 1 E= -75.2953428985396  delta_E= -0.524  |g|= 0.245  |ddm|= 1.49
HOMO (B2u) = -0.375058505355513  LUMO (B3u) = -0.0620673626538308
cycle= 2 E= -75.3191698853078  delta_E= -0.0238  |g|= 0.0495  |ddm|= 0.35
HOMO (B2u) = -0.339451307241011  LUMO (B3u) = -0.0217153065240383
cycle= 3 E= -75.3205643325183  delta_E= -0.00139  |g|= 0.0179  |ddm|= 0.0655
HOMO (B2u) = -0.343918314413034  LUMO (B3u) = -0.0260457604373075
cycle= 4 E= -75.320786165773  delta_E= -0.000222  |g|= 0.000666  |ddm|= 0.0365
HOMO (B2u) = -0.344078228753201  LUMO (B3u) = -0.0263545301612761
cycle= 5 E= -75.3207863342661  delta_E= -1.68e-07  |g|= 0.00011  |ddm|= 0.000905
HOMO (B2u) = -0.34404092812384  LUMO (B3u) = -0.0263210064987917
cycle= 6 E= -75.3207863411989  delta_E= -6.93e-09  |g|= 1.7e-05  |ddm|= 0.000188
HOMO (B2u) = -0.344038581299433  LUMO (B3u) = -0.0263216091209551
cycle= 7 E= -75.3207863413827  delta_E= -1.84e-10  |g|= 1.93e-06  |ddm|= 3.63e-05
HOMO (B2u) = -0.344037999604642  LUMO (B3u) = -0.026321440957216
cycle= 8 E= -75.3207863413852  delta_E= -2.44e-12  |g|= 1.24e-07  |ddm|= 4.02e-06
HOMO (B2u) = -0.344038005467255  LUMO (B3u) = -0.0263214419458158
cycle= 9 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 8.04e-09  |ddm|= 2.72e-07
HOMO (B2u) = -0.344038005447966  LUMO (B3u) = -0.0263214437150757
cycle= 10 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 6.26e-09  |ddm|= 7.9e-09
HOMO (B2u) = -0.344038005257676  LUMO (B3u) = -0.0263214435356963
cycle= 11 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 4.62e-09  |ddm|= 4.91e-09
HOMO (B2u) = -0.344038003880613  LUMO (B3u) = -0.0263214420965956
cycle= 12 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 4.1e-09  |ddm|= 2.25e-09
HOMO (B2u) = -0.344038004235215  LUMO (B3u) = -0.0263214424504661
cycle= 13 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 3.69e-09  |ddm|= 1.48e-09
HOMO (B2u) = -0.344038004143401  LUMO (B3u) = -0.0263214423662649
cycle= 14 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 3.11e-09  |ddm|= 1.26e-09
HOMO (B2u) = -0.344038003955598  LUMO (B3u) = -0.0263214422137809
cycle= 15 E= -75.3207863413851  delta_E=    0  |g|= 9.32e-10  |ddm|= 5.21e-09
HOMO (B2u) = -0.344038003851174  LUMO (B3u) = -0.0263214422045425
cycle= 16 E= -75.3207863413851  delta_E= -5.68e-14  |g|= 8.98e-10  |ddm|= 1.22e-09
HOMO (B2u) = -0.34403800388924  LUMO (B3u) = -0.0263214421914407
cycle= 17 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 9.61e-10  |ddm|= 9.8e-10
HOMO (B2u) = -0.344038003858523  LUMO (B3u) = -0.0263214421653593
cycle= 18 E= -75.3207863413852  delta_E= 2.84e-14  |g|= 7.37e-10  |ddm|= 5.28e-10
HOMO (B2u) = -0.344038003858572  LUMO (B3u) = -0.0263214421728071
cycle= 19 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 6.17e-10  |ddm|= 4.19e-10
HOMO (B2u) = -0.3440380038613  LUMO (B3u) = -0.0263214421815347
cycle= 20 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 5.15e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.344038003849511  LUMO (B3u) = -0.0263214421727787
cycle= 21 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 4.04e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.344038003841708  LUMO (B3u) = -0.026321442169123
cycle= 22 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 2.96e-10  |ddm|= 2.48e-10
HOMO (B2u) = -0.344038003834217  LUMO (B3u) = -0.0263214421655069
cycle= 23 E= -75.3207863413851  delta_E= -5.68e-14  |g|= 2.07e-10  |ddm|= 2.11e-10
HOMO (B2u) = -0.344038003827954  LUMO (B3u) = -0.0263214421623574
cycle= 24 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.79e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.344038003826299  LUMO (B3u) = -0.0263214421599125
cycle= 25 E= -75.3207863413851  delta_E= -2.84e-14  |g|= 1.51e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.344038003822882  LUMO (B3u) = -0.026321442157639
cycle= 26 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 1.23e-10  |ddm|= 7.2e-11
HOMO (B2u) = -0.344038003820043  LUMO (B3u) = -0.0263214421557619
cycle= 27 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.03e-10  |ddm|= 5.49e-11
HOMO (B2u) = -0.34403800381771  LUMO (B3u) = -0.026321442154178
cycle= 28 E= -75.3207863413852  delta_E= -1.14e-13  |g|= 8.37e-11  |ddm|= 4.71e-11
HOMO (B2u) = -0.344038003815912  LUMO (B3u) = -0.0263214421529724
cycle= 29 E= -75.3207863413851  delta_E= 1.14e-13  |g|= 6.66e-11  |ddm|= 4.03e-11
HOMO (B2u) = -0.34403800381439  LUMO (B3u) = -0.0263214421519508
cycle= 30 E= -75.3207863413851  delta_E=    0  |g|= 5.29e-11  |ddm|= 3.22e-11
HOMO (B2u) = -0.344038003810771  LUMO (B3u) = -0.0263214421494699
Extra cycle  E= -75.3207863413851  delta_E= -2.84e-14  |g|= 1.95e-11  |ddm|= 7.79e-11
converged SCF energy = -75.3207863413851

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmppf15737o
max_memory 4000 MB (current use 8705 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4441902032779  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.458167544527  dE = -0.013977341  S^2 = 0.0000000
               |grad[o]|=0.0923  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4696863278004  dE = -0.011518783  S^2 = 0.0000000
               |grad[o]|=0.0772  |ddm|=0.0805  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4782736014103  dE = -0.0085872736  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.0433  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4843087113875  dE = -0.00603511  S^2 = 0.0000000
               |grad[o]|=0.0424  |ddm|=0.0577  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.487659464802  dE = -0.0033507534  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.0723  |maxRot[o]|=0.0598
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4884291461438  dE = -0.00076968134  S^2 = 0.0000000
               |grad[o]|=0.0102  |ddm|=0.0384  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4887234221597  dE = -0.00029427602  S^2 = 0.0000000
               |grad[o]|=0.00536  |ddm|=0.0131  |maxRot[o]|=0.0349
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4887546649271  dE = -3.1242767e-05  S^2 = 0.0000000
               |grad[o]|=0.00188  |ddm|=0.00827  |maxRot[o]|=0.0123
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4887576343245  dE = -2.9693974e-06  S^2 = 0.0000000
               |grad[o]|=0.000631  |ddm|=0.00252  |maxRot[o]|=0.00387
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4887579069092  dE = -2.7258466e-07  S^2 = 0.0000000
               |grad[o]|=0.000193  |ddm|=0.000781  |maxRot[o]|=0.00117
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4887579316638  dE = -2.4754598e-08  S^2 = 0.0000000
               |grad[o]|=6.19e-05  |ddm|=0.000237  |maxRot[o]|=0.000356
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4887579338997  dE = -2.2358648e-09  S^2 = 0.0000000
               |grad[o]|=1.84e-05  |ddm|=7.09e-05  |maxRot[o]|=0.000107
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4887579341011  dE = -2.0139623e-10  S^2 = 0.0000000
               |grad[o]|=5.66e-06  |ddm|=2.14e-05  |maxRot[o]|=3.21e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4887579341157  dE = -1.463718e-11  S^2 = 0.0000000
               |grad[o]|=1.71e-06  |ddm|=6.48e-06  |maxRot[o]|=9.76e-06
2-step CASSCF converged in 14 macro (56 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95981392 1.93127287 1.89228264 1.77943939 0.07180266 0.22650184
 0.05783603 0.08105066]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01133   0.01013  -0.00414   0.00000   0.00000
  0 C 2s       0.65705   0.65938  -0.26022  -0.00000  -0.00000
  0 C 3s      -0.00998   0.01639  -0.04128   0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69378
  0 C 2py     -0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.25932  -0.25424   0.65514  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06179
  0 C 3py     -0.00000   0.00000   0.00000   0.05203   0.00000
  0 C 3pz     -0.01577  -0.00197   0.00765   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.03378   0.00000
  0 C 3dz^2    0.02382  -0.01278   0.03532  -0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000  -0.12186
 0 C 3dx2-y2  -0.00000   0.00665  -0.00734  -0.00000   0.00000
  1 C 1s       0.01133  -0.01013  -0.00414   0.00000   0.00000
  1 C 2s       0.65705  -0.65938  -0.26022  -0.00000  -0.00000
  1 C 3s      -0.00998  -0.01639  -0.04128   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69378
  1 C 2py     -0.00000   0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.25932  -0.25424  -0.65514  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06179
  1 C 3py      0.00000  -0.00000  -0.00000   0.05203  -0.00000
  1 C 3pz      0.01577  -0.00197  -0.00765  -0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03378   0.00000
  1 C 3dz^2    0.02382   0.01278   0.03532   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12186
 1 C 3dx2-y2  -0.00000  -0.00665  -0.00734  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000  -0.00000   0.25300
  0 C 3s      -0.00000   0.00000   0.03435
  0 C 2px     -0.00000   0.69779  -0.00000
  0 C 2py      0.70690   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.65775
  0 C 3px     -0.00000  -0.00738  -0.00000
  0 C 3py     -0.01256  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.04088
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01132  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00778
  0 C 3dxz    -0.00000  -0.11419   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02095
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s      -0.00000  -0.00000  -0.25300
  1 C 3s       0.00000   0.00000  -0.03435
  1 C 2px      0.00000  -0.69779  -0.00000
  1 C 2py     -0.70690   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.65775
  1 C 3px      0.00000   0.00738   0.00000
  1 C 3py      0.01256   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04088
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01132  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00778
  1 C 3dxz    -0.00000  -0.11419  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02095
<CAS-nat-orb|mo-hf>  3  3    0.99891159
<CAS-nat-orb|mo-hf>  4  4    0.99971276
<CAS-nat-orb|mo-hf>  5  5    0.99892918
<CAS-nat-orb|mo-hf>  6  6    0.99899872
<CAS-nat-orb|mo-hf>  7  7    0.93636100
<CAS-nat-orb|mo-hf>  8  8    0.97867430
<CAS-nat-orb|mo-hf>  9  9    0.95989984
<CAS-nat-orb|mo-hf>  10  10    0.91658565
CASSCF energy = -75.4887579341157
CASCI E = -75.4887579341157  E(CI) = -15.3435702518704  S^2 = 0.0000000
......production of RDMs took       3.85 sec
......reading the RDM took          0.46 sec
......production of RDMs took      27.75 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.81 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000024340
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000006429
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000377115
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000048909
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000230203
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000660075
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000220025
HMAT symm error =    0.0110786171
E(MRCI) - E(ref) = -0.114976524738637 DC = -0.00597882999265417
E(WickICMRCISD)   = -75.60373445885433  E_corr_ci = -0.114976524738637
E(WickICMRCISD+Q) = -75.60971328884699  E_corr_ci = -0.1209553547312911
Time cost =   3291.395
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 19:14:42 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.878579098766 AA    0.000000000000   0.000000000000   3.550000000000 Bohr   0.0

nuclear repulsion = 10.1408450704225
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.775]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1614343.66


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpm7c8s450
max_memory 4000 MB (current use 8711 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.755922874727

WARN: Singularity detected in overlap matrix (condition number = 98.8). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.113183134036075  LUMO (B3u) = -0.113183134036075

WARN: B2u HOMO -0.113183134036075 > system LUMO -0.113183134036075

cycle= 1 E= -75.287473469352  delta_E= -0.532  |g|= 0.242  |ddm|= 1.48
HOMO (B2u) = -0.370939595595209  LUMO (B3u) = -0.0596135835397201
cycle= 2 E= -75.3109303175841  delta_E= -0.0235  |g|= 0.0489  |ddm|= 0.349
HOMO (B2u) = -0.335857476925405  LUMO (B3u) = -0.0198166980956899
cycle= 3 E= -75.3123050204643  delta_E= -0.00137  |g|= 0.0178  |ddm|= 0.0646
HOMO (B2u) = -0.340305747412609  LUMO (B3u) = -0.0241187549333964
cycle= 4 E= -75.3125256665475  delta_E= -0.000221  |g|= 0.000662  |ddm|= 0.0362
HOMO (B2u) = -0.340473004463874  LUMO (B3u) = -0.0244347316795402
cycle= 5 E= -75.3125258326695  delta_E= -1.66e-07  |g|= 0.000114  |ddm|= 0.000883
HOMO (B2u) = -0.340435552234747  LUMO (B3u) = -0.0244019229355891
cycle= 6 E= -75.3125258401167  delta_E= -7.45e-09  |g|= 1.75e-05  |ddm|= 0.000196
HOMO (B2u) = -0.340433109442996  LUMO (B3u) = -0.0244024220699501
cycle= 7 E= -75.3125258403105  delta_E= -1.94e-10  |g|= 1.93e-06  |ddm|= 3.69e-05
HOMO (B2u) = -0.340432553987336  LUMO (B3u) = -0.0244022873481917
cycle= 8 E= -75.3125258403128  delta_E= -2.3e-12  |g|= 1.26e-07  |ddm|= 4e-06
HOMO (B2u) = -0.340432558917047  LUMO (B3u) = -0.0244022873230074
cycle= 9 E= -75.3125258403128  delta_E= -2.84e-14  |g|= 8.37e-09  |ddm|= 2.82e-07
HOMO (B2u) = -0.340432558754947  LUMO (B3u) = -0.0244022890121892
cycle= 10 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 6.6e-09  |ddm|= 7.96e-09
HOMO (B2u) = -0.340432558578542  LUMO (B3u) = -0.0244022888598054
cycle= 11 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 4.82e-09  |ddm|= 5.19e-09
HOMO (B2u) = -0.340432557195132  LUMO (B3u) = -0.024402287416901
cycle= 12 E= -75.312525840313  delta_E= -1.42e-13  |g|= 4.25e-09  |ddm|= 2.4e-09
HOMO (B2u) = -0.340432557527146  LUMO (B3u) = -0.0244022877527925
cycle= 13 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 3.83e-09  |ddm|= 1.59e-09
HOMO (B2u) = -0.340432557415096  LUMO (B3u) = -0.0244022876441997
cycle= 14 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 3.17e-09  |ddm|= 1.55e-09
HOMO (B2u) = -0.340432557231977  LUMO (B3u) = -0.0244022875215862
cycle= 15 E= -75.3125258403129  delta_E=    0  |g|= 9.91e-10  |ddm|= 5.61e-09
HOMO (B2u) = -0.340432557132607  LUMO (B3u) = -0.0244022875080979
cycle= 16 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 9.51e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.340432557163374  LUMO (B3u) = -0.0244022874951745
cycle= 17 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 1.02e-09  |ddm|= 8.59e-10
HOMO (B2u) = -0.34043255712963  LUMO (B3u) = -0.0244022874689911
cycle= 18 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 7.86e-10  |ddm|= 5.81e-10
HOMO (B2u) = -0.340432557127468  LUMO (B3u) = -0.0244022874756969
cycle= 19 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 6.48e-10  |ddm|= 4.67e-10
HOMO (B2u) = -0.340432557128436  LUMO (B3u) = -0.0244022874838917
cycle= 20 E= -75.3125258403128  delta_E= -2.84e-14  |g|= 5.37e-10  |ddm|= 3.25e-10
HOMO (B2u) = -0.340432557114878  LUMO (B3u) = -0.0244022874745592
cycle= 21 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 4.2e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.340432557105277  LUMO (B3u) = -0.0244022874701126
cycle= 22 E= -75.3125258403128  delta_E= 2.84e-14  |g|= 3.06e-10  |ddm|= 2.69e-10
HOMO (B2u) = -0.340432557096  LUMO (B3u) = -0.0244022874658634
cycle= 23 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 2.17e-10  |ddm|= 2.24e-10
HOMO (B2u) = -0.340432557089279  LUMO (B3u) = -0.0244022874625686
cycle= 24 E= -75.3125258403129  delta_E=    0  |g|= 1.88e-10  |ddm|= 7.9e-11
HOMO (B2u) = -0.34043255708676  LUMO (B3u) = -0.0244022874599234
cycle= 25 E= -75.3125258403128  delta_E= 1.14e-13  |g|= 1.58e-10  |ddm|= 7.17e-11
HOMO (B2u) = -0.340432557082767  LUMO (B3u) = -0.0244022874574695
cycle= 26 E= -75.3125258403128  delta_E= -5.68e-14  |g|= 1.28e-10  |ddm|= 7.98e-11
HOMO (B2u) = -0.340432557079513  LUMO (B3u) = -0.0244022874554742
cycle= 27 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 1.06e-10  |ddm|= 6.11e-11
HOMO (B2u) = -0.340432557076834  LUMO (B3u) = -0.0244022874537976
cycle= 28 E= -75.3125258403128  delta_E=    0  |g|= 8.57e-11  |ddm|= 5.1e-11
HOMO (B2u) = -0.340432557070014  LUMO (B3u) = -0.0244022874496095
Extra cycle  E= -75.3125258403128  delta_E=    0  |g|= 3.07e-11  |ddm|= 1.34e-10
converged SCF energy = -75.3125258403128

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpm7c8s450
max_memory 4000 MB (current use 8711 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4401587585067  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4545820280337  dE = -0.01442327  S^2 = 0.0000000
               |grad[o]|=0.0942  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.466273131342  dE = -0.011691103  S^2 = 0.0000000
               |grad[o]|=0.0778  |ddm|=0.0854  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4747186173491  dE = -0.008445486  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.0439  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4804815517801  dE = -0.0057629344  S^2 = 0.0000000
               |grad[o]|= 0.04  |ddm|=0.0656  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4831482679985  dE = -0.0026667162  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.0733  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4838263888482  dE = -0.00067812085  S^2 = 0.0000000
               |grad[o]|=0.00923  |ddm|=0.0307  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4840373805917  dE = -0.00021099174  S^2 = 0.0000000
               |grad[o]|=0.00452  |ddm|=0.0109  |maxRot[o]|=0.0302
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4840578015726  dE = -2.0420981e-05  S^2 = 0.0000000
               |grad[o]|=0.00157  |ddm|=0.00639  |maxRot[o]|= 0.01
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4840596374039  dE = -1.8358312e-06  S^2 = 0.0000000
               |grad[o]|=0.000514  |ddm|=0.00193  |maxRot[o]|=0.00306
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4840597985685  dE = -1.6116462e-07  S^2 = 0.0000000
               |grad[o]|=0.000153  |ddm|=0.00059  |maxRot[o]|=0.000904
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4840598125584  dE = -1.3989947e-08  S^2 = 0.0000000
               |grad[o]|=4.79e-05  |ddm|=0.000175  |maxRot[o]|=0.000268
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4840598137758  dE = -1.2173871e-09  S^2 = 0.0000000
               |grad[o]|=1.41e-05  |ddm|=5.18e-05  |maxRot[o]|=7.9e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4840598138815  dE = -1.0564349e-10  S^2 = 0.0000000
               |grad[o]|=4.22e-06  |ddm|=1.53e-05  |maxRot[o]|=2.34e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4840598138905  dE = -9.0523145e-12  S^2 = 0.0000000
               |grad[o]|=1.24e-06  |ddm|=4.51e-06  |maxRot[o]|=6.88e-06
2-step CASSCF converged in 14 macro (56 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95901066 1.93191387 1.8886991  1.76663822 0.07041578 0.23918108
 0.05753793 0.08660336]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01153   0.01022  -0.00378   0.00000   0.00000
  0 C 2s       0.66488   0.66240  -0.23954  -0.00000  -0.00000
  0 C 3s      -0.00763   0.01613  -0.03939  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69368
  0 C 2py      0.00000  -0.00000  -0.00000   0.70438  -0.00000
  0 C 2pz      0.23883  -0.24630   0.66308  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06285
  0 C 3py     -0.00000  -0.00000  -0.00000   0.05282  -0.00000
  0 C 3pz     -0.01454  -0.00188   0.00916  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.00000  -0.00000   0.03256  -0.00000
  0 C 3dz^2    0.02207  -0.01238   0.03528  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.12191
 0 C 3dx2-y2   0.00028   0.00654  -0.00728   0.00000  -0.00000
  1 C 1s       0.01153  -0.01022  -0.00378   0.00000   0.00000
  1 C 2s       0.66488  -0.66240  -0.23954   0.00000   0.00000
  1 C 3s      -0.00763  -0.01613  -0.03939   0.00000   0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69368
  1 C 2py      0.00000  -0.00000   0.00000   0.70438   0.00000
  1 C 2pz     -0.23883  -0.24630  -0.66308   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06285
  1 C 3py     -0.00000   0.00000   0.00000   0.05282   0.00000
  1 C 3pz      0.01454  -0.00188  -0.00916  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03256  -0.00000
  1 C 3dz^2    0.02207   0.01238   0.03528   0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12191
 1 C 3dx2-y2   0.00028  -0.00654  -0.00728   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00035
  0 C 2s      -0.00000  -0.00000   0.24517
  0 C 3s      -0.00000  -0.00000   0.03335
  0 C 2px     -0.00000   0.69791  -0.00000
  0 C 2py      0.70694   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.66096
  0 C 3px      0.00000  -0.00931  -0.00000
  0 C 3py     -0.01055  -0.00000   0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03822
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.01090  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00694
  0 C 3dxz     0.00000  -0.11326  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01984
  1 C 1s       0.00000   0.00000   0.00035
  1 C 2s       0.00000   0.00000  -0.24517
  1 C 3s       0.00000   0.00000  -0.03335
  1 C 2px     -0.00000  -0.69791  -0.00000
  1 C 2py     -0.70694   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.66096
  1 C 3px      0.00000   0.00931   0.00000
  1 C 3py      0.01055  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03822
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01090   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00694
  1 C 3dxz    -0.00000  -0.11326  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01984
<CAS-nat-orb|mo-hf>  3  3    0.99958549
<CAS-nat-orb|mo-hf>  4  4    0.99970353
<CAS-nat-orb|mo-hf>  5  5    0.99960080
<CAS-nat-orb|mo-hf>  6  6    0.99894173
<CAS-nat-orb|mo-hf>  7  7    0.93559186
<CAS-nat-orb|mo-hf>  8  8    0.97993346
<CAS-nat-orb|mo-hf>  9  9    0.96008674
<CAS-nat-orb|mo-hf>  10  10    0.92430540
CASSCF energy = -75.4840598138905
CASCI E = -75.4840598138905  E(CI) = -15.2745978794696  S^2 = 0.0000000
......production of RDMs took       7.40 sec
......reading the RDM took          0.46 sec
......production of RDMs took     100.25 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.10 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000064914
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000017146
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000732041
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000085357
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000455119
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0001037765
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000345922
HMAT symm error =    0.0156811358
E(MRCI) - E(ref) = -0.115174804606383 DC = -0.006023705576391935
E(WickICMRCISD)   = -75.59923461849689  E_corr_ci = -0.115174804606383
E(WickICMRCISD+Q) = -75.60525832407329  E_corr_ci = -0.1211985101827749
Time cost =   3364.288
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 20:10:46 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.905037959312 AA    0.000000000000   0.000000000000   3.600000000000 Bohr   0.0

nuclear repulsion = 10
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.8]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1668082.48


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpuared9mw
max_memory 4000 MB (current use 8713 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7418315703506

WARN: Singularity detected in overlap matrix (condition number = 92.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.11001988110011  LUMO (B3u) = -0.11001988110011

WARN: B2u HOMO -0.11001988110011 > system LUMO -0.11001988110011

cycle= 1 E= -75.2796395081188  delta_E= -0.538  |g|= 0.24  |ddm|= 1.48
HOMO (B2u) = -0.366960154497  LUMO (B3u) = -0.0572442637655636
cycle= 2 E= -75.3027407260661  delta_E= -0.0231  |g|= 0.0483  |ddm|= 0.349
HOMO (B2u) = -0.332387624443795  LUMO (B3u) = -0.0179860460523905
cycle= 3 E= -75.3040943705399  delta_E= -0.00135  |g|= 0.0177  |ddm|= 0.0637
HOMO (B2u) = -0.336815650622684  LUMO (B3u) = -0.0222589901147891
cycle= 4 E= -75.3043133588736  delta_E= -0.000219  |g|= 0.000659  |ddm|= 0.0358
HOMO (B2u) = -0.336986521904539  LUMO (B3u) = -0.0225780980112818
cycle= 5 E= -75.3043135231658  delta_E= -1.64e-07  |g|= 0.000118  |ddm|= 0.000867
HOMO (B2u) = -0.336949107818825  LUMO (B3u) = -0.0225461573189892
cycle= 6 E= -75.304313531111  delta_E= -7.95e-09  |g|= 1.79e-05  |ddm|= 0.000202
HOMO (B2u) = -0.336946583100421  LUMO (B3u) = -0.0225465689188807
cycle= 7 E= -75.3043135313143  delta_E= -2.03e-10  |g|= 1.93e-06  |ddm|= 3.75e-05
HOMO (B2u) = -0.33694605225586  LUMO (B3u) = -0.0225464651749517
cycle= 8 E= -75.3043135313167  delta_E= -2.39e-12  |g|= 1.28e-07  |ddm|= 3.99e-06
HOMO (B2u) = -0.336946056653499  LUMO (B3u) = -0.0225464645227561
cycle= 9 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 8.64e-09  |ddm|= 2.92e-07
HOMO (B2u) = -0.336946056352744  LUMO (B3u) = -0.0225464661350554
cycle= 10 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 6.9e-09  |ddm|= 7.93e-09
HOMO (B2u) = -0.336946056204075  LUMO (B3u) = -0.022546466027244
cycle= 11 E= -75.3043135313167  delta_E=    0  |g|= 5e-09  |ddm|= 5.47e-09
HOMO (B2u) = -0.336946054829705  LUMO (B3u) = -0.0225464645959414
cycle= 12 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 4.37e-09  |ddm|= 2.55e-09
HOMO (B2u) = -0.336946055134035  LUMO (B3u) = -0.0225464649077606
cycle= 13 E= -75.3043135313167  delta_E=    0  |g|= 3.93e-09  |ddm|= 1.64e-09
HOMO (B2u) = -0.336946055006462  LUMO (B3u) = -0.0225464647809869
cycle= 14 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 3.23e-09  |ddm|= 1.79e-09
HOMO (B2u) = -0.33694605481691  LUMO (B3u) = -0.0225464646820566
cycle= 15 E= -75.3043135313167  delta_E=    0  |g|= 1.03e-09  |ddm|= 5.76e-09
HOMO (B2u) = -0.336946054733919  LUMO (B3u) = -0.0225464646668242
cycle= 16 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 1.01e-09  |ddm|= 1.16e-09
HOMO (B2u) = -0.336946054756348  LUMO (B3u) = -0.0225464646548156
cycle= 17 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 1.07e-09  |ddm|= 6.91e-10
HOMO (B2u) = -0.336946054720463  LUMO (B3u) = -0.0225464646290975
cycle= 18 E= -75.3043135313167  delta_E= 4.26e-14  |g|= 8.28e-10  |ddm|= 6.21e-10
HOMO (B2u) = -0.336946054716361  LUMO (B3u) = -0.0225464646352981
cycle= 19 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 6.75e-10  |ddm|= 5.08e-10
HOMO (B2u) = -0.336946054716006  LUMO (B3u) = -0.0225464646432749
cycle= 20 E= -75.3043135313166  delta_E= 4.26e-14  |g|= 5.55e-10  |ddm|= 3.53e-10
HOMO (B2u) = -0.336946054701177  LUMO (B3u) = -0.0225464646337962
cycle= 21 E= -75.3043135313167  delta_E= -9.95e-14  |g|= 4.34e-10  |ddm|= 3.09e-10
HOMO (B2u) = -0.336946054690181  LUMO (B3u) = -0.0225464646289064
cycle= 22 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 3.16e-10  |ddm|= 2.86e-10
HOMO (B2u) = -0.336946054679549  LUMO (B3u) = -0.0225464646243564
cycle= 23 E= -75.3043135313166  delta_E= 7.11e-14  |g|= 2.25e-10  |ddm|= 2.36e-10
HOMO (B2u) = -0.336946054672853  LUMO (B3u) = -0.0225464646210285
cycle= 24 E= -75.3043135313166  delta_E= -2.84e-14  |g|= 1.95e-10  |ddm|= 8.13e-11
HOMO (B2u) = -0.336946054669537  LUMO (B3u) = -0.0225464646182657
cycle= 25 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 1.63e-10  |ddm|= 7.74e-11
HOMO (B2u) = -0.336946054665105  LUMO (B3u) = -0.0225464646157189
cycle= 26 E= -75.3043135313166  delta_E= 4.26e-14  |g|= 1.31e-10  |ddm|= 8.61e-11
HOMO (B2u) = -0.336946054661539  LUMO (B3u) = -0.0225464646136726
cycle= 27 E= -75.3043135313166  delta_E= 1.42e-14  |g|= 1.08e-10  |ddm|= 6.62e-11
HOMO (B2u) = -0.336946054658601  LUMO (B3u) = -0.0225464646119541
cycle= 28 E= -75.3043135313165  delta_E= 1.42e-13  |g|= 8.69e-11  |ddm|= 5.42e-11
HOMO (B2u) = -0.336946054656287  LUMO (B3u) = -0.0225464646106319
cycle= 29 E= -75.3043135313164  delta_E= 4.26e-14  |g|= 6.88e-11  |ddm|= 4.51e-11
HOMO (B2u) = -0.336946054654358  LUMO (B3u) = -0.0225464646095273
cycle= 30 E= -75.3043135313164  delta_E= 5.68e-14  |g|= 5.45e-11  |ddm|= 3.55e-11
HOMO (B2u) = -0.336946054652903  LUMO (B3u) = -0.0225464646087119
cycle= 31 E= -75.3043135313162  delta_E= 1.71e-13  |g|= 4.43e-11  |ddm|= 2.6e-11
HOMO (B2u) = -0.336946054651859  LUMO (B3u) = -0.0225464646081071
cycle= 32 E= -75.304313531316  delta_E= 2.42e-13  |g|= 3.72e-11  |ddm|= 1.83e-11
HOMO (B2u) = -0.336946054651024  LUMO (B3u) = -0.0225464646075892
cycle= 33 E= -75.3043135313158  delta_E= 1.14e-13  |g|= 3.13e-11  |ddm|= 1.59e-11
HOMO (B2u) = -0.336946054650276  LUMO (B3u) = -0.0225464646071504
cycle= 34 E= -75.3043135313156  delta_E= 2.13e-13  |g|= 2.66e-11  |ddm|= 1.34e-11
HOMO (B2u) = -0.336946054649659  LUMO (B3u) = -0.0225464646067815
cycle= 35 E= -75.3043135313153  delta_E= 3.69e-13  |g|= 2.29e-11  |ddm|= 1.08e-11
HOMO (B2u) = -0.336946054649136  LUMO (B3u) = -0.0225464646064567
cycle= 36 E= -75.3043135313148  delta_E= 4.83e-13  |g|= 1.96e-11  |ddm|= 9.1e-12
HOMO (B2u) = -0.336946054648687  LUMO (B3u) = -0.0225464646061657
cycle= 37 E= -75.3043135313142  delta_E= 5.68e-13  |g|= 1.7e-11  |ddm|= 7.54e-12
HOMO (B2u) = -0.336946054648295  LUMO (B3u) = -0.0225464646059003
cycle= 38 E= -75.3043135313138  delta_E= 4.12e-13  |g|= 1.48e-11  |ddm|= 6.24e-12
HOMO (B2u) = -0.336946054647947  LUMO (B3u) = -0.0225464646056519
cycle= 39 E= -75.3043135313132  delta_E= 5.68e-13  |g|= 1.29e-11  |ddm|= 5.33e-12
HOMO (B2u) = -0.336946054647627  LUMO (B3u) = -0.0225464646054094
cycle= 40 E= -75.3043135313125  delta_E= 7.11e-13  |g|= 1.15e-11  |ddm|= 4.43e-12
HOMO (B2u) = -0.336946054647315  LUMO (B3u) = -0.0225464646051576
cycle= 41 E= -75.3043135313117  delta_E= 7.67e-13  |g|= 1.01e-11  |ddm|= 4.17e-12
HOMO (B2u) = -0.336946054647001  LUMO (B3u) = -0.0225464646048902
cycle= 42 E= -75.304313531311  delta_E= 7.11e-13  |g|= 9.08e-12  |ddm|= 3.5e-12
HOMO (B2u) = -0.336946054646684  LUMO (B3u) = -0.0225464646046069
cycle= 43 E= -75.3043135313104  delta_E= 6.25e-13  |g|= 8.08e-12  |ddm|= 3.01e-12
HOMO (B2u) = -0.336946054646367  LUMO (B3u) = -0.0225464646043096
cycle= 44 E= -75.3043135313098  delta_E= 5.97e-13  |g|= 7.38e-12  |ddm|= 2.7e-12
HOMO (B2u) = -0.336946054646049  LUMO (B3u) = -0.022546464604003
cycle= 45 E= -75.3043135313093  delta_E= 5.12e-13  |g|= 6.59e-12  |ddm|= 2.37e-12
HOMO (B2u) = -0.336946054645731  LUMO (B3u) = -0.0225464646036864
cycle= 46 E= -75.3043135313086  delta_E= 7.11e-13  |g|= 6.22e-12  |ddm|= 2.26e-12
HOMO (B2u) = -0.336946054645403  LUMO (B3u) = -0.0225464646033532
cycle= 47 E= -75.3043135313079  delta_E= 7.11e-13  |g|= 6.02e-12  |ddm|= 2.12e-12
HOMO (B2u) = -0.336946054645064  LUMO (B3u) = -0.0225464646030041
cycle= 48 E= -75.3043135313074  delta_E= 5.12e-13  |g|= 5.56e-12  |ddm|= 2.3e-12
HOMO (B2u) = -0.336946054644728  LUMO (B3u) = -0.0225464646026561
cycle= 49 E= -75.3043135313068  delta_E= 5.4e-13  |g|= 5.17e-12  |ddm|= 2.13e-12
HOMO (B2u) = -0.336946054644397  LUMO (B3u) = -0.0225464646023124
cycle= 50 E= -75.3043135313063  delta_E= 4.83e-13  |g|= 4.6e-12  |ddm|= 2.26e-12
SCF not converged.
SCF energy = -75.3043135313063

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpuared9mw
max_memory 4000 MB (current use 8713 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4361879187434  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4510674042747  dE = -0.014879486  S^2 = 0.0000000
               |grad[o]|=0.0962  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4629189235359  dE = -0.011851519  S^2 = 0.0000000
               |grad[o]|=0.0783  |ddm|=0.0904  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4711959375446  dE = -0.008277014  S^2 = 0.0000000
               |grad[o]|=0.0578  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4766896838971  dE = -0.0054937464  S^2 = 0.0000000
               |grad[o]|=0.0374  |ddm|=0.0747  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4787687090164  dE = -0.0020790251  S^2 = 0.0000000
               |grad[o]|=0.0177  |ddm|=0.0719  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4793255751258  dE = -0.00055686611  S^2 = 0.0000000
               |grad[o]|=0.00796  |ddm|=0.0238  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4794395830796  dE = -0.00011400795  S^2 = 0.0000000
               |grad[o]|=0.00351  |ddm|=0.00912  |maxRot[o]|= 0.02
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4794610609727  dE = -2.1477893e-05  S^2 = 0.0000000
               |grad[o]|=0.00156  |ddm|=0.00383  |maxRot[o]|=0.0103
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4794629155068  dE = -1.8545341e-06  S^2 = 0.0000000
               |grad[o]|=0.000524  |ddm|=0.0019  |maxRot[o]|=0.00308
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4794630731664  dE = -1.5765957e-07  S^2 = 0.0000000
               |grad[o]|=0.000157  |ddm|=0.000572  |maxRot[o]|=0.000897
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4794630864324  dE = -1.3266018e-08  S^2 = 0.0000000
               |grad[o]|=4.79e-05  |ddm|=0.000168  |maxRot[o]|=0.000261
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4794630875505  dE = -1.11811e-09  S^2 = 0.0000000
               |grad[o]|=1.38e-05  |ddm|=4.9e-05  |maxRot[o]|=7.6e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.479463087644  dE = -9.343637e-11  S^2 = 0.0000000
               |grad[o]|=4.16e-06  |ddm|=1.42e-05  |maxRot[o]|=2.21e-05
2-step CASSCF converged in 13 macro (53 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95829685 1.93254562 1.88457147 1.75318651 0.06913522 0.25249636
 0.05723696 0.09253102]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01171   0.01031  -0.00343   0.00000   0.00000
  0 C 2s       0.67180   0.66526  -0.21945   0.00000  -0.00000
  0 C 3s      -0.00547   0.01587  -0.03746   0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69361
  0 C 2py      0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.21892  -0.23851   0.67009   0.00000  -0.00000
  0 C 3px      0.00000   0.00000   0.00000   0.00000  -0.06384
  0 C 3py      0.00000   0.00000   0.00000   0.05350  -0.00000
  0 C 3pz     -0.01342  -0.00181   0.01074   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000   0.03134   0.00000
  0 C 3dz^2    0.02038  -0.01199   0.03514   0.00000   0.00000
  0 C 3dxz     0.00000   0.00000   0.00000  -0.00000  -0.12178
 0 C 3dx2-y2   0.00055   0.00643  -0.00721  -0.00000  -0.00000
  1 C 1s       0.01171  -0.01031  -0.00343   0.00000   0.00000
  1 C 2s       0.67180  -0.66526  -0.21945  -0.00000  -0.00000
  1 C 3s      -0.00547  -0.01587  -0.03746  -0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69361
  1 C 2py     -0.00000  -0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.21892  -0.23851  -0.67009   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06384
  1 C 3py     -0.00000  -0.00000  -0.00000   0.05350  -0.00000
  1 C 3pz      0.01342  -0.00181  -0.01074   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.03134   0.00000
  1 C 3dz^2    0.02038   0.01199   0.03514  -0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12178
 1 C 3dx2-y2   0.00055  -0.00643  -0.00721   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00032
  0 C 2s       0.00000  -0.00000   0.23748
  0 C 3s      -0.00000  -0.00000   0.03235
  0 C 2px      0.00000   0.69804  -0.00000
  0 C 2py      0.70698  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.66400
  0 C 3px     -0.00000  -0.01120  -0.00000
  0 C 3py     -0.00856  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03555
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01047  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00616
  0 C 3dxz    -0.00000  -0.11230  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01875
  1 C 1s       0.00000   0.00000   0.00032
  1 C 2s       0.00000  -0.00000  -0.23748
  1 C 3s       0.00000   0.00000  -0.03235
  1 C 2px      0.00000  -0.69804   0.00000
  1 C 2py     -0.70698   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66400
  1 C 3px     -0.00000   0.01120   0.00000
  1 C 3py      0.00856   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03555
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01047  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00616
  1 C 3dxz     0.00000  -0.11230  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01875
<CAS-nat-orb|mo-hf>  3  3    0.99985292
<CAS-nat-orb|mo-hf>  4  4    0.99969360
<CAS-nat-orb|mo-hf>  5  5    0.99986456
<CAS-nat-orb|mo-hf>  6  6    0.99888267
<CAS-nat-orb|mo-hf>  7  7    0.93493360
<CAS-nat-orb|mo-hf>  8  8    0.98111604
<CAS-nat-orb|mo-hf>  9  9    0.96025422
<CAS-nat-orb|mo-hf>  10  10    0.93117475
CASSCF energy = -75.479463087644
CASCI E = -75.479463087644  E(CI) = -15.2075075478094  S^2 = 0.0000000
......production of RDMs took       3.00 sec
......reading the RDM took          0.60 sec
......production of RDMs took      28.63 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.93 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000055893
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000014763
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000469116
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000056715
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000290916
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000798554
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000266185
HMAT symm error =    0.0128613302
E(MRCI) - E(ref) = -0.1153742312962294 DC = -0.006068752024020652
E(WickICMRCISD)   = -75.59483731894019  E_corr_ci = -0.1153742312962294
E(WickICMRCISD+Q) = -75.60090607096421  E_corr_ci = -0.12144298332025
Time cost =   2946.694
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 20:59:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.931496819858 AA    0.000000000000   0.000000000000   3.650000000000 Bohr   0.0

nuclear repulsion = 9.86301369863014
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.825]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1719029.79


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp60htz85q
max_memory 4000 MB (current use 8711 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7286668554631

WARN: Singularity detected in overlap matrix (condition number = 86.3). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.107001630831574  LUMO (B3u) = -0.107001630831574

WARN: B2u HOMO -0.107001630831574 > system LUMO -0.107001630831574

cycle= 1 E= -75.2718520447977  delta_E= -0.543  |g|= 0.238  |ddm|= 1.48
HOMO (B2u) = -0.363117515186497  LUMO (B3u) = -0.0549592840356633
cycle= 2 E= -75.2946135925964  delta_E= -0.0228  |g|= 0.0477  |ddm|= 0.349
HOMO (B2u) = -0.329037998444989  LUMO (B3u) = -0.0162218724304535
cycle= 3 E= -75.2959451182036  delta_E= -0.00133  |g|= 0.0175  |ddm|= 0.0628
HOMO (B2u) = -0.333444355785578  LUMO (B3u) = -0.0204649331299245
cycle= 4 E= -75.2961620440469  delta_E= -0.000217  |g|= 0.000656  |ddm|= 0.0354
HOMO (B2u) = -0.333615190019287  LUMO (B3u) = -0.0207831790531227
cycle= 5 E= -75.2961622069416  delta_E= -1.63e-07  |g|= 0.000121  |ddm|= 0.000855
HOMO (B2u) = -0.333577969876335  LUMO (B3u) = -0.0207522115134184
cycle= 6 E= -75.2961622153582  delta_E= -8.42e-09  |g|= 1.83e-05  |ddm|= 0.000208
HOMO (B2u) = -0.333575376692481  LUMO (B3u) = -0.0207525487418174
cycle= 7 E= -75.2961622155709  delta_E= -2.13e-10  |g|= 1.93e-06  |ddm|= 3.81e-05
HOMO (B2u) = -0.333574868730931  LUMO (B3u) = -0.0207524737519143
cycle= 8 E= -75.2961622155733  delta_E= -2.34e-12  |g|= 1.29e-07  |ddm|= 4e-06
HOMO (B2u) = -0.333574872987137  LUMO (B3u) = -0.0207524728268864
cycle= 9 E= -75.2961622155733  delta_E= -5.68e-14  |g|= 8.8e-09  |ddm|= 3e-07
HOMO (B2u) = -0.333574872571759  LUMO (B3u) = -0.0207524743926053
cycle= 10 E= -75.2961622155732  delta_E= 8.53e-14  |g|= 7.1e-09  |ddm|= 7.86e-09
HOMO (B2u) = -0.333574872450829  LUMO (B3u) = -0.0207524743252671
cycle= 11 E= -75.2961622155734  delta_E= -1.28e-13  |g|= 5.12e-09  |ddm|= 5.67e-09
HOMO (B2u) = -0.333574871097617  LUMO (B3u) = -0.0207524729163974
cycle= 12 E= -75.2961622155733  delta_E= 9.95e-14  |g|= 4.45e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.333574871371889  LUMO (B3u) = -0.0207524732023052
cycle= 13 E= -75.2961622155733  delta_E=    0  |g|= 4e-09  |ddm|= 1.72e-09
HOMO (B2u) = -0.333574871232241  LUMO (B3u) = -0.0207524730610019
cycle= 14 E= -75.2961622155733  delta_E= -5.68e-14  |g|= 3.27e-09  |ddm|= 2e-09
HOMO (B2u) = -0.333574871044342  LUMO (B3u) = -0.0207524729849
cycle= 15 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 1.05e-09  |ddm|= 6.09e-09
HOMO (B2u) = -0.333574870948568  LUMO (B3u) = -0.0207524729724885
cycle= 16 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 9.82e-10  |ddm|= 1.12e-09
HOMO (B2u) = -0.33357487098377  LUMO (B3u) = -0.0207524729552194
cycle= 17 E= -75.2961622155733  delta_E=    0  |g|= 1.1e-09  |ddm|= 1.11e-09
HOMO (B2u) = -0.333574870946634  LUMO (B3u) = -0.0207524729305071
cycle= 18 E= -75.2961622155733  delta_E= 4.26e-14  |g|= 8.5e-10  |ddm|= 6.48e-10
HOMO (B2u) = -0.333574870941364  LUMO (B3u) = -0.0207524729366941
cycle= 19 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 6.86e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.333574870940211  LUMO (B3u) = -0.0207524729448027
cycle= 20 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 5.62e-10  |ddm|= 3.75e-10
HOMO (B2u) = -0.333574870924655  LUMO (B3u) = -0.0207524729356255
cycle= 21 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 4.37e-10  |ddm|= 3.24e-10
HOMO (B2u) = -0.333574870912727  LUMO (B3u) = -0.02075247293063
cycle= 22 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 3.18e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.333574870901193  LUMO (B3u) = -0.0207524729260978
cycle= 23 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 2.27e-10  |ddm|= 2.46e-10
HOMO (B2u) = -0.333574870894272  LUMO (B3u) = -0.0207524729227359
cycle= 24 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 1.96e-10  |ddm|= 8.28e-11
HOMO (B2u) = -0.333574870891265  LUMO (B3u) = -0.0207524729198866
cycle= 25 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 1.66e-10  |ddm|= 7.51e-11
HOMO (B2u) = -0.333574870886561  LUMO (B3u) = -0.0207524729173319
cycle= 26 E= -75.2961622155733  delta_E= -4.26e-14  |g|= 1.33e-10  |ddm|= 9e-11
HOMO (B2u) = -0.333574870882817  LUMO (B3u) = -0.0207524729152981
cycle= 27 E= -75.2961622155731  delta_E= 1.56e-13  |g|= 1.08e-10  |ddm|= 6.94e-11
HOMO (B2u) = -0.333574870879732  LUMO (B3u) = -0.0207524729135876
cycle= 28 E= -75.2961622155731  delta_E= 1.42e-14  |g|= 8.72e-11  |ddm|= 5.59e-11
HOMO (B2u) = -0.333574870877294  LUMO (B3u) = -0.0207524729122674
cycle= 29 E= -75.296162215573  delta_E= 1.14e-13  |g|= 6.89e-11  |ddm|= 4.61e-11
HOMO (B2u) = -0.333574870875279  LUMO (B3u) = -0.0207524729111681
cycle= 30 E= -75.296162215573  delta_E= 5.68e-14  |g|= 5.47e-11  |ddm|= 3.62e-11
HOMO (B2u) = -0.333574870873767  LUMO (B3u) = -0.0207524729103586
cycle= 31 E= -75.2961622155728  delta_E= 1.42e-13  |g|= 4.47e-11  |ddm|= 2.64e-11
HOMO (B2u) = -0.33357487087269  LUMO (B3u) = -0.0207524729097495
cycle= 32 E= -75.2961622155727  delta_E= 1.42e-13  |g|= 3.75e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.333574870871831  LUMO (B3u) = -0.0207524729092289
cycle= 33 E= -75.2961622155725  delta_E= 2.13e-13  |g|= 3.12e-11  |ddm|= 1.61e-11
HOMO (B2u) = -0.33357487087104  LUMO (B3u) = -0.020752472908785
cycle= 34 E= -75.2961622155721  delta_E= 3.41e-13  |g|= 2.65e-11  |ddm|= 1.37e-11
HOMO (B2u) = -0.333574870870387  LUMO (B3u) = -0.0207524729084097
cycle= 35 E= -75.2961622155715  delta_E= 6.11e-13  |g|= 2.25e-11  |ddm|= 1.11e-11
HOMO (B2u) = -0.333574870869832  LUMO (B3u) = -0.0207524729080755
cycle= 36 E= -75.2961622155712  delta_E= 3.41e-13  |g|= 1.92e-11  |ddm|= 9.14e-12
HOMO (B2u) = -0.333574870869354  LUMO (B3u) = -0.0207524729077737
cycle= 37 E= -75.2961622155707  delta_E= 5.12e-13  |g|= 1.67e-11  |ddm|= 7.52e-12
HOMO (B2u) = -0.333574870868938  LUMO (B3u) = -0.020752472907498
cycle= 38 E= -75.2961622155703  delta_E= 3.69e-13  |g|= 1.45e-11  |ddm|= 6.21e-12
HOMO (B2u) = -0.333574870868567  LUMO (B3u) = -0.0207524729072354
cycle= 39 E= -75.2961622155696  delta_E= 6.54e-13  |g|= 1.25e-11  |ddm|= 5.28e-12
HOMO (B2u) = -0.333574870868223  LUMO (B3u) = -0.020752472906975
cycle= 40 E= -75.2961622155689  delta_E= 7.82e-13  |g|= 1.1e-11  |ddm|= 4.54e-12
HOMO (B2u) = -0.333574870867887  LUMO (B3u) = -0.0207524729067023
cycle= 41 E= -75.2961622155681  delta_E= 7.67e-13  |g|= 9.87e-12  |ddm|= 3.91e-12
HOMO (B2u) = -0.333574870867552  LUMO (B3u) = -0.0207524729064177
cycle= 42 E= -75.2961622155674  delta_E= 6.54e-13  |g|= 8.76e-12  |ddm|= 3.4e-12
HOMO (B2u) = -0.333574870867224  LUMO (B3u) = -0.0207524729061229
cycle= 43 E= -75.2961622155668  delta_E= 6.11e-13  |g|= 7.99e-12  |ddm|= 3.11e-12
HOMO (B2u) = -0.3335748708669  LUMO (B3u) = -0.0207524729058206
cycle= 44 E= -75.2961622155662  delta_E= 6.54e-13  |g|= 7.32e-12  |ddm|= 2.72e-12
HOMO (B2u) = -0.333574870866576  LUMO (B3u) = -0.0207524729055087
cycle= 45 E= -75.2961622155655  delta_E= 6.54e-13  |g|= 6.55e-12  |ddm|= 2.35e-12
HOMO (B2u) = -0.333574870866243  LUMO (B3u) = -0.0207524729051786
cycle= 46 E= -75.2961622155648  delta_E= 7.39e-13  |g|= 6.15e-12  |ddm|= 2.28e-12
HOMO (B2u) = -0.333574870865903  LUMO (B3u) = -0.0207524729048363
cycle= 47 E= -75.2961622155642  delta_E= 5.68e-13  |g|= 6.06e-12  |ddm|= 2.09e-12
HOMO (B2u) = -0.333574870865553  LUMO (B3u) = -0.0207524729044786
cycle= 48 E= -75.2961622155637  delta_E= 4.83e-13  |g|= 5.47e-12  |ddm|= 2.33e-12
HOMO (B2u) = -0.333574870865211  LUMO (B3u) = -0.0207524729041284
cycle= 49 E= -75.2961622155633  delta_E= 4.26e-13  |g|= 4.89e-12  |ddm|= 2.41e-12
HOMO (B2u) = -0.33357487086488  LUMO (B3u) = -0.0207524729037903
cycle= 50 E= -75.296162215563  delta_E= 2.84e-13  |g|= 4.36e-12  |ddm|= 2.52e-12
SCF not converged.
SCF energy = -75.296162215563

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp60htz85q
max_memory 4000 MB (current use 8711 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.432291665502  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4476382203368  dE = -0.015346555  S^2 = 0.0000000
               |grad[o]|=0.0982  |ddm|= 3.79  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4596363662675  dE = -0.011998146  S^2 = 0.0000000
               |grad[o]|=0.0787  |ddm|=0.0955  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4677180638665  dE = -0.0080816976  S^2 = 0.0000000
               |grad[o]|=0.0566  |ddm|=0.0425  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4729439436789  dE = -0.0052258798  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.0843  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4745190827269  dE = -0.001575139  S^2 = 0.0000000
               |grad[o]|=0.0141  |ddm|=0.0685  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4749268246326  dE = -0.00040774191  S^2 = 0.0000000
               |grad[o]|=0.00641  |ddm|=0.0178  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4749757494099  dE = -4.8924777e-05  S^2 = 0.0000000
               |grad[o]|=0.00236  |ddm|=0.00766  |maxRot[o]|=0.0155
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4749799403128  dE = -4.190903e-06  S^2 = 0.0000000
               |grad[o]|=0.000797  |ddm|=0.00271  |maxRot[o]|=0.00464
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4749802902404  dE = -3.4992752e-07  S^2 = 0.0000000
               |grad[o]|=0.000242  |ddm|=0.000827  |maxRot[o]|=0.00134
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4749803191896  dE = -2.8949231e-08  S^2 = 0.0000000
               |grad[o]|=7.13e-05  |ddm|=0.000245  |maxRot[o]|=0.000385
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4749803215846  dE = -2.3950548e-09  S^2 = 0.0000000
               |grad[o]|=2.09e-05  |ddm|=7.03e-05  |maxRot[o]|=0.000111
macro iter 12 (2 JK  0 micro), CASSCF E = -75.474980321779  dE = -1.9431923e-10  S^2 = 0.0000000
               |grad[o]|=6.07e-06  |ddm|=2.04e-05  |maxRot[o]|=3.19e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4749803217953  dE = -1.6356694e-11  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=5.82e-06  |maxRot[o]|=8.97e-06
2-step CASSCF converged in 13 macro (52 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95767234 1.93317379 1.87988787 1.73905603 0.06793607 0.26647544
 0.056932   0.09886645]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01187   0.01040  -0.00309   0.00000   0.00000
  0 C 2s       0.67780   0.66796  -0.20019  -0.00000  -0.00000
  0 C 3s      -0.00350   0.01562  -0.03551  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69358
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439  -0.00000
  0 C 2pz      0.19981  -0.23087   0.67619  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06476
  0 C 3py      0.00000  -0.00000  -0.00000   0.05406  -0.00000
  0 C 3pz     -0.01243  -0.00176   0.01236  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03012  -0.00000
  0 C 3dz^2    0.01877  -0.01161   0.03492  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.12148
 0 C 3dx2-y2   0.00081   0.00633  -0.00713   0.00000   0.00000
  1 C 1s       0.01187  -0.01040  -0.00309   0.00000   0.00000
  1 C 2s       0.67780  -0.66796  -0.20019   0.00000   0.00000
  1 C 3s      -0.00350  -0.01562  -0.03551   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69358
  1 C 2py     -0.00000   0.00000   0.00000   0.70439   0.00000
  1 C 2pz     -0.19981  -0.23087  -0.67619  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06476
  1 C 3py     -0.00000   0.00000   0.00000   0.05406   0.00000
  1 C 3pz      0.01243  -0.00176  -0.01236  -0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03012  -0.00000
  1 C 3dz^2    0.01877   0.01161   0.03492   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12148
 1 C 3dx2-y2   0.00081  -0.00633  -0.00713  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.22994
  0 C 3s      -0.00000  -0.00000   0.03135
  0 C 2px     -0.00000   0.69817  -0.00000
  0 C 2py      0.70700  -0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.66687
  0 C 3px      0.00000  -0.01303  -0.00000
  0 C 3py     -0.00659   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03288
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01006   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00544
  0 C 3dxz     0.00000  -0.11131  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01768
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.22994
  1 C 3s       0.00000   0.00000  -0.03135
  1 C 2px     -0.00000  -0.69817   0.00000
  1 C 2py     -0.70700  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66687
  1 C 3px     -0.00000   0.01303   0.00000
  1 C 3py      0.00659   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03288
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01006   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00544
  1 C 3dxz     0.00000  -0.11131  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01768
<CAS-nat-orb|mo-hf>  3  3    0.99977692
<CAS-nat-orb|mo-hf>  4  4    0.99968291
<CAS-nat-orb|mo-hf>  5  5    0.99978338
<CAS-nat-orb|mo-hf>  6  6    0.99882147
<CAS-nat-orb|mo-hf>  7  7    0.93437317
<CAS-nat-orb|mo-hf>  8  8    0.98222691
<CAS-nat-orb|mo-hf>  9  9    0.96040422
<CAS-nat-orb|mo-hf>  10  10    0.93730552
CASSCF energy = -75.4749803217953
CASCI E = -75.4749803217953  E(CI) = -15.1422389411515  S^2 = 0.0000000
......production of RDMs took       3.01 sec
......reading the RDM took          0.48 sec
......production of RDMs took      93.39 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         11.04 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000030467
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000008048
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000465150
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000059930
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000284288
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000745348
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000248449
HMAT symm error =    0.0114666797
E(MRCI) - E(ref) = -0.1155734735247762 DC = -0.006113771689615933
E(WickICMRCISD)   = -75.59055379532009  E_corr_ci = -0.1155734735247762
E(WickICMRCISD+Q) = -75.5966675670097  E_corr_ci = -0.1216872452143921
Time cost =   3547.685
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 21:59:01 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.957955680404 AA    0.000000000000   0.000000000000   3.700000000000 Bohr   0.0

nuclear repulsion = 9.72972972972973
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.85]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1776405.66


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp4d43oxls
max_memory 4000 MB (current use 8713 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7163760223708

WARN: Singularity detected in overlap matrix (condition number = 80.7). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.104120790735628  LUMO (B3u) = -0.104120790735628

WARN: B2u HOMO -0.104120790735628 > system LUMO -0.104120790735628

cycle= 1 E= -75.2641203852924  delta_E= -0.548  |g|= 0.236  |ddm|= 1.47
HOMO (B2u) = -0.359408877513718  LUMO (B3u) = -0.0527582771899437
cycle= 2 E= -75.2865593123333  delta_E= -0.0224  |g|= 0.0471  |ddm|= 0.348
HOMO (B2u) = -0.325804970810899  LUMO (B3u) = -0.0145227547118883
cycle= 3 E= -75.2878678904737  delta_E= -0.00131  |g|= 0.0174  |ddm|= 0.0619
HOMO (B2u) = -0.330188258882721  LUMO (B3u) = -0.0187350374973052
cycle= 4 E= -75.2880824131579  delta_E= -0.000215  |g|= 0.000653  |ddm|= 0.035
HOMO (B2u) = -0.330355542534975  LUMO (B3u) = -0.0190485772808916
cycle= 5 E= -75.288082574972  delta_E= -1.62e-07  |g|= 0.000124  |ddm|= 0.000847
HOMO (B2u) = -0.330318643630837  LUMO (B3u) = -0.0190186484174822
cycle= 6 E= -75.2880825838255  delta_E= -8.85e-09  |g|= 1.86e-05  |ddm|= 0.000214
HOMO (B2u) = -0.330315994378313  LUMO (B3u) = -0.0190189216398534
cycle= 7 E= -75.2880825840469  delta_E= -2.21e-10  |g|= 1.93e-06  |ddm|= 3.86e-05
HOMO (B2u) = -0.330315507539185  LUMO (B3u) = -0.0190188734083588
cycle= 8 E= -75.2880825840494  delta_E= -2.47e-12  |g|= 1.29e-07  |ddm|= 4.01e-06
HOMO (B2u) = -0.330315512036509  LUMO (B3u) = -0.0190188725353976
cycle= 9 E= -75.2880825840494  delta_E=    0  |g|= 8.84e-09  |ddm|= 3.07e-07
HOMO (B2u) = -0.330315511516023  LUMO (B3u) = -0.0190188740618194
cycle= 10 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 7.23e-09  |ddm|= 7.7e-09
HOMO (B2u) = -0.330315511430118  LUMO (B3u) = -0.0190188740426807
cycle= 11 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 5.2e-09  |ddm|= 5.82e-09
HOMO (B2u) = -0.33031551011709  LUMO (B3u) = -0.0190188726787201
cycle= 12 E= -75.2880825840493  delta_E= 8.53e-14  |g|= 4.48e-09  |ddm|= 2.8e-09
HOMO (B2u) = -0.330315510361655  LUMO (B3u) = -0.0190188729364834
cycle= 13 E= -75.2880825840493  delta_E= -4.26e-14  |g|= 4.02e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.330315510214359  LUMO (B3u) = -0.0190188727856386
cycle= 14 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 3.28e-09  |ddm|= 2.15e-09
HOMO (B2u) = -0.330315510029076  LUMO (B3u) = -0.0190188727303302
cycle= 15 E= -75.2880825840493  delta_E= -5.68e-14  |g|= 1.06e-09  |ddm|= 6.34e-09
HOMO (B2u) = -0.330315509940816  LUMO (B3u) = -0.0190188727155718
cycle= 16 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 9.94e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.330315509970181  LUMO (B3u) = -0.0190188726986174
cycle= 17 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 1.11e-09  |ddm|= 1e-09
HOMO (B2u) = -0.330315509932798  LUMO (B3u) = -0.019018872675381
cycle= 18 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 8.61e-10  |ddm|= 6.58e-10
HOMO (B2u) = -0.330315509926831  LUMO (B3u) = -0.0190188726818151
cycle= 19 E= -75.2880825840494  delta_E= 2.84e-14  |g|= 6.9e-10  |ddm|= 5.6e-10
HOMO (B2u) = -0.330315509925312  LUMO (B3u) = -0.0190188726902667
cycle= 20 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 5.63e-10  |ddm|= 3.89e-10
HOMO (B2u) = -0.330315509909679  LUMO (B3u) = -0.0190188726817632
cycle= 21 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 4.37e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.330315509897374  LUMO (B3u) = -0.0190188726770185
cycle= 22 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 3.17e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.33031550988547  LUMO (B3u) = -0.0190188726728182
cycle= 23 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 2.27e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.330315509878511  LUMO (B3u) = -0.0190188726694835
cycle= 24 E= -75.2880825840493  delta_E=    0  |g|= 1.96e-10  |ddm|= 8.25e-11
HOMO (B2u) = -0.330315509875092  LUMO (B3u) = -0.019018872666667
cycle= 25 E= -75.2880825840492  delta_E= 7.11e-14  |g|= 1.65e-10  |ddm|= 7.65e-11
HOMO (B2u) = -0.330315509870251  LUMO (B3u) = -0.0190188726641984
cycle= 26 E= -75.2880825840493  delta_E= -4.26e-14  |g|= 1.32e-10  |ddm|= 9.21e-11
HOMO (B2u) = -0.330315509866422  LUMO (B3u) = -0.0190188726622499
cycle= 27 E= -75.2880825840491  delta_E= 1.71e-13  |g|= 1.07e-10  |ddm|= 7.13e-11
HOMO (B2u) = -0.33031550986326  LUMO (B3u) = -0.0190188726606045
cycle= 28 E= -75.2880825840491  delta_E= 1.42e-14  |g|= 8.6e-11  |ddm|= 5.68e-11
HOMO (B2u) = -0.330315509860747  LUMO (B3u) = -0.0190188726593304
cycle= 29 E= -75.288082584049  delta_E= 9.95e-14  |g|= 6.79e-11  |ddm|= 4.65e-11
HOMO (B2u) = -0.330315509858676  LUMO (B3u) = -0.0190188726582743
cycle= 30 E= -75.288082584049  delta_E= -5.68e-14  |g|= 5.37e-11  |ddm|= 3.64e-11
HOMO (B2u) = -0.33031550985712  LUMO (B3u) = -0.0190188726574981
cycle= 31 E= -75.2880825840488  delta_E= 2.84e-13  |g|= 4.37e-11  |ddm|= 2.65e-11
HOMO (B2u) = -0.330315509856004  LUMO (B3u) = -0.0190188726569033
cycle= 32 E= -75.2880825840485  delta_E= 2.27e-13  |g|= 3.64e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.330315509855103  LUMO (B3u) = -0.019018872656393
cycle= 33 E= -75.2880825840482  delta_E= 2.98e-13  |g|= 3.04e-11  |ddm|= 1.62e-11
HOMO (B2u) = -0.330315509854284  LUMO (B3u) = -0.0190188726559574
cycle= 34 E= -75.2880825840479  delta_E= 3.55e-13  |g|= 2.55e-11  |ddm|= 1.39e-11
HOMO (B2u) = -0.330315509853608  LUMO (B3u) = -0.0190188726555872
cycle= 35 E= -75.2880825840474  delta_E= 4.26e-13  |g|= 2.15e-11  |ddm|= 1.11e-11
HOMO (B2u) = -0.330315509853029  LUMO (B3u) = -0.0190188726552522
cycle= 36 E= -75.2880825840468  delta_E= 6.11e-13  |g|= 1.85e-11  |ddm|= 9.08e-12
HOMO (B2u) = -0.330315509852526  LUMO (B3u) = -0.0190188726549436
cycle= 37 E= -75.2880825840464  delta_E= 4.69e-13  |g|= 1.62e-11  |ddm|= 7.47e-12
HOMO (B2u) = -0.330315509852086  LUMO (B3u) = -0.0190188726546573
cycle= 38 E= -75.2880825840459  delta_E= 4.97e-13  |g|= 1.41e-11  |ddm|= 6.13e-12
HOMO (B2u) = -0.33031550985169  LUMO (B3u) = -0.0190188726543802
cycle= 39 E= -75.2880825840452  delta_E= 6.39e-13  |g|= 1.23e-11  |ddm|= 5.09e-12
HOMO (B2u) = -0.330315509851319  LUMO (B3u) = -0.0190188726541015
cycle= 40 E= -75.2880825840445  delta_E= 7.53e-13  |g|= 1.07e-11  |ddm|= 4.48e-12
HOMO (B2u) = -0.330315509850963  LUMO (B3u) = -0.0190188726538174
cycle= 41 E= -75.2880825840438  delta_E= 6.68e-13  |g|= 9.53e-12  |ddm|= 3.8e-12
HOMO (B2u) = -0.330315509850618  LUMO (B3u) = -0.019018872653527
cycle= 42 E= -75.2880825840432  delta_E= 5.68e-13  |g|= 8.59e-12  |ddm|= 3.35e-12
HOMO (B2u) = -0.33031550985028  LUMO (B3u) = -0.0190188726532285
cycle= 43 E= -75.2880825840427  delta_E= 5.68e-13  |g|= 7.77e-12  |ddm|= 3.06e-12
HOMO (B2u) = -0.330315509849953  LUMO (B3u) = -0.0190188726529286
cycle= 44 E= -75.2880825840421  delta_E= 5.4e-13  |g|= 6.9e-12  |ddm|= 2.61e-12
HOMO (B2u) = -0.330315509849637  LUMO (B3u) = -0.0190188726526311
cycle= 45 E= -75.2880825840415  delta_E= 6.25e-13  |g|= 6.25e-12  |ddm|= 2.31e-12
HOMO (B2u) = -0.330315509849324  LUMO (B3u) = -0.0190188726523287
cycle= 46 E= -75.2880825840409  delta_E= 6.39e-13  |g|= 5.77e-12  |ddm|= 2.13e-12
HOMO (B2u) = -0.330315509849013  LUMO (B3u) = -0.0190188726520225
cycle= 47 E= -75.2880825840402  delta_E= 7.11e-13  |g|= 5.37e-12  |ddm|= 1.96e-12
HOMO (B2u) = -0.330315509848698  LUMO (B3u) = -0.0190188726517072
cycle= 48 E= -75.2880825840397  delta_E= 4.69e-13  |g|= 5.07e-12  |ddm|= 1.89e-12
HOMO (B2u) = -0.330315509848381  LUMO (B3u) = -0.0190188726513867
cycle= 49 E= -75.2880825840392  delta_E= 4.83e-13  |g|= 4.68e-12  |ddm|= 2.16e-12
HOMO (B2u) = -0.330315509848069  LUMO (B3u) = -0.0190188726510715
cycle= 50 E= -75.2880825840389  delta_E= 2.84e-13  |g|= 4.18e-12  |ddm|= 2.19e-12
SCF not converged.
SCF energy = -75.2880825840389

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp4d43oxls
max_memory 4000 MB (current use 8713 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4284824270337  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4443078950974  dE = -0.015825468  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|= 3.78  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4564374553097  dE = -0.01212956  S^2 = 0.0000000
               |grad[o]|=0.0791  |ddm|=0.101  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4642977992943  dE = -0.007860344  S^2 = 0.0000000
               |grad[o]|=0.0552  |ddm|=0.0401  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4683807784995  dE = -0.0040829792  S^2 = 0.0000000
               |grad[o]|=0.0319  |ddm|=0.0934  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4701492368494  dE = -0.0017684583  S^2 = 0.0000000
               |grad[o]|=0.0156  |ddm|=0.0554  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4705691466104  dE = -0.00041990976  S^2 = 0.0000000
               |grad[o]|=0.00654  |ddm|=0.0184  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4706177408617  dE = -4.8594251e-05  S^2 = 0.0000000
               |grad[o]|=0.0024  |ddm|=0.0076  |maxRot[o]|=0.0154
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4706218263527  dE = -4.0854909e-06  S^2 = 0.0000000
               |grad[o]|=0.000811  |ddm|=0.00265  |maxRot[o]|=0.00457
macro iter 9 (3 JK  0 micro), CASSCF E = -75.470622163005  dE = -3.3665228e-07  S^2 = 0.0000000
               |grad[o]|=0.000246  |ddm|=0.000806  |maxRot[o]|=0.00131
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4706221904789  dE = -2.7473931e-08  S^2 = 0.0000000
               |grad[o]|=7.15e-05  |ddm|=0.000238  |maxRot[o]|=0.000374
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4706221927187  dE = -2.2397586e-09  S^2 = 0.0000000
               |grad[o]|=2.09e-05  |ddm|=6.78e-05  |maxRot[o]|=0.000107
macro iter 12 (2 JK  0 micro), CASSCF E = -75.470622192902  dE = -1.8337687e-10  S^2 = 0.0000000
               |grad[o]|=6e-06  |ddm|=1.97e-05  |maxRot[o]|=3.05e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.470622192917  dE = -1.5020873e-11  S^2 = 0.0000000
               |grad[o]|=1.75e-06  |ddm|=5.59e-06  |maxRot[o]|=8.71e-06
2-step CASSCF converged in 13 macro (51 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95713289 1.93379644 1.87461994 1.72422802 0.06681525 0.28113863
 0.05662336 0.10564547]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01200   0.01047  -0.00276   0.00000   0.00000
  0 C 2s       0.68293   0.67051  -0.18198   0.00000  -0.00000
  0 C 3s      -0.00172   0.01539  -0.03356   0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69358
  0 C 2py     -0.00000   0.00000  -0.00000   0.70441   0.00000
  0 C 2pz      0.18173  -0.22338   0.68140   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06561
  0 C 3py     -0.00000   0.00000  -0.00000   0.05451   0.00000
  0 C 3pz     -0.01154  -0.00172   0.01401   0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02892  -0.00000
  0 C 3dz^2    0.01723  -0.01123   0.03460   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.12102
 0 C 3dx2-y2   0.00106   0.00623  -0.00705   0.00000   0.00000
  1 C 1s       0.01200  -0.01047  -0.00276   0.00000   0.00000
  1 C 2s       0.68293  -0.67051  -0.18198   0.00000  -0.00000
  1 C 3s      -0.00172  -0.01539  -0.03356  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69358
  1 C 2py      0.00000  -0.00000  -0.00000   0.70441   0.00000
  1 C 2pz     -0.18173  -0.22338  -0.68140   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06561
  1 C 3py      0.00000  -0.00000   0.00000   0.05451  -0.00000
  1 C 3pz      0.01154  -0.00172  -0.01401   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02892   0.00000
  1 C 3dz^2    0.01723   0.01123   0.03460  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12102
 1 C 3dx2-y2   0.00106  -0.00623  -0.00705   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00028
  0 C 2s       0.00000  -0.00000   0.22254
  0 C 3s       0.00000  -0.00000   0.03036
  0 C 2px     -0.00000   0.69830  -0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.66959
  0 C 3px     -0.00000  -0.01481   0.00000
  0 C 3py     -0.00465   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.03021
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00965   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00477
  0 C 3dxz    -0.00000  -0.11029  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01664
  1 C 1s       0.00000   0.00000   0.00028
  1 C 2s      -0.00000   0.00000  -0.22254
  1 C 3s      -0.00000   0.00000  -0.03036
  1 C 2px      0.00000  -0.69830  -0.00000
  1 C 2py     -0.70703  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66959
  1 C 3px      0.00000   0.01481   0.00000
  1 C 3py      0.00465   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.03021
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00965  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00477
  1 C 3dxz    -0.00000  -0.11029  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01664
<CAS-nat-orb|mo-hf>  3  3    0.99943449
<CAS-nat-orb|mo-hf>  4  4    0.99967130
<CAS-nat-orb|mo-hf>  5  5    0.99943415
<CAS-nat-orb|mo-hf>  6  6    0.99875809
<CAS-nat-orb|mo-hf>  7  7    0.93391054
<CAS-nat-orb|mo-hf>  8  8    0.98327030
<CAS-nat-orb|mo-hf>  9  9    0.96053902
<CAS-nat-orb|mo-hf>  10  10    0.94279395
CASSCF energy = -75.470622192917
CASCI E = -75.470622192917  E(CI) = -15.078733269316  S^2 = 0.0000000
......production of RDMs took       5.34 sec
......reading the RDM took          0.54 sec
......production of RDMs took     359.47 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.63 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000033121
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000008748
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000508965
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000061252
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000314511
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000720374
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000240125
HMAT symm error =    0.0091340015
E(MRCI) - E(ref) = -0.1157714325122896 DC = -0.006158597425011867
E(WickICMRCISD)   = -75.58639362542934  E_corr_ci = -0.1157714325122896
E(WickICMRCISD+Q) = -75.59255222285435  E_corr_ci = -0.1219300299373015
Time cost =   3563.396
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 22:58:24 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.984414540950 AA    0.000000000000   0.000000000000   3.750000000000 Bohr   0.0

nuclear repulsion = 9.6
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.875]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1831729.25


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpj4n7zgul
max_memory 4000 MB (current use 8711 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7049084284725

WARN: Singularity detected in overlap matrix (condition number = 75.6). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.10137021191345  LUMO (B3u) = -0.101370211913451

WARN: B2u HOMO -0.10137021191345 > system LUMO -0.101370211913451

cycle= 1 E= -75.2564523906342  delta_E= -0.552  |g|= 0.234  |ddm|= 1.47
HOMO (B2u) = -0.355831308623929  LUMO (B3u) = -0.0506406338501535
cycle= 2 E= -75.2785865089974  delta_E= -0.0221  |g|= 0.0465  |ddm|= 0.348
HOMO (B2u) = -0.322685006141468  LUMO (B3u) = -0.0128872994795369
cycle= 3 E= -75.2798715208091  delta_E= -0.00129  |g|= 0.0172  |ddm|= 0.061
HOMO (B2u) = -0.327043790963021  LUMO (B3u) = -0.0170677233110562
cycle= 4 E= -75.2800833606865  delta_E= -0.000212  |g|= 0.000651  |ddm|= 0.0346
HOMO (B2u) = -0.327204207243865  LUMO (B3u) = -0.0173729266447939
cycle= 5 E= -75.280083521623  delta_E= -1.61e-07  |g|= 0.000127  |ddm|= 0.00084
HOMO (B2u) = -0.327167734029069  LUMO (B3u) = -0.0173440705847748
cycle= 6 E= -75.2800835308717  delta_E= -9.25e-09  |g|= 1.89e-05  |ddm|= 0.000218
HOMO (B2u) = -0.327165039753309  LUMO (B3u) = -0.0173442874866643
cycle= 7 E= -75.2800835311012  delta_E= -2.3e-10  |g|= 1.94e-06  |ddm|= 3.91e-05
HOMO (B2u) = -0.32716457228414  LUMO (B3u) = -0.0173442642259164
cycle= 8 E= -75.2800835311035  delta_E= -2.39e-12  |g|= 1.3e-07  |ddm|= 4.03e-06
HOMO (B2u) = -0.327164577390585  LUMO (B3u) = -0.0173442637009293
cycle= 9 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 8.76e-09  |ddm|= 3.12e-07
HOMO (B2u) = -0.32716457678051  LUMO (B3u) = -0.0173442652043367
cycle= 10 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 7.28e-09  |ddm|= 7.49e-09
HOMO (B2u) = -0.327164576737275  LUMO (B3u) = -0.0173442652402208
cycle= 11 E= -75.2800835311036  delta_E=    0  |g|= 5.21e-09  |ddm|= 5.91e-09
HOMO (B2u) = -0.327164575481269  LUMO (B3u) = -0.0173442639354093
cycle= 12 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 4.47e-09  |ddm|= 2.89e-09
HOMO (B2u) = -0.327164575694898  LUMO (B3u) = -0.0173442641643246
cycle= 13 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 4e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.327164575241135  LUMO (B3u) = -0.0173442639315225
cycle= 14 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 9.56e-10  |ddm|= 7.34e-09
HOMO (B2u) = -0.327164575348957  LUMO (B3u) = -0.0173442639680668
cycle= 15 E= -75.2800835311035  delta_E=    0  |g|= 9.67e-10  |ddm|= 1.36e-09
HOMO (B2u) = -0.327164575274781  LUMO (B3u) = -0.0173442639512637
cycle= 16 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 9.33e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.327164575295805  LUMO (B3u) = -0.0173442639367919
cycle= 17 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 1.03e-09  |ddm|= 7.83e-10
HOMO (B2u) = -0.327164575258638  LUMO (B3u) = -0.017344263915318
cycle= 18 E= -75.2800835311035  delta_E= 8.53e-14  |g|= 7.77e-10  |ddm|= 6.6e-10
HOMO (B2u) = -0.327164575252137  LUMO (B3u) = -0.0173442639221963
cycle= 19 E= -75.2800835311035  delta_E= -5.68e-14  |g|= 6.03e-10  |ddm|= 5.76e-10
HOMO (B2u) = -0.327164575250309  LUMO (B3u) = -0.0173442639311217
cycle= 20 E= -75.2800835311035  delta_E=    0  |g|= 4.74e-10  |ddm|= 4.02e-10
HOMO (B2u) = -0.327164575234639  LUMO (B3u) = -0.0173442639235529
cycle= 21 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 3.48e-10  |ddm|= 3.39e-10
HOMO (B2u) = -0.327164575221932  LUMO (B3u) = -0.0173442639192384
cycle= 22 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 2.28e-10  |ddm|= 3.09e-10
HOMO (B2u) = -0.327164575218982  LUMO (B3u) = -0.0173442639164658
cycle= 23 E= -75.2800835311034  delta_E= 1.42e-13  |g|= 2.02e-10  |ddm|= 7.25e-11
HOMO (B2u) = -0.327164575212585  LUMO (B3u) = -0.0173442639133738
cycle= 24 E= -75.2800835311033  delta_E= 5.68e-14  |g|= 1.73e-10  |ddm|= 7.56e-11
HOMO (B2u) = -0.327164575209121  LUMO (B3u) = -0.017344263910818
cycle= 25 E= -75.2800835311034  delta_E= -5.68e-14  |g|= 1.44e-10  |ddm|= 7.32e-11
HOMO (B2u) = -0.327164575204641  LUMO (B3u) = -0.0173442639086162
cycle= 26 E= -75.2800835311032  delta_E= 1.71e-13  |g|= 1.13e-10  |ddm|= 8.65e-11
HOMO (B2u) = -0.327164575201219  LUMO (B3u) = -0.0173442639069198
cycle= 27 E= -75.2800835311032  delta_E=    0  |g|= 9.1e-11  |ddm|= 6.56e-11
HOMO (B2u) = -0.327164575192805  LUMO (B3u) = -0.0173442639025149
Extra cycle  E= -75.2800835311032  delta_E= 2.84e-14  |g|= 3.1e-11  |ddm|= 1.55e-10
converged SCF energy = -75.2800835311032

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpj4n7zgul
max_memory 4000 MB (current use 8711 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4247711667705  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4410888633244  dE = -0.016317697  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4533325047281  dE = -0.012243641  S^2 = 0.0000000
               |grad[o]|=0.0793  |ddm|=0.106  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4609477172215  dE = -0.0076152125  S^2 = 0.0000000
               |grad[o]|=0.0536  |ddm|=0.0363  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4644456692502  dE = -0.003497952  S^2 = 0.0000000
               |grad[o]|=0.029  |ddm|=0.101  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4660376434344  dE = -0.0015919742  S^2 = 0.0000000
               |grad[o]|=0.0144  |ddm|=0.046  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4663659925416  dE = -0.00032834911  S^2 = 0.0000000
               |grad[o]|=0.00573  |ddm|=0.0163  |maxRot[o]|=0.0373
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4663951153511  dE = -2.912281e-05  S^2 = 0.0000000
               |grad[o]|=0.00201  |ddm|=0.00667  |maxRot[o]|=0.012
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4663975386565  dE = -2.4233054e-06  S^2 = 0.0000000
               |grad[o]|=0.000657  |ddm|=0.00204  |maxRot[o]|=0.00351
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4663977373441  dE = -1.9868753e-07  S^2 = 0.0000000
               |grad[o]|=0.000196  |ddm|=0.000621  |maxRot[o]|=0.000999
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4663977535141  dE = -1.6169992e-08  S^2 = 0.0000000
               |grad[o]|=5.71e-05  |ddm|=0.000182  |maxRot[o]|=0.000286
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4663977548352  dE = -1.3211547e-09  S^2 = 0.0000000
               |grad[o]|=1.67e-05  |ddm|=5.2e-05  |maxRot[o]|=8.12e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4663977549446  dE = -1.0942358e-10  S^2 = 0.0000000
               |grad[o]|=4.83e-06  |ddm|=1.5e-05  |maxRot[o]|=2.33e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4663977549536  dE = -8.9670493e-12  S^2 = 0.0000000
               |grad[o]|=1.4e-06  |ddm|=4.39e-06  |maxRot[o]|=6.59e-06
2-step CASSCF converged in 13 macro (51 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95667458 1.9344164  1.86874335 1.70868175 0.06576131 0.29650692
 0.0563102  0.11290549]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01211   0.01055  -0.00246   0.00000   0.00000
  0 C 2s       0.68726   0.67292  -0.16495  -0.00000  -0.00000
  0 C 3s      -0.00012   0.01517  -0.03163  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69361
  0 C 2py      0.00000  -0.00000  -0.00000   0.70443  -0.00000
  0 C 2pz      0.16481  -0.21605   0.68580   0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06639
  0 C 3py      0.00000  -0.00000  -0.00000   0.05485  -0.00000
  0 C 3pz     -0.01075  -0.00170   0.01569  -0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02772  -0.00000
  0 C 3dz^2    0.01579  -0.01087   0.03419  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.12041
 0 C 3dx2-y2   0.00128   0.00613  -0.00696   0.00000  -0.00000
  1 C 1s       0.01211  -0.01055  -0.00246   0.00000   0.00000
  1 C 2s       0.68726  -0.67292  -0.16495   0.00000   0.00000
  1 C 3s      -0.00012  -0.01517  -0.03163   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69361
  1 C 2py      0.00000  -0.00000  -0.00000   0.70443   0.00000
  1 C 2pz     -0.16481  -0.21605  -0.68580   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.06639
  1 C 3py     -0.00000   0.00000   0.00000   0.05485   0.00000
  1 C 3pz      0.01075  -0.00170  -0.01569  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02772  -0.00000
  1 C 3dz^2    0.01579   0.01087   0.03419   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.12041
 1 C 3dx2-y2   0.00128  -0.00613  -0.00696   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00026
  0 C 2s      -0.00000  -0.00000   0.21528
  0 C 3s      -0.00000  -0.00000   0.02936
  0 C 2px     -0.00000   0.69842   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67214
  0 C 3px      0.00000  -0.01654  -0.00000
  0 C 3py     -0.00273  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02753
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00925   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00414
  0 C 3dxz     0.00000  -0.10923   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01562
  1 C 1s       0.00000   0.00000   0.00026
  1 C 2s       0.00000   0.00000  -0.21528
  1 C 3s       0.00000   0.00000  -0.02936
  1 C 2px     -0.00000  -0.69842   0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.67214
  1 C 3px      0.00000   0.01654  -0.00000
  1 C 3py      0.00273  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02753
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00925   0.00000   0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00414
  1 C 3dxz    -0.00000  -0.10923   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01562
<CAS-nat-orb|mo-hf>  3  3    0.99890662
<CAS-nat-orb|mo-hf>  4  4    0.99965866
<CAS-nat-orb|mo-hf>  5  5    0.99889779
<CAS-nat-orb|mo-hf>  6  6    0.99869247
<CAS-nat-orb|mo-hf>  7  7    0.93353912
<CAS-nat-orb|mo-hf>  8  8    0.98425022
<CAS-nat-orb|mo-hf>  9  9    0.96066028
<CAS-nat-orb|mo-hf>  10  10    0.94772193
CASSCF energy = -75.4663977549536
CASCI E = -75.4663977549536  E(CI) = -15.0169341218208  S^2 = 0.0000000
......production of RDMs took       2.93 sec
......reading the RDM took          0.47 sec
......production of RDMs took      36.22 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         11.85 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000053893
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000014235
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000548228
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000065989
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000339547
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000809160
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000269720
HMAT symm error =    0.0119858921
E(MRCI) - E(ref) = -0.1159668709133257 DC = -0.006203026407394446
E(WickICMRCISD)   = -75.58236462586693  E_corr_ci = -0.1159668709133257
E(WickICMRCISD+Q) = -75.58856765227432  E_corr_ci = -0.1221698973207201
Time cost =   2820.522
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 23:45:24 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.010873401496 AA    0.000000000000   0.000000000000   3.800000000000 Bohr   0.0

nuclear repulsion = 9.47368421052632
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1880331.58


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpfz3p_fmk
max_memory 4000 MB (current use 8713 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6942155395782

WARN: Singularity detected in overlap matrix (condition number = 70.9). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.0987431605477894  LUMO (B3u) = -0.0987431605477894

WARN: B2u HOMO -0.0987431605477894 > system LUMO -0.0987431605477894

cycle= 1 E= -75.2488547171613  delta_E= -0.555  |g|= 0.232  |ddm|= 1.46
HOMO (B2u) = -0.352381746665131  LUMO (B3u) = -0.0486055106896998
cycle= 2 E= -75.2707023112209  delta_E= -0.0218  |g|= 0.046  |ddm|= 0.348
HOMO (B2u) = -0.319674633980572  LUMO (B3u) = -0.0113141174561868
cycle= 3 E= -75.2719633258624  delta_E= -0.00126  |g|= 0.0171  |ddm|= 0.0602
HOMO (B2u) = -0.324007395733246  LUMO (B3u) = -0.0154613624878811
cycle= 4 E= -75.2721722602516  delta_E= -0.000209  |g|= 0.000648  |ddm|= 0.0343
HOMO (B2u) = -0.324157880743128  LUMO (B3u) = -0.0157548749526129
cycle= 5 E= -75.2721724204055  delta_E= -1.6e-07  |g|= 0.000129  |ddm|= 0.000835
HOMO (B2u) = -0.324121920212105  LUMO (B3u) = -0.0157271018699669
cycle= 6 E= -75.2721724300014  delta_E= -9.6e-09  |g|= 1.92e-05  |ddm|= 0.000222
HOMO (B2u) = -0.324119190447227  LUMO (B3u) = -0.015727267628408
cycle= 7 E= -75.2721724302383  delta_E= -2.37e-10  |g|= 1.95e-06  |ddm|= 3.95e-05
HOMO (B2u) = -0.324118740620276  LUMO (B3u) = -0.0157272677303712
cycle= 8 E= -75.2721724302408  delta_E= -2.44e-12  |g|= 1.3e-07  |ddm|= 4.06e-06
HOMO (B2u) = -0.324118746684939  LUMO (B3u) = -0.0157272678197168
cycle= 9 E= -75.2721724302407  delta_E= 8.53e-14  |g|= 8.56e-09  |ddm|= 3.15e-07
HOMO (B2u) = -0.324118746003072  LUMO (B3u) = -0.0157272693229342
cycle= 10 E= -75.2721724302408  delta_E= -1.14e-13  |g|= 7.22e-09  |ddm|= 7.25e-09
HOMO (B2u) = -0.324118746008896  LUMO (B3u) = -0.0157272694156986
cycle= 11 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 5.15e-09  |ddm|= 5.89e-09
HOMO (B2u) = -0.324118744820905  LUMO (B3u) = -0.0157272681801322
cycle= 12 E= -75.2721724302408  delta_E= -4.26e-14  |g|= 4.4e-09  |ddm|= 2.93e-09
HOMO (B2u) = -0.324118745005511  LUMO (B3u) = -0.0157272683815496
cycle= 13 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 3.94e-09  |ddm|= 1.69e-09
HOMO (B2u) = -0.32411874456031  LUMO (B3u) = -0.0157272681653051
cycle= 14 E= -75.2721724302408  delta_E= -2.84e-14  |g|= 9.12e-10  |ddm|= 7.35e-09
HOMO (B2u) = -0.324118744667788  LUMO (B3u) = -0.0157272682017973
cycle= 15 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 9.35e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.324118744590962  LUMO (B3u) = -0.0157272681872695
cycle= 16 E= -75.2721724302408  delta_E= 5.68e-14  |g|= 8.7e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.324118744616221  LUMO (B3u) = -0.0157272681691153
cycle= 17 E= -75.2721724302407  delta_E= 8.53e-14  |g|= 9.97e-10  |ddm|= 9.91e-10
HOMO (B2u) = -0.32411874458062  LUMO (B3u) = -0.0157272681499045
cycle= 18 E= -75.2721724302408  delta_E= -1.14e-13  |g|= 7.53e-10  |ddm|= 6.37e-10
HOMO (B2u) = -0.324118744574874  LUMO (B3u) = -0.0157272681577597
cycle= 19 E= -75.2721724302407  delta_E= 7.11e-14  |g|= 5.82e-10  |ddm|= 5.72e-10
HOMO (B2u) = -0.32411874457381  LUMO (B3u) = -0.0157272681676045
cycle= 20 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 4.57e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.324118744559211  LUMO (B3u) = -0.0157272681614896
cycle= 21 E= -75.2721724302406  delta_E= 2.84e-14  |g|= 3.35e-10  |ddm|= 3.32e-10
HOMO (B2u) = -0.324118744547189  LUMO (B3u) = -0.0157272681581051
cycle= 22 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 2.18e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.324118744544415  LUMO (B3u) = -0.0157272681554593
cycle= 23 E= -75.2721724302406  delta_E= 2.84e-14  |g|= 1.93e-10  |ddm|= 6.87e-11
HOMO (B2u) = -0.324118744538212  LUMO (B3u) = -0.0157272681524936
cycle= 24 E= -75.2721724302406  delta_E= 8.53e-14  |g|= 1.65e-10  |ddm|= 7.25e-11
HOMO (B2u) = -0.324118744535101  LUMO (B3u) = -0.0157272681500455
cycle= 25 E= -75.2721724302405  delta_E= 8.53e-14  |g|= 1.38e-10  |ddm|= 6.71e-11
HOMO (B2u) = -0.324118744530822  LUMO (B3u) = -0.0157272681480841
cycle= 26 E= -75.2721724302404  delta_E= 7.11e-14  |g|= 1.08e-10  |ddm|= 8.36e-11
HOMO (B2u) = -0.324118744527575  LUMO (B3u) = -0.0157272681465808
cycle= 27 E= -75.2721724302403  delta_E= 7.11e-14  |g|= 8.72e-11  |ddm|= 6.36e-11
HOMO (B2u) = -0.324118744524961  LUMO (B3u) = -0.0157272681452983
cycle= 28 E= -75.2721724302403  delta_E= 1.42e-14  |g|= 6.95e-11  |ddm|= 4.83e-11
HOMO (B2u) = -0.324118744522971  LUMO (B3u) = -0.0157272681443219
cycle= 29 E= -75.2721724302402  delta_E= 7.11e-14  |g|= 5.47e-11  |ddm|= 3.78e-11
HOMO (B2u) = -0.324118744521453  LUMO (B3u) = -0.0157272681435362
cycle= 30 E= -75.27217243024  delta_E= 2.7e-13  |g|= 4.37e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.324118744520461  LUMO (B3u) = -0.0157272681429921
cycle= 31 E= -75.2721724302396  delta_E= 3.41e-13  |g|= 3.68e-11  |ddm|= 1.77e-11
HOMO (B2u) = -0.324118744519503  LUMO (B3u) = -0.0157272681424923
cycle= 32 E= -75.2721724302392  delta_E= 4.12e-13  |g|= 3.08e-11  |ddm|= 1.59e-11
HOMO (B2u) = -0.324118744518729  LUMO (B3u) = -0.0157272681420612
cycle= 33 E= -75.2721724302388  delta_E= 4.26e-13  |g|= 2.57e-11  |ddm|= 1.37e-11
HOMO (B2u) = -0.324118744518028  LUMO (B3u) = -0.015727268141691
cycle= 34 E= -75.2721724302384  delta_E= 3.69e-13  |g|= 2.16e-11  |ddm|= 1.16e-11
HOMO (B2u) = -0.324118744517449  LUMO (B3u) = -0.0157272681413647
cycle= 35 E= -75.2721724302379  delta_E= 4.83e-13  |g|= 1.86e-11  |ddm|= 9.14e-12
HOMO (B2u) = -0.324118744516944  LUMO (B3u) = -0.0157272681410546
cycle= 36 E= -75.2721724302376  delta_E= 3.69e-13  |g|= 1.6e-11  |ddm|= 7.5e-12
HOMO (B2u) = -0.324118744516496  LUMO (B3u) = -0.0157272681407549
cycle= 37 E= -75.272172430237  delta_E= 5.68e-13  |g|= 1.38e-11  |ddm|= 6.19e-12
HOMO (B2u) = -0.324118744516093  LUMO (B3u) = -0.0157272681404662
cycle= 38 E= -75.2721724302364  delta_E= 5.97e-13  |g|= 1.18e-11  |ddm|= 5.11e-12
HOMO (B2u) = -0.324118744515717  LUMO (B3u) = -0.0157272681401788
cycle= 39 E= -75.2721724302358  delta_E= 6.25e-13  |g|= 1.03e-11  |ddm|= 4.33e-12
HOMO (B2u) = -0.324118744515359  LUMO (B3u) = -0.0157272681398901
cycle= 40 E= -75.2721724302352  delta_E= 6.25e-13  |g|= 9.22e-12  |ddm|= 3.78e-12
HOMO (B2u) = -0.324118744515018  LUMO (B3u) = -0.0157272681396014
cycle= 41 E= -75.2721724302347  delta_E= 4.55e-13  |g|= 8.34e-12  |ddm|= 3.38e-12
HOMO (B2u) = -0.324118744514691  LUMO (B3u) = -0.0157272681393123
cycle= 42 E= -75.2721724302341  delta_E= 5.68e-13  |g|= 7.42e-12  |ddm|= 2.83e-12
HOMO (B2u) = -0.324118744514376  LUMO (B3u) = -0.0157272681390228
cycle= 43 E= -75.2721724302337  delta_E= 4.26e-13  |g|= 6.35e-12  |ddm|= 2.41e-12
HOMO (B2u) = -0.324118744514072  LUMO (B3u) = -0.0157272681387355
cycle= 44 E= -75.2721724302331  delta_E= 5.97e-13  |g|= 5.63e-12  |ddm|= 2.11e-12
HOMO (B2u) = -0.324118744513777  LUMO (B3u) = -0.0157272681384491
cycle= 45 E= -75.2721724302326  delta_E= 5.4e-13  |g|= 5.31e-12  |ddm|= 1.9e-12
HOMO (B2u) = -0.324118744513485  LUMO (B3u) = -0.0157272681381599
cycle= 46 E= -75.272172430232  delta_E= 5.54e-13  |g|= 5.2e-12  |ddm|= 1.85e-12
HOMO (B2u) = -0.324118744513198  LUMO (B3u) = -0.0157272681378723
cycle= 47 E= -75.2721724302317  delta_E= 3.55e-13  |g|= 4.58e-12  |ddm|= 1.92e-12
HOMO (B2u) = -0.32411874451292  LUMO (B3u) = -0.0157272681375912
cycle= 48 E= -75.2721724302314  delta_E= 3.13e-13  |g|= 4.1e-12  |ddm|= 1.9e-12
HOMO (B2u) = -0.32411874451265  LUMO (B3u) = -0.0157272681373174
cycle= 49 E= -75.2721724302309  delta_E= 4.55e-13  |g|= 3.61e-12  |ddm|= 1.89e-12
HOMO (B2u) = -0.324118744512387  LUMO (B3u) = -0.0157272681370478
cycle= 50 E= -75.2721724302306  delta_E= 2.84e-13  |g|= 3.11e-12  |ddm|= 1.98e-12
SCF not converged.
SCF energy = -75.2721724302306

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpfz3p_fmk
max_memory 4000 MB (current use 8713 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4211674784893  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4379918121477  dE = -0.016824334  S^2 = 0.0000000
               |grad[o]|=0.104  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.450328925131  dE = -0.012337113  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.111  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.45767628123  dE = -0.0073473561  S^2 = 0.0000000
               |grad[o]|=0.052  |ddm|=0.0312  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.460656908774  dE = -0.0029806275  S^2 = 0.0000000
               |grad[o]|=0.0258  |ddm|=0.107  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4620588880428  dE = -0.0014019793  S^2 = 0.0000000
               |grad[o]|=0.0131  |ddm|=0.037  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.462292487446  dE = -0.0002335994  S^2 = 0.0000000
               |grad[o]|=0.00491  |ddm|=0.0145  |maxRot[o]|=0.0321
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4623128145836  dE = -2.0327138e-05  S^2 = 0.0000000
               |grad[o]|=0.00177  |ddm|=0.00549  |maxRot[o]|= 0.01
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4623145092852  dE = -1.6947016e-06  S^2 = 0.0000000
               |grad[o]|=0.000572  |ddm|=0.00171  |maxRot[o]|=0.00292
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4623146491677  dE = -1.3988253e-07  S^2 = 0.0000000
               |grad[o]|=0.000171  |ddm|=0.000523  |maxRot[o]|=0.000831
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4623146606566  dE = -1.1488893e-08  S^2 = 0.0000000
               |grad[o]|=4.97e-05  |ddm|=0.000154  |maxRot[o]|=0.000238
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4623146616061  dE = -9.494272e-10  S^2 = 0.0000000
               |grad[o]|=1.46e-05  |ddm|=4.41e-05  |maxRot[o]|=6.81e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4623146616922  dE = -8.6188834e-11  S^2 = 0.0000000
               |grad[o]|=4.22e-06  |ddm|=1.28e-05  |maxRot[o]|=1.92e-05
2-step CASSCF converged in 12 macro (49 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9562916  1.93503351 1.86223013 1.69240301 0.06476757 0.31259504
 0.05599298 0.12068616]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01220   0.01062  -0.00217   0.00000   0.00000
  0 C 2s       0.69087   0.67520  -0.14918  -0.00000   0.00000
  0 C 3s       0.00130   0.01496  -0.02972  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69367
  0 C 2py      0.00000  -0.00000  -0.00000   0.70446   0.00000
  0 C 2pz      0.14914  -0.20886   0.68947  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06711
  0 C 3py      0.00000  -0.00000  -0.00000   0.05509  -0.00000
  0 C 3pz     -0.01004  -0.00168   0.01737  -0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02654   0.00000
  0 C 3dz^2    0.01444  -0.01051   0.03370  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.11966
 0 C 3dx2-y2   0.00150   0.00603  -0.00686  -0.00000  -0.00000
  1 C 1s       0.01220  -0.01062  -0.00217   0.00000   0.00000
  1 C 2s       0.69087  -0.67520  -0.14918   0.00000  -0.00000
  1 C 3s       0.00130  -0.01496  -0.02972   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69367
  1 C 2py     -0.00000   0.00000   0.00000   0.70446   0.00000
  1 C 2pz     -0.14914  -0.20886  -0.68947   0.00000   0.00000
  1 C 3px     -0.00000  -0.00000   0.00000   0.00000  -0.06711
  1 C 3py     -0.00000   0.00000   0.00000   0.05509  -0.00000
  1 C 3pz      0.01004  -0.00168  -0.01737  -0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02654   0.00000
  1 C 3dz^2    0.01444   0.01051   0.03370   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11966
 1 C 3dx2-y2   0.00150  -0.00603  -0.00686  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s      -0.00000   0.00000   0.20816
  0 C 3s      -0.00000   0.00000   0.02837
  0 C 2px     -0.00000   0.69855   0.00000
  0 C 2py      0.70705  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67455
  0 C 3px     -0.00000  -0.01822   0.00000
  0 C 3py     -0.00084  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.02485
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00885  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00357
  0 C 3dxz    -0.00000  -0.10813  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01462
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000   0.00000  -0.20816
  1 C 3s       0.00000  -0.00000  -0.02837
  1 C 2px      0.00000  -0.69855  -0.00000
  1 C 2py     -0.70705   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.67455
  1 C 3px      0.00000   0.01822  -0.00000
  1 C 3py      0.00084   0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.02485
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00885  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00357
  1 C 3dxz    -0.00000  -0.10813   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01462
<CAS-nat-orb|mo-hf>  3  3    0.99826977
<CAS-nat-orb|mo-hf>  4  4    0.99964485
<CAS-nat-orb|mo-hf>  5  5    0.99825062
<CAS-nat-orb|mo-hf>  6  6    0.99862457
<CAS-nat-orb|mo-hf>  7  7    0.93325603
<CAS-nat-orb|mo-hf>  8  8    0.98517025
<CAS-nat-orb|mo-hf>  9  9    0.96077009
<CAS-nat-orb|mo-hf>  10  10    0.95215925
CASSCF energy = -75.4623146616922
CASCI E = -75.4623146616922  E(CI) = -14.9567871911424  S^2 = 0.0000000
......production of RDMs took       2.46 sec
......reading the RDM took          0.46 sec
......production of RDMs took      28.38 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         11.23 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000021426
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000005659
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000488009
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000060144
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000300163
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000755390
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000251797
HMAT symm error =    0.0118146706
E(MRCI) - E(ref) = -0.1161587952639422 DC = -0.006246885511572132
E(WickICMRCISD)   = -75.57847345695619  E_corr_ci = -0.1161587952639422
E(WickICMRCISD+Q) = -75.58472034246776  E_corr_ci = -0.1224056807755144
Time cost =   3146.438
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Tue May 30 00:37:51 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.037332262042 AA    0.000000000000   0.000000000000   3.850000000000 Bohr   0.0

nuclear repulsion = 9.35064935064935
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1931816.46


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpthzh9ksx
max_memory 4000 MB (current use 8711 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6842509501291

WARN: Singularity detected in overlap matrix (condition number = 66.5). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.096233291331383  LUMO (B3u) = -0.0962332913313831

WARN: B2u HOMO -0.096233291331383 > system LUMO -0.0962332913313831

cycle= 1 E= -75.241333020414  delta_E= -0.557  |g|= 0.231  |ddm|= 1.46
HOMO (B2u) = -0.349057007799765  LUMO (B3u) = -0.0466518414985259
cycle= 2 E= -75.2629125920112  delta_E= -0.0216  |g|= 0.0454  |ddm|= 0.348
HOMO (B2u) = -0.316770424633126  LUMO (B3u) = -0.00980180087757371
cycle= 3 E= -75.2641493459228  delta_E= -0.00124  |g|= 0.0169  |ddm|= 0.0593
HOMO (B2u) = -0.321075514288453  LUMO (B3u) = -0.0139142694602797
cycle= 4 E= -75.2643552043106  delta_E= -0.000206  |g|= 0.000645  |ddm|= 0.0339
HOMO (B2u) = -0.321213308623813  LUMO (B3u) = -0.0141930697532558
cycle= 5 E= -75.2643553636796  delta_E= -1.59e-07  |g|= 0.000131  |ddm|= 0.00083
HOMO (B2u) = -0.321177935176444  LUMO (B3u) = -0.0141663723644065
cycle= 6 E= -75.2643553735705  delta_E= -9.89e-09  |g|= 1.94e-05  |ddm|= 0.000225
HOMO (B2u) = -0.321175177873357  LUMO (B3u) = -0.014166489841589
cycle= 7 E= -75.2643553738139  delta_E= -2.43e-10  |g|= 1.96e-06  |ddm|= 3.98e-05
HOMO (B2u) = -0.321174743989146  LUMO (B3u) = -0.0141665118435128
cycle= 8 E= -75.2643553738163  delta_E= -2.4e-12  |g|= 1.29e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.321174751334008  LUMO (B3u) = -0.0141665127830991
cycle= 9 E= -75.2643553738164  delta_E= -1.14e-13  |g|= 8.24e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.321174750584952  LUMO (B3u) = -0.0141665142894426
cycle= 10 E= -75.2643553738163  delta_E= 8.53e-14  |g|= 7.1e-09  |ddm|= 7e-09
HOMO (B2u) = -0.321174750650722  LUMO (B3u) = -0.0141665144507412
cycle= 11 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 5.04e-09  |ddm|= 5.83e-09
HOMO (B2u) = -0.321174749547505  LUMO (B3u) = -0.0141665133016324
cycle= 12 E= -75.2643553738163  delta_E= 1.42e-14  |g|= 4.3e-09  |ddm|= 2.94e-09
HOMO (B2u) = -0.321174749705739  LUMO (B3u) = -0.0141665134762837
cycle= 13 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 3.84e-09  |ddm|= 1.62e-09
HOMO (B2u) = -0.321174749276046  LUMO (B3u) = -0.0141665132806752
cycle= 14 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 8.46e-10  |ddm|= 7.27e-09
HOMO (B2u) = -0.321174749384385  LUMO (B3u) = -0.01416651331755
cycle= 15 E= -75.2643553738163  delta_E= -7.11e-14  |g|= 8.86e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.321174749304162  LUMO (B3u) = -0.0141665133064282
cycle= 16 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 7.94e-10  |ddm|= 9.85e-10
HOMO (B2u) = -0.321174749333596  LUMO (B3u) = -0.0141665132831892
cycle= 17 E= -75.2643553738162  delta_E= 5.68e-14  |g|= 9.47e-10  |ddm|= 1.24e-09
HOMO (B2u) = -0.321174749300381  LUMO (B3u) = -0.0141665132664835
cycle= 18 E= -75.2643553738163  delta_E= -2.84e-14  |g|= 7.16e-10  |ddm|= 5.97e-10
HOMO (B2u) = -0.321174749295833  LUMO (B3u) = -0.0141665132755054
cycle= 19 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 5.5e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.321174749295965  LUMO (B3u) = -0.0141665132864369
cycle= 20 E= -75.2643553738162  delta_E= 4.26e-14  |g|= 4.32e-10  |ddm|= 3.85e-10
HOMO (B2u) = -0.321174749282987  LUMO (B3u) = -0.0141665132820904
cycle= 21 E= -75.2643553738162  delta_E= 2.84e-14  |g|= 3.14e-10  |ddm|= 3.18e-10
HOMO (B2u) = -0.321174749272132  LUMO (B3u) = -0.0141665132799465
cycle= 22 E= -75.2643553738163  delta_E= -7.11e-14  |g|= 2.03e-10  |ddm|= 2.88e-10
HOMO (B2u) = -0.321174749269654  LUMO (B3u) = -0.0141665132774818
cycle= 23 E= -75.2643553738162  delta_E= 1.14e-13  |g|= 1.8e-10  |ddm|= 6.28e-11
HOMO (B2u) = -0.32117474926374  LUMO (B3u) = -0.0141665132746971
cycle= 24 E= -75.2643553738162  delta_E= 1.42e-14  |g|= 1.53e-10  |ddm|= 6.81e-11
HOMO (B2u) = -0.32117474926111  LUMO (B3u) = -0.0141665132723735
cycle= 25 E= -75.2643553738161  delta_E= 8.53e-14  |g|= 1.29e-10  |ddm|= 6e-11
HOMO (B2u) = -0.321174749257179  LUMO (B3u) = -0.0141665132707343
cycle= 26 E= -75.264355373816  delta_E= 1.14e-13  |g|= 1.01e-10  |ddm|= 7.85e-11
HOMO (B2u) = -0.321174749254215  LUMO (B3u) = -0.0141665132694849
cycle= 27 E= -75.264355373816  delta_E= -1.42e-14  |g|= 8.19e-11  |ddm|= 5.99e-11
HOMO (B2u) = -0.321174749251807  LUMO (B3u) = -0.0141665132683819
cycle= 28 E= -75.2643553738158  delta_E= 1.42e-13  |g|= 6.53e-11  |ddm|= 4.52e-11
HOMO (B2u) = -0.321174749249962  LUMO (B3u) = -0.0141665132675277
cycle= 29 E= -75.2643553738157  delta_E= 9.95e-14  |g|= 5.17e-11  |ddm|= 3.53e-11
HOMO (B2u) = -0.321174749248556  LUMO (B3u) = -0.0141665132668279
cycle= 30 E= -75.2643553738154  delta_E= 2.84e-13  |g|= 4.13e-11  |ddm|= 2.58e-11
HOMO (B2u) = -0.32117474924764  LUMO (B3u) = -0.0141665132663293
cycle= 31 E= -75.2643553738151  delta_E= 3.98e-13  |g|= 3.5e-11  |ddm|= 1.64e-11
HOMO (B2u) = -0.321174749246748  LUMO (B3u) = -0.014166513265871
cycle= 32 E= -75.2643553738146  delta_E= 4.26e-13  |g|= 2.92e-11  |ddm|= 1.48e-11
HOMO (B2u) = -0.32117474924603  LUMO (B3u) = -0.0141665132654738
cycle= 33 E= -75.2643553738143  delta_E= 3.69e-13  |g|= 2.45e-11  |ddm|= 1.28e-11
HOMO (B2u) = -0.321174749245367  LUMO (B3u) = -0.014166513265133
cycle= 34 E= -75.2643553738139  delta_E= 3.13e-13  |g|= 2.06e-11  |ddm|= 1.09e-11
HOMO (B2u) = -0.321174749244817  LUMO (B3u) = -0.0141665132648277
cycle= 35 E= -75.2643553738135  delta_E= 3.98e-13  |g|= 1.78e-11  |ddm|= 8.55e-12
HOMO (B2u) = -0.321174749244337  LUMO (B3u) = -0.0141665132645346
cycle= 36 E= -75.264355373813  delta_E= 5.4e-13  |g|= 1.53e-11  |ddm|= 7.05e-12
HOMO (B2u) = -0.321174749243908  LUMO (B3u) = -0.0141665132642471
cycle= 37 E= -75.2643553738125  delta_E= 4.83e-13  |g|= 1.3e-11  |ddm|= 5.89e-12
HOMO (B2u) = -0.321174749243518  LUMO (B3u) = -0.0141665132639656
cycle= 38 E= -75.2643553738119  delta_E= 6.11e-13  |g|= 1.12e-11  |ddm|= 4.91e-12
HOMO (B2u) = -0.321174749243158  LUMO (B3u) = -0.0141665132636862
cycle= 39 E= -75.2643553738113  delta_E= 5.68e-13  |g|= 9.87e-12  |ddm|= 4.04e-12
HOMO (B2u) = -0.321174749242813  LUMO (B3u) = -0.0141665132634064
cycle= 40 E= -75.2643553738107  delta_E= 5.97e-13  |g|= 8.75e-12  |ddm|= 3.61e-12
HOMO (B2u) = -0.321174749242489  LUMO (B3u) = -0.0141665132631288
cycle= 41 E= -75.2643553738103  delta_E= 4.41e-13  |g|= 7.77e-12  |ddm|= 3.09e-12
HOMO (B2u) = -0.321174749242179  LUMO (B3u) = -0.0141665132628535
cycle= 42 E= -75.2643553738098  delta_E= 4.55e-13  |g|= 6.8e-12  |ddm|= 2.61e-12
HOMO (B2u) = -0.321174749241878  LUMO (B3u) = -0.0141665132625761
cycle= 43 E= -75.2643553738093  delta_E= 5.97e-13  |g|= 6.23e-12  |ddm|= 2.41e-12
HOMO (B2u) = -0.321174749241584  LUMO (B3u) = -0.0141665132622965
cycle= 44 E= -75.2643553738087  delta_E= 5.12e-13  |g|= 5.75e-12  |ddm|= 2.24e-12
HOMO (B2u) = -0.321174749241297  LUMO (B3u) = -0.0141665132620178
cycle= 45 E= -75.2643553738083  delta_E= 4.55e-13  |g|= 5.46e-12  |ddm|= 2.1e-12
HOMO (B2u) = -0.321174749241011  LUMO (B3u) = -0.0141665132617349
cycle= 46 E= -75.2643553738078  delta_E= 5.26e-13  |g|= 5.33e-12  |ddm|= 2.05e-12
HOMO (B2u) = -0.321174749240726  LUMO (B3u) = -0.014166513261451
cycle= 47 E= -75.2643553738074  delta_E= 3.41e-13  |g|= 4.98e-12  |ddm|= 2.22e-12
HOMO (B2u) = -0.321174749240447  LUMO (B3u) = -0.0141665132611716
cycle= 48 E= -75.264355373807  delta_E= 3.69e-13  |g|= 4.29e-12  |ddm|= 2.29e-12
HOMO (B2u) = -0.32117474924018  LUMO (B3u) = -0.0141665132609041
cycle= 49 E= -75.2643553738068  delta_E= 2.98e-13  |g|= 3.55e-12  |ddm|= 2.37e-12
HOMO (B2u) = -0.32117474923992  LUMO (B3u) = -0.0141665132606443
cycle= 50 E= -75.2643553738065  delta_E= 2.56e-13  |g|= 3.05e-12  |ddm|= 2.27e-12
SCF not converged.
SCF energy = -75.2643553738065

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpthzh9ksx
max_memory 4000 MB (current use 8711 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4176796778916  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.435025478155  dE = -0.0173458  S^2 = 0.0000000
               |grad[o]|=0.106  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4474337661348  dE = -0.012408288  S^2 = 0.0000000
               |grad[o]|=0.0797  |ddm|=0.116  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4544928097119  dE = -0.0070590436  S^2 = 0.0000000
               |grad[o]|=0.0502  |ddm|=0.0257  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4570198552154  dE = -0.0025270455  S^2 = 0.0000000
               |grad[o]|=0.0225  |ddm|=0.109  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4582156669088  dE = -0.0011958117  S^2 = 0.0000000
               |grad[o]|=0.0117  |ddm|=0.029  |maxRot[o]|=0.0599
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4583447280554  dE = -0.00012906115  S^2 = 0.0000000
               |grad[o]|=0.00413  |ddm|=0.013  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4583764279376  dE = -3.1699882e-05  S^2 = 0.0000000
               |grad[o]|=0.00208  |ddm|=0.00331  |maxRot[o]|=0.0124
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4583791016407  dE = -2.6737031e-06  S^2 = 0.0000000
               |grad[o]|=0.000717  |ddm|=0.00209  |maxRot[o]|=0.00364
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4583793258095  dE = -2.2416882e-07  S^2 = 0.0000000
               |grad[o]|=0.000222  |ddm|=0.000651  |maxRot[o]|=0.00105
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4583793445603  dE = -1.8750825e-08  S^2 = 0.0000000
               |grad[o]|=6.53e-05  |ddm|=0.000197  |maxRot[o]|=0.000301
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4583793461255  dE = -1.5651693e-09  S^2 = 0.0000000
               |grad[o]|=1.94e-05  |ddm|=5.74e-05  |maxRot[o]|=8.66e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4583793462561  dE = -1.3059775e-10  S^2 = 0.0000000
               |grad[o]|=5.65e-06  |ddm|=1.67e-05  |maxRot[o]|=2.51e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4583793462636  dE = -7.4891204e-12  S^2 = 0.0000000
               |grad[o]|=1.67e-06  |ddm|=4.59e-06  |maxRot[o]|=7.48e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95597951 1.93565085 1.85505359 1.67538712 0.06382139 0.32940991
 0.0556711  0.12902653]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01228   0.01069  -0.00190   0.00000   0.00000
  0 C 2s       0.69385   0.67734  -0.13470  -0.00000  -0.00000
  0 C 3s       0.00257   0.01477  -0.02786  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69376
  0 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  0 C 2pz      0.13475  -0.20184   0.69251   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06778
  0 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  0 C 3pz     -0.00941  -0.00168   0.01906  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02538  -0.00000
  0 C 3dz^2    0.01317  -0.01016   0.03314  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.11878
 0 C 3dx2-y2   0.00169   0.00594  -0.00676   0.00000  -0.00000
  1 C 1s       0.01228  -0.01069  -0.00190   0.00000   0.00000
  1 C 2s       0.69385  -0.67734  -0.13470   0.00000  -0.00000
  1 C 3s       0.00257  -0.01477  -0.02786  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69376
  1 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  1 C 2pz     -0.13475  -0.20184  -0.69251  -0.00000  -0.00000
  1 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06778
  1 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  1 C 3pz      0.00941  -0.00168  -0.01906   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.02538   0.00000
  1 C 3dz^2    0.01317   0.01016   0.03314  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11878
 1 C 3dx2-y2   0.00169  -0.00594  -0.00676  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.20120
  0 C 3s      -0.00000  -0.00000   0.02738
  0 C 2px     -0.00000   0.69868  -0.00000
  0 C 2py      0.70706  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.67682
  0 C 3px     -0.00000  -0.01985  -0.00000
  0 C 3py      0.00101  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02216
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00847   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00304
  0 C 3dxz    -0.00000  -0.10700  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01365
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s       0.00000   0.00000  -0.20120
  1 C 3s       0.00000   0.00000  -0.02738
  1 C 2px      0.00000  -0.69868   0.00000
  1 C 2py     -0.70706   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67682
  1 C 3px      0.00000   0.01985   0.00000
  1 C 3py     -0.00101   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02216
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00847  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00304
  1 C 3dxz    -0.00000  -0.10700  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01365
<CAS-nat-orb|mo-hf>  3  3    0.99758992
<CAS-nat-orb|mo-hf>  4  4    0.99962978
<CAS-nat-orb|mo-hf>  5  5    0.99755850
<CAS-nat-orb|mo-hf>  6  6    0.99855438
<CAS-nat-orb|mo-hf>  7  7    0.93304991
<CAS-nat-orb|mo-hf>  8  8    0.98603349
<CAS-nat-orb|mo-hf>  9  9    0.96086979
<CAS-nat-orb|mo-hf>  10  10    0.95616483
CASSCF energy = -75.4583793462636
CASCI E = -75.4583793462636  E(CI) = -14.898240418617  S^2 = 0.0000000
......production of RDMs took       2.41 sec
......reading the RDM took          0.48 sec
......production of RDMs took      29.90 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.14 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000028863
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000007624
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000439741
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000047794
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000275458
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000692089
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000230696
HMAT symm error =    0.0121390979
E(MRCI) - E(ref) = -0.1163459178892481 DC = -0.006289958542800953
E(WickICMRCISD)   = -75.57472526415282  E_corr_ci = -0.1163459178892481
E(WickICMRCISD+Q) = -75.58101522269561  E_corr_ci = -0.122635876432049
Time cost =   3099.649
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Tue May 30 01:29:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.063791122588 AA    0.000000000000   0.000000000000   3.900000000000 Bohr   0.0

nuclear repulsion = 9.23076923076923
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   1982292.69


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp3p37wn7r
max_memory 4000 MB (current use 8713 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6749703835052

WARN: Singularity detected in overlap matrix (condition number = 62.4). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.0938346227346621  LUMO (B3u) = -0.0938346227346621

WARN: B2u HOMO -0.0938346227346621 > system LUMO -0.0938346227346621

cycle= 1 E= -75.2338921256661  delta_E= -0.559  |g|= 0.229  |ddm|= 1.46
HOMO (B2u) = -0.345853796512396  LUMO (B3u) = -0.0447783510681931
cycle= 2 E= -75.2552221736389  delta_E= -0.0213  |g|= 0.0449  |ddm|= 0.347
HOMO (B2u) = -0.313968969330057  LUMO (B3u) = -0.00834890411119893
cycle= 3 E= -75.2564345511741  delta_E= -0.00121  |g|= 0.0167  |ddm|= 0.0585
HOMO (B2u) = -0.318244577067684  LUMO (B3u) = -0.0124246975036506
cycle= 4 E= -75.2566372099209  delta_E= -0.000203  |g|= 0.000641  |ddm|= 0.0335
HOMO (B2u) = -0.318367270990409  LUMO (B3u) = -0.0126861477138977
cycle= 5 E= -75.2566373684186  delta_E= -1.58e-07  |g|= 0.000132  |ddm|= 0.000824
HOMO (B2u) = -0.318332550664859  LUMO (B3u) = -0.0126605067829988
cycle= 6 E= -75.2566373785487  delta_E= -1.01e-08  |g|= 1.96e-05  |ddm|= 0.000227
HOMO (B2u) = -0.318329772186369  LUMO (B3u) = -0.0126605767315263
cycle= 7 E= -75.2566373787974  delta_E= -2.49e-10  |g|= 1.98e-06  |ddm|= 4.01e-05
HOMO (B2u) = -0.318329352566567  LUMO (B3u) = -0.0126606192769706
cycle= 8 E= -75.2566373788  delta_E= -2.53e-12  |g|= 1.29e-07  |ddm|= 4.15e-06
HOMO (B2u) = -0.318329361479119  LUMO (B3u) = -0.0126606212717807
cycle= 9 E= -75.2566373788  delta_E= 2.84e-14  |g|= 7.84e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.31832936067614  LUMO (B3u) = -0.0126606228040161
cycle= 10 E= -75.2566373788  delta_E= -5.68e-14  |g|= 6.9e-09  |ddm|= 6.79e-09
HOMO (B2u) = -0.318329360806424  LUMO (B3u) = -0.0126606230301896
cycle= 11 E= -75.2566373788  delta_E= 5.68e-14  |g|= 4.88e-09  |ddm|= 5.61e-09
HOMO (B2u) = -0.318329359796188  LUMO (B3u) = -0.0126606219766804
cycle= 12 E= -75.2566373788  delta_E=    0  |g|= 4.15e-09  |ddm|= 2.93e-09
HOMO (B2u) = -0.318329359932217  LUMO (B3u) = -0.0126606221275516
cycle= 13 E= -75.2566373788  delta_E=    0  |g|= 3.71e-09  |ddm|= 1.52e-09
HOMO (B2u) = -0.318329359524989  LUMO (B3u) = -0.0126606219552329
cycle= 14 E= -75.2566373788  delta_E=    0  |g|= 7.6e-10  |ddm|= 7.09e-09
HOMO (B2u) = -0.318329359627898  LUMO (B3u) = -0.0126606219882047
cycle= 15 E= -75.2566373787999  delta_E= 2.84e-14  |g|= 8.15e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.318329359559799  LUMO (B3u) = -0.0126606219793819
cycle= 16 E= -75.2566373787999  delta_E=    0  |g|= 7.33e-10  |ddm|= 8.25e-10
HOMO (B2u) = -0.31832935958447  LUMO (B3u) = -0.0126606219560549
cycle= 17 E= -75.2566373788  delta_E= -5.68e-14  |g|= 8.82e-10  |ddm|= 1.15e-09
HOMO (B2u) = -0.318329359554326  LUMO (B3u) = -0.012660621941993
cycle= 18 E= -75.2566373788  delta_E=    0  |g|= 6.69e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.318329359551771  LUMO (B3u) = -0.0126606219524592
cycle= 19 E= -75.2566373788  delta_E= 2.84e-14  |g|= 5.12e-10  |ddm|= 5.27e-10
HOMO (B2u) = -0.31832935955355  LUMO (B3u) = -0.0126606219646638
cycle= 20 E= -75.2566373787999  delta_E= 2.84e-14  |g|= 4.02e-10  |ddm|= 3.62e-10
HOMO (B2u) = -0.318329359542686  LUMO (B3u) = -0.0126606219622955
cycle= 21 E= -75.2566373787999  delta_E= 5.68e-14  |g|= 2.91e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.318329359533467  LUMO (B3u) = -0.0126606219616156
cycle= 22 E= -75.2566373787999  delta_E=    0  |g|= 1.86e-10  |ddm|= 2.67e-10
HOMO (B2u) = -0.318329359531395  LUMO (B3u) = -0.0126606219593452
cycle= 23 E= -75.2566373788  delta_E= -1.42e-13  |g|= 1.65e-10  |ddm|= 5.47e-11
HOMO (B2u) = -0.318329359526161  LUMO (B3u) = -0.0126606219569053
cycle= 24 E= -75.2566373787998  delta_E= 2.27e-13  |g|= 1.4e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.318329359523757  LUMO (B3u) = -0.0126606219548878
cycle= 25 E= -75.2566373787998  delta_E=    0  |g|= 1.18e-10  |ddm|= 5.42e-11
HOMO (B2u) = -0.318329359520312  LUMO (B3u) = -0.012660621953642
cycle= 26 E= -75.2566373787996  delta_E= 1.71e-13  |g|= 9.27e-11  |ddm|= 7.11e-11
HOMO (B2u) = -0.318329359517734  LUMO (B3u) = -0.0126606219527
cycle= 27 E= -75.2566373787996  delta_E= 2.84e-14  |g|= 7.51e-11  |ddm|= 5.46e-11
HOMO (B2u) = -0.318329359515607  LUMO (B3u) = -0.0126606219518194
cycle= 28 E= -75.2566373787995  delta_E= 8.53e-14  |g|= 6.04e-11  |ddm|= 4.09e-11
HOMO (B2u) = -0.318329359513965  LUMO (B3u) = -0.0126606219511223
cycle= 29 E= -75.2566373787993  delta_E= 1.71e-13  |g|= 4.77e-11  |ddm|= 3.2e-11
HOMO (B2u) = -0.318329359512715  LUMO (B3u) = -0.0126606219505382
cycle= 30 E= -75.256637378799  delta_E= 3.13e-13  |g|= 3.8e-11  |ddm|= 2.33e-11
HOMO (B2u) = -0.318329359511903  LUMO (B3u) = -0.0126606219501112
cycle= 31 E= -75.2566373787986  delta_E= 3.69e-13  |g|= 3.21e-11  |ddm|= 1.48e-11
HOMO (B2u) = -0.318329359511105  LUMO (B3u) = -0.0126606219497203
cycle= 32 E= -75.2566373787983  delta_E= 3.41e-13  |g|= 2.69e-11  |ddm|= 1.33e-11
HOMO (B2u) = -0.318329359510459  LUMO (B3u) = -0.0126606219493823
cycle= 33 E= -75.256637378798  delta_E= 3.41e-13  |g|= 2.26e-11  |ddm|= 1.14e-11
HOMO (B2u) = -0.318329359509859  LUMO (B3u) = -0.0126606219490871
cycle= 34 E= -75.2566373787976  delta_E= 3.41e-13  |g|= 1.93e-11  |ddm|= 9.66e-12
HOMO (B2u) = -0.318329359509354  LUMO (B3u) = -0.0126606219488131
cycle= 35 E= -75.2566373787972  delta_E= 4.26e-13  |g|= 1.67e-11  |ddm|= 7.67e-12
HOMO (B2u) = -0.318329359508902  LUMO (B3u) = -0.0126606219485376
cycle= 36 E= -75.2566373787967  delta_E= 5.4e-13  |g|= 1.42e-11  |ddm|= 6.46e-12
HOMO (B2u) = -0.318329359508495  LUMO (B3u) = -0.0126606219482634
cycle= 37 E= -75.256637378796  delta_E= 6.25e-13  |g|= 1.21e-11  |ddm|= 5.4e-12
HOMO (B2u) = -0.31832935950812  LUMO (B3u) = -0.0126606219479872
cycle= 38 E= -75.2566373787954  delta_E= 6.54e-13  |g|= 1.06e-11  |ddm|= 4.47e-12
HOMO (B2u) = -0.318329359507772  LUMO (B3u) = -0.012660621947713
cycle= 39 E= -75.2566373787949  delta_E= 4.83e-13  |g|= 9.4e-12  |ddm|= 3.83e-12
HOMO (B2u) = -0.318329359507437  LUMO (B3u) = -0.012660621947437
cycle= 40 E= -75.2566373787945  delta_E= 4.26e-13  |g|= 8.37e-12  |ddm|= 3.26e-12
HOMO (B2u) = -0.318329359507118  LUMO (B3u) = -0.0126606219471606
cycle= 41 E= -75.256637378794  delta_E= 4.83e-13  |g|= 7.26e-12  |ddm|= 2.77e-12
HOMO (B2u) = -0.318329359506815  LUMO (B3u) = -0.0126606219468887
cycle= 42 E= -75.2566373787934  delta_E= 5.68e-13  |g|= 6.28e-12  |ddm|= 2.42e-12
HOMO (B2u) = -0.318329359506519  LUMO (B3u) = -0.0126606219466126
cycle= 43 E= -75.2566373787929  delta_E= 5.12e-13  |g|= 5.69e-12  |ddm|= 2.16e-12
HOMO (B2u) = -0.318329359506228  LUMO (B3u) = -0.012660621946334
cycle= 44 E= -75.2566373787923  delta_E= 5.68e-13  |g|= 5.51e-12  |ddm|= 2e-12
HOMO (B2u) = -0.318329359505938  LUMO (B3u) = -0.0126606219460514
cycle= 45 E= -75.2566373787918  delta_E= 5.4e-13  |g|= 5.06e-12  |ddm|= 2.01e-12
HOMO (B2u) = -0.31832935950565  LUMO (B3u) = -0.0126606219457674
cycle= 46 E= -75.2566373787915  delta_E= 2.56e-13  |g|= 4.54e-12  |ddm|= 2.02e-12
HOMO (B2u) = -0.318329359505372  LUMO (B3u) = -0.0126606219454915
cycle= 47 E= -75.2566373787912  delta_E= 3.69e-13  |g|= 3.89e-12  |ddm|= 2.02e-12
HOMO (B2u) = -0.318329359505106  LUMO (B3u) = -0.0126606219452272
cycle= 48 E= -75.256637378791  delta_E= 1.71e-13  |g|= 3.29e-12  |ddm|= 1.99e-12
HOMO (B2u) = -0.318329359504853  LUMO (B3u) = -0.0126606219449749
cycle= 49 E= -75.2566373787908  delta_E= 2.27e-13  |g|= 2.86e-12  |ddm|= 1.91e-12
HOMO (B2u) = -0.318329359504611  LUMO (B3u) = -0.0126606219447341
cycle= 50 E= -75.2566373787905  delta_E= 2.27e-13  |g|= 2.53e-12  |ddm|= 1.65e-12
SCF not converged.
SCF energy = -75.2566373787905

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp3p37wn7r
max_memory 4000 MB (current use 8713 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4143148843344  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4321977296483  dE = -0.017882845  S^2 = 0.0000000
               |grad[o]|=0.108  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4446520957597  dE = -0.012454366  S^2 = 0.0000000
               |grad[o]|=0.0797  |ddm|=0.121  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4513995122134  dE = -0.0067474165  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.0219  |maxRot[o]|=0.0798
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4535335662107  dE = -0.002134054  S^2 = 0.0000000
               |grad[o]|=0.019  |ddm|=0.108  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4543108806167  dE = -0.00077731441  S^2 = 0.0000000
               |grad[o]|= 0.01  |ddm|=0.0225  |maxRot[o]|= 0.04
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4545719137074  dE = -0.00026103309  S^2 = 0.0000000
               |grad[o]|=0.0052  |ddm|=0.00808  |maxRot[o]|=0.033
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4545949695643  dE = -2.3055857e-05  S^2 = 0.0000000
               |grad[o]|=0.00193  |ddm|=0.00569  |maxRot[o]|=0.0106
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4545969714225  dE = -2.0018582e-06  S^2 = 0.0000000
               |grad[o]|=0.000646  |ddm|=0.00183  |maxRot[o]|=0.00312
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4545971434663  dE = -1.7204377e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.000578  |maxRot[o]|=0.000903
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4545971581454  dE = -1.4679131e-08  S^2 = 0.0000000
               |grad[o]|=5.9e-05  |ddm|=0.000175  |maxRot[o]|=0.000264
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4545971593865  dE = -1.2410339e-09  S^2 = 0.0000000
               |grad[o]|=1.78e-05  |ddm|=5.13e-05  |maxRot[o]|=7.65e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4545971594911  dE = -1.0467716e-10  S^2 = 0.0000000
               |grad[o]|=5.1e-06  |ddm|=1.54e-05  |maxRot[o]|=2.23e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4545971594996  dE = -8.4554586e-12  S^2 = 0.0000000
               |grad[o]|=1.52e-06  |ddm|=4.45e-06  |maxRot[o]|=6.52e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95573076 1.93626698 1.84718163 1.65763445 0.06292257 0.34695114
 0.05534506 0.1379674 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01234   0.01075  -0.00166   0.00000   0.00000
  0 C 2s       0.69629   0.67936  -0.12152  -0.00000  -0.00000
  0 C 3s       0.00370   0.01459  -0.02605   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69387
  0 C 2py     -0.00000   0.00000   0.00000   0.70453  -0.00000
  0 C 2pz      0.12164  -0.19495   0.69500  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06838
  0 C 3py     -0.00000   0.00000  -0.00000   0.05527   0.00000
  0 C 3pz     -0.00884  -0.00169   0.02073   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02424   0.00000
  0 C 3dz^2    0.01200  -0.00982   0.03250   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.11777
 0 C 3dx2-y2   0.00188   0.00585  -0.00666  -0.00000  -0.00000
  1 C 1s       0.01234  -0.01075  -0.00166   0.00000   0.00000
  1 C 2s       0.69629  -0.67936  -0.12152  -0.00000   0.00000
  1 C 3s       0.00370  -0.01459  -0.02605  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69387
  1 C 2py      0.00000  -0.00000   0.00000   0.70453  -0.00000
  1 C 2pz     -0.12164  -0.19495  -0.69500  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06838
  1 C 3py      0.00000  -0.00000  -0.00000   0.05527   0.00000
  1 C 3pz      0.00884  -0.00169  -0.02073   0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.02424  -0.00000
  1 C 3dz^2    0.01200   0.00982   0.03250  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.11777
 1 C 3dx2-y2   0.00188  -0.00585  -0.00666   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00021
  0 C 2s      -0.00000  -0.00000   0.19437
  0 C 3s       0.00000  -0.00000   0.02640
  0 C 2px     -0.00000   0.69881  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.67895
  0 C 3px      0.00000  -0.02144   0.00000
  0 C 3py      0.00283  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01949
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00809  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00255
  0 C 3dxz     0.00000  -0.10583   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01271
  1 C 1s       0.00000   0.00000   0.00021
  1 C 2s      -0.00000   0.00000  -0.19437
  1 C 3s       0.00000   0.00000  -0.02640
  1 C 2px     -0.00000  -0.69881  -0.00000
  1 C 2py     -0.70705  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67895
  1 C 3px      0.00000   0.02144   0.00000
  1 C 3py     -0.00283  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01949
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00809  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00255
  1 C 3dxz    -0.00000  -0.10583  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.01271
<CAS-nat-orb|mo-hf>  3  3    0.99692136
<CAS-nat-orb|mo-hf>  4  4    0.99961325
<CAS-nat-orb|mo-hf>  5  5    0.99687558
<CAS-nat-orb|mo-hf>  6  6    0.99848189
<CAS-nat-orb|mo-hf>  7  7    0.93292274
<CAS-nat-orb|mo-hf>  8  8    0.98684296
<CAS-nat-orb|mo-hf>  9  9    0.96096128
<CAS-nat-orb|mo-hf>  10  10    0.95978892
CASSCF energy = -75.4545971594996
CASCI E = -75.4545971594996  E(CI) = -14.8412429770464  S^2 = 0.0000000
......production of RDMs took       2.59 sec
......reading the RDM took          0.45 sec
......production of RDMs took      27.83 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.59 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000023311
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000006157
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000683057
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000085944
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000418588
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000937093
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000312364
HMAT symm error =    0.0115384040
E(MRCI) - E(ref) = -0.1165272952185177 DC = -0.006332051483603213
E(WickICMRCISD)   = -75.5711244547181  E_corr_ci = -0.1165272952185177
E(WickICMRCISD+Q) = -75.5774565062017  E_corr_ci = -0.1228593467021209
Time cost =   3100.285
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Tue May 30 02:21:11 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.090249983134 AA    0.000000000000   0.000000000000   3.950000000000 Bohr   0.0

nuclear repulsion = 9.11392405063291
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   2035369.54


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp1d_ajk_d
max_memory 4000 MB (current use 8711 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6663316753772

WARN: Singularity detected in overlap matrix (condition number = 58.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0915415140147796  LUMO (B3u) = -0.0915415140147796

WARN: B2u HOMO -0.0915415140147796 > system LUMO -0.0915415140147796

cycle= 1 E= -75.2265361682301  delta_E= -0.56  |g|= 0.228  |ddm|= 1.46
HOMO (B2u) = -0.342768719019987  LUMO (B3u) = -0.0429835717594423
cycle= 2 E= -75.2476350005993  delta_E= -0.0211  |g|= 0.0444  |ddm|= 0.347
HOMO (B2u) = -0.311266865337972  LUMO (B3u) = -0.00695392831510911
cycle= 3 E= -75.2488230162567  delta_E= -0.00119  |g|= 0.0166  |ddm|= 0.0577
HOMO (B2u) = -0.315511002797545  LUMO (B3u) = -0.010990840618904
cycle= 4 E= -75.24902239302  delta_E= -0.000199  |g|= 0.000637  |ddm|= 0.0332
HOMO (B2u) = -0.315616573066829  LUMO (B3u) = -0.0112327274277411
cycle= 5 E= -75.2490225504908  delta_E= -1.57e-07  |g|= 0.000134  |ddm|= 0.000817
HOMO (B2u) = -0.315582567140402  LUMO (B3u) = -0.0112081163367538
cycle= 6 E= -75.2490225608019  delta_E= -1.03e-08  |g|= 1.98e-05  |ddm|= 0.000228
HOMO (B2u) = -0.315579772310337  LUMO (B3u) = -0.0112081376157125
cycle= 7 E= -75.249022561055  delta_E= -2.53e-10  |g|= 2e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.315579365287539  LUMO (B3u) = -0.0112081994129459
cycle= 8 E= -75.2490225610576  delta_E= -2.56e-12  |g|= 1.29e-07  |ddm|= 4.21e-06
HOMO (B2u) = -0.315579376014584  LUMO (B3u) = -0.0112082026370646
cycle= 9 E= -75.2490225610575  delta_E= 5.68e-14  |g|= 7.39e-09  |ddm|= 3.13e-07
HOMO (B2u) = -0.315579375159299  LUMO (B3u) = -0.0112082041996799
cycle= 10 E= -75.2490225610576  delta_E= -1.14e-13  |g|= 6.68e-09  |ddm|= 6.7e-09
HOMO (B2u) = -0.315579375372017  LUMO (B3u) = -0.0112082045104394
cycle= 11 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 4.7e-09  |ddm|= 5.38e-09
HOMO (B2u) = -0.315579374456029  LUMO (B3u) = -0.0112082035522789
cycle= 12 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 3.98e-09  |ddm|= 2.88e-09
HOMO (B2u) = -0.315579374574187  LUMO (B3u) = -0.0112082036829932
cycle= 13 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 3.56e-09  |ddm|= 1.41e-09
HOMO (B2u) = -0.31557937420497  LUMO (B3u) = -0.0112082035344109
cycle= 14 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 7.08e-10  |ddm|= 6.53e-09
HOMO (B2u) = -0.31557937430368  LUMO (B3u) = -0.0112082035701466
cycle= 15 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 7.46e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.315579374231822  LUMO (B3u) = -0.0112082035635359
cycle= 16 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 6.5e-10  |ddm|= 8.6e-10
HOMO (B2u) = -0.315579374257301  LUMO (B3u) = -0.0112082035349904
cycle= 17 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 8.07e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.315579374230771  LUMO (B3u) = -0.0112082035236274
cycle= 18 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 6.13e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.315579374230605  LUMO (B3u) = -0.0112082035356827
cycle= 19 E= -75.2490225610576  delta_E=    0  |g|= 4.68e-10  |ddm|= 4.87e-10
HOMO (B2u) = -0.31557937423453  LUMO (B3u) = -0.0112082035493864
cycle= 20 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 3.68e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.315579374226199  LUMO (B3u) = -0.0112082035491772
cycle= 21 E= -75.2490225610575  delta_E= 8.53e-14  |g|= 2.65e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.315579374219015  LUMO (B3u) = -0.0112082035501454
cycle= 22 E= -75.2490225610575  delta_E=    0  |g|= 1.67e-10  |ddm|= 2.4e-10
HOMO (B2u) = -0.315579374217204  LUMO (B3u) = -0.011208203548262
cycle= 23 E= -75.2490225610575  delta_E= 5.68e-14  |g|= 1.48e-10  |ddm|= 4.95e-11
HOMO (B2u) = -0.315579374212321  LUMO (B3u) = -0.0112082035460582
cycle= 24 E= -75.2490225610574  delta_E= 8.53e-14  |g|= 1.25e-10  |ddm|= 5.57e-11
HOMO (B2u) = -0.315579374210464  LUMO (B3u) = -0.0112082035442361
cycle= 25 E= -75.2490225610572  delta_E= 1.42e-13  |g|= 1.06e-10  |ddm|= 4.69e-11
HOMO (B2u) = -0.315579374207603  LUMO (B3u) = -0.0112082035434344
cycle= 26 E= -75.2490225610572  delta_E= 2.84e-14  |g|= 8.35e-11  |ddm|= 6.15e-11
HOMO (B2u) = -0.315579374205477  LUMO (B3u) = -0.0112082035428356
cycle= 27 E= -75.2490225610571  delta_E= 1.42e-13  |g|= 6.81e-11  |ddm|= 4.75e-11
HOMO (B2u) = -0.315579374203675  LUMO (B3u) = -0.0112082035421961
cycle= 28 E= -75.2490225610569  delta_E= 1.42e-13  |g|= 5.49e-11  |ddm|= 3.53e-11
HOMO (B2u) = -0.315579374202262  LUMO (B3u) = -0.0112082035416665
cycle= 29 E= -75.2490225610567  delta_E= 2.27e-13  |g|= 4.35e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.315579374201176  LUMO (B3u) = -0.0112082035412007
cycle= 30 E= -75.2490225610564  delta_E= 2.56e-13  |g|= 3.47e-11  |ddm|= 2.02e-11
HOMO (B2u) = -0.315579374200465  LUMO (B3u) = -0.0112082035408417
cycle= 31 E= -75.2490225610561  delta_E= 3.13e-13  |g|= 2.93e-11  |ddm|= 1.28e-11
HOMO (B2u) = -0.315579374199762  LUMO (B3u) = -0.0112082035405087
cycle= 32 E= -75.2490225610558  delta_E= 3.13e-13  |g|= 2.48e-11  |ddm|= 1.13e-11
HOMO (B2u) = -0.3155793741992  LUMO (B3u) = -0.0112082035402182
cycle= 33 E= -75.2490225610554  delta_E= 4.26e-13  |g|= 2.1e-11  |ddm|= 9.53e-12
HOMO (B2u) = -0.315579374198661  LUMO (B3u) = -0.0112082035399596
cycle= 34 E= -75.249022561055  delta_E= 4.26e-13  |g|= 1.81e-11  |ddm|= 8.08e-12
HOMO (B2u) = -0.315579374198198  LUMO (B3u) = -0.0112082035397083
cycle= 35 E= -75.2490225610546  delta_E= 3.98e-13  |g|= 1.55e-11  |ddm|= 6.44e-12
HOMO (B2u) = -0.315579374197779  LUMO (B3u) = -0.0112082035394487
cycle= 36 E= -75.2490225610541  delta_E= 5.12e-13  |g|= 1.32e-11  |ddm|= 5.51e-12
HOMO (B2u) = -0.315579374197391  LUMO (B3u) = -0.0112082035391772
cycle= 37 E= -75.2490225610533  delta_E= 7.67e-13  |g|= 1.14e-11  |ddm|= 4.7e-12
HOMO (B2u) = -0.315579374197029  LUMO (B3u) = -0.0112082035388991
cycle= 38 E= -75.2490225610527  delta_E= 6.25e-13  |g|= 1e-11  |ddm|= 4.02e-12
HOMO (B2u) = -0.315579374196689  LUMO (B3u) = -0.0112082035386193
cycle= 39 E= -75.2490225610522  delta_E= 4.83e-13  |g|= 8.95e-12  |ddm|= 3.42e-12
HOMO (B2u) = -0.315579374196364  LUMO (B3u) = -0.0112082035383406
cycle= 40 E= -75.2490225610517  delta_E= 4.55e-13  |g|= 7.77e-12  |ddm|= 2.84e-12
HOMO (B2u) = -0.315579374196055  LUMO (B3u) = -0.0112082035380647
cycle= 41 E= -75.2490225610512  delta_E= 4.83e-13  |g|= 6.76e-12  |ddm|= 2.4e-12
HOMO (B2u) = -0.315579374195764  LUMO (B3u) = -0.0112082035377971
cycle= 42 E= -75.2490225610507  delta_E= 5.12e-13  |g|= 6.16e-12  |ddm|= 2.16e-12
HOMO (B2u) = -0.315579374195479  LUMO (B3u) = -0.0112082035375266
cycle= 43 E= -75.2490225610503  delta_E= 3.98e-13  |g|= 5.67e-12  |ddm|= 2e-12
HOMO (B2u) = -0.3155793741952  LUMO (B3u) = -0.0112082035372557
cycle= 44 E= -75.2490225610499  delta_E= 4.26e-13  |g|= 5.35e-12  |ddm|= 1.93e-12
HOMO (B2u) = -0.315579374194934  LUMO (B3u) = -0.0112082035369956
cycle= 45 E= -75.2490225610495  delta_E= 3.69e-13  |g|= 4.99e-12  |ddm|= 1.94e-12
HOMO (B2u) = -0.315579374194683  LUMO (B3u) = -0.0112082035367491
cycle= 46 E= -75.2490225610493  delta_E= 2.84e-13  |g|= 4.55e-12  |ddm|= 2e-12
HOMO (B2u) = -0.315579374194447  LUMO (B3u) = -0.0112082035365171
cycle= 47 E= -75.2490225610491  delta_E= 1.99e-13  |g|= 4.01e-12  |ddm|= 2.07e-12
HOMO (B2u) = -0.315579374194223  LUMO (B3u) = -0.0112082035362982
cycle= 48 E= -75.2490225610488  delta_E= 2.27e-13  |g|= 3.5e-12  |ddm|= 2.1e-12
HOMO (B2u) = -0.315579374194015  LUMO (B3u) = -0.0112082035360938
cycle= 49 E= -75.2490225610486  delta_E= 1.99e-13  |g|= 3.28e-12  |ddm|= 1.9e-12
HOMO (B2u) = -0.315579374193823  LUMO (B3u) = -0.0112082035359061
cycle= 50 E= -75.2490225610483  delta_E= 2.84e-13  |g|= 3.14e-12  |ddm|= 1.67e-12
SCF not converged.
SCF energy = -75.2490225610483

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp1d_ajk_d
max_memory 4000 MB (current use 8711 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.411079088155  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4295148015772  dE = -0.018435713  S^2 = 0.0000000
               |grad[o]|= 0.11  |ddm|= 3.74  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4419615955653  dE = -0.012446794  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.126  |maxRot[o]|=0.0797
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4483092081593  dE = -0.0063476126  S^2 = 0.0000000
               |grad[o]|=0.0462  |ddm|=0.0237  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4501513131696  dE = -0.001842105  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.103  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4507915066812  dE = -0.00064019351  S^2 = 0.0000000
               |grad[o]|=0.00864  |ddm|=0.018  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.450931555394  dE = -0.00014004871  S^2 = 0.0000000
               |grad[o]|=0.00425  |ddm|=0.00738  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4509688489369  dE = -3.7293543e-05  S^2 = 0.0000000
               |grad[o]|=0.00223  |ddm|=0.00337  |maxRot[o]|=0.0132
macro iter 8 (3 JK  0 micro), CASSCF E = -75.450972149416  dE = -3.3004791e-06  S^2 = 0.0000000
               |grad[o]|=0.000816  |ddm|=0.00227  |maxRot[o]|=0.00397
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4509724425349  dE = -2.9311896e-07  S^2 = 0.0000000
               |grad[o]|=0.000262  |ddm|=0.000737  |maxRot[o]|=0.00117
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4509724683906  dE = -2.5855684e-08  S^2 = 0.0000000
               |grad[o]|=7.99e-05  |ddm|=0.00023  |maxRot[o]|=0.000344
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4509724706906  dE = -2.2999842e-09  S^2 = 0.0000000
               |grad[o]|=2.43e-05  |ddm|=6.91e-05  |maxRot[o]|=0.000102
macro iter 12 (2 JK  0 micro), CASSCF E = -75.450972470888  dE = -1.9736035e-10  S^2 = 0.0000000
               |grad[o]|=7.21e-06  |ddm|=2.12e-05  |maxRot[o]|=3.02e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4509724709117  dE = -2.3760549e-11  S^2 = 0.0000000
               |grad[o]|=2.23e-06  |ddm|=6.19e-06  |maxRot[o]|=8.84e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95553918 1.93688267 1.83858345 1.6391569  0.06206759 0.36520862
 0.0550149  0.14754669]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01239   0.01081  -0.00143   0.00000   0.00000
  0 C 2s       0.69827   0.68127  -0.10961  -0.00000   0.00000
  0 C 3s       0.00470   0.01443  -0.02431  -0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000   0.00000   0.69401
  0 C 2py     -0.00000  -0.00000  -0.00000   0.70457   0.00000
  0 C 2pz      0.10978  -0.18822   0.69702  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  0 C 3py     -0.00000   0.00000   0.00000   0.05523   0.00000
  0 C 3pz     -0.00833  -0.00170   0.02237  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02312   0.00000
  0 C 3dz^2    0.01091  -0.00949   0.03179  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000  -0.00000  -0.11663
 0 C 3dx2-y2   0.00204   0.00576  -0.00656   0.00000  -0.00000
  1 C 1s       0.01239  -0.01081  -0.00143   0.00000   0.00000
  1 C 2s       0.69827  -0.68127  -0.10961   0.00000  -0.00000
  1 C 3s       0.00470  -0.01443  -0.02431   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69401
  1 C 2py      0.00000  -0.00000   0.00000   0.70457  -0.00000
  1 C 2pz     -0.10978  -0.18822  -0.69702   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  1 C 3py      0.00000   0.00000   0.00000   0.05523   0.00000
  1 C 3pz      0.00833  -0.00170  -0.02237  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000  -0.02312  -0.00000
  1 C 3dz^2    0.01091   0.00949   0.03179   0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000   0.00000   0.11663
 1 C 3dx2-y2   0.00204  -0.00576  -0.00656   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s      -0.00000   0.00000   0.18769
  0 C 3s       0.00000  -0.00000   0.02542
  0 C 2px      0.00000   0.69895  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.68096
  0 C 3px      0.00000  -0.02298  -0.00000
  0 C 3py      0.00461   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01682
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00772   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00210
  0 C 3dxz     0.00000  -0.10461  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01180
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.18769
  1 C 3s       0.00000   0.00000  -0.02542
  1 C 2px     -0.00000  -0.69895   0.00000
  1 C 2py     -0.70705  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.68096
  1 C 3px     -0.00000   0.02298   0.00000
  1 C 3py     -0.00461  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01682
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00772  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00210
  1 C 3dxz     0.00000  -0.10461  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01180
<CAS-nat-orb|mo-hf>  3  3    0.99630521
<CAS-nat-orb|mo-hf>  4  4    0.99959512
<CAS-nat-orb|mo-hf>  5  5    0.99624281
<CAS-nat-orb|mo-hf>  6  6    0.99840712
<CAS-nat-orb|mo-hf>  7  7    0.93287016
<CAS-nat-orb|mo-hf>  8  8    0.98760133
<CAS-nat-orb|mo-hf>  9  9    0.96104579
<CAS-nat-orb|mo-hf>  10  10    0.96307389
CASSCF energy = -75.4509724709117
CASCI E = -75.4509724709117  E(CI) = -14.7857466796769  S^2 = 0.0000000
......production of RDMs took       5.73 sec
......reading the RDM took          0.49 sec
......production of RDMs took      27.82 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.69 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000074090
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000019570
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000699251
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000084620
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000433023
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000939674
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000313225
HMAT symm error =    0.0150258501
E(MRCI) - E(ref) = -0.1167018498444889 DC = -0.006372962191802592
E(WickICMRCISD)   = -75.56767432075621  E_corr_ci = -0.1167018498444889
E(WickICMRCISD+Q) = -75.57404728294802  E_corr_ci = -0.1230748120362915
Time cost =   3039.011
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Tue May 30 03:11:50 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.116708843680 AA    0.000000000000   0.000000000000   4.000000000000 Bohr   0.0

nuclear repulsion = 9
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 2.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   2087982.74


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp4z_dld52
max_memory 4000 MB (current use 8713 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.65829474285

WARN: Singularity detected in overlap matrix (condition number = 55.3). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.0893486438705823  LUMO (B3u) = -0.0893486438705823

WARN: B2u HOMO -0.0893486438705823 > system LUMO -0.0893486438705823

cycle= 1 E= -75.2192687068769  delta_E= -0.561  |g|= 0.226  |ddm|= 1.45
HOMO (B2u) = -0.339798299416296  LUMO (B3u) = -0.041265862456372
cycle= 2 E= -75.240154283596  delta_E= -0.0209  |g|= 0.0439  |ddm|= 0.347
HOMO (B2u) = -0.308660706394017  LUMO (B3u) = -0.00561531074292567
cycle= 3 E= -75.2413180659383  delta_E= -0.00116  |g|= 0.0164  |ddm|= 0.0569
HOMO (B2u) = -0.312871203858109  LUMO (B3u) = -0.00961084060264919
cycle= 4 E= -75.2415141140048  delta_E= -0.000196  |g|= 0.000633  |ddm|= 0.0328
HOMO (B2u) = -0.312958040513247  LUMO (B3u) = -0.00983140550670129
cycle= 5 E= -75.2415142702404  delta_E= -1.56e-07  |g|= 0.000135  |ddm|= 0.00081
HOMO (B2u) = -0.312924808517806  LUMO (B3u) = -0.00980779398986145
cycle= 6 E= -75.2415142806734  delta_E= -1.04e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.312922000715272  LUMO (B3u) = -0.00980776379454734
cycle= 7 E= -75.2415142809298  delta_E= -2.56e-10  |g|= 2.02e-06  |ddm|= 4.04e-05
HOMO (B2u) = -0.312921604622324  LUMO (B3u) = -0.00980784357418808
cycle= 8 E= -75.2415142809325  delta_E= -2.64e-12  |g|= 1.28e-07  |ddm|= 4.27e-06
HOMO (B2u) = -0.312921617364979  LUMO (B3u) = -0.0098078481710803
cycle= 9 E= -75.2415142809324  delta_E= 5.68e-14  |g|= 6.97e-09  |ddm|= 3.09e-07
HOMO (B2u) = -0.312921616459927  LUMO (B3u) = -0.00980784977548457
cycle= 10 E= -75.2415142809325  delta_E= -9.95e-14  |g|= 6.47e-09  |ddm|= 6.76e-09
HOMO (B2u) = -0.312921616767833  LUMO (B3u) = -0.00980785018189258
cycle= 11 E= -75.2415142809325  delta_E= 2.84e-14  |g|= 4.52e-09  |ddm|= 5.1e-09
HOMO (B2u) = -0.312921615945114  LUMO (B3u) = -0.00980784931540634
cycle= 12 E= -75.2415142809324  delta_E= 4.26e-14  |g|= 3.83e-09  |ddm|= 2.76e-09
HOMO (B2u) = -0.312921616048482  LUMO (B3u) = -0.00980784942792094
cycle= 13 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 3.44e-09  |ddm|= 1.28e-09
HOMO (B2u) = -0.312921615711669  LUMO (B3u) = -0.00980784930675397
cycle= 14 E= -75.2415142809325  delta_E=    0  |g|= 6.02e-10  |ddm|= 6.18e-09
HOMO (B2u) = -0.312921615819668  LUMO (B3u) = -0.00980784934693056
cycle= 15 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 6.91e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615744761  LUMO (B3u) = -0.00980784933898525
cycle= 16 E= -75.2415142809324  delta_E=    0  |g|= 5.81e-10  |ddm|= 9.25e-10
HOMO (B2u) = -0.312921615768062  LUMO (B3u) = -0.00980784930678692
cycle= 17 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 7.3e-10  |ddm|= 1.37e-09
HOMO (B2u) = -0.312921615745458  LUMO (B3u) = -0.00980784929807701
cycle= 18 E= -75.2415142809325  delta_E= 1.42e-14  |g|= 5.55e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.312921615748108  LUMO (B3u) = -0.00980784931184778
cycle= 19 E= -75.2415142809325  delta_E= -7.11e-14  |g|= 4.22e-10  |ddm|= 4.38e-10
HOMO (B2u) = -0.312921615754576  LUMO (B3u) = -0.00980784932722052
cycle= 20 E= -75.2415142809325  delta_E= 4.26e-14  |g|= 3.33e-10  |ddm|= 2.91e-10
HOMO (B2u) = -0.312921615749071  LUMO (B3u) = -0.00980784932930565
cycle= 21 E= -75.2415142809325  delta_E= -1.42e-14  |g|= 2.38e-10  |ddm|= 2.3e-10
HOMO (B2u) = -0.31292161574419  LUMO (B3u) = -0.00980784933207293
cycle= 22 E= -75.2415142809324  delta_E= 5.68e-14  |g|= 1.48e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.312921615742996  LUMO (B3u) = -0.00980784933046021
cycle= 23 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 1.31e-10  |ddm|= 3.97e-11
HOMO (B2u) = -0.312921615738458  LUMO (B3u) = -0.00980784932845032
cycle= 24 E= -75.2415142809323  delta_E= 1.14e-13  |g|= 1.11e-10  |ddm|= 5.14e-11
HOMO (B2u) = -0.312921615737114  LUMO (B3u) = -0.00980784932689817
cycle= 25 E= -75.2415142809323  delta_E=    0  |g|= 9.41e-11  |ddm|= 4.14e-11
HOMO (B2u) = -0.312921615730103  LUMO (B3u) = -0.0098078493251258
Extra cycle  E= -75.2415142809322  delta_E= 8.53e-14  |g|= 3.08e-11  |ddm|= 1.48e-10
converged SCF energy = -75.2415142809322

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp4z_dld52
max_memory 4000 MB (current use 8713 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4079772031603  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4269817802709  dE = -0.019004577  S^2 = 0.0000000
               |grad[o]|=0.112  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4392390609045  dE = -0.012257281  S^2 = 0.0000000
               |grad[o]|=0.0795  |ddm|=0.131  |maxRot[o]|=0.079
macro iter 3 (6 JK  0 micro), CASSCF E = -75.445201108255  dE = -0.0059620474  S^2 = 0.0000000
               |grad[o]|=0.0446  |ddm|=0.0299  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4468486060163  dE = -0.0016474978  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.0972  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4473913047245  dE = -0.00054269871  S^2 = 0.0000000
               |grad[o]|=0.00768  |ddm|=0.0155  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4474931754124  dE = -0.00010187069  S^2 = 0.0000000
               |grad[o]|=0.00359  |ddm|=0.00705  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4475072918844  dE = -1.4116472e-05  S^2 = 0.0000000
               |grad[o]|=0.00155  |ddm|=0.0034  |maxRot[o]|=0.00814
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4475086026484  dE = -1.3107639e-06  S^2 = 0.0000000
               |grad[o]|=0.000542  |ddm|=0.00148  |maxRot[o]|=0.00246
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4475087235353  dE = -1.2088697e-07  S^2 = 0.0000000
               |grad[o]|=0.000173  |ddm|=0.000483  |maxRot[o]|=0.000736
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4475087346377  dE = -1.1102372e-08  S^2 = 0.0000000
               |grad[o]|=5.34e-05  |ddm|=0.000152  |maxRot[o]|=0.000222
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4475087356532  dE = -1.0155219e-09  S^2 = 0.0000000
               |grad[o]|=1.65e-05  |ddm|=4.64e-05  |maxRot[o]|=6.64e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.44750873574  dE = -8.6799901e-11  S^2 = 0.0000000
               |grad[o]|=5.06e-06  |ddm|=1.42e-05  |maxRot[o]|=1.98e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95539888 1.93749713 1.82923655 1.61997885 0.06124689 0.38415951
 0.05468072 0.15780146]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01243   0.01086  -0.00123   0.00000   0.00000
  0 C 2s       0.69987   0.68306  -0.09890  -0.00000   0.00000
  0 C 3s       0.00559   0.01429  -0.02264   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.69417
  0 C 2py      0.00000  -0.00000  -0.00000   0.70461   0.00000
  0 C 2pz      0.09912  -0.18163   0.69866   0.00000   0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.06942
  0 C 3py      0.00000  -0.00000  -0.00000   0.05510   0.00000
  0 C 3pz     -0.00787  -0.00173   0.02398   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02202   0.00000
  0 C 3dz^2    0.00990  -0.00917   0.03103   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.11537
 0 C 3dx2-y2   0.00220   0.00568  -0.00646   0.00000   0.00000
  1 C 1s       0.01243  -0.01086  -0.00123   0.00000   0.00000
  1 C 2s       0.69987  -0.68306  -0.09890  -0.00000   0.00000
  1 C 3s       0.00559  -0.01429  -0.02264  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000  -0.00000  -0.00000   0.69417
  1 C 2py     -0.00000   0.00000   0.00000   0.70461  -0.00000
  1 C 2pz     -0.09912  -0.18163  -0.69866   0.00000   0.00000
  1 C 3px      0.00000   0.00000  -0.00000  -0.00000  -0.06942
  1 C 3py     -0.00000   0.00000   0.00000   0.05510  -0.00000
  1 C 3pz      0.00787  -0.00173  -0.02398   0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02202  -0.00000
  1 C 3dz^2    0.00990   0.00917   0.03103  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000   0.11537
 1 C 3dx2-y2   0.00220  -0.00568  -0.00646  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00018
  0 C 2s      -0.00000  -0.00000   0.18114
  0 C 3s      -0.00000   0.00000   0.02444
  0 C 2px      0.00000   0.69909   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.68284
  0 C 3px     -0.00000  -0.02448   0.00000
  0 C 3py      0.00635  -0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.01417
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00736   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00169
  0 C 3dxz    -0.00000  -0.10334   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01092
  1 C 1s       0.00000   0.00000   0.00018
  1 C 2s       0.00000  -0.00000  -0.18114
  1 C 3s       0.00000  -0.00000  -0.02444
  1 C 2px      0.00000  -0.69909  -0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.68284
  1 C 3px     -0.00000   0.02448  -0.00000
  1 C 3py     -0.00635  -0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01417
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00736   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00169
  1 C 3dxz     0.00000  -0.10334   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01092
<CAS-nat-orb|mo-hf>  3  3    0.99576779
<CAS-nat-orb|mo-hf>  4  4    0.99957524
<CAS-nat-orb|mo-hf>  5  5    0.99568631
<CAS-nat-orb|mo-hf>  6  6    0.99833014
<CAS-nat-orb|mo-hf>  7  7    0.93288522
<CAS-nat-orb|mo-hf>  8  8    0.98831105
<CAS-nat-orb|mo-hf>  9  9    0.96112499
<CAS-nat-orb|mo-hf>  10  10    0.96605594
CASSCF energy = -75.44750873574
CASCI E = -75.44750873574  E(CI) = -14.7317047760616  S^2 = 0.0000000
......production of RDMs took       2.93 sec
......reading the RDM took          0.46 sec
......production of RDMs took      54.57 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         11.94 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000101700
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000026863
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000728584
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000089942
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000451392
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0001007028
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000335676
HMAT symm error =    0.0163343631
E(MRCI) - E(ref) = -0.1168685545586072 DC = -0.006412482189653223
E(WickICMRCISD)   = -75.56437729029864  E_corr_ci = -0.1168685545586072
E(WickICMRCISD+Q) = -75.5707897724883  E_corr_ci = -0.1232810367482605
Time cost =   3112.700
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Tue May 30 04:03:43 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.143167704226 AA    0.000000000000   0.000000000000   4.050000000000 Bohr   0.0

nuclear repulsion = 8.88888888888889
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   2142060.63


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp8ozre0hp
max_memory 4000 MB (current use 8711 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.650821541947

WARN: Singularity detected in overlap matrix (condition number = 52.1). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0872509906487009  LUMO (B3u) = -0.0872509906487007

WARN: B2u HOMO -0.0872509906487009 > system LUMO -0.0872509906487007

cycle= 1 E= -75.2120928138537  delta_E= -0.561  |g|= 0.225  |ddm|= 1.45
HOMO (B2u) = -0.336938998033693  LUMO (B3u) = -0.0396234294723655
cycle= 2 E= -75.2327826177341  delta_E= -0.0207  |g|= 0.0434  |ddm|= 0.347
HOMO (B2u) = -0.306147078592025  LUMO (B3u) = -0.00433141905845612
cycle= 3 E= -75.2339223949765  delta_E= -0.00114  |g|= 0.0162  |ddm|= 0.0561
HOMO (B2u) = -0.310321597199801  LUMO (B3u) = -0.00828279864970623
cycle= 4 E= -75.2341150976661  delta_E= -0.000193  |g|= 0.000629  |ddm|= 0.0325
HOMO (B2u) = -0.310388518956865  LUMO (B3u) = -0.00848075571953718
cycle= 5 E= -75.2341152524229  delta_E= -1.55e-07  |g|= 0.000135  |ddm|= 0.000802
HOMO (B2u) = -0.310356121170238  LUMO (B3u) = -0.00845811286980798
cycle= 6 E= -75.2341152629183  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.310353302460647  LUMO (B3u) = -0.00845802697819558
cycle= 7 E= -75.2341152631768  delta_E= -2.58e-10  |g|= 2.04e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.310352915622104  LUMO (B3u) = -0.00845812345206009
cycle= 8 E= -75.2341152631795  delta_E= -2.7e-12  |g|= 1.28e-07  |ddm|= 4.34e-06
HOMO (B2u) = -0.310352930535094  LUMO (B3u) = -0.00845812953625347
cycle= 9 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 6.66e-09  |ddm|= 3.04e-07
HOMO (B2u) = -0.310352929576746  LUMO (B3u) = -0.00845813118916161
cycle= 10 E= -75.2341152631794  delta_E=    0  |g|= 6.31e-09  |ddm|= 7.04e-09
HOMO (B2u) = -0.310352929991887  LUMO (B3u) = -0.0084581317008041
cycle= 11 E= -75.2341152631795  delta_E= -9.95e-14  |g|= 4.39e-09  |ddm|= 4.78e-09
HOMO (B2u) = -0.310352929258389  LUMO (B3u) = -0.00845813092327023
cycle= 12 E= -75.2341152631794  delta_E= 8.53e-14  |g|= 3.72e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.310352929350486  LUMO (B3u) = -0.00845813101898259
cycle= 13 E= -75.2341152631794  delta_E= -2.84e-14  |g|= 3.35e-09  |ddm|= 1.11e-09
HOMO (B2u) = -0.310352929050747  LUMO (B3u) = -0.00845813092930915
cycle= 14 E= -75.2341152631794  delta_E=    0  |g|= 5.26e-10  |ddm|= 5.83e-09
HOMO (B2u) = -0.310352929162668  LUMO (B3u) = -0.00845813096843038
cycle= 15 E= -75.2341152631795  delta_E= -5.68e-14  |g|= 6.38e-10  |ddm|= 1.08e-09
HOMO (B2u) = -0.310352929093806  LUMO (B3u) = -0.00845813095605681
cycle= 16 E= -75.2341152631794  delta_E= 9.95e-14  |g|= 5.3e-10  |ddm|= 9.18e-10
HOMO (B2u) = -0.310352929110809  LUMO (B3u) = -0.00845813092663165
cycle= 17 E= -75.2341152631795  delta_E= -9.95e-14  |g|= 6.74e-10  |ddm|= 1.16e-09
HOMO (B2u) = -0.310352929092283  LUMO (B3u) = -0.00845813092038636
cycle= 18 E= -75.2341152631794  delta_E= 1.14e-13  |g|= 5.14e-10  |ddm|= 3e-10
HOMO (B2u) = -0.310352929098004  LUMO (B3u) = -0.00845813093592169
cycle= 19 E= -75.2341152631795  delta_E= -8.53e-14  |g|= 3.9e-10  |ddm|= 3.84e-10
HOMO (B2u) = -0.310352929107252  LUMO (B3u) = -0.00845813095308993
cycle= 20 E= -75.2341152631794  delta_E= 2.84e-14  |g|= 3.09e-10  |ddm|= 2.49e-10
HOMO (B2u) = -0.310352929104757  LUMO (B3u) = -0.00845813095747195
cycle= 21 E= -75.2341152631793  delta_E= 1.14e-13  |g|= 2.2e-10  |ddm|= 1.93e-10
HOMO (B2u) = -0.31035292910236  LUMO (B3u) = -0.00845813096210893
cycle= 22 E= -75.2341152631794  delta_E= -5.68e-14  |g|= 1.33e-10  |ddm|= 1.79e-10
HOMO (B2u) = -0.31035292910178  LUMO (B3u) = -0.00845813096067
cycle= 23 E= -75.2341152631791  delta_E= 2.98e-13  |g|= 1.19e-10  |ddm|= 3.47e-11
HOMO (B2u) = -0.310352929097862  LUMO (B3u) = -0.00845813095899314
cycle= 24 E= -75.234115263179  delta_E= 9.95e-14  |g|= 1.01e-10  |ddm|= 4.74e-11
HOMO (B2u) = -0.310352929096946  LUMO (B3u) = -0.00845813095797771
cycle= 25 E= -75.2341152631788  delta_E= 2.27e-13  |g|= 8.5e-11  |ddm|= 3.5e-11
HOMO (B2u) = -0.310352929095509  LUMO (B3u) = -0.00845813095818302
cycle= 26 E= -75.2341152631787  delta_E= 5.68e-14  |g|= 6.77e-11  |ddm|= 3.88e-11
HOMO (B2u) = -0.310352929094485  LUMO (B3u) = -0.00845813095836032
cycle= 27 E= -75.2341152631786  delta_E= 8.53e-14  |g|= 5.66e-11  |ddm|= 3.04e-11
HOMO (B2u) = -0.310352929093488  LUMO (B3u) = -0.00845813095827486
cycle= 28 E= -75.2341152631784  delta_E= 1.85e-13  |g|= 4.63e-11  |ddm|= 2.25e-11
HOMO (B2u) = -0.310352929092656  LUMO (B3u) = -0.00845813095813761
cycle= 29 E= -75.2341152631782  delta_E= 2.42e-13  |g|= 3.68e-11  |ddm|= 1.88e-11
HOMO (B2u) = -0.310352929091993  LUMO (B3u) = -0.00845813095794948
cycle= 30 E= -75.2341152631779  delta_E= 2.42e-13  |g|= 2.96e-11  |ddm|= 1.4e-11
HOMO (B2u) = -0.310352929091551  LUMO (B3u) = -0.00845813095775513
cycle= 31 E= -75.2341152631774  delta_E= 5.54e-13  |g|= 2.52e-11  |ddm|= 9.07e-12
HOMO (B2u) = -0.310352929091072  LUMO (B3u) = -0.00845813095756448
cycle= 32 E= -75.234115263177  delta_E= 3.55e-13  |g|= 2.14e-11  |ddm|= 8.06e-12
HOMO (B2u) = -0.310352929090703  LUMO (B3u) = -0.00845813095739625
cycle= 33 E= -75.2341152631765  delta_E= 5.54e-13  |g|= 1.85e-11  |ddm|= 6.5e-12
HOMO (B2u) = -0.310352929090338  LUMO (B3u) = -0.00845813095724343
cycle= 34 E= -75.234115263176  delta_E= 5.26e-13  |g|= 1.64e-11  |ddm|= 5.35e-12
HOMO (B2u) = -0.310352929090001  LUMO (B3u) = -0.00845813095706435
cycle= 35 E= -75.2341152631753  delta_E= 6.25e-13  |g|= 1.45e-11  |ddm|= 4.51e-12
HOMO (B2u) = -0.310352929089671  LUMO (B3u) = -0.00845813095685044
cycle= 36 E= -75.2341152631748  delta_E= 5.54e-13  |g|= 1.28e-11  |ddm|= 4.22e-12
HOMO (B2u) = -0.310352929089356  LUMO (B3u) = -0.00845813095662071
cycle= 37 E= -75.2341152631742  delta_E= 5.54e-13  |g|= 1.12e-11  |ddm|= 3.78e-12
HOMO (B2u) = -0.310352929089057  LUMO (B3u) = -0.00845813095638165
cycle= 38 E= -75.2341152631736  delta_E= 5.68e-13  |g|= 9.83e-12  |ddm|= 3.19e-12
HOMO (B2u) = -0.310352929088774  LUMO (B3u) = -0.00845813095614098
cycle= 39 E= -75.2341152631732  delta_E= 4.97e-13  |g|= 8.8e-12  |ddm|= 2.68e-12
HOMO (B2u) = -0.310352929088503  LUMO (B3u) = -0.00845813095590569
cycle= 40 E= -75.2341152631725  delta_E= 6.82e-13  |g|= 7.89e-12  |ddm|= 2.4e-12
HOMO (B2u) = -0.310352929088248  LUMO (B3u) = -0.00845813095567863
cycle= 41 E= -75.2341152631721  delta_E= 3.69e-13  |g|= 7.19e-12  |ddm|= 2.17e-12
HOMO (B2u) = -0.310352929088001  LUMO (B3u) = -0.00845813095545647
cycle= 42 E= -75.2341152631717  delta_E= 4.26e-13  |g|= 6.6e-12  |ddm|= 2.01e-12
HOMO (B2u) = -0.310352929087767  LUMO (B3u) = -0.00845813095524095
cycle= 43 E= -75.2341152631713  delta_E= 3.98e-13  |g|= 6.06e-12  |ddm|= 1.89e-12
HOMO (B2u) = -0.310352929087544  LUMO (B3u) = -0.00845813095503373
cycle= 44 E= -75.234115263171  delta_E= 2.56e-13  |g|= 5.54e-12  |ddm|= 1.79e-12
HOMO (B2u) = -0.310352929087337  LUMO (B3u) = -0.00845813095483977
cycle= 45 E= -75.2341152631708  delta_E= 2.27e-13  |g|= 5.22e-12  |ddm|= 1.78e-12
HOMO (B2u) = -0.310352929087143  LUMO (B3u) = -0.00845813095465802
cycle= 46 E= -75.2341152631707  delta_E= 1.42e-13  |g|= 4.87e-12  |ddm|= 1.97e-12
HOMO (B2u) = -0.310352929086967  LUMO (B3u) = -0.00845813095449199
cycle= 47 E= -75.2341152631705  delta_E= 1.99e-13  |g|= 4.49e-12  |ddm|= 2.06e-12
HOMO (B2u) = -0.310352929086806  LUMO (B3u) = -0.00845813095434147
cycle= 48 E= -75.2341152631702  delta_E= 2.84e-13  |g|= 4.32e-12  |ddm|= 2.07e-12
HOMO (B2u) = -0.310352929086659  LUMO (B3u) = -0.00845813095420355
cycle= 49 E= -75.2341152631701  delta_E= 1.14e-13  |g|= 3.85e-12  |ddm|= 2.17e-12
HOMO (B2u) = -0.310352929086528  LUMO (B3u) = -0.00845813095407843
cycle= 50 E= -75.2341152631697  delta_E= 3.13e-13  |g|= 3.45e-12  |ddm|= 2.12e-12
SCF not converged.
SCF energy = -75.2341152631697

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmp8ozre0hp
max_memory 4000 MB (current use 8711 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4050131046161  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4242568550164  dE = -0.01924375  S^2 = 0.0000000
               |grad[o]|=0.114  |ddm|= 3.72  |maxRot[o]|=0.0783
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4363763708249  dE = -0.012119516  S^2 = 0.0000000
               |grad[o]|=0.0799  |ddm|=0.133  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4421108433977  dE = -0.0057344726  S^2 = 0.0000000
               |grad[o]|=0.044  |ddm|=0.0334  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4436341196009  dE = -0.0015232762  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.0929  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4441217800073  dE = -0.00048766041  S^2 = 0.0000000
               |grad[o]|=0.00714  |ddm|=0.0141  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4441999159791  dE = -7.8135972e-05  S^2 = 0.0000000
               |grad[o]|=0.00324  |ddm|=0.00699  |maxRot[o]|=0.0188
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4442076928444  dE = -7.7768654e-06  S^2 = 0.0000000
               |grad[o]|=0.00125  |ddm|=0.00327  |maxRot[o]|=0.00597
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4442084526307  dE = -7.5978627e-07  S^2 = 0.0000000
               |grad[o]|=0.000426  |ddm|=0.00115  |maxRot[o]|=0.00183
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4442085258774  dE = -7.3246639e-08  S^2 = 0.0000000
               |grad[o]|=0.000137  |ddm|=0.000379  |maxRot[o]|=0.000563
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4442085329124  dE = -7.0350694e-09  S^2 = 0.0000000
               |grad[o]|=4.32e-05  |ddm|=0.000121  |maxRot[o]|=0.000173
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4442085335836  dE = -6.7119288e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=3.77e-05  |maxRot[o]|=5.35e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4442085336482  dE = -6.4574124e-11  S^2 = 0.0000000
               |grad[o]|=4.2e-06  |ddm|=1.18e-05  |maxRot[o]|=1.64e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95530406 1.9381115  1.81911526 1.60013609 0.06045908 0.40376979
 0.05434301 0.16876121]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01246   0.01091  -0.00105   0.00000   0.00000
  0 C 2s       0.70117   0.68475  -0.08932   0.00000   0.00000
  0 C 3s       0.00639   0.01416  -0.02106   0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69435
  0 C 2py      0.00000   0.00000  -0.00000   0.70466  -0.00000
  0 C 2pz      0.08959  -0.17518   0.69998   0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06986
  0 C 3py     -0.00000   0.00000   0.00000   0.05490   0.00000
  0 C 3pz     -0.00744  -0.00175   0.02554   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.02095   0.00000
  0 C 3dz^2    0.00897  -0.00886   0.03021   0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11401
 0 C 3dx2-y2   0.00234   0.00560  -0.00636   0.00000   0.00000
  1 C 1s       0.01246  -0.01091  -0.00105   0.00000   0.00000
  1 C 2s       0.70117  -0.68475  -0.08932   0.00000   0.00000
  1 C 3s       0.00639  -0.01416  -0.02106  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70466  -0.00000
  1 C 2pz     -0.08959  -0.17518  -0.69998   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000   0.00000  -0.06986
  1 C 3py      0.00000  -0.00000   0.00000   0.05490  -0.00000
  1 C 3pz      0.00744  -0.00175  -0.02554   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02095   0.00000
  1 C 3dz^2    0.00897   0.00886   0.03021  -0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11401
 1 C 3dx2-y2   0.00234  -0.00560  -0.00636  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00016
  0 C 2s       0.00000   0.00000   0.17473
  0 C 3s       0.00000   0.00000   0.02347
  0 C 2px     -0.00000   0.69923   0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68460
  0 C 3px     -0.00000  -0.02593  -0.00000
  0 C 3py      0.00804  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.01155
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00702  -0.00000  -0.00000
  0 C 3dz^2    0.00000   0.00000   0.00132
  0 C 3dxz    -0.00000  -0.10203   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01008
  1 C 1s       0.00000   0.00000   0.00016
  1 C 2s      -0.00000  -0.00000  -0.17473
  1 C 3s      -0.00000  -0.00000  -0.02347
  1 C 2px      0.00000  -0.69923   0.00000
  1 C 2py     -0.70703   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68460
  1 C 3px      0.00000   0.02593  -0.00000
  1 C 3py     -0.00804   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.01155
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00702   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00132
  1 C 3dxz    -0.00000  -0.10203   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01008
<CAS-nat-orb|mo-hf>  3  3    0.99532682
<CAS-nat-orb|mo-hf>  4  4    0.99955353
<CAS-nat-orb|mo-hf>  5  5    0.99522358
<CAS-nat-orb|mo-hf>  6  6    0.99825105
<CAS-nat-orb|mo-hf>  7  7    0.93296318
<CAS-nat-orb|mo-hf>  8  8    0.98897441
<CAS-nat-orb|mo-hf>  9  9    0.96119968
<CAS-nat-orb|mo-hf>  10  10    0.96876542
CASSCF energy = -75.4442085336482
CASCI E = -75.4442085336482  E(CI) = -14.6790718460568  S^2 = 0.0000000
......production of RDMs took       2.40 sec
......reading the RDM took          0.45 sec
......production of RDMs took      37.18 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took          9.52 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000042741
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000011289
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000681347
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000083422
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000419875
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0001001362
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000333787
HMAT symm error =    0.0134237935
E(MRCI) - E(ref) = -0.1170264596157011 DC = -0.006450414574493305
E(WickICMRCISD)   = -75.56123499326389  E_corr_ci = -0.1170264596157011
E(WickICMRCISD+Q) = -75.56768540783838  E_corr_ci = -0.1234768741901944
Time cost =   3188.267
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Tue May 30 04:56:51 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.169626564772 AA    0.000000000000   0.000000000000   4.100000000000 Bohr   0.0

nuclear repulsion = 8.78048780487805
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   2.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   2197478.86


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpcg71bfhu
max_memory 4000 MB (current use 8713 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6438760157729

WARN: Singularity detected in overlap matrix (condition number = 49.2). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0852438140031957  LUMO (B3u) = -0.0852438140031957

WARN: B2u HOMO -0.0852438140031957 > system LUMO -0.0852438140031957

cycle= 1 E= -75.2050111450144  delta_E= -0.561  |g|= 0.224  |ddm|= 1.45
HOMO (B2u) = -0.334187231388071  LUMO (B3g) = -0.0398454588841031
cycle= 2 E= -75.2255220782413  delta_E= -0.0205  |g|= 0.043  |ddm|= 0.347
HOMO (B2u) = -0.30372256156516  LUMO (B3g) = -0.00486882385407491
cycle= 3 E= -75.2266381654048  delta_E= -0.00112  |g|= 0.0161  |ddm|= 0.0554
HOMO (B2u) = -0.307858619678188  LUMO (B3g) = -0.0077666680528308
cycle= 4 E= -75.2268275306809  delta_E= -0.000189  |g|= 0.000623  |ddm|= 0.0321
HOMO (B2u) = -0.307904877132325  LUMO (B3g) = -0.0079120047359308
cycle= 5 E= -75.2268276836983  delta_E= -1.53e-07  |g|= 0.000135  |ddm|= 0.000792
HOMO (B2u) = -0.307873376598217  LUMO (B3g) = -0.0078718186414497
cycle= 6 E= -75.2268276941976  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000228
HOMO (B2u) = -0.307870547891905  LUMO (B3g) = -0.00786924076200173
cycle= 7 E= -75.2268276944567  delta_E= -2.59e-10  |g|= 2.07e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.307870168621817  LUMO (B3g) = -0.00786899944460292
cycle= 8 E= -75.2268276944594  delta_E= -2.74e-12  |g|= 1.28e-07  |ddm|= 4.42e-06
HOMO (B2u) = -0.307870185809366  LUMO (B3g) = -0.00786900390117577
cycle= 9 E= -75.2268276944594  delta_E= 2.84e-14  |g|= 6.56e-09  |ddm|= 2.97e-07
HOMO (B2u) = -0.307870184795259  LUMO (B3g) = -0.00786900501367667
cycle= 10 E= -75.2268276944594  delta_E= -4.26e-14  |g|= 6.26e-09  |ddm|= 7.52e-09
HOMO (B2u) = -0.307870185325629  LUMO (B3g) = -0.00786900549296982
cycle= 11 E= -75.2268276944594  delta_E=    0  |g|= 4.35e-09  |ddm|= 4.43e-09
HOMO (B2u) = -0.307870184673259  LUMO (B3g) = -0.00786900468938985
cycle= 12 E= -75.2268276944595  delta_E= -8.53e-14  |g|= 3.7e-09  |ddm|= 2.56e-09
HOMO (B2u) = -0.307870184756425  LUMO (B3g) = -0.00786900477073713
cycle= 13 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 3.33e-09  |ddm|= 9.6e-10
HOMO (B2u) = -0.307870184502857  LUMO (B3g) = -0.00786900460315198
cycle= 14 E= -75.2268276944596  delta_E= -5.68e-14  |g|= 5.16e-10  |ddm|= 5.31e-09
HOMO (B2u) = -0.307870184616368  LUMO (B3g) = -0.00786900470665598
cycle= 15 E= -75.2268276944595  delta_E= 7.11e-14  |g|= 6.33e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.307870184548759  LUMO (B3g) = -0.00786900464747879
cycle= 16 E= -75.2268276944595  delta_E= 1.42e-14  |g|= 5.31e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.307870184560441  LUMO (B3g) = -0.0078690046596384
cycle= 17 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 6.57e-10  |ddm|= 9.06e-10
HOMO (B2u) = -0.307870184545934  LUMO (B3g) = -0.00786900465087811
cycle= 18 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 5.03e-10  |ddm|= 2.42e-10
HOMO (B2u) = -0.307870184554947  LUMO (B3g) = -0.00786900465781755
cycle= 19 E= -75.2268276944594  delta_E= 1.42e-14  |g|= 3.83e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.307870184567197  LUMO (B3g) = -0.00786900467028308
cycle= 20 E= -75.2268276944595  delta_E= -1.42e-14  |g|= 3.05e-10  |ddm|= 2.09e-10
HOMO (B2u) = -0.307870184567794  LUMO (B3g) = -0.00786900467434109
cycle= 21 E= -75.2268276944594  delta_E= 7.11e-14  |g|= 2.16e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.30787018456797  LUMO (B3g) = -0.00786900467912575
cycle= 22 E= -75.2268276944593  delta_E= 1.14e-13  |g|= 1.3e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.307870184567947  LUMO (B3g) = -0.00786900467997868
cycle= 23 E= -75.2268276944591  delta_E= 1.71e-13  |g|= 1.16e-10  |ddm|= 3.48e-11
HOMO (B2u) = -0.307870184564505  LUMO (B3g) = -0.00786900467807376
cycle= 24 E= -75.226827694459  delta_E= 9.95e-14  |g|= 9.85e-11  |ddm|= 4.86e-11
HOMO (B2u) = -0.307870184564104  LUMO (B3g) = -0.00786900467867828
cycle= 25 E= -75.2268276944588  delta_E= 2.27e-13  |g|= 8.27e-11  |ddm|= 3.06e-11
HOMO (B2u) = -0.307870184563433  LUMO (B3g) = -0.00786900467875063
cycle= 26 E= -75.2268276944587  delta_E= 9.95e-14  |g|= 6.63e-11  |ddm|= 2.96e-11
HOMO (B2u) = -0.307870184562996  LUMO (B3g) = -0.00786900467871481
cycle= 27 E= -75.2268276944585  delta_E= 1.28e-13  |g|= 5.6e-11  |ddm|= 2.32e-11
HOMO (B2u) = -0.307870184562419  LUMO (B3g) = -0.00786900467872891
cycle= 28 E= -75.2268276944584  delta_E= 1.71e-13  |g|= 4.61e-11  |ddm|= 1.81e-11
HOMO (B2u) = -0.307870184561889  LUMO (B3g) = -0.00786900467886443
cycle= 29 E= -75.2268276944583  delta_E= 9.95e-14  |g|= 3.68e-11  |ddm|= 1.63e-11
HOMO (B2u) = -0.30787018456144  LUMO (B3g) = -0.00786900467895938
cycle= 30 E= -75.226827694458  delta_E= 3.27e-13  |g|= 2.97e-11  |ddm|= 1.27e-11
HOMO (B2u) = -0.307870184561135  LUMO (B3g) = -0.00786900467902489
cycle= 31 E= -75.2268276944574  delta_E= 5.4e-13  |g|= 2.54e-11  |ddm|= 8.46e-12
HOMO (B2u) = -0.307870184560779  LUMO (B3g) = -0.00786900467901494
cycle= 32 E= -75.2268276944569  delta_E= 5.26e-13  |g|= 2.17e-11  |ddm|= 7.48e-12
HOMO (B2u) = -0.307870184560515  LUMO (B3g) = -0.00786900467903826
cycle= 33 E= -75.2268276944564  delta_E= 5.26e-13  |g|= 1.88e-11  |ddm|= 5.92e-12
HOMO (B2u) = -0.30787018456024  LUMO (B3g) = -0.00786900467901103
cycle= 34 E= -75.2268276944557  delta_E= 6.54e-13  |g|= 1.67e-11  |ddm|= 4.9e-12
HOMO (B2u) = -0.307870184559966  LUMO (B3g) = -0.0078690046789698
cycle= 35 E= -75.226827694455  delta_E= 7.25e-13  |g|= 1.5e-11  |ddm|= 4.27e-12
HOMO (B2u) = -0.307870184559676  LUMO (B3g) = -0.00786900467891458
cycle= 36 E= -75.2268276944545  delta_E= 5.12e-13  |g|= 1.32e-11  |ddm|= 4.13e-12
HOMO (B2u) = -0.30787018455939  LUMO (B3g) = -0.00786900467884393
cycle= 37 E= -75.226827694454  delta_E= 4.55e-13  |g|= 1.17e-11  |ddm|= 3.73e-12
HOMO (B2u) = -0.307870184559112  LUMO (B3g) = -0.00786900467876468
cycle= 38 E= -75.2268276944535  delta_E= 5.54e-13  |g|= 1.04e-11  |ddm|= 3.16e-12
HOMO (B2u) = -0.307870184558834  LUMO (B3g) = -0.00786900467866806
cycle= 39 E= -75.226827694453  delta_E= 4.97e-13  |g|= 9.35e-12  |ddm|= 2.73e-12
HOMO (B2u) = -0.307870184558562  LUMO (B3g) = -0.00786900467856577
cycle= 40 E= -75.2268276944524  delta_E= 5.68e-13  |g|= 8.43e-12  |ddm|= 2.49e-12
HOMO (B2u) = -0.307870184558297  LUMO (B3g) = -0.00786900467846049
cycle= 41 E= -75.2268276944519  delta_E= 5.26e-13  |g|= 7.54e-12  |ddm|= 2.24e-12
HOMO (B2u) = -0.307870184558037  LUMO (B3g) = -0.00786900467834929
cycle= 42 E= -75.2268276944515  delta_E= 3.55e-13  |g|= 6.75e-12  |ddm|= 2.09e-12
HOMO (B2u) = -0.307870184557792  LUMO (B3g) = -0.00786900467823774
cycle= 43 E= -75.2268276944511  delta_E= 3.69e-13  |g|= 6.21e-12  |ddm|= 1.88e-12
HOMO (B2u) = -0.30787018455756  LUMO (B3g) = -0.00786900467812496
cycle= 44 E= -75.2268276944509  delta_E= 2.84e-13  |g|= 5.66e-12  |ddm|= 1.81e-12
HOMO (B2u) = -0.307870184557338  LUMO (B3g) = -0.00786900467801507
cycle= 45 E= -75.2268276944507  delta_E= 1.85e-13  |g|= 5.21e-12  |ddm|= 1.82e-12
HOMO (B2u) = -0.307870184557129  LUMO (B3g) = -0.00786900467790704
cycle= 46 E= -75.2268276944504  delta_E= 2.56e-13  |g|= 4.93e-12  |ddm|= 1.88e-12
HOMO (B2u) = -0.307870184556939  LUMO (B3g) = -0.00786900467780729
cycle= 47 E= -75.2268276944502  delta_E= 2.42e-13  |g|= 4.64e-12  |ddm|= 1.98e-12
HOMO (B2u) = -0.307870184556764  LUMO (B3g) = -0.00786900467771272
cycle= 48 E= -75.2268276944498  delta_E= 3.55e-13  |g|= 4.37e-12  |ddm|= 1.97e-12
HOMO (B2u) = -0.307870184556609  LUMO (B3g) = -0.00786900467762731
cycle= 49 E= -75.2268276944496  delta_E= 1.85e-13  |g|= 4.2e-12  |ddm|= 2.01e-12
HOMO (B2u) = -0.307870184556469  LUMO (B3g) = -0.00786900467755079
cycle= 50 E= -75.2268276944494  delta_E= 1.99e-13  |g|= 4.03e-12  |ddm|= 2.1e-12
SCF not converged.
SCF energy = -75.2268276944494

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpcg71bfhu
max_memory 4000 MB (current use 8713 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4021896555603  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4214622710135  dE = -0.019272615  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 3.71  |maxRot[o]|=0.0798
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4334669884843  dE = -0.012004717  S^2 = 0.0000000
               |grad[o]|=0.0809  |ddm|=0.133  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4390840830975  dE = -0.0056170946  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.033  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4405313907132  dE = -0.0014473076  S^2 = 0.0000000
               |grad[o]|=0.0131  |ddm|=0.0907  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4409977480156  dE = -0.0004663573  S^2 = 0.0000000
               |grad[o]|=0.00691  |ddm|=0.0135  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4410655925366  dE = -6.7844521e-05  S^2 = 0.0000000
               |grad[o]|=0.00313  |ddm|=0.00709  |maxRot[o]|=0.0174
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4410727624914  dE = -7.1699547e-06  S^2 = 0.0000000
               |grad[o]|=0.00122  |ddm|=0.00314  |maxRot[o]|=0.00565
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4410735010525  dE = -7.385611e-07  S^2 = 0.0000000
               |grad[o]|=0.000424  |ddm|=0.00113  |maxRot[o]|=0.00178
macro iter 9 (3 JK  0 micro), CASSCF E = -75.441073576053  dE = -7.5000557e-08  S^2 = 0.0000000
               |grad[o]|=0.000139  |ddm|=0.00038  |maxRot[o]|=0.000561
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4410735836074  dE = -7.5544193e-09  S^2 = 0.0000000
               |grad[o]|=4.5e-05  |ddm|=0.000124  |maxRot[o]|=0.000177
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4410735843694  dE = -7.6192919e-10  S^2 = 0.0000000
               |grad[o]|=1.45e-05  |ddm|=4.01e-05  |maxRot[o]|=5.59e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4410735844463  dE = -7.6937567e-11  S^2 = 0.0000000
               |grad[o]|=4.62e-06  |ddm|=1.28e-05  |maxRot[o]|=1.77e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.955248   1.93872422 1.80820219 1.57967992 0.42398996 0.05970208
 0.05400185 0.18045177]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01248   0.01096  -0.00089   0.00000   0.00000
  0 C 2s       0.70221   0.68634  -0.08081   0.00000   0.00000
  0 C 3s       0.00710   0.01405  -0.01955  -0.00000   0.00000
  0 C 2px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 2py      0.00000  -0.00000   0.00000   0.70471   0.70701
  0 C 2pz      0.08112  -0.16887   0.70104   0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3py      0.00000  -0.00000   0.00000   0.05462   0.00967
  0 C 3pz     -0.00705  -0.00178   0.02705  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.01990   0.00668
  0 C 3dz^2    0.00810  -0.00856   0.02935  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.00000
 0 C 3dx2-y2   0.00247   0.00552  -0.00626   0.00000  -0.00000
  1 C 1s       0.01248  -0.01096  -0.00089   0.00000   0.00000
  1 C 2s       0.70221  -0.68634  -0.08081   0.00000   0.00000
  1 C 3s       0.00710  -0.01405  -0.01955  -0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 2py     -0.00000   0.00000  -0.00000   0.70471  -0.70701
  1 C 2pz     -0.08112  -0.16887  -0.70104   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3py     -0.00000   0.00000  -0.00000   0.05462  -0.00967
  1 C 3pz      0.00705  -0.00178  -0.02705   0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.01990   0.00668
  1 C 3dz^2    0.00810   0.00856   0.02935  -0.00000  -0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
 1 C 3dx2-y2   0.00247  -0.00552  -0.00626  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00015
  0 C 2s       0.00000   0.00000   0.16846
  0 C 3s       0.00000  -0.00000   0.02250
  0 C 2px      0.69455   0.69937   0.00000
  0 C 2py     -0.00000  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68626
  0 C 3px     -0.07025  -0.02735   0.00000
  0 C 3py     -0.00000   0.00000   0.00000
  0 C 3pz      0.00000  -0.00000  -0.00897
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00098
  0 C 3dxz    -0.11253  -0.10066   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00927
  1 C 1s       0.00000   0.00000   0.00015
  1 C 2s      -0.00000   0.00000  -0.16846
  1 C 3s      -0.00000  -0.00000  -0.02250
  1 C 2px      0.69455  -0.69937  -0.00000
  1 C 2py     -0.00000  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.68626
  1 C 3px     -0.07025   0.02735  -0.00000
  1 C 3py     -0.00000   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.00897
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00098
  1 C 3dxz     0.11253  -0.10066   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00927
<CAS-nat-orb|mo-hf>  3  3    0.99498964
<CAS-nat-orb|mo-hf>  4  4    0.99952981
<CAS-nat-orb|mo-hf>  5  5    0.99486174
<CAS-nat-orb|mo-hf>  6  6    0.99817000
<CAS-nat-orb|mo-hf>  7  7    0.98959360
<CAS-nat-orb|mo-hf>  8  8    0.93310237
<CAS-nat-orb|mo-hf>  9  9    0.96127106
<CAS-nat-orb|mo-hf>  10  10    0.97122879
CASSCF energy = -75.4410735844463
CASCI E = -75.4410735844463  E(CI) = -14.6278044350822  S^2 = 0.0000000
......production of RDMs took       3.02 sec
......reading the RDM took          0.57 sec
......production of RDMs took      35.03 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.32 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000023388
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000006178
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000518351
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000065497
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000317550
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0000751397
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000250466
HMAT symm error =    0.0114490713
E(MRCI) - E(ref) = -0.1171747221391115 DC = -0.006486578152756817
E(WickICMRCISD)   = -75.55824830658543  E_corr_ci = -0.1171747221391115
E(WickICMRCISD+Q) = -75.56473488473819  E_corr_ci = -0.1236613002918683
Time cost =   3562.190
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-21-33.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Tue May 30 05:56:13 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.196085425318 AA    0.000000000000   0.000000000000   4.150000000000 Bohr   0.0

nuclear repulsion = 8.67469879518072
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:   2261271.17


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpthms_3lo
max_memory 4000 MB (current use 8711 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6374240354882

WARN: Singularity detected in overlap matrix (condition number = 46.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0833226379096652  LUMO (B3u) = -0.0833226379096652

WARN: B2u HOMO -0.0833226379096652 > system LUMO -0.0833226379096652

cycle= 1 E= -75.1980259935244  delta_E= -0.561  |g|= 0.223  |ddm|= 1.45
HOMO (B2u) = -0.331539393004466  LUMO (B3g) = -0.042479426899903
cycle= 2 E= -75.2183742970649  delta_E= -0.0203  |g|= 0.0426  |ddm|= 0.347
HOMO (B2u) = -0.301383734536958  LUMO (B3g) = -0.00782777517474283
cycle= 3 E= -75.2194670845425  delta_E= -0.00109  |g|= 0.0159  |ddm|= 0.0547
HOMO (B2u) = -0.305478746489495  LUMO (B3g) = -0.010733308875924
cycle= 4 E= -75.2196531399389  delta_E= -0.000186  |g|= 0.000618  |ddm|= 0.0318
HOMO (B2u) = -0.305504012954427  LUMO (B3g) = -0.0108540193385371
cycle= 5 E= -75.2196532909579  delta_E= -1.51e-07  |g|= 0.000135  |ddm|= 0.000782
HOMO (B2u) = -0.305473477058594  LUMO (B3g) = -0.0108148524604041
cycle= 6 E= -75.219653301404  delta_E= -1.04e-08  |g|= 1.98e-05  |ddm|= 0.000227
HOMO (B2u) = -0.305470638287291  LUMO (B3g) = -0.0108121741027792
cycle= 7 E= -75.2196533016625  delta_E= -2.58e-10  |g|= 2.1e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.305470264892431  LUMO (B3g) = -0.0108119322510386
cycle= 8 E= -75.2196533016654  delta_E= -2.87e-12  |g|= 1.29e-07  |ddm|= 4.5e-06
HOMO (B2u) = -0.305470284406465  LUMO (B3g) = -0.0108119381626839
cycle= 9 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 6.74e-09  |ddm|= 2.91e-07
HOMO (B2u) = -0.305470283327175  LUMO (B3g) = -0.0108119393051191
cycle= 10 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 6.37e-09  |ddm|= 8.17e-09
HOMO (B2u) = -0.305470283985962  LUMO (B3g) = -0.0108119399154113
cycle= 11 E= -75.2196533016653  delta_E= -2.84e-14  |g|= 4.44e-09  |ddm|= 4.14e-09
HOMO (B2u) = -0.305470283403762  LUMO (B3g) = -0.0108119391826612
cycle= 12 E= -75.2196533016653  delta_E=    0  |g|= 3.79e-09  |ddm|= 2.46e-09
HOMO (B2u) = -0.305470283231267  LUMO (B3g) = -0.0108119391067099
cycle= 13 E= -75.2196533016654  delta_E= -2.84e-14  |g|= 3.38e-10  |ddm|= 5.65e-09
HOMO (B2u) = -0.305470283280833  LUMO (B3g) = -0.0108119391356951
cycle= 14 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 4.47e-10  |ddm|= 6.62e-10
HOMO (B2u) = -0.305470283380742  LUMO (B3g) = -0.0108119392267769
cycle= 15 E= -75.2196533016654  delta_E= -4.26e-14  |g|= 5.45e-10  |ddm|= 9.28e-10
HOMO (B2u) = -0.305470283318582  LUMO (B3g) = -0.0108119391708652
cycle= 16 E= -75.2196533016653  delta_E= 4.26e-14  |g|= 4.69e-10  |ddm|= 8.42e-10
HOMO (B2u) = -0.305470283328601  LUMO (B3g) = -0.0108119391822765
cycle= 17 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 5.85e-10  |ddm|= 9.63e-10
HOMO (B2u) = -0.30547028331764  LUMO (B3g) = -0.0108119391766986
cycle= 18 E= -75.2196533016652  delta_E= 9.95e-14  |g|= 4.24e-10  |ddm|= 2.55e-10
HOMO (B2u) = -0.305470283329685  LUMO (B3g) = -0.0108119391863874
cycle= 19 E= -75.2196533016652  delta_E= -1.42e-14  |g|= 2.87e-10  |ddm|= 2.99e-10
HOMO (B2u) = -0.305470283344797  LUMO (B3g) = -0.0108119392016171
cycle= 20 E= -75.2196533016652  delta_E= 2.84e-14  |g|= 1.97e-10  |ddm|= 1.86e-10
HOMO (B2u) = -0.305470283348183  LUMO (B3g) = -0.0108119392084041
cycle= 21 E= -75.2196533016651  delta_E= 8.53e-14  |g|= 1.04e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.305470283348753  LUMO (B3g) = -0.0108119392083464
cycle= 22 E= -75.2196533016653  delta_E= -1.42e-13  |g|= 1.02e-10  |ddm|= 1.99e-11
HOMO (B2u) = -0.305470283349391  LUMO (B3g) = -0.0108119392095878
cycle= 23 E= -75.2196533016652  delta_E= 8.53e-14  |g|= 8.99e-11  |ddm|= 3.47e-11
HOMO (B2u) = -0.305470283347049  LUMO (B3g) = -0.0108119392083947
cycle= 24 E= -75.2196533016651  delta_E= 8.53e-14  |g|= 7.52e-11  |ddm|= 4.37e-11
HOMO (B2u) = -0.305470283347479  LUMO (B3g) = -0.0108119392096187
cycle= 25 E= -75.219653301665  delta_E= 8.53e-14  |g|= 6.16e-11  |ddm|= 3.41e-11
HOMO (B2u) = -0.305470283347749  LUMO (B3g) = -0.0108119392103766
cycle= 26 E= -75.2196533016651  delta_E= -8.53e-14  |g|= 4.61e-11  |ddm|= 2.42e-11
HOMO (B2u) = -0.305470283348095  LUMO (B3g) = -0.0108119392108431
cycle= 27 E= -75.219653301665  delta_E= 5.68e-14  |g|= 3.73e-11  |ddm|= 1.77e-11
HOMO (B2u) = -0.305470283348156  LUMO (B3g) = -0.0108119392111906
cycle= 28 E= -75.2196533016649  delta_E= 1.42e-13  |g|= 2.99e-11  |ddm|= 1.24e-11
HOMO (B2u) = -0.305470283348175  LUMO (B3g) = -0.0108119392115457
cycle= 29 E= -75.2196533016646  delta_E= 3.13e-13  |g|= 2.38e-11  |ddm|= 1.05e-11
HOMO (B2u) = -0.305470283348207  LUMO (B3g) = -0.010811939211774
cycle= 30 E= -75.2196533016642  delta_E= 3.41e-13  |g|= 2.05e-11  |ddm|= 6.48e-12
HOMO (B2u) = -0.305470283348146  LUMO (B3g) = -0.0108119392119533
cycle= 31 E= -75.2196533016638  delta_E= 3.98e-13  |g|= 1.72e-11  |ddm|= 6.8e-12
HOMO (B2u) = -0.305470283348023  LUMO (B3g) = -0.0108119392120479
cycle= 32 E= -75.2196533016634  delta_E= 4.26e-13  |g|= 1.44e-11  |ddm|= 5.82e-12
HOMO (B2u) = -0.305470283347959  LUMO (B3g) = -0.0108119392121555
cycle= 33 E= -75.2196533016629  delta_E= 4.97e-13  |g|= 1.24e-11  |ddm|= 4.48e-12
HOMO (B2u) = -0.305470283347856  LUMO (B3g) = -0.010811939212193
cycle= 34 E= -75.2196533016623  delta_E= 5.83e-13  |g|= 1.11e-11  |ddm|= 3.43e-12
HOMO (B2u) = -0.305470283347727  LUMO (B3g) = -0.0108119392121968
cycle= 35 E= -75.2196533016616  delta_E= 7.11e-13  |g|= 1.02e-11  |ddm|= 2.96e-12
HOMO (B2u) = -0.305470283347554  LUMO (B3g) = -0.0108119392121644
cycle= 36 E= -75.2196533016611  delta_E= 5.4e-13  |g|= 9.17e-12  |ddm|= 3.09e-12
HOMO (B2u) = -0.305470283347355  LUMO (B3g) = -0.0108119392121019
cycle= 37 E= -75.2196533016605  delta_E= 5.97e-13  |g|= 8.14e-12  |ddm|= 2.86e-12
HOMO (B2u) = -0.305470283347143  LUMO (B3g) = -0.0108119392120135
cycle= 38 E= -75.21965330166  delta_E= 4.55e-13  |g|= 7.12e-12  |ddm|= 2.69e-12
HOMO (B2u) = -0.305470283346919  LUMO (B3g) = -0.0108119392119047
cycle= 39 E= -75.2196533016595  delta_E= 4.83e-13  |g|= 6.29e-12  |ddm|= 2.49e-12
HOMO (B2u) = -0.305470283346686  LUMO (B3g) = -0.0108119392117769
cycle= 40 E= -75.2196533016591  delta_E= 4.12e-13  |g|= 5.67e-12  |ddm|= 2.35e-12
HOMO (B2u) = -0.305470283346459  LUMO (B3g) = -0.0108119392116394
cycle= 41 E= -75.2196533016588  delta_E= 3.84e-13  |g|= 5.05e-12  |ddm|= 2.15e-12
HOMO (B2u) = -0.305470283346234  LUMO (B3g) = -0.0108119392114926
cycle= 42 E= -75.2196533016584  delta_E= 3.84e-13  |g|= 4.57e-12  |ddm|= 1.93e-12
HOMO (B2u) = -0.305470283346019  LUMO (B3g) = -0.0108119392113402
cycle= 43 E= -75.2196533016579  delta_E= 4.41e-13  |g|= 4.2e-12  |ddm|= 1.74e-12
HOMO (B2u) = -0.305470283345817  LUMO (B3g) = -0.0108119392111903
cycle= 44 E= -75.2196533016576  delta_E= 3.69e-13  |g|= 3.93e-12  |ddm|= 1.63e-12
HOMO (B2u) = -0.305470283345625  LUMO (B3g) = -0.0108119392110409
cycle= 45 E= -75.2196533016572  delta_E= 3.55e-13  |g|= 3.74e-12  |ddm|= 1.6e-12
HOMO (B2u) = -0.305470283345446  LUMO (B3g) = -0.0108119392108958
cycle= 46 E= -75.2196533016569  delta_E= 3.13e-13  |g|= 3.56e-12  |ddm|= 1.59e-12
HOMO (B2u) = -0.305470283345279  LUMO (B3g) = -0.010811939210758
cycle= 47 E= -75.2196533016564  delta_E= 4.69e-13  |g|= 3.4e-12  |ddm|= 1.59e-12
HOMO (B2u) = -0.305470283345122  LUMO (B3g) = -0.0108119392106254
cycle= 48 E= -75.2196533016562  delta_E= 2.7e-13  |g|= 3.26e-12  |ddm|= 1.53e-12
HOMO (B2u) = -0.305470283344973  LUMO (B3g) = -0.0108119392104975
cycle= 49 E= -75.2196533016559  delta_E= 2.7e-13  |g|= 3.16e-12  |ddm|= 1.43e-12
HOMO (B2u) = -0.305470283344833  LUMO (B3g) = -0.010811939210374
cycle= 50 E= -75.2196533016556  delta_E= 2.56e-13  |g|= 3.09e-12  |ddm|= 1.43e-12
SCF not converged.
SCF energy = -75.2196533016556

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-ic-mrcisd/tmpthms_3lo
max_memory 4000 MB (current use 8711 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-ic-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-ic-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-ic-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3995087253759  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4185379094409  dE = -0.019029184  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4305812202913  dE = -0.012043311  S^2 = 0.0000000
               |grad[o]|=0.0825  |ddm|= 0.13  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4361629116421  dE = -0.0055816914  S^2 = 0.0000000
               |grad[o]|=0.0449  |ddm|=0.0292  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4375634990385  dE = -0.0014005874  S^2 = 0.0000000
               |grad[o]|=0.0129  |ddm|= 0.09  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4380295769935  dE = -0.00046607795  S^2 = 0.0000000
               |grad[o]|=0.00687  |ddm|=0.0132  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4380962924997  dE = -6.6715506e-05  S^2 = 0.0000000
               |grad[o]|=0.00315  |ddm|=0.00729  |maxRot[o]|=0.0171
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4381038259103  dE = -7.5334106e-06  S^2 = 0.0000000
               |grad[o]|=0.00126  |ddm|=0.00318  |maxRot[o]|=0.00571
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4381046488813  dE = -8.2297102e-07  S^2 = 0.0000000
               |grad[o]|=0.000447  |ddm|=0.00118  |maxRot[o]|=0.00185
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4381047373476  dE = -8.8466265e-08  S^2 = 0.0000000
               |grad[o]|=0.000151  |ddm|=0.000407  |maxRot[o]|=0.0006
macro iter 10 (2 JK  0 micro), CASSCF E = -75.4381047467734  dE = -9.4258326e-09  S^2 = 0.0000000
               |grad[o]|=5.02e-05  |ddm|=0.000136  |maxRot[o]|=0.000195
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4381047477702  dE = -9.9680619e-10  S^2 = 0.0000000
               |grad[o]|=1.66e-05  |ddm|=4.5e-05  |maxRot[o]|=6.33e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4381047478756  dE = -1.0541612e-10  S^2 = 0.0000000
               |grad[o]|=5.39e-06  |ddm|=1.48e-05  |maxRot[o]|=2.05e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4381047478867  dE = -1.1041834e-11  S^2 = 0.0000000
               |grad[o]|=1.79e-06  |ddm|=4.81e-06  |maxRot[o]|=6.74e-06
2-step CASSCF converged in 13 macro (47 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9552256  1.93933509 1.79648698 1.55867496 0.44475737 0.0589722
 0.05365784 0.19288996]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01249   0.01101  -0.00075   0.00000   0.00000
  0 C 2s       0.70304   0.68783  -0.07328   0.00000   0.00000
  0 C 3s       0.00773   0.01395  -0.01813   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 2py     -0.00000   0.00000  -0.00000   0.70477   0.70699
  0 C 2pz      0.07361  -0.16270   0.70188  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3py      0.00000   0.00000  -0.00000   0.05427   0.01126
  0 C 3pz     -0.00668  -0.00182   0.02850   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.01889   0.00635
  0 C 3dz^2    0.00731  -0.00827   0.02845   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 0 C 3dx2-y2   0.00258   0.00545  -0.00616  -0.00000  -0.00000
  1 C 1s       0.01249  -0.01101  -0.00075   0.00000   0.00000
  1 C 2s       0.70304  -0.68783  -0.07328  -0.00000  -0.00000
  1 C 3s       0.00773  -0.01395  -0.01813  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 2py     -0.00000   0.00000   0.00000   0.70477  -0.70699
  1 C 2pz     -0.07361  -0.16270  -0.70188  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3py      0.00000  -0.00000  -0.00000   0.05427  -0.01126
  1 C 3pz      0.00668  -0.00182  -0.02850   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01889   0.00635
  1 C 3dz^2    0.00731   0.00827   0.02845   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 1 C 3dx2-y2   0.00258  -0.00545  -0.00616   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00014
  0 C 2s      -0.00000   0.00000   0.16232
  0 C 3s       0.00000  -0.00000   0.02153
  0 C 2px      0.69477   0.69952  -0.00000
  0 C 2py      0.00000  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.68780
  0 C 3px     -0.07060  -0.02872  -0.00000
  0 C 3py      0.00000   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00644
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00067
  0 C 3dxz    -0.11095  -0.09923  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00851
  1 C 1s       0.00000   0.00000   0.00014
  1 C 2s       0.00000   0.00000  -0.16232
  1 C 3s      -0.00000   0.00000  -0.02153
  1 C 2px      0.69477  -0.69952   0.00000
  1 C 2py      0.00000  -0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68780
  1 C 3px     -0.07060   0.02872   0.00000
  1 C 3py     -0.00000   0.00000   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00644
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00067
  1 C 3dxz     0.11095  -0.09923  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00851
<CAS-nat-orb|mo-hf>  3  3    0.99475641
<CAS-nat-orb|mo-hf>  4  4    0.99950402
<CAS-nat-orb|mo-hf>  5  5    0.99460067
<CAS-nat-orb|mo-hf>  6  6    0.99808720
<CAS-nat-orb|mo-hf>  7  7    0.99017070
<CAS-nat-orb|mo-hf>  8  8    0.93329643
<CAS-nat-orb|mo-hf>  9  9    0.96133983
<CAS-nat-orb|mo-hf>  10  10    0.97346862
CASSCF energy = -75.4381047478867
CASCI E = -75.4381047478867  E(CI) = -14.5778601831497  S^2 = 0.0000000
......production of RDMs took       2.90 sec
......reading the RDM took          0.46 sec
......production of RDMs took      32.59 sec
Reading binary 4RDM from BLOCK

WARN: AT LEAST, NO MORE bytes TO READ!

......reading the RDM took         10.30 sec

diag overlap ref-ref-* size = 1
diag overlap ijrskltu* size = 1296
diag overlap rsiatukp* size = 5184
diag overlap ijrakltp* size = 576
diag overlap rsabtupq* size = 20736
diag overlap ijabklpq* size = 256
diag overlap irabktpq1 size = 4608
diag overlap rabctpqg* size = 9216
diag overlap iabckpqg* size = 1024
HMAT basis size = 31655 thrds = 1e-10
hamil eq (ref-ref-*, ref-ref-*)
hamil eq (ref-ref-*, ijrskltu*)
hamil eq (ref-ref-*, rsiatukp*)
hamil eq (ref-ref-*, ijrakltp*)
hamil eq (ref-ref-*, rsabtupq*)
hamil eq (ref-ref-*, ijabklpq*)
hamil eq (ref-ref-*, irabktpq1)
hamil eq (ref-ref-*, irabktpq2)
hamil eq (ref-ref-*, rabctpqg*)
hamil eq (ref-ref-*, iabckpqg*)
hamil eq (ijrskltu*, ref-ref-*)
hamil eq (ijrskltu*, ijrskltu*)
hamil eq (ijrskltu*, rsiatukp*)
hamil eq (ijrskltu*, ijrakltp*)
hamil eq (ijrskltu*, rsabtupq*)
hamil eq (ijrskltu*, ijabklpq*)
hamil eq (ijrskltu*, irabktpq1)
hamil eq (ijrskltu*, irabktpq2)
hamil eq (ijrskltu*, rabctpqg*)
hamil eq (ijrskltu*, iabckpqg*)
hamil eq (rsiatukp*, ref-ref-*)
hamil eq (rsiatukp*, ijrskltu*)
hamil eq (rsiatukp*, rsiatukp*)
hamil eq (rsiatukp*, ijrakltp*)
hamil eq (rsiatukp*, rsabtupq*)
hamil eq (rsiatukp*, ijabklpq*)
hamil eq (rsiatukp*, irabktpq1)
hamil eq (rsiatukp*, irabktpq2)
hamil eq (rsiatukp*, rabctpqg*)
hamil eq (rsiatukp*, iabckpqg*)
hamil eq (ijrakltp*, ref-ref-*)
hamil eq (ijrakltp*, ijrskltu*)
hamil eq (ijrakltp*, rsiatukp*)
hamil eq (ijrakltp*, ijrakltp*)
hamil eq (ijrakltp*, rsabtupq*)
hamil eq (ijrakltp*, ijabklpq*)
hamil eq (ijrakltp*, irabktpq1)
hamil eq (ijrakltp*, irabktpq2)
hamil eq (ijrakltp*, rabctpqg*)
hamil eq (ijrakltp*, iabckpqg*)
hamil eq (rsabtupq*, ref-ref-*)
hamil eq (rsabtupq*, ijrskltu*)
hamil eq (rsabtupq*, rsiatukp*)
hamil eq (rsabtupq*, ijrakltp*)
hamil eq (rsabtupq*, rsabtupq*)
hamil eq (rsabtupq*, ijabklpq*)
hamil eq (rsabtupq*, irabktpq1)
hamil eq (rsabtupq*, irabktpq2)
hamil eq (rsabtupq*, rabctpqg*)
hamil eq (rsabtupq*, iabckpqg*)
hamil eq (ijabklpq*, ref-ref-*)
hamil eq (ijabklpq*, ijrskltu*)
hamil eq (ijabklpq*, rsiatukp*)
hamil eq (ijabklpq*, ijrakltp*)
hamil eq (ijabklpq*, rsabtupq*)
hamil eq (ijabklpq*, ijabklpq*)
hamil eq (ijabklpq*, irabktpq1)
hamil eq (ijabklpq*, irabktpq2)
hamil eq (ijabklpq*, rabctpqg*)
hamil eq (ijabklpq*, iabckpqg*)
hamil eq (irabktpq1, ref-ref-*)
hamil eq (irabktpq1, ijrskltu*)
hamil eq (irabktpq1, rsiatukp*)
hamil eq (irabktpq1, ijrakltp*)
hamil eq (irabktpq1, rsabtupq*)
hamil eq (irabktpq1, ijabklpq*)
hamil eq (irabktpq1, irabktpq1)
hamil eq (irabktpq1, irabktpq2)
hamil eq (irabktpq1, rabctpqg*)
hamil eq (irabktpq1, iabckpqg*)
hamil eq (irabktpq2, ref-ref-*)
hamil eq (irabktpq2, ijrskltu*)
hamil eq (irabktpq2, rsiatukp*)
hamil eq (irabktpq2, ijrakltp*)
hamil eq (irabktpq2, rsabtupq*)
hamil eq (irabktpq2, ijabklpq*)
hamil eq (irabktpq2, irabktpq1)
hamil eq (irabktpq2, irabktpq2)
hamil eq (irabktpq2, rabctpqg*)
hamil eq (irabktpq2, iabckpqg*)
hamil eq (rabctpqg*, ref-ref-*)
hamil eq (rabctpqg*, ijrskltu*)
hamil eq (rabctpqg*, rsiatukp*)
hamil eq (rabctpqg*, ijrakltp*)
hamil eq (rabctpqg*, rsabtupq*)
hamil eq (rabctpqg*, ijabklpq*)
hamil eq (rabctpqg*, irabktpq1)
hamil eq (rabctpqg*, irabktpq2)
hamil eq (rabctpqg*, rabctpqg*)
hamil eq (rabctpqg*, iabckpqg*)
hamil eq (iabckpqg*, ref-ref-*)
hamil eq (iabckpqg*, ijrskltu*)
hamil eq (iabckpqg*, rsiatukp*)
hamil eq (iabckpqg*, ijrakltp*)
hamil eq (iabckpqg*, rsabtupq*)
hamil eq (iabckpqg*, ijabklpq*)
hamil eq (iabckpqg*, irabktpq1)
hamil eq (iabckpqg*, irabktpq2)
hamil eq (iabckpqg*, rabctpqg*)
hamil eq (iabckpqg*, iabckpqg*)
keys = ['ref-ref-*', 'ijrskltu*', 'rsiatukp*', 'ijrakltp*', 'rsabtupq*', 'ijabklpq*', 'irabktpq1', 'rabctpqg*', 'iabckpqg*']
pre mat (ref-ref-*, ref-ref-*)       0      0 symm error =    0.0000000000
pre mat (ref-ref-*, ijrskltu*)       0      1 symm error =    0.0000000000
pre mat (ref-ref-*, rsiatukp*)       0    667 symm error =    0.0000000000
pre mat (ref-ref-*, ijrakltp*)       0   5851 symm error =    0.0000000000
pre mat (ref-ref-*, rsabtupq*)       0   6427 symm error =    0.0000000000
pre mat (ref-ref-*, ijabklpq*)       0  16867 symm error =    0.0000000000
pre mat (ref-ref-*, irabktpq1)       0  17003 symm error =    0.0000000000
pre mat (ref-ref-*, rabctpqg*)       0  21575 symm error =    0.0000000000
pre mat (ref-ref-*, iabckpqg*)       0  30647 symm error =    0.0000000000
pre mat (ijrskltu*, ref-ref-*)       1      0 symm error =    0.0000000000
pre mat (ijrskltu*, ijrskltu*)       1      1 symm error =    0.0000000000
pre mat (ijrskltu*, rsiatukp*)       1    667 symm error =    0.0000000000
pre mat (ijrskltu*, ijrakltp*)       1   5851 symm error =    0.0000000000
pre mat (ijrskltu*, rsabtupq*)       1   6427 symm error =    0.0000000000
pre mat (ijrskltu*, ijabklpq*)       1  16867 symm error =    0.0000000000
pre mat (ijrskltu*, irabktpq1)       1  17003 symm error =    0.0000000000
pre mat (ijrskltu*, rabctpqg*)       1  21575 symm error =    0.0000000000
pre mat (ijrskltu*, iabckpqg*)       1  30647 symm error =    0.0000000000
pre mat (rsiatukp*, ref-ref-*)     667      0 symm error =    0.0000000000
pre mat (rsiatukp*, ijrskltu*)     667      1 symm error =    0.0000000000
pre mat (rsiatukp*, rsiatukp*)     667    667 symm error =    0.0000025635
pre mat (rsiatukp*, ijrakltp*)     667   5851 symm error =    0.0000000000
pre mat (rsiatukp*, rsabtupq*)     667   6427 symm error =    0.0000000000
pre mat (rsiatukp*, ijabklpq*)     667  16867 symm error =    0.0000000000
pre mat (rsiatukp*, irabktpq1)     667  17003 symm error =    0.0000000000
pre mat (rsiatukp*, rabctpqg*)     667  21575 symm error =    0.0000000000
pre mat (rsiatukp*, iabckpqg*)     667  30647 symm error =    0.0000000000
pre mat (ijrakltp*, ref-ref-*)    5851      0 symm error =    0.0000000000
pre mat (ijrakltp*, ijrskltu*)    5851      1 symm error =    0.0000000000
pre mat (ijrakltp*, rsiatukp*)    5851    667 symm error =    0.0000000000
pre mat (ijrakltp*, ijrakltp*)    5851   5851 symm error =    0.0000006771
pre mat (ijrakltp*, rsabtupq*)    5851   6427 symm error =    0.0000000000
pre mat (ijrakltp*, ijabklpq*)    5851  16867 symm error =    0.0000000000
pre mat (ijrakltp*, irabktpq1)    5851  17003 symm error =    0.0000000000
pre mat (ijrakltp*, rabctpqg*)    5851  21575 symm error =    0.0000000000
pre mat (ijrakltp*, iabckpqg*)    5851  30647 symm error =    0.0000000000
pre mat (rsabtupq*, ref-ref-*)    6427      0 symm error =    0.0000000000
pre mat (rsabtupq*, ijrskltu*)    6427      1 symm error =    0.0000000000
pre mat (rsabtupq*, rsiatukp*)    6427    667 symm error =    0.0000000000
pre mat (rsabtupq*, ijrakltp*)    6427   5851 symm error =    0.0000000000
pre mat (rsabtupq*, rsabtupq*)    6427   6427 symm error =    0.0000803856
pre mat (rsabtupq*, ijabklpq*)    6427  16867 symm error =    0.0000000000
pre mat (rsabtupq*, irabktpq1)    6427  17003 symm error =    0.0000000000
pre mat (rsabtupq*, rabctpqg*)    6427  21575 symm error =    0.0000000000
pre mat (rsabtupq*, iabckpqg*)    6427  30647 symm error =    0.0000000000
pre mat (ijabklpq*, ref-ref-*)   16867      0 symm error =    0.0000000000
pre mat (ijabklpq*, ijrskltu*)   16867      1 symm error =    0.0000000000
pre mat (ijabklpq*, rsiatukp*)   16867    667 symm error =    0.0000000000
pre mat (ijabklpq*, ijrakltp*)   16867   5851 symm error =    0.0000000000
pre mat (ijabklpq*, rsabtupq*)   16867   6427 symm error =    0.0000000000
pre mat (ijabklpq*, ijabklpq*)   16867  16867 symm error =    0.0000088089
pre mat (ijabklpq*, irabktpq1)   16867  17003 symm error =    0.0000000000
pre mat (ijabklpq*, rabctpqg*)   16867  21575 symm error =    0.0000000000
pre mat (ijabklpq*, iabckpqg*)   16867  30647 symm error =    0.0000000000
pre mat (irabktpq1, ref-ref-*)   17003      0 symm error =    0.0000000000
pre mat (irabktpq1, ijrskltu*)   17003      1 symm error =    0.0000000000
pre mat (irabktpq1, rsiatukp*)   17003    667 symm error =    0.0000000000
pre mat (irabktpq1, ijrakltp*)   17003   5851 symm error =    0.0000000000
pre mat (irabktpq1, rsabtupq*)   17003   6427 symm error =    0.0000000000
pre mat (irabktpq1, ijabklpq*)   17003  16867 symm error =    0.0000000000
pre mat (irabktpq1, irabktpq1)   17003  17003 symm error =    0.0000502361
pre mat (irabktpq1, rabctpqg*)   17003  21575 symm error =    0.0000000000
pre mat (irabktpq1, iabckpqg*)   17003  30647 symm error =    0.0000000000
pre mat (rabctpqg*, ref-ref-*)   21575      0 symm error =    0.0000000000
pre mat (rabctpqg*, ijrskltu*)   21575      1 symm error =    0.0000000000
pre mat (rabctpqg*, rsiatukp*)   21575    667 symm error =    0.0000000000
pre mat (rabctpqg*, ijrakltp*)   21575   5851 symm error =    0.0000000000
pre mat (rabctpqg*, rsabtupq*)   21575   6427 symm error =    0.0000000000
pre mat (rabctpqg*, ijabklpq*)   21575  16867 symm error =    0.0000000000
pre mat (rabctpqg*, irabktpq1)   21575  17003 symm error =    0.0000000000
pre mat (rabctpqg*, rabctpqg*)   21575  21575 symm error =    0.0001144162
pre mat (rabctpqg*, iabckpqg*)   21575  30647 symm error =    0.0000000000
pre mat (iabckpqg*, ref-ref-*)   30647      0 symm error =    0.0000000000
pre mat (iabckpqg*, ijrskltu*)   30647      1 symm error =    0.0000000000
pre mat (iabckpqg*, rsiatukp*)   30647    667 symm error =    0.0000000000
pre mat (iabckpqg*, ijrakltp*)   30647   5851 symm error =    0.0000000000
pre mat (iabckpqg*, rsabtupq*)   30647   6427 symm error =    0.0000000000
pre mat (iabckpqg*, ijabklpq*)   30647  16867 symm error =    0.0000000000
pre mat (iabckpqg*, irabktpq1)   30647  17003 symm error =    0.0000000000
pre mat (iabckpqg*, rabctpqg*)   30647  21575 symm error =    0.0000000000
pre mat (iabckpqg*, iabckpqg*)   30647  30647 symm error =    0.0000381387
HMAT symm error =    0.0186499631
E(MRCI) - E(ref) = -0.1173125057128459 DC = -0.006520782345978815
E(WickICMRCISD)   = -75.55541725359953  E_corr_ci = -0.1173125057128459
E(WickICMRCISD+Q) = -75.5619380359455  E_corr_ci = -0.1238332880588247
Time cost =   3128.207
