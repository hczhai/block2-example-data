#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 14:38:18 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.952518979656 AA    0.000000000000   0.000000000000   1.800000000000 Bohr   0.0

nuclear repulsion = 20
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  0.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:         2.60


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpz94d0_j0
max_memory 4000 MB (current use 128 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.1366469280558

WARN: Singularity detected in overlap matrix (condition number = 1.91e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.411563442743742  LUMO (Ag) = -0.232616164544876
cycle= 1 E= -75.1160073846339  delta_E= 1.02  |g|= 0.175  |ddm|= 1.65
HOMO (B1u) = -0.462886704875274  LUMO (Ag) = -0.0990177048643899
cycle= 2 E= -75.1270298311364  delta_E= -0.011  |g|= 0.057  |ddm|= 0.233
HOMO (B1u) = -0.43800078024347  LUMO (Ag) = -0.0789293202815925
cycle= 3 E= -75.1282984729017  delta_E= -0.00127  |g|= 0.0157  |ddm|= 0.191
HOMO (B1u) = -0.440879448397979  LUMO (Ag) = -0.0869420301347693
cycle= 4 E= -75.1284487654917  delta_E= -0.00015  |g|= 0.00222  |ddm|= 0.0862
HOMO (B1u) = -0.441380240119147  LUMO (Ag) = -0.0882782976432009
cycle= 5 E= -75.128452075633  delta_E= -3.31e-06  |g|= 0.000419  |ddm|= 0.0158
HOMO (B1u) = -0.441351661772562  LUMO (Ag) = -0.0881933274529146
cycle= 6 E= -75.1284521927703  delta_E= -1.17e-07  |g|= 2.77e-05  |ddm|= 0.00246
HOMO (B1u) = -0.441354048137814  LUMO (Ag) = -0.0881978149646813
cycle= 7 E= -75.1284521931899  delta_E= -4.2e-10  |g|= 1.77e-06  |ddm|= 0.000613
HOMO (B1u) = -0.441354076509799  LUMO (Ag) = -0.0881971474462646
cycle= 8 E= -75.1284521931909  delta_E= -1.05e-12  |g|= 1.61e-07  |ddm|= 3.45e-05
HOMO (B1u) = -0.441354065704851  LUMO (Ag) = -0.088197192369039
cycle= 9 E= -75.1284521931911  delta_E= -1.28e-13  |g|= 1.18e-08  |ddm|= 1.67e-06
HOMO (B1u) = -0.441354065627295  LUMO (Ag) = -0.0881971880050309
cycle= 10 E= -75.128452193191  delta_E= 1.42e-14  |g|= 5.48e-09  |ddm|= 1.02e-07
HOMO (B1u) = -0.441354065537253  LUMO (Ag) = -0.0881971874491724
cycle= 11 E= -75.128452193191  delta_E= 5.68e-14  |g|= 6.43e-10  |ddm|= 4.11e-08
HOMO (B1u) = -0.441354065565261  LUMO (Ag) = -0.0881971874919244
cycle= 12 E= -75.128452193191  delta_E= -5.68e-14  |g|= 4.42e-10  |ddm|= 2e-09
HOMO (B1u) = -0.441354065556535  LUMO (Ag) = -0.0881971875208377
cycle= 13 E= -75.128452193191  delta_E= 1.42e-14  |g|= 3.69e-10  |ddm|= 7.3e-10
HOMO (B1u) = -0.441354065533065  LUMO (Ag) = -0.0881971874636951
cycle= 14 E= -75.128452193191  delta_E= 5.68e-14  |g|= 3.29e-10  |ddm|= 2.3e-09
HOMO (B1u) = -0.44135406549918  LUMO (Ag) = -0.0881971874068152
cycle= 15 E= -75.1284521931909  delta_E= 4.26e-14  |g|= 4e-10  |ddm|= 4.87e-09
HOMO (B1u) = -0.441354065482259  LUMO (Ag) = -0.0881971874625843
cycle= 16 E= -75.128452193191  delta_E= -4.26e-14  |g|= 4.26e-10  |ddm|= 1.09e-08
HOMO (B1u) = -0.441354065533747  LUMO (Ag) = -0.088197187509444
cycle= 17 E= -75.128452193191  delta_E= -2.84e-14  |g|= 4.37e-10  |ddm|= 6.5e-10
HOMO (B1u) = -0.441354065581834  LUMO (Ag) = -0.0881971875250081
cycle= 18 E= -75.128452193191  delta_E= -2.84e-14  |g|= 1.74e-10  |ddm|= 3.91e-09
HOMO (B1u) = -0.441354065573298  LUMO (Ag) = -0.0881971875101982
cycle= 19 E= -75.1284521931911  delta_E= -4.26e-14  |g|= 6.31e-11  |ddm|= 1.06e-09
HOMO (B1u) = -0.441354065569011  LUMO (Ag) = -0.0881971875057857
cycle= 20 E= -75.1284521931911  delta_E=    0  |g|= 5.36e-11  |ddm|= 5.55e-11
HOMO (B1u) = -0.441354065556397  LUMO (Ag) = -0.0881971874846864
Extra cycle  E= -75.1284521931911  delta_E=    0  |g|= 1.5e-11  |ddm|= 1.15e-10
converged SCF energy = -75.1284521931911

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpz94d0_j0
max_memory 4000 MB (current use 140 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.2773851266806  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.2921612552898  dE = -0.014776129  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3054533418256  dE = -0.013292087  S^2 = 0.0000000
               |grad[o]|=0.122  |ddm|=0.0317  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3171665948287  dE = -0.011713253  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|=0.022  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3257563368096  dE = -0.008589742  S^2 = 0.0000000
               |grad[o]|=0.0806  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3312100882295  dE = -0.0054537514  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.00664  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.3353808805648  dE = -0.0041707923  S^2 = 0.0000000
               |grad[o]|=0.0513  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.3388115062492  dE = -0.0034306257  S^2 = 0.0000000
               |grad[o]|=0.0423  |ddm|=0.00197  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.3416937899073  dE = -0.0028822837  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.00139  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.3441068760523  dE = -0.0024130861  S^2 = 0.0000000
               |grad[o]|=0.0285  |ddm|=0.00119  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.3460868947936  dE = -0.0019800187  S^2 = 0.0000000
               |grad[o]|=0.023  |ddm|=0.00138  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.3476533580266  dE = -0.0015664632  S^2 = 0.0000000
               |grad[o]|=0.0181  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.3488207494816  dE = -0.0011673915  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00222  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.3496021914663  dE = -0.00078144198  S^2 = 0.0000000
               |grad[o]|=0.00962  |ddm|=0.00269  |maxRot[o]|=0.0799
macro iter 14 (6 JK  0 micro), CASSCF E = -75.3500076019287  dE = -0.00040541046  S^2 = 0.0000000
               |grad[o]|=0.00596  |ddm|=0.00323  |maxRot[o]|=0.0799
macro iter 15 (4 JK  0 micro), CASSCF E = -75.3500690559467  dE = -6.1454018e-05  S^2 = 0.0000000
               |grad[o]|=0.00259  |ddm|=0.004  |maxRot[o]|=0.0356
macro iter 16 (3 JK  0 micro), CASSCF E = -75.3500711296791  dE = -2.0737324e-06  S^2 = 0.0000000
               |grad[o]|=0.000771  |ddm|=0.00302  |maxRot[o]|=0.0056
macro iter 17 (3 JK  0 micro), CASSCF E = -75.3500712273194  dE = -9.7640338e-08  S^2 = 0.0000000
               |grad[o]|=0.000204  |ddm|=0.00102  |maxRot[o]|=0.00111
macro iter 18 (3 JK  0 micro), CASSCF E = -75.3500712324681  dE = -5.1486921e-09  S^2 = 0.0000000
               |grad[o]|=5.3e-05  |ddm|=0.000289  |maxRot[o]|=0.000238
macro iter 19 (3 JK  0 micro), CASSCF E = -75.3500712327529  dE = -2.8484237e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=6.97e-05  |maxRot[o]|=5.33e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.3500712327691  dE = -1.612932e-11  S^2 = 0.0000000
               |grad[o]|=3.36e-06  |ddm|=1.72e-05  |maxRot[o]|=1.23e-05
2-step CASSCF converged in 20 macro (102 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99117055 1.9483733  1.94837323 1.38207917 0.61632491 0.05352421
 0.05352413 0.0066305 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00026   0.00000   0.00000   0.00156  -0.00335
  0 C 2s       0.56540   0.00000  -0.00000   0.40871  -0.42139
  0 C 3s      -0.05874   0.00000  -0.00000   0.01072  -0.04347
  0 C 2px     -0.00000  -0.00000   0.70297  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70297  -0.00000  -0.00000  -0.00000
  0 C 2pz      0.41246   0.00000  -0.00000  -0.57668   0.56528
  0 C 3px      0.00000   0.00000  -0.06368  -0.00000   0.00000
  0 C 3py     -0.00000  -0.06368   0.00000  -0.00000  -0.00000
  0 C 3pz     -0.06271   0.00000  -0.00000  -0.01322  -0.02762
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.04218   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.05310   0.00000  -0.00000   0.01011   0.01522
  0 C 3dxz    -0.00000   0.00000   0.04218  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s      -0.00026   0.00000   0.00000  -0.00156  -0.00335
  1 C 2s       0.56540  -0.00000   0.00000  -0.40871  -0.42139
  1 C 3s      -0.05874  -0.00000   0.00000  -0.01072  -0.04347
  1 C 2px      0.00000  -0.00000   0.70297   0.00000  -0.00000
  1 C 2py      0.00000   0.70297  -0.00000   0.00000   0.00000
  1 C 2pz     -0.41246   0.00000   0.00000  -0.57668  -0.56528
  1 C 3px      0.00000  -0.00000  -0.06368   0.00000   0.00000
  1 C 3py      0.00000  -0.06368   0.00000   0.00000   0.00000
  1 C 3pz      0.06271   0.00000  -0.00000  -0.01322   0.02762
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.04218  -0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.05310  -0.00000   0.00000  -0.01011   0.01522
  1 C 3dxz    -0.00000   0.00000  -0.04218  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00117
  0 C 2s      -0.00000   0.00000   0.57006
  0 C 3s      -0.00000   0.00000  -0.05590
  0 C 2px      0.70510  -0.00000  -0.00000
  0 C 2py      0.00000   0.70510   0.00000
  0 C 2pz     -0.00000   0.00000   0.40146
  0 C 3px     -0.04754  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04754   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01218
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02390   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.10289
  0 C 3dxz    -0.02390  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00117
  1 C 2s       0.00000  -0.00000  -0.57006
  1 C 3s       0.00000  -0.00000   0.05590
  1 C 2px     -0.70510   0.00000   0.00000
  1 C 2py      0.00000  -0.70510  -0.00000
  1 C 2pz     -0.00000   0.00000   0.40146
  1 C 3px      0.04754   0.00000   0.00000
  1 C 3py      0.00000   0.04754  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01218
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02390   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.10289
  1 C 3dxz    -0.02390  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99656097
<CAS-nat-orb|mo-hf>  4  4    0.99984847
<CAS-nat-orb|mo-hf>  5  5    0.99984847
<CAS-nat-orb|mo-hf>  6  6    0.99856152
<CAS-nat-orb|mo-hf>  7  7    0.98495368
<CAS-nat-orb|mo-hf>  8  8    0.83784467
<CAS-nat-orb|mo-hf>  8  15   -0.54092854
<CAS-nat-orb|mo-hf>  9  9    0.83784453
<CAS-nat-orb|mo-hf>  9  16   -0.54092872
<CAS-nat-orb|mo-hf>  10  20   -0.80017035
CASSCF energy = -75.3500712327691
CASCI E = -75.3500712327691  E(CI) = -19.5186694186704  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.037
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.041
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.082
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.082
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.082
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.082
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.673
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.534
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      3.614

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.031
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.027
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  57.1 KB SPT = 0.8620 T =      0.647
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.724
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.736
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.726
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.327
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.331
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.550
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.18
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.13
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.09
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.05
 INIT-R <-- Site =    2 ..  Bmem = 56.2 MB Rmem = 5.02 MB T = 0.06
 INIT-R <-- Site =    1 ..  Bmem = 40.1 MB Rmem =  455 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.678 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.304 | Tfpread = 0.000 | Tfpwrite = 0.301 | data = 74.8 MB | cpsd = 56.6 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.867 | E =     -75.4327556764 | DW = 8.95e-06

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.929 | E =     -75.4509873064 | DE = -1.82e-02 | DW = 3.08e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     11.588 | E =     -75.4512053830 | DE = -2.18e-04 | DW = 7.42e-05

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.313 | E =     -75.4515688752 | DE = -3.63e-04 | DW = 3.67e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     13.166 | E =     -75.4515722794 | DE = -3.40e-06 | DW = 7.57e-05

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.859 | E =     -75.4515851596 | DE = -1.29e-05 | DW = 3.83e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.324 | E =     -75.4515756662 | DE = 9.49e-06 | DW = 7.58e-05

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     19.046 | E =     -75.4515898598 | DE = -1.42e-05 | DW = 3.83e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.682 | E =     -75.4520694047 | DE = -4.80e-04 | DW = 5.59e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.773 | E =     -75.4521819936 | DE = -1.13e-04 | DW = 5.08e-06

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.886 | E =     -75.4521985468 | DE = -1.66e-05 | DW = 1.12e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.529 | E =     -75.4522014998 | DE = -2.95e-06 | DW = 5.61e-06

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.823 | E =     -75.4522023622 | DE = -8.62e-07 | DW = 1.14e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     37.609 | E =     -75.4522026979 | DE = -3.36e-07 | DW = 5.65e-06

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     42.247 | E =     -75.4522031697 | DE = -4.72e-07 | DW = 1.14e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     47.146 | E =     -75.4522033991 | DE = -2.29e-07 | DW = 5.66e-06

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.555 | E =     -75.4522811308 | DE = -7.77e-05 | DW = 1.28e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     66.865 | E =     -75.4522976543 | DE = -1.65e-05 | DW = 6.18e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     77.701 | E =     -75.4523009752 | DE = -3.32e-06 | DW = 1.71e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.825 | E =     -75.4523014101 | DE = -4.35e-07 | DW = 6.52e-07

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     98.809 | E =     -75.4523010262 | DE = 3.84e-07 | DW = 1.71e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.158 | E =     -75.4523014073 | DE = -3.81e-07 | DW = 6.51e-07

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    120.485 | E =     -75.4523010179 | DE = 3.89e-07 | DW = 1.71e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    131.921 | E =     -75.4523014142 | DE = -3.96e-07 | DW = 6.52e-07

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    152.551 | E =     -75.4523077966 | DE = -6.38e-06 | DW = 1.35e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    179.091 | E =     -75.4523082022 | DE = -4.06e-07 | DW = 4.67e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    204.218 | E =     -75.4523083120 | DE = -1.10e-07 | DW = 1.35e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    230.239 | E =     -75.4523082444 | DE = 6.77e-08 | DW = 4.38e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    254.155 | E =     -75.4523082828 | DE = -3.84e-08 | DW = 1.32e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    280.196 | E =     -75.4523082236 | DE = 5.92e-08 | DW = 4.28e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    306.042 | E =     -75.4523082772 | DE = -5.36e-08 | DW = 1.31e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    334.171 | E =     -75.4523082190 | DE = 5.82e-08 | DW = 4.27e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    377.855 | E =     -75.4523085932 | DE = -3.74e-07 | DW = 2.00e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    408.986 | E =     -75.4523085931 | DE = 2.41e-11 | DW = 2.00e-08

E(MRCI) = -75.45230859314012  E_corr = -0.1022373603710491
Time cost =    629.941
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 14:48:48 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   0.978977840202 AA    0.000000000000   0.000000000000   1.850000000000 Bohr   0.0

nuclear repulsion = 19.4594594594595
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:      7916.56


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp63vbknwi
max_memory 4000 MB (current use 5097 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.0853308429702

WARN: Singularity detected in overlap matrix (condition number = 1.7e+03). SCF may be inaccurate and hard to converge.

HOMO (B1u) = -0.413580977369314  LUMO (Ag) = -0.227598981995077
cycle= 1 E= -75.172693617241  delta_E= 0.913  |g|= 0.173  |ddm|= 1.63
HOMO (B1u) = -0.471112350140236  LUMO (Ag) = -0.104670423689865
cycle= 2 E= -75.1835008238031  delta_E= -0.0108  |g|= 0.0557  |ddm|= 0.215
HOMO (B1u) = -0.445209609873391  LUMO (Ag) = -0.0826198965911246
cycle= 3 E= -75.1846477232622  delta_E= -0.00115  |g|= 0.0156  |ddm|= 0.166
HOMO (B1u) = -0.447439744130488  LUMO (Ag) = -0.0899048584713121
cycle= 4 E= -75.1847993820882  delta_E= -0.000152  |g|= 0.00222  |ddm|= 0.0841
HOMO (B1u) = -0.447984981890543  LUMO (Ag) = -0.0913127106239855
cycle= 5 E= -75.1848027365253  delta_E= -3.35e-06  |g|= 0.00041  |ddm|= 0.016
HOMO (B1u) = -0.447956467884101  LUMO (Ag) = -0.0912347091259185
cycle= 6 E= -75.18480284832  delta_E= -1.12e-07  |g|= 2.74e-05  |ddm|= 0.00219
HOMO (B1u) = -0.447959917478171  LUMO (Ag) = -0.0912398214370498
cycle= 7 E= -75.184802848724  delta_E= -4.04e-10  |g|= 1.64e-06  |ddm|= 0.00057
HOMO (B1u) = -0.447959903825145  LUMO (Ag) = -0.091239251118185
cycle= 8 E= -75.184802848725  delta_E= -9.38e-13  |g|= 1.46e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.447959899406515  LUMO (Ag) = -0.0912392910101838
cycle= 9 E= -75.184802848725  delta_E=    0  |g|= 1.12e-08  |ddm|= 1.31e-06
HOMO (B1u) = -0.447959898995552  LUMO (Ag) = -0.0912392858238231
cycle= 10 E= -75.184802848725  delta_E=    0  |g|= 5.77e-09  |ddm|= 8.36e-08
HOMO (B1u) = -0.44795989906096  LUMO (Ag) = -0.0912392856583272
cycle= 11 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 6.42e-10  |ddm|= 4.21e-08
HOMO (B1u) = -0.447959899110057  LUMO (Ag) = -0.091239285722377
cycle= 12 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 4.38e-10  |ddm|= 1.82e-09
HOMO (B1u) = -0.447959899095924  LUMO (Ag) = -0.0912392857451299
cycle= 13 E= -75.1848028487249  delta_E= -2.84e-14  |g|= 3.45e-10  |ddm|= 8.36e-10
HOMO (B1u) = -0.447959899057595  LUMO (Ag) = -0.0912392856766914
cycle= 14 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 3.4e-10  |ddm|= 1.68e-09
HOMO (B1u) = -0.447959899024746  LUMO (Ag) = -0.0912392856285203
cycle= 15 E= -75.1848028487248  delta_E= 5.68e-14  |g|= 3.87e-10  |ddm|= 4.34e-09
HOMO (B1u) = -0.447959899030258  LUMO (Ag) = -0.0912392857009416
cycle= 16 E= -75.1848028487249  delta_E= -8.53e-14  |g|= 4.3e-10  |ddm|= 9.23e-09
HOMO (B1u) = -0.447959899080265  LUMO (Ag) = -0.0912392857450303
cycle= 17 E= -75.184802848725  delta_E= -8.53e-14  |g|= 4.45e-10  |ddm|= 4.6e-10
HOMO (B1u) = -0.447959899143794  LUMO (Ag) = -0.0912392857743575
cycle= 18 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 2.02e-10  |ddm|= 3.46e-09
HOMO (B1u) = -0.447959899126029  LUMO (Ag) = -0.0912392857536385
cycle= 19 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 6.75e-11  |ddm|= 1.02e-09
HOMO (B1u) = -0.447959899121224  LUMO (Ag) = -0.0912392857486653
cycle= 20 E= -75.184802848725  delta_E= -5.68e-14  |g|= 5.56e-11  |ddm|= 5.82e-11
HOMO (B1u) = -0.447959899118643  LUMO (Ag) = -0.0912392857462666
cycle= 21 E= -75.1848028487249  delta_E= 2.84e-14  |g|= 4.9e-11  |ddm|= 2.34e-11
HOMO (B1u) = -0.447959899117639  LUMO (Ag) = -0.0912392857438109
cycle= 22 E= -75.184802848725  delta_E= -2.84e-14  |g|= 4.44e-11  |ddm|= 2.15e-11
HOMO (B1u) = -0.447959899116703  LUMO (Ag) = -0.0912392857428609
cycle= 23 E= -75.1848028487249  delta_E= 5.68e-14  |g|= 4.45e-11  |ddm|= 1.44e-11
HOMO (B1u) = -0.447959899113543  LUMO (Ag) = -0.0912392857391212
cycle= 24 E= -75.1848028487249  delta_E= -2.84e-14  |g|= 4.02e-11  |ddm|= 1.48e-10
HOMO (B1u) = -0.44795989911023  LUMO (Ag) = -0.0912392857319351
cycle= 25 E= -75.184802848725  delta_E= -5.68e-14  |g|= 2.82e-11  |ddm|= 1.15e-10
HOMO (B1u) = -0.447959899107716  LUMO (Ag) = -0.0912392857264658
cycle= 26 E= -75.1848028487249  delta_E= 8.53e-14  |g|= 1.6e-11  |ddm|= 1.21e-10
HOMO (B1u) = -0.447959899107811  LUMO (Ag) = -0.0912392857264965
cycle= 27 E= -75.184802848725  delta_E= -8.53e-14  |g|= 1.16e-11  |ddm|= 2.43e-11
HOMO (B1u) = -0.447959899108249  LUMO (Ag) = -0.0912392857268309
cycle= 28 E= -75.1848028487247  delta_E= 2.56e-13  |g|= 1.11e-11  |ddm|= 3.31e-12
HOMO (B1u) = -0.447959899108597  LUMO (Ag) = -0.0912392857270317
cycle= 29 E= -75.1848028487247  delta_E= 5.68e-14  |g|= 9.9e-12  |ddm|= 3.75e-12
HOMO (B1u) = -0.44795989910891  LUMO (Ag) = -0.091239285727149
cycle= 30 E= -75.1848028487246  delta_E= 2.84e-14  |g|= 8.46e-12  |ddm|= 4.79e-12
HOMO (B1u) = -0.447959899109165  LUMO (Ag) = -0.0912392857272425
cycle= 31 E= -75.1848028487246  delta_E=    0  |g|= 7.34e-12  |ddm|= 4.52e-12
HOMO (B1u) = -0.447959899109233  LUMO (Ag) = -0.0912392857265857
Extra cycle  E= -75.1848028487246  delta_E= 5.68e-14  |g|= 2.65e-12  |ddm|= 2.01e-11
converged SCF energy = -75.1848028487246

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp63vbknwi
max_memory 4000 MB (current use 5097 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.335087523525  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3504581939654  dE = -0.01537067  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.3642128300736  dE = -0.013754636  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0333  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.3762420195611  dE = -0.012029189  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|=0.0229  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.3841411858192  dE = -0.0078991663  S^2 = 0.0000000
               |grad[o]|=0.0783  |ddm|=0.014  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.3894311159847  dE = -0.0052899302  S^2 = 0.0000000
               |grad[o]|=0.0619  |ddm|=0.00584  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.393575577825  dE = -0.0041444618  S^2 = 0.0000000
               |grad[o]|=0.0506  |ddm|=0.0029  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.397021581142  dE = -0.0034460033  S^2 = 0.0000000
               |grad[o]|=0.0417  |ddm|=0.00186  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.399926173121  dE = -0.002904592  S^2 = 0.0000000
               |grad[o]|=0.0343  |ddm|=0.00135  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4023539081255  dE = -0.002427735  S^2 = 0.0000000
               |grad[o]|=0.0279  |ddm|=0.00128  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4043305996982  dE = -0.0019766916  S^2 = 0.0000000
               |grad[o]|=0.0223  |ddm|=0.00152  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4058701161474  dE = -0.0015395164  S^2 = 0.0000000
               |grad[o]|=0.0173  |ddm|=0.00192  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4069826589885  dE = -0.0011125428  S^2 = 0.0000000
               |grad[o]|=0.0127  |ddm|=0.00237  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.407677832732  dE = -0.00069517374  S^2 = 0.0000000
               |grad[o]|=0.00858  |ddm|=0.00283  |maxRot[o]|=0.0799
macro iter 14 (5 JK  0 micro), CASSCF E = -75.4079300388895  dE = -0.00025220616  S^2 = 0.0000000
               |grad[o]|=0.00477  |ddm|=0.00337  |maxRot[o]|=0.0599
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4079624068773  dE = -3.2367988e-05  S^2 = 0.0000000
               |grad[o]|=0.002  |ddm|=0.00329  |maxRot[o]|= 0.02
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4079663328239  dE = -3.9259465e-06  S^2 = 0.0000000
               |grad[o]|=0.00083  |ddm|=0.00182  |maxRot[o]|=0.00728
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4079664730897  dE = -1.4026581e-07  S^2 = 0.0000000
               |grad[o]|=0.000219  |ddm|=0.00106  |maxRot[o]|=0.00138
macro iter 18 (4 JK  0 micro), CASSCF E = -75.4079664804424  dE = -7.3527104e-09  S^2 = 0.0000000
               |grad[o]|=5.52e-05  |ddm|=0.000309  |maxRot[o]|=0.000271
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4079664808342  dE = -3.9182169e-10  S^2 = 0.0000000
               |grad[o]|=1.56e-05  |ddm|=7.16e-05  |maxRot[o]|=6.22e-05
macro iter 20 (3 JK  0 micro), CASSCF E = -75.4079664808546  dE = -2.0349944e-11  S^2 = 0.0000000
               |grad[o]|=3.76e-06  |ddm|=2.11e-05  |maxRot[o]|=1.17e-05
2-step CASSCF converged in 20 macro (102 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99071501 1.94427801 1.94427781 1.40690827 0.59110117 0.05781825
 0.05781802 0.00708346]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s      -0.00011   0.00000   0.00000   0.00165  -0.00303
  0 C 2s       0.56693  -0.00000   0.00000   0.41981  -0.41934
  0 C 3s      -0.05883   0.00000   0.00000   0.01056  -0.04125
  0 C 2px      0.00000  -0.00000   0.70357  -0.00000  -0.00000
  0 C 2py      0.00000   0.70357  -0.00000   0.00000   0.00000
  0 C 2pz      0.41060   0.00000   0.00000  -0.56869   0.56692
  0 C 3px      0.00000  -0.00000  -0.05731  -0.00000  -0.00000
  0 C 3py      0.00000  -0.05731  -0.00000  -0.00000   0.00000
  0 C 3pz     -0.06180   0.00000   0.00000  -0.01234  -0.02899
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.04122  -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.05218   0.00000   0.00000   0.00930   0.01419
  0 C 3dxz     0.00000  -0.00000   0.04122  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
  1 C 1s      -0.00011   0.00000   0.00000  -0.00165  -0.00303
  1 C 2s       0.56693  -0.00000  -0.00000  -0.41981  -0.41934
  1 C 3s      -0.05883  -0.00000  -0.00000  -0.01056  -0.04125
  1 C 2px     -0.00000  -0.00000   0.70357   0.00000   0.00000
  1 C 2py     -0.00000   0.70357   0.00000   0.00000  -0.00000
  1 C 2pz     -0.41060  -0.00000   0.00000  -0.56869  -0.56692
  1 C 3px     -0.00000   0.00000  -0.05731   0.00000   0.00000
  1 C 3py     -0.00000  -0.05731   0.00000   0.00000  -0.00000
  1 C 3pz      0.06180   0.00000   0.00000  -0.01234   0.02899
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.04122  -0.00000  -0.00000   0.00000
  1 C 3dz^2    0.05218   0.00000  -0.00000  -0.00930   0.01419
  1 C 3dxz     0.00000  -0.00000  -0.04122  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00113
  0 C 2s       0.00000  -0.00000   0.56365
  0 C 3s       0.00000  -0.00000  -0.05372
  0 C 2px      0.70531   0.00000   0.00000
  0 C 2py      0.00000   0.70531   0.00000
  0 C 2pz      0.00000   0.00000   0.41389
  0 C 3px     -0.04437   0.00000   0.00000
  0 C 3py      0.00000  -0.04437   0.00000
  0 C 3pz      0.00000  -0.00000  -0.01152
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02384   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.08932
  0 C 3dxz    -0.02384   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00113
  1 C 2s      -0.00000  -0.00000  -0.56365
  1 C 3s      -0.00000   0.00000   0.05372
  1 C 2px     -0.70531  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70531  -0.00000
  1 C 2pz      0.00000  -0.00000   0.41389
  1 C 3px      0.04437  -0.00000  -0.00000
  1 C 3py     -0.00000   0.04437  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.01152
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02384   0.00000
  1 C 3dz^2   -0.00000   0.00000   0.08932
  1 C 3dxz    -0.02384   0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99647821
<CAS-nat-orb|mo-hf>  4  4    0.99985488
<CAS-nat-orb|mo-hf>  5  5    0.99985488
<CAS-nat-orb|mo-hf>  6  6    0.99860560
<CAS-nat-orb|mo-hf>  7  7    0.98449184
<CAS-nat-orb|mo-hf>  8  8    0.85083709
<CAS-nat-orb|mo-hf>  8  15   -0.52116379
<CAS-nat-orb|mo-hf>  9  9    0.85083680
<CAS-nat-orb|mo-hf>  9  16   -0.52116422
<CAS-nat-orb|mo-hf>  10  20   -0.78474255
CASSCF energy = -75.4079664808546
CASCI E = -75.4079664808546  E(CI) = -19.3366966480993  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.001
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.010

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  57.0 KB SPT = 0.8623 T =      0.065
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8631 T =      0.015
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.011
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.014
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.115
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.10
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 56.2 MB Rmem = 5.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 40.1 MB Rmem =  455 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.319 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.184 | Tfpread = 0.000 | Tfpwrite = 0.175 | data = 74.8 MB | cpsd = 56.6 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.465 | E =     -75.4906297296 | DW = 9.49e-06

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.612 | E =     -75.5092305264 | DE = -1.86e-02 | DW = 3.33e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.517 | E =     -75.5094614424 | DE = -2.31e-04 | DW = 7.81e-05

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.314 | E =     -75.5098332996 | DE = -3.72e-04 | DW = 3.92e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.108 | E =     -75.5098433382 | DE = -1.00e-05 | DW = 7.91e-05

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.945 | E =     -75.5098441826 | DE = -8.44e-07 | DW = 3.91e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.769 | E =     -75.5098489901 | DE = -4.81e-06 | DW = 7.91e-05

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.638 | E =     -75.5098493623 | DE = -3.72e-07 | DW = 3.93e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.355 | E =     -75.5103602636 | DE = -5.11e-04 | DW = 5.97e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     12.295 | E =     -75.5104784276 | DE = -1.18e-04 | DW = 5.56e-06

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.742 | E =     -75.5104967119 | DE = -1.83e-05 | DW = 1.20e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     17.704 | E =     -75.5104988373 | DE = -2.13e-06 | DW = 6.09e-06

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.492 | E =     -75.5105010719 | DE = -2.23e-06 | DW = 1.21e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.424 | E =     -75.5105012167 | DE = -1.45e-07 | DW = 6.12e-06

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     25.883 | E =     -75.5105027574 | DE = -1.54e-06 | DW = 1.22e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     28.566 | E =     -75.5105028159 | DE = -5.85e-08 | DW = 6.20e-06

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.676 | E =     -75.5105826340 | DE = -7.98e-05 | DW = 1.34e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     47.925 | E =     -75.5105996414 | DE = -1.70e-05 | DW = 6.55e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     59.613 | E =     -75.5106031635 | DE = -3.52e-06 | DW = 1.80e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     72.539 | E =     -75.5106036191 | DE = -4.56e-07 | DW = 6.95e-07

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     84.013 | E =     -75.5106032683 | DE = 3.51e-07 | DW = 1.80e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     96.478 | E =     -75.5106036824 | DE = -4.14e-07 | DW = 6.95e-07

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    105.187 | E =     -75.5106032642 | DE = 4.18e-07 | DW = 1.80e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    117.761 | E =     -75.5106036872 | DE = -4.23e-07 | DW = 6.94e-07

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    140.376 | E =     -75.5106102368 | DE = -6.55e-06 | DW = 1.41e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    171.595 | E =     -75.5106106964 | DE = -4.60e-07 | DW = 4.98e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    208.251 | E =     -75.5106108058 | DE = -1.09e-07 | DW = 1.40e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    238.043 | E =     -75.5106107354 | DE = 7.04e-08 | DW = 4.62e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    298.308 | E =     -75.5106107661 | DE = -3.07e-08 | DW = 1.37e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    332.738 | E =     -75.5106107050 | DE = 6.10e-08 | DW = 4.50e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    357.216 | E =     -75.5106107627 | DE = -5.76e-08 | DW = 1.37e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    388.544 | E =     -75.5106107025 | DE = 6.02e-08 | DW = 4.49e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    442.383 | E =     -75.5106111014 | DE = -3.99e-07 | DW = 2.16e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    476.290 | E =     -75.5106111013 | DE = 3.41e-11 | DW = 2.16e-08

E(MRCI) = -75.51061110133267  E_corr = -0.1026446204780882
Time cost =    565.845
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 14:58:13 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.005436700748 AA    0.000000000000   0.000000000000   1.900000000000 Bohr   0.0

nuclear repulsion = 18.9473684210526
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   0.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     16151.23


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp5di4kwin
max_memory 4000 MB (current use 5094 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -76.031041178399

WARN: Singularity detected in overlap matrix (condition number = 1.52e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.394985537155228  LUMO (Ag) = -0.222680456230754
cycle= 1 E= -75.2198455234798  delta_E= 0.811  |g|= 0.173  |ddm|= 1.61
HOMO (B1u) = -0.479415237903266  LUMO (Ag) = -0.109973136342065
cycle= 2 E= -75.2305447304664  delta_E= -0.0107  |g|= 0.0546  |ddm|= 0.201
HOMO (B1u) = -0.452535964635348  LUMO (Ag) = -0.0860888408725848
cycle= 3 E= -75.23159022107  delta_E= -0.00105  |g|= 0.0153  |ddm|= 0.145
HOMO (B1u) = -0.454103263824992  LUMO (Ag) = -0.0925462170063942
cycle= 4 E= -75.2317373690304  delta_E= -0.000147  |g|= 0.00222  |ddm|= 0.0805
HOMO (B1u) = -0.454675048897529  LUMO (Ag) = -0.09400587319759
cycle= 5 E= -75.2317407777115  delta_E= -3.41e-06  |g|= 0.0004  |ddm|= 0.0162
HOMO (B1u) = -0.45464663574983  LUMO (Ag) = -0.0939357427361181
cycle= 6 E= -75.231740884219  delta_E= -1.07e-07  |g|= 2.7e-05  |ddm|= 0.00191
HOMO (B1u) = -0.454651041484011  LUMO (Ag) = -0.0939413575689314
cycle= 7 E= -75.2317408846097  delta_E= -3.91e-10  |g|= 1.59e-06  |ddm|= 0.000529
HOMO (B1u) = -0.454650997156081  LUMO (Ag) = -0.0939408954912678
cycle= 8 E= -75.2317408846106  delta_E= -9.66e-13  |g|= 1.33e-07  |ddm|= 2.94e-05
HOMO (B1u) = -0.454650997886298  LUMO (Ag) = -0.0939409273864949
cycle= 9 E= -75.2317408846106  delta_E= 2.84e-14  |g|= 9.79e-09  |ddm|= 1.1e-06
HOMO (B1u) = -0.454650996884574  LUMO (Ag) = -0.0939409222283057
cycle= 10 E= -75.2317408846106  delta_E= 2.84e-14  |g|= 6.08e-09  |ddm|= 5.23e-08
HOMO (B1u) = -0.454650997076415  LUMO (Ag) = -0.093940922402734
cycle= 11 E= -75.2317408846106  delta_E= -2.84e-14  |g|= 6.37e-10  |ddm|= 4.13e-08
HOMO (B1u) = -0.454650997071842  LUMO (Ag) = -0.0939409223769582
cycle= 12 E= -75.2317408846106  delta_E=    0  |g|= 4.28e-10  |ddm|= 1.29e-09
HOMO (B1u) = -0.454650997117846  LUMO (Ag) = -0.0939409225016658
cycle= 13 E= -75.2317408846107  delta_E= -5.68e-14  |g|= 3.36e-10  |ddm|= 9.49e-10
HOMO (B1u) = -0.454650997077016  LUMO (Ag) = -0.0939409224367675
cycle= 14 E= -75.2317408846107  delta_E=    0  |g|= 3.39e-10  |ddm|= 7.14e-10
HOMO (B1u) = -0.454650997041849  LUMO (Ag) = -0.0939409223983254
cycle= 15 E= -75.2317408846107  delta_E= 1.42e-14  |g|= 3.66e-10  |ddm|= 3.37e-09
HOMO (B1u) = -0.454650997062124  LUMO (Ag) = -0.0939409224617964
cycle= 16 E= -75.2317408846107  delta_E= -4.26e-14  |g|= 3.85e-10  |ddm|= 5.53e-09
HOMO (B1u) = -0.454650997122843  LUMO (Ag) = -0.0939409225143688
cycle= 17 E= -75.2317408846106  delta_E= 8.53e-14  |g|= 4.28e-10  |ddm|= 7.07e-10
HOMO (B1u) = -0.454650997189805  LUMO (Ag) = -0.0939409225485738
cycle= 18 E= -75.2317408846106  delta_E= 1.42e-14  |g|= 2.28e-10  |ddm|= 2.6e-09
HOMO (B1u) = -0.454650997163367  LUMO (Ag) = -0.0939409225221581
cycle= 19 E= -75.2317408846107  delta_E= -9.95e-14  |g|= 7.15e-11  |ddm|= 9.44e-10
HOMO (B1u) = -0.454650997158146  LUMO (Ag) = -0.0939409225166855
cycle= 20 E= -75.2317408846107  delta_E=    0  |g|= 5.79e-11  |ddm|= 6.16e-11
HOMO (B1u) = -0.454650997140898  LUMO (Ag) = -0.0939409224899472
Extra cycle  E= -75.2317408846106  delta_E= 5.68e-14  |g|= 1.47e-11  |ddm|= 2.44e-10
converged SCF energy = -75.2317408846106

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp5di4kwin
max_memory 4000 MB (current use 5094 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3834026666715  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.3993783188574  dE = -0.015975652  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.413581288193  dE = -0.014202969  S^2 = 0.0000000
               |grad[o]|=0.121  |ddm|=0.0352  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4257653436683  dE = -0.012184055  S^2 = 0.0000000
               |grad[o]|=0.0987  |ddm|=0.0239  |maxRot[o]|=0.0788
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4331103247086  dE = -0.007344981  S^2 = 0.0000000
               |grad[o]|=0.0761  |ddm|=0.0138  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4382667661345  dE = -0.0051564414  S^2 = 0.0000000
               |grad[o]|=0.0608  |ddm|=0.00523  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4423939869121  dE = -0.0041272208  S^2 = 0.0000000
               |grad[o]|=0.0498  |ddm|=0.00271  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4458545729835  dE = -0.0034605861  S^2 = 0.0000000
               |grad[o]|=0.041  |ddm|=0.00177  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4487750462321  dE = -0.0029204732  S^2 = 0.0000000
               |grad[o]|=0.0336  |ddm|=0.00136  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4512043521472  dE = -0.0024293059  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.0014  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4531589133663  dE = -0.0019545612  S^2 = 0.0000000
               |grad[o]|=0.0215  |ddm|=0.0017  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4546463623763  dE = -0.001487449  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.455672818517  dE = -0.0010264561  S^2 = 0.0000000
               |grad[o]|=0.0116  |ddm|=0.00257  |maxRot[o]|=0.0799
macro iter 13 (6 JK  0 micro), CASSCF E = -75.4562435543183  dE = -0.0005707358  S^2 = 0.0000000
               |grad[o]|=0.00729  |ddm|=0.00301  |maxRot[o]|=0.0799
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4563596908065  dE = -0.00011613649  S^2 = 0.0000000
               |grad[o]|=0.00332  |ddm|=0.00358  |maxRot[o]|= 0.04
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4563704186208  dE = -1.0727814e-05  S^2 = 0.0000000
               |grad[o]|=0.00122  |ddm|=0.00264  |maxRot[o]|=0.012
macro iter 16 (3 JK  0 micro), CASSCF E = -75.45637074665  dE = -3.2802913e-07  S^2 = 0.0000000
               |grad[o]|=0.000319  |ddm|=0.00144  |maxRot[o]|=0.00212
macro iter 17 (3 JK  0 micro), CASSCF E = -75.4563707606426  dE = -1.3992604e-08  S^2 = 0.0000000
               |grad[o]|=7.89e-05  |ddm|=0.000437  |maxRot[o]|=0.000387
macro iter 18 (4 JK  0 micro), CASSCF E = -75.4563707619016  dE = -1.2589823e-09  S^2 = 0.0000000
               |grad[o]|=2.14e-05  |ddm|=0.000102  |maxRot[o]|=9.72e-05
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4563707619389  dE = -3.7331915e-11  S^2 = 0.0000000
               |grad[o]|=7.14e-06  |ddm|=2.91e-05  |maxRot[o]|=1.3e-05
2-step CASSCF converged in 19 macro (98 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.99022074 1.93998141 1.93998132 1.43110603 0.56650905 0.06231576
 0.06231569 0.00757   ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00012   0.00000   0.00000   0.00176  -0.00276
  0 C 2s       0.56879   0.00000   0.00000   0.43063  -0.41683
  0 C 3s      -0.05868   0.00000   0.00000   0.01038  -0.03881
  0 C 2px     -0.00000   0.00000   0.70409  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70409   0.00000   0.00000   0.00000
  0 C 2pz      0.40833   0.00000   0.00000  -0.56057   0.56889
  0 C 3px     -0.00000   0.00000  -0.05130  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.05130  -0.00000   0.00000  -0.00000
  0 C 3pz     -0.06076   0.00000  -0.00000  -0.01148  -0.03034
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.04026  -0.00000   0.00000  -0.00000
  0 C 3dz^2    0.05111   0.00000   0.00000   0.00848   0.01325
  0 C 3dxz    -0.00000   0.00000   0.04026  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 1s       0.00012   0.00000   0.00000  -0.00176  -0.00276
  1 C 2s       0.56879  -0.00000  -0.00000  -0.43063  -0.41683
  1 C 3s      -0.05868  -0.00000  -0.00000  -0.01038  -0.03881
  1 C 2px      0.00000  -0.00000   0.70409   0.00000   0.00000
  1 C 2py      0.00000   0.70409   0.00000   0.00000   0.00000
  1 C 2pz     -0.40833  -0.00000   0.00000  -0.56057  -0.56889
  1 C 3px      0.00000  -0.00000  -0.05130   0.00000   0.00000
  1 C 3py      0.00000  -0.05130   0.00000  -0.00000   0.00000
  1 C 3pz      0.06076   0.00000   0.00000  -0.01148   0.03034
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.04026  -0.00000   0.00000  -0.00000
  1 C 3dz^2    0.05111  -0.00000  -0.00000  -0.00848   0.01325
  1 C 3dxz    -0.00000   0.00000  -0.04026  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00109
  0 C 2s       0.00000   0.00000   0.55672
  0 C 3s      -0.00000   0.00000  -0.05173
  0 C 2px      0.70549  -0.00000   0.00000
  0 C 2py      0.00000   0.70549   0.00000
  0 C 2pz      0.00000  -0.00000   0.42574
  0 C 3px     -0.04149  -0.00000   0.00000
  0 C 3py     -0.00000  -0.04149   0.00000
  0 C 3pz     -0.00000   0.00000  -0.01023
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02382   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.07763
  0 C 3dxz    -0.02382  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00109
  1 C 2s      -0.00000  -0.00000  -0.55672
  1 C 3s       0.00000  -0.00000   0.05173
  1 C 2px     -0.70549  -0.00000  -0.00000
  1 C 2py      0.00000  -0.70549   0.00000
  1 C 2pz      0.00000   0.00000   0.42574
  1 C 3px      0.04149   0.00000  -0.00000
  1 C 3py     -0.00000   0.04149  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01023
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.07763
  1 C 3dxz    -0.02382  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99637510
<CAS-nat-orb|mo-hf>  4  4    0.99985872
<CAS-nat-orb|mo-hf>  5  5    0.99985872
<CAS-nat-orb|mo-hf>  6  6    0.99864217
<CAS-nat-orb|mo-hf>  7  7    0.98400076
<CAS-nat-orb|mo-hf>  8  8    0.86287914
<CAS-nat-orb|mo-hf>  8  15   -0.50178788
<CAS-nat-orb|mo-hf>  9  9    0.86287908
<CAS-nat-orb|mo-hf>  9  16   -0.50178797
<CAS-nat-orb|mo-hf>  10  20   -0.76833495
CASSCF energy = -75.4563707619389
CASCI E = -75.4563707619389  E(CI) = -19.1577865225828  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.030
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.040
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.040
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.336
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.094
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.654

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.029
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.8 KB SPT = 0.8628 T =      0.629
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.724
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.727
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.732
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.322
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.326
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.525
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.12
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.13
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.10
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.05
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 56.2 MB Rmem = 5.02 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 40.1 MB Rmem =  455 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.610 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.329 | Tfpread = 0.000 | Tfpwrite = 0.328 | data = 74.8 MB | cpsd = 56.6 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.451 | E =     -75.5387474634 | DW = 1.02e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     13.130 | E =     -75.5579610118 | DE = -1.92e-02 | DW = 3.60e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     16.109 | E =     -75.5582214032 | DE = -2.60e-04 | DW = 8.09e-05

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.885 | E =     -75.5586013566 | DE = -3.80e-04 | DW = 4.43e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.636 | E =     -75.5586048190 | DE = -3.46e-06 | DW = 7.79e-05

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     24.426 | E =     -75.5586100283 | DE = -5.21e-06 | DW = 4.30e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     27.215 | E =     -75.5586062698 | DE = 3.76e-06 | DW = 7.58e-05

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     29.960 | E =     -75.5586094153 | DE = -3.15e-06 | DW = 4.33e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.518 | E =     -75.5591449101 | DE = -5.35e-04 | DW = 6.44e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.300 | E =     -75.5592691382 | DE = -1.24e-04 | DW = 6.16e-06

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.685 | E =     -75.5592842511 | DE = -1.51e-05 | DW = 1.29e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     48.394 | E =     -75.5592867993 | DE = -2.55e-06 | DW = 6.72e-06

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.876 | E =     -75.5592886391 | DE = -1.84e-06 | DW = 1.30e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.508 | E =     -75.5592888194 | DE = -1.80e-07 | DW = 6.76e-06

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     58.492 | E =     -75.5592905049 | DE = -1.69e-06 | DW = 1.31e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     62.095 | E =     -75.5592904774 | DE = 2.76e-08 | DW = 6.79e-06

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     69.043 | E =     -75.5593746440 | DE = -8.42e-05 | DW = 1.41e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     80.360 | E =     -75.5593923346 | DE = -1.77e-05 | DW = 6.99e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     90.825 | E =     -75.5593959243 | DE = -3.59e-06 | DW = 1.89e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    102.182 | E =     -75.5593964095 | DE = -4.85e-07 | DW = 7.38e-07

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.833 | E =     -75.5593959964 | DE = 4.13e-07 | DW = 1.89e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    123.804 | E =     -75.5593964439 | DE = -4.48e-07 | DW = 7.35e-07

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    134.101 | E =     -75.5593959419 | DE = 5.02e-07 | DW = 1.88e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    145.531 | E =     -75.5593964285 | DE = -4.87e-07 | DW = 7.32e-07

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    166.344 | E =     -75.5594032217 | DE = -6.79e-06 | DW = 1.46e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    192.254 | E =     -75.5594037536 | DE = -5.32e-07 | DW = 5.20e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    217.903 | E =     -75.5594038598 | DE = -1.06e-07 | DW = 1.44e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    244.592 | E =     -75.5594037909 | DE = 6.89e-08 | DW = 4.78e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    269.688 | E =     -75.5594038354 | DE = -4.45e-08 | DW = 1.42e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    296.589 | E =     -75.5594037717 | DE = 6.37e-08 | DW = 4.73e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    322.703 | E =     -75.5594038339 | DE = -6.22e-08 | DW = 1.42e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    349.273 | E =     -75.5594037704 | DE = 6.35e-08 | DW = 4.73e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    390.113 | E =     -75.5594042031 | DE = -4.33e-07 | DW = 2.33e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    420.458 | E =     -75.5594042031 | DE = 4.64e-11 | DW = 2.33e-08

E(MRCI) = -75.55940420307945  E_corr = -0.1030334411405534
Time cost =    578.531
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:07:52 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.031895561294 AA    0.000000000000   0.000000000000   1.950000000000 Bohr   0.0

nuclear repulsion = 18.4615384615385
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    0.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     24476.81


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp6rmjuvsy
max_memory 4000 MB (current use 5095 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9746920535549

WARN: Singularity detected in overlap matrix (condition number = 1.36e+03). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.376946372482714  LUMO (Ag) = -0.217906597905051
cycle= 1 E= -75.2586399523512  delta_E= 0.716  |g|= 0.174  |ddm|=  1.6
HOMO (B1u) = -0.487753910327477  LUMO (Ag) = -0.11493850556452
cycle= 2 E= -75.2693410539255  delta_E= -0.0107  |g|= 0.0537  |ddm|= 0.193
HOMO (B1u) = -0.459920537702703  LUMO (Ag) = -0.0893203899470917
cycle= 3 E= -75.2703049843484  delta_E= -0.000964  |g|= 0.0148  |ddm|= 0.127
HOMO (B1u) = -0.46084545813185  LUMO (Ag) = -0.094899039815313
cycle= 4 E= -75.2704430756293  delta_E= -0.000138  |g|= 0.00223  |ddm|= 0.0758
HOMO (B1u) = -0.461426494056181  LUMO (Ag) = -0.0963896216507975
cycle= 5 E= -75.2704465290253  delta_E= -3.45e-06  |g|= 0.00039  |ddm|= 0.0164
HOMO (B1u) = -0.461398372411752  LUMO (Ag) = -0.0963285783601151
cycle= 6 E= -75.270446630032  delta_E= -1.01e-07  |g|= 2.67e-05  |ddm|= 0.00163
HOMO (B1u) = -0.461403601387683  LUMO (Ag) = -0.0963346266369837
cycle= 7 E= -75.2704466304109  delta_E= -3.79e-10  |g|= 1.62e-06  |ddm|= 0.000491
HOMO (B1u) = -0.461403547807355  LUMO (Ag) = -0.0963342779054539
cycle= 8 E= -75.2704466304119  delta_E= -1.02e-12  |g|= 1.22e-07  |ddm|= 2.97e-05
HOMO (B1u) = -0.461403551923599  LUMO (Ag) = -0.0963343022387094
cycle= 9 E= -75.2704466304118  delta_E= 4.26e-14  |g|= 8.39e-09  |ddm|= 9.29e-07
HOMO (B1u) = -0.461403550344583  LUMO (Ag) = -0.0963342976552105
cycle= 10 E= -75.2704466304119  delta_E= -1.42e-14  |g|= 6.38e-09  |ddm|= 2.4e-08
HOMO (B1u) = -0.461403550640218  LUMO (Ag) = -0.096334298127982
cycle= 11 E= -75.2704466304118  delta_E= 2.84e-14  |g|= 6.23e-10  |ddm|= 3.92e-08
HOMO (B1u) = -0.461403550656425  LUMO (Ag) = -0.0963342981381211
cycle= 12 E= -75.2704466304119  delta_E= -4.26e-14  |g|= 4.14e-10  |ddm|= 1.28e-09
HOMO (B1u) = -0.461403550671604  LUMO (Ag) = -0.0963342982119645
cycle= 13 E= -75.2704466304119  delta_E= -1.42e-14  |g|= 3.39e-10  |ddm|= 4.86e-10
HOMO (B1u) = -0.461403550622954  LUMO (Ag) = -0.0963342981468165
cycle= 14 E= -75.2704466304119  delta_E= 2.84e-14  |g|= 3.56e-10  |ddm|= 3.17e-10
HOMO (B1u) = -0.461403550574539  LUMO (Ag) = -0.096334298118238
cycle= 15 E= -75.2704466304119  delta_E= -2.84e-14  |g|= 3.81e-10  |ddm|= 1.5e-09
HOMO (B1u) = -0.46140355063151  LUMO (Ag) = -0.096334298178031
cycle= 16 E= -75.2704466304119  delta_E= 2.84e-14  |g|= 3.41e-10  |ddm|= 1.67e-09
HOMO (B1u) = -0.461403550697668  LUMO (Ag) = -0.0963342982338945
cycle= 17 E= -75.2704466304119  delta_E=    0  |g|= 4.14e-10  |ddm|= 8.7e-10
HOMO (B1u) = -0.461403550757025  LUMO (Ag) = -0.0963342982649217
cycle= 18 E= -75.270446630412  delta_E= -9.95e-14  |g|= 2.49e-10  |ddm|= 1.74e-09
HOMO (B1u) = -0.461403550722952  LUMO (Ag) = -0.0963342982337741
cycle= 19 E= -75.2704466304118  delta_E= 1.56e-13  |g|= 7.48e-11  |ddm|= 8.42e-10
HOMO (B1u) = -0.461403550718248  LUMO (Ag) = -0.0963342982287087
cycle= 20 E= -75.2704466304119  delta_E= -5.68e-14  |g|= 6.23e-11  |ddm|= 5.46e-11
HOMO (B1u) = -0.461403550714611  LUMO (Ag) = -0.096334298225299
cycle= 21 E= -75.2704466304119  delta_E=    0  |g|= 5.61e-11  |ddm|= 2.8e-11
HOMO (B1u) = -0.461403550704094  LUMO (Ag) = -0.0963342982038717
Extra cycle  E= -75.2704466304119  delta_E= -5.68e-14  |g|= 1.66e-11  |ddm|= 2.5e-10
converged SCF energy = -75.2704466304119

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp6rmjuvsy
max_memory 4000 MB (current use 5095 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4235309439023  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4401092624254  dE = -0.016578319  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4547501986021  dE = -0.014640936  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0372  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4667159136033  dE = -0.011965715  S^2 = 0.0000000
               |grad[o]|=0.0972  |ddm|=0.0249  |maxRot[o]|=0.0768
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4737122587909  dE = -0.0069963452  S^2 = 0.0000000
               |grad[o]|=0.0746  |ddm|=0.0134  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.478804926352  dE = -0.0050926676  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.00488  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.4829459326791  dE = -0.0041410063  S^2 = 0.0000000
               |grad[o]|=0.0492  |ddm|=0.00261  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.4864361575778  dE = -0.0034902249  S^2 = 0.0000000
               |grad[o]|=0.0404  |ddm|=0.00172  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.4893784958783  dE = -0.0029423383  S^2 = 0.0000000
               |grad[o]|=0.0329  |ddm|=0.00143  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.4918065096677  dE = -0.0024280138  S^2 = 0.0000000
               |grad[o]|=0.0264  |ddm|=0.00157  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.4937283511053  dE = -0.0019218414  S^2 = 0.0000000
               |grad[o]|=0.0205  |ddm|=0.00194  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.4951451778606  dE = -0.0014168268  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00236  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.4960589334918  dE = -0.00091375563  S^2 = 0.0000000
               |grad[o]|=0.0103  |ddm|=0.00279  |maxRot[o]|=0.0799
macro iter 13 (5 JK  0 micro), CASSCF E = -75.496416224059  dE = -0.00035729057  S^2 = 0.0000000
               |grad[o]|=0.00583  |ddm|=0.00322  |maxRot[o]|=0.0599
macro iter 14 (4 JK  0 micro), CASSCF E = -75.4964898775037  dE = -7.3653445e-05  S^2 = 0.0000000
               |grad[o]|=0.00261  |ddm|=0.00297  |maxRot[o]|=0.0348
macro iter 15 (3 JK  0 micro), CASSCF E = -75.4964915866644  dE = -1.7091607e-06  S^2 = 0.0000000
               |grad[o]|=0.000642  |ddm|=0.00247  |maxRot[o]|=0.00496
macro iter 16 (3 JK  0 micro), CASSCF E = -75.4964916468339  dE = -6.0169455e-08  S^2 = 0.0000000
               |grad[o]|=0.000154  |ddm|=0.000806  |maxRot[o]|=0.000856
macro iter 17 (4 JK  0 micro), CASSCF E = -75.4964916504806  dE = -3.6467469e-09  S^2 = 0.0000000
               |grad[o]|=3.72e-05  |ddm|=0.000211  |maxRot[o]|=0.000163
macro iter 18 (3 JK  0 micro), CASSCF E = -75.496491650584  dE = -1.0338397e-10  S^2 = 0.0000000
               |grad[o]|=7.36e-06  |ddm|=5.08e-05  |maxRot[o]|=3.49e-05
macro iter 19 (3 JK  0 micro), CASSCF E = -75.4964916505892  dE = -5.2580162e-12  S^2 = 0.0000000
               |grad[o]|=2.03e-06  |ddm|=1.17e-05  |maxRot[o]|=6.69e-06
2-step CASSCF converged in 19 macro (97 JK 19 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98968842 1.9354812  1.93548131 1.4543614  0.54286911 0.06701425
 0.06701431 0.00808999]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00041   0.00000   0.00000   0.00186  -0.00251
  0 C 2s       0.57092   0.00000   0.00000   0.44116  -0.41394
  0 C 3s      -0.05831   0.00000  -0.00000   0.01019  -0.03618
  0 C 2px      0.00000   0.00000   0.70454  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70454   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40572  -0.00000  -0.00000  -0.55236   0.57112
  0 C 3px      0.00000  -0.00000  -0.04561  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.04561  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05958   0.00000  -0.00000  -0.01065  -0.03168
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.03931  -0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04991   0.00000  -0.00000   0.00767   0.01244
  0 C 3dxz     0.00000  -0.00000   0.03931  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00041   0.00000   0.00000  -0.00186  -0.00251
  1 C 2s       0.57092  -0.00000   0.00000  -0.44116  -0.41394
  1 C 3s      -0.05831  -0.00000   0.00000  -0.01019  -0.03618
  1 C 2px     -0.00000   0.00000   0.70454  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70454   0.00000   0.00000   0.00000
  1 C 2pz     -0.40572  -0.00000   0.00000  -0.55236  -0.57112
  1 C 3px     -0.00000  -0.00000  -0.04561   0.00000   0.00000
  1 C 3py      0.00000  -0.04561  -0.00000   0.00000   0.00000
  1 C 3pz      0.05958   0.00000   0.00000  -0.01065   0.03168
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03931   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04991  -0.00000  -0.00000  -0.00767   0.01244
  1 C 3dxz     0.00000   0.00000  -0.03931  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00105
  0 C 2s       0.00000   0.00000   0.54938
  0 C 3s      -0.00000  -0.00000  -0.04995
  0 C 2px      0.70564  -0.00000   0.00000
  0 C 2py     -0.00000   0.70564   0.00000
  0 C 2pz      0.00000  -0.00000   0.43709
  0 C 3px     -0.03887  -0.00000   0.00000
  0 C 3py     -0.00000  -0.03887  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.00850
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02381   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.06762
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00105
  1 C 2s       0.00000   0.00000  -0.54938
  1 C 3s      -0.00000   0.00000   0.04995
  1 C 2px     -0.70564   0.00000  -0.00000
  1 C 2py      0.00000  -0.70564  -0.00000
  1 C 2pz     -0.00000   0.00000   0.43709
  1 C 3px      0.03887   0.00000  -0.00000
  1 C 3py      0.00000   0.03887  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.00850
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02381   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.06762
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99625189
<CAS-nat-orb|mo-hf>  4  4    0.99986004
<CAS-nat-orb|mo-hf>  5  5    0.99986004
<CAS-nat-orb|mo-hf>  6  6    0.99867026
<CAS-nat-orb|mo-hf>  7  7    0.98348638
<CAS-nat-orb|mo-hf>  8  8    0.87399690
<CAS-nat-orb|mo-hf>  8  15   -0.48288166
<CAS-nat-orb|mo-hf>  9  9    0.87399699
<CAS-nat-orb|mo-hf>  9  16   -0.48288152
<CAS-nat-orb|mo-hf>  10  17    0.40709993
<CAS-nat-orb|mo-hf>  10  20   -0.75070514
CASSCF energy = -75.4964916505892
CASCI E = -75.4964916505892  E(CI) = -18.9821892359973  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.002
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.012

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.001
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.8 KB SPT = 0.8627 T =      0.049
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.015
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.014
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.100
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.08
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.09
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 56.2 MB Rmem = 5.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 40.1 MB Rmem =  455 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.272 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.170 | Tfpread = 0.000 | Tfpwrite = 0.167 | data = 74.8 MB | cpsd = 56.6 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.203 | E =     -75.5788375391 | DW = 1.09e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.163 | E =     -75.5983913989 | DE = -1.96e-02 | DW = 3.90e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.078 | E =     -75.5986676713 | DE = -2.76e-04 | DW = 8.60e-05

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.919 | E =     -75.5990666168 | DE = -3.99e-04 | DW = 4.87e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.715 | E =     -75.5990691189 | DE = -2.50e-06 | DW = 8.40e-05

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.525 | E =     -75.5990793625 | DE = -1.02e-05 | DW = 4.71e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.399 | E =     -75.5990867630 | DE = -7.40e-06 | DW = 8.42e-05

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.217 | E =     -75.5990790284 | DE = 7.73e-06 | DW = 4.72e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.043 | E =     -75.5996270110 | DE = -5.48e-04 | DW = 6.85e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     11.974 | E =     -75.5997548860 | DE = -1.28e-04 | DW = 6.84e-06

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.522 | E =     -75.5997732907 | DE = -1.84e-05 | DW = 1.38e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     17.430 | E =     -75.5997759039 | DE = -2.61e-06 | DW = 7.35e-06

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.090 | E =     -75.5997776125 | DE = -1.71e-06 | DW = 1.40e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     22.888 | E =     -75.5997777097 | DE = -9.72e-08 | DW = 7.44e-06

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.125 | E =     -75.5997781063 | DE = -3.97e-07 | DW = 1.40e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.260 | E =     -75.5997780855 | DE = 2.08e-08 | DW = 7.47e-06

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     37.716 | E =     -75.5998666499 | DE = -8.86e-05 | DW = 1.47e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     49.129 | E =     -75.5998848551 | DE = -1.82e-05 | DW = 7.36e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     59.765 | E =     -75.5998891030 | DE = -4.25e-06 | DW = 2.10e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     70.861 | E =     -75.5998890535 | DE = 4.96e-08 | DW = 7.78e-07

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     81.344 | E =     -75.5998886100 | DE = 4.44e-07 | DW = 1.98e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     93.702 | E =     -75.5998890824 | DE = -4.72e-07 | DW = 7.75e-07

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    104.622 | E =     -75.5998885775 | DE = 5.05e-07 | DW = 1.97e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    117.065 | E =     -75.5998890822 | DE = -5.05e-07 | DW = 7.73e-07

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    139.512 | E =     -75.5998961236 | DE = -7.04e-06 | DW = 1.52e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    166.139 | E =     -75.5998967172 | DE = -5.94e-07 | DW = 5.52e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    194.913 | E =     -75.5998968338 | DE = -1.17e-07 | DW = 1.49e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    221.510 | E =     -75.5998967616 | DE = 7.22e-08 | DW = 5.04e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    248.144 | E =     -75.5998968133 | DE = -5.18e-08 | DW = 1.48e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    272.699 | E =     -75.5998967466 | DE = 6.67e-08 | DW = 5.00e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    300.128 | E =     -75.5998968094 | DE = -6.28e-08 | DW = 1.47e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    326.753 | E =     -75.5998967426 | DE = 6.68e-08 | DW = 4.99e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    370.715 | E =     -75.5998972019 | DE = -4.59e-07 | DW = 2.50e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    403.528 | E =     -75.5998972018 | DE = 3.21e-11 | DW = 2.50e-08

E(MRCI) = -75.59989720184821  E_corr = -0.1034055512589589
Time cost =    602.286
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:17:54 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.058354421840 AA    0.000000000000   0.000000000000   2.000000000000 Bohr   0.0

nuclear repulsion = 18
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 1.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     32320.11


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpacl4f7ic
max_memory 4000 MB (current use 5097 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.9170535172816

WARN: Singularity detected in overlap matrix (condition number = 1.22e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.359902883841541  LUMO (Ag) = -0.213307043039728
cycle= 1 E= -75.2901241201449  delta_E= 0.627  |g|= 0.175  |ddm|= 1.58
HOMO (B1u) = -0.496094054564504  LUMO (Ag) = -0.119573071329233
cycle= 2 E= -75.3009349666093  delta_E= -0.0108  |g|= 0.0531  |ddm|= 0.188
HOMO (B1u) = -0.467321073254813  LUMO (Ag) = -0.0923011554436151
cycle= 3 E= -75.3018357121932  delta_E= -0.000901  |g|= 0.0141  |ddm|= 0.113
HOMO (B1u) = -0.467647600574111  LUMO (Ag) = -0.0969889779106467
cycle= 4 E= -75.3019617797125  delta_E= -0.000126  |g|= 0.00222  |ddm|= 0.0704
HOMO (B1u) = -0.468220968325748  LUMO (Ag) = -0.0984869419679114
cycle= 5 E= -75.3019652459277  delta_E= -3.47e-06  |g|= 0.000378  |ddm|= 0.0164
HOMO (B1u) = -0.468193490312786  LUMO (Ag) = -0.0984366742323402
cycle= 6 E= -75.3019653408538  delta_E= -9.49e-08  |g|= 2.64e-05  |ddm|= 0.00134
HOMO (B1u) = -0.468199393066117  LUMO (Ag) = -0.0984431261473197
cycle= 7 E= -75.3019653412215  delta_E= -3.68e-10  |g|= 1.72e-06  |ddm|= 0.000455
HOMO (B1u) = -0.468199353870882  LUMO (Ag) = -0.098442890784737
cycle= 8 E= -75.3019653412227  delta_E= -1.22e-12  |g|= 1.15e-07  |ddm|= 3.08e-05
HOMO (B1u) = -0.468199359870447  LUMO (Ag) = -0.0984429094364471
cycle= 9 E= -75.3019653412227  delta_E= 1.42e-14  |g|= 7.48e-09  |ddm|= 7.76e-07
HOMO (B1u) = -0.4681993578502  LUMO (Ag) = -0.0984429054950346
cycle= 10 E= -75.3019653412227  delta_E= -1.42e-14  |g|= 6.67e-09  |ddm|= 7.66e-09
HOMO (B1u) = -0.46819935819627  LUMO (Ag) = -0.0984429061772303
cycle= 11 E= -75.3019653412227  delta_E= 2.84e-14  |g|= 6.05e-10  |ddm|= 3.47e-08
HOMO (B1u) = -0.468199358177825  LUMO (Ag) = -0.0984429061457359
cycle= 12 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 3.83e-10  |ddm|= 1.62e-09
HOMO (B1u) = -0.468199358249336  LUMO (Ag) = -0.0984429062804847
cycle= 13 E= -75.3019653412227  delta_E= -8.53e-14  |g|= 3.49e-10  |ddm|= 2.01e-10
HOMO (B1u) = -0.4681993581867  LUMO (Ag) = -0.0984429062151477
cycle= 14 E= -75.3019653412227  delta_E= 4.26e-14  |g|= 3.58e-10  |ddm|= 7.2e-10
HOMO (B1u) = -0.468199358149058  LUMO (Ag) = -0.0984429062034102
cycle= 15 E= -75.3019653412227  delta_E= 1.42e-14  |g|= 3.77e-10  |ddm|= 3.87e-10
HOMO (B1u) = -0.468199358214599  LUMO (Ag) = -0.098442906243677
cycle= 16 E= -75.3019653412227  delta_E= -2.84e-14  |g|= 2.98e-10  |ddm|= 8.77e-10
HOMO (B1u) = -0.468199358285043  LUMO (Ag) = -0.0984429063011113
cycle= 17 E= -75.3019653412226  delta_E= 5.68e-14  |g|= 4.07e-10  |ddm|= 9.51e-10
HOMO (B1u) = -0.468199358332422  LUMO (Ag) = -0.0984429063251926
cycle= 18 E= -75.3019653412227  delta_E= -4.26e-14  |g|= 2.62e-10  |ddm|= 1.08e-09
HOMO (B1u) = -0.468199358291859  LUMO (Ag) = -0.0984429062903817
cycle= 19 E= -75.3019653412226  delta_E= 8.53e-14  |g|= 7.26e-11  |ddm|= 7.04e-10
HOMO (B1u) = -0.468199358287233  LUMO (Ag) = -0.0984429062852037
cycle= 20 E= -75.3019653412227  delta_E= -1.28e-13  |g|= 6.08e-11  |ddm|= 5.25e-11
HOMO (B1u) = -0.468199358283489  LUMO (Ag) = -0.098442906281351
cycle= 21 E= -75.3019653412226  delta_E= 8.53e-14  |g|= 5.64e-11  |ddm|= 1.95e-11
HOMO (B1u) = -0.468199358282719  LUMO (Ag) = -0.0984429062787663
cycle= 22 E= -75.3019653412226  delta_E= 2.84e-14  |g|= 4.95e-11  |ddm|= 3.87e-11
HOMO (B1u) = -0.468199358281443  LUMO (Ag) = -0.0984429062752551
cycle= 23 E= -75.3019653412227  delta_E= -1.42e-13  |g|= 4.36e-11  |ddm|= 7.85e-11
HOMO (B1u) = -0.468199358279728  LUMO (Ag) = -0.0984429062691371
cycle= 24 E= -75.3019653412227  delta_E=    0  |g|= 3.66e-11  |ddm|= 7.5e-11
HOMO (B1u) = -0.468199358278618  LUMO (Ag) = -0.0984429062634033
Extra cycle  E= -75.3019653412226  delta_E= 9.95e-14  |g|= 1.06e-11  |ddm|= 1.3e-10
converged SCF energy = -75.3019653412226

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpacl4f7ic
max_memory 4000 MB (current use 5097 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4565254955835  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4737022764213  dE = -0.017176781  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4887727731252  dE = -0.015070497  S^2 = 0.0000000
               |grad[o]|= 0.12  |ddm|=0.0393  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5002894655844  dE = -0.011516692  S^2 = 0.0000000
               |grad[o]|=0.0957  |ddm|=0.0259  |maxRot[o]|=0.0795
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5070713854006  dE = -0.0067819198  S^2 = 0.0000000
               |grad[o]|=0.0736  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5121496775693  dE = -0.0050782922  S^2 = 0.0000000
               |grad[o]|=0.0594  |ddm|=0.00472  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5163277967249  dE = -0.0041781192  S^2 = 0.0000000
               |grad[o]|=0.0487  |ddm|=0.00258  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5198580737636  dE = -0.003530277  S^2 = 0.0000000
               |grad[o]|=0.0398  |ddm|=0.00176  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5228214717484  dE = -0.002963398  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00158  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5252380577932  dE = -0.002416586  S^2 = 0.0000000
               |grad[o]|=0.0255  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5271072497555  dE = -0.001869192  S^2 = 0.0000000
               |grad[o]|=0.0195  |ddm|=0.00221  |maxRot[o]|=0.0799
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5284243189397  dE = -0.0013170692  S^2 = 0.0000000
               |grad[o]|=0.0139  |ddm|=0.00263  |maxRot[o]|=0.0799
macro iter 12 (6 JK  0 micro), CASSCF E = -75.529186187055  dE = -0.00076186812  S^2 = 0.0000000
               |grad[o]|=0.00884  |ddm|=0.00303  |maxRot[o]|=0.0798
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5293597023536  dE = -0.0001735153  S^2 = 0.0000000
               |grad[o]|=0.00413  |ddm|=0.00348  |maxRot[o]|= 0.04
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5293893921311  dE = -2.9689777e-05  S^2 = 0.0000000
               |grad[o]|=0.00175  |ddm|=0.00233  |maxRot[o]|=0.0199
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5293900606679  dE = -6.6853674e-07  S^2 = 0.0000000
               |grad[o]|=0.000422  |ddm|=0.00169  |maxRot[o]|=0.00304
macro iter 16 (3 JK  0 micro), CASSCF E = -75.529390083547  dE = -2.2879107e-08  S^2 = 0.0000000
               |grad[o]|=9.85e-05  |ddm|=0.000522  |maxRot[o]|=0.000505
macro iter 17 (4 JK  0 micro), CASSCF E = -75.5293900853978  dE = -1.8508928e-09  S^2 = 0.0000000
               |grad[o]|=2.92e-05  |ddm|=0.000129  |maxRot[o]|=0.000103
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5293900854448  dE = -4.6938453e-11  S^2 = 0.0000000
               |grad[o]|=7.21e-06  |ddm|=2.25e-05  |maxRot[o]|=1.27e-05
2-step CASSCF converged in 18 macro (92 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98911931 1.93077492 1.93077469 1.47651695 0.52034779 0.07191173
 0.07191148 0.00864313]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00076   0.00000   0.00000   0.00197  -0.00230
  0 C 2s       0.57327  -0.00000  -0.00000   0.45141  -0.41073
  0 C 3s      -0.05772  -0.00000   0.00000   0.00999  -0.03341
  0 C 2px     -0.00000   0.00000   0.70492   0.00000   0.00000
  0 C 2py     -0.00000   0.70492   0.00000  -0.00000  -0.00000
  0 C 2pz      0.40282  -0.00000   0.00000  -0.54404   0.57355
  0 C 3px     -0.00000   0.00000  -0.04022   0.00000  -0.00000
  0 C 3py      0.00000  -0.04022  -0.00000  -0.00000  -0.00000
  0 C 3pz     -0.05831  -0.00000   0.00000  -0.00984  -0.03298
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.03836   0.00000  -0.00000  -0.00000
  0 C 3dz^2    0.04862  -0.00000   0.00000   0.00687   0.01178
  0 C 3dxz    -0.00000   0.00000   0.03836   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00076   0.00000   0.00000  -0.00197  -0.00230
  1 C 2s       0.57327   0.00000  -0.00000  -0.45141  -0.41073
  1 C 3s      -0.05772   0.00000  -0.00000  -0.00999  -0.03341
  1 C 2px      0.00000  -0.00000   0.70492  -0.00000   0.00000
  1 C 2py      0.00000   0.70492   0.00000   0.00000  -0.00000
  1 C 2pz     -0.40282   0.00000   0.00000  -0.54404  -0.57355
  1 C 3px      0.00000  -0.00000  -0.04022  -0.00000  -0.00000
  1 C 3py      0.00000  -0.04022  -0.00000   0.00000   0.00000
  1 C 3pz      0.05831  -0.00000   0.00000  -0.00984   0.03298
  1 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.03836   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04862   0.00000  -0.00000  -0.00687   0.01178
  1 C 3dxz    -0.00000   0.00000  -0.03836   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00101
  0 C 2s      -0.00000  -0.00000   0.54172
  0 C 3s       0.00000  -0.00000  -0.04839
  0 C 2px      0.70576  -0.00000   0.00000
  0 C 2py      0.00000   0.70576  -0.00000
  0 C 2pz     -0.00000   0.00000   0.44796
  0 C 3px     -0.03649  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03649  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00649
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02381  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.05909
  0 C 3dxz    -0.02381  -0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00101
  1 C 2s      -0.00000   0.00000  -0.54172
  1 C 3s      -0.00000   0.00000   0.04839
  1 C 2px     -0.70576   0.00000   0.00000
  1 C 2py      0.00000  -0.70576  -0.00000
  1 C 2pz      0.00000   0.00000   0.44796
  1 C 3px      0.03649   0.00000  -0.00000
  1 C 3py     -0.00000   0.03649   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00649
  1 C 3dxy    -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02381  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.05909
  1 C 3dxz    -0.02381  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99610896
<CAS-nat-orb|mo-hf>  4  4    0.99985893
<CAS-nat-orb|mo-hf>  5  5    0.99985893
<CAS-nat-orb|mo-hf>  6  6    0.99868926
<CAS-nat-orb|mo-hf>  7  7    0.98295350
<CAS-nat-orb|mo-hf>  8  8    0.88422791
<CAS-nat-orb|mo-hf>  8  15   -0.46451001
<CAS-nat-orb|mo-hf>  9  9    0.88422777
<CAS-nat-orb|mo-hf>  9  16   -0.46451027
<CAS-nat-orb|mo-hf>  10  17    0.44059970
<CAS-nat-orb|mo-hf>  10  20   -0.73158913
CASSCF energy = -75.5293900854448
CASCI E = -75.5293900854448  E(CI) = -18.8101054812113  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.001
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.006
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.008
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.017

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.7 KB SPT = 0.8631 T =      0.098
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.027
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.006
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.005
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.015
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.020
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.174
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.09
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.08
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.05
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 56.2 MB Rmem = 5.02 MB T = 0.02
 INIT-R <-- Site =    1 ..  Bmem = 40.1 MB Rmem =  455 KB T = 0.04
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.01
Time init sweep =        0.397 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.208 | Tfpread = 0.000 | Tfpwrite = 0.191 | data = 74.8 MB | cpsd = 56.6 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.935 | E =     -75.6115195796 | DW = 1.15e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.770 | E =     -75.6315752905 | DE = -2.01e-02 | DW = 4.24e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.173 | E =     -75.6318596101 | DE = -2.84e-04 | DW = 8.95e-05

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.555 | E =     -75.6322800536 | DE = -4.20e-04 | DW = 5.32e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.896 | E =     -75.6322818757 | DE = -1.82e-06 | DW = 9.28e-05

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.311 | E =     -75.6323024776 | DE = -2.06e-05 | DW = 5.42e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.558 | E =     -75.6323018950 | DE = 5.83e-07 | DW = 8.91e-05

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     11.819 | E =     -75.6323012348 | DE = 6.60e-07 | DW = 5.42e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.733 | E =     -75.6328749284 | DE = -5.74e-04 | DW = 7.24e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     18.332 | E =     -75.6330084010 | DE = -1.33e-04 | DW = 7.49e-06

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     21.241 | E =     -75.6330240473 | DE = -1.56e-05 | DW = 1.46e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.216 | E =     -75.6330270698 | DE = -3.02e-06 | DW = 8.01e-06

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.995 | E =     -75.6330288938 | DE = -1.82e-06 | DW = 1.48e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.080 | E =     -75.6330289998 | DE = -1.06e-07 | DW = 8.09e-06

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.686 | E =     -75.6330292770 | DE = -2.77e-07 | DW = 1.48e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.536 | E =     -75.6330293007 | DE = -2.37e-08 | DW = 8.10e-06

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.879 | E =     -75.6331215657 | DE = -9.23e-05 | DW = 1.54e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     51.905 | E =     -75.6331404789 | DE = -1.89e-05 | DW = 7.84e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     61.308 | E =     -75.6331448632 | DE = -4.38e-06 | DW = 2.21e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     71.563 | E =     -75.6331448048 | DE = 5.84e-08 | DW = 8.23e-07

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     84.514 | E =     -75.6331449404 | DE = -1.36e-07 | DW = 2.21e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     97.258 | E =     -75.6331448432 | DE = 9.72e-08 | DW = 8.19e-07

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.252 | E =     -75.6331449342 | DE = -9.10e-08 | DW = 2.20e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    124.208 | E =     -75.6331448435 | DE = 9.08e-08 | DW = 8.18e-07

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    149.921 | E =     -75.6331521888 | DE = -7.35e-06 | DW = 1.58e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    180.257 | E =     -75.6331528094 | DE = -6.21e-07 | DW = 5.86e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    208.781 | E =     -75.6331529386 | DE = -1.29e-07 | DW = 1.55e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    236.279 | E =     -75.6331528619 | DE = 7.67e-08 | DW = 5.31e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    262.012 | E =     -75.6331529162 | DE = -5.43e-08 | DW = 1.53e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    288.347 | E =     -75.6331528457 | DE = 7.05e-08 | DW = 5.27e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    314.894 | E =     -75.6331529146 | DE = -6.90e-08 | DW = 1.53e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    341.214 | E =     -75.6331528437 | DE = 7.09e-08 | DW = 5.26e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    382.086 | E =     -75.6331533281 | DE = -4.84e-07 | DW = 2.67e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    411.173 | E =     -75.6331533281 | DE = 3.24e-11 | DW = 2.67e-08

E(MRCI) = -75.633153328107  E_corr = -0.103763242662211
Time cost =    492.830
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:26:07 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.084813282386 AA    0.000000000000   0.000000000000   2.050000000000 Bohr   0.0

nuclear repulsion = 17.5609756097561
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     39100.92


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpjw02fyn6
max_memory 4000 MB (current use 5118 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8587717717965

WARN: Singularity detected in overlap matrix (condition number = 1.1e+03). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.343801090949931  LUMO (Ag) = -0.208899636382795
cycle= 1 E= -75.3152287127073  delta_E= 0.544  |g|= 0.177  |ddm|= 1.56
HOMO (B1u) = -0.504407518465331  LUMO (Ag) = -0.123879990102774
cycle= 2 E= -75.326251581953  delta_E= -0.011  |g|= 0.0526  |ddm|= 0.188
HOMO (B1u) = -0.474708360691125  LUMO (Ag) = -0.0950218080877935
cycle= 3 E= -75.3271055696138  delta_E= -0.000854  |g|= 0.0134  |ddm|= 0.101
HOMO (B1u) = -0.474494822450148  LUMO (Ag) = -0.0988363835418916
cycle= 4 E= -75.3272181663453  delta_E= -0.000113  |g|= 0.00221  |ddm|= 0.0646
HOMO (B1u) = -0.475044448091171  LUMO (Ag) = -0.100314895198609
cycle= 5 E= -75.3272215916786  delta_E= -3.43e-06  |g|= 0.000363  |ddm|= 0.0164
HOMO (B1u) = -0.475018098728987  LUMO (Ag) = -0.100277615221357
cycle= 6 E= -75.3272216794877  delta_E= -8.78e-08  |g|= 2.61e-05  |ddm|= 0.00103
HOMO (B1u) = -0.475024517384062  LUMO (Ag) = -0.100284470661359
cycle= 7 E= -75.3272216798442  delta_E= -3.56e-10  |g|= 1.87e-06  |ddm|= 0.000419
HOMO (B1u) = -0.475024512000407  LUMO (Ag) = -0.100284344431205
cycle= 8 E= -75.3272216798456  delta_E= -1.42e-12  |g|= 1.12e-07  |ddm|= 3.22e-05
HOMO (B1u) = -0.475024518733667  LUMO (Ag) = -0.100284359326606
cycle= 9 E= -75.3272216798456  delta_E=    0  |g|= 7.12e-09  |ddm|= 6.36e-07
HOMO (B1u) = -0.475024516372406  LUMO (Ag) = -0.100284355800601
cycle= 10 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 6.88e-09  |ddm|= 8.6e-09
HOMO (B1u) = -0.475024518411257  LUMO (Ag) = -0.100284358870979
cycle= 11 E= -75.3272216798456  delta_E= -2.84e-14  |g|= 5.9e-09  |ddm|= 2.94e-08
HOMO (B1u) = -0.47502451677225  LUMO (Ag) = -0.100284356674954
cycle= 12 E= -75.3272216798456  delta_E= 5.68e-14  |g|= 5.27e-10  |ddm|= 7.3e-09
HOMO (B1u) = -0.475024516786975  LUMO (Ag) = -0.100284356796285
cycle= 13 E= -75.3272216798456  delta_E= -5.68e-14  |g|= 5.14e-10  |ddm|= 1.16e-09
HOMO (B1u) = -0.475024516697171  LUMO (Ag) = -0.100284356701326
cycle= 14 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 5.68e-10  |ddm|= 1.33e-09
HOMO (B1u) = -0.475024516687892  LUMO (Ag) = -0.100284356713633
cycle= 15 E= -75.3272216798456  delta_E= 2.84e-14  |g|= 5.39e-10  |ddm|= 7.86e-10
HOMO (B1u) = -0.475024516721546  LUMO (Ag) = -0.100284356696744
cycle= 16 E= -75.3272216798457  delta_E= -1.14e-13  |g|= 4.35e-10  |ddm|= 4.09e-09
HOMO (B1u) = -0.475024516863632  LUMO (Ag) = -0.100284356808633
cycle= 17 E= -75.3272216798455  delta_E= 1.99e-13  |g|= 5.68e-10  |ddm|= 1.78e-09
HOMO (B1u) = -0.475024516900882  LUMO (Ag) = -0.100284356827834
cycle= 18 E= -75.3272216798456  delta_E= -1.14e-13  |g|= 4.14e-10  |ddm|= 6.15e-10
HOMO (B1u) = -0.47502451685605  LUMO (Ag) = -0.100284356793194
cycle= 19 E= -75.3272216798457  delta_E= -5.68e-14  |g|= 2.33e-10  |ddm|= 5.24e-10
HOMO (B1u) = -0.475024516880725  LUMO (Ag) = -0.100284356813854
cycle= 20 E= -75.3272216798456  delta_E= 1.14e-13  |g|= 9.92e-11  |ddm|= 2.28e-10
HOMO (B1u) = -0.47502451687624  LUMO (Ag) = -0.100284356809379
cycle= 21 E= -75.3272216798456  delta_E= -7.11e-14  |g|= 9.28e-11  |ddm|= 3.17e-11
HOMO (B1u) = -0.475024516875595  LUMO (Ag) = -0.100284356804496
cycle= 22 E= -75.3272216798456  delta_E= 4.26e-14  |g|= 8.18e-11  |ddm|= 9.72e-11
HOMO (B1u) = -0.475024516873796  LUMO (Ag) = -0.100284356797744
cycle= 23 E= -75.3272216798456  delta_E=    0  |g|= 7.1e-11  |ddm|= 1.6e-10
HOMO (B1u) = -0.475024516865124  LUMO (Ag) = -0.100284356774914
Extra cycle  E= -75.3272216798456  delta_E= -5.68e-14  |g|= 2.34e-11  |ddm|= 2.11e-10
converged SCF energy = -75.3272216798456

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpjw02fyn6
max_memory 4000 MB (current use 5118 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4833111059063  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.501081123956  dE = -0.017770018  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5165754583853  dE = -0.015494334  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0415  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5274381013174  dE = -0.010862643  S^2 = 0.0000000
               |grad[o]|=0.0942  |ddm|=0.0269  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5341182018328  dE = -0.0066801005  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0121  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5392283074735  dE = -0.0051101056  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00475  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5434666951776  dE = -0.0042383877  S^2 = 0.0000000
               |grad[o]|=0.0483  |ddm|=0.00267  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5470469288405  dE = -0.0035802337  S^2 = 0.0000000
               |grad[o]|=0.0393  |ddm|=0.00189  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5500288114037  dE = -0.0029818826  S^2 = 0.0000000
               |grad[o]|=0.0315  |ddm|=0.00181  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5524207857349  dE = -0.0023919743  S^2 = 0.0000000
               |grad[o]|=0.0246  |ddm|=0.0021  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5542124364549  dE = -0.0017916507  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5553931747992  dE = -0.0011807383  S^2 = 0.0000000
               |grad[o]|=0.0125  |ddm|=0.00293  |maxRot[o]|=0.0798
macro iter 12 (6 JK  0 micro), CASSCF E = -75.5559528170005  dE = -0.0005596422  S^2 = 0.0000000
               |grad[o]|=0.0071  |ddm|=0.00332  |maxRot[o]|=0.0798
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5559944765664  dE = -4.1659566e-05  S^2 = 0.0000000
               |grad[o]|=0.00221  |ddm|=0.00383  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5559984890054  dE = -4.012439e-06  S^2 = 0.0000000
               |grad[o]|=0.00082  |ddm|=0.00163  |maxRot[o]|=0.00754
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5559985877638  dE = -9.8758335e-08  S^2 = 0.0000000
               |grad[o]|=0.000181  |ddm|=0.000852  |maxRot[o]|=0.00113
macro iter 16 (4 JK  0 micro), CASSCF E = -75.5559985922054  dE = -4.4416311e-09  S^2 = 0.0000000
               |grad[o]|=4.32e-05  |ddm|=0.000229  |maxRot[o]|=0.000181
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5559985923263  dE = -1.2090595e-10  S^2 = 0.0000000
               |grad[o]|=7.82e-06  |ddm|=5.11e-05  |maxRot[o]|=3.83e-05
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5559985923329  dE = -6.5654149e-12  S^2 = 0.0000000
               |grad[o]|=1.56e-06  |ddm|=5.01e-06  |maxRot[o]|=6.03e-06
2-step CASSCF converged in 18 macro (91 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98851474 1.92585844 1.92585837 1.49745743 0.49906983 0.07700632
 0.07700619 0.00922867]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00113   0.00000   0.00000   0.00208  -0.00211
  0 C 2s       0.57579   0.00000  -0.00000   0.46137  -0.40723
  0 C 3s      -0.05693  -0.00000  -0.00000   0.00979  -0.03053
  0 C 2px     -0.00000   0.00000   0.70524  -0.00000   0.00000
  0 C 2py      0.00000   0.70524   0.00000  -0.00000  -0.00000
  0 C 2pz      0.39967   0.00000   0.00000  -0.53564   0.57613
  0 C 3px     -0.00000   0.00000  -0.03513  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03513   0.00000   0.00000  -0.00000
  0 C 3pz     -0.05695  -0.00000   0.00000  -0.00906  -0.03424
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.03742   0.00000   0.00000  -0.00000
  0 C 3dz^2    0.04728  -0.00000   0.00000   0.00608   0.01129
  0 C 3dxz    -0.00000   0.00000   0.03742  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00113   0.00000   0.00000  -0.00208  -0.00211
  1 C 2s       0.57579   0.00000  -0.00000  -0.46137  -0.40723
  1 C 3s      -0.05693   0.00000   0.00000  -0.00979  -0.03053
  1 C 2px      0.00000  -0.00000   0.70524   0.00000   0.00000
  1 C 2py      0.00000   0.70524  -0.00000  -0.00000   0.00000
  1 C 2pz     -0.39967   0.00000  -0.00000  -0.53564  -0.57613
  1 C 3px      0.00000  -0.00000  -0.03513   0.00000  -0.00000
  1 C 3py      0.00000  -0.03513  -0.00000   0.00000   0.00000
  1 C 3pz      0.05695  -0.00000  -0.00000  -0.00906   0.03424
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.03742   0.00000  -0.00000  -0.00000
  1 C 3dz^2    0.04728  -0.00000   0.00000  -0.00608   0.01129
  1 C 3dxz    -0.00000   0.00000  -0.03742  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00097
  0 C 2s      -0.00000   0.00000   0.53380
  0 C 3s      -0.00000   0.00000  -0.04704
  0 C 2px      0.70587   0.00000  -0.00000
  0 C 2py      0.00000   0.70587   0.00000
  0 C 2pz     -0.00000  -0.00000   0.45840
  0 C 3px     -0.03434   0.00000  -0.00000
  0 C 3py      0.00000  -0.03434  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.00431
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.05187
  0 C 3dxz    -0.02382  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00097
  1 C 2s       0.00000  -0.00000  -0.53380
  1 C 3s       0.00000  -0.00000   0.04704
  1 C 2px     -0.70587   0.00000   0.00000
  1 C 2py     -0.00000  -0.70587   0.00000
  1 C 2pz      0.00000   0.00000   0.45840
  1 C 3px      0.03434  -0.00000   0.00000
  1 C 3py     -0.00000   0.03434   0.00000
  1 C 3pz     -0.00000   0.00000  -0.00431
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.05187
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99594658
<CAS-nat-orb|mo-hf>  4  4    0.99985545
<CAS-nat-orb|mo-hf>  5  5    0.99985545
<CAS-nat-orb|mo-hf>  6  6    0.99869864
<CAS-nat-orb|mo-hf>  7  7    0.98240655
<CAS-nat-orb|mo-hf>  8  8    0.89361614
<CAS-nat-orb|mo-hf>  8  15   -0.44672575
<CAS-nat-orb|mo-hf>  9  9    0.89361610
<CAS-nat-orb|mo-hf>  9  16   -0.44672583
<CAS-nat-orb|mo-hf>  10  17    0.47419762
<CAS-nat-orb|mo-hf>  10  20   -0.71074897
CASSCF energy = -75.5559985923329
CASCI E = -75.5559985923329  E(CI) = -18.6416908007547  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.030
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.338
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.095
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.657

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.030
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.6 KB SPT = 0.8633 T =      0.643
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.736
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.725
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.729
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.329
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.317
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.564
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.09
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.12
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.08
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.05
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.05
 INIT-R <-- Site =    2 ..  Bmem = 56.2 MB Rmem = 5.02 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 40.1 MB Rmem =  455 KB T = 0.06
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.579 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.279 | Tfpread = 0.000 | Tfpwrite = 0.277 | data = 74.8 MB | cpsd = 56.6 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.388 | E =     -75.6378197777 | DW = 1.21e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     11.509 | E =     -75.6584503602 | DE = -2.06e-02 | DW = 4.57e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.224 | E =     -75.6587590891 | DE = -3.09e-04 | DW = 9.39e-05

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.978 | E =     -75.6591956595 | DE = -4.37e-04 | DW = 5.72e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     13.675 | E =     -75.6591991070 | DE = -3.45e-06 | DW = 9.86e-05

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     14.387 | E =     -75.6592232688 | DE = -2.42e-05 | DW = 5.83e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.049 | E =     -75.6592216064 | DE = 1.66e-06 | DW = 9.87e-05

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.798 | E =     -75.6592239045 | DE = -2.30e-06 | DW = 5.84e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     17.625 | E =     -75.6598156355 | DE = -5.92e-04 | DW = 7.69e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     22.429 | E =     -75.6599547420 | DE = -1.39e-04 | DW = 8.13e-06

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.187 | E =     -75.6599747777 | DE = -2.00e-05 | DW = 1.60e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.953 | E =     -75.6599779843 | DE = -3.21e-06 | DW = 9.07e-06

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.517 | E =     -75.6599777530 | DE = 2.31e-07 | DW = 1.58e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.514 | E =     -75.6599778072 | DE = -5.42e-08 | DW = 8.83e-06

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.251 | E =     -75.6599779929 | DE = -1.86e-07 | DW = 1.58e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     47.801 | E =     -75.6599780430 | DE = -5.01e-08 | DW = 8.85e-06

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.268 | E =     -75.6600745999 | DE = -9.66e-05 | DW = 1.61e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     66.377 | E =     -75.6600942829 | DE = -1.97e-05 | DW = 8.33e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     77.492 | E =     -75.6600988876 | DE = -4.60e-06 | DW = 2.32e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.376 | E =     -75.6600988410 | DE = 4.66e-08 | DW = 8.73e-07

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     99.520 | E =     -75.6600989969 | DE = -1.56e-07 | DW = 2.32e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.729 | E =     -75.6600988963 | DE = 1.01e-07 | DW = 8.71e-07

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.629 | E =     -75.6600989890 | DE = -9.28e-08 | DW = 2.32e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    132.836 | E =     -75.6600988838 | DE = 1.05e-07 | DW = 8.68e-07

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    153.782 | E =     -75.6601064534 | DE = -7.57e-06 | DW = 1.65e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    178.887 | E =     -75.6601071143 | DE = -6.61e-07 | DW = 6.30e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    203.187 | E =     -75.6601072698 | DE = -1.55e-07 | DW = 1.63e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    228.576 | E =     -75.6601071820 | DE = 8.78e-08 | DW = 5.65e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    253.620 | E =     -75.6601072168 | DE = -3.48e-08 | DW = 1.59e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    279.750 | E =     -75.6601071423 | DE = 7.45e-08 | DW = 5.53e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    305.033 | E =     -75.6601072115 | DE = -6.91e-08 | DW = 1.59e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    332.401 | E =     -75.6601071365 | DE = 7.50e-08 | DW = 5.52e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    378.112 | E =     -75.6601076579 | DE = -5.21e-07 | DW = 2.86e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    409.397 | E =     -75.6601076579 | DE = 2.94e-11 | DW = 2.86e-08

E(MRCI) = -75.66010765786979  E_corr = -0.1041090655369032
Time cost =    802.627
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:39:30 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.111272142932 AA    0.000000000000   0.000000000000   2.100000000000 Bohr   0.0

nuclear repulsion = 17.1428571428571
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     47336.49


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpxktmnnw7
max_memory 4000 MB (current use 5096 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.8003866027882

WARN: Singularity detected in overlap matrix (condition number =  999). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.32858894486889  LUMO (Ag) = -0.204693729619157
cycle= 1 E= -75.3347800230759  delta_E= 0.466  |g|= 0.18  |ddm|= 1.55
HOMO (B1u) = -0.512671455628693  LUMO (Ag) = -0.127860887413406
cycle= 2 E= -75.346109112634  delta_E= -0.0113  |g|= 0.0522  |ddm|= 0.19
HOMO (B1u) = -0.482062537885922  LUMO (Ag) = -0.097476944519184
cycle= 3 E= -75.3469306677087  delta_E= -0.000822  |g|= 0.0126  |ddm|= 0.0913
HOMO (B1u) = -0.481374466024948  LUMO (Ag) = -0.100457341704975
cycle= 4 E= -75.3470296424032  delta_E= -9.9e-05  |g|= 0.00217  |ddm|= 0.0587
HOMO (B1u) = -0.481886259872507  LUMO (Ag) = -0.101886818572125
cycle= 5 E= -75.3470329570725  delta_E= -3.31e-06  |g|= 0.000344  |ddm|= 0.0161
HOMO (B1u) = -0.481861583616576  LUMO (Ag) = -0.101865081893001
cycle= 6 E= -75.3470330362213  delta_E= -7.91e-08  |g|= 2.58e-05  |ddm|= 0.000729
HOMO (B1u) = -0.481868355987196  LUMO (Ag) = -0.101872367771491
cycle= 7 E= -75.3470330365669  delta_E= -3.46e-10  |g|= 2.05e-06  |ddm|= 0.000385
HOMO (B1u) = -0.481868395860479  LUMO (Ag) = -0.101872342919466
cycle= 8 E= -75.3470330365685  delta_E= -1.68e-12  |g|= 1.14e-07  |ddm|= 3.34e-05
HOMO (B1u) = -0.481868402323703  LUMO (Ag) = -0.101872355528156
cycle= 9 E= -75.3470330365685  delta_E= 2.84e-14  |g|= 7.18e-09  |ddm|= 5.08e-07
HOMO (B1u) = -0.481868399652581  LUMO (Ag) = -0.101872352083975
cycle= 10 E= -75.3470330365686  delta_E= -9.95e-14  |g|= 7.13e-09  |ddm|= 1.12e-08
HOMO (B1u) = -0.481868400187874  LUMO (Ag) = -0.10187235326224
cycle= 11 E= -75.3470330365686  delta_E= -1.42e-14  |g|= 6.89e-10  |ddm|= 1.92e-08
HOMO (B1u) = -0.481868400167163  LUMO (Ag) = -0.101872353238043
cycle= 12 E= -75.3470330365686  delta_E= 2.84e-14  |g|= 4.28e-10  |ddm|= 1.88e-09
HOMO (B1u) = -0.48186840019363  LUMO (Ag) = -0.101872353313131
cycle= 13 E= -75.3470330365686  delta_E=    0  |g|= 4.17e-10  |ddm|= 9.79e-10
HOMO (B1u) = -0.481868400173097  LUMO (Ag) = -0.101872353275869
cycle= 14 E= -75.3470330365685  delta_E= 8.53e-14  |g|= 3.67e-10  |ddm|= 1.28e-10
HOMO (B1u) = -0.481868400169247  LUMO (Ag) = -0.101872353281095
cycle= 15 E= -75.3470330365686  delta_E= -4.26e-14  |g|= 3.32e-10  |ddm|= 1.88e-10
HOMO (B1u) = -0.481868400196784  LUMO (Ag) = -0.101872353279107
cycle= 16 E= -75.3470330365686  delta_E= -2.84e-14  |g|= 2.86e-10  |ddm|= 1.66e-09
HOMO (B1u) = -0.481868400273185  LUMO (Ag) = -0.101872353333381
cycle= 17 E= -75.3470330365686  delta_E= -4.26e-14  |g|= 4.38e-10  |ddm|= 7.99e-10
HOMO (B1u) = -0.481868400301211  LUMO (Ag) = -0.101872353344063
cycle= 18 E= -75.3470330365686  delta_E= 4.26e-14  |g|= 2.9e-10  |ddm|= 3.37e-10
HOMO (B1u) = -0.481868400249901  LUMO (Ag) = -0.10187235330532
cycle= 19 E= -75.3470330365686  delta_E= 1.42e-14  |g|= 7.98e-11  |ddm|= 4.1e-10
HOMO (B1u) = -0.481868400246859  LUMO (Ag) = -0.101872353300952
cycle= 20 E= -75.3470330365686  delta_E=    0  |g|= 6.62e-11  |ddm|= 4.53e-11
HOMO (B1u) = -0.481868400243209  LUMO (Ag) = -0.101872353286215
Extra cycle  E= -75.3470330365686  delta_E=    0  |g|= 1.85e-11  |ddm|= 1.69e-10
converged SCF energy = -75.3470330365686

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpxktmnnw7
max_memory 4000 MB (current use 5096 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B2u B3u B1u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5047007388545  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5230583899011  dE = -0.018357651  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5389743488824  dE = -0.015915959  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5492372330063  dE = -0.010262884  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.028  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5558447646871  dE = -0.0066075317  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0115  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5609981178417  dE = -0.0051533532  S^2 = 0.0000000
               |grad[o]|=0.0585  |ddm|=0.00486  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5652967728306  dE = -0.004298655  S^2 = 0.0000000
               |grad[o]|=0.0476  |ddm|=0.00284  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5689147822829  dE = -0.0036180095  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00213  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5718913796566  dE = -0.0029765974  S^2 = 0.0000000
               |grad[o]|=0.0304  |ddm|=0.00212  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5742210210789  dE = -0.0023296414  S^2 = 0.0000000
               |grad[o]|=0.0232  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5758831904342  dE = -0.0016621694  S^2 = 0.0000000
               |grad[o]|=0.0166  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5768604420838  dE = -0.00097725165  S^2 = 0.0000000
               |grad[o]|=0.0106  |ddm|=0.00327  |maxRot[o]|=0.0798
macro iter 12 (5 JK  0 micro), CASSCF E = -75.5771322750623  dE = -0.00027183298  S^2 = 0.0000000
               |grad[o]|=0.00491  |ddm|=0.00368  |maxRot[o]|=0.0599
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5771370896574  dE = -4.8145951e-06  S^2 = 0.0000000
               |grad[o]|=0.00106  |ddm|=0.0034  |maxRot[o]|=0.00815
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5771372175538  dE = -1.278964e-07  S^2 = 0.0000000
               |grad[o]|=0.000228  |ddm|=0.00108  |maxRot[o]|=0.00122
macro iter 15 (4 JK  0 micro), CASSCF E = -75.5771372234019  dE = -5.848122e-09  S^2 = 0.0000000
               |grad[o]|=5.05e-05  |ddm|=0.000271  |maxRot[o]|=0.000195
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5771372235454  dE = -1.43487e-10  S^2 = 0.0000000
               |grad[o]|=9.34e-06  |ddm|=5.42e-05  |maxRot[o]|=3.55e-05
macro iter 17 (3 JK  0 micro), CASSCF E = -75.577137223552  dE = -6.5796257e-12  S^2 = 0.0000000
               |grad[o]|=2.15e-06  |ddm|=1.24e-05  |maxRot[o]|=7.05e-06
2-step CASSCF converged in 17 macro (87 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98787579 1.92072813 1.92072837 1.51715864 0.47907    0.08229644
 0.08229649 0.00984613]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00153   0.00000   0.00000   0.00220  -0.00194
  0 C 2s       0.57846  -0.00000  -0.00000   0.47106  -0.40350
  0 C 3s      -0.05596  -0.00000  -0.00000   0.00960  -0.02757
  0 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  0 C 2py      0.00000   0.70551  -0.00000  -0.00000   0.00000
  0 C 2pz      0.39631   0.00000  -0.00000  -0.52717   0.57883
  0 C 3px     -0.00000   0.00000  -0.03031   0.00000  -0.00000
  0 C 3py      0.00000  -0.03031  -0.00000   0.00000   0.00000
  0 C 3pz     -0.05553  -0.00000  -0.00000  -0.00832  -0.03544
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.03648  -0.00000   0.00000   0.00000
  0 C 3dz^2    0.04590  -0.00000  -0.00000   0.00531   0.01098
  0 C 3dxz     0.00000   0.00000   0.03648   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00153   0.00000   0.00000  -0.00220  -0.00194
  1 C 2s       0.57846   0.00000   0.00000  -0.47106  -0.40350
  1 C 3s      -0.05596   0.00000   0.00000  -0.00960  -0.02757
  1 C 2px      0.00000  -0.00000   0.70551  -0.00000  -0.00000
  1 C 2py     -0.00000   0.70551  -0.00000  -0.00000  -0.00000
  1 C 2pz     -0.39631   0.00000   0.00000  -0.52717  -0.57883
  1 C 3px     -0.00000   0.00000  -0.03031  -0.00000   0.00000
  1 C 3py     -0.00000  -0.03031   0.00000  -0.00000  -0.00000
  1 C 3pz      0.05553  -0.00000  -0.00000  -0.00832   0.03544
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.03648  -0.00000   0.00000   0.00000
  1 C 3dz^2    0.04590   0.00000   0.00000  -0.00531   0.01098
  1 C 3dxz     0.00000  -0.00000  -0.03648   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00092
  0 C 2s       0.00000  -0.00000   0.52568
  0 C 3s      -0.00000   0.00000  -0.04590
  0 C 2px      0.70596  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70596  -0.00000
  0 C 2pz     -0.00000   0.00000   0.46846
  0 C 3px     -0.03238  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.03238   0.00000
  0 C 3pz     -0.00000   0.00000  -0.00204
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02383   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.04579
  0 C 3dxz    -0.02383  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00092
  1 C 2s       0.00000  -0.00000  -0.52568
  1 C 3s       0.00000  -0.00000   0.04590
  1 C 2px     -0.70596   0.00000   0.00000
  1 C 2py      0.00000  -0.70596  -0.00000
  1 C 2pz     -0.00000  -0.00000   0.46846
  1 C 3px      0.03238   0.00000   0.00000
  1 C 3py      0.00000   0.03238   0.00000
  1 C 3pz      0.00000   0.00000  -0.00204
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02383  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04579
  1 C 3dxz    -0.02383  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99576518
<CAS-nat-orb|mo-hf>  4  4    0.99984965
<CAS-nat-orb|mo-hf>  5  5    0.99984965
<CAS-nat-orb|mo-hf>  6  6    0.99869802
<CAS-nat-orb|mo-hf>  7  7    0.98184922
<CAS-nat-orb|mo-hf>  8  8    0.90221124
<CAS-nat-orb|mo-hf>  8  15   -0.42956747
<CAS-nat-orb|mo-hf>  9  9    0.90221131
<CAS-nat-orb|mo-hf>  9  16   -0.42956735
<CAS-nat-orb|mo-hf>  10  10    0.40783679
<CAS-nat-orb|mo-hf>  10  17    0.50741117
<CAS-nat-orb|mo-hf>  10  20   -0.68802314
CASSCF energy = -75.577137223552
CASCI E = -75.577137223552  E(CI) = -18.4770625199534  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.006
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.012

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.5 KB SPT = 0.8634 T =      0.064
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.016
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.018
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.016
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.123
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.05
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 56.2 MB Rmem = 5.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 40.1 MB Rmem =  455 KB T = 0.02
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.02
Time init sweep =        0.284 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.162 | Tfpread = 0.000 | Tfpwrite = 0.158 | data = 74.8 MB | cpsd = 56.5 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.397 | E =     -75.6586355944 | DW = 1.27e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.639 | E =     -75.6798336067 | DE = -2.12e-02 | DW = 4.84e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.673 | E =     -75.6801773449 | DE = -3.44e-04 | DW = 9.82e-05

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.659 | E =     -75.6806306229 | DE = -4.53e-04 | DW = 6.24e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.537 | E =     -75.6806348810 | DE = -4.26e-06 | DW = 1.02e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.589 | E =     -75.6806479958 | DE = -1.31e-05 | DW = 6.32e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.453 | E =     -75.6806483768 | DE = -3.81e-07 | DW = 1.02e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.584 | E =     -75.6806496636 | DE = -1.29e-06 | DW = 6.33e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     10.824 | E =     -75.6812767390 | DE = -6.27e-04 | DW = 8.16e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.318 | E =     -75.6814224808 | DE = -1.46e-04 | DW = 8.85e-06

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     17.690 | E =     -75.6814468993 | DE = -2.44e-05 | DW = 1.68e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     21.186 | E =     -75.6814501930 | DE = -3.29e-06 | DW = 9.75e-06

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.640 | E =     -75.6814509737 | DE = -7.81e-07 | DW = 1.70e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.724 | E =     -75.6814511375 | DE = -1.64e-07 | DW = 9.79e-06

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.293 | E =     -75.6814511747 | DE = -3.72e-08 | DW = 1.70e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.998 | E =     -75.6814512862 | DE = -1.12e-07 | DW = 9.79e-06

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.219 | E =     -75.6815486858 | DE = -9.74e-05 | DW = 1.67e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     49.756 | E =     -75.6815692741 | DE = -2.06e-05 | DW = 8.82e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     60.742 | E =     -75.6815737295 | DE = -4.46e-06 | DW = 2.43e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     71.986 | E =     -75.6815736931 | DE = 3.65e-08 | DW = 9.20e-07

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     81.015 | E =     -75.6815738546 | DE = -1.62e-07 | DW = 2.43e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     90.235 | E =     -75.6815737646 | DE = 9.00e-08 | DW = 9.18e-07

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     99.180 | E =     -75.6815738513 | DE = -8.67e-08 | DW = 2.43e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    109.083 | E =     -75.6815737665 | DE = 8.48e-08 | DW = 9.17e-07

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    127.606 | E =     -75.6815816328 | DE = -7.87e-06 | DW = 1.73e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    151.791 | E =     -75.6815823421 | DE = -7.09e-07 | DW = 6.76e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    184.855 | E =     -75.6815825644 | DE = -2.22e-07 | DW = 1.76e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    237.357 | E =     -75.6815824690 | DE = 9.53e-08 | DW = 6.30e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    268.369 | E =     -75.6815824540 | DE = 1.50e-08 | DW = 1.66e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    296.000 | E =     -75.6815823772 | DE = 7.68e-08 | DW = 5.84e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    321.555 | E =     -75.6815824358 | DE = -5.86e-08 | DW = 1.65e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    348.380 | E =     -75.6815823612 | DE = 7.46e-08 | DW = 5.81e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    389.861 | E =     -75.6815829112 | DE = -5.50e-07 | DW = 3.06e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    418.955 | E =     -75.6815829111 | DE = 2.11e-11 | DW = 3.06e-08

E(MRCI) = -75.68158291113865  E_corr = -0.1044456875866757
Time cost =    486.699
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:47:36 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.137731003478 AA    0.000000000000   0.000000000000   2.150000000000 Bohr   0.0

nuclear repulsion = 16.7441860465116
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     54431.96


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpnjf6aiid
max_memory 4000 MB (current use 5114 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.742346402077

WARN: Singularity detected in overlap matrix (condition number =  905). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.314216447683401  LUMO (Ag) = -0.200692527520578
cycle= 1 E= -75.349511035823  delta_E= 0.393  |g|= 0.183  |ddm|= 1.54
HOMO (B3u) = -0.511968787672978  LUMO (Ag) = -0.131517049931572
cycle= 2 E= -75.361230819294  delta_E= -0.0117  |g|= 0.052  |ddm|= 0.195
HOMO (B2u) = -0.477859245905663  LUMO (Ag) = -0.099664307632512
cycle= 3 E= -75.3620321930707  delta_E= -0.000801  |g|= 0.0118  |ddm|= 0.0834
HOMO (B2u) = -0.480852254510821  LUMO (Ag) = -0.101863987618504
cycle= 4 E= -75.3621184017556  delta_E= -8.62e-05  |g|= 0.00212  |ddm|= 0.0529
HOMO (B3u) = -0.481684500444459  LUMO (Ag) = -0.103214149326984
cycle= 5 E= -75.3621215318461  delta_E= -3.13e-06  |g|= 0.000318  |ddm|= 0.0156
HOMO (B2u) = -0.481600836313231  LUMO (Ag) = -0.103210190493484
cycle= 6 E= -75.3621216003492  delta_E= -6.85e-08  |g|= 2.54e-05  |ddm|= 0.000515
HOMO (B2u) = -0.481601754909294  LUMO (Ag) = -0.103217967965927
cycle= 7 E= -75.3621216006849  delta_E= -3.36e-10  |g|= 2.23e-06  |ddm|= 0.00035
HOMO (B2u) = -0.48160198740666  LUMO (Ag) = -0.10321803452051
cycle= 8 E= -75.3621216006869  delta_E= -2.02e-12  |g|= 1.23e-07  |ddm|= 3.4e-05
HOMO (B2u) = -0.481601999517358  LUMO (Ag) = -0.103218045659584
cycle= 9 E= -75.362121600687  delta_E= -5.68e-14  |g|= 7.62e-09  |ddm|= 3.86e-07
HOMO (B3u) = -0.481601998065172  LUMO (Ag) = -0.103218041944468
cycle= 10 E= -75.3621216006869  delta_E= 8.53e-14  |g|= 7.43e-09  |ddm|= 1.11e-08
HOMO (B3u) = -0.481601999747066  LUMO (Ag) = -0.103218043391464
cycle= 11 E= -75.3621216006869  delta_E=    0  |g|= 6.97e-10  |ddm|= 1.25e-08
HOMO (B3u) = -0.481601999838111  LUMO (Ag) = -0.103218043447817
cycle= 12 E= -75.362121600687  delta_E= -1.14e-13  |g|= 4.94e-10  |ddm|= 2.23e-09
HOMO (B2u) = -0.481601999861622  LUMO (Ag) = -0.103218043480368
cycle= 13 E= -75.362121600687  delta_E= -4.26e-14  |g|= 4.81e-10  |ddm|= 1.52e-09
HOMO (B3u) = -0.481601999857516  LUMO (Ag) = -0.103218043468433
cycle= 14 E= -75.3621216006869  delta_E= 1.28e-13  |g|= 3.93e-10  |ddm|= 6.49e-10
HOMO (B3u) = -0.481601999868634  LUMO (Ag) = -0.103218043468031
cycle= 15 E= -75.362121600687  delta_E= -4.26e-14  |g|= 3.57e-10  |ddm|= 4.22e-10
HOMO (B3u) = -0.481601999841291  LUMO (Ag) = -0.103218043457583
cycle= 16 E= -75.362121600687  delta_E= -1.42e-14  |g|= 3.06e-10  |ddm|= 1.6e-09
HOMO (B3u) = -0.481601999854675  LUMO (Ag) = -0.103218043505538
cycle= 17 E= -75.362121600687  delta_E=    0  |g|= 4.61e-10  |ddm|= 6.95e-10
HOMO (B3u) = -0.481601999903114  LUMO (Ag) = -0.10321804351029
cycle= 18 E= -75.3621216006869  delta_E= 2.84e-14  |g|= 3e-10  |ddm|= 2.69e-10
HOMO (B3u) = -0.481601999880011  LUMO (Ag) = -0.103218043469277
cycle= 19 E= -75.362121600687  delta_E= -2.84e-14  |g|= 8.36e-11  |ddm|= 4.6e-10
HOMO (B3u) = -0.481601999875235  LUMO (Ag) = -0.103218043464456
cycle= 20 E= -75.3621216006869  delta_E= 4.26e-14  |g|= 7.18e-11  |ddm|= 4.74e-11
HOMO (B3u) = -0.481601999874252  LUMO (Ag) = -0.103218043462761
cycle= 21 E= -75.3621216006868  delta_E= 8.53e-14  |g|= 6.31e-11  |ddm|= 1.52e-11
HOMO (B3u) = -0.481601999872586  LUMO (Ag) = -0.103218043459745
cycle= 22 E= -75.3621216006869  delta_E= -9.95e-14  |g|= 5.25e-11  |ddm|= 6.22e-11
HOMO (B3u) = -0.481601999871144  LUMO (Ag) = -0.10321804345745
cycle= 23 E= -75.3621216006869  delta_E= 5.68e-14  |g|= 4.41e-11  |ddm|= 4.14e-11
HOMO (B3u) = -0.481601999869577  LUMO (Ag) = -0.10321804345526
cycle= 24 E= -75.3621216006868  delta_E= 5.68e-14  |g|= 3.87e-11  |ddm|= 5.73e-11
HOMO (B3u) = -0.481601999868688  LUMO (Ag) = -0.103218043453321
cycle= 25 E= -75.3621216006868  delta_E= -1.42e-14  |g|= 3.32e-11  |ddm|= 1.29e-11
HOMO (B3u) = -0.481601999869884  LUMO (Ag) = -0.103218043451912
cycle= 26 E= -75.3621216006868  delta_E= 4.26e-14  |g|= 2.02e-11  |ddm|= 2.44e-11
HOMO (B3u) = -0.481601999871867  LUMO (Ag) = -0.103218043452548
cycle= 27 E= -75.3621216006868  delta_E= -2.84e-14  |g|= 1.42e-11  |ddm|= 1.94e-11
HOMO (B3u) = -0.481601999872069  LUMO (Ag) = -0.103218043452275
cycle= 28 E= -75.3621216006867  delta_E= 8.53e-14  |g|= 1.2e-11  |ddm|= 6.03e-12
HOMO (B3u) = -0.48160199987213  LUMO (Ag) = -0.103218043451906
cycle= 29 E= -75.3621216006868  delta_E= -8.53e-14  |g|= 9.99e-12  |ddm|= 4.15e-12
HOMO (B3u) = -0.481601999872158  LUMO (Ag) = -0.103218043451539
cycle= 30 E= -75.3621216006869  delta_E= -2.84e-14  |g|= 8.16e-12  |ddm|= 7.6e-12
HOMO (B3u) = -0.481601999872179  LUMO (Ag) = -0.103218043451227
cycle= 31 E= -75.3621216006867  delta_E= 1.42e-13  |g|= 7.06e-12  |ddm|= 4.59e-12
HOMO (B3u) = -0.481601999872188  LUMO (Ag) = -0.103218043450944
cycle= 32 E= -75.3621216006861  delta_E= 6.25e-13  |g|= 1.32e-11  |ddm|= 2.1e-12
HOMO (B3u) = -0.481601999872164  LUMO (Ag) = -0.103218043450707
cycle= 33 E= -75.362121600686  delta_E= 5.68e-14  |g|= 1.18e-11  |ddm|= 1.99e-11
HOMO (B3u) = -0.48160199987211  LUMO (Ag) = -0.10321804345049
cycle= 34 E= -75.362121600686  delta_E= 8.53e-14  |g|= 1.06e-11  |ddm|= 1.94e-11
HOMO (B3u) = -0.481601999872017  LUMO (Ag) = -0.10321804345032
cycle= 35 E= -75.3621216006859  delta_E= 5.68e-14  |g|= 9.41e-12  |ddm|= 2.06e-11
HOMO (B3u) = -0.481601999871938  LUMO (Ag) = -0.103218043450183
cycle= 36 E= -75.362121600686  delta_E= -1.28e-13  |g|= 8.13e-12  |ddm|= 2.19e-11
HOMO (B3u) = -0.481601999871862  LUMO (Ag) = -0.103218043450047
cycle= 37 E= -75.362121600686  delta_E= 1.42e-14  |g|= 6.76e-12  |ddm|= 2.37e-11
HOMO (B3u) = -0.481601999871783  LUMO (Ag) = -0.103218043449911
cycle= 38 E= -75.362121600686  delta_E= -1.42e-14  |g|= 5.42e-12  |ddm|= 2.32e-11
HOMO (B3u) = -0.481601999871699  LUMO (Ag) = -0.10321804344979
cycle= 39 E= -75.3621216006861  delta_E= -4.26e-14  |g|= 4.06e-12  |ddm|= 2.4e-11
HOMO (B2u) = -0.481601999871612  LUMO (Ag) = -0.103218043449676
cycle= 40 E= -75.362121600686  delta_E= 8.53e-14  |g|= 2.8e-12  |ddm|= 2.61e-11
HOMO (B2u) = -0.481601999871557  LUMO (Ag) = -0.103218043449563
cycle= 41 E= -75.3621216006861  delta_E= -1.14e-13  |g|= 2.14e-12  |ddm|= 4.58e-12
HOMO (B2u) = -0.481601999871507  LUMO (Ag) = -0.103218043449458
cycle= 42 E= -75.3621216006858  delta_E= 2.98e-13  |g|= 2.96e-12  |ddm|= 2.7e-12
HOMO (B3u) = -0.481601999871449  LUMO (Ag) = -0.103218043449375
cycle= 43 E= -75.3621216006849  delta_E= 8.95e-13  |g|= 5.55e-12  |ddm|= 7.95e-13
HOMO (B3u) = -0.48160199987137  LUMO (Ag) = -0.103218043449289
cycle= 44 E= -75.362121600685  delta_E= -7.11e-14  |g|= 6.15e-12  |ddm|= 8.06e-12
HOMO (B3u) = -0.481601999871295  LUMO (Ag) = -0.103218043449218
cycle= 45 E= -75.3621216006849  delta_E= 7.11e-14  |g|= 5.73e-12  |ddm|= 1.08e-11
HOMO (B3u) = -0.481601999871223  LUMO (Ag) = -0.103218043449153
cycle= 46 E= -75.3621216006848  delta_E= 8.53e-14  |g|= 5.34e-12  |ddm|= 1.08e-11
HOMO (B3u) = -0.481601999871152  LUMO (Ag) = -0.103218043449094
cycle= 47 E= -75.3621216006848  delta_E= 2.84e-14  |g|= 4.77e-12  |ddm|= 1.09e-11
HOMO (B3u) = -0.481601999871083  LUMO (Ag) = -0.103218043449039
cycle= 48 E= -75.3621216006846  delta_E= 1.85e-13  |g|= 4.49e-12  |ddm|= 1.06e-11
HOMO (B2u) = -0.481601999871017  LUMO (Ag) = -0.103218043448988
cycle= 49 E= -75.3621216006845  delta_E= 5.68e-14  |g|= 4.02e-12  |ddm|= 1.08e-11
HOMO (B3u) = -0.481601999870948  LUMO (Ag) = -0.103218043448941
cycle= 50 E= -75.3621216006844  delta_E= 9.95e-14  |g|= 3.77e-12  |ddm|= 1.23e-11
SCF not converged.
SCF energy = -75.3621216006844

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpnjf6aiid
max_memory 4000 MB (current use 5114 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5214099234482  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5403499364107  dE = -0.018940013  S^2 = 0.0000000
               |grad[o]|=0.142  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5566891541988  dE = -0.016339218  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.046  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5664484579379  dE = -0.0097593037  S^2 = 0.0000000
               |grad[o]|=0.091  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.573007274573  dE = -0.0065588166  S^2 = 0.0000000
               |grad[o]|=0.0715  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.57821068675  dE = -0.0052034122  S^2 = 0.0000000
               |grad[o]|=0.0576  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5825630314943  dE = -0.0043523447  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.0031  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5861976368086  dE = -0.0036346053  S^2 = 0.0000000
               |grad[o]|=0.0372  |ddm|=0.00245  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5891318419559  dE = -0.0029342051  S^2 = 0.0000000
               |grad[o]|=0.0289  |ddm|=0.00251  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.591343792253  dE = -0.0022119503  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.5928024617205  dE = -0.0014586695  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.00328  |maxRot[o]|=0.0798
macro iter 11 (6 JK  0 micro), CASSCF E = -75.5934806911901  dE = -0.00067822947  S^2 = 0.0000000
               |grad[o]|=0.00812  |ddm|=0.00368  |maxRot[o]|=0.0798
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5935226099424  dE = -4.1918752e-05  S^2 = 0.0000000
               |grad[o]|=0.00228  |ddm|=0.00417  |maxRot[o]|= 0.02
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5935273558622  dE = -4.7459197e-06  S^2 = 0.0000000
               |grad[o]|=0.000866  |ddm|=0.00146  |maxRot[o]|=0.00833
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5935274551923  dE = -9.9330137e-08  S^2 = 0.0000000
               |grad[o]|=0.000176  |ddm|=0.000808  |maxRot[o]|=0.00113
macro iter 15 (4 JK  0 micro), CASSCF E = -75.5935274594477  dE = -4.2553694e-09  S^2 = 0.0000000
               |grad[o]|=4.32e-05  |ddm|=0.000207  |maxRot[o]|=0.000162
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5935274595321  dE = -8.4483531e-11  S^2 = 0.0000000
               |grad[o]|=7.59e-06  |ddm|=4.06e-05  |maxRot[o]|=2.8e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5935274595338  dE = -1.6200374e-12  S^2 = 0.0000000
               |grad[o]|=1.3e-06  |ddm|=5.01e-06  |maxRot[o]|=4.99e-06
2-step CASSCF converged in 17 macro (84 JK 17 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98720391 1.53562802 1.91537967 1.91537961 0.46035066 0.08778182
 0.08778176 0.01049456]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00194   0.00231   0.00000   0.00000  -0.00179
  0 C 2s       0.58123   0.48048  -0.00000  -0.00000  -0.39956
  0 C 3s      -0.05483   0.00943  -0.00000  -0.00000  -0.02456
  0 C 2px      0.00000   0.00000   0.00000   0.70574   0.00000
  0 C 2py      0.00000  -0.00000   0.70574   0.00000   0.00000
  0 C 2pz      0.39276  -0.51862   0.00000  -0.00000   0.58162
  0 C 3px      0.00000   0.00000  -0.00000  -0.02575   0.00000
  0 C 3py     -0.00000   0.00000  -0.02575  -0.00000   0.00000
  0 C 3pz     -0.05404  -0.00761  -0.00000  -0.00000  -0.03659
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.03555  -0.00000   0.00000
  0 C 3dz^2    0.04451   0.00457  -0.00000  -0.00000   0.01083
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03555   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00194  -0.00231   0.00000   0.00000  -0.00179
  1 C 2s       0.58123  -0.48048   0.00000   0.00000  -0.39956
  1 C 3s      -0.05483  -0.00943   0.00000   0.00000  -0.02456
  1 C 2px      0.00000  -0.00000   0.00000   0.70574  -0.00000
  1 C 2py      0.00000  -0.00000   0.70574   0.00000  -0.00000
  1 C 2pz     -0.39276  -0.51862  -0.00000  -0.00000  -0.58162
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.02575  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02575  -0.00000  -0.00000
  1 C 3pz      0.05404  -0.00761  -0.00000  -0.00000   0.03659
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03555   0.00000   0.00000
  1 C 3dz^2    0.04451  -0.00457   0.00000   0.00000   0.01083
  1 C 3dxz     0.00000   0.00000   0.00000  -0.03555   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00088
  0 C 2s      -0.00000  -0.00000   0.51738
  0 C 3s      -0.00000  -0.00000  -0.04498
  0 C 2px      0.70604   0.00000  -0.00000
  0 C 2py      0.00000   0.70604  -0.00000
  0 C 2pz     -0.00000   0.00000   0.47816
  0 C 3px     -0.03061   0.00000  -0.00000
  0 C 3py      0.00000  -0.03061  -0.00000
  0 C 3pz     -0.00000   0.00000   0.00024
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.04072
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00088
  1 C 2s       0.00000  -0.00000  -0.51738
  1 C 3s       0.00000   0.00000   0.04498
  1 C 2px     -0.70604  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70604   0.00000
  1 C 2pz     -0.00000  -0.00000   0.47816
  1 C 3px      0.03061  -0.00000   0.00000
  1 C 3py     -0.00000   0.03061   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00024
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.04072
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99556549
<CAS-nat-orb|mo-hf>  4  4    0.99868711
<CAS-nat-orb|mo-hf>  5  5    0.99984158
<CAS-nat-orb|mo-hf>  6  6    0.99984158
<CAS-nat-orb|mo-hf>  7  7    0.98128495
<CAS-nat-orb|mo-hf>  8  8    0.91006597
<CAS-nat-orb|mo-hf>  8  15   -0.41306114
<CAS-nat-orb|mo-hf>  9  9    0.91006599
<CAS-nat-orb|mo-hf>  9  16   -0.41306111
<CAS-nat-orb|mo-hf>  10  10    0.41868609
<CAS-nat-orb|mo-hf>  10  17    0.53963873
<CAS-nat-orb|mo-hf>  10  20   -0.66337408
CASSCF energy = -75.5935274595338
CASCI E = -75.5935274595338  E(CI) = -18.3163035050599  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.339
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.099
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.666

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.029
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.5 KB SPT = 0.8635 T =      0.636
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.729
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.722
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.727
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.326
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.323
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.528
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.10
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.11
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.09
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.576 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.282 | Tfpread = 0.000 | Tfpwrite = 0.280 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.842 | E =     -75.6752942115 | DW = 1.35e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.608 | E =     -75.6964639379 | DE = -2.12e-02 | DW = 5.19e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.625 | E =     -75.6968193125 | DE = -3.55e-04 | DW = 1.05e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.255 | E =     -75.6972875008 | DE = -4.68e-04 | DW = 6.68e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.040 | E =     -75.6972874588 | DE = 4.21e-08 | DW = 1.09e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     23.780 | E =     -75.6973145000 | DE = -2.70e-05 | DW = 6.76e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     26.627 | E =     -75.6973135458 | DE = 9.54e-07 | DW = 1.10e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     29.343 | E =     -75.6973162978 | DE = -2.75e-06 | DW = 6.76e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.952 | E =     -75.6979800451 | DE = -6.64e-04 | DW = 8.91e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.627 | E =     -75.6981354157 | DE = -1.55e-04 | DW = 9.73e-06

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.933 | E =     -75.6981623405 | DE = -2.69e-05 | DW = 1.83e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     44.502 | E =     -75.6981654736 | DE = -3.13e-06 | DW = 1.06e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     48.709 | E =     -75.6981669511 | DE = -1.48e-06 | DW = 1.84e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.542 | E =     -75.6981672953 | DE = -3.44e-07 | DW = 1.07e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.015 | E =     -75.6981673452 | DE = -4.99e-08 | DW = 1.85e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     59.617 | E =     -75.6981673883 | DE = -4.31e-08 | DW = 1.07e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     67.323 | E =     -75.6982678626 | DE = -1.00e-04 | DW = 1.78e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     78.482 | E =     -75.6982891247 | DE = -2.13e-05 | DW = 9.34e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     89.970 | E =     -75.6982936033 | DE = -4.48e-06 | DW = 2.59e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    101.413 | E =     -75.6982935799 | DE = 2.34e-08 | DW = 9.72e-07

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.882 | E =     -75.6982936807 | DE = -1.01e-07 | DW = 2.58e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    124.238 | E =     -75.6982936489 | DE = 3.18e-08 | DW = 9.73e-07

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    134.646 | E =     -75.6982936758 | DE = -2.69e-08 | DW = 2.58e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    146.453 | E =     -75.6982936582 | DE = 1.76e-08 | DW = 9.73e-07

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    169.150 | E =     -75.6983019880 | DE = -8.33e-06 | DW = 1.84e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    195.492 | E =     -75.6983026693 | DE = -6.81e-07 | DW = 7.25e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    221.453 | E =     -75.6983028492 | DE = -1.80e-07 | DW = 1.80e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    248.532 | E =     -75.6983027477 | DE = 1.02e-07 | DW = 6.41e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    274.168 | E =     -75.6983027755 | DE = -2.78e-08 | DW = 1.73e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    301.505 | E =     -75.6983026956 | DE = 7.99e-08 | DW = 6.24e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    328.190 | E =     -75.6983027709 | DE = -7.54e-08 | DW = 1.73e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    355.778 | E =     -75.6983026911 | DE = 7.98e-08 | DW = 6.23e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    399.739 | E =     -75.6983032756 | DE = -5.84e-07 | DW = 3.26e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    431.984 | E =     -75.6983032755 | DE = 2.64e-11 | DW = 3.26e-08

E(MRCI) = -75.69830327554996  E_corr = -0.1047758160162005
Time cost =    663.856
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 15:58:40 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.164189864024 AA    0.000000000000   0.000000000000   2.200000000000 Bohr   0.0

nuclear repulsion = 16.3636363636364
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.1]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     62453.80


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpbq13td96
max_memory 4000 MB (current use 5131 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6850211082767

WARN: Singularity detected in overlap matrix (condition number =  823). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.300635738182937  LUMO (Ag) = -0.196894745039133
cycle= 1 E= -75.3600714434763  delta_E= 0.325  |g|= 0.186  |ddm|= 1.52
HOMO (B3u) = -0.505767689307348  LUMO (Ag) = -0.134850139116738
cycle= 2 E= -75.3722557388854  delta_E= -0.0122  |g|= 0.0519  |ddm|= 0.201
HOMO (B3u) = -0.471042686025419  LUMO (Ag) = -0.101583923798027
cycle= 3 E= -75.3730472275437  delta_E= -0.000791  |g|= 0.011  |ddm|= 0.0769
HOMO (B3u) = -0.473583831878466  LUMO (Ag) = -0.10306443620941
cycle= 4 E= -75.3731222408076  delta_E= -7.5e-05  |g|= 0.00204  |ddm|= 0.0475
HOMO (B2u) = -0.474409949766166  LUMO (Ag) = -0.104308159498409
cycle= 5 E= -75.3731251255  delta_E= -2.88e-06  |g|= 0.000283  |ddm|= 0.0148
HOMO (B2u) = -0.474348151042956  LUMO (Ag) = -0.104322379442281
cycle= 6 E= -75.3731251811964  delta_E= -5.57e-08  |g|= 2.51e-05  |ddm|= 0.000586
HOMO (B2u) = -0.474349388268691  LUMO (Ag) = -0.10433076431711
cycle= 7 E= -75.3731251815252  delta_E= -3.29e-10  |g|= 2.41e-06  |ddm|= 0.000311
HOMO (B2u) = -0.474349685667056  LUMO (Ag) = -0.104330912577451
cycle= 8 E= -75.3731251815275  delta_E= -2.25e-12  |g|= 1.4e-07  |ddm|= 3.41e-05
HOMO (B2u) = -0.474349699393743  LUMO (Ag) = -0.104330922331009
cycle= 9 E= -75.3731251815274  delta_E= 5.68e-14  |g|= 8.38e-09  |ddm|= 2.86e-07
HOMO (B2u) = -0.474349697428499  LUMO (Ag) = -0.104330918023848
cycle= 10 E= -75.3731251815275  delta_E= -5.68e-14  |g|= 7.66e-09  |ddm|= 1.05e-08
HOMO (B2u) = -0.474349699485501  LUMO (Ag) = -0.104330919909221
cycle= 11 E= -75.3731251815275  delta_E= 1.42e-14  |g|= 7.73e-10  |ddm|= 1.38e-08
HOMO (B2u) = -0.474349699588805  LUMO (Ag) = -0.104330919969954
cycle= 12 E= -75.3731251815275  delta_E=    0  |g|= 5.7e-10  |ddm|= 2.3e-09
HOMO (B2u) = -0.474349699607499  LUMO (Ag) = -0.10433092000694
cycle= 13 E= -75.3731251815274  delta_E= 9.95e-14  |g|= 5.32e-10  |ddm|= 8.58e-10
HOMO (B2u) = -0.474349699605719  LUMO (Ag) = -0.10433091999043
cycle= 14 E= -75.3731251815274  delta_E= -7.11e-14  |g|= 4.47e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.474349699620655  LUMO (Ag) = -0.104330919983788
cycle= 15 E= -75.3731251815275  delta_E= -2.84e-14  |g|= 4.06e-10  |ddm|= 4.6e-10
HOMO (B2u) = -0.474349699583949  LUMO (Ag) = -0.104330919972241
cycle= 16 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 3.48e-10  |ddm|= 1.48e-09
HOMO (B2u) = -0.474349699580121  LUMO (Ag) = -0.104330920005606
cycle= 17 E= -75.3731251815274  delta_E= 1.42e-14  |g|= 4.94e-10  |ddm|= 6.8e-10
HOMO (B2u) = -0.474349699624135  LUMO (Ag) = -0.104330920003903
cycle= 18 E= -75.3731251815274  delta_E= -1.42e-14  |g|= 3.15e-10  |ddm|= 3.54e-10
HOMO (B2u) = -0.474349699596378  LUMO (Ag) = -0.104330919959424
cycle= 19 E= -75.3731251815274  delta_E= 4.26e-14  |g|= 9.43e-11  |ddm|= 6.37e-10
HOMO (B2u) = -0.474349699592277  LUMO (Ag) = -0.104330919954833
cycle= 20 E= -75.3731251815274  delta_E= -5.68e-14  |g|= 8.1e-11  |ddm|= 4.64e-11
HOMO (B2u) = -0.474349699592258  LUMO (Ag) = -0.104330919953748
cycle= 21 E= -75.3731251815274  delta_E= 4.26e-14  |g|= 7.05e-11  |ddm|= 2.04e-11
HOMO (B2u) = -0.474349699592227  LUMO (Ag) = -0.104330919951833
cycle= 22 E= -75.3731251815274  delta_E= 2.84e-14  |g|= 5.81e-11  |ddm|= 3.82e-11
HOMO (B2u) = -0.474349699591773  LUMO (Ag) = -0.104330919950036
cycle= 23 E= -75.3731251815273  delta_E= 5.68e-14  |g|= 4.86e-11  |ddm|= 4.31e-11
HOMO (B2u) = -0.474349699590991  LUMO (Ag) = -0.104330919948648
cycle= 24 E= -75.3731251815273  delta_E= 1.42e-14  |g|= 4.27e-11  |ddm|= 5.87e-11
HOMO (B2u) = -0.474349699590779  LUMO (Ag) = -0.104330919947174
cycle= 25 E= -75.3731251815274  delta_E= -1.42e-13  |g|= 3.59e-11  |ddm|= 1.55e-11
HOMO (B2u) = -0.474349699592248  LUMO (Ag) = -0.104330919945934
cycle= 26 E= -75.3731251815274  delta_E= 8.53e-14  |g|= 2.2e-11  |ddm|= 2.96e-11
HOMO (B3u) = -0.474349699594309  LUMO (Ag) = -0.104330919946681
cycle= 27 E= -75.3731251815273  delta_E= 2.84e-14  |g|= 1.58e-11  |ddm|= 2.28e-11
HOMO (B2u) = -0.474349699594338  LUMO (Ag) = -0.104330919946224
cycle= 28 E= -75.3731251815273  delta_E= 2.84e-14  |g|= 1.34e-11  |ddm|= 8.93e-12
HOMO (B3u) = -0.474349699594257  LUMO (Ag) = -0.104330919945706
cycle= 29 E= -75.3731251815273  delta_E= 4.26e-14  |g|= 1.13e-11  |ddm|= 7.48e-12
HOMO (B3u) = -0.474349699594182  LUMO (Ag) = -0.104330919945233
cycle= 30 E= -75.3731251815273  delta_E= -4.26e-14  |g|= 9.35e-12  |ddm|= 6.81e-12
HOMO (B3u) = -0.474349699594127  LUMO (Ag) = -0.104330919944857
cycle= 31 E= -75.373125181527  delta_E= 2.56e-13  |g|= 8.63e-12  |ddm|= 4.23e-12
HOMO (B3u) = -0.474349699594087  LUMO (Ag) = -0.104330919944582
cycle= 32 E= -75.3731251815264  delta_E= 6.54e-13  |g|= 1.07e-11  |ddm|= 2.83e-12
HOMO (B3u) = -0.474349699594064  LUMO (Ag) = -0.104330919944358
cycle= 33 E= -75.3731251815264  delta_E= -2.84e-14  |g|= 9.14e-12  |ddm|= 7.85e-12
HOMO (B3u) = -0.474349699594037  LUMO (Ag) = -0.104330919944187
cycle= 34 E= -75.3731251815264  delta_E= 5.68e-14  |g|= 8.1e-12  |ddm|= 6.14e-12
HOMO (B3u) = -0.474349699593978  LUMO (Ag) = -0.104330919944084
cycle= 35 E= -75.3731251815262  delta_E= 1.28e-13  |g|= 7.11e-12  |ddm|= 6.03e-12
HOMO (B3u) = -0.474349699593936  LUMO (Ag) = -0.104330919944015
cycle= 36 E= -75.3731251815262  delta_E= 1.42e-14  |g|= 6.34e-12  |ddm|= 4.73e-12
HOMO (B3u) = -0.474349699593891  LUMO (Ag) = -0.104330919943949
cycle= 37 E= -75.3731251815264  delta_E= -1.42e-13  |g|= 5.54e-12  |ddm|= 4.68e-12
HOMO (B3u) = -0.474349699593843  LUMO (Ag) = -0.104330919943894
cycle= 38 E= -75.3731251815263  delta_E= 8.53e-14  |g|= 4.97e-12  |ddm|= 4.18e-12
HOMO (B3u) = -0.474349699593787  LUMO (Ag) = -0.104330919943837
cycle= 39 E= -75.3731251815258  delta_E= 4.83e-13  |g|= 4.86e-12  |ddm|= 3.41e-12
HOMO (B3u) = -0.474349699593711  LUMO (Ag) = -0.104330919943762
cycle= 40 E= -75.3731251815259  delta_E= -1.14e-13  |g|= 3.7e-12  |ddm|= 6.34e-12
HOMO (B3u) = -0.474349699593655  LUMO (Ag) = -0.104330919943694
cycle= 41 E= -75.3731251815257  delta_E= 1.71e-13  |g|= 3.75e-12  |ddm|= 3.32e-12
HOMO (B3u) = -0.474349699593592  LUMO (Ag) = -0.10433091994362
cycle= 42 E= -75.3731251815255  delta_E= 2.13e-13  |g|= 4.52e-12  |ddm|= 3.85e-12
HOMO (B3u) = -0.47434969959353  LUMO (Ag) = -0.10433091994354
cycle= 43 E= -75.3731251815254  delta_E= 1.56e-13  |g|= 4.83e-12  |ddm|= 7.56e-12
HOMO (B3u) = -0.47434969959347  LUMO (Ag) = -0.10433091994346
cycle= 44 E= -75.3731251815252  delta_E= 2.13e-13  |g|= 5.3e-12  |ddm|= 7.57e-12
HOMO (B3u) = -0.474349699593413  LUMO (Ag) = -0.104330919943384
cycle= 45 E= -75.3731251815252  delta_E= -7.11e-14  |g|= 4.63e-12  |ddm|= 9.99e-12
HOMO (B3u) = -0.474349699593361  LUMO (Ag) = -0.104330919943311
cycle= 46 E= -75.3731251815251  delta_E= 8.53e-14  |g|= 4.08e-12  |ddm|= 9.52e-12
HOMO (B3u) = -0.474349699593324  LUMO (Ag) = -0.10433091994325
cycle= 47 E= -75.3731251815249  delta_E= 2.56e-13  |g|= 4.46e-12  |ddm|= 8.39e-12
HOMO (B3u) = -0.47434969959331  LUMO (Ag) = -0.104330919943193
cycle= 48 E= -75.3731251815249  delta_E=    0  |g|= 3.76e-12  |ddm|= 1.11e-11
HOMO (B3u) = -0.474349699593382  LUMO (Ag) = -0.104330919943144
Extra cycle  E= -75.3731251815247  delta_E= 1.56e-13  |g|= 7.97e-13  |ddm|= 4.54e-11
converged SCF energy = -75.3731251815247

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpbq13td96
max_memory 4000 MB (current use 5131 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.53406922644  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5535870028287  dE = -0.019517776  S^2 = 0.0000000
               |grad[o]|=0.143  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5700693269253  dE = -0.016482324  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0484  |maxRot[o]|=0.0784
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5795436432117  dE = -0.0094743163  S^2 = 0.0000000
               |grad[o]|=0.0899  |ddm|=0.0297  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5861233810653  dE = -0.0065797379  S^2 = 0.0000000
               |grad[o]|=0.0707  |ddm|=0.011  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5914066871017  dE = -0.005283306  S^2 = 0.0000000
               |grad[o]|=0.0568  |ddm|=0.00536  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5958184636737  dE = -0.0044117766  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=0.00348  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5994546486858  dE = -0.003636185  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00287  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6023099683175  dE = -0.0028553196  S^2 = 0.0000000
               |grad[o]|=0.0272  |ddm|=0.00296  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043446411872  dE = -0.0020346729  S^2 = 0.0000000
               |grad[o]|=0.0193  |ddm|=0.00333  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6054817673888  dE = -0.0011371262  S^2 = 0.0000000
               |grad[o]|=0.012  |ddm|=0.00374  |maxRot[o]|=0.0798
macro iter 11 (5 JK  0 micro), CASSCF E = -75.605791425092  dE = -0.0003096577  S^2 = 0.0000000
               |grad[o]|=0.00551  |ddm|=0.00398  |maxRot[o]|=0.0599
macro iter 12 (3 JK  0 micro), CASSCF E = -75.605804070647  dE = -1.2645555e-05  S^2 = 0.0000000
               |grad[o]|=0.00133  |ddm|=0.00326  |maxRot[o]|=0.0137
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6058043166793  dE = -2.460323e-07  S^2 = 0.0000000
               |grad[o]|=0.000277  |ddm|=0.00116  |maxRot[o]|=0.00176
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6058043246967  dE = -8.0173947e-09  S^2 = 0.0000000
               |grad[o]|=5.71e-05  |ddm|=0.000304  |maxRot[o]|=0.000262
macro iter 15 (3 JK  0 micro), CASSCF E = -75.605804325139  dE = -4.4232706e-10  S^2 = 0.0000000
               |grad[o]|=2.04e-05  |ddm|=6.86e-05  |maxRot[o]|=4.92e-05
macro iter 16 (3 JK  0 micro), CASSCF E = -75.6058043251496  dE = -1.0572876e-11  S^2 = 0.0000000
               |grad[o]|=2.88e-06  |ddm|=1.05e-05  |maxRot[o]|=6.21e-06
2-step CASSCF converged in 16 macro (80 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98650078 1.5529     1.90980632 1.90980663 0.44288892 0.09346229
 0.0934622  0.01117286]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00235   0.00241   0.00000   0.00000  -0.00166
  0 C 2s       0.58410   0.48964  -0.00000  -0.00000  -0.39544
  0 C 3s      -0.05356   0.00927  -0.00000  -0.00000  -0.02152
  0 C 2px     -0.00000   0.00000   0.00000   0.70593   0.00000
  0 C 2py      0.00000  -0.00000   0.70593  -0.00000  -0.00000
  0 C 2pz      0.38903  -0.51000   0.00000  -0.00000   0.58448
  0 C 3px     -0.00000   0.00000   0.00000  -0.02144   0.00000
  0 C 3py      0.00000  -0.00000  -0.02144  -0.00000  -0.00000
  0 C 3pz     -0.05250  -0.00695  -0.00000  -0.00000  -0.03768
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03464  -0.00000  -0.00000
  0 C 3dz^2    0.04312   0.00386  -0.00000  -0.00000   0.01086
  0 C 3dxz    -0.00000   0.00000   0.00000   0.03464   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00235  -0.00241   0.00000   0.00000  -0.00166
  1 C 2s       0.58410  -0.48964   0.00000   0.00000  -0.39544
  1 C 3s      -0.05356  -0.00927   0.00000   0.00000  -0.02152
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70593  -0.00000
  1 C 2py      0.00000   0.00000   0.70593   0.00000   0.00000
  1 C 2pz     -0.38903  -0.51000   0.00000  -0.00000  -0.58448
  1 C 3px      0.00000  -0.00000  -0.00000  -0.02144  -0.00000
  1 C 3py     -0.00000   0.00000  -0.02144   0.00000   0.00000
  1 C 3pz      0.05250  -0.00695  -0.00000  -0.00000   0.03768
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03464  -0.00000  -0.00000
  1 C 3dz^2    0.04312  -0.00386   0.00000   0.00000   0.01086
  1 C 3dxz    -0.00000   0.00000   0.00000  -0.03464   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00084
  0 C 2s      -0.00000  -0.00000   0.50895
  0 C 3s      -0.00000  -0.00000  -0.04424
  0 C 2px      0.70611   0.00000  -0.00000
  0 C 2py      0.00000   0.70611  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.48752
  0 C 3px     -0.02900   0.00000  -0.00000
  0 C 3py      0.00000  -0.02900  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00249
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02384  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03651
  0 C 3dxz    -0.02384   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00084
  1 C 2s       0.00000   0.00000  -0.50895
  1 C 3s       0.00000   0.00000   0.04424
  1 C 2px     -0.70611  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70611   0.00000
  1 C 2pz     -0.00000   0.00000   0.48752
  1 C 3px      0.02900  -0.00000   0.00000
  1 C 3py     -0.00000   0.02900   0.00000
  1 C 3pz     -0.00000  -0.00000   0.00249
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02384  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.03651
  1 C 3dxz    -0.02384   0.00000  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99534813
<CAS-nat-orb|mo-hf>  4  4    0.99866563
<CAS-nat-orb|mo-hf>  5  5    0.99983126
<CAS-nat-orb|mo-hf>  6  6    0.99983126
<CAS-nat-orb|mo-hf>  7  7    0.98071670
<CAS-nat-orb|mo-hf>  8  8    0.91723383
<CAS-nat-orb|mo-hf>  9  9    0.91723388
<CAS-nat-orb|mo-hf>  10  10    0.43078380
<CAS-nat-orb|mo-hf>  10  17    0.57019896
<CAS-nat-orb|mo-hf>  10  20   -0.63691825
CASSCF energy = -75.6058043251496
CASCI E = -75.6058043251496  E(CI) = -18.1594673126169  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.339
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.101
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.665

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.031
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.6 KB SPT = 0.8633 T =      0.649
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.829
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.977
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.122
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.012
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.013
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      7.612
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.251 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.142 | Tfpread = 0.000 | Tfpwrite = 0.138 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.374 | E =     -75.6892036489 | DW = 1.39e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.856 | E =     -75.7090567960 | DE = -1.99e-02 | DW = 5.65e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.683 | E =     -75.7094433136 | DE = -3.87e-04 | DW = 1.12e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.571 | E =     -75.7098667009 | DE = -4.23e-04 | DW = 7.24e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.425 | E =     -75.7098651089 | DE = 1.59e-06 | DW = 1.15e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.389 | E =     -75.7098738815 | DE = -8.77e-06 | DW = 7.28e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.514 | E =     -75.7098712247 | DE = 2.66e-06 | DW = 1.15e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.431 | E =     -75.7098738160 | DE = -2.59e-06 | DW = 7.28e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     10.536 | E =     -75.7105673142 | DE = -6.93e-04 | DW = 9.39e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     13.961 | E =     -75.7107314877 | DE = -1.64e-04 | DW = 1.06e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     16.909 | E =     -75.7107610896 | DE = -2.96e-05 | DW = 1.95e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     19.950 | E =     -75.7107648383 | DE = -3.75e-06 | DW = 1.16e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     22.866 | E =     -75.7107655780 | DE = -7.40e-07 | DW = 1.97e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.254 | E =     -75.7107657612 | DE = -1.83e-07 | DW = 1.16e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.174 | E =     -75.7107656795 | DE = 8.17e-08 | DW = 1.96e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.874 | E =     -75.7107659213 | DE = -2.42e-07 | DW = 1.16e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.899 | E =     -75.7108697274 | DE = -1.04e-04 | DW = 1.85e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     53.961 | E =     -75.7108917706 | DE = -2.20e-05 | DW = 9.70e-07

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     66.513 | E =     -75.7108964921 | DE = -4.72e-06 | DW = 2.70e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     78.269 | E =     -75.7108964834 | DE = 8.74e-09 | DW = 1.01e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     87.682 | E =     -75.7108966056 | DE = -1.22e-07 | DW = 2.69e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     99.246 | E =     -75.7108965540 | DE = 5.16e-08 | DW = 1.01e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    120.222 | E =     -75.7108965362 | DE = 1.78e-08 | DW = 2.68e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    132.782 | E =     -75.7108965147 | DE = 2.15e-08 | DW = 1.01e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    154.556 | E =     -75.7109051457 | DE = -8.63e-06 | DW = 1.90e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    184.421 | E =     -75.7109058834 | DE = -7.38e-07 | DW = 7.54e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    210.644 | E =     -75.7109060546 | DE = -1.71e-07 | DW = 1.84e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    236.944 | E =     -75.7109059480 | DE = 1.07e-07 | DW = 6.57e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    263.003 | E =     -75.7109059828 | DE = -3.48e-08 | DW = 1.78e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    296.558 | E =     -75.7109058973 | DE = 8.55e-08 | DW = 6.44e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    321.886 | E =     -75.7109059780 | DE = -8.07e-08 | DW = 1.78e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    355.010 | E =     -75.7109058928 | DE = 8.52e-08 | DW = 6.43e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    395.947 | E =     -75.7109065230 | DE = -6.30e-07 | DW = 3.48e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    427.023 | E =     -75.7109065230 | DE = 3.11e-11 | DW = 3.48e-08

E(MRCI) = -75.71090652295769  E_corr = -0.1051021978080655
Time cost =    554.589
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:07:55 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.190648724570 AA    0.000000000000   0.000000000000   2.250000000000 Bohr   0.0

nuclear repulsion = 16
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.125]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     70214.39


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmphos19zc5
max_memory 4000 MB (current use 5091 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.6287133444179

WARN: Singularity detected in overlap matrix (condition number =  749). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.2878011472914  LUMO (Ag) = -0.193295779361717
cycle= 1 E= -75.3670366286219  delta_E= 0.262  |g|= 0.19  |ddm|= 1.51
HOMO (B3u) = -0.499807889396643  LUMO (Ag) = -0.137862572577772
cycle= 2 E= -75.3797482358211  delta_E= -0.0127  |g|= 0.0519  |ddm|= 0.208
HOMO (B3u) = -0.46454022619521  LUMO (Ag) = -0.103237375699653
cycle= 3 E= -75.3805383397255  delta_E= -0.00079  |g|= 0.0104  |ddm|= 0.0716
HOMO (B3u) = -0.466699997579168  LUMO (Ag) = -0.104062742035947
cycle= 4 E= -75.3806041774367  delta_E= -6.58e-05  |g|= 0.00196  |ddm|= 0.0425
HOMO (B3u) = -0.467507612863157  LUMO (Ag) = -0.105181483870832
cycle= 5 E= -75.3806067875641  delta_E= -2.61e-06  |g|= 0.00024  |ddm|= 0.0138
HOMO (B3u) = -0.467469009904277  LUMO (Ag) = -0.105209990979466
cycle= 6 E= -75.3806068286268  delta_E= -4.11e-08  |g|= 2.47e-05  |ddm|= 0.000855
HOMO (B3u) = -0.467470595918401  LUMO (Ag) = -0.105219180794845
cycle= 7 E= -75.3806068289548  delta_E= -3.28e-10  |g|= 2.6e-06  |ddm|= 0.000264
HOMO (B3u) = -0.467470958375022  LUMO (Ag) = -0.105219406231852
cycle= 8 E= -75.3806068289575  delta_E= -2.73e-12  |g|= 1.64e-07  |ddm|= 3.35e-05
HOMO (B3u) = -0.467470973641787  LUMO (Ag) = -0.105219414001834
cycle= 9 E= -75.3806068289574  delta_E= 8.53e-14  |g|= 9.4e-09  |ddm|= 3.15e-07
HOMO (B3u) = -0.467470971058692  LUMO (Ag) = -0.105219408947957
cycle= 10 E= -75.3806068289575  delta_E= -1.14e-13  |g|= 7.6e-09  |ddm|= 1.06e-08
HOMO (B3u) = -0.467470973492029  LUMO (Ag) = -0.10521941134199
cycle= 11 E= -75.3806068289574  delta_E= 1.56e-13  |g|= 8.77e-10  |ddm|= 1.87e-08
HOMO (B3u) = -0.467470973606633  LUMO (Ag) = -0.105219411411532
cycle= 12 E= -75.3806068289574  delta_E= -1.42e-14  |g|= 6.81e-10  |ddm|= 2.27e-09
HOMO (B3u) = -0.467470973590792  LUMO (Ag) = -0.105219411386339
cycle= 13 E= -75.3806068289575  delta_E= -7.11e-14  |g|= 5.78e-10  |ddm|= 1.29e-09
HOMO (B2u) = -0.467470973609001  LUMO (Ag) = -0.105219411406847
cycle= 14 E= -75.3806068289574  delta_E= 4.26e-14  |g|= 5.17e-10  |ddm|= 2.14e-10
HOMO (B3u) = -0.467470973617555  LUMO (Ag) = -0.105219411398042
cycle= 15 E= -75.3806068289574  delta_E=    0  |g|= 4.54e-10  |ddm|= 4.7e-10
HOMO (B2u) = -0.467470973587528  LUMO (Ag) = -0.105219411378718
cycle= 16 E= -75.3806068289575  delta_E= -5.68e-14  |g|= 4e-10  |ddm|= 8.34e-10
HOMO (B3u) = -0.467470973563591  LUMO (Ag) = -0.105219411401248
cycle= 17 E= -75.3806068289574  delta_E= 5.68e-14  |g|= 5.25e-10  |ddm|= 1.01e-09
HOMO (B3u) = -0.467470973603068  LUMO (Ag) = -0.105219411391121
cycle= 18 E= -75.3806068289575  delta_E= -5.68e-14  |g|= 3.18e-10  |ddm|= 4.58e-10
HOMO (B3u) = -0.467470973566575  LUMO (Ag) = -0.105219411341615
cycle= 19 E= -75.3806068289573  delta_E= 1.42e-13  |g|= 1.1e-10  |ddm|= 7.7e-10
HOMO (B3u) = -0.46747097356398  LUMO (Ag) = -0.105219411337602
cycle= 20 E= -75.3806068289574  delta_E= -1.14e-13  |g|= 9.38e-11  |ddm|= 3.83e-11
HOMO (B3u) = -0.467470973565744  LUMO (Ag) = -0.105219411337385
cycle= 21 E= -75.3806068289575  delta_E= -5.68e-14  |g|= 7.96e-11  |ddm|= 2.96e-11
HOMO (B2u) = -0.467470973565652  LUMO (Ag) = -0.105219411335878
cycle= 22 E= -75.3806068289574  delta_E= 1.42e-13  |g|= 6.65e-11  |ddm|= 3.96e-11
HOMO (B2u) = -0.467470973566284  LUMO (Ag) = -0.105219411334805
cycle= 23 E= -75.3806068289574  delta_E=    0  |g|= 5.46e-11  |ddm|= 3.46e-11
HOMO (B2u) = -0.467470973570426  LUMO (Ag) = -0.105219411332164
Extra cycle  E= -75.3806068289575  delta_E= -1.14e-13  |g|= 1.51e-11  |ddm|= 6.12e-11
converged SCF energy = -75.3806068289575

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmphos19zc5
max_memory 4000 MB (current use 5091 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5432350452006  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5633269876805  dE = -0.020091942  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.579856429044  dE = -0.016529441  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=0.0507  |maxRot[o]|=0.0764
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5891714790074  dE = -0.00931505  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0303  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5958163542769  dE = -0.0066448753  S^2 = 0.0000000
               |grad[o]|=0.0699  |ddm|=0.0111  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6011944129844  dE = -0.0053780587  S^2 = 0.0000000
               |grad[o]|=0.0557  |ddm|=0.00579  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6056552723611  dE = -0.0044608594  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00393  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6092550981739  dE = -0.0035998258  S^2 = 0.0000000
               |grad[o]|=0.034  |ddm|=0.00337  |maxRot[o]|=0.0797
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6118591159488  dE = -0.0026040178  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00347  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6135434946912  dE = -0.0016843787  S^2 = 0.0000000
               |grad[o]|=0.0171  |ddm|=0.00365  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6143869858539  dE = -0.00084349116  S^2 = 0.0000000
               |grad[o]|=0.00999  |ddm|=0.00384  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6145205027512  dE = -0.0001335169  S^2 = 0.0000000
               |grad[o]|=0.00373  |ddm|=0.00405  |maxRot[o]|= 0.04
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6145268297887  dE = -6.3270375e-06  S^2 = 0.0000000
               |grad[o]|=0.000948  |ddm|=0.0023  |maxRot[o]|=0.00981
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6145269484983  dE = -1.1870958e-07  S^2 = 0.0000000
               |grad[o]|=0.000187  |ddm|=0.000826  |maxRot[o]|=0.00121
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6145269526716  dE = -4.1732733e-09  S^2 = 0.0000000
               |grad[o]|=4.1e-05  |ddm|=0.000208  |maxRot[o]|=0.00018
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6145269528473  dE = -1.756888e-10  S^2 = 0.0000000
               |grad[o]|=1.44e-05  |ddm|=4.51e-05  |maxRot[o]|=2.67e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6145269528483  dE = -1.0231815e-12  S^2 = 0.0000000
               |grad[o]|=1.14e-06  |ddm|=6.56e-06  |maxRot[o]|=3.21e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98576845 1.56903862 1.90400104 1.90400151 0.42663325 0.09933863
 0.09933873 0.01187979]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00276   0.00252   0.00000   0.00000  -0.00155
  0 C 2s       0.58703   0.49855   0.00000   0.00000  -0.39116
  0 C 3s      -0.05216   0.00914   0.00000   0.00000  -0.01848
  0 C 2px      0.00000   0.00000  -0.00000   0.70609   0.00000
  0 C 2py     -0.00000  -0.00000   0.70609   0.00000  -0.00000
  0 C 2pz      0.38514  -0.50131   0.00000  -0.00000   0.58739
  0 C 3px      0.00000  -0.00000  -0.00000  -0.01737  -0.00000
  0 C 3py      0.00000  -0.00000  -0.01737   0.00000  -0.00000
  0 C 3pz     -0.05093  -0.00632   0.00000   0.00000  -0.03868
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03373   0.00000  -0.00000
  0 C 3dz^2    0.04175   0.00318   0.00000   0.00000   0.01107
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03373  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00276  -0.00252   0.00000   0.00000  -0.00155
  1 C 2s       0.58703  -0.49855  -0.00000  -0.00000  -0.39116
  1 C 3s      -0.05216  -0.00914  -0.00000  -0.00000  -0.01848
  1 C 2px     -0.00000   0.00000   0.00000   0.70609   0.00000
  1 C 2py     -0.00000   0.00000   0.70609  -0.00000   0.00000
  1 C 2pz     -0.38514  -0.50131   0.00000  -0.00000  -0.58739
  1 C 3px     -0.00000  -0.00000   0.00000  -0.01737   0.00000
  1 C 3py      0.00000   0.00000  -0.01737  -0.00000   0.00000
  1 C 3pz      0.05093  -0.00632   0.00000   0.00000   0.03868
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.03373   0.00000  -0.00000
  1 C 3dz^2    0.04175  -0.00318  -0.00000   0.00000   0.01107
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03373  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00080
  0 C 2s       0.00000   0.00000   0.50039
  0 C 3s      -0.00000  -0.00000  -0.04369
  0 C 2px      0.70617   0.00000  -0.00000
  0 C 2py      0.00000   0.70617   0.00000
  0 C 2pz     -0.00000  -0.00000   0.49657
  0 C 3px     -0.02753   0.00000  -0.00000
  0 C 3py      0.00000  -0.02753  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.00467
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02382   0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.03305
  0 C 3dxz    -0.02382   0.00000  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00080
  1 C 2s       0.00000   0.00000  -0.50039
  1 C 3s       0.00000   0.00000   0.04369
  1 C 2px     -0.70617  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70617   0.00000
  1 C 2pz     -0.00000   0.00000   0.49657
  1 C 3px      0.02753  -0.00000   0.00000
  1 C 3py     -0.00000   0.02753  -0.00000
  1 C 3pz     -0.00000  -0.00000   0.00467
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02382   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03305
  1 C 3dxz    -0.02382   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99511401
<CAS-nat-orb|mo-hf>  4  4    0.99863346
<CAS-nat-orb|mo-hf>  5  5    0.99981869
<CAS-nat-orb|mo-hf>  6  6    0.99981869
<CAS-nat-orb|mo-hf>  7  7    0.98014677
<CAS-nat-orb|mo-hf>  8  8    0.92376834
<CAS-nat-orb|mo-hf>  9  9    0.92376844
<CAS-nat-orb|mo-hf>  10  10    0.44416383
<CAS-nat-orb|mo-hf>  10  17    0.59838661
<CAS-nat-orb|mo-hf>  10  20   -0.60893948
CASSCF energy = -75.6145269528483
CASCI E = -75.6145269528483  E(CI) = -18.0065822004664  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.010

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.056
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.011
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.014
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.101
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.10
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.14
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.02
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.352 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.223 | Tfpread = 0.000 | Tfpwrite = 0.219 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.210 | E =     -75.6976301777 | DW = 1.49e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.378 | E =     -75.7180471769 | DE = -2.04e-02 | DW = 6.13e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.197 | E =     -75.7184416879 | DE = -3.95e-04 | DW = 1.19e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.954 | E =     -75.7188764250 | DE = -4.35e-04 | DW = 7.82e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.800 | E =     -75.7188711922 | DE = 5.23e-06 | DW = 1.21e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.653 | E =     -75.7188819115 | DE = -1.07e-05 | DW = 7.82e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.495 | E =     -75.7188770107 | DE = 4.90e-06 | DW = 1.22e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.338 | E =     -75.7188797877 | DE = -2.78e-06 | DW = 7.83e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.300 | E =     -75.7196007931 | DE = -7.21e-04 | DW = 9.99e-06

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     12.392 | E =     -75.7197700234 | DE = -1.69e-04 | DW = 1.15e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.084 | E =     -75.7198050073 | DE = -3.50e-05 | DW = 2.10e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     18.077 | E =     -75.7198090867 | DE = -4.08e-06 | DW = 1.28e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.556 | E =     -75.7198087190 | DE = 3.68e-07 | DW = 2.09e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.349 | E =     -75.7198090659 | DE = -3.47e-07 | DW = 1.26e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     28.126 | E =     -75.7198090967 | DE = -3.09e-08 | DW = 2.10e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.606 | E =     -75.7198091987 | DE = -1.02e-07 | DW = 1.26e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.312 | E =     -75.7199161825 | DE = -1.07e-04 | DW = 1.91e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     54.129 | E =     -75.7199391948 | DE = -2.30e-05 | DW = 1.01e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     64.687 | E =     -75.7199439999 | DE = -4.81e-06 | DW = 2.80e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     74.123 | E =     -75.7199440187 | DE = -1.88e-08 | DW = 1.05e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     83.103 | E =     -75.7199440728 | DE = -5.41e-08 | DW = 2.79e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     93.751 | E =     -75.7199440849 | DE = -1.21e-08 | DW = 1.06e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    109.210 | E =     -75.7199441039 | DE = -1.90e-08 | DW = 2.79e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.461 | E =     -75.7199441122 | DE = -8.25e-09 | DW = 1.06e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    145.103 | E =     -75.7199530955 | DE = -8.98e-06 | DW = 1.98e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    172.390 | E =     -75.7199538803 | DE = -7.85e-07 | DW = 7.87e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    199.823 | E =     -75.7199540477 | DE = -1.67e-07 | DW = 1.88e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    227.198 | E =     -75.7199539431 | DE = 1.05e-07 | DW = 6.82e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    254.897 | E =     -75.7199539929 | DE = -4.98e-08 | DW = 1.84e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    282.741 | E =     -75.7199539026 | DE = 9.02e-08 | DW = 6.73e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    310.643 | E =     -75.7199539890 | DE = -8.64e-08 | DW = 1.84e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    339.065 | E =     -75.7199538991 | DE = 8.99e-08 | DW = 6.72e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    381.672 | E =     -75.7199545691 | DE = -6.70e-07 | DW = 3.69e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    412.423 | E =     -75.7199545690 | DE = 4.35e-11 | DW = 3.69e-08

E(MRCI) = -75.71995456900996  E_corr = -0.105427616161677
Time cost =    492.926
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:16:08 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.217107585116 AA    0.000000000000   0.000000000000   2.300000000000 Bohr   0.0

nuclear repulsion = 15.6521739130435
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.15]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     76998.00


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp4fmi6nsq
max_memory 4000 MB (current use 5092 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.5736679955661

WARN: Singularity detected in overlap matrix (condition number =  684). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.275669226345096  LUMO (Ag) = -0.189888551192394
cycle= 1 E= -75.3709156762751  delta_E= 0.203  |g|= 0.194  |ddm|=  1.5
HOMO (B3u) = -0.494059555931335  LUMO (Ag) = -0.140557688111627
cycle= 2 E= -75.3842064529923  delta_E= -0.0133  |g|= 0.0519  |ddm|= 0.217
HOMO (B3u) = -0.458318448325722  LUMO (Ag) = -0.104627267109311
cycle= 3 E= -75.3850020490567  delta_E= -0.000796  |g|= 0.00987  |ddm|= 0.0675
HOMO (B2u) = -0.460162695295051  LUMO (Ag) = -0.10485931238232
cycle= 4 E= -75.3850609582636  delta_E= -5.89e-05  |g|= 0.00188  |ddm|= 0.038
HOMO (B3u) = -0.460946264390437  LUMO (Ag) = -0.105848218108884
cycle= 5 E= -75.3850633096871  delta_E= -2.35e-06  |g|= 0.000188  |ddm|= 0.0127
HOMO (B3u) = -0.460927636332218  LUMO (Ag) = -0.105880739343782
cycle= 6 E= -75.3850633353856  delta_E= -2.57e-08  |g|= 2.43e-05  |ddm|= 0.00106
HOMO (B3u) = -0.46092962518536  LUMO (Ag) = -0.105890953720659
cycle= 7 E= -75.3850633357242  delta_E= -3.39e-10  |g|= 2.81e-06  |ddm|= 0.000195
HOMO (B3u) = -0.460930055066112  LUMO (Ag) = -0.105891268417329
cycle= 8 E= -75.3850633357271  delta_E= -2.98e-12  |g|= 1.94e-07  |ddm|= 3.21e-05
HOMO (B3u) = -0.460930071210935  LUMO (Ag) = -0.105891273497098
cycle= 9 E= -75.3850633357272  delta_E= -5.68e-14  |g|= 1.06e-08  |ddm|= 5.6e-07
HOMO (B3u) = -0.460930068167933  LUMO (Ag) = -0.105891267976196
cycle= 10 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 7.04e-09  |ddm|= 1.11e-08
HOMO (B3u) = -0.460930070691163  LUMO (Ag) = -0.105891270569472
cycle= 11 E= -75.3850633357273  delta_E= -2.84e-14  |g|= 9.69e-10  |ddm|= 1.93e-08
HOMO (B3u) = -0.460930070838339  LUMO (Ag) = -0.105891270680808
cycle= 12 E= -75.3850633357272  delta_E= 5.68e-14  |g|= 8.28e-10  |ddm|= 3.01e-09
HOMO (B3u) = -0.460930070808237  LUMO (Ag) = -0.105891270629901
cycle= 13 E= -75.3850633357272  delta_E=    0  |g|= 6.45e-10  |ddm|= 1.19e-09
HOMO (B3u) = -0.460930070826841  LUMO (Ag) = -0.105891270646854
cycle= 14 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 6.04e-10  |ddm|= 7.96e-10
HOMO (B3u) = -0.460930070827042  LUMO (Ag) = -0.105891270638897
cycle= 15 E= -75.3850633357272  delta_E= -2.84e-14  |g|= 5.27e-10  |ddm|= 5.16e-10
HOMO (B3u) = -0.46093007079796  LUMO (Ag) = -0.105891270621308
cycle= 16 E= -75.3850633357272  delta_E=    0  |g|= 4.66e-10  |ddm|= 6.02e-10
HOMO (B3u) = -0.460930070761858  LUMO (Ag) = -0.105891270622215
cycle= 17 E= -75.3850633357272  delta_E= 2.84e-14  |g|= 5.52e-10  |ddm|= 1.1e-09
HOMO (B3u) = -0.460930070795115  LUMO (Ag) = -0.105891270601554
cycle= 18 E= -75.3850633357272  delta_E= 1.42e-14  |g|= 3.09e-10  |ddm|= 5.57e-10
HOMO (B3u) = -0.460930070749308  LUMO (Ag) = -0.105891270547112
cycle= 19 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 1.29e-10  |ddm|= 7.18e-10
HOMO (B3u) = -0.460930070747193  LUMO (Ag) = -0.105891270543288
cycle= 20 E= -75.3850633357272  delta_E=    0  |g|= 1.12e-10  |ddm|= 3.92e-11
HOMO (B3u) = -0.460930070750954  LUMO (Ag) = -0.105891270544174
cycle= 21 E= -75.3850633357271  delta_E= 8.53e-14  |g|= 9.36e-11  |ddm|= 4.9e-11
HOMO (B3u) = -0.460930070752633  LUMO (Ag) = -0.105891270544057
cycle= 22 E= -75.3850633357272  delta_E= -8.53e-14  |g|= 7.92e-11  |ddm|= 2.8e-11
HOMO (B3u) = -0.460930070754034  LUMO (Ag) = -0.105891270543524
cycle= 23 E= -75.3850633357271  delta_E= 8.53e-14  |g|= 6.47e-11  |ddm|= 3.75e-11
HOMO (B3u) = -0.460930070755095  LUMO (Ag) = -0.105891270542859
cycle= 24 E= -75.3850633357271  delta_E= -5.68e-14  |g|= 5.27e-11  |ddm|= 4.61e-11
HOMO (B3u) = -0.460930070756033  LUMO (Ag) = -0.105891270541848
cycle= 25 E= -75.3850633357272  delta_E= -5.68e-14  |g|= 4.19e-11  |ddm|= 2.83e-11
HOMO (B3u) = -0.460930070757789  LUMO (Ag) = -0.105891270540598
cycle= 26 E= -75.3850633357271  delta_E= 1.14e-13  |g|= 2.7e-11  |ddm|= 3.27e-11
HOMO (B3u) = -0.460930070759773  LUMO (Ag) = -0.105891270541394
cycle= 27 E= -75.3850633357271  delta_E= 2.84e-14  |g|= 2.14e-11  |ddm|= 2.32e-11
HOMO (B3u) = -0.460930070759448  LUMO (Ag) = -0.105891270540459
cycle= 28 E= -75.3850633357271  delta_E= -8.53e-14  |g|= 1.78e-11  |ddm|= 8.06e-12
HOMO (B3u) = -0.460930070759075  LUMO (Ag) = -0.105891270539541
cycle= 29 E= -75.3850633357272  delta_E= -8.53e-14  |g|= 1.45e-11  |ddm|= 7.93e-12
HOMO (B3u) = -0.460930070758806  LUMO (Ag) = -0.105891270538791
cycle= 30 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 1.19e-11  |ddm|= 9.33e-12
HOMO (B3u) = -0.46093007075861  LUMO (Ag) = -0.105891270538158
cycle= 31 E= -75.3850633357272  delta_E= -1.42e-14  |g|= 9.54e-12  |ddm|= 8.74e-12
HOMO (B3u) = -0.460930070758497  LUMO (Ag) = -0.105891270537669
cycle= 32 E= -75.3850633357272  delta_E= 4.26e-14  |g|= 7.62e-12  |ddm|= 7.23e-12
HOMO (B3u) = -0.460930070758464  LUMO (Ag) = -0.105891270537322
cycle= 33 E= -75.3850633357271  delta_E= 1.42e-14  |g|= 6.16e-12  |ddm|= 4.84e-12
HOMO (B3u) = -0.460930070758469  LUMO (Ag) = -0.105891270537085
cycle= 34 E= -75.3850633357264  delta_E= 7.53e-13  |g|= 7.23e-12  |ddm|= 2.31e-12
HOMO (B3u) = -0.460930070758433  LUMO (Ag) = -0.105891270536954
cycle= 35 E= -75.3850633357265  delta_E= -1.28e-13  |g|= 6.14e-12  |ddm|= 6.76e-12
HOMO (B3u) = -0.460930070758431  LUMO (Ag) = -0.105891270536864
cycle= 36 E= -75.3850633357264  delta_E= 1.42e-13  |g|= 5.56e-12  |ddm|= 7.83e-12
HOMO (B3u) = -0.46093007075841  LUMO (Ag) = -0.105891270536779
cycle= 37 E= -75.3850633357263  delta_E= 1.14e-13  |g|= 5.32e-12  |ddm|= 8.48e-12
HOMO (B3u) = -0.460930070758368  LUMO (Ag) = -0.105891270536691
cycle= 38 E= -75.3850633357263  delta_E=    0  |g|= 5.26e-12  |ddm|= 8.2e-12
HOMO (B3u) = -0.460930070758071  LUMO (Ag) = -0.105891270536246
Extra cycle  E= -75.3850633357263  delta_E= -2.84e-14  |g|= 1.41e-12  |ddm|= 5.21e-11
converged SCF energy = -75.3850633357263

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp4fmi6nsq
max_memory 4000 MB (current use 5092 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5493989307682  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5700624304029  dE = -0.0206635  S^2 = 0.0000000
               |grad[o]|=0.144  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.586562573655  dE = -0.016500143  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0532  |maxRot[o]|=0.0764
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5958278724723  dE = -0.0092652988  S^2 = 0.0000000
               |grad[o]|=0.0881  |ddm|=0.0308  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6025782751308  dE = -0.0067504027  S^2 = 0.0000000
               |grad[o]|=0.069  |ddm|=0.0115  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6080413814839  dE = -0.0054631064  S^2 = 0.0000000
               |grad[o]|=0.0545  |ddm|=0.00632  |maxRot[o]|=0.0795
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6123296419002  dE = -0.0042882604  S^2 = 0.0000000
               |grad[o]|=0.0425  |ddm|=0.00446  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6155964232389  dE = -0.0032667813  S^2 = 0.0000000
               |grad[o]|=0.0324  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6179389381291  dE = -0.0023425149  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00362  |maxRot[o]|=0.0798
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194233957369  dE = -0.0014844576  S^2 = 0.0000000
               |grad[o]|=0.016  |ddm|=0.00373  |maxRot[o]|=0.0798
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6201142648622  dE = -0.00069086913  S^2 = 0.0000000
               |grad[o]|=0.00899  |ddm|=0.0039  |maxRot[o]|=0.0798
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201867133788  dE = -7.2448517e-05  S^2 = 0.0000000
               |grad[o]|=0.0028  |ddm|=0.00412  |maxRot[o]|=0.0333
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201877710692  dE = -1.0576904e-06  S^2 = 0.0000000
               |grad[o]|=0.000516  |ddm|=0.00202  |maxRot[o]|=0.00371
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201877952079  dE = -2.4138629e-08  S^2 = 0.0000000
               |grad[o]|=9.22e-05  |ddm|=0.000481  |maxRot[o]|=0.000503
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6201877964234  dE = -1.2155539e-09  S^2 = 0.0000000
               |grad[o]|=2.62e-05  |ddm|=0.000111  |maxRot[o]|=9.43e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6201877964595  dE = -3.608136e-11  S^2 = 0.0000000
               |grad[o]|=7.47e-06  |ddm|=1.85e-05  |maxRot[o]|=7.33e-06
2-step CASSCF converged in 15 macro (77 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98500901 1.58412241 1.89795628 1.8979566  0.41151822 0.10541178
 0.10541191 0.0126138 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00317   0.00262   0.00000   0.00000  -0.00145
  0 C 2s       0.59002   0.50721   0.00000  -0.00000  -0.38673
  0 C 3s      -0.05064   0.00902   0.00000  -0.00000  -0.01545
  0 C 2px      0.00000  -0.00000  -0.00000   0.70621  -0.00000
  0 C 2py      0.00000   0.00000   0.70621  -0.00000  -0.00000
  0 C 2pz      0.38111  -0.49255   0.00000  -0.00000   0.59034
  0 C 3px      0.00000  -0.00000   0.00000  -0.01351   0.00000
  0 C 3py     -0.00000   0.00000  -0.01351   0.00000  -0.00000
  0 C 3pz     -0.04932  -0.00573   0.00000  -0.00000  -0.03961
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.03283   0.00000  -0.00000
  0 C 3dz^2    0.04041   0.00253   0.00000  -0.00000   0.01144
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03283   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00317  -0.00262   0.00000   0.00000  -0.00145
  1 C 2s       0.59002  -0.50721   0.00000   0.00000  -0.38673
  1 C 3s      -0.05064  -0.00902  -0.00000   0.00000  -0.01545
  1 C 2px     -0.00000   0.00000  -0.00000   0.70621  -0.00000
  1 C 2py      0.00000  -0.00000   0.70621  -0.00000   0.00000
  1 C 2pz     -0.38111  -0.49255   0.00000  -0.00000  -0.59034
  1 C 3px     -0.00000   0.00000   0.00000  -0.01351   0.00000
  1 C 3py     -0.00000  -0.00000  -0.01351   0.00000   0.00000
  1 C 3pz      0.04932  -0.00573   0.00000  -0.00000   0.03961
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03283  -0.00000  -0.00000
  1 C 3dz^2    0.04041  -0.00253  -0.00000   0.00000   0.01144
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03283  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00075
  0 C 2s      -0.00000   0.00000   0.49173
  0 C 3s      -0.00000   0.00000  -0.04330
  0 C 2px      0.70622  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70622   0.00000
  0 C 2pz     -0.00000  -0.00000   0.50534
  0 C 3px     -0.02618  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.02618   0.00000
  0 C 3pz     -0.00000   0.00000   0.00676
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02379   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.03024
  0 C 3dxz    -0.02379  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00075
  1 C 2s       0.00000  -0.00000  -0.49173
  1 C 3s       0.00000  -0.00000   0.04330
  1 C 2px     -0.70622   0.00000   0.00000
  1 C 2py      0.00000  -0.70622   0.00000
  1 C 2pz     -0.00000   0.00000   0.50534
  1 C 3px      0.02618   0.00000   0.00000
  1 C 3py      0.00000   0.02618  -0.00000
  1 C 3pz     -0.00000   0.00000   0.00676
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02379   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.03024
  1 C 3dxz    -0.02379  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99486439
<CAS-nat-orb|mo-hf>  4  4    0.99859055
<CAS-nat-orb|mo-hf>  5  5    0.99980387
<CAS-nat-orb|mo-hf>  6  6    0.99980387
<CAS-nat-orb|mo-hf>  7  7    0.97957779
<CAS-nat-orb|mo-hf>  8  8    0.92972100
<CAS-nat-orb|mo-hf>  9  9    0.92972110
<CAS-nat-orb|mo-hf>  10  10    0.45886290
<CAS-nat-orb|mo-hf>  10  17    0.62354822
<CAS-nat-orb|mo-hf>  10  20   -0.57985789
CASSCF energy = -75.6201877964595
CASCI E = -75.6201877964595  E(CI) = -17.857654995822  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.026
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.030
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.040
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.040
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.338
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.085
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.643

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.029
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.5 KB SPT = 0.8636 T =      0.625
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.724
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.722
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.720
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.323
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.320
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.501
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.11
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.12
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.08
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.05
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.565 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.272 | Tfpread = 0.000 | Tfpwrite = 0.269 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.652 | E =     -75.7014198837 | DW = 1.54e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.546 | E =     -75.7239181460 | DE = -2.25e-02 | DW = 6.51e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.259 | E =     -75.7243380247 | DE = -4.20e-04 | DW = 1.25e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     16.356 | E =     -75.7248259014 | DE = -4.88e-04 | DW = 8.37e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     17.045 | E =     -75.7248175141 | DE = 8.39e-06 | DW = 1.28e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     17.754 | E =     -75.7248256907 | DE = -8.18e-06 | DW = 8.35e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.329 | E =     -75.7248214913 | DE = 4.20e-06 | DW = 1.28e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     22.999 | E =     -75.7248238208 | DE = -2.33e-06 | DW = 8.35e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.335 | E =     -75.7255712328 | DE = -7.47e-04 | DW = 1.03e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.961 | E =     -75.7257466732 | DE = -1.75e-04 | DW = 1.24e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.359 | E =     -75.7257859055 | DE = -3.92e-05 | DW = 2.20e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.932 | E =     -75.7257907089 | DE = -4.80e-06 | DW = 1.38e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     45.914 | E =     -75.7257906351 | DE = 7.38e-08 | DW = 2.21e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     50.909 | E =     -75.7257915895 | DE = -9.54e-07 | DW = 1.39e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.301 | E =     -75.7257907792 | DE = 8.10e-07 | DW = 2.19e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     60.015 | E =     -75.7257909778 | DE = -1.99e-07 | DW = 1.36e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     68.419 | E =     -75.7259041234 | DE = -1.13e-04 | DW = 1.98e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     80.023 | E =     -75.7259270691 | DE = -2.29e-05 | DW = 1.08e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     91.341 | E =     -75.7259318343 | DE = -4.77e-06 | DW = 2.93e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    102.511 | E =     -75.7259318305 | DE = 3.75e-09 | DW = 1.12e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    113.580 | E =     -75.7259319306 | DE = -1.00e-07 | DW = 2.92e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    125.077 | E =     -75.7259318665 | DE = 6.41e-08 | DW = 1.12e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    136.518 | E =     -75.7259317849 | DE = 8.16e-08 | DW = 2.90e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    147.944 | E =     -75.7259318103 | DE = -2.54e-08 | DW = 1.11e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    169.627 | E =     -75.7259412206 | DE = -9.41e-06 | DW = 2.04e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    195.946 | E =     -75.7259420244 | DE = -8.04e-07 | DW = 8.24e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    221.648 | E =     -75.7259422009 | DE = -1.76e-07 | DW = 1.92e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    248.766 | E =     -75.7259420937 | DE = 1.07e-07 | DW = 7.14e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    274.283 | E =     -75.7259421676 | DE = -7.39e-08 | DW = 1.88e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    300.848 | E =     -75.7259420721 | DE = 9.56e-08 | DW = 7.08e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    326.841 | E =     -75.7259421646 | DE = -9.26e-08 | DW = 1.88e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    353.221 | E =     -75.7259420692 | DE = 9.54e-08 | DW = 7.07e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    391.364 | E =     -75.7259427631 | DE = -6.94e-07 | DW = 3.91e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    421.895 | E =     -75.7259427631 | DE = -9.59e-12 | DW = 3.91e-08

E(MRCI) = -75.72594276314713  E_corr = -0.105754966687627
Time cost =    586.914
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:25:55 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.243566445662 AA    0.000000000000   0.000000000000   2.350000000000 Bohr   0.0

nuclear repulsion = 15.3191489361702
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.175]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     84930.89


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmph264f0rs
max_memory 4000 MB (current use 5112 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.520080440469

WARN: Singularity detected in overlap matrix (condition number =  625). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.264198750943281  LUMO (Ag) = -0.186664127921807
cycle= 1 E= -75.3721584993459  delta_E= 0.148  |g|= 0.198  |ddm|= 1.49
HOMO (B3u) = -0.488497893717008  LUMO (Ag) = -0.142939777698254
cycle= 2 E= -75.3860697595072  delta_E= -0.0139  |g|= 0.052  |ddm|= 0.225
HOMO (B2u) = -0.452348284546127  LUMO (Ag) = -0.105756871897142
cycle= 3 E= -75.3868762726882  delta_E= -0.000807  |g|= 0.00951  |ddm|= 0.0641
HOMO (B2u) = -0.453936921014672  LUMO (Ag) = -0.105452022681083
cycle= 4 E= -75.3869305550891  delta_E= -5.43e-05  |g|= 0.00182  |ddm|= 0.034
HOMO (B2u) = -0.4546996704121  LUMO (Ag) = -0.106320748353531
cycle= 5 E= -75.3869327103433  delta_E= -2.16e-06  |g|= 0.00013  |ddm|= 0.0115
HOMO (B2u) = -0.454692197268591  LUMO (Ag) = -0.106342680679353
cycle= 6 E= -75.3869327222535  delta_E= -1.19e-08  |g|= 2.27e-05  |ddm|= 0.00104
HOMO (B3u) = -0.454694399587798  LUMO (Ag) = -0.106353370939731
cycle= 7 E= -75.3869327225934  delta_E= -3.4e-10  |g|= 3.04e-06  |ddm|= 8.49e-05
HOMO (B3u) = -0.454694907644864  LUMO (Ag) = -0.106353839610061
cycle= 8 E= -75.386932722597  delta_E= -3.61e-12  |g|= 2.27e-07  |ddm|= 2.93e-05
HOMO (B3u) = -0.454694923997378  LUMO (Ag) = -0.106353843315644
cycle= 9 E= -75.3869327225971  delta_E= -9.95e-14  |g|= 1.18e-08  |ddm|= 9.54e-07
HOMO (B3u) = -0.454694921257068  LUMO (Ag) = -0.106353838492752
cycle= 10 E= -75.386932722597  delta_E= 7.11e-14  |g|= 6.12e-09  |ddm|= 1.64e-08
HOMO (B3u) = -0.454694923053106  LUMO (Ag) = -0.106353840256013
cycle= 11 E= -75.386932722597  delta_E=    0  |g|= 1.13e-09  |ddm|= 1.31e-08
HOMO (B3u) = -0.454694923185177  LUMO (Ag) = -0.106353840334015
cycle= 12 E= -75.386932722597  delta_E= 2.84e-14  |g|= 9.16e-10  |ddm|= 1.69e-09
HOMO (B3u) = -0.454694923152614  LUMO (Ag) = -0.10635384028109
cycle= 13 E= -75.3869327225971  delta_E= -8.53e-14  |g|= 7.07e-10  |ddm|= 9.3e-10
HOMO (B3u) = -0.454694923167922  LUMO (Ag) = -0.10635384029078
cycle= 14 E= -75.3869327225971  delta_E= -8.53e-14  |g|= 6.99e-10  |ddm|= 1.25e-09
HOMO (B3u) = -0.454694923166705  LUMO (Ag) = -0.106353840308747
cycle= 15 E= -75.3869327225971  delta_E= 4.26e-14  |g|= 6.17e-10  |ddm|= 9.49e-10
HOMO (B3u) = -0.454694923134383  LUMO (Ag) = -0.106353840280398
cycle= 16 E= -75.3869327225971  delta_E= 1.42e-14  |g|= 5.53e-10  |ddm|= 5.93e-10
HOMO (B3u) = -0.454694923091051  LUMO (Ag) = -0.106353840262767
cycle= 17 E= -75.3869327225971  delta_E= -4.26e-14  |g|= 5.8e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.454694923115489  LUMO (Ag) = -0.106353840230181
cycle= 18 E= -75.386932722597  delta_E= 9.95e-14  |g|= 2.91e-10  |ddm|= 6.62e-10
HOMO (B3u) = -0.45469492307463  LUMO (Ag) = -0.106353840179431
cycle= 19 E= -75.386932722597  delta_E= -1.42e-14  |g|= 1.54e-10  |ddm|= 4.73e-10
HOMO (B3u) = -0.454694923074661  LUMO (Ag) = -0.106353840176675
cycle= 20 E= -75.386932722597  delta_E= 1.42e-14  |g|= 1.33e-10  |ddm|= 4.1e-11
HOMO (B3u) = -0.454694923078883  LUMO (Ag) = -0.106353840178033
cycle= 21 E= -75.386932722597  delta_E= 2.84e-14  |g|= 1.13e-10  |ddm|= 5.49e-11
HOMO (B3u) = -0.454694923081384  LUMO (Ag) = -0.106353840178701
cycle= 22 E= -75.386932722597  delta_E= 2.84e-14  |g|= 9.75e-11  |ddm|= 3.59e-11
HOMO (B2u) = -0.454694923082686  LUMO (Ag) = -0.106353840178386
cycle= 23 E= -75.3869327225969  delta_E= 9.95e-14  |g|= 8.05e-11  |ddm|= 4.14e-11
HOMO (B2u) = -0.454694923084145  LUMO (Ag) = -0.106353840177026
cycle= 24 E= -75.386932722597  delta_E= -9.95e-14  |g|= 6.38e-11  |ddm|= 5.82e-11
HOMO (B2u) = -0.454694923085147  LUMO (Ag) = -0.106353840175222
cycle= 25 E= -75.386932722597  delta_E= -2.84e-14  |g|= 4.88e-11  |ddm|= 4.28e-11
HOMO (B2u) = -0.454694923086528  LUMO (Ag) = -0.106353840173288
cycle= 26 E= -75.386932722597  delta_E= 1.42e-14  |g|= 3.33e-11  |ddm|= 2.75e-11
HOMO (B2u) = -0.454694923087892  LUMO (Ag) = -0.106353840173314
cycle= 27 E= -75.3869327225968  delta_E= 2.13e-13  |g|= 2.73e-11  |ddm|= 1.4e-11
HOMO (B2u) = -0.454694923087462  LUMO (Ag) = -0.106353840172129
cycle= 28 E= -75.3869327225969  delta_E= -8.53e-14  |g|= 2.3e-11  |ddm|= 1.07e-11
HOMO (B2u) = -0.454694923087019  LUMO (Ag) = -0.106353840171012
cycle= 29 E= -75.3869327225969  delta_E= -5.68e-14  |g|= 1.91e-11  |ddm|= 1.06e-11
HOMO (B2u) = -0.454694923086699  LUMO (Ag) = -0.106353840170074
cycle= 30 E= -75.3869327225969  delta_E= 1.42e-14  |g|= 1.56e-11  |ddm|= 1.12e-11
HOMO (B2u) = -0.454694923086464  LUMO (Ag) = -0.10635384016925
cycle= 31 E= -75.3869327225969  delta_E=    0  |g|= 1.28e-11  |ddm|= 1.15e-11
HOMO (B2u) = -0.454694923086332  LUMO (Ag) = -0.106353840167362
Extra cycle  E= -75.3869327225968  delta_E= 8.53e-14  |g|= 4.59e-12  |ddm|= 3.16e-11
converged SCF energy = -75.3869327225968

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmph264f0rs
max_memory 4000 MB (current use 5112 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5529956225487  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5742290470535  dE = -0.021233425  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5907012103409  dE = -0.016472163  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0556  |maxRot[o]|=0.078
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5999901297041  dE = -0.0092889194  S^2 = 0.0000000
               |grad[o]|=0.0873  |ddm|=0.0313  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066440843335  dE = -0.0066539546  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.012  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.611779405665  dE = -0.0051353213  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.00672  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.615822557542  dE = -0.0040431519  S^2 = 0.0000000
               |grad[o]|=0.042  |ddm|=0.00468  |maxRot[o]|=0.0798
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6189165173662  dE = -0.0030939598  S^2 = 0.0000000
               |grad[o]|=0.0322  |ddm|=0.00395  |maxRot[o]|=0.0798
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6211360444135  dE = -0.002219527  S^2 = 0.0000000
               |grad[o]|=0.0235  |ddm|=0.00375  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6225342446591  dE = -0.0013982002  S^2 = 0.0000000
               |grad[o]|=0.0158  |ddm|=0.0038  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.623166113344  dE = -0.00063186868  S^2 = 0.0000000
               |grad[o]|=0.00874  |ddm|=0.00396  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6232125399936  dE = -4.642665e-05  S^2 = 0.0000000
               |grad[o]|=0.00248  |ddm|=0.00421  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6232205419481  dE = -8.0019545e-06  S^2 = 0.0000000
               |grad[o]|=0.00103  |ddm|=0.00125  |maxRot[o]|=0.0111
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6232206696269  dE = -1.2767877e-07  S^2 = 0.0000000
               |grad[o]|=0.000188  |ddm|=0.000798  |maxRot[o]|=0.00125
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6232206732045  dE = -3.5776537e-09  S^2 = 0.0000000
               |grad[o]|=3.57e-05  |ddm|=0.000182  |maxRot[o]|=0.000178
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6232206732845  dE = -8.0007112e-11  S^2 = 0.0000000
               |grad[o]|=7.94e-06  |ddm|=3.68e-05  |maxRot[o]|=2.3e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6232206732852  dE = -6.5369932e-13  S^2 = 0.0000000
               |grad[o]|=1.25e-06  |ddm|=4.2e-06  |maxRot[o]|=3.15e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98422473 1.59822006 1.89166117 1.89166115 0.39748969 0.11168497
 0.11168493 0.0133733 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00356   0.00273   0.00000   0.00000  -0.00136
  0 C 2s       0.59304   0.51564   0.00000   0.00000  -0.38216
  0 C 3s      -0.04903   0.00893   0.00000   0.00000  -0.01244
  0 C 2px      0.00000   0.00000  -0.00000   0.70632  -0.00000
  0 C 2py      0.00000  -0.00000   0.70632   0.00000  -0.00000
  0 C 2pz      0.37694  -0.48373   0.00000   0.00000   0.59331
  0 C 3px      0.00000   0.00000  -0.00000  -0.00987  -0.00000
  0 C 3py      0.00000  -0.00000  -0.00987  -0.00000   0.00000
  0 C 3pz     -0.04768  -0.00519   0.00000   0.00000  -0.04045
  0 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.03194  -0.00000   0.00000
  0 C 3dz^2    0.03910   0.00193   0.00000   0.00000   0.01197
  0 C 3dxz     0.00000   0.00000  -0.00000   0.03194  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00356  -0.00273   0.00000   0.00000  -0.00136
  1 C 2s       0.59304  -0.51564   0.00000   0.00000  -0.38216
  1 C 3s      -0.04903  -0.00893  -0.00000  -0.00000  -0.01244
  1 C 2px     -0.00000  -0.00000   0.00000   0.70632   0.00000
  1 C 2py     -0.00000   0.00000   0.70632   0.00000  -0.00000
  1 C 2pz     -0.37694  -0.48373   0.00000  -0.00000  -0.59331
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00987   0.00000
  1 C 3py     -0.00000   0.00000  -0.00987   0.00000  -0.00000
  1 C 3pz      0.04768  -0.00519   0.00000   0.00000   0.04045
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.03194  -0.00000   0.00000
  1 C 3dz^2    0.03910  -0.00193  -0.00000  -0.00000   0.01197
  1 C 3dxz     0.00000   0.00000  -0.00000  -0.03194  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00071
  0 C 2s       0.00000   0.00000   0.48298
  0 C 3s       0.00000   0.00000  -0.04305
  0 C 2px      0.70627   0.00000  -0.00000
  0 C 2py     -0.00000   0.70627   0.00000
  0 C 2pz      0.00000   0.00000   0.51383
  0 C 3px     -0.02494   0.00000  -0.00000
  0 C 3py      0.00000  -0.02494   0.00000
  0 C 3pz     -0.00000   0.00000   0.00873
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02373   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02798
  0 C 3dxz    -0.02373   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00071
  1 C 2s       0.00000  -0.00000  -0.48298
  1 C 3s      -0.00000  -0.00000   0.04305
  1 C 2px     -0.70627  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70627  -0.00000
  1 C 2pz     -0.00000   0.00000   0.51383
  1 C 3px      0.02494  -0.00000   0.00000
  1 C 3py     -0.00000   0.02494  -0.00000
  1 C 3pz      0.00000   0.00000   0.00873
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02373   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02798
  1 C 3dxz    -0.02373   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99460038
<CAS-nat-orb|mo-hf>  4  4    0.99853698
<CAS-nat-orb|mo-hf>  5  5    0.99978677
<CAS-nat-orb|mo-hf>  6  6    0.99978677
<CAS-nat-orb|mo-hf>  7  7    0.97901210
<CAS-nat-orb|mo-hf>  8  8    0.93514181
<CAS-nat-orb|mo-hf>  9  9    0.93514178
<CAS-nat-orb|mo-hf>  10  10    0.47490998
<CAS-nat-orb|mo-hf>  10  17    0.64513856
<CAS-nat-orb|mo-hf>  10  20   -0.55018538
CASSCF energy = -75.6232206732852
CASCI E = -75.6232206732852  E(CI) = -17.7126744234002  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.011

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.055
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.014
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.012
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.016
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.105
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.263 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.152 | Tfpread = 0.000 | Tfpwrite = 0.147 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.448 | E =     -75.7039242970 | DW = 1.62e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.562 | E =     -75.7271766206 | DE = -2.33e-02 | DW = 6.93e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.442 | E =     -75.7276475827 | DE = -4.71e-04 | DW = 1.31e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.325 | E =     -75.7281350009 | DE = -4.87e-04 | DW = 8.91e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.225 | E =     -75.7281262645 | DE = 8.74e-06 | DW = 1.34e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.064 | E =     -75.7281339511 | DE = -7.69e-06 | DW = 8.89e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.051 | E =     -75.7281437646 | DE = -9.81e-06 | DW = 1.37e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.904 | E =     -75.7281437244 | DE = 4.01e-08 | DW = 8.99e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.758 | E =     -75.7289190860 | DE = -7.75e-04 | DW = 1.10e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     12.587 | E =     -75.7291020088 | DE = -1.83e-04 | DW = 1.35e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.921 | E =     -75.7291449525 | DE = -4.29e-05 | DW = 2.35e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.923 | E =     -75.7291493462 | DE = -4.39e-06 | DW = 1.46e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     25.254 | E =     -75.7291511441 | DE = -1.80e-06 | DW = 2.38e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     28.956 | E =     -75.7291515853 | DE = -4.41e-07 | DW = 1.50e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.311 | E =     -75.7291519756 | DE = -3.90e-07 | DW = 2.33e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.141 | E =     -75.7291530626 | DE = -1.09e-06 | DW = 1.51e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.722 | E =     -75.7292680047 | DE = -1.15e-04 | DW = 2.05e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.128 | E =     -75.7292917365 | DE = -2.37e-05 | DW = 1.12e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     64.387 | E =     -75.7292965443 | DE = -4.81e-06 | DW = 3.04e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     76.448 | E =     -75.7292965556 | DE = -1.13e-08 | DW = 1.17e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.364 | E =     -75.7292965223 | DE = 3.33e-08 | DW = 3.01e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    100.410 | E =     -75.7292965696 | DE = -4.72e-08 | DW = 1.16e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.434 | E =     -75.7292965262 | DE = 4.34e-08 | DW = 3.02e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    122.173 | E =     -75.7292965712 | DE = -4.50e-08 | DW = 1.16e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    143.931 | E =     -75.7293062987 | DE = -9.73e-06 | DW = 2.11e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    174.895 | E =     -75.7293071493 | DE = -8.51e-07 | DW = 8.55e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    202.356 | E =     -75.7293073166 | DE = -1.67e-07 | DW = 1.96e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    234.145 | E =     -75.7293072085 | DE = 1.08e-07 | DW = 7.39e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    262.732 | E =     -75.7293073011 | DE = -9.25e-08 | DW = 1.93e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    290.058 | E =     -75.7293071988 | DE = 1.02e-07 | DW = 7.36e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    323.102 | E =     -75.7293072999 | DE = -1.01e-07 | DW = 1.93e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    352.004 | E =     -75.7293071976 | DE = 1.02e-07 | DW = 7.35e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    406.073 | E =     -75.7293079456 | DE = -7.48e-07 | DW = 4.14e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    433.670 | E =     -75.7293079456 | DE = 4.35e-11 | DW = 4.14e-08

E(MRCI) = -75.72930794555197  E_corr = -0.1060872722667909
Time cost =    507.799
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:34:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.270025306208 AA    0.000000000000   0.000000000000   2.400000000000 Bohr   0.0

nuclear repulsion = 15
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.2]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     92775.60


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpo8gvjx31
max_memory 4000 MB (current use 5095 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4681036266052

WARN: Singularity detected in overlap matrix (condition number =  573). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.253350702957071  LUMO (Ag) = -0.183612207324933
cycle= 1 E= -75.3711621684052  delta_E= 0.0969  |g|= 0.203  |ddm|= 1.48
HOMO (B3u) = -0.483102395155572  LUMO (Ag) = -0.145014054403864
cycle= 2 E= -75.3857253013105  delta_E= -0.0146  |g|= 0.052  |ddm|= 0.234
HOMO (B2u) = -0.446604227160941  LUMO (Ag) = -0.106629940030307
cycle= 3 E= -75.3865468682808  delta_E= -0.000822  |g|= 0.00932  |ddm|= 0.0615
HOMO (B3u) = -0.44799076917457  LUMO (Ag) = -0.105837943292174
cycle= 4 E= -75.3865987559146  delta_E= -5.19e-05  |g|= 0.00179  |ddm|= 0.0304
HOMO (B3u) = -0.448742110750612  LUMO (Ag) = -0.106605000995193
cycle= 5 E= -75.3866008121181  delta_E= -2.06e-06  |g|= 7.74e-05  |ddm|= 0.0104
HOMO (B2u) = -0.448735377102867  LUMO (Ag) = -0.106607023368654
cycle= 6 E= -75.3866008154598  delta_E= -3.34e-09  |g|= 1.47e-05  |ddm|= 0.000795
HOMO (B3u) = -0.448736161720342  LUMO (Ag) = -0.106613403607842
cycle= 7 E= -75.3866008156198  delta_E= -1.6e-10  |g|= 2.92e-06  |ddm|= 4.96e-05
HOMO (B3u) = -0.448736721595753  LUMO (Ag) = -0.10661423343487
cycle= 8 E= -75.3866008156237  delta_E= -3.96e-12  |g|= 2.59e-07  |ddm|= 1.95e-05
HOMO (B3u) = -0.448736741737759  LUMO (Ag) = -0.106614252118962
cycle= 9 E= -75.3866008156237  delta_E= 4.26e-14  |g|= 1.3e-08  |ddm|= 1.45e-06
HOMO (B3u) = -0.448736740751524  LUMO (Ag) = -0.106614250131367
cycle= 10 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 5.79e-09  |ddm|= 2.13e-08
HOMO (B3u) = -0.448736740319986  LUMO (Ag) = -0.106614249152993
cycle= 11 E= -75.3866008156238  delta_E= -4.26e-14  |g|= 1.24e-09  |ddm|= 1.24e-08
HOMO (B3u) = -0.448736740437401  LUMO (Ag) = -0.106614249218276
cycle= 12 E= -75.3866008156237  delta_E= 7.11e-14  |g|= 9.73e-10  |ddm|= 9.72e-10
HOMO (B3u) = -0.448736740404328  LUMO (Ag) = -0.106614249162894
cycle= 13 E= -75.3866008156238  delta_E= -5.68e-14  |g|= 7.76e-10  |ddm|= 6.89e-10
HOMO (B3u) = -0.44873674043406  LUMO (Ag) = -0.106614249171016
cycle= 14 E= -75.3866008156238  delta_E= 1.42e-14  |g|= 7.65e-10  |ddm|= 1.78e-09
HOMO (B3u) = -0.44873674043865  LUMO (Ag) = -0.106614249220386
cycle= 15 E= -75.3866008156237  delta_E= 2.84e-14  |g|= 6.9e-10  |ddm|= 1.26e-09
HOMO (B3u) = -0.448736740358197  LUMO (Ag) = -0.106614249169878
cycle= 16 E= -75.3866008156238  delta_E= -2.84e-14  |g|= 6.73e-10  |ddm|= 1.38e-09
HOMO (B3u) = -0.448736740337378  LUMO (Ag) = -0.106614249142488
cycle= 17 E= -75.3866008156237  delta_E= 7.11e-14  |g|= 6.33e-10  |ddm|= 9.34e-10
HOMO (B3u) = -0.448736740348743  LUMO (Ag) = -0.106614249099353
cycle= 18 E= -75.3866008156239  delta_E= -1.56e-13  |g|= 3.13e-10  |ddm|= 8.01e-10
HOMO (B3u) = -0.448736740350463  LUMO (Ag) = -0.106614249078725
cycle= 19 E= -75.3866008156238  delta_E= 9.95e-14  |g|= 1.76e-10  |ddm|= 3.28e-10
HOMO (B3u) = -0.448736740350676  LUMO (Ag) = -0.106614249075953
cycle= 20 E= -75.3866008156238  delta_E=    0  |g|= 1.52e-10  |ddm|= 5.47e-11
HOMO (B3u) = -0.448736740354209  LUMO (Ag) = -0.106614249076774
cycle= 21 E= -75.3866008156237  delta_E= 5.68e-14  |g|= 1.32e-10  |ddm|= 5.84e-11
HOMO (B3u) = -0.448736740356053  LUMO (Ag) = -0.106614249077039
cycle= 22 E= -75.3866008156237  delta_E= -2.84e-14  |g|= 1.16e-10  |ddm|= 4.3e-11
HOMO (B3u) = -0.448736740356319  LUMO (Ag) = -0.106614249076548
cycle= 23 E= -75.3866008156237  delta_E= 2.84e-14  |g|= 9.81e-11  |ddm|= 4.71e-11
HOMO (B3u) = -0.448736740357484  LUMO (Ag) = -0.106614249074614
cycle= 24 E= -75.3866008156237  delta_E=    0  |g|= 7.92e-11  |ddm|= 6.7e-11
HOMO (B3u) = -0.448736740356556  LUMO (Ag) = -0.106614249063653
Extra cycle  E= -75.3866008156237  delta_E= -4.26e-14  |g|= 2.58e-11  |ddm|= 1.01e-10
converged SCF energy = -75.3866008156237

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpo8gvjx31
max_memory 4000 MB (current use 5095 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5544099472186  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5762121394352  dE = -0.021802192  S^2 = 0.0000000
               |grad[o]|=0.145  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5926062291363  dE = -0.01639409  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0581  |maxRot[o]|=0.0789
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6014965894484  dE = -0.0088903603  S^2 = 0.0000000
               |grad[o]|=0.0866  |ddm|=0.0319  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6078348960809  dE = -0.0063383066  S^2 = 0.0000000
               |grad[o]|=0.0679  |ddm|=0.0122  |maxRot[o]|=0.0798
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6128018721615  dE = -0.0049669761  S^2 = 0.0000000
               |grad[o]|=0.054  |ddm|=0.00703  |maxRot[o]|=0.0798
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6167385513628  dE = -0.0039366792  S^2 = 0.0000000
               |grad[o]|=0.0426  |ddm|=0.00504  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6197655962099  dE = -0.0030270448  S^2 = 0.0000000
               |grad[o]|=0.0328  |ddm|=0.00419  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6219462136253  dE = -0.0021806174  S^2 = 0.0000000
               |grad[o]|=0.0241  |ddm|=0.0039  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.62332582029  dE = -0.0013796067  S^2 = 0.0000000
               |grad[o]|=0.0162  |ddm|=0.00388  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6239528534227  dE = -0.00062703313  S^2 = 0.0000000
               |grad[o]|=0.00898  |ddm|=0.00404  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6239994853785  dE = -4.6631956e-05  S^2 = 0.0000000
               |grad[o]|=0.00253  |ddm|=0.00433  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6240076586899  dE = -8.1733114e-06  S^2 = 0.0000000
               |grad[o]|=0.00105  |ddm|=0.00127  |maxRot[o]|=0.0113
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6240077847724  dE = -1.2608251e-07  S^2 = 0.0000000
               |grad[o]|=0.000187  |ddm|=0.000797  |maxRot[o]|=0.00122
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6240077881028  dE = -3.3303991e-09  S^2 = 0.0000000
               |grad[o]|=3.42e-05  |ddm|=0.000172  |maxRot[o]|=0.000172
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6240077881796  dE = -7.680967e-11  S^2 = 0.0000000
               |grad[o]|=8.17e-06  |ddm|=3.54e-05  |maxRot[o]|=2.2e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.6240077881816  dE = -1.9895197e-12  S^2 = 0.0000000
               |grad[o]|=1.32e-06  |ddm|=6.64e-06  |maxRot[o]|=3.13e-06
2-step CASSCF converged in 16 macro (78 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98341795 1.61142026 1.88510477 1.88510533 0.38447454 0.11816034
 0.11816031 0.01415649]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00394   0.00282   0.00000   0.00000  -0.00128
  0 C 2s       0.59610   0.52384   0.00000  -0.00000  -0.37748
  0 C 3s      -0.04733   0.00887   0.00000  -0.00000  -0.00946
  0 C 2px      0.00000  -0.00000  -0.00000   0.70639  -0.00000
  0 C 2py     -0.00000   0.00000   0.70639  -0.00000  -0.00000
  0 C 2pz      0.37264  -0.47485  -0.00000  -0.00000   0.59629
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00643  -0.00000
  0 C 3py     -0.00000   0.00000  -0.00643  -0.00000  -0.00000
  0 C 3pz     -0.04603  -0.00469   0.00000  -0.00000  -0.04119
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.03106  -0.00000  -0.00000
  0 C 3dz^2    0.03783   0.00135   0.00000  -0.00000   0.01265
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.03106  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00394  -0.00282   0.00000   0.00000  -0.00128
  1 C 2s       0.59610  -0.52384  -0.00000   0.00000  -0.37748
  1 C 3s      -0.04733  -0.00887  -0.00000   0.00000  -0.00946
  1 C 2px      0.00000   0.00000   0.00000   0.70639   0.00000
  1 C 2py      0.00000  -0.00000   0.70639   0.00000   0.00000
  1 C 2pz     -0.37264  -0.47485  -0.00000  -0.00000  -0.59629
  1 C 3px     -0.00000   0.00000   0.00000  -0.00643   0.00000
  1 C 3py      0.00000  -0.00000  -0.00643   0.00000   0.00000
  1 C 3pz      0.04603  -0.00469   0.00000  -0.00000   0.04119
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.03106  -0.00000  -0.00000
  1 C 3dz^2    0.03783  -0.00135  -0.00000   0.00000   0.01265
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.03106  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00067
  0 C 2s       0.00000   0.00000   0.47414
  0 C 3s      -0.00000   0.00000  -0.04292
  0 C 2px      0.70631  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70631  -0.00000
  0 C 2pz      0.00000  -0.00000   0.52207
  0 C 3px     -0.02380   0.00000   0.00000
  0 C 3py      0.00000  -0.02380  -0.00000
  0 C 3pz     -0.00000   0.00000   0.01059
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.02366   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02618
  0 C 3dxz    -0.02366   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00067
  1 C 2s       0.00000  -0.00000  -0.47414
  1 C 3s       0.00000  -0.00000   0.04292
  1 C 2px     -0.70631  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70631   0.00000
  1 C 2pz     -0.00000  -0.00000   0.52207
  1 C 3px      0.02380   0.00000   0.00000
  1 C 3py      0.00000   0.02380   0.00000
  1 C 3pz     -0.00000   0.00000   0.01059
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02366  -0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02618
  1 C 3dxz    -0.02366  -0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99432404
<CAS-nat-orb|mo-hf>  4  4    0.99847304
<CAS-nat-orb|mo-hf>  5  5    0.99976738
<CAS-nat-orb|mo-hf>  6  6    0.99976738
<CAS-nat-orb|mo-hf>  7  7    0.97845223
<CAS-nat-orb|mo-hf>  8  8    0.94007722
<CAS-nat-orb|mo-hf>  9  9    0.94007728
<CAS-nat-orb|mo-hf>  10  10    0.49233343
<CAS-nat-orb|mo-hf>  10  17    0.66275073
<CAS-nat-orb|mo-hf>  10  20   -0.52046337
CASSCF energy = -75.6240077881816
CASCI E = -75.6240077881816  E(CI) = -17.5716139909124  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.010

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.053
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.012
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.010
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.094
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.10
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.04
Time init sweep =        0.334 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.220 | Tfpread = 0.000 | Tfpwrite = 0.217 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.482 | E =     -75.7043849439 | DW = 1.68e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.804 | E =     -75.7282272754 | DE = -2.38e-02 | DW = 7.43e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.590 | E =     -75.7287097178 | DE = -4.82e-04 | DW = 1.39e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.376 | E =     -75.7292232475 | DE = -5.14e-04 | DW = 9.57e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.111 | E =     -75.7292121192 | DE = 1.11e-05 | DW = 1.42e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.920 | E =     -75.7292373071 | DE = -2.52e-05 | DW = 9.60e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.885 | E =     -75.7292389788 | DE = -1.67e-06 | DW = 1.44e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.757 | E =     -75.7292433578 | DE = -4.38e-06 | DW = 9.62e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.584 | E =     -75.7300299789 | DE = -7.87e-04 | DW = 1.15e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     12.556 | E =     -75.7302204537 | DE = -1.90e-04 | DW = 1.45e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.307 | E =     -75.7302655223 | DE = -4.51e-05 | DW = 2.48e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.697 | E =     -75.7302713982 | DE = -5.88e-06 | DW = 1.61e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.492 | E =     -75.7302721732 | DE = -7.75e-07 | DW = 2.48e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.508 | E =     -75.7302733995 | DE = -1.23e-06 | DW = 1.62e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.832 | E =     -75.7302725028 | DE = 8.97e-07 | DW = 2.47e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.663 | E =     -75.7302728117 | DE = -3.09e-07 | DW = 1.58e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     50.642 | E =     -75.7303941989 | DE = -1.21e-04 | DW = 2.13e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     62.842 | E =     -75.7304186631 | DE = -2.45e-05 | DW = 1.17e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     75.147 | E =     -75.7304235358 | DE = -4.87e-06 | DW = 3.14e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     87.435 | E =     -75.7304236357 | DE = -9.99e-08 | DW = 1.21e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     99.622 | E =     -75.7304236477 | DE = -1.20e-08 | DW = 3.14e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.316 | E =     -75.7304236944 | DE = -4.67e-08 | DW = 1.22e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    124.710 | E =     -75.7304236647 | DE = 2.97e-08 | DW = 3.14e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    136.395 | E =     -75.7304237119 | DE = -4.71e-08 | DW = 1.22e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    159.218 | E =     -75.7304338131 | DE = -1.01e-05 | DW = 2.17e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    186.113 | E =     -75.7304346947 | DE = -8.82e-07 | DW = 8.90e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    213.947 | E =     -75.7304348713 | DE = -1.77e-07 | DW = 2.01e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    241.169 | E =     -75.7304347575 | DE = 1.14e-07 | DW = 7.69e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    269.429 | E =     -75.7304348590 | DE = -1.02e-07 | DW = 1.98e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    296.041 | E =     -75.7304347489 | DE = 1.10e-07 | DW = 7.66e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    323.896 | E =     -75.7304348583 | DE = -1.09e-07 | DW = 1.98e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    352.314 | E =     -75.7304347480 | DE = 1.10e-07 | DW = 7.66e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    395.039 | E =     -75.7304355438 | DE = -7.96e-07 | DW = 4.37e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    425.187 | E =     -75.7304355438 | DE = 4.92e-11 | DW = 4.37e-08

E(MRCI) = -75.73043554376986  E_corr = -0.1064277555882285
Time cost =    495.288
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:42:38 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.296484166754 AA    0.000000000000   0.000000000000   2.450000000000 Bohr   0.0

nuclear repulsion = 14.6938775510204
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.225]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:     99814.08


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpao5lui3w
max_memory 4000 MB (current use 5092 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.4178541557328

WARN: Singularity detected in overlap matrix (condition number =  525). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.243088233296001  LUMO (Ag) = -0.180721513540292
cycle= 1 E= -75.3682765376263  delta_E= 0.0496  |g|= 0.207  |ddm|= 1.47
HOMO (B2u) = -0.477856195390327  LUMO (Ag) = -0.146786594446605
cycle= 2 E= -75.3835137621145  delta_E= -0.0152  |g|= 0.0521  |ddm|= 0.243
HOMO (B2u) = -0.441063789154574  LUMO (Ag) = -0.107250630527329
cycle= 3 E= -75.3843533836983  delta_E= -0.00084  |g|= 0.00929  |ddm|= 0.0595
HOMO (B2u) = -0.442295646912942  LUMO (Ag) = -0.106015245128841
cycle= 4 E= -75.3844049545557  delta_E= -5.16e-05  |g|= 0.0018  |ddm|= 0.0274
HOMO (B2u) = -0.443045442143855  LUMO (Ag) = -0.106700546721384
cycle= 5 E= -75.3844070231975  delta_E= -2.07e-06  |g|= 7.54e-05  |ddm|= 0.0094
HOMO (B3u) = -0.443032060379307  LUMO (Ag) = -0.106682393250684
cycle= 6 E= -75.3844070255161  delta_E= -2.32e-09  |g|= 1.3e-05  |ddm|= 0.00058
HOMO (B3u) = -0.443029779172082  LUMO (Ag) = -0.106680098001436
cycle= 7 E= -75.3844070256074  delta_E= -9.14e-11  |g|= 1.64e-06  |ddm|= 2.88e-05
HOMO (B2u) = -0.443029714305112  LUMO (Ag) = -0.106679671912371
cycle= 8 E= -75.3844070256093  delta_E= -1.85e-12  |g|= 2.42e-07  |ddm|= 1.68e-05
HOMO (B2u) = -0.443029690449364  LUMO (Ag) = -0.106679577828792
cycle= 9 E= -75.3844070256094  delta_E= -8.53e-14  |g|= 1.45e-08  |ddm|= 6.37e-07
HOMO (B2u) = -0.443029691481266  LUMO (Ag) = -0.106679578764971
cycle= 10 E= -75.3844070256094  delta_E= -7.11e-14  |g|= 7.83e-09  |ddm|= 1.24e-08
HOMO (B3u) = -0.44302968809759  LUMO (Ag) = -0.106679573968627
cycle= 11 E= -75.3844070256093  delta_E= 9.95e-14  |g|= 1.35e-09  |ddm|= 2.39e-08
HOMO (B3u) = -0.443029688180344  LUMO (Ag) = -0.106679573991998
cycle= 12 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 1e-09  |ddm|= 5.75e-10
HOMO (B3u) = -0.443029688159278  LUMO (Ag) = -0.106679573949154
cycle= 13 E= -75.3844070256094  delta_E=    0  |g|= 8.03e-10  |ddm|= 4.93e-10
HOMO (B2u) = -0.443029688192494  LUMO (Ag) = -0.106679573942763
cycle= 14 E= -75.3844070256093  delta_E= 9.95e-14  |g|= 7.7e-10  |ddm|= 1.61e-09
HOMO (B2u) = -0.443029688177654  LUMO (Ag) = -0.106679573918279
cycle= 15 E= -75.3844070256094  delta_E= -1.14e-13  |g|= 6.85e-10  |ddm|= 1.8e-10
HOMO (B3u) = -0.443029688159958  LUMO (Ag) = -0.106679573896859
cycle= 16 E= -75.3844070256094  delta_E= 1.42e-14  |g|= 6.1e-10  |ddm|= 4.14e-10
HOMO (B3u) = -0.443029688049667  LUMO (Ag) = -0.106679573933517
cycle= 17 E= -75.3844070256093  delta_E= 1.42e-14  |g|= 7.87e-10  |ddm|= 5.88e-10
HOMO (B3u) = -0.443029688062134  LUMO (Ag) = -0.106679573857409
cycle= 18 E= -75.3844070256094  delta_E= -4.26e-14  |g|= 4.09e-10  |ddm|= 7.25e-10
HOMO (B3u) = -0.443029688139514  LUMO (Ag) = -0.106679573881841
cycle= 19 E= -75.3844070256094  delta_E= -1.42e-14  |g|= 1.85e-10  |ddm|= 5.25e-10
HOMO (B3u) = -0.443029688139996  LUMO (Ag) = -0.106679573878203
cycle= 20 E= -75.3844070256094  delta_E= 1.42e-14  |g|= 1.57e-10  |ddm|= 6.58e-11
HOMO (B3u) = -0.44302968814238  LUMO (Ag) = -0.106679573877668
cycle= 21 E= -75.3844070256094  delta_E= 2.84e-14  |g|= 1.36e-10  |ddm|= 5.73e-11
HOMO (B3u) = -0.443029688143706  LUMO (Ag) = -0.106679573876974
cycle= 22 E= -75.3844070256092  delta_E= 1.14e-13  |g|= 1.2e-10  |ddm|= 4.64e-11
HOMO (B3u) = -0.443029688143302  LUMO (Ag) = -0.106679573876223
cycle= 23 E= -75.3844070256092  delta_E= 1.42e-14  |g|= 1.02e-10  |ddm|= 3.87e-11
HOMO (B3u) = -0.443029688142368  LUMO (Ag) = -0.106679573875259
cycle= 24 E= -75.3844070256093  delta_E= -2.84e-14  |g|= 8.63e-11  |ddm|= 3.82e-11
HOMO (B3u) = -0.443029688141286  LUMO (Ag) = -0.106679573874444
cycle= 25 E= -75.3844070256093  delta_E=    0  |g|= 7.37e-11  |ddm|= 3.01e-11
HOMO (B3u) = -0.443029688136573  LUMO (Ag) = -0.106679573860742
Extra cycle  E= -75.3844070256092  delta_E= 2.84e-14  |g|= 2.58e-11  |ddm|= 9.55e-11
converged SCF energy = -75.3844070256092

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpao5lui3w
max_memory 4000 MB (current use 5092 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5539827086622  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5763523954717  dE = -0.022369687  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5917534042897  dE = -0.015401009  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0607  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.6003903624951  dE = -0.0086369582  S^2 = 0.0000000
               |grad[o]|=0.0877  |ddm|=0.031  |maxRot[o]|=0.0798
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6066555455685  dE = -0.0062651831  S^2 = 0.0000000
               |grad[o]|=0.0695  |ddm|=0.0128  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.611593658943  dE = -0.0049381134  S^2 = 0.0000000
               |grad[o]|=0.0556  |ddm|=0.00767  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6155228056344  dE = -0.0039291467  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.00553  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6185576167749  dE = -0.0030348111  S^2 = 0.0000000
               |grad[o]|=0.0341  |ddm|=0.00451  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6207571529015  dE = -0.0021995361  S^2 = 0.0000000
               |grad[o]|=0.0252  |ddm|=0.00407  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6221628799135  dE = -0.001405727  S^2 = 0.0000000
               |grad[o]|=0.017  |ddm|=0.00399  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6228190303294  dE = -0.00065615042  S^2 = 0.0000000
               |grad[o]|=0.00956  |ddm|=0.00414  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6228849762501  dE = -6.5945921e-05  S^2 = 0.0000000
               |grad[o]|=0.00283  |ddm|=0.00447  |maxRot[o]|=0.0322
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6228858545739  dE = -8.783238e-07  S^2 = 0.0000000
               |grad[o]|=0.000486  |ddm|=0.00205  |maxRot[o]|=0.00325
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6228858730539  dE = -1.8479994e-08  S^2 = 0.0000000
               |grad[o]|=7.94e-05  |ddm|=0.000394  |maxRot[o]|=0.000414
macro iter 14 (4 JK  0 micro), CASSCF E = -75.622885873866  dE = -8.1212193e-10  S^2 = 0.0000000
               |grad[o]|=2.09e-05  |ddm|=8.49e-05  |maxRot[o]|=8.19e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6228858738916  dE = -2.5579538e-11  S^2 = 0.0000000
               |grad[o]|=5.75e-06  |ddm|=1.23e-05  |maxRot[o]|=5.91e-06
2-step CASSCF converged in 15 macro (77 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98259231 1.62382549 1.87827403 1.87827425 0.37239076 0.12484096
 0.12484103 0.01496118]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00430   0.00292   0.00000   0.00000  -0.00121
  0 C 2s       0.59918   0.53182   0.00000  -0.00000  -0.37268
  0 C 3s      -0.04557   0.00882   0.00000  -0.00000  -0.00652
  0 C 2px      0.00000  -0.00000  -0.00000   0.70645   0.00000
  0 C 2py      0.00000   0.00000   0.70645  -0.00000  -0.00000
  0 C 2pz      0.36821  -0.46590  -0.00000   0.00000   0.59928
  0 C 3px      0.00000  -0.00000   0.00000  -0.00317  -0.00000
  0 C 3py      0.00000   0.00000  -0.00317  -0.00000  -0.00000
  0 C 3pz     -0.04436  -0.00424   0.00000  -0.00000  -0.04182
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.03019  -0.00000  -0.00000
  0 C 3dz^2    0.03661   0.00082   0.00000  -0.00000   0.01349
  0 C 3dxz     0.00000  -0.00000   0.00000   0.03019  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00430  -0.00292   0.00000   0.00000  -0.00121
  1 C 2s       0.59918  -0.53182   0.00000   0.00000  -0.37268
  1 C 3s      -0.04557  -0.00882  -0.00000   0.00000  -0.00652
  1 C 2px     -0.00000   0.00000  -0.00000   0.70645   0.00000
  1 C 2py     -0.00000  -0.00000   0.70645  -0.00000  -0.00000
  1 C 2pz     -0.36821  -0.46590   0.00000  -0.00000  -0.59928
  1 C 3px     -0.00000   0.00000   0.00000  -0.00317  -0.00000
  1 C 3py     -0.00000  -0.00000  -0.00317   0.00000   0.00000
  1 C 3pz      0.04436  -0.00424   0.00000  -0.00000   0.04182
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000   0.00000  -0.03019  -0.00000  -0.00000
  1 C 3dz^2    0.03661  -0.00082  -0.00000   0.00000   0.01349
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.03019   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00063
  0 C 2s      -0.00000   0.00000   0.46522
  0 C 3s      -0.00000   0.00000  -0.04289
  0 C 2px      0.70635  -0.00000  -0.00000
  0 C 2py      0.00000   0.70635   0.00000
  0 C 2pz     -0.00000  -0.00000   0.53006
  0 C 3px     -0.02272   0.00000  -0.00000
  0 C 3py      0.00000  -0.02272   0.00000
  0 C 3pz     -0.00000   0.00000   0.01231
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02357   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02477
  0 C 3dxz    -0.02357   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00063
  1 C 2s       0.00000  -0.00000  -0.46522
  1 C 3s       0.00000  -0.00000   0.04289
  1 C 2px     -0.70635  -0.00000   0.00000
  1 C 2py      0.00000  -0.70635  -0.00000
  1 C 2pz     -0.00000   0.00000   0.53006
  1 C 3px      0.02272  -0.00000   0.00000
  1 C 3py     -0.00000   0.02272  -0.00000
  1 C 3pz     -0.00000   0.00000   0.01231
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02357   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02477
  1 C 3dxz    -0.02357   0.00000  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99403737
<CAS-nat-orb|mo-hf>  4  4    0.99839931
<CAS-nat-orb|mo-hf>  5  5    0.99974564
<CAS-nat-orb|mo-hf>  6  6    0.99974564
<CAS-nat-orb|mo-hf>  7  7    0.97790000
<CAS-nat-orb|mo-hf>  8  8    0.94457118
<CAS-nat-orb|mo-hf>  9  9    0.94457122
<CAS-nat-orb|mo-hf>  10  10    0.51114068
<CAS-nat-orb|mo-hf>  10  17    0.67613239
<CAS-nat-orb|mo-hf>  10  18   -0.49120211
CASSCF energy = -75.6228858738916
CASCI E = -75.6228858738916  E(CI) = -17.4344344666044  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.037
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.342
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.092
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.656

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.028
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.640
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.723
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.721
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.733
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.335
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.331
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.552
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.13
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.10
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.09
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.593 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.293 | Tfpread = 0.000 | Tfpwrite = 0.285 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.529 | E =     -75.7009906064 | DW = 1.82e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     14.523 | E =     -75.7272732543 | DE = -2.63e-02 | DW = 7.96e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     17.598 | E =     -75.7277849528 | DE = -5.12e-04 | DW = 1.43e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.379 | E =     -75.7283865093 | DE = -6.02e-04 | DW = 1.01e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     23.240 | E =     -75.7283882922 | DE = -1.78e-06 | DW = 1.52e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     25.891 | E =     -75.7284080519 | DE = -1.98e-05 | DW = 1.01e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     28.702 | E =     -75.7284069128 | DE = 1.14e-06 | DW = 1.50e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     31.421 | E =     -75.7284146636 | DE = -7.75e-06 | DW = 1.02e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.919 | E =     -75.7292430793 | DE = -8.28e-04 | DW = 1.22e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.118 | E =     -75.7294405398 | DE = -1.97e-04 | DW = 1.57e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     44.771 | E =     -75.7294894475 | DE = -4.89e-05 | DW = 2.64e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     48.965 | E =     -75.7294946667 | DE = -5.22e-06 | DW = 1.69e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.037 | E =     -75.7294958952 | DE = -1.23e-06 | DW = 2.61e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     56.335 | E =     -75.7294967021 | DE = -8.07e-07 | DW = 1.70e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     60.639 | E =     -75.7294969435 | DE = -2.41e-07 | DW = 2.63e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     64.597 | E =     -75.7294980969 | DE = -1.15e-06 | DW = 1.74e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     71.710 | E =     -75.7296228800 | DE = -1.25e-04 | DW = 2.21e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     81.707 | E =     -75.7296479394 | DE = -2.51e-05 | DW = 1.20e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     90.734 | E =     -75.7296532805 | DE = -5.34e-06 | DW = 3.26e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    100.682 | E =     -75.7296532924 | DE = -1.19e-08 | DW = 1.24e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.549 | E =     -75.7296534108 | DE = -1.18e-07 | DW = 3.26e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.802 | E =     -75.7296534326 | DE = -2.17e-08 | DW = 1.26e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    132.544 | E =     -75.7296534261 | DE = 6.47e-09 | DW = 3.26e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    142.491 | E =     -75.7296534647 | DE = -3.87e-08 | DW = 1.26e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    163.768 | E =     -75.7296639723 | DE = -1.05e-05 | DW = 2.24e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    189.199 | E =     -75.7296648879 | DE = -9.16e-07 | DW = 9.25e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    214.837 | E =     -75.7296650740 | DE = -1.86e-07 | DW = 2.06e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    241.490 | E =     -75.7296649542 | DE = 1.20e-07 | DW = 8.00e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    268.513 | E =     -75.7296650699 | DE = -1.16e-07 | DW = 2.03e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    296.272 | E =     -75.7296649520 | DE = 1.18e-07 | DW = 7.97e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    321.615 | E =     -75.7296650705 | DE = -1.18e-07 | DW = 2.03e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    346.717 | E =     -75.7296649525 | DE = 1.18e-07 | DW = 7.97e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    392.629 | E =     -75.7296657928 | DE = -8.40e-07 | DW = 4.61e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    426.440 | E =     -75.7296657928 | DE = -1.01e-11 | DW = 4.61e-08

E(MRCI) = -75.72966579282162  E_corr = -0.1067799189300587
Time cost =    797.048
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 16:55:55 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.322943027300 AA    0.000000000000   0.000000000000   2.500000000000 Bohr   0.0

nuclear repulsion = 14.4
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.25]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    108325.57


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp8s9zelms
max_memory 4000 MB (current use 5092 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.3694175262293

WARN: Singularity detected in overlap matrix (condition number =  483). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.23337660812262  LUMO (Ag) = -0.177980136770163
cycle= 1 E= -75.3638092539421  delta_E= 0.00561  |g|= 0.211  |ddm|= 1.47
HOMO (B3u) = -0.472745514482944  LUMO (Ag) = -0.148264279814741
cycle= 2 E= -75.3797344374882  delta_E= -0.0159  |g|= 0.0521  |ddm|= 0.252
HOMO (B2u) = -0.435707130637764  LUMO (Ag) = -0.10762354329793
cycle= 3 E= -75.3805941182358  delta_E= -0.00086  |g|= 0.00941  |ddm|= 0.058
HOMO (B2u) = -0.43682644742338  LUMO (Ag) = -0.105984728580028
cycle= 4 E= -75.3806472395887  delta_E= -5.31e-05  |g|= 0.00184  |ddm|= 0.0247
HOMO (B3u) = -0.437581210136121  LUMO (Ag) = -0.106606422286032
cycle= 5 E= -75.3806494262656  delta_E= -2.19e-06  |g|= 0.000123  |ddm|= 0.0084
HOMO (B3u) = -0.437555273305047  LUMO (Ag) = -0.106565393729154
cycle= 6 E= -75.3806494342396  delta_E= -7.97e-09  |g|= 2.47e-05  |ddm|= 0.000449
HOMO (B3u) = -0.437550531930258  LUMO (Ag) = -0.106557643143761
cycle= 7 E= -75.3806494346655  delta_E= -4.26e-10  |g|= 3.1e-06  |ddm|= 0.000106
HOMO (B2u) = -0.437550642586866  LUMO (Ag) = -0.106557057009268
cycle= 8 E= -75.380649434671  delta_E= -5.43e-12  |g|= 3.13e-07  |ddm|= 2.83e-05
HOMO (B3u) = -0.437550627656463  LUMO (Ag) = -0.106556986157319
cycle= 9 E= -75.380649434671  delta_E= 1.42e-14  |g|= 1.55e-08  |ddm|= 1.79e-06
HOMO (B2u) = -0.437550624651401  LUMO (Ag) = -0.106556982907058
cycle= 10 E= -75.380649434671  delta_E= -7.11e-14  |g|= 1.93e-09  |ddm|= 3.85e-08
HOMO (B2u) = -0.437550624780239  LUMO (Ag) = -0.106556982982804
cycle= 11 E= -75.380649434671  delta_E= 7.11e-14  |g|= 1.07e-09  |ddm|= 2.21e-09
HOMO (B2u) = -0.437550625017937  LUMO (Ag) = -0.106556983191543
cycle= 12 E= -75.3806494346711  delta_E= -9.95e-14  |g|= 9.86e-10  |ddm|= 1.7e-09
HOMO (B2u) = -0.43755062498644  LUMO (Ag) = -0.106556983144878
cycle= 13 E= -75.380649434671  delta_E= 8.53e-14  |g|= 7.72e-10  |ddm|= 7.35e-10
HOMO (B3u) = -0.437550624987075  LUMO (Ag) = -0.106556983115228
cycle= 14 E= -75.380649434671  delta_E= 1.42e-14  |g|= 6.86e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.437550624979848  LUMO (Ag) = -0.106556983104247
cycle= 15 E= -75.380649434671  delta_E= -7.11e-14  |g|= 5.97e-10  |ddm|= 5.75e-10
HOMO (B2u) = -0.437550624972201  LUMO (Ag) = -0.106556983130717
cycle= 16 E= -75.3806494346709  delta_E= 1.14e-13  |g|= 5.63e-10  |ddm|= 8.69e-10
HOMO (B3u) = -0.437550624903759  LUMO (Ag) = -0.106556983105396
cycle= 17 E= -75.3806494346711  delta_E= -1.71e-13  |g|= 6.09e-10  |ddm|= 7.77e-10
HOMO (B2u) = -0.437550624889816  LUMO (Ag) = -0.106556983016551
cycle= 18 E= -75.380649434671  delta_E= 8.53e-14  |g|= 2.01e-10  |ddm|= 9.04e-10
HOMO (B3u) = -0.437550624887783  LUMO (Ag) = -0.106556983009412
cycle= 19 E= -75.380649434671  delta_E= -2.84e-14  |g|= 1.59e-10  |ddm|= 1.05e-10
HOMO (B3u) = -0.437550624886698  LUMO (Ag) = -0.106556983005798
cycle= 20 E= -75.380649434671  delta_E= 7.11e-14  |g|= 1.38e-10  |ddm|= 5.43e-11
HOMO (B3u) = -0.43755062489201  LUMO (Ag) = -0.106556983007984
cycle= 21 E= -75.3806494346709  delta_E= 4.26e-14  |g|= 1.15e-10  |ddm|= 7.55e-11
HOMO (B3u) = -0.437550624896088  LUMO (Ag) = -0.10655698300968
cycle= 22 E= -75.380649434671  delta_E= -8.53e-14  |g|= 9.78e-11  |ddm|= 6.22e-11
HOMO (B3u) = -0.437550624898343  LUMO (Ag) = -0.106556983011033
cycle= 23 E= -75.380649434671  delta_E= 1.42e-14  |g|= 8.2e-11  |ddm|= 3.85e-11
HOMO (B3u) = -0.437550624900005  LUMO (Ag) = -0.106556983011851
cycle= 24 E= -75.380649434671  delta_E=    0  |g|= 6.8e-11  |ddm|= 3.11e-11
HOMO (B3u) = -0.437550624900992  LUMO (Ag) = -0.106556983005128
Extra cycle  E= -75.3806494346709  delta_E= 7.11e-14  |g|= 2.2e-11  |ddm|= 8.38e-11
converged SCF energy = -75.3806494346709

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp8s9zelms
max_memory 4000 MB (current use 5092 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5520156742906  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5749505591389  dE = -0.022934885  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5893012124507  dE = -0.014350653  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0632  |maxRot[o]|=0.0798
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5977688165921  dE = -0.0084676041  S^2 = 0.0000000
               |grad[o]|=0.0889  |ddm|=0.0299  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6039880943573  dE = -0.0062192778  S^2 = 0.0000000
               |grad[o]|=0.071  |ddm|=0.0135  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6089050842787  dE = -0.0049169899  S^2 = 0.0000000
               |grad[o]|=0.0571  |ddm|=0.00834  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6128207739006  dE = -0.0039156896  S^2 = 0.0000000
               |grad[o]|=0.0454  |ddm|=0.00603  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6158465880878  dE = -0.0030258142  S^2 = 0.0000000
               |grad[o]|=0.0352  |ddm|=0.00484  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6180396497449  dE = -0.0021930617  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6194395438653  dE = -0.0013998941  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00412  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6200886570631  dE = -0.0006491132  S^2 = 0.0000000
               |grad[o]|=0.00981  |ddm|=0.00428  |maxRot[o]|=0.0799
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6201507315124  dE = -6.2074449e-05  S^2 = 0.0000000
               |grad[o]|=0.00282  |ddm|=0.00468  |maxRot[o]|=0.0311
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6201515469886  dE = -8.1547611e-07  S^2 = 0.0000000
               |grad[o]|=0.000473  |ddm|=0.00207  |maxRot[o]|=0.00308
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6201515639995  dE = -1.7010905e-08  S^2 = 0.0000000
               |grad[o]|=7.61e-05  |ddm|=0.000375  |maxRot[o]|=0.000388
macro iter 14 (4 JK  0 micro), CASSCF E = -75.6201515647055  dE = -7.0602368e-10  S^2 = 0.0000000
               |grad[o]|=1.95e-05  |ddm|=7.56e-05  |maxRot[o]|=7.72e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.620151564741  dE = -3.5555558e-11  S^2 = 0.0000000
               |grad[o]|=5.8e-06  |ddm|=1.97e-05  |maxRot[o]|=5.36e-06
2-step CASSCF converged in 15 macro (77 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98175021 1.63550568 1.87115526 1.87115612 0.36118663 0.13173034
 0.13173046 0.01578531]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00465   0.00301   0.00000   0.00000  -0.00114
  0 C 2s       0.60227   0.53958  -0.00000  -0.00000  -0.36778
  0 C 3s      -0.04374   0.00880  -0.00000  -0.00000  -0.00363
  0 C 2px      0.00000  -0.00000  -0.00000   0.70650  -0.00000
  0 C 2py      0.00000   0.00000   0.70650  -0.00000   0.00000
  0 C 2pz      0.36367  -0.45689  -0.00000  -0.00000   0.60226
  0 C 3px      0.00000  -0.00000   0.00000  -0.00009   0.00000
  0 C 3py     -0.00000   0.00000  -0.00009  -0.00000   0.00000
  0 C 3pz     -0.04268  -0.00383  -0.00000  -0.00000  -0.04233
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.02932  -0.00000   0.00000
  0 C 3dz^2    0.03544   0.00032  -0.00000  -0.00000   0.01448
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02932   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00465  -0.00301   0.00000   0.00000  -0.00114
  1 C 2s       0.60227  -0.53958   0.00000   0.00000  -0.36778
  1 C 3s      -0.04374  -0.00880   0.00000   0.00000  -0.00363
  1 C 2px     -0.00000   0.00000  -0.00000   0.70650  -0.00000
  1 C 2py      0.00000  -0.00000   0.70650   0.00000  -0.00000
  1 C 2pz     -0.36367  -0.45689  -0.00000   0.00000  -0.60226
  1 C 3px     -0.00000   0.00000   0.00000  -0.00009   0.00000
  1 C 3py     -0.00000  -0.00000  -0.00009   0.00000  -0.00000
  1 C 3pz      0.04268  -0.00383  -0.00000  -0.00000   0.04233
  1 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000  -0.02932  -0.00000   0.00000
  1 C 3dz^2    0.03544  -0.00032   0.00000   0.00000   0.01448
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02932  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s      -0.00000  -0.00000   0.45623
  0 C 3s      -0.00000  -0.00000  -0.04293
  0 C 2px      0.70638   0.00000  -0.00000
  0 C 2py      0.00000   0.70638  -0.00000
  0 C 2pz      0.00000  -0.00000   0.53783
  0 C 3px     -0.02172   0.00000  -0.00000
  0 C 3py      0.00000  -0.02172  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01389
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02345  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02369
  0 C 3dxz    -0.02345   0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s       0.00000   0.00000  -0.45623
  1 C 3s       0.00000   0.00000   0.04293
  1 C 2px     -0.70638  -0.00000   0.00000
  1 C 2py     -0.00000  -0.70638   0.00000
  1 C 2pz      0.00000  -0.00000   0.53783
  1 C 3px      0.02172  -0.00000   0.00000
  1 C 3py     -0.00000   0.02172   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01389
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02345  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02369
  1 C 3dxz    -0.02345   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99374270
<CAS-nat-orb|mo-hf>  4  4    0.99831642
<CAS-nat-orb|mo-hf>  5  5    0.99972153
<CAS-nat-orb|mo-hf>  6  6    0.99972153
<CAS-nat-orb|mo-hf>  7  7    0.97735855
<CAS-nat-orb|mo-hf>  8  8    0.94866400
<CAS-nat-orb|mo-hf>  9  9    0.94866407
<CAS-nat-orb|mo-hf>  10  10    0.53130920
<CAS-nat-orb|mo-hf>  10  17    0.68518175
<CAS-nat-orb|mo-hf>  10  18   -0.46282825
CASSCF energy = -75.620151564741
CASCI E = -75.620151564741  E(CI) = -17.3010862554014  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.006
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.012

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.061
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.015
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.005
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.010
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.015
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.112
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.08
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.11
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.325 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.199 | Tfpread = 0.000 | Tfpwrite = 0.192 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.644 | E =     -75.6973222005 | DW = 1.94e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.211 | E =     -75.7248076914 | DE = -2.75e-02 | DW = 8.50e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.183 | E =     -75.7253604215 | DE = -5.53e-04 | DW = 1.51e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.266 | E =     -75.7259683636 | DE = -6.08e-04 | DW = 1.06e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.234 | E =     -75.7259775320 | DE = -9.17e-06 | DW = 1.59e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.313 | E =     -75.7259945228 | DE = -1.70e-05 | DW = 1.07e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.281 | E =     -75.7259910011 | DE = 3.52e-06 | DW = 1.60e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.267 | E =     -75.7259946811 | DE = -3.68e-06 | DW = 1.07e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     11.958 | E =     -75.7268572051 | DE = -8.63e-04 | DW = 1.28e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     16.053 | E =     -75.7270628080 | DE = -2.06e-04 | DW = 1.68e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     19.614 | E =     -75.7271160654 | DE = -5.33e-05 | DW = 2.80e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.676 | E =     -75.7271229573 | DE = -6.89e-06 | DW = 1.86e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.092 | E =     -75.7271231818 | DE = -2.25e-07 | DW = 2.78e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.884 | E =     -75.7271247455 | DE = -1.56e-06 | DW = 1.86e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.146 | E =     -75.7271241343 | DE = 6.11e-07 | DW = 2.79e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     37.635 | E =     -75.7271252763 | DE = -1.14e-06 | DW = 1.86e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     45.867 | E =     -75.7272545746 | DE = -1.29e-04 | DW = 2.28e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     56.196 | E =     -75.7272806470 | DE = -2.61e-05 | DW = 1.25e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     65.846 | E =     -75.7272861349 | DE = -5.49e-06 | DW = 3.39e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     75.944 | E =     -75.7272862269 | DE = -9.20e-08 | DW = 1.29e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     85.482 | E =     -75.7272863139 | DE = -8.70e-08 | DW = 3.39e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     95.316 | E =     -75.7272863341 | DE = -2.02e-08 | DW = 1.30e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    104.637 | E =     -75.7272863369 | DE = -2.82e-09 | DW = 3.39e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    114.585 | E =     -75.7272863644 | DE = -2.75e-08 | DW = 1.30e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    135.108 | E =     -75.7272972880 | DE = -1.09e-05 | DW = 2.31e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    166.360 | E =     -75.7272982329 | DE = -9.45e-07 | DW = 9.56e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    195.010 | E =     -75.7272984300 | DE = -1.97e-07 | DW = 2.11e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    223.986 | E =     -75.7272983043 | DE = 1.26e-07 | DW = 8.30e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    251.191 | E =     -75.7272984333 | DE = -1.29e-07 | DW = 2.08e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    278.306 | E =     -75.7272983066 | DE = 1.27e-07 | DW = 8.29e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    304.288 | E =     -75.7272984354 | DE = -1.29e-07 | DW = 2.08e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    330.740 | E =     -75.7272983080 | DE = 1.27e-07 | DW = 8.30e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    371.725 | E =     -75.7272991991 | DE = -8.91e-07 | DW = 4.85e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    402.859 | E =     -75.7272991991 | DE = -4.42e-12 | DW = 4.85e-08

E(MRCI) = -75.72729919906713  E_corr = -0.1071476343260969
Time cost =    464.775
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:03:40 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.349401887846 AA    0.000000000000   0.000000000000   2.550000000000 Bohr   0.0

nuclear repulsion = 14.1176470588235
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.275]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    114939.21


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp6mhowcpq
max_memory 4000 MB (current use 5090 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.322852658808

WARN: Singularity detected in overlap matrix (condition number =  444). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.224183141291851  LUMO (Ag) = -0.175375833613537
cycle= 1 E= -75.3580302281757  delta_E= -0.0352  |g|= 0.215  |ddm|= 1.46
HOMO (B3u) = -0.467759172708484  LUMO (Ag) = -0.149454753798778
cycle= 2 E= -75.3746497165004  delta_E= -0.0166  |g|= 0.0521  |ddm|= 0.26
HOMO (B3u) = -0.43051679398039  LUMO (Ag) = -0.107753824209473
cycle= 3 E= -75.3755305907905  delta_E= -0.000881  |g|= 0.00966  |ddm|= 0.0568
HOMO (B3u) = -0.431561534231314  LUMO (Ag) = -0.105750596270451
cycle= 4 E= -75.375586878976  delta_E= -5.63e-05  |g|= 0.00191  |ddm|= 0.0225
HOMO (B3u) = -0.432324246357025  LUMO (Ag) = -0.106325540767304
cycle= 5 E= -75.3755892675815  delta_E= -2.39e-06  |g|= 0.000174  |ddm|= 0.00743
HOMO (B3u) = -0.432284401985618  LUMO (Ag) = -0.106263967776653
cycle= 6 E= -75.3755892854562  delta_E= -1.79e-08  |g|= 3.01e-05  |ddm|= 0.000369
HOMO (B3u) = -0.432278729183663  LUMO (Ag) = -0.106254488809749
cycle= 7 E= -75.3755892860987  delta_E= -6.43e-10  |g|= 3.64e-06  |ddm|= 0.000169
HOMO (B3u) = -0.432278901425334  LUMO (Ag) = -0.106253945307322
cycle= 8 E= -75.3755892861055  delta_E= -6.82e-12  |g|= 3.45e-07  |ddm|= 2.86e-05
HOMO (B3u) = -0.432278883343894  LUMO (Ag) = -0.106253871171358
cycle= 9 E= -75.3755892861056  delta_E= -7.11e-14  |g|= 1.65e-08  |ddm|= 2.14e-06
HOMO (B3u) = -0.432278879789833  LUMO (Ag) = -0.10625386864663
cycle= 10 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 2.15e-09  |ddm|= 4.37e-08
HOMO (B3u) = -0.432278879857054  LUMO (Ag) = -0.106253868618805
cycle= 11 E= -75.3755892861056  delta_E= -1.28e-13  |g|= 1.22e-09  |ddm|= 2.26e-09
HOMO (B3u) = -0.432278880151781  LUMO (Ag) = -0.1062538688911
cycle= 12 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 1.11e-09  |ddm|= 9.93e-10
HOMO (B3u) = -0.432278880104388  LUMO (Ag) = -0.106253868832283
cycle= 13 E= -75.3755892861056  delta_E= -1.14e-13  |g|= 8.75e-10  |ddm|= 7.61e-10
HOMO (B3u) = -0.432278880095663  LUMO (Ag) = -0.106253868794125
cycle= 14 E= -75.3755892861056  delta_E= 2.84e-14  |g|= 7.5e-10  |ddm|= 1.05e-09
HOMO (B3u) = -0.432278880082216  LUMO (Ag) = -0.106253868781101
cycle= 15 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 6.68e-10  |ddm|= 7.64e-10
HOMO (B3u) = -0.432278880089643  LUMO (Ag) = -0.106253868822494
cycle= 16 E= -75.3755892861055  delta_E= 2.84e-14  |g|= 6.2e-10  |ddm|= 1.23e-09
HOMO (B3u) = -0.432278880013176  LUMO (Ag) = -0.106253868780759
cycle= 17 E= -75.3755892861056  delta_E= -1.14e-13  |g|= 6.62e-10  |ddm|= 8.79e-10
HOMO (B3u) = -0.43227887997921  LUMO (Ag) = -0.106253868675898
cycle= 18 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 2.29e-10  |ddm|= 1.04e-09
HOMO (B3u) = -0.432278879978759  LUMO (Ag) = -0.106253868669243
cycle= 19 E= -75.3755892861056  delta_E= -5.68e-14  |g|= 1.8e-10  |ddm|= 1.33e-10
HOMO (B3u) = -0.432278879978558  LUMO (Ag) = -0.106253868666114
cycle= 20 E= -75.3755892861055  delta_E= 5.68e-14  |g|= 1.56e-10  |ddm|= 8.29e-11
HOMO (B3u) = -0.432278879985215  LUMO (Ag) = -0.106253868669413
cycle= 21 E= -75.3755892861056  delta_E= -4.26e-14  |g|= 1.29e-10  |ddm|= 8.79e-11
HOMO (B2u) = -0.432278879990252  LUMO (Ag) = -0.106253868671841
cycle= 22 E= -75.3755892861056  delta_E= -1.42e-14  |g|= 1.09e-10  |ddm|= 7.49e-11
HOMO (B3u) = -0.432278879993466  LUMO (Ag) = -0.106253868673931
cycle= 23 E= -75.3755892861055  delta_E= 8.53e-14  |g|= 9.17e-11  |ddm|= 5.23e-11
HOMO (B2u) = -0.432278879995674  LUMO (Ag) = -0.106253868674858
cycle= 24 E= -75.3755892861055  delta_E=    0  |g|= 7.55e-11  |ddm|= 3.9e-11
HOMO (B2u) = -0.432278879997426  LUMO (Ag) = -0.106253868668085
Extra cycle  E= -75.3755892861055  delta_E=    0  |g|= 2.45e-11  |ddm|= 9.37e-11
converged SCF energy = -75.3755892861055

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp6mhowcpq
max_memory 4000 MB (current use 5090 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5487757489226  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5722713022268  dE = -0.023495553  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.585744931768  dE = -0.01347363  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0659  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5940429034159  dE = -0.0082979716  S^2 = 0.0000000
               |grad[o]|=0.0897  |ddm|=0.029  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.6002041743312  dE = -0.0061612709  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0141  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6050818819346  dE = -0.0048777076  S^2 = 0.0000000
               |grad[o]|=0.0582  |ddm|=0.00894  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6089576814858  dE = -0.0038757996  S^2 = 0.0000000
               |grad[o]|=0.0463  |ddm|=0.00649  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6119401746749  dE = -0.0029824932  S^2 = 0.0000000
               |grad[o]|=0.0358  |ddm|=0.00515  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6140855047819  dE = -0.0021453301  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00446  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6154331097064  dE = -0.0013476049  S^2 = 0.0000000
               |grad[o]|=0.0176  |ddm|=0.00427  |maxRot[o]|=0.0799
macro iter 10 (6 JK  0 micro), CASSCF E = -75.6160256894793  dE = -0.00059257977  S^2 = 0.0000000
               |grad[o]|=0.00954  |ddm|=0.00447  |maxRot[o]|=0.0799
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6160629769087  dE = -3.7287429e-05  S^2 = 0.0000000
               |grad[o]|=0.00234  |ddm|=0.00497  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6160660550402  dE = -3.0781315e-06  S^2 = 0.0000000
               |grad[o]|=0.00071  |ddm|=0.00145  |maxRot[o]|=0.00664
macro iter 13 (3 JK  0 micro), CASSCF E = -75.616066104516  dE = -4.9475872e-08  S^2 = 0.0000000
               |grad[o]|=0.000121  |ddm|=0.000548  |maxRot[o]|=0.000716
macro iter 14 (3 JK  0 micro), CASSCF E = -75.6160661058705  dE = -1.3544934e-09  S^2 = 0.0000000
               |grad[o]|=2.27e-05  |ddm|=0.000101  |maxRot[o]|=9.64e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6160661059279  dE = -5.7426064e-11  S^2 = 0.0000000
               |grad[o]|=6.82e-06  |ddm|=1.86e-05  |maxRot[o]|=1.72e-05
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98089629 1.64657004 1.86373099 1.86373155 0.35078072 0.13883206
 0.13883218 0.01662617]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00498   0.00310   0.00000   0.00000  -0.00109
  0 C 2s       0.60537   0.54713  -0.00000   0.00000  -0.36277
  0 C 3s      -0.04187   0.00880  -0.00000  -0.00000  -0.00080
  0 C 2px      0.00000  -0.00000   0.00000   0.70653  -0.00000
  0 C 2py      0.00000  -0.00000   0.70653  -0.00000   0.00000
  0 C 2pz      0.35902  -0.44783   0.00000   0.00000   0.60525
  0 C 3px     -0.00000   0.00000   0.00000   0.00282   0.00000
  0 C 3py     -0.00000   0.00000   0.00282   0.00000   0.00000
  0 C 3pz     -0.04100  -0.00346  -0.00000  -0.00000  -0.04273
  0 C 3dxy    -0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.02846  -0.00000   0.00000
  0 C 3dz^2    0.03432  -0.00015  -0.00000  -0.00000   0.01561
  0 C 3dxz    -0.00000   0.00000   0.00000   0.02846   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 1s       0.00498  -0.00310   0.00000   0.00000  -0.00109
  1 C 2s       0.60537  -0.54713   0.00000   0.00000  -0.36277
  1 C 3s      -0.04187  -0.00880   0.00000   0.00000  -0.00080
  1 C 2px      0.00000  -0.00000  -0.00000   0.70653  -0.00000
  1 C 2py      0.00000  -0.00000   0.70653  -0.00000  -0.00000
  1 C 2pz     -0.35902  -0.44783   0.00000   0.00000  -0.60525
  1 C 3px     -0.00000   0.00000  -0.00000   0.00282   0.00000
  1 C 3py     -0.00000   0.00000   0.00282   0.00000  -0.00000
  1 C 3pz      0.04100  -0.00346  -0.00000  -0.00000   0.04273
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02846  -0.00000   0.00000
  1 C 3dz^2    0.03432   0.00015   0.00000  -0.00000   0.01561
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.02846  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s       0.00000  -0.00000   0.44717
  0 C 3s       0.00000   0.00000  -0.04302
  0 C 2px      0.70642  -0.00000   0.00000
  0 C 2py      0.00000   0.70642   0.00000
  0 C 2pz      0.00000   0.00000   0.54537
  0 C 3px     -0.02076  -0.00000   0.00000
  0 C 3py     -0.00000  -0.02076   0.00000
  0 C 3pz      0.00000   0.00000   0.01534
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02331   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02287
  0 C 3dxz    -0.02331  -0.00000   0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000  -0.00000  -0.44717
  1 C 3s      -0.00000  -0.00000   0.04302
  1 C 2px     -0.70642   0.00000  -0.00000
  1 C 2py      0.00000  -0.70642   0.00000
  1 C 2pz      0.00000  -0.00000   0.54537
  1 C 3px      0.02076   0.00000  -0.00000
  1 C 3py     -0.00000   0.02076  -0.00000
  1 C 3pz      0.00000  -0.00000   0.01534
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02331   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02287
  1 C 3dxz    -0.02331  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99344301
<CAS-nat-orb|mo-hf>  4  4    0.99822554
<CAS-nat-orb|mo-hf>  5  5    0.99969500
<CAS-nat-orb|mo-hf>  6  6    0.99969500
<CAS-nat-orb|mo-hf>  7  7    0.97683026
<CAS-nat-orb|mo-hf>  8  8    0.95239320
<CAS-nat-orb|mo-hf>  9  9    0.95239323
<CAS-nat-orb|mo-hf>  10  10    0.55278295
<CAS-nat-orb|mo-hf>  10  17    0.68990907
<CAS-nat-orb|mo-hf>  10  18   -0.43567160
CASSCF energy = -75.6160661059279
CASCI E = -75.6160661059279  E(CI) = -17.1715112019246  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.338
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.103
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.665

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.031
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.638
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.727
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.730
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.737
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.327
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.329
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.559
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.11
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.12
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.10
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.06
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.608 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.300 | Tfpread = 0.000 | Tfpwrite = 0.291 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.191 | E =     -75.6928111922 | DW = 2.04e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     14.107 | E =     -75.7209515136 | DE = -2.81e-02 | DW = 9.00e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     17.324 | E =     -75.7215402518 | DE = -5.89e-04 | DW = 1.56e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.103 | E =     -75.7221949258 | DE = -6.55e-04 | DW = 1.13e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.629 | E =     -75.7221989119 | DE = -3.99e-06 | DW = 1.67e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     22.383 | E =     -75.7222385431 | DE = -3.96e-05 | DW = 1.14e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     23.200 | E =     -75.7222394366 | DE = -8.94e-07 | DW = 1.68e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     24.956 | E =     -75.7222387057 | DE = 7.31e-07 | DW = 1.13e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.610 | E =     -75.7231400027 | DE = -9.01e-04 | DW = 1.34e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.681 | E =     -75.7233530464 | DE = -2.13e-04 | DW = 1.81e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.608 | E =     -75.7234102588 | DE = -5.72e-05 | DW = 2.96e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.956 | E =     -75.7234172266 | DE = -6.97e-06 | DW = 1.98e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.710 | E =     -75.7234197513 | DE = -2.52e-06 | DW = 2.94e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     44.368 | E =     -75.7234220702 | DE = -2.32e-06 | DW = 2.01e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     48.107 | E =     -75.7234224687 | DE = -3.99e-07 | DW = 3.02e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.882 | E =     -75.7234219007 | DE = 5.68e-07 | DW = 1.98e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     61.528 | E =     -75.7235554830 | DE = -1.34e-04 | DW = 2.37e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     73.056 | E =     -75.7235823737 | DE = -2.69e-05 | DW = 1.31e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     82.532 | E =     -75.7235879361 | DE = -5.56e-06 | DW = 3.51e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     93.310 | E =     -75.7235880288 | DE = -9.27e-08 | DW = 1.35e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    103.429 | E =     -75.7235880891 | DE = -6.03e-08 | DW = 3.51e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    114.208 | E =     -75.7235881483 | DE = -5.92e-08 | DW = 1.36e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    125.396 | E =     -75.7235881741 | DE = -2.57e-08 | DW = 3.52e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    136.614 | E =     -75.7235882305 | DE = -5.64e-08 | DW = 1.36e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    158.702 | E =     -75.7235993908 | DE = -1.12e-05 | DW = 2.38e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    184.874 | E =     -75.7236003616 | DE = -9.71e-07 | DW = 9.86e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    211.181 | E =     -75.7236005728 | DE = -2.11e-07 | DW = 2.15e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    239.905 | E =     -75.7236005231 | DE = 4.97e-08 | DW = 1.11e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    266.293 | E =     -75.7236009223 | DE = -3.99e-07 | DW = 2.45e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    293.332 | E =     -75.7236008077 | DE = 1.15e-07 | DW = 1.07e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    319.984 | E =     -75.7236007958 | DE = 1.18e-08 | DW = 2.29e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    347.658 | E =     -75.7236006047 | DE = 1.91e-07 | DW = 8.99e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    390.786 | E =     -75.7236013958 | DE = -7.91e-07 | DW = 5.10e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    426.247 | E =     -75.7236013958 | DE = -2.60e-11 | DW = 5.10e-08

E(MRCI) = -75.7236013957878  E_corr = -0.1075352898598538
Time cost =    662.430
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:14:42 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.375860748392 AA    0.000000000000   0.000000000000   2.600000000000 Bohr   0.0

nuclear repulsion = 13.8461538461538
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.3]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    123303.53


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpmgnjisk0
max_memory 4000 MB (current use 5092 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.2781958136929

WARN: Singularity detected in overlap matrix (condition number =  409). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.215477115824913  LUMO (Ag) = -0.172896295276616
cycle= 1 E= -75.3511756370242  delta_E= -0.073  |g|= 0.218  |ddm|= 1.45
HOMO (B2u) = -0.462888168119373  LUMO (Ag) = -0.150366392380427
cycle= 2 E= -75.3684890547635  delta_E= -0.0173  |g|= 0.0521  |ddm|= 0.268
HOMO (B2u) = -0.425477509345155  LUMO (Ag) = -0.107647319512264
cycle= 3 E= -75.3693914994859  delta_E= -0.000902  |g|= 0.00999  |ddm|= 0.056
HOMO (B2u) = -0.426482502338423  LUMO (Ag) = -0.105320428216435
cycle= 4 E= -75.3694522894417  delta_E= -6.08e-05  |g|= 0.002  |ddm|= 0.0206
HOMO (B3u) = -0.427253849930309  LUMO (Ag) = -0.105864709294584
cycle= 5 E= -75.3694549331516  delta_E= -2.64e-06  |g|= 0.000217  |ddm|= 0.00651
HOMO (B3u) = -0.427202128961969  LUMO (Ag) = -0.105788865113738
cycle= 6 E= -75.3694549621127  delta_E= -2.9e-08  |g|= 3.29e-05  |ddm|= 0.000392
HOMO (B3u) = -0.427195922281588  LUMO (Ag) = -0.105778621503342
cycle= 7 E= -75.3694549628765  delta_E= -7.64e-10  |g|= 4.04e-06  |ddm|= 0.000193
HOMO (B3u) = -0.427196084833618  LUMO (Ag) = -0.105778048731891
cycle= 8 E= -75.3694549628848  delta_E= -8.24e-12  |g|= 3.71e-07  |ddm|= 2.79e-05
HOMO (B3u) = -0.427196062616053  LUMO (Ag) = -0.105777966013369
cycle= 9 E= -75.3694549628848  delta_E=    0  |g|= 1.75e-08  |ddm|= 2.3e-06
HOMO (B3u) = -0.427196058477425  LUMO (Ag) = -0.105777964390646
cycle= 10 E= -75.3694549628848  delta_E= -5.68e-14  |g|= 2.34e-09  |ddm|= 4.88e-08
HOMO (B2u) = -0.427196058514628  LUMO (Ag) = -0.105777964290619
cycle= 11 E= -75.3694549628847  delta_E= 8.53e-14  |g|= 1.36e-09  |ddm|= 2.45e-09
HOMO (B3u) = -0.427196058862663  LUMO (Ag) = -0.105777964641119
cycle= 12 E= -75.3694549628848  delta_E= -5.68e-14  |g|= 1.25e-09  |ddm|= 7.34e-10
HOMO (B3u) = -0.427196058806567  LUMO (Ag) = -0.105777964571431
cycle= 13 E= -75.3694549628848  delta_E=    0  |g|= 9.8e-10  |ddm|= 9.66e-10
HOMO (B3u) = -0.427196058787384  LUMO (Ag) = -0.1057779645259
cycle= 14 E= -75.3694549628848  delta_E=    0  |g|= 8.26e-10  |ddm|= 9.73e-10
HOMO (B2u) = -0.42719605877482  LUMO (Ag) = -0.105777964513413
cycle= 15 E= -75.3694549628849  delta_E= -8.53e-14  |g|= 7.31e-10  |ddm|= 9.07e-10
HOMO (B2u) = -0.427196058780696  LUMO (Ag) = -0.105777964558761
cycle= 16 E= -75.3694549628848  delta_E= 1.14e-13  |g|= 6.83e-10  |ddm|= 1.29e-09
HOMO (B2u) = -0.427196058709539  LUMO (Ag) = -0.105777964511268
cycle= 17 E= -75.3694549628848  delta_E= -7.11e-14  |g|= 7.11e-10  |ddm|= 6.99e-10
HOMO (B2u) = -0.427196058655214  LUMO (Ag) = -0.105777964391221
cycle= 18 E= -75.3694549628848  delta_E= 1.42e-14  |g|= 2.55e-10  |ddm|= 1.18e-09
HOMO (B2u) = -0.427196058655752  LUMO (Ag) = -0.105777964384882
cycle= 19 E= -75.3694549628849  delta_E= -5.68e-14  |g|= 2.02e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.42719605865634  LUMO (Ag) = -0.105777964382243
cycle= 20 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 1.73e-10  |ddm|= 1.06e-10
HOMO (B2u) = -0.427196058664241  LUMO (Ag) = -0.105777964386517
cycle= 21 E= -75.3694549628848  delta_E= 5.68e-14  |g|= 1.42e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.427196058670115  LUMO (Ag) = -0.105777964389646
cycle= 22 E= -75.3694549628848  delta_E=    0  |g|= 1.19e-10  |ddm|= 8.64e-11
HOMO (B2u) = -0.427196058674124  LUMO (Ag) = -0.105777964392308
cycle= 23 E= -75.3694549628848  delta_E=    0  |g|= 1e-10  |ddm|= 6.61e-11
HOMO (B2u) = -0.42719605867701  LUMO (Ag) = -0.105777964393709
cycle= 24 E= -75.3694549628848  delta_E= 2.84e-14  |g|= 8.26e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.427196058679983  LUMO (Ag) = -0.105777964393375
cycle= 25 E= -75.3694549628848  delta_E= -2.84e-14  |g|= 6.32e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.427196058681602  LUMO (Ag) = -0.105777964390984
cycle= 26 E= -75.3694549628847  delta_E= 4.26e-14  |g|= 4.2e-11  |ddm|= 4.02e-11
HOMO (B2u) = -0.427196058681037  LUMO (Ag) = -0.10577796438934
cycle= 27 E= -75.3694549628846  delta_E= 9.95e-14  |g|= 3.5e-11  |ddm|= 1.33e-11
HOMO (B2u) = -0.427196058680384  LUMO (Ag) = -0.105777964387863
cycle= 28 E= -75.3694549628847  delta_E= -4.26e-14  |g|= 2.94e-11  |ddm|= 1.04e-11
HOMO (B2u) = -0.427196058679697  LUMO (Ag) = -0.105777964386447
cycle= 29 E= -75.3694549628845  delta_E= 1.56e-13  |g|= 2.46e-11  |ddm|= 9.17e-12
HOMO (B2u) = -0.427196058679231  LUMO (Ag) = -0.105777964385339
cycle= 30 E= -75.3694549628845  delta_E= 5.68e-14  |g|= 2.04e-11  |ddm|= 7.88e-12
HOMO (B2u) = -0.427196058678912  LUMO (Ag) = -0.105777964384437
cycle= 31 E= -75.3694549628845  delta_E= -2.84e-14  |g|= 1.68e-11  |ddm|= 6.87e-12
HOMO (B2u) = -0.427196058678727  LUMO (Ag) = -0.105777964383681
cycle= 32 E= -75.3694549628845  delta_E= -2.84e-14  |g|= 1.37e-11  |ddm|= 6.2e-12
HOMO (B2u) = -0.427196058678654  LUMO (Ag) = -0.105777964383069
cycle= 33 E= -75.3694549628842  delta_E= 2.84e-13  |g|= 1.14e-11  |ddm|= 5.39e-12
HOMO (B2u) = -0.427196058678673  LUMO (Ag) = -0.105777964382662
cycle= 34 E= -75.369454962884  delta_E= 2.56e-13  |g|= 9.05e-12  |ddm|= 5.76e-12
HOMO (B2u) = -0.427196058678717  LUMO (Ag) = -0.10577796438244
cycle= 35 E= -75.3694549628838  delta_E= 2.13e-13  |g|= 7.86e-12  |ddm|= 4.5e-12
HOMO (B2u) = -0.42719605867873  LUMO (Ag) = -0.105777964382237
cycle= 36 E= -75.3694549628834  delta_E= 4.12e-13  |g|= 7.43e-12  |ddm|= 3.55e-12
HOMO (B2u) = -0.427196058678704  LUMO (Ag) = -0.10577796438203
cycle= 37 E= -75.3694549628825  delta_E= 8.24e-13  |g|= 8.56e-12  |ddm|= 2.58e-12
HOMO (B2u) = -0.42719605867862  LUMO (Ag) = -0.105777964381811
cycle= 38 E= -75.3694549628826  delta_E= -5.68e-14  |g|= 7.16e-12  |ddm|= 4.33e-12
HOMO (B2u) = -0.427196058678525  LUMO (Ag) = -0.105777964381607
cycle= 39 E= -75.3694549628825  delta_E= 8.53e-14  |g|= 6.14e-12  |ddm|= 3.95e-12
HOMO (B2u) = -0.427196058678412  LUMO (Ag) = -0.105777964381397
cycle= 40 E= -75.3694549628826  delta_E= -8.53e-14  |g|= 5.2e-12  |ddm|= 4.72e-12
HOMO (B2u) = -0.427196058678298  LUMO (Ag) = -0.1057779643812
cycle= 41 E= -75.3694549628827  delta_E= -5.68e-14  |g|= 4.58e-12  |ddm|= 5.12e-12
HOMO (B2u) = -0.427196058678192  LUMO (Ag) = -0.105777964381022
cycle= 42 E= -75.3694549628827  delta_E= -4.26e-14  |g|= 3.51e-12  |ddm|= 7e-12
HOMO (B2u) = -0.427196058678093  LUMO (Ag) = -0.105777964380859
cycle= 43 E= -75.3694549628829  delta_E= -1.85e-13  |g|= 3.26e-12  |ddm|= 5.78e-12
HOMO (B2u) = -0.427196058678007  LUMO (Ag) = -0.105777964380704
cycle= 44 E= -75.3694549628829  delta_E= -1.42e-14  |g|= 2.91e-12  |ddm|= 5.96e-12
HOMO (B2u) = -0.427196058677939  LUMO (Ag) = -0.105777964380566
cycle= 45 E= -75.369454962883  delta_E= -9.95e-14  |g|= 3.04e-12  |ddm|= 6.06e-12
HOMO (B2u) = -0.42719605867791  LUMO (Ag) = -0.105777964380457
cycle= 46 E= -75.3694549628831  delta_E= -8.53e-14  |g|= 2.82e-12  |ddm|= 3.79e-12
HOMO (B2u) = -0.427196058677882  LUMO (Ag) = -0.105777964380346
cycle= 47 E= -75.3694549628833  delta_E= -1.85e-13  |g|= 3.42e-12  |ddm|= 4.78e-12
HOMO (B2u) = -0.427196058677869  LUMO (Ag) = -0.105777964380263
cycle= 48 E= -75.3694549628835  delta_E= -2.13e-13  |g|= 3.6e-12  |ddm|= 6.58e-12
HOMO (B2u) = -0.427196058677852  LUMO (Ag) = -0.105777964380192
cycle= 49 E= -75.3694549628835  delta_E=    0  |g|= 3.27e-12  |ddm|= 7.68e-12
HOMO (B2u) = -0.427196058677767  LUMO (Ag) = -0.105777964379991
Extra cycle  E= -75.3694549628835  delta_E=    0  |g|= 8.86e-13  |ddm|= 3.37e-11
converged SCF energy = -75.3694549628835

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpmgnjisk0
max_memory 4000 MB (current use 5092 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5444984241951  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5681729303072  dE = -0.023674506  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0785
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5810861650649  dE = -0.012913235  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0676  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5892815622396  dE = -0.0081953972  S^2 = 0.0000000
               |grad[o]|=0.0906  |ddm|=0.0287  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5954078084372  dE = -0.0061262462  S^2 = 0.0000000
               |grad[o]|=0.0731  |ddm|=0.0147  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.6002514671465  dE = -0.0048436587  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.00955  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.6040806863508  dE = -0.0038292192  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.00694  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6070035233026  dE = -0.002922837  S^2 = 0.0000000
               |grad[o]|=0.0361  |ddm|=0.00545  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6090769727149  dE = -0.0020734494  S^2 = 0.0000000
               |grad[o]|=0.0263  |ddm|=0.00465  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6103421977602  dE = -0.001265225  S^2 = 0.0000000
               |grad[o]|=0.0172  |ddm|=0.00445  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6107875292991  dE = -0.00044533154  S^2 = 0.0000000
               |grad[o]|=0.00887  |ddm|=0.00473  |maxRot[o]|= 0.06
macro iter 11 (4 JK  0 micro), CASSCF E = -75.6108585947094  dE = -7.106541e-05  S^2 = 0.0000000
               |grad[o]|=0.00315  |ddm|=0.00398  |maxRot[o]|=0.0328
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6108594681549  dE = -8.7344549e-07  S^2 = 0.0000000
               |grad[o]|=0.000499  |ddm|=0.00241  |maxRot[o]|=0.00309
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6108594859766  dE = -1.7821733e-08  S^2 = 0.0000000
               |grad[o]|=7.69e-05  |ddm|=0.000368  |maxRot[o]|=0.000379
macro iter 14 (4 JK  0 micro), CASSCF E = -75.610859486604  dE = -6.2735239e-10  S^2 = 0.0000000
               |grad[o]|=1.76e-05  |ddm|=6.77e-05  |maxRot[o]|=7.05e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.6108594866193  dE = -1.529088e-11  S^2 = 0.0000000
               |grad[o]|=3.86e-06  |ddm|=1.18e-05  |maxRot[o]|=7.29e-06
2-step CASSCF converged in 15 macro (76 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.98003346 1.65708329 1.85598501 1.85598557 0.34113361 0.1461487
 0.14614889 0.01748146]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00530   0.00319   0.00000   0.00000  -0.00104
  0 C 2s       0.60847   0.55448  -0.00000  -0.00000  -0.35767
  0 C 3s      -0.03996   0.00882  -0.00000  -0.00000   0.00198
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655  -0.00000
  0 C 2py     -0.00000   0.00000   0.70655  -0.00000   0.00000
  0 C 2pz      0.35425  -0.43870  -0.00000  -0.00000   0.60822
  0 C 3px     -0.00000  -0.00000   0.00000   0.00558  -0.00000
  0 C 3py     -0.00000   0.00000   0.00558   0.00000   0.00000
  0 C 3pz     -0.03931  -0.00314  -0.00000  -0.00000  -0.04299
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02761   0.00000   0.00000
  0 C 3dz^2    0.03326  -0.00060  -0.00000  -0.00000   0.01688
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02761  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00530  -0.00319   0.00000   0.00000  -0.00104
  1 C 2s       0.60847  -0.55448   0.00000  -0.00000  -0.35767
  1 C 3s      -0.03996  -0.00882   0.00000   0.00000   0.00198
  1 C 2px     -0.00000   0.00000  -0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000  -0.00000
  1 C 2pz     -0.35425  -0.43870  -0.00000   0.00000  -0.60822
  1 C 3px      0.00000   0.00000   0.00000   0.00558   0.00000
  1 C 3py      0.00000  -0.00000   0.00558   0.00000  -0.00000
  1 C 3pz      0.03931  -0.00314  -0.00000  -0.00000   0.04299
  1 C 3dxy     0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02761  -0.00000   0.00000
  1 C 3dz^2    0.03326   0.00060   0.00000   0.00000   0.01688
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02761  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00051
  0 C 2s      -0.00000  -0.00000   0.43805
  0 C 3s      -0.00000  -0.00000  -0.04314
  0 C 2px      0.70645   0.00000   0.00000
  0 C 2py      0.00000   0.70645  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55270
  0 C 3px     -0.01985   0.00000   0.00000
  0 C 3py      0.00000  -0.01985  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01664
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02315  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02225
  0 C 3dxz    -0.02315   0.00000   0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00051
  1 C 2s      -0.00000   0.00000  -0.43805
  1 C 3s       0.00000   0.00000   0.04314
  1 C 2px     -0.70645  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70645   0.00000
  1 C 2pz      0.00000  -0.00000   0.55270
  1 C 3px      0.01985  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01985   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01664
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02315  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02225
  1 C 3dxz    -0.02315   0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99314135
<CAS-nat-orb|mo-hf>  4  4    0.99812796
<CAS-nat-orb|mo-hf>  5  5    0.99966602
<CAS-nat-orb|mo-hf>  6  6    0.99966602
<CAS-nat-orb|mo-hf>  7  7    0.97631890
<CAS-nat-orb|mo-hf>  8  8    0.95579301
<CAS-nat-orb|mo-hf>  9  9    0.95579307
<CAS-nat-orb|mo-hf>  10  10    0.57546018
<CAS-nat-orb|mo-hf>  10  17    0.69041990
<CAS-nat-orb|mo-hf>  10  18   -0.40995049
CASSCF energy = -75.6108594866193
CASCI E = -75.6108594866193  E(CI) = -17.0456438779434  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.034
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.002
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.005
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.007
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.049

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.062
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.015
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.014
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.017
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.118
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.08
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.04
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.07
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.04
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.394 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.209 | Tfpread = 0.000 | Tfpwrite = 0.200 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.505 | E =     -75.6872620256 | DW = 2.12e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.803 | E =     -75.7161252028 | DE = -2.89e-02 | DW = 9.65e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.743 | E =     -75.7166955903 | DE = -5.70e-04 | DW = 1.67e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.742 | E =     -75.7173570844 | DE = -6.61e-04 | DW = 1.18e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.668 | E =     -75.7173630025 | DE = -5.92e-06 | DW = 1.74e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.678 | E =     -75.7173678236 | DE = -4.82e-06 | DW = 1.18e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.652 | E =     -75.7173630625 | DE = 4.76e-06 | DW = 1.72e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.820 | E =     -75.7173715593 | DE = -8.50e-06 | DW = 1.18e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     10.792 | E =     -75.7183199431 | DE = -9.48e-04 | DW = 1.41e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     13.803 | E =     -75.7185452613 | DE = -2.25e-04 | DW = 1.95e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     16.449 | E =     -75.7186104507 | DE = -6.52e-05 | DW = 3.17e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     19.249 | E =     -75.7186178416 | DE = -7.39e-06 | DW = 2.15e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     21.926 | E =     -75.7186200636 | DE = -2.22e-06 | DW = 3.21e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.970 | E =     -75.7186210333 | DE = -9.70e-07 | DW = 2.17e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.634 | E =     -75.7186215757 | DE = -5.42e-07 | DW = 3.23e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.353 | E =     -75.7186209786 | DE = 5.97e-07 | DW = 2.14e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     38.244 | E =     -75.7187600713 | DE = -1.39e-04 | DW = 2.46e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     50.436 | E =     -75.7187877184 | DE = -2.76e-05 | DW = 1.35e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     61.109 | E =     -75.7187936020 | DE = -5.88e-06 | DW = 3.64e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     70.725 | E =     -75.7187936059 | DE = -3.93e-09 | DW = 1.38e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     80.349 | E =     -75.7187937413 | DE = -1.35e-07 | DW = 3.64e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     93.233 | E =     -75.7187937771 | DE = -3.58e-08 | DW = 1.40e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    105.339 | E =     -75.7187937697 | DE = 7.45e-09 | DW = 3.64e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    118.356 | E =     -75.7187938129 | DE = -4.32e-08 | DW = 1.41e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    141.229 | E =     -75.7188053456 | DE = -1.15e-05 | DW = 2.45e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    169.944 | E =     -75.7188063653 | DE = -1.02e-06 | DW = 1.02e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    198.306 | E =     -75.7188065894 | DE = -2.24e-07 | DW = 2.20e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    233.036 | E =     -75.7188068426 | DE = -2.53e-07 | DW = 1.12e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    261.617 | E =     -75.7188068603 | DE = -1.77e-08 | DW = 2.39e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    291.717 | E =     -75.7188066491 | DE = 2.11e-07 | DW = 9.37e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    318.979 | E =     -75.7188066503 | DE = -1.12e-09 | DW = 2.20e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    357.417 | E =     -75.7188068965 | DE = -2.46e-07 | DW = 1.13e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    406.661 | E =     -75.7188074697 | DE = -5.73e-07 | DW = 5.35e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    436.753 | E =     -75.7188074697 | DE = 6.08e-12 | DW = 5.35e-08

E(MRCI) = -75.71880746965809  E_corr = -0.1079479830388266
Time cost =    512.162
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:23:14 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.402319608938 AA    0.000000000000   0.000000000000   2.650000000000 Bohr   0.0

nuclear repulsion = 13.5849056603774
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.325]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    131236.26


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpcsyfrl4s
max_memory 4000 MB (current use 5092 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.2354639903452

WARN: Singularity detected in overlap matrix (condition number =  377). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.207229697178326  LUMO (Ag) = -0.170529385107339
cycle= 1 E= -75.3434515147689  delta_E= -0.108  |g|= 0.222  |ddm|= 1.45
HOMO (B3u) = -0.458125308046684  LUMO (Ag) = -0.151008288235492
cycle= 2 E= -75.3614525114845  delta_E= -0.018  |g|= 0.052  |ddm|= 0.276
HOMO (B3u) = -0.420576044882481  LUMO (Ag) = -0.107310756967327
cycle= 3 E= -75.3623762459039  delta_E= -0.000924  |g|= 0.0104  |ddm|= 0.0554
HOMO (B3u) = -0.421573778613681  LUMO (Ag) = -0.104704594692276
cycle= 4 E= -75.3624425687673  delta_E= -6.63e-05  |g|= 0.00208  |ddm|= 0.019
HOMO (B3u) = -0.422353066342063  LUMO (Ag) = -0.105232949169249
cycle= 5 E= -75.3624454885392  delta_E= -2.92e-06  |g|= 0.000251  |ddm|= 0.00568
HOMO (B3u) = -0.422292447876755  LUMO (Ag) = -0.105149049472676
cycle= 6 E= -75.3624455277622  delta_E= -3.92e-08  |g|= 3.5e-05  |ddm|= 0.000464
HOMO (B2u) = -0.422285778696182  LUMO (Ag) = -0.105138173661531
cycle= 7 E= -75.362445528617  delta_E= -8.55e-10  |g|= 4.37e-06  |ddm|= 0.0002
HOMO (B2u) = -0.422285894464517  LUMO (Ag) = -0.105137535804997
cycle= 8 E= -75.3624455286266  delta_E= -9.63e-12  |g|= 3.96e-07  |ddm|= 2.7e-05
HOMO (B3u) = -0.422285868761296  LUMO (Ag) = -0.105137442523124
cycle= 9 E= -75.3624455286268  delta_E= -1.99e-13  |g|= 1.83e-08  |ddm|= 2.34e-06
HOMO (B2u) = -0.422285864047108  LUMO (Ag) = -0.105137442034634
cycle= 10 E= -75.3624455286268  delta_E= 5.68e-14  |g|= 2.5e-09  |ddm|= 5.4e-08
HOMO (B2u) = -0.422285864208524  LUMO (Ag) = -0.105137442035486
cycle= 11 E= -75.3624455286267  delta_E= 5.68e-14  |g|= 1.63e-09  |ddm|= 2.05e-09
HOMO (B2u) = -0.422285864471731  LUMO (Ag) = -0.105137442316619
cycle= 12 E= -75.3624455286268  delta_E= -5.68e-14  |g|= 1.38e-09  |ddm|= 8.32e-10
HOMO (B3u) = -0.422285864412731  LUMO (Ag) = -0.105137442239544
cycle= 13 E= -75.3624455286267  delta_E= 1.42e-14  |g|= 1.08e-09  |ddm|= 1.18e-09
HOMO (B3u) = -0.422285864387668  LUMO (Ag) = -0.10513744218975
cycle= 14 E= -75.3624455286267  delta_E= 1.42e-14  |g|= 9.02e-10  |ddm|= 9.99e-10
HOMO (B3u) = -0.422285864372422  LUMO (Ag) = -0.105137442174053
cycle= 15 E= -75.3624455286268  delta_E= -9.95e-14  |g|= 7.9e-10  |ddm|= 8.85e-10
HOMO (B3u) = -0.42228586437712  LUMO (Ag) = -0.10513744221937
cycle= 16 E= -75.3624455286268  delta_E= 2.84e-14  |g|= 7.37e-10  |ddm|= 1.3e-09
HOMO (B3u) = -0.422285864307829  LUMO (Ag) = -0.105137442168198
cycle= 17 E= -75.3624455286268  delta_E= -1.42e-14  |g|= 7.58e-10  |ddm|= 5.5e-10
HOMO (B3u) = -0.422285864233339  LUMO (Ag) = -0.105137442035447
cycle= 18 E= -75.3624455286268  delta_E=    0  |g|= 2.86e-10  |ddm|= 1.32e-09
HOMO (B3u) = -0.422285864234577  LUMO (Ag) = -0.105137442029409
cycle= 19 E= -75.3624455286268  delta_E= 5.68e-14  |g|= 2.28e-10  |ddm|= 1.9e-10
HOMO (B3u) = -0.42228586423915  LUMO (Ag) = -0.105137442029796
cycle= 20 E= -75.3624455286268  delta_E= -2.84e-14  |g|= 1.9e-10  |ddm|= 1.38e-10
HOMO (B3u) = -0.422285864248109  LUMO (Ag) = -0.105137442034876
cycle= 21 E= -75.3624455286268  delta_E= 2.84e-14  |g|= 1.56e-10  |ddm|= 1.19e-10
HOMO (B3u) = -0.422285864254738  LUMO (Ag) = -0.105137442038669
cycle= 22 E= -75.3624455286268  delta_E= -2.84e-14  |g|= 1.3e-10  |ddm|= 9.57e-11
HOMO (B3u) = -0.422285864259431  LUMO (Ag) = -0.105137442041884
cycle= 23 E= -75.3624455286267  delta_E= 5.68e-14  |g|= 1.08e-10  |ddm|= 7.55e-11
HOMO (B3u) = -0.422285864262953  LUMO (Ag) = -0.105137442043874
cycle= 24 E= -75.3624455286266  delta_E= 8.53e-14  |g|= 8.92e-11  |ddm|= 5.7e-11
HOMO (B3u) = -0.422285864266427  LUMO (Ag) = -0.105137442044012
cycle= 25 E= -75.3624455286266  delta_E= 4.26e-14  |g|= 6.86e-11  |ddm|= 4.05e-11
HOMO (B3u) = -0.422285864268376  LUMO (Ag) = -0.105137442042108
cycle= 26 E= -75.3624455286265  delta_E= 8.53e-14  |g|= 4.61e-11  |ddm|= 4.55e-11
HOMO (B3u) = -0.422285864267577  LUMO (Ag) = -0.105137442040172
cycle= 27 E= -75.3624455286264  delta_E= 9.95e-14  |g|= 3.83e-11  |ddm|= 1.63e-11
HOMO (B3u) = -0.422285864266687  LUMO (Ag) = -0.105137442038423
cycle= 28 E= -75.3624455286263  delta_E= 1.14e-13  |g|= 3.18e-11  |ddm|= 1.22e-11
HOMO (B3u) = -0.422285864265885  LUMO (Ag) = -0.105137442036873
cycle= 29 E= -75.3624455286262  delta_E= 7.11e-14  |g|= 2.64e-11  |ddm|= 1.02e-11
HOMO (B3u) = -0.422285864265327  LUMO (Ag) = -0.10513744203567
cycle= 30 E= -75.3624455286262  delta_E=    0  |g|= 2.19e-11  |ddm|= 8.67e-12
HOMO (B3u) = -0.422285864264706  LUMO (Ag) = -0.105137442032706
Extra cycle  E= -75.3624455286261  delta_E= 9.95e-14  |g|= 7.4e-12  |ddm|= 2.75e-11
converged SCF energy = -75.3624455286261

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpcsyfrl4s
max_memory 4000 MB (current use 5092 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5393906023641  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5629975370736  dE = -0.023606935  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.75  |maxRot[o]|=0.0764
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5755556069915  dE = -0.01255807  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0687  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5836978888132  dE = -0.0081422818  S^2 = 0.0000000
               |grad[o]|=0.0915  |ddm|=0.0289  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5898048014452  dE = -0.0061069126  S^2 = 0.0000000
               |grad[o]|=0.0739  |ddm|=0.0155  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5946145711073  dE = -0.0048097697  S^2 = 0.0000000
               |grad[o]|=0.0596  |ddm|=0.0101  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5983864945643  dE = -0.0037719235  S^2 = 0.0000000
               |grad[o]|=0.0472  |ddm|=0.00736  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.6012301452596  dE = -0.0028436507  S^2 = 0.0000000
               |grad[o]|=0.036  |ddm|=0.00571  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.6032050743215  dE = -0.0019749291  S^2 = 0.0000000
               |grad[o]|=0.0259  |ddm|=0.00483  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.6043559988411  dE = -0.0011509245  S^2 = 0.0000000
               |grad[o]|=0.0165  |ddm|=0.00466  |maxRot[o]|=0.0799
macro iter 10 (5 JK  0 micro), CASSCF E = -75.6047080375019  dE = -0.00035203866  S^2 = 0.0000000
               |grad[o]|=0.00777  |ddm|=0.00509  |maxRot[o]|= 0.06
macro iter 11 (3 JK  0 micro), CASSCF E = -75.6047337083171  dE = -2.5670815e-05  S^2 = 0.0000000
               |grad[o]|=0.00195  |ddm|=0.00436  |maxRot[o]|=0.0194
macro iter 12 (3 JK  0 micro), CASSCF E = -75.6047340653384  dE = -3.5702129e-07  S^2 = 0.0000000
               |grad[o]|=0.000322  |ddm|=0.0016  |maxRot[o]|=0.00185
macro iter 13 (3 JK  0 micro), CASSCF E = -75.6047340726251  dE = -7.2867721e-09  S^2 = 0.0000000
               |grad[o]|=5.01e-05  |ddm|=0.000237  |maxRot[o]|=0.000232
macro iter 14 (4 JK  0 micro), CASSCF E = -75.604734072917  dE = -2.9186253e-10  S^2 = 0.0000000
               |grad[o]|=1.46e-05  |ddm|=3.6e-05  |maxRot[o]|=4.8e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.604734072927  dE = -1.0004442e-11  S^2 = 0.0000000
               |grad[o]|=3.88e-06  |ddm|=6.73e-06  |maxRot[o]|=3.47e-06
2-step CASSCF converged in 15 macro (75 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97916645 1.66712983 1.84789509 1.84789498 0.33219448 0.15368537
 0.15368543 0.01834836]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00560   0.00327   0.00000   0.00000  -0.00099
  0 C 2s       0.61156   0.56162   0.00000  -0.00000  -0.35247
  0 C 3s      -0.03803   0.00886   0.00000  -0.00000   0.00469
  0 C 2px     -0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py     -0.00000   0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34937  -0.42951  -0.00000  -0.00000   0.61119
  0 C 3px     -0.00000   0.00000  -0.00000   0.00818   0.00000
  0 C 3py     -0.00000   0.00000   0.00818  -0.00000  -0.00000
  0 C 3pz     -0.03762  -0.00286   0.00000  -0.00000  -0.04310
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.02675  -0.00000  -0.00000
  0 C 3dz^2    0.03225  -0.00101   0.00000  -0.00000   0.01829
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02675   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 1s       0.00560  -0.00327   0.00000   0.00000  -0.00099
  1 C 2s       0.61156  -0.56162  -0.00000   0.00000  -0.35247
  1 C 3s      -0.03803  -0.00886  -0.00000   0.00000   0.00469
  1 C 2px      0.00000  -0.00000   0.00000   0.70655  -0.00000
  1 C 2py     -0.00000  -0.00000   0.70655   0.00000   0.00000
  1 C 2pz     -0.34937  -0.42951  -0.00000  -0.00000  -0.61119
  1 C 3px      0.00000   0.00000   0.00000   0.00818  -0.00000
  1 C 3py      0.00000  -0.00000   0.00818  -0.00000   0.00000
  1 C 3pz      0.03762  -0.00286   0.00000  -0.00000   0.04310
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02675  -0.00000  -0.00000
  1 C 3dz^2    0.03225   0.00101   0.00000   0.00000   0.01829
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.02675   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00047
  0 C 2s      -0.00000   0.00000   0.42887
  0 C 3s       0.00000   0.00000  -0.04326
  0 C 2px      0.70648   0.00000  -0.00000
  0 C 2py      0.00000   0.70648  -0.00000
  0 C 2pz      0.00000  -0.00000   0.55983
  0 C 3px     -0.01896   0.00000   0.00000
  0 C 3py      0.00000  -0.01896  -0.00000
  0 C 3pz      0.00000   0.00000   0.01780
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02297  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02181
  0 C 3dxz    -0.02297   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00047
  1 C 2s      -0.00000  -0.00000  -0.42887
  1 C 3s      -0.00000  -0.00000   0.04326
  1 C 2px     -0.70648  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70648   0.00000
  1 C 2pz      0.00000  -0.00000   0.55983
  1 C 3px      0.01896  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01896   0.00000
  1 C 3pz     -0.00000   0.00000   0.01780
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.02297  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02181
  1 C 3dxz    -0.02297   0.00000   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99284123
<CAS-nat-orb|mo-hf>  4  4    0.99802530
<CAS-nat-orb|mo-hf>  5  5    0.99963455
<CAS-nat-orb|mo-hf>  6  6    0.99963455
<CAS-nat-orb|mo-hf>  7  7    0.97582840
<CAS-nat-orb|mo-hf>  8  8    0.95889489
<CAS-nat-orb|mo-hf>  9  9    0.95889488
<CAS-nat-orb|mo-hf>  10  10    0.59917813
<CAS-nat-orb|mo-hf>  10  17    0.68689326
CASSCF energy = -75.604734072927
CASCI E = -75.604734072927  E(CI) = -16.9234138781701  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.001
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.005
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.008
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.015

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.055
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.018
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.006
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.005
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.015
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.021
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.122
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.09
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.03
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.315 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.192 | Tfpread = 0.000 | Tfpwrite = 0.187 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.746 | E =     -75.6807065255 | DW = 2.20e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.289 | E =     -75.7103189914 | DE = -2.96e-02 | DW = 1.02e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.630 | E =     -75.7109011670 | DE = -5.82e-04 | DW = 1.72e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.846 | E =     -75.7115949949 | DE = -6.94e-04 | DW = 1.25e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.890 | E =     -75.7116005174 | DE = -5.52e-06 | DW = 1.81e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.986 | E =     -75.7116186597 | DE = -1.81e-05 | DW = 1.25e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.069 | E =     -75.7116214139 | DE = -2.75e-06 | DW = 1.80e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.110 | E =     -75.7116253331 | DE = -3.92e-06 | DW = 1.23e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     12.638 | E =     -75.7126185557 | DE = -9.93e-04 | DW = 1.48e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     16.718 | E =     -75.7128498777 | DE = -2.31e-04 | DW = 2.13e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.303 | E =     -75.7129200397 | DE = -7.02e-05 | DW = 3.39e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.014 | E =     -75.7129277429 | DE = -7.70e-06 | DW = 2.32e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.466 | E =     -75.7129306504 | DE = -2.91e-06 | DW = 3.43e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.702 | E =     -75.7129321271 | DE = -1.48e-06 | DW = 2.35e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     38.368 | E =     -75.7129328793 | DE = -7.52e-07 | DW = 3.45e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.722 | E =     -75.7129332450 | DE = -3.66e-07 | DW = 2.35e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     53.449 | E =     -75.7130770175 | DE = -1.44e-04 | DW = 2.55e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     66.742 | E =     -75.7131052386 | DE = -2.82e-05 | DW = 1.39e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     78.827 | E =     -75.7131114714 | DE = -6.23e-06 | DW = 3.77e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     90.995 | E =     -75.7131113675 | DE = 1.04e-07 | DW = 1.42e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    102.816 | E =     -75.7131117090 | DE = -3.41e-07 | DW = 3.77e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    114.682 | E =     -75.7131115868 | DE = 1.22e-07 | DW = 1.43e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    126.435 | E =     -75.7131117678 | DE = -1.81e-07 | DW = 3.77e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    137.853 | E =     -75.7131116496 | DE = 1.18e-07 | DW = 1.43e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    159.438 | E =     -75.7131236166 | DE = -1.20e-05 | DW = 2.52e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    185.805 | E =     -75.7131246747 | DE = -1.06e-06 | DW = 1.04e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    213.640 | E =     -75.7131253653 | DE = -6.91e-07 | DW = 2.61e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    239.733 | E =     -75.7131252411 | DE = 1.24e-07 | DW = 1.17e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    265.877 | E =     -75.7131252388 | DE = 2.31e-09 | DW = 2.45e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    294.058 | E =     -75.7131250126 | DE = 2.26e-07 | DW = 1.21e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    320.022 | E =     -75.7131253677 | DE = -3.55e-07 | DW = 2.61e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    346.657 | E =     -75.7131252419 | DE = 1.26e-07 | DW = 1.16e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    391.320 | E =     -75.7131258794 | DE = -6.37e-07 | DW = 5.59e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    424.086 | E =     -75.7131258794 | DE = -7.94e-12 | DW = 5.59e-08

E(MRCI) = -75.71312587936266  E_corr = -0.1083918064356482
Time cost =    494.384
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:31:29 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.428778469484 AA    0.000000000000   0.000000000000   2.700000000000 Bohr   0.0

nuclear repulsion = 13.3333333333333
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.35]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    138347.47


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpjbxwzjzl
max_memory 4000 MB (current use 5113 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1946578857084

WARN: Singularity detected in overlap matrix (condition number =  348). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.199413840928996  LUMO (Ag) = -0.168263344015825
cycle= 1 E= -75.3350369843805  delta_E= -0.14  |g|= 0.225  |ddm|= 1.44
HOMO (B3u) = -0.453464888109062  LUMO (Ag) = -0.151390240663931
cycle= 2 E= -75.3537139122306  delta_E= -0.0187  |g|= 0.0519  |ddm|= 0.284
HOMO (B2u) = -0.415801083744366  LUMO (Ag) = -0.106751931948702
cycle= 3 E= -75.3546580860939  delta_E= -0.000944  |g|= 0.0108  |ddm|= 0.0549
HOMO (B2u) = -0.416822160762624  LUMO (Ag) = -0.103915433790311
cycle= 4 E= -75.3547306562047  delta_E= -7.26e-05  |g|= 0.00215  |ddm|= 0.0177
HOMO (B3u) = -0.417607675822702  LUMO (Ag) = -0.104440258456578
cycle= 5 E= -75.3547338450163  delta_E= -3.19e-06  |g|= 0.000277  |ddm|= 0.00497
HOMO (B3u) = -0.417541021758629  LUMO (Ag) = -0.104353293703207
cycle= 6 E= -75.3547338927568  delta_E= -4.77e-08  |g|= 3.68e-05  |ddm|= 0.000534
HOMO (B3u) = -0.417533919980039  LUMO (Ag) = -0.104341804406659
cycle= 7 E= -75.3547338936913  delta_E= -9.35e-10  |g|= 4.65e-06  |ddm|= 0.000197
HOMO (B3u) = -0.417533963921616  LUMO (Ag) = -0.104341084871122
cycle= 8 E= -75.3547338937024  delta_E= -1.11e-11  |g|= 4.19e-07  |ddm|= 2.62e-05
HOMO (B3u) = -0.41753393566935  LUMO (Ag) = -0.104340979663722
cycle= 9 E= -75.3547338937025  delta_E= -1.14e-13  |g|= 1.9e-08  |ddm|= 2.29e-06
HOMO (B3u) = -0.417533930414545  LUMO (Ag) = -0.104340980550983
cycle= 10 E= -75.3547338937026  delta_E= -5.68e-14  |g|= 2.65e-09  |ddm|= 5.91e-08
HOMO (B2u) = -0.417533930814163  LUMO (Ag) = -0.104340980801866
cycle= 11 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 1.97e-09  |ddm|= 1.76e-09
HOMO (B3u) = -0.41753393089096  LUMO (Ag) = -0.104340980883098
cycle= 12 E= -75.3547338937025  delta_E= 5.68e-14  |g|= 1.5e-09  |ddm|= 1.89e-09
HOMO (B2u) = -0.417533930830964  LUMO (Ag) = -0.104340980797967
cycle= 13 E= -75.3547338937026  delta_E= -8.53e-14  |g|= 1.18e-09  |ddm|= 1.33e-09
HOMO (B2u) = -0.417533930794492  LUMO (Ag) = -0.104340980739339
cycle= 14 E= -75.3547338937025  delta_E= 8.53e-14  |g|= 9.83e-10  |ddm|= 9.21e-10
HOMO (B2u) = -0.417533930774647  LUMO (Ag) = -0.104340980717534
cycle= 15 E= -75.3547338937025  delta_E= -5.68e-14  |g|= 8.53e-10  |ddm|= 7.74e-10
HOMO (B2u) = -0.417533930784768  LUMO (Ag) = -0.104340980767629
cycle= 16 E= -75.3547338937026  delta_E= -1.42e-14  |g|= 7.87e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.417533930718007  LUMO (Ag) = -0.104340980715542
cycle= 17 E= -75.3547338937026  delta_E= -4.26e-14  |g|= 8.01e-10  |ddm|= 3.93e-10
HOMO (B2u) = -0.417533930624118  LUMO (Ag) = -0.104340980573331
cycle= 18 E= -75.3547338937025  delta_E= 1.14e-13  |g|= 3.17e-10  |ddm|= 1.48e-09
HOMO (B2u) = -0.417533930625805  LUMO (Ag) = -0.104340980567546
cycle= 19 E= -75.3547338937025  delta_E=    0  |g|= 2.56e-10  |ddm|= 2.19e-10
HOMO (B2u) = -0.417533930636065  LUMO (Ag) = -0.104340980572393
cycle= 20 E= -75.3547338937026  delta_E= -1.14e-13  |g|= 2.06e-10  |ddm|= 1.7e-10
HOMO (B2u) = -0.417533930645901  LUMO (Ag) = -0.104340980578134
cycle= 21 E= -75.3547338937025  delta_E= 1.14e-13  |g|= 1.69e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.417533930653113  LUMO (Ag) = -0.10434098058254
cycle= 22 E= -75.3547338937025  delta_E= -5.68e-14  |g|= 1.4e-10  |ddm|= 1.03e-10
HOMO (B2u) = -0.417533930658231  LUMO (Ag) = -0.104340980586167
cycle= 23 E= -75.3547338937026  delta_E= -5.68e-14  |g|= 1.16e-10  |ddm|= 8.49e-11
HOMO (B2u) = -0.417533930662181  LUMO (Ag) = -0.104340980588726
cycle= 24 E= -75.3547338937026  delta_E= -2.84e-14  |g|= 9.52e-11  |ddm|= 6.86e-11
HOMO (B2u) = -0.417533930666073  LUMO (Ag) = -0.104340980589479
cycle= 25 E= -75.3547338937025  delta_E= 1.42e-13  |g|= 7.35e-11  |ddm|= 4.6e-11
HOMO (B2u) = -0.417533930668318  LUMO (Ag) = -0.104340980588157
cycle= 26 E= -75.3547338937023  delta_E= 1.42e-13  |g|= 5.01e-11  |ddm|= 5.08e-11
HOMO (B2u) = -0.417533930667265  LUMO (Ag) = -0.104340980585923
cycle= 27 E= -75.3547338937023  delta_E= 5.68e-14  |g|= 4.13e-11  |ddm|= 1.86e-11
HOMO (B2u) = -0.417533930666114  LUMO (Ag) = -0.104340980583871
cycle= 28 E= -75.3547338937023  delta_E= 2.84e-14  |g|= 3.39e-11  |ddm|= 1.39e-11
HOMO (B2u) = -0.417533930665237  LUMO (Ag) = -0.104340980582245
cycle= 29 E= -75.3547338937022  delta_E= 9.95e-14  |g|= 2.81e-11  |ddm|= 1.11e-11
HOMO (B2u) = -0.417533930664623  LUMO (Ag) = -0.104340980580997
cycle= 30 E= -75.354733893702  delta_E= 1.28e-13  |g|= 2.33e-11  |ddm|= 9.23e-12
HOMO (B2u) = -0.417533930664204  LUMO (Ag) = -0.104340980580017
cycle= 31 E= -75.354733893702  delta_E= 5.68e-14  |g|= 1.92e-11  |ddm|= 7.95e-12
HOMO (B2u) = -0.417533930663939  LUMO (Ag) = -0.104340980579205
cycle= 32 E= -75.3547338937019  delta_E= 5.68e-14  |g|= 1.58e-11  |ddm|= 7.02e-12
HOMO (B2u) = -0.417533930663801  LUMO (Ag) = -0.104340980578542
cycle= 33 E= -75.3547338937015  delta_E= 4.55e-13  |g|= 1.34e-11  |ddm|= 5.96e-12
HOMO (B2u) = -0.417533930663776  LUMO (Ag) = -0.104340980578099
cycle= 34 E= -75.3547338937012  delta_E= 2.84e-13  |g|= 1.15e-11  |ddm|= 5.53e-12
HOMO (B2u) = -0.417533930663806  LUMO (Ag) = -0.104340980577842
cycle= 35 E= -75.3547338937006  delta_E= 6.25e-13  |g|= 1.08e-11  |ddm|= 3.52e-12
HOMO (B2u) = -0.417533930663776  LUMO (Ag) = -0.104340980577563
cycle= 36 E= -75.3547338936996  delta_E= 9.66e-13  |g|= 1.1e-11  |ddm|= 3.5e-12
HOMO (B2u) = -0.417533930663681  LUMO (Ag) = -0.104340980577272
cycle= 37 E= -75.3547338936989  delta_E= 6.82e-13  |g|= 1.1e-11  |ddm|= 3.09e-12
HOMO (B2u) = -0.417533930663538  LUMO (Ag) = -0.104340980576976
cycle= 38 E= -75.3547338936985  delta_E= 4.41e-13  |g|= 9.91e-12  |ddm|= 3.76e-12
HOMO (B2u) = -0.417533930663364  LUMO (Ag) = -0.104340980576671
cycle= 39 E= -75.3547338936983  delta_E= 1.56e-13  |g|= 8.52e-12  |ddm|= 4.19e-12
HOMO (B2u) = -0.417533930663179  LUMO (Ag) = -0.104340980576376
cycle= 40 E= -75.3547338936983  delta_E= 4.26e-14  |g|= 7.2e-12  |ddm|= 4.63e-12
HOMO (B2u) = -0.417533930662994  LUMO (Ag) = -0.104340980576105
cycle= 41 E= -75.3547338936981  delta_E= 2.13e-13  |g|= 6.3e-12  |ddm|= 4.1e-12
HOMO (B2u) = -0.417533930662808  LUMO (Ag) = -0.104340980575858
cycle= 42 E= -75.354733893698  delta_E= 2.84e-14  |g|= 5.47e-12  |ddm|= 4.75e-12
HOMO (B2u) = -0.417533930662632  LUMO (Ag) = -0.104340980575638
cycle= 43 E= -75.3547338936972  delta_E= 7.96e-13  |g|= 5.96e-12  |ddm|= 2.8e-12
HOMO (B2u) = -0.417533930662458  LUMO (Ag) = -0.104340980575444
cycle= 44 E= -75.3547338936962  delta_E= 9.95e-13  |g|= 6.93e-12  |ddm|= 2.31e-12
HOMO (B2u) = -0.417533930662276  LUMO (Ag) = -0.104340980575264
cycle= 45 E= -75.3547338936952  delta_E= 1.05e-12  |g|= 1.27e-11  |ddm|= 1.8e-12
HOMO (B2u) = -0.417533930662073  LUMO (Ag) = -0.104340980575074
cycle= 46 E= -75.3547338936952  delta_E= -5.68e-14  |g|= 1.13e-11  |ddm|= 1.02e-11
HOMO (B2u) = -0.417533930661889  LUMO (Ag) = -0.104340980574898
cycle= 47 E= -75.3547338936952  delta_E= 8.53e-14  |g|= 9.78e-12  |ddm|= 1.07e-11
HOMO (B2u) = -0.417533930661708  LUMO (Ag) = -0.104340980574722
cycle= 48 E= -75.3547338936952  delta_E= -2.84e-14  |g|= 8.35e-12  |ddm|= 1.13e-11
HOMO (B2u) = -0.417533930661524  LUMO (Ag) = -0.104340980574536
cycle= 49 E= -75.3547338936951  delta_E= 8.53e-14  |g|= 7.07e-12  |ddm|= 1.19e-11
HOMO (B2u) = -0.417533930661351  LUMO (Ag) = -0.104340980574346
cycle= 50 E= -75.354733893695  delta_E= 7.11e-14  |g|= 5.83e-12  |ddm|= 1.31e-11
SCF not converged.
SCF energy = -75.354733893695

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpjbxwzjzl
max_memory 4000 MB (current use 5113 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5336329215203  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5570159697823  dE = -0.023383048  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0767
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5693552301391  dE = -0.01233926  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0693  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5774785831027  dE = -0.008123353  S^2 = 0.0000000
               |grad[o]|=0.0922  |ddm|=0.0294  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.583574179373  dE = -0.0060955963  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0162  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5883444835039  dE = -0.0047703041  S^2 = 0.0000000
               |grad[o]|=0.0599  |ddm|=0.0107  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5920437676225  dE = -0.0036992841  S^2 = 0.0000000
               |grad[o]|=0.0471  |ddm|=0.00775  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5947849401533  dE = -0.0027411725  S^2 = 0.0000000
               |grad[o]|=0.0356  |ddm|=0.00594  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5966317625483  dE = -0.0018468224  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.00502  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5976344316744  dE = -0.0010026691  S^2 = 0.0000000
               |grad[o]|=0.0152  |ddm|=0.00495  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5978366751264  dE = -0.00020224345  S^2 = 0.0000000
               |grad[o]|=0.00622  |ddm|=0.00558  |maxRot[o]|= 0.04
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5978670904779  dE = -3.0415352e-05  S^2 = 0.0000000
               |grad[o]|=0.00217  |ddm|=0.00321  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5978677925341  dE = -7.0205624e-07  S^2 = 0.0000000
               |grad[o]|=0.000396  |ddm|=0.00173  |maxRot[o]|=0.00284
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5978678056029  dE = -1.3068771e-08  S^2 = 0.0000000
               |grad[o]|=6.44e-05  |ddm|=0.000312  |maxRot[o]|=0.000323
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5978678060264  dE = -4.2351189e-10  S^2 = 0.0000000
               |grad[o]|=1.43e-05  |ddm|=4.96e-05  |maxRot[o]|=6.01e-05
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5978678060471  dE = -2.0747848e-11  S^2 = 0.0000000
               |grad[o]|=3.49e-06  |ddm|=7.4e-06  |maxRot[o]|=1.25e-05
2-step CASSCF converged in 15 macro (73 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97829968 1.67678243 1.83943605 1.83943641 0.32392932 0.16144608
 0.16144608 0.01922395]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00588   0.00336   0.00000   0.00000  -0.00095
  0 C 2s       0.61465   0.56857  -0.00000  -0.00000  -0.34718
  0 C 3s      -0.03607   0.00891  -0.00000   0.00000   0.00734
  0 C 2px      0.00000  -0.00000  -0.00000   0.70655   0.00000
  0 C 2py      0.00000  -0.00000   0.70655   0.00000  -0.00000
  0 C 2pz      0.34438  -0.42027   0.00000   0.00000   0.61414
  0 C 3px      0.00000   0.00000  -0.00000   0.01064   0.00000
  0 C 3py      0.00000  -0.00000   0.01064   0.00000  -0.00000
  0 C 3pz     -0.03594  -0.00262  -0.00000   0.00000  -0.04307
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.02590   0.00000  -0.00000
  0 C 3dz^2    0.03130  -0.00139  -0.00000   0.00000   0.01982
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02590   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 1s       0.00588  -0.00336   0.00000   0.00000  -0.00095
  1 C 2s       0.61465  -0.56857   0.00000  -0.00000  -0.34718
  1 C 3s      -0.03607  -0.00891   0.00000  -0.00000   0.00734
  1 C 2px      0.00000  -0.00000   0.00000   0.70655   0.00000
  1 C 2py      0.00000  -0.00000   0.70655  -0.00000   0.00000
  1 C 2pz     -0.34438  -0.42027   0.00000   0.00000  -0.61414
  1 C 3px     -0.00000   0.00000   0.00000   0.01064  -0.00000
  1 C 3py     -0.00000   0.00000   0.01064  -0.00000   0.00000
  1 C 3pz      0.03594  -0.00262  -0.00000   0.00000   0.04307
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02590   0.00000  -0.00000
  1 C 3dz^2    0.03130   0.00139   0.00000  -0.00000   0.01982
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02590   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00044
  0 C 2s      -0.00000  -0.00000   0.41964
  0 C 3s       0.00000  -0.00000  -0.04337
  0 C 2px      0.70651  -0.00000   0.00000
  0 C 2py     -0.00000   0.70651  -0.00000
  0 C 2pz      0.00000  -0.00000   0.56675
  0 C 3px     -0.01810  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01810  -0.00000
  0 C 3pz      0.00000  -0.00000   0.01881
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02276  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02148
  0 C 3dxz    -0.02276  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00044
  1 C 2s      -0.00000   0.00000  -0.41964
  1 C 3s      -0.00000   0.00000   0.04337
  1 C 2px     -0.70651   0.00000   0.00000
  1 C 2py      0.00000  -0.70651   0.00000
  1 C 2pz     -0.00000   0.00000   0.56675
  1 C 3px      0.01810   0.00000  -0.00000
  1 C 3py      0.00000   0.01810   0.00000
  1 C 3pz      0.00000  -0.00000   0.01881
  1 C 3dxy    -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02276  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02148
  1 C 3dxz    -0.02276  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99254645
<CAS-nat-orb|mo-hf>  4  4    0.99791956
<CAS-nat-orb|mo-hf>  5  5    0.99960057
<CAS-nat-orb|mo-hf>  6  6    0.99960057
<CAS-nat-orb|mo-hf>  7  7    0.97536360
<CAS-nat-orb|mo-hf>  8  8    0.96172744
<CAS-nat-orb|mo-hf>  9  9    0.96172746
<CAS-nat-orb|mo-hf>  10  10    0.62371776
<CAS-nat-orb|mo-hf>  10  17    0.67956595
CASSCF energy = -75.5978678060471
CASCI E = -75.5978678060471  E(CI) = -16.8047461411188  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.340
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.090
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.657

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.028
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.639
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.735
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.726
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.731
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.327
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.323
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.556
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.10
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.10
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.08
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.05
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.08
Time init sweep =        0.586 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.299 | Tfpread = 0.000 | Tfpwrite = 0.264 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.096 | E =     -75.6726340435 | DW = 2.33e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.367 | E =     -75.7038096956 | DE = -3.12e-02 | DW = 1.09e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.574 | E =     -75.7044424386 | DE = -6.33e-04 | DW = 1.81e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.518 | E =     -75.7051187361 | DE = -6.76e-04 | DW = 1.31e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.561 | E =     -75.7051298007 | DE = -1.11e-05 | DW = 1.86e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     24.506 | E =     -75.7051511444 | DE = -2.13e-05 | DW = 1.30e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     27.508 | E =     -75.7051603318 | DE = -9.19e-06 | DW = 1.86e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     30.235 | E =     -75.7051653020 | DE = -4.97e-06 | DW = 1.29e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.119 | E =     -75.7062051830 | DE = -1.04e-03 | DW = 1.55e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     37.955 | E =     -75.7064488240 | DE = -2.44e-04 | DW = 2.28e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.612 | E =     -75.7065235246 | DE = -7.47e-05 | DW = 3.60e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     46.450 | E =     -75.7065341157 | DE = -1.06e-05 | DW = 2.52e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     51.095 | E =     -75.7065384671 | DE = -4.35e-06 | DW = 3.66e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.484 | E =     -75.7065383747 | DE = 9.24e-08 | DW = 2.48e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     60.241 | E =     -75.7065401224 | DE = -1.75e-06 | DW = 3.66e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     64.146 | E =     -75.7065415995 | DE = -1.48e-06 | DW = 2.54e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     72.548 | E =     -75.7066913281 | DE = -1.50e-04 | DW = 2.65e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     84.726 | E =     -75.7067205874 | DE = -2.93e-05 | DW = 1.44e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     96.165 | E =     -75.7067269382 | DE = -6.35e-06 | DW = 3.91e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    107.533 | E =     -75.7067269341 | DE = 4.12e-09 | DW = 1.48e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    119.512 | E =     -75.7067276857 | DE = -7.52e-07 | DW = 3.96e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    130.829 | E =     -75.7067275801 | DE = 1.06e-07 | DW = 1.52e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    142.416 | E =     -75.7067277968 | DE = -2.17e-07 | DW = 3.96e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    152.339 | E =     -75.7067276363 | DE = 1.60e-07 | DW = 1.52e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    173.082 | E =     -75.7067397271 | DE = -1.21e-05 | DW = 2.62e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    199.442 | E =     -75.7067408833 | DE = -1.16e-06 | DW = 1.13e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    225.678 | E =     -75.7067410999 | DE = -2.17e-07 | DW = 2.32e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    255.806 | E =     -75.7067413873 | DE = -2.87e-07 | DW = 1.22e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    282.728 | E =     -75.7067413863 | DE = 9.62e-10 | DW = 2.52e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    316.736 | E =     -75.7067415139 | DE = -1.28e-07 | DW = 1.21e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    341.408 | E =     -75.7067413737 | DE = 1.40e-07 | DW = 2.49e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    371.226 | E =     -75.7067415240 | DE = -1.50e-07 | DW = 1.22e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    418.063 | E =     -75.7067420862 | DE = -5.62e-07 | DW = 5.84e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    457.340 | E =     -75.7067420862 | DE = 3.43e-11 | DW = 5.84e-08

E(MRCI) = -75.70674208621439  E_corr = -0.1088742801672424
Time cost =    744.704
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:43:53 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.455237330030 AA    0.000000000000   0.000000000000   2.750000000000 Bohr   0.0

nuclear repulsion = 13.0909090909091
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.375]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    147477.49


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpnz89p71z
max_memory 4000 MB (current use 5153 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1557644738047

WARN: Singularity detected in overlap matrix (condition number =  321). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.19200419727189  LUMO (Ag) = -0.166086961504869
cycle= 1 E= -75.3260871697503  delta_E= -0.17  |g|= 0.228  |ddm|= 1.44
HOMO (B2u) = -0.448902413635198  LUMO (Ag) = -0.151522743525038
cycle= 2 E= -75.3454236890815  delta_E= -0.0193  |g|= 0.0517  |ddm|= 0.291
HOMO (B2u) = -0.411143114796123  LUMO (Ag) = -0.105979877749064
cycle= 3 E= -75.3463869604458  delta_E= -0.000963  |g|= 0.0112  |ddm|= 0.0546
HOMO (B3u) = -0.412216378156836  LUMO (Ag) = -0.102966454342322
cycle= 4 E= -75.3464661736964  delta_E= -7.92e-05  |g|= 0.00221  |ddm|= 0.0168
HOMO (B2u) = -0.413005500150536  LUMO (Ag) = -0.103497081119969
cycle= 5 E= -75.3464696035283  delta_E= -3.43e-06  |g|= 0.000295  |ddm|= 0.00439
HOMO (B3u) = -0.412935226123343  LUMO (Ag) = -0.103410770619273
cycle= 6 E= -75.3464696577874  delta_E= -5.43e-08  |g|= 3.83e-05  |ddm|= 0.000585
HOMO (B2u) = -0.4129277426732  LUMO (Ag) = -0.103398722647748
cycle= 7 E= -75.346469658793  delta_E= -1.01e-09  |g|= 4.88e-06  |ddm|= 0.00019
HOMO (B2u) = -0.412927696344276  LUMO (Ag) = -0.103397915940693
cycle= 8 E= -75.3464696588055  delta_E= -1.25e-11  |g|= 4.41e-07  |ddm|= 2.55e-05
HOMO (B2u) = -0.412927666372067  LUMO (Ag) = -0.103397797537191
cycle= 9 E= -75.3464696588055  delta_E=    0  |g|= 1.96e-08  |ddm|= 2.16e-06
HOMO (B2u) = -0.412927660626365  LUMO (Ag) = -0.103397800029288
cycle= 10 E= -75.3464696588056  delta_E= -1.14e-13  |g|= 2.79e-09  |ddm|= 6.4e-08
HOMO (B2u) = -0.412927661254343  LUMO (Ag) = -0.103397800547652
cycle= 11 E= -75.3464696588055  delta_E= 9.95e-14  |g|= 2.27e-09  |ddm|= 1.8e-09
HOMO (B2u) = -0.412927661143677  LUMO (Ag) = -0.103397800408825
cycle= 12 E= -75.3464696588056  delta_E= -7.11e-14  |g|= 1.62e-09  |ddm|= 2.56e-09
HOMO (B2u) = -0.412927661098319  LUMO (Ag) = -0.103397800323989
cycle= 13 E= -75.3464696588055  delta_E= 2.84e-14  |g|= 1.29e-09  |ddm|= 1.58e-09
HOMO (B2u) = -0.412927661060721  LUMO (Ag) = -0.103397800268892
cycle= 14 E= -75.3464696588057  delta_E= -1.42e-13  |g|= 1.06e-09  |ddm|= 1e-09
HOMO (B2u) = -0.41292766103975  LUMO (Ag) = -0.103397800245314
cycle= 15 E= -75.3464696588056  delta_E= 9.95e-14  |g|= 9.1e-10  |ddm|= 6.98e-10
HOMO (B2u) = -0.412927661042114  LUMO (Ag) = -0.103397800286391
cycle= 16 E= -75.3464696588056  delta_E= -1.42e-14  |g|= 8.43e-10  |ddm|= 1.25e-09
HOMO (B2u) = -0.412927660985037  LUMO (Ag) = -0.103397800239682
cycle= 17 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 8.37e-10  |ddm|= 1.77e-10
HOMO (B2u) = -0.41292766087313  LUMO (Ag) = -0.103397800091716
cycle= 18 E= -75.3464696588056  delta_E= -5.68e-14  |g|= 3.44e-10  |ddm|= 1.65e-09
HOMO (B2u) = -0.412927660874971  LUMO (Ag) = -0.103397800086035
cycle= 19 E= -75.3464696588055  delta_E= 5.68e-14  |g|= 2.81e-10  |ddm|= 2.47e-10
HOMO (B3u) = -0.412927660889728  LUMO (Ag) = -0.103397800094609
cycle= 20 E= -75.3464696588055  delta_E=    0  |g|= 2.22e-10  |ddm|= 1.97e-10
HOMO (B3u) = -0.412927660899975  LUMO (Ag) = -0.103397800100643
cycle= 21 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 1.81e-10  |ddm|= 1.45e-10
HOMO (B3u) = -0.412927660907479  LUMO (Ag) = -0.103397800105607
cycle= 22 E= -75.3464696588056  delta_E= -2.84e-14  |g|= 1.49e-10  |ddm|= 1.12e-10
HOMO (B3u) = -0.412927660912976  LUMO (Ag) = -0.103397800109685
cycle= 23 E= -75.3464696588055  delta_E= 8.53e-14  |g|= 1.23e-10  |ddm|= 9.2e-11
HOMO (B3u) = -0.412927660917522  LUMO (Ag) = -0.103397800113041
cycle= 24 E= -75.3464696588056  delta_E= -5.68e-14  |g|= 1.01e-10  |ddm|= 7.84e-11
HOMO (B3u) = -0.412927660921703  LUMO (Ag) = -0.103397800114419
cycle= 25 E= -75.3464696588055  delta_E= 1.14e-13  |g|= 7.76e-11  |ddm|= 5.48e-11
HOMO (B3u) = -0.412927660924298  LUMO (Ag) = -0.1033978001139
cycle= 26 E= -75.3464696588053  delta_E= 1.42e-13  |g|= 5.36e-11  |ddm|= 5.72e-11
HOMO (B3u) = -0.412927660923069  LUMO (Ag) = -0.103397800111495
cycle= 27 E= -75.3464696588053  delta_E= -1.42e-14  |g|= 4.39e-11  |ddm|= 2.12e-11
HOMO (B3u) = -0.412927660921724  LUMO (Ag) = -0.103397800109243
cycle= 28 E= -75.3464696588051  delta_E= 1.85e-13  |g|= 3.58e-11  |ddm|= 1.61e-11
HOMO (B3u) = -0.412927660920781  LUMO (Ag) = -0.10339780010759
cycle= 29 E= -75.3464696588051  delta_E= 5.68e-14  |g|= 2.95e-11  |ddm|= 1.19e-11
HOMO (B3u) = -0.412927660920102  LUMO (Ag) = -0.10339780010633
cycle= 30 E= -75.346469658805  delta_E= 1.14e-13  |g|= 2.42e-11  |ddm|= 9.67e-12
HOMO (B3u) = -0.412927660919631  LUMO (Ag) = -0.103397800105347
cycle= 31 E= -75.3464696588048  delta_E= 1.71e-13  |g|= 1.99e-11  |ddm|= 8.27e-12
HOMO (B3u) = -0.412927660919327  LUMO (Ag) = -0.103397800104548
cycle= 32 E= -75.3464696588046  delta_E= 2.27e-13  |g|= 1.65e-11  |ddm|= 7.11e-12
HOMO (B3u) = -0.412927660919154  LUMO (Ag) = -0.103397800103891
cycle= 33 E= -75.3464696588044  delta_E= 2.27e-13  |g|= 1.41e-11  |ddm|= 6.31e-12
HOMO (B3u) = -0.412927660919105  LUMO (Ag) = -0.103397800103452
cycle= 34 E= -75.3464696588038  delta_E= 5.12e-13  |g|= 1.26e-11  |ddm|= 5.24e-12
HOMO (B3u) = -0.412927660919116  LUMO (Ag) = -0.103397800103194
cycle= 35 E= -75.3464696588031  delta_E= 7.39e-13  |g|= 1.2e-11  |ddm|= 3.83e-12
HOMO (B3u) = -0.41292766091906  LUMO (Ag) = -0.103397800102921
cycle= 36 E= -75.3464696588022  delta_E= 8.81e-13  |g|= 1.17e-11  |ddm|= 3.46e-12
HOMO (B3u) = -0.412927660918932  LUMO (Ag) = -0.10339780010262
cycle= 37 E= -75.3464696588013  delta_E= 9.66e-13  |g|= 1.27e-11  |ddm|= 3.39e-12
HOMO (B3u) = -0.412927660918743  LUMO (Ag) = -0.103397800102297
cycle= 38 E= -75.3464696588005  delta_E= 7.39e-13  |g|= 1.21e-11  |ddm|= 3.12e-12
HOMO (B3u) = -0.412927660918511  LUMO (Ag) = -0.103397800101959
cycle= 39 E= -75.3464696588003  delta_E= 1.71e-13  |g|= 1.04e-11  |ddm|= 4.14e-12
HOMO (B3u) = -0.412927660918268  LUMO (Ag) = -0.103397800101634
cycle= 40 E= -75.3464696588  delta_E= 2.98e-13  |g|= 8.85e-12  |ddm|= 4.43e-12
HOMO (B3u) = -0.41292766091802  LUMO (Ag) = -0.103397800101327
cycle= 41 E= -75.3464696587999  delta_E= 1.28e-13  |g|= 7.43e-12  |ddm|= 4.9e-12
HOMO (B3u) = -0.412927660917783  LUMO (Ag) = -0.103397800101045
cycle= 42 E= -75.3464696587999  delta_E= 2.84e-14  |g|= 6.42e-12  |ddm|= 4.85e-12
HOMO (B3u) = -0.412927660917566  LUMO (Ag) = -0.103397800100793
cycle= 43 E= -75.3464696587997  delta_E= 1.99e-13  |g|= 5.7e-12  |ddm|= 4.31e-12
HOMO (B3u) = -0.412927660917376  LUMO (Ag) = -0.103397800100575
cycle= 44 E= -75.3464696587991  delta_E= 6.25e-13  |g|= 6.09e-12  |ddm|= 3.05e-12
HOMO (B3u) = -0.412927660917204  LUMO (Ag) = -0.103397800100392
cycle= 45 E= -75.3464696587979  delta_E= 1.17e-12  |g|= 1.22e-11  |ddm|= 1.9e-12
HOMO (B3u) = -0.412927660917014  LUMO (Ag) = -0.103397800100204
cycle= 46 E= -75.3464696587978  delta_E= 5.68e-14  |g|= 1.09e-11  |ddm|= 9.73e-12
HOMO (B3u) = -0.412927660916862  LUMO (Ag) = -0.10339780010005
cycle= 47 E= -75.346469658798  delta_E= -1.28e-13  |g|= 9.62e-12  |ddm|= 9.72e-12
HOMO (B3u) = -0.412927660916722  LUMO (Ag) = -0.103397800099909
cycle= 48 E= -75.3464696587979  delta_E= 5.68e-14  |g|= 8.29e-12  |ddm|= 1.05e-11
HOMO (B3u) = -0.412927660916591  LUMO (Ag) = -0.103397800099773
cycle= 49 E= -75.3464696587979  delta_E= 1.42e-14  |g|= 6.83e-12  |ddm|= 1.13e-11
HOMO (B3u) = -0.412927660916458  LUMO (Ag) = -0.103397800099626
cycle= 50 E= -75.3464696587979  delta_E= -2.84e-14  |g|= 5.24e-12  |ddm|= 1.18e-11
SCF not converged.
SCF energy = -75.3464696587979

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpnz89p71z
max_memory 4000 MB (current use 5153 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5273817495056  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.550567376779  dE = -0.023185627  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.74  |maxRot[o]|=0.0789
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5627306637848  dE = -0.012163287  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 0.07  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5708350967081  dE = -0.0081044329  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0298  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5769074899929  dE = -0.0060723933  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0169  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5816177919851  dE = -0.004710302  S^2 = 0.0000000
               |grad[o]|=0.0598  |ddm|=0.0112  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5852166480583  dE = -0.0035988561  S^2 = 0.0000000
               |grad[o]|=0.0466  |ddm|=0.00806  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5878213075534  dE = -0.0026046595  S^2 = 0.0000000
               |grad[o]|=0.0347  |ddm|=0.00612  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5895012709119  dE = -0.0016799634  S^2 = 0.0000000
               |grad[o]|=0.0237  |ddm|=0.00522  |maxRot[o]|=0.0799
macro iter 9 (6 JK  0 micro), CASSCF E = -75.5903141198193  dE = -0.00081284891  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.00535  |maxRot[o]|=0.0799
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5904157781656  dE = -0.00010165835  S^2 = 0.0000000
               |grad[o]|=0.00416  |ddm|=0.00625  |maxRot[o]|=0.0374
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5904169951707  dE = -1.2170052e-06  S^2 = 0.0000000
               |grad[o]|=0.000613  |ddm|=0.00344  |maxRot[o]|=0.00344
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5904170206057  dE = -2.5435e-08  S^2 = 0.0000000
               |grad[o]|=9.08e-05  |ddm|=0.000454  |maxRot[o]|=0.000414
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5904170213116  dE = -7.0583894e-10  S^2 = 0.0000000
               |grad[o]|=1.74e-05  |ddm|=6.53e-05  |maxRot[o]|=6.97e-05
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5904170213273  dE = -1.5745627e-11  S^2 = 0.0000000
               |grad[o]|=3.39e-06  |ddm|=1.18e-05  |maxRot[o]|=7.77e-06
2-step CASSCF converged in 14 macro (71 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97743797 1.68610695 1.83058025 1.83058126 0.31631711 0.16943555
 0.16943539 0.02010551]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00615   0.00344   0.00000   0.00000  -0.00091
  0 C 2s       0.61773   0.57533   0.00000  -0.00000  -0.34180
  0 C 3s      -0.03411   0.00898  -0.00000  -0.00000   0.00990
  0 C 2px      0.00000  -0.00000  -0.00000   0.70654  -0.00000
  0 C 2py     -0.00000   0.00000   0.70654  -0.00000  -0.00000
  0 C 2pz      0.33928  -0.41097  -0.00000  -0.00000   0.61707
  0 C 3px     -0.00000  -0.00000   0.00000   0.01297  -0.00000
  0 C 3py      0.00000  -0.00000   0.01297   0.00000  -0.00000
  0 C 3pz     -0.03426  -0.00242  -0.00000  -0.00000  -0.04286
  0 C 3dxy     0.00000   0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02505   0.00000  -0.00000
  0 C 3dz^2    0.03040  -0.00175  -0.00000  -0.00000   0.02149
  0 C 3dxz    -0.00000  -0.00000   0.00000   0.02505  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 1s       0.00615  -0.00344   0.00000   0.00000  -0.00091
  1 C 2s       0.61773  -0.57533  -0.00000   0.00000  -0.34180
  1 C 3s      -0.03411  -0.00898   0.00000   0.00000   0.00990
  1 C 2px      0.00000   0.00000  -0.00000   0.70654  -0.00000
  1 C 2py      0.00000   0.00000   0.70654  -0.00000   0.00000
  1 C 2pz     -0.33928  -0.41097  -0.00000   0.00000  -0.61707
  1 C 3px     -0.00000   0.00000   0.00000   0.01297   0.00000
  1 C 3py      0.00000  -0.00000   0.01297  -0.00000   0.00000
  1 C 3pz      0.03426  -0.00242  -0.00000  -0.00000   0.04286
  1 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02505   0.00000  -0.00000
  1 C 3dz^2    0.03040   0.00175   0.00000   0.00000   0.02149
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02505  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s      -0.00000   0.00000   0.41035
  0 C 3s      -0.00000  -0.00000  -0.04345
  0 C 2px      0.70654   0.00000  -0.00000
  0 C 2py     -0.00000   0.70654  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.57349
  0 C 3px     -0.01725  -0.00000   0.00000
  0 C 3py     -0.00000  -0.01725  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.01967
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.02253  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02125
  0 C 3dxz    -0.02253  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.41035
  1 C 3s       0.00000   0.00000   0.04345
  1 C 2px     -0.70654   0.00000  -0.00000
  1 C 2py      0.00000  -0.70654   0.00000
  1 C 2pz      0.00000   0.00000   0.57349
  1 C 3px      0.01725  -0.00000   0.00000
  1 C 3py      0.00000   0.01725   0.00000
  1 C 3pz     -0.00000  -0.00000   0.01967
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02253  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02125
  1 C 3dxz    -0.02253   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99226092
<CAS-nat-orb|mo-hf>  4  4    0.99781292
<CAS-nat-orb|mo-hf>  5  5    0.99956408
<CAS-nat-orb|mo-hf>  6  6    0.99956408
<CAS-nat-orb|mo-hf>  7  7    0.97493012
<CAS-nat-orb|mo-hf>  8  8    0.96431698
<CAS-nat-orb|mo-hf>  9  9    0.96431699
<CAS-nat-orb|mo-hf>  10  10    0.64879976
<CAS-nat-orb|mo-hf>  10  17    0.66873233
CASSCF energy = -75.5904170213273
CASCI E = -75.5904170213273  E(CI) = -16.6895622080532  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.010

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.051
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.012
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.014
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.017
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.103
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.269 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.179 | Tfpread = 0.000 | Tfpwrite = 0.176 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.612 | E =     -75.6650177126 | DW = 2.45e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.163 | E =     -75.6968243473 | DE = -3.18e-02 | DW = 1.17e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.240 | E =     -75.6974507498 | DE = -6.26e-04 | DW = 1.86e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.293 | E =     -75.6981219186 | DE = -6.71e-04 | DW = 1.36e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.182 | E =     -75.6981326505 | DE = -1.07e-05 | DW = 1.90e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.160 | E =     -75.6981521885 | DE = -1.95e-05 | DW = 1.36e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.983 | E =     -75.6981565985 | DE = -4.41e-06 | DW = 1.89e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.827 | E =     -75.6981646449 | DE = -8.05e-06 | DW = 1.36e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     10.963 | E =     -75.6992603932 | DE = -1.10e-03 | DW = 1.66e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     13.931 | E =     -75.6995184213 | DE = -2.58e-04 | DW = 2.50e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     16.805 | E =     -75.6995943316 | DE = -7.59e-05 | DW = 3.86e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     19.615 | E =     -75.6996028522 | DE = -8.52e-06 | DW = 2.71e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     22.216 | E =     -75.6996061743 | DE = -3.32e-06 | DW = 3.89e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.969 | E =     -75.6996081944 | DE = -2.02e-06 | DW = 2.73e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.854 | E =     -75.6996095271 | DE = -1.33e-06 | DW = 3.90e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.337 | E =     -75.6996109018 | DE = -1.37e-06 | DW = 2.74e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     38.152 | E =     -75.6997682656 | DE = -1.57e-04 | DW = 2.74e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     54.339 | E =     -75.6997995870 | DE = -3.13e-05 | DW = 1.57e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     67.794 | E =     -75.6998062649 | DE = -6.68e-06 | DW = 4.12e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     78.716 | E =     -75.6998061823 | DE = 8.25e-08 | DW = 1.56e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.640 | E =     -75.6998068440 | DE = -6.62e-07 | DW = 4.11e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     98.829 | E =     -75.6998067731 | DE = 7.09e-08 | DW = 1.59e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    109.025 | E =     -75.6998070535 | DE = -2.80e-07 | DW = 4.11e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    118.567 | E =     -75.6998069115 | DE = 1.42e-07 | DW = 1.58e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    138.185 | E =     -75.6998193851 | DE = -1.25e-05 | DW = 2.70e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    172.525 | E =     -75.6998206114 | DE = -1.23e-06 | DW = 1.17e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    224.743 | E =     -75.6998213356 | DE = -7.24e-07 | DW = 2.78e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    256.657 | E =     -75.6998212117 | DE = 1.24e-07 | DW = 1.26e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    282.129 | E =     -75.6998211476 | DE = 6.42e-08 | DW = 2.52e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    319.909 | E =     -75.6998213396 | DE = -1.92e-07 | DW = 1.27e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    348.014 | E =     -75.6998212212 | DE = 1.18e-07 | DW = 2.58e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    377.839 | E =     -75.6998213707 | DE = -1.49e-07 | DW = 1.26e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    425.599 | E =     -75.6998219982 | DE = -6.27e-07 | DW = 6.12e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    457.577 | E =     -75.6998219982 | DE = 3.59e-11 | DW = 6.12e-08

E(MRCI) = -75.69982199816275  E_corr = -0.1094049768354353
Time cost =    517.636
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 17:52:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.481696190576 AA    0.000000000000   0.000000000000   2.800000000000 Bohr   0.0

nuclear repulsion = 12.8571428571429
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.4]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    155290.92


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpe78vnnr_
max_memory 4000 MB (current use 5090 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.1187592585641

WARN: Singularity detected in overlap matrix (condition number =  297). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.184977014444632  LUMO (Ag) = -0.163989710542373
cycle= 1 E= -75.3167358242476  delta_E= -0.198  |g|= 0.231  |ddm|= 1.44
HOMO (B3u) = -0.444434359277165  LUMO (Ag) = -0.151416963696338
cycle= 2 E= -75.3367114409982  delta_E= -0.02  |g|= 0.0515  |ddm|= 0.298
HOMO (B2u) = -0.406594326641876  LUMO (Ag) = -0.105005000614386
cycle= 3 E= -75.3376920455643  delta_E= -0.000981  |g|= 0.0117  |ddm|= 0.0545
HOMO (B3u) = -0.407746719644285  LUMO (Ag) = -0.101871698894465
cycle= 4 E= -75.3377779901322  delta_E= -8.59e-05  |g|= 0.00225  |ddm|= 0.0162
HOMO (B2u) = -0.408536003811461  LUMO (Ag) = -0.102414153547258
cycle= 5 E= -75.3377816192104  delta_E= -3.63e-06  |g|= 0.000309  |ddm|= 0.00396
HOMO (B3u) = -0.408464040126319  LUMO (Ag) = -0.102331174534053
cycle= 6 E= -75.3377816780684  delta_E= -5.89e-08  |g|= 3.95e-05  |ddm|= 0.000618
HOMO (B2u) = -0.408456256018869  LUMO (Ag) = -0.102318677176297
cycle= 7 E= -75.3377816791323  delta_E= -1.06e-09  |g|= 5.06e-06  |ddm|= 0.00018
HOMO (B3u) = -0.40845610623603  LUMO (Ag) = -0.102317785563311
cycle= 8 E= -75.337781679146  delta_E= -1.37e-11  |g|= 4.62e-07  |ddm|= 2.48e-05
HOMO (B2u) = -0.408456075143802  LUMO (Ag) = -0.102317652725201
cycle= 9 E= -75.337781679146  delta_E= 2.84e-14  |g|= 2.02e-08  |ddm|= 1.99e-06
HOMO (B3u) = -0.408456068963826  LUMO (Ag) = -0.102317657025672
cycle= 10 E= -75.3377816791461  delta_E= -8.53e-14  |g|= 2.92e-09  |ddm|= 6.88e-08
HOMO (B3u) = -0.408456069755509  LUMO (Ag) = -0.10231765774182
cycle= 11 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 2.43e-09  |ddm|= 2.37e-09
HOMO (B3u) = -0.408456069552397  LUMO (Ag) = -0.102317657486114
cycle= 12 E= -75.3377816791461  delta_E= -1.42e-14  |g|= 1.71e-09  |ddm|= 2.85e-09
HOMO (B3u) = -0.408456069503525  LUMO (Ag) = -0.102317657383057
cycle= 13 E= -75.3377816791461  delta_E= 1.42e-14  |g|= 1.38e-09  |ddm|= 1.53e-09
HOMO (B3u) = -0.408456069460314  LUMO (Ag) = -0.102317657325529
cycle= 14 E= -75.3377816791461  delta_E= 2.84e-14  |g|= 1.14e-09  |ddm|= 1e-09
HOMO (B3u) = -0.408456069436735  LUMO (Ag) = -0.102317657300138
cycle= 15 E= -75.3377816791461  delta_E=    0  |g|= 9.7e-10  |ddm|= 6.23e-10
HOMO (B3u) = -0.40845606943728  LUMO (Ag) = -0.102317657335113
cycle= 16 E= -75.337781679146  delta_E= 5.68e-14  |g|= 8.89e-10  |ddm|= 1.18e-09
HOMO (B3u) = -0.408456069387151  LUMO (Ag) = -0.10231765729339
cycle= 17 E= -75.3377816791461  delta_E= -1.14e-13  |g|= 8.67e-10  |ddm|= 8.47e-11
HOMO (B3u) = -0.408456069259322  LUMO (Ag) = -0.102317657143801
cycle= 18 E= -75.3377816791461  delta_E= 2.84e-14  |g|= 3.66e-10  |ddm|= 1.82e-09
HOMO (B3u) = -0.408456069261092  LUMO (Ag) = -0.102317657138117
cycle= 19 E= -75.3377816791461  delta_E=    0  |g|= 2.99e-10  |ddm|= 2.73e-10
HOMO (B3u) = -0.408456069278289  LUMO (Ag) = -0.102317657148925
cycle= 20 E= -75.337781679146  delta_E= 8.53e-14  |g|= 2.36e-10  |ddm|= 2.1e-10
HOMO (B3u) = -0.408456069289258  LUMO (Ag) = -0.102317657155447
cycle= 21 E= -75.3377816791461  delta_E= -4.26e-14  |g|= 1.92e-10  |ddm|= 1.51e-10
HOMO (B3u) = -0.408456069297003  LUMO (Ag) = -0.102317657160983
cycle= 22 E= -75.3377816791461  delta_E= -2.84e-14  |g|= 1.57e-10  |ddm|= 1.18e-10
HOMO (B3u) = -0.408456069302697  LUMO (Ag) = -0.102317657165485
cycle= 23 E= -75.3377816791461  delta_E= -1.42e-14  |g|= 1.28e-10  |ddm|= 9.79e-11
HOMO (B3u) = -0.408456069307729  LUMO (Ag) = -0.102317657169658
cycle= 24 E= -75.337781679146  delta_E= 1.28e-13  |g|= 1.05e-10  |ddm|= 8.81e-11
HOMO (B3u) = -0.408456069312227  LUMO (Ag) = -0.102317657171908
cycle= 25 E= -75.337781679146  delta_E= -1.42e-14  |g|= 8.08e-11  |ddm|= 6.41e-11
HOMO (B3u) = -0.408456069315188  LUMO (Ag) = -0.10231765717237
cycle= 26 E= -75.337781679146  delta_E= 2.84e-14  |g|= 5.65e-11  |ddm|= 6.32e-11
HOMO (B3u) = -0.408456069313846  LUMO (Ag) = -0.102317657169912
cycle= 27 E= -75.337781679146  delta_E= -5.68e-14  |g|= 4.61e-11  |ddm|= 2.28e-11
HOMO (B3u) = -0.408456069312357  LUMO (Ag) = -0.102317657167573
cycle= 28 E= -75.3377816791458  delta_E= 2.13e-13  |g|= 3.75e-11  |ddm|= 1.75e-11
HOMO (B2u) = -0.408456069311334  LUMO (Ag) = -0.102317657165921
cycle= 29 E= -75.3377816791457  delta_E= 9.95e-14  |g|= 3.07e-11  |ddm|= 1.29e-11
HOMO (B2u) = -0.408456069310589  LUMO (Ag) = -0.1023176571647
cycle= 30 E= -75.3377816791457  delta_E= 1.42e-14  |g|= 2.52e-11  |ddm|= 1e-11
HOMO (B2u) = -0.408456069310079  LUMO (Ag) = -0.102317657163775
cycle= 31 E= -75.3377816791455  delta_E= 1.85e-13  |g|= 2.06e-11  |ddm|= 8.35e-12
HOMO (B2u) = -0.408456069309745  LUMO (Ag) = -0.102317657163044
cycle= 32 E= -75.3377816791453  delta_E= 1.99e-13  |g|= 1.7e-11  |ddm|= 6.99e-12
HOMO (B2u) = -0.408456069309552  LUMO (Ag) = -0.102317657162446
cycle= 33 E= -75.3377816791451  delta_E= 1.99e-13  |g|= 1.41e-11  |ddm|= 6.17e-12
HOMO (B2u) = -0.40845606930949  LUMO (Ag) = -0.102317657162036
cycle= 34 E= -75.3377816791446  delta_E= 4.69e-13  |g|= 1.23e-11  |ddm|= 4.86e-12
HOMO (B2u) = -0.408456069309506  LUMO (Ag) = -0.102317657161791
cycle= 35 E= -75.3377816791441  delta_E= 5.83e-13  |g|= 1.13e-11  |ddm|= 3.63e-12
HOMO (B2u) = -0.408456069309466  LUMO (Ag) = -0.102317657161531
cycle= 36 E= -75.3377816791432  delta_E= 8.81e-13  |g|= 1.13e-11  |ddm|= 3.12e-12
HOMO (B2u) = -0.408456069309358  LUMO (Ag) = -0.102317657161228
cycle= 37 E= -75.3377816791424  delta_E= 8.24e-13  |g|= 1.16e-11  |ddm|= 3.07e-12
HOMO (B2u) = -0.408456069309202  LUMO (Ag) = -0.10231765716091
cycle= 38 E= -75.3377816791413  delta_E= 1.02e-12  |g|= 1.74e-11  |ddm|= 2.62e-12
HOMO (B2u) = -0.408456069308987  LUMO (Ag) = -0.102317657160555
cycle= 39 E= -75.3377816791413  delta_E= 5.68e-14  |g|= 1.55e-11  |ddm|= 1.19e-11
HOMO (B2u) = -0.408456069308771  LUMO (Ag) = -0.102317657160219
cycle= 40 E= -75.3377816791412  delta_E= 8.53e-14  |g|= 1.35e-11  |ddm|= 1.29e-11
HOMO (B2u) = -0.408456069308561  LUMO (Ag) = -0.102317657159908
cycle= 41 E= -75.337781679141  delta_E= 1.56e-13  |g|= 1.15e-11  |ddm|= 1.25e-11
HOMO (B2u) = -0.408456069308355  LUMO (Ag) = -0.102317657159613
cycle= 42 E= -75.337781679141  delta_E= 2.84e-14  |g|= 9.59e-12  |ddm|= 1.46e-11
HOMO (B2u) = -0.408456069308165  LUMO (Ag) = -0.102317657159339
cycle= 43 E= -75.3377816791409  delta_E= 8.53e-14  |g|= 7.81e-12  |ddm|= 1.48e-11
HOMO (B2u) = -0.408456069308003  LUMO (Ag) = -0.102317657159104
cycle= 44 E= -75.3377816791409  delta_E= 4.26e-14  |g|= 6.06e-12  |ddm|= 1.51e-11
HOMO (B2u) = -0.40845606930788  LUMO (Ag) = -0.102317657158914
cycle= 45 E= -75.3377816791408  delta_E= 9.95e-14  |g|= 4.57e-12  |ddm|= 1.23e-11
HOMO (B2u) = -0.408456069307787  LUMO (Ag) = -0.102317657158737
cycle= 46 E= -75.3377816791409  delta_E= -1.56e-13  |g|= 3.68e-12  |ddm|= 1.12e-11
HOMO (B2u) = -0.408456069307751  LUMO (Ag) = -0.102317657158609
cycle= 47 E= -75.33778167914  delta_E= 9.66e-13  |g|= 5.57e-12  |ddm|= 1.59e-12
HOMO (B2u) = -0.408456069307679  LUMO (Ag) = -0.102317657158475
cycle= 48 E= -75.3377816791399  delta_E= 8.53e-14  |g|= 4.5e-12  |ddm|= 4.58e-12
HOMO (B2u) = -0.408456069307607  LUMO (Ag) = -0.102317657158339
cycle= 49 E= -75.3377816791398  delta_E= 8.53e-14  |g|= 3.64e-12  |ddm|= 3.88e-12
HOMO (B2u) = -0.40845606930754  LUMO (Ag) = -0.102317657158216
cycle= 50 E= -75.3377816791395  delta_E= 3.41e-13  |g|= 3.91e-12  |ddm|= 3.02e-12
SCF not converged.
SCF energy = -75.3377816791395

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpe78vnnr_
max_memory 4000 MB (current use 5090 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5207710561412  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5435755559907  dE = -0.0228045  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5556765916915  dE = -0.012101036  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0699  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5637960000716  dE = -0.0081194084  S^2 = 0.0000000
               |grad[o]|=0.093  |ddm|=0.0305  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5698524603916  dE = -0.0060564603  S^2 = 0.0000000
               |grad[o]|=0.0748  |ddm|=0.0176  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5744957561061  dE = -0.0046432957  S^2 = 0.0000000
               |grad[o]|=0.0595  |ddm|=0.0117  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5779777384791  dE = -0.0034819824  S^2 = 0.0000000
               |grad[o]|=0.0458  |ddm|=0.00834  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5804224270874  dE = -0.0024446886  S^2 = 0.0000000
               |grad[o]|=0.0334  |ddm|=0.00629  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5819071701024  dE = -0.001484743  S^2 = 0.0000000
               |grad[o]|=0.0219  |ddm|=0.00549  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5824311440377  dE = -0.00052397394  S^2 = 0.0000000
               |grad[o]|=0.0112  |ddm|=0.00592  |maxRot[o]|= 0.06
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5825178887642  dE = -8.6744727e-05  S^2 = 0.0000000
               |grad[o]|=0.00395  |ddm|=0.00527  |maxRot[o]|=0.0339
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5825189141504  dE = -1.0253862e-06  S^2 = 0.0000000
               |grad[o]|=0.000571  |ddm|=0.00341  |maxRot[o]|=0.00308
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5825189358438  dE = -2.1693424e-08  S^2 = 0.0000000
               |grad[o]|=8.42e-05  |ddm|=0.000435  |maxRot[o]|=0.000366
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5825189364267  dE = -5.8290084e-10  S^2 = 0.0000000
               |grad[o]|=1.62e-05  |ddm|=6.21e-05  |maxRot[o]|=6.09e-05
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5825189364378  dE = -1.1112888e-11  S^2 = 0.0000000
               |grad[o]|=3.07e-06  |ddm|=1.02e-05  |maxRot[o]|=7.04e-06
2-step CASSCF converged in 14 macro (70 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97658607 1.6951559  1.82129723 1.8212978  0.30935554 0.17765846
 0.17765884 0.02099016]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00641   0.00352   0.00000   0.00000  -0.00088
  0 C 2s       0.62079   0.58190   0.00000  -0.00000  -0.33633
  0 C 3s      -0.03214   0.00906   0.00000  -0.00000   0.01238
  0 C 2px     -0.00000   0.00000  -0.00000   0.70653   0.00000
  0 C 2py      0.00000  -0.00000   0.70653   0.00000  -0.00000
  0 C 2pz      0.33407  -0.40161   0.00000   0.00000   0.61999
  0 C 3px     -0.00000  -0.00000  -0.00000   0.01517  -0.00000
  0 C 3py      0.00000  -0.00000   0.01517   0.00000  -0.00000
  0 C 3pz     -0.03258  -0.00225   0.00000   0.00000  -0.04249
  0 C 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02420   0.00000  -0.00000
  0 C 3dz^2    0.02955  -0.00209   0.00000  -0.00000   0.02326
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.02420  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 1s       0.00641  -0.00352   0.00000   0.00000  -0.00088
  1 C 2s       0.62079  -0.58190  -0.00000  -0.00000  -0.33633
  1 C 3s      -0.03214  -0.00906  -0.00000   0.00000   0.01238
  1 C 2px      0.00000   0.00000   0.00000   0.70653   0.00000
  1 C 2py     -0.00000   0.00000   0.70653   0.00000  -0.00000
  1 C 2pz     -0.33407  -0.40161   0.00000  -0.00000  -0.61999
  1 C 3px      0.00000  -0.00000   0.00000   0.01517  -0.00000
  1 C 3py     -0.00000   0.00000   0.01517  -0.00000   0.00000
  1 C 3pz      0.03258  -0.00225   0.00000  -0.00000   0.04249
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02420   0.00000  -0.00000
  1 C 3dz^2    0.02955   0.00209  -0.00000   0.00000   0.02326
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02420   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000   0.00000   0.40101
  0 C 3s      -0.00000  -0.00000  -0.04346
  0 C 2px      0.70657  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70657   0.00000
  0 C 2pz     -0.00000   0.00000   0.58004
  0 C 3px     -0.01641  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01641  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02037
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02228  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02106
  0 C 3dxz    -0.02228  -0.00000  -0.00000
 0 C 3dx2-y2   0.00000   0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s       0.00000   0.00000  -0.40101
  1 C 3s       0.00000  -0.00000   0.04346
  1 C 2px     -0.70657   0.00000   0.00000
  1 C 2py      0.00000  -0.70657   0.00000
  1 C 2pz     -0.00000   0.00000   0.58004
  1 C 3px      0.01641   0.00000   0.00000
  1 C 3py      0.00000   0.01641  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02037
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02228   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02106
  1 C 3dxz    -0.02228  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99198874
<CAS-nat-orb|mo-hf>  4  4    0.99770782
<CAS-nat-orb|mo-hf>  5  5    0.99952508
<CAS-nat-orb|mo-hf>  6  6    0.99952508
<CAS-nat-orb|mo-hf>  7  7    0.97453486
<CAS-nat-orb|mo-hf>  8  8    0.96668730
<CAS-nat-orb|mo-hf>  9  9    0.96668737
<CAS-nat-orb|mo-hf>  10  10    0.67408712
<CAS-nat-orb|mo-hf>  10  17    0.65475251
CASSCF energy = -75.5825189364378
CASCI E = -75.5825189364378  E(CI) = -16.5777815499748  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.046
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.036
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.340
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.101
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.666

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.029
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.638
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.710
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.717
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.713
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      2.167
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.016
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      8.022
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.10
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.05
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.04
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.296 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.211 | Tfpread = 0.000 | Tfpwrite = 0.209 | data = 74.1 MB | cpsd = 56.0 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.307 | E =     -75.6595704509 | DW = 2.61e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.353 | E =     -75.6894350727 | DE = -2.99e-02 | DW = 1.18e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.045 | E =     -75.6900506604 | DE = -6.16e-04 | DW = 1.89e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.839 | E =     -75.6907401204 | DE = -6.89e-04 | DW = 1.40e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.787 | E =     -75.6907560504 | DE = -1.59e-05 | DW = 1.97e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.484 | E =     -75.6907684887 | DE = -1.24e-05 | DW = 1.42e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     13.549 | E =     -75.6907703497 | DE = -1.86e-06 | DW = 1.94e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     16.620 | E =     -75.6907774151 | DE = -7.07e-06 | DW = 1.39e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     21.660 | E =     -75.6919263021 | DE = -1.15e-03 | DW = 1.73e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.860 | E =     -75.6921951160 | DE = -2.69e-04 | DW = 2.70e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.723 | E =     -75.6922750900 | DE = -8.00e-05 | DW = 4.12e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.983 | E =     -75.6922839017 | DE = -8.81e-06 | DW = 2.93e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     38.454 | E =     -75.6922896306 | DE = -5.73e-06 | DW = 4.17e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.005 | E =     -75.6922915303 | DE = -1.90e-06 | DW = 2.95e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     47.743 | E =     -75.6922930018 | DE = -1.47e-06 | DW = 4.17e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     51.843 | E =     -75.6922937575 | DE = -7.56e-07 | DW = 2.96e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     59.825 | E =     -75.6924590733 | DE = -1.65e-04 | DW = 2.85e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     72.402 | E =     -75.6924921458 | DE = -3.31e-05 | DW = 1.63e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     83.761 | E =     -75.6924985057 | DE = -6.36e-06 | DW = 4.22e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     95.063 | E =     -75.6924987704 | DE = -2.65e-07 | DW = 1.64e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    107.141 | E =     -75.6924995438 | DE = -7.73e-07 | DW = 4.28e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    118.660 | E =     -75.6924994381 | DE = 1.06e-07 | DW = 1.65e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    130.737 | E =     -75.6924998333 | DE = -3.95e-07 | DW = 4.28e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    141.944 | E =     -75.6924996933 | DE = 1.40e-07 | DW = 1.65e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    163.712 | E =     -75.6925125882 | DE = -1.29e-05 | DW = 2.79e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    189.658 | E =     -75.6925138501 | DE = -1.26e-06 | DW = 1.23e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    215.839 | E =     -75.6925140918 | DE = -2.42e-07 | DW = 2.45e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    244.202 | E =     -75.6925144325 | DE = -3.41e-07 | DW = 1.31e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    269.969 | E =     -75.6925144466 | DE = -1.41e-08 | DW = 2.66e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    299.103 | E =     -75.6925146135 | DE = -1.67e-07 | DW = 1.31e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    325.148 | E =     -75.6925144798 | DE = 1.34e-07 | DW = 2.64e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    355.064 | E =     -75.6925146552 | DE = -1.75e-07 | DW = 1.31e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    419.184 | E =     -75.6925153691 | DE = -7.14e-07 | DW = 6.41e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    453.026 | E =     -75.6925153691 | DE = 3.10e-11 | DW = 6.41e-08

E(MRCI) = -75.692515369101  E_corr = -0.1099964326631806
Time cost =    635.226
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:03:06 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.508155051122 AA    0.000000000000   0.000000000000   2.850000000000 Bohr   0.0

nuclear repulsion = 12.6315789473684
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.425]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    163817.21


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmplpwkegtx
max_memory 4000 MB (current use 5090 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0836082427711

WARN: Singularity detected in overlap matrix (condition number =  275). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.178310042866845  LUMO (Ag) = -0.161961845746925
cycle= 1 E= -75.3070977055452  delta_E= -0.223  |g|= 0.234  |ddm|= 1.43
HOMO (B3u) = -0.440057963112902  LUMO (Ag) = -0.151084704136088
cycle= 2 E= -75.3276882495978  delta_E= -0.0206  |g|= 0.0513  |ddm|= 0.304
HOMO (B3u) = -0.402148496278863  LUMO (Ag) = -0.103839161942739
cycle= 3 E= -75.3286840635262  delta_E= -0.000996  |g|= 0.0121  |ddm|= 0.0544
HOMO (B2u) = -0.403404739232162  LUMO (Ag) = -0.100645294675413
cycle= 4 E= -75.3287765426504  delta_E= -9.25e-05  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.404190054526261  LUMO (Ag) = -0.101202470957948
cycle= 5 E= -75.3287803215959  delta_E= -3.78e-06  |g|= 0.000318  |ddm|= 0.00364
HOMO (B3u) = -0.404117903551407  LUMO (Ag) = -0.101124705066543
cycle= 6 E= -75.3287803833538  delta_E= -6.18e-08  |g|= 4.04e-05  |ddm|= 0.000637
HOMO (B3u) = -0.404109925173551  LUMO (Ag) = -0.101111910622266
cycle= 7 E= -75.3287803844586  delta_E= -1.1e-09  |g|= 5.18e-06  |ddm|= 0.000169
HOMO (B3u) = -0.404109663968695  LUMO (Ag) = -0.101110942652327
cycle= 8 E= -75.3287803844733  delta_E= -1.47e-11  |g|= 4.83e-07  |ddm|= 2.4e-05
HOMO (B2u) = -0.404109632109872  LUMO (Ag) = -0.101110794247811
cycle= 9 E= -75.3287803844733  delta_E= -8.53e-14  |g|= 2.07e-08  |ddm|= 1.8e-06
HOMO (B2u) = -0.404109625552919  LUMO (Ag) = -0.101110800522632
cycle= 10 E= -75.3287803844734  delta_E= -1.42e-14  |g|= 3.06e-09  |ddm|= 7.31e-08
HOMO (B3u) = -0.404109626471973  LUMO (Ag) = -0.101110801398539
cycle= 11 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 2.51e-09  |ddm|= 3.11e-09
HOMO (B2u) = -0.40410962620161  LUMO (Ag) = -0.101110801058642
cycle= 12 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 1.79e-09  |ddm|= 2.71e-09
HOMO (B2u) = -0.404109626163899  LUMO (Ag) = -0.101110800945883
cycle= 13 E= -75.3287803844733  delta_E= 4.26e-14  |g|= 1.48e-09  |ddm|= 1.6e-09
HOMO (B2u) = -0.404109626115955  LUMO (Ag) = -0.101110800888834
cycle= 14 E= -75.3287803844733  delta_E= 7.11e-14  |g|= 1.23e-09  |ddm|= 9.94e-10
HOMO (B3u) = -0.404109626089659  LUMO (Ag) = -0.101110800862323
cycle= 15 E= -75.3287803844734  delta_E= -9.95e-14  |g|= 1.04e-09  |ddm|= 6.13e-10
HOMO (B3u) = -0.404109626087946  LUMO (Ag) = -0.101110800890432
cycle= 16 E= -75.3287803844733  delta_E= 1.42e-14  |g|= 9.42e-10  |ddm|= 1.1e-09
HOMO (B2u) = -0.404109626047447  LUMO (Ag) = -0.101110800856137
cycle= 17 E= -75.3287803844733  delta_E= 2.84e-14  |g|= 8.95e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.404109625906414  LUMO (Ag) = -0.101110800709268
cycle= 18 E= -75.3287803844733  delta_E= -1.42e-14  |g|= 3.85e-10  |ddm|= 1.99e-09
HOMO (B2u) = -0.404109625907907  LUMO (Ag) = -0.101110800703469
cycle= 19 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 3.15e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.404109625926457  LUMO (Ag) = -0.101110800715659
cycle= 20 E= -75.3287803844733  delta_E= 5.68e-14  |g|= 2.49e-10  |ddm|= 2.16e-10
HOMO (B2u) = -0.404109625937743  LUMO (Ag) = -0.10111080072237
cycle= 21 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 2.04e-10  |ddm|= 1.59e-10
HOMO (B2u) = -0.404109625945472  LUMO (Ag) = -0.10111080072845
cycle= 22 E= -75.3287803844734  delta_E= -5.68e-14  |g|= 1.66e-10  |ddm|= 1.23e-10
HOMO (B2u) = -0.404109625951205  LUMO (Ag) = -0.101110800733347
cycle= 23 E= -75.3287803844733  delta_E= 8.53e-14  |g|= 1.34e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.40410962595661  LUMO (Ag) = -0.101110800738328
cycle= 24 E= -75.3287803844733  delta_E= 1.42e-14  |g|= 1.09e-10  |ddm|= 9.77e-11
HOMO (B2u) = -0.404109625961328  LUMO (Ag) = -0.101110800741471
cycle= 25 E= -75.3287803844734  delta_E= -4.26e-14  |g|= 8.4e-11  |ddm|= 7.43e-11
HOMO (B2u) = -0.404109625964662  LUMO (Ag) = -0.101110800743054
cycle= 26 E= -75.3287803844733  delta_E= 5.68e-14  |g|= 5.93e-11  |ddm|= 7.02e-11
HOMO (B2u) = -0.404109625963267  LUMO (Ag) = -0.101110800740642
cycle= 27 E= -75.3287803844731  delta_E= 1.99e-13  |g|= 4.85e-11  |ddm|= 2.48e-11
HOMO (B2u) = -0.404109625961681  LUMO (Ag) = -0.1011108007383
cycle= 28 E= -75.328780384473  delta_E= 1.14e-13  |g|= 3.94e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.404109625960587  LUMO (Ag) = -0.101110800736693
cycle= 29 E= -75.328780384473  delta_E= -2.84e-14  |g|= 3.23e-11  |ddm|= 1.38e-11
HOMO (B2u) = -0.404109625959766  LUMO (Ag) = -0.101110800735532
cycle= 30 E= -75.3287803844728  delta_E= 1.99e-13  |g|= 2.65e-11  |ddm|= 1.04e-11
HOMO (B3u) = -0.404109625959196  LUMO (Ag) = -0.101110800734673
cycle= 31 E= -75.3287803844727  delta_E= 1.42e-13  |g|= 2.18e-11  |ddm|= 8.51e-12
HOMO (B3u) = -0.404109625958816  LUMO (Ag) = -0.101110800734019
cycle= 32 E= -75.3287803844725  delta_E= 1.99e-13  |g|= 1.82e-11  |ddm|= 7.05e-12
HOMO (B2u) = -0.404109625958585  LUMO (Ag) = -0.101110800733492
cycle= 33 E= -75.328780384472  delta_E= 4.83e-13  |g|= 1.57e-11  |ddm|= 6.12e-12
HOMO (B2u) = -0.404109625958484  LUMO (Ag) = -0.101110800733118
cycle= 34 E= -75.3287803844714  delta_E= 6.11e-13  |g|= 1.44e-11  |ddm|= 5.17e-12
HOMO (B2u) = -0.404109625958463  LUMO (Ag) = -0.101110800732882
cycle= 35 E= -75.3287803844704  delta_E= 9.52e-13  |g|= 1.4e-11  |ddm|= 4.01e-12
HOMO (B3u) = -0.404109625958369  LUMO (Ag) = -0.101110800732626
cycle= 36 E= -75.3287803844699  delta_E= 5.83e-13  |g|= 1.3e-11  |ddm|= 4.01e-12
HOMO (B3u) = -0.404109625958226  LUMO (Ag) = -0.101110800732359
cycle= 37 E= -75.3287803844689  delta_E= 9.81e-13  |g|= 1.35e-11  |ddm|= 3.39e-12
HOMO (B2u) = -0.404109625958022  LUMO (Ag) = -0.101110800732064
cycle= 38 E= -75.328780384468  delta_E= 9.09e-13  |g|= 1.45e-11  |ddm|= 3.47e-12
HOMO (B3u) = -0.404109625957776  LUMO (Ag) = -0.10111080073175
cycle= 39 E= -75.3287803844671  delta_E= 8.38e-13  |g|= 1.45e-11  |ddm|= 3.24e-12
HOMO (B3u) = -0.404109625957494  LUMO (Ag) = -0.101110800731409
cycle= 40 E= -75.3287803844665  delta_E= 6.25e-13  |g|= 1.32e-11  |ddm|= 4.11e-12
HOMO (B2u) = -0.404109625957187  LUMO (Ag) = -0.101110800731073
cycle= 41 E= -75.3287803844657  delta_E= 8.38e-13  |g|= 1.22e-11  |ddm|= 3.99e-12
HOMO (B3u) = -0.404109625956862  LUMO (Ag) = -0.101110800730761
cycle= 42 E= -75.3287803844654  delta_E= 2.7e-13  |g|= 1.06e-11  |ddm|= 4.78e-12
HOMO (B2u) = -0.404109625956553  LUMO (Ag) = -0.10111080073047
cycle= 43 E= -75.3287803844648  delta_E= 5.83e-13  |g|= 1.01e-11  |ddm|= 3.92e-12
HOMO (B2u) = -0.404109625956273  LUMO (Ag) = -0.101110800730224
cycle= 44 E= -75.328780384464  delta_E= 8.53e-13  |g|= 9.92e-12  |ddm|= 2.94e-12
HOMO (B3u) = -0.404109625955977  LUMO (Ag) = -0.101110800729979
cycle= 45 E= -75.3287803844631  delta_E= 8.53e-13  |g|= 9.56e-12  |ddm|= 3.5e-12
HOMO (B3u) = -0.404109625955691  LUMO (Ag) = -0.101110800729737
cycle= 46 E= -75.328780384462  delta_E= 1.11e-12  |g|= 1.07e-11  |ddm|= 2.49e-12
HOMO (B3u) = -0.404109625955388  LUMO (Ag) = -0.101110800729487
cycle= 47 E= -75.3287803844609  delta_E= 1.12e-12  |g|= 1.42e-11  |ddm|= 2.56e-12
HOMO (B3u) = -0.404109625955074  LUMO (Ag) = -0.101110800729241
cycle= 48 E= -75.3287803844608  delta_E= 1.14e-13  |g|= 1.29e-11  |ddm|= 7.09e-12
HOMO (B3u) = -0.404109625954789  LUMO (Ag) = -0.101110800729002
cycle= 49 E= -75.3287803844608  delta_E= -7.11e-14  |g|= 1.15e-11  |ddm|= 9.05e-12
HOMO (B3u) = -0.404109625954533  LUMO (Ag) = -0.101110800728771
cycle= 50 E= -75.3287803844607  delta_E= 9.95e-14  |g|= 9.75e-12  |ddm|= 1.12e-11
SCF not converged.
SCF energy = -75.3287803844607

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmplpwkegtx
max_memory 4000 MB (current use 5090 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5139143945445  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5362176871125  dE = -0.022303293  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.54832879955  dE = -0.012111112  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0694  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5564826513851  dE = -0.0081538518  S^2 = 0.0000000
               |grad[o]|=0.0932  |ddm|=0.0313  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.562522441489  dE = -0.0060397901  S^2 = 0.0000000
               |grad[o]|=0.0747  |ddm|=0.0183  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.567086026465  dE = -0.004563585  S^2 = 0.0000000
               |grad[o]|=0.0588  |ddm|=0.0122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5704303794426  dE = -0.003344353  S^2 = 0.0000000
               |grad[o]|=0.0446  |ddm|=0.00858  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5726884494352  dE = -0.00225807  S^2 = 0.0000000
               |grad[o]|=0.0317  |ddm|=0.00647  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5739474748018  dE = -0.0012590254  S^2 = 0.0000000
               |grad[o]|=0.0197  |ddm|=0.0059  |maxRot[o]|=0.0799
macro iter 9 (5 JK  0 micro), CASSCF E = -75.5742840766656  dE = -0.00033660186  S^2 = 0.0000000
               |grad[o]|=0.00856  |ddm|=0.00674  |maxRot[o]|= 0.06
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5742936839157  dE = -9.6072501e-06  S^2 = 0.0000000
               |grad[o]|=0.00138  |ddm|=0.00616  |maxRot[o]|=0.0106
macro iter 11 (3 JK  0 micro), CASSCF E = -75.574293847171  dE = -1.6325522e-07  S^2 = 0.0000000
               |grad[o]|=0.00023  |ddm|=0.00135  |maxRot[o]|=0.00105
macro iter 12 (3 JK  0 micro), CASSCF E = -75.574293850415  dE = -3.2439971e-09  S^2 = 0.0000000
               |grad[o]|=3.41e-05  |ddm|=0.000171  |maxRot[o]|=0.000144
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5742938505331  dE = -1.180922e-10  S^2 = 0.0000000
               |grad[o]|=8.36e-06  |ddm|=2.43e-05  |maxRot[o]|=2.84e-05
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5742938505364  dE = -3.3821834e-12  S^2 = 0.0000000
               |grad[o]|=2.14e-06  |ddm|=3.81e-06  |maxRot[o]|=2.39e-06
2-step CASSCF converged in 14 macro (69 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97574977 1.70399347 1.81154678 1.8115465  0.3030469  0.18612083
 0.18612067 0.02187507]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00665   0.00360   0.00000   0.00000  -0.00085
  0 C 2s       0.62384   0.58827  -0.00000   0.00000  -0.33076
  0 C 3s      -0.03017   0.00916   0.00000   0.00000   0.01475
  0 C 2px      0.00000  -0.00000  -0.00000   0.70651  -0.00000
  0 C 2py      0.00000  -0.00000   0.70651  -0.00000   0.00000
  0 C 2pz      0.32876  -0.39221   0.00000  -0.00000   0.62289
  0 C 3px      0.00000  -0.00000   0.00000   0.01725  -0.00000
  0 C 3py      0.00000  -0.00000   0.01725   0.00000   0.00000
  0 C 3pz     -0.03092  -0.00212   0.00000   0.00000  -0.04192
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02335   0.00000   0.00000
  0 C 3dz^2    0.02875  -0.00240   0.00000   0.00000   0.02515
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02335  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00665  -0.00360   0.00000   0.00000  -0.00085
  1 C 2s       0.62384  -0.58827  -0.00000  -0.00000  -0.33076
  1 C 3s      -0.03017  -0.00916  -0.00000  -0.00000   0.01475
  1 C 2px     -0.00000   0.00000  -0.00000   0.70651   0.00000
  1 C 2py     -0.00000   0.00000   0.70651  -0.00000  -0.00000
  1 C 2pz     -0.32876  -0.39221  -0.00000   0.00000  -0.62289
  1 C 3px     -0.00000   0.00000   0.00000   0.01725   0.00000
  1 C 3py     -0.00000   0.00000   0.01725   0.00000  -0.00000
  1 C 3pz      0.03092  -0.00212   0.00000   0.00000   0.04192
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02335  -0.00000   0.00000
  1 C 3dz^2    0.02875   0.00240  -0.00000  -0.00000   0.02515
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02335  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00033
  0 C 2s       0.00000  -0.00000   0.39163
  0 C 3s       0.00000   0.00000  -0.04339
  0 C 2px      0.70659   0.00000   0.00000
  0 C 2py      0.00000   0.70659   0.00000
  0 C 2pz      0.00000   0.00000   0.58640
  0 C 3px     -0.01557   0.00000   0.00000
  0 C 3py      0.00000  -0.01557   0.00000
  0 C 3pz      0.00000  -0.00000   0.02090
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02201   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.02090
  0 C 3dxz    -0.02201   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000   0.00000
  1 C 1s       0.00000   0.00000   0.00033
  1 C 2s       0.00000   0.00000  -0.39163
  1 C 3s      -0.00000  -0.00000   0.04339
  1 C 2px     -0.70659  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70659  -0.00000
  1 C 2pz      0.00000   0.00000   0.58640
  1 C 3px      0.01557  -0.00000  -0.00000
  1 C 3py     -0.00000   0.01557  -0.00000
  1 C 3pz      0.00000   0.00000   0.02090
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.02201   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.02090
  1 C 3dxz    -0.02201   0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000  -0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99173401
<CAS-nat-orb|mo-hf>  4  4    0.99760699
<CAS-nat-orb|mo-hf>  5  5    0.99948360
<CAS-nat-orb|mo-hf>  6  6    0.99948360
<CAS-nat-orb|mo-hf>  7  7    0.97418543
<CAS-nat-orb|mo-hf>  8  8    0.96886030
<CAS-nat-orb|mo-hf>  9  9    0.96886030
<CAS-nat-orb|mo-hf>  10  10    0.69921223
<CAS-nat-orb|mo-hf>  10  15   -0.63804367
CASSCF energy = -75.5742938505364
CASCI E = -75.5742938505364  E(CI) = -16.4693217807171  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.041

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.058
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.016
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.010
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.106
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.268 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.154 | Tfpread = 0.000 | Tfpwrite = 0.151 | data = 74.1 MB | cpsd = 55.9 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.769 | E =     -75.6505891259 | DW = 2.78e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.376 | E =     -75.6816282383 | DE = -3.10e-02 | DW = 1.21e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.244 | E =     -75.6823003792 | DE = -6.72e-04 | DW = 1.97e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.176 | E =     -75.6830257082 | DE = -7.25e-04 | DW = 1.47e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.046 | E =     -75.6830440887 | DE = -1.84e-05 | DW = 2.02e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.041 | E =     -75.6830792136 | DE = -3.51e-05 | DW = 1.47e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.871 | E =     -75.6830852697 | DE = -6.06e-06 | DW = 2.02e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.895 | E =     -75.6830941915 | DE = -8.92e-06 | DW = 1.45e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     11.114 | E =     -75.6843306838 | DE = -1.24e-03 | DW = 1.88e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.728 | E =     -75.6846203626 | DE = -2.90e-04 | DW = 2.95e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     17.616 | E =     -75.6846983005 | DE = -7.79e-05 | DW = 4.43e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.996 | E =     -75.6847084997 | DE = -1.02e-05 | DW = 3.16e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.184 | E =     -75.6847146394 | DE = -6.14e-06 | DW = 4.46e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.236 | E =     -75.6847173030 | DE = -2.66e-06 | DW = 3.19e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.143 | E =     -75.6847210859 | DE = -3.78e-06 | DW = 4.50e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.235 | E =     -75.6847223612 | DE = -1.28e-06 | DW = 3.19e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.983 | E =     -75.6848985066 | DE = -1.76e-04 | DW = 3.02e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.115 | E =     -75.6849331976 | DE = -3.47e-05 | DW = 1.75e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     66.672 | E =     -75.6849404827 | DE = -7.29e-06 | DW = 4.51e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     77.346 | E =     -75.6849406922 | DE = -2.10e-07 | DW = 1.76e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.300 | E =     -75.6849416491 | DE = -9.57e-07 | DW = 4.51e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    103.257 | E =     -75.6849416213 | DE = 2.78e-08 | DW = 1.76e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    116.358 | E =     -75.6849422426 | DE = -6.21e-07 | DW = 4.51e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    128.607 | E =     -75.6849421773 | DE = 6.53e-08 | DW = 1.76e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    148.350 | E =     -75.6849555821 | DE = -1.34e-05 | DW = 2.86e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    179.390 | E =     -75.6849572683 | DE = -1.69e-06 | DW = 1.36e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    207.664 | E =     -75.6849575509 | DE = -2.83e-07 | DW = 2.61e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    235.122 | E =     -75.6849579040 | DE = -3.53e-07 | DW = 1.39e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    265.726 | E =     -75.6849578311 | DE = 7.29e-08 | DW = 2.72e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    297.530 | E =     -75.6849580759 | DE = -2.45e-07 | DW = 1.40e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    324.937 | E =     -75.6849579648 | DE = 1.11e-07 | DW = 2.74e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    360.737 | E =     -75.6849581907 | DE = -2.26e-07 | DW = 1.39e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    423.372 | E =     -75.6849593429 | DE = -1.15e-06 | DW = 6.72e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    458.565 | E =     -75.6849593429 | DE = -2.96e-11 | DW = 6.72e-08

E(MRCI) = -75.68495934292136  E_corr = -0.1106654923849248
Time cost =    556.878
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:12:23 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.534613911668 AA    0.000000000000   0.000000000000   2.900000000000 Bohr   0.0

nuclear repulsion = 12.4137931034483
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.45]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    172162.38


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpafgzfyh6
max_memory 4000 MB (current use 5089 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0502696488693

WARN: Singularity detected in overlap matrix (condition number =  255). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.171982441441623  LUMO (Ag) = -0.159994465911487
cycle= 1 E= -75.2972707224471  delta_E= -0.247  |g|= 0.236  |ddm|= 1.43
HOMO (B3u) = -0.435771051837407  LUMO (Ag) = -0.150538347855666
cycle= 2 E= -75.3184487790456  delta_E= -0.0212  |g|= 0.051  |ddm|= 0.31
HOMO (B2u) = -0.39780086513172  LUMO (Ag) = -0.102495692949927
cycle= 3 E= -75.3194573772646  delta_E= -0.00101  |g|= 0.0124  |ddm|= 0.0544
HOMO (B2u) = -0.399183030564798  LUMO (Ag) = -0.0993011615665471
cycle= 4 E= -75.3195559425281  delta_E= -9.86e-05  |g|= 0.00229  |ddm|= 0.0157
HOMO (B2u) = -0.399959753294004  LUMO (Ag) = -0.0998732578136651
cycle= 5 E= -75.3195598190019  delta_E= -3.88e-06  |g|= 0.000323  |ddm|= 0.00343
HOMO (B3u) = -0.399888567456491  LUMO (Ag) = -0.0998019916939259
cycle= 6 E= -75.3195598822274  delta_E= -6.32e-08  |g|= 4.09e-05  |ddm|= 0.000646
HOMO (B2u) = -0.399880517827686  LUMO (Ag) = -0.0997890778931016
cycle= 7 E= -75.3195598833514  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000156
HOMO (B3u) = -0.399880142870899  LUMO (Ag) = -0.0997880477227927
cycle= 8 E= -75.319559883367  delta_E= -1.55e-11  |g|= 5.02e-07  |ddm|= 2.32e-05
HOMO (B3u) = -0.399880110369041  LUMO (Ag) = -0.0997878828350397
cycle= 9 E= -75.319559883367  delta_E= 2.84e-14  |g|= 2.12e-08  |ddm|= 1.59e-06
HOMO (B3u) = -0.399880103488951  LUMO (Ag) = -0.0997878912045869
cycle= 10 E= -75.319559883367  delta_E= -2.84e-14  |g|= 3.19e-09  |ddm|= 7.71e-08
HOMO (B3u) = -0.399880104492774  LUMO (Ag) = -0.0997878921946702
cycle= 11 E= -75.319559883367  delta_E= -5.68e-14  |g|= 2.57e-09  |ddm|= 3.68e-09
HOMO (B3u) = -0.39988010419905  LUMO (Ag) = -0.0997878918212044
cycle= 12 E= -75.319559883367  delta_E= 2.84e-14  |g|= 1.87e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.399880104169367  LUMO (Ag) = -0.0997878916909738
cycle= 13 E= -75.319559883367  delta_E= -2.84e-14  |g|= 1.58e-09  |ddm|= 1.61e-09
HOMO (B2u) = -0.399880104126802  LUMO (Ag) = -0.0997878916470373
cycle= 14 E= -75.319559883367  delta_E=    0  |g|= 1.31e-09  |ddm|= 1.09e-09
HOMO (B2u) = -0.399880104099621  LUMO (Ag) = -0.0997878916239718
cycle= 15 E= -75.319559883367  delta_E= 8.53e-14  |g|= 1.11e-09  |ddm|= 6.96e-10
HOMO (B2u) = -0.39988010408625  LUMO (Ag) = -0.0997878916343568
cycle= 16 E= -75.319559883367  delta_E= -5.68e-14  |g|= 1.01e-09  |ddm|= 9.01e-10
HOMO (B2u) = -0.399880104058022  LUMO (Ag) = -0.0997878916092053
cycle= 17 E= -75.319559883367  delta_E=    0  |g|= 9.25e-10  |ddm|= 3.41e-10
HOMO (B2u) = -0.399880103906985  LUMO (Ag) = -0.0997878914693907
cycle= 18 E= -75.319559883367  delta_E= 5.68e-14  |g|= 4.03e-10  |ddm|= 2.15e-09
HOMO (B2u) = -0.399880103908048  LUMO (Ag) = -0.0997878914633991
cycle= 19 E= -75.3195598833671  delta_E= -1.42e-13  |g|= 3.3e-10  |ddm|= 3.17e-10
HOMO (B2u) = -0.399880103926961  LUMO (Ag) = -0.0997878914762784
cycle= 20 E= -75.3195598833671  delta_E=    0  |g|= 2.64e-10  |ddm|= 2.23e-10
HOMO (B2u) = -0.399880103938454  LUMO (Ag) = -0.0997878914831057
cycle= 21 E= -75.319559883367  delta_E= 1.14e-13  |g|= 2.17e-10  |ddm|= 1.65e-10
HOMO (B2u) = -0.399880103945878  LUMO (Ag) = -0.0997878914896904
cycle= 22 E= -75.319559883367  delta_E= -5.68e-14  |g|= 1.76e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.399880103951602  LUMO (Ag) = -0.0997878914950272
cycle= 23 E= -75.319559883367  delta_E=    0  |g|= 1.42e-10  |ddm|= 1.08e-10
HOMO (B2u) = -0.399880103957418  LUMO (Ag) = -0.0997878915008465
cycle= 24 E= -75.319559883367  delta_E=    0  |g|= 1.14e-10  |ddm|= 1.04e-10
HOMO (B2u) = -0.399880103962209  LUMO (Ag) = -0.0997878915047865
cycle= 25 E= -75.319559883367  delta_E=    0  |g|= 8.77e-11  |ddm|= 8.45e-11
HOMO (B2u) = -0.399880103960217  LUMO (Ag) = -0.0997878915001716
Extra cycle  E= -75.319559883367  delta_E= 2.84e-14  |g|= 2.66e-11  |ddm|= 1.54e-10
converged SCF energy = -75.319559883367

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpafgzfyh6
max_memory 4000 MB (current use 5089 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.5069071999532  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5287793153018  dE = -0.021872115  S^2 = 0.0000000
               |grad[o]|=0.148  |ddm|= 3.72  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5408869080812  dE = -0.012107593  S^2 = 0.0000000
               |grad[o]|=0.117  |ddm|=0.0689  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5490568342284  dE = -0.0081699261  S^2 = 0.0000000
               |grad[o]|=0.0931  |ddm|=0.0319  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.555056478915  dE = -0.0059996447  S^2 = 0.0000000
               |grad[o]|=0.0741  |ddm|=0.0189  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5595105396428  dE = -0.0044540607  S^2 = 0.0000000
               |grad[o]|=0.0578  |ddm|=0.0126  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5626826681489  dE = -0.0031721285  S^2 = 0.0000000
               |grad[o]|=0.043  |ddm|=0.00882  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5647157862231  dE = -0.0020331181  S^2 = 0.0000000
               |grad[o]|=0.0294  |ddm|=0.00676  |maxRot[o]|=0.0799
macro iter 8 (6 JK  0 micro), CASSCF E = -75.5657086773443  dE = -0.00099289112  S^2 = 0.0000000
               |grad[o]|=0.0169  |ddm|=0.00658  |maxRot[o]|=0.0799
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5658453333932  dE = -0.00013665605  S^2 = 0.0000000
               |grad[o]|=0.00539  |ddm|=0.00792  |maxRot[o]|= 0.04
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5658470538095  dE = -1.7204163e-06  S^2 = 0.0000000
               |grad[o]|=0.000741  |ddm|=0.00487  |maxRot[o]|=0.00387
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5658470908325  dE = -3.7023e-08  S^2 = 0.0000000
               |grad[o]|=0.000113  |ddm|=0.000648  |maxRot[o]|=0.000437
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5658470916885  dE = -8.5603347e-10  S^2 = 0.0000000
               |grad[o]|=1.99e-05  |ddm|=8.25e-05  |maxRot[o]|=7.13e-05
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5658470917018  dE = -1.3272938e-11  S^2 = 0.0000000
               |grad[o]|=3.51e-06  |ddm|=1.09e-05  |maxRot[o]|=7.33e-06
2-step CASSCF converged in 13 macro (65 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97493427 1.71266362 1.80127972 1.80127945 0.2974247  0.19483012
 0.19483021 0.02275791]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00688   0.00368   0.00000   0.00000  -0.00082
  0 C 2s       0.62688   0.59446  -0.00000  -0.00000  -0.32511
  0 C 3s      -0.02821   0.00928  -0.00000  -0.00000   0.01701
  0 C 2px      0.00000  -0.00000  -0.00000   0.70649   0.00000
  0 C 2py     -0.00000  -0.00000   0.70649  -0.00000   0.00000
  0 C 2pz      0.32333  -0.38275   0.00000  -0.00000   0.62576
  0 C 3px      0.00000  -0.00000   0.00000   0.01921   0.00000
  0 C 3py     -0.00000   0.00000   0.01921   0.00000  -0.00000
  0 C 3pz     -0.02927  -0.00203  -0.00000  -0.00000  -0.04115
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.02251   0.00000  -0.00000
  0 C 3dz^2    0.02800  -0.00269  -0.00000  -0.00000   0.02714
  0 C 3dxz     0.00000  -0.00000   0.00000   0.02251   0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00688  -0.00368   0.00000   0.00000  -0.00082
  1 C 2s       0.62688  -0.59446   0.00000   0.00000  -0.32511
  1 C 3s      -0.02821  -0.00928   0.00000   0.00000   0.01701
  1 C 2px     -0.00000  -0.00000  -0.00000   0.70649  -0.00000
  1 C 2py      0.00000  -0.00000   0.70649  -0.00000   0.00000
  1 C 2pz     -0.32333  -0.38275  -0.00000  -0.00000  -0.62576
  1 C 3px     -0.00000   0.00000   0.00000   0.01921  -0.00000
  1 C 3py      0.00000  -0.00000   0.01921   0.00000  -0.00000
  1 C 3pz      0.02927  -0.00203  -0.00000  -0.00000   0.04115
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02251  -0.00000  -0.00000
  1 C 3dz^2    0.02800   0.00269  -0.00000   0.00000   0.02714
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02251   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.38220
  0 C 3s      -0.00000  -0.00000  -0.04321
  0 C 2px      0.70662  -0.00000  -0.00000
  0 C 2py     -0.00000   0.70662  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.59260
  0 C 3px     -0.01471  -0.00000  -0.00000
  0 C 3py     -0.00000  -0.01471  -0.00000
  0 C 3pz     -0.00000  -0.00000   0.02126
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000  -0.02171  -0.00000
  0 C 3dz^2   -0.00000  -0.00000  -0.02074
  0 C 3dxz    -0.02171  -0.00000  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.38220
  1 C 3s       0.00000   0.00000   0.04321
  1 C 2px     -0.70662   0.00000   0.00000
  1 C 2py      0.00000  -0.70662   0.00000
  1 C 2pz     -0.00000  -0.00000   0.59260
  1 C 3px      0.01471   0.00000   0.00000
  1 C 3py      0.00000   0.01471   0.00000
  1 C 3pz     -0.00000  -0.00000   0.02126
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02171  -0.00000
  1 C 3dz^2    0.00000   0.00000   0.02074
  1 C 3dxz    -0.02171  -0.00000  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99150094
<CAS-nat-orb|mo-hf>  4  4    0.99751313
<CAS-nat-orb|mo-hf>  5  5    0.99943968
<CAS-nat-orb|mo-hf>  6  6    0.99943968
<CAS-nat-orb|mo-hf>  7  7    0.97389125
<CAS-nat-orb|mo-hf>  8  8    0.97085576
<CAS-nat-orb|mo-hf>  9  9    0.97085575
<CAS-nat-orb|mo-hf>  10  10    0.72379448
<CAS-nat-orb|mo-hf>  10  14   -0.61908433
CASSCF energy = -75.5658470917018
CASCI E = -75.5658470917018  E(CI) = -16.3640995380281  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.001
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.001
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.006
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.044

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.065
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.019
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.020
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.013
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.127
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.10
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.10
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.05
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.302 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.178 | Tfpread = 0.000 | Tfpwrite = 0.173 | data = 74.1 MB | cpsd = 55.9 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.295 | E =     -75.6388783943 | DW = 2.95e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.713 | E =     -75.6737882566 | DE = -3.49e-02 | DW = 1.17e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.601 | E =     -75.6744913409 | DE = -7.03e-04 | DW = 2.01e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.505 | E =     -75.6752287083 | DE = -7.37e-04 | DW = 1.49e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.357 | E =     -75.6752464190 | DE = -1.77e-05 | DW = 2.09e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.153 | E =     -75.6752821291 | DE = -3.57e-05 | DW = 1.51e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.898 | E =     -75.6752938640 | DE = -1.17e-05 | DW = 2.09e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.674 | E =     -75.6753174024 | DE = -2.35e-05 | DW = 1.52e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     10.879 | E =     -75.6766075210 | DE = -1.29e-03 | DW = 1.99e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.017 | E =     -75.6769197790 | DE = -3.12e-04 | DW = 3.18e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     18.175 | E =     -75.6770032471 | DE = -8.35e-05 | DW = 4.75e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     21.225 | E =     -75.6770154854 | DE = -1.22e-05 | DW = 3.41e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.467 | E =     -75.6770236109 | DE = -8.13e-06 | DW = 4.79e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.829 | E =     -75.6770263793 | DE = -2.77e-06 | DW = 3.44e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.794 | E =     -75.6770304143 | DE = -4.04e-06 | DW = 4.81e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.717 | E =     -75.6770317603 | DE = -1.35e-06 | DW = 3.44e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.281 | E =     -75.6772173397 | DE = -1.86e-04 | DW = 3.14e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     51.112 | E =     -75.6772534280 | DE = -3.61e-05 | DW = 1.82e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     76.393 | E =     -75.6772616014 | DE = -8.17e-06 | DW = 4.72e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     92.603 | E =     -75.6772618542 | DE = -2.53e-07 | DW = 1.85e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    105.533 | E =     -75.6772628821 | DE = -1.03e-06 | DW = 4.70e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    118.631 | E =     -75.6772629064 | DE = -2.42e-08 | DW = 1.85e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    131.581 | E =     -75.6772637130 | DE = -8.07e-07 | DW = 4.71e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    144.132 | E =     -75.6772636602 | DE = 5.29e-08 | DW = 1.85e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    167.390 | E =     -75.6772775524 | DE = -1.39e-05 | DW = 2.96e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    196.183 | E =     -75.6772794046 | DE = -1.85e-06 | DW = 1.41e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    226.096 | E =     -75.6772801114 | DE = -7.07e-07 | DW = 3.20e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    252.759 | E =     -75.6772799626 | DE = 1.49e-07 | DW = 1.45e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    280.354 | E =     -75.6772801194 | DE = -1.57e-07 | DW = 2.83e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    309.460 | E =     -75.6772803801 | DE = -2.61e-07 | DW = 1.45e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    336.810 | E =     -75.6772802357 | DE = 1.44e-07 | DW = 2.79e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    365.135 | E =     -75.6772805324 | DE = -2.97e-07 | DW = 1.46e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    435.546 | E =     -75.6772822413 | DE = -1.71e-06 | DW = 7.04e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    469.772 | E =     -75.6772822413 | DE = -1.23e-11 | DW = 7.04e-08

E(MRCI) = -75.67728224129937  E_corr = -0.1114351495975825
Time cost =    550.252
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:21:33 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.561072772214 AA    0.000000000000   0.000000000000   2.950000000000 Bohr   0.0

nuclear repulsion = 12.2033898305085
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.475]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    180092.42


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp7ki0s9nk
max_memory 4000 MB (current use 5132 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -75.0186954217206

WARN: Singularity detected in overlap matrix (condition number =  236). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.165974687131634  LUMO (Ag) = -0.158079543422892
cycle= 1 E= -75.2873378760354  delta_E= -0.269  |g|= 0.239  |ddm|= 1.43
HOMO (B3u) = -0.431571893819984  LUMO (Ag) = -0.149790781563185
cycle= 2 E= -75.3090731833374  delta_E= -0.0217  |g|= 0.0507  |ddm|= 0.316
HOMO (B3u) = -0.393547996937856  LUMO (Ag) = -0.100989331184846
cycle= 3 E= -75.3100918952135  delta_E= -0.00102  |g|= 0.0127  |ddm|= 0.0544
HOMO (B3u) = -0.395075054129109  LUMO (Ag) = -0.0978528282721949
cycle= 4 E= -75.3101958879618  delta_E= -0.000104  |g|= 0.00229  |ddm|= 0.0157
HOMO (B3u) = -0.395838291352905  LUMO (Ag) = -0.0984379062399637
cycle= 5 E= -75.3101998099164  delta_E= -3.92e-06  |g|= 0.000326  |ddm|= 0.00328
HOMO (B3u) = -0.395768945444499  LUMO (Ag) = -0.0983739814936185
cycle= 6 E= -75.3101998734464  delta_E= -6.35e-08  |g|= 4.1e-05  |ddm|= 0.000649
HOMO (B3u) = -0.395760954503403  LUMO (Ag) = -0.0983611341563445
cycle= 7 E= -75.3101998745661  delta_E= -1.12e-09  |g|= 5.24e-06  |ddm|= 0.000143
HOMO (B3u) = -0.395760469633685  LUMO (Ag) = -0.0983600611975554
cycle= 8 E= -75.310199874582  delta_E= -1.59e-11  |g|= 5.2e-07  |ddm|= 2.23e-05
HOMO (B3u) = -0.395760436404823  LUMO (Ag) = -0.0983598792412559
cycle= 9 E= -75.3101998745822  delta_E= -1.42e-13  |g|= 2.17e-08  |ddm|= 1.39e-06
HOMO (B3u) = -0.395760429248383  LUMO (Ag) = -0.0983598897706397
cycle= 10 E= -75.3101998745821  delta_E= 5.68e-14  |g|= 3.33e-09  |ddm|= 8.05e-08
HOMO (B3u) = -0.395760430313182  LUMO (Ag) = -0.0983598908473278
cycle= 11 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 2.6e-09  |ddm|= 4.16e-09
HOMO (B3u) = -0.395760430019763  LUMO (Ag) = -0.0983598904704316
cycle= 12 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 1.93e-09  |ddm|= 2.62e-09
HOMO (B3u) = -0.395760430010127  LUMO (Ag) = -0.0983598903379396
cycle= 13 E= -75.3101998745821  delta_E= 9.95e-14  |g|= 1.67e-09  |ddm|= 1.74e-09
HOMO (B3u) = -0.395760429956846  LUMO (Ag) = -0.0983598902854213
cycle= 14 E= -75.3101998745822  delta_E= -5.68e-14  |g|= 1.39e-09  |ddm|= 9.68e-10
HOMO (B3u) = -0.395760429928458  LUMO (Ag) = -0.0983598902665723
cycle= 15 E= -75.3101998745823  delta_E= -5.68e-14  |g|= 1.19e-09  |ddm|= 8e-10
HOMO (B3u) = -0.395760429913514  LUMO (Ag) = -0.0983598902681461
cycle= 16 E= -75.3101998745821  delta_E= 1.71e-13  |g|= 1.06e-09  |ddm|= 8.03e-10
HOMO (B3u) = -0.395760429892041  LUMO (Ag) = -0.0983598902484902
cycle= 17 E= -75.3101998745822  delta_E= -1.56e-13  |g|= 9.59e-10  |ddm|= 4.23e-10
HOMO (B3u) = -0.395760429734567  LUMO (Ag) = -0.0983598901198581
cycle= 18 E= -75.3101998745822  delta_E= 4.26e-14  |g|= 4.21e-10  |ddm|= 2.31e-09
HOMO (B3u) = -0.395760429735099  LUMO (Ag) = -0.098359890113631
cycle= 19 E= -75.3101998745822  delta_E= -1.42e-14  |g|= 3.45e-10  |ddm|= 3.34e-10
HOMO (B3u) = -0.395760429753827  LUMO (Ag) = -0.0983598901268101
cycle= 20 E= -75.3101998745822  delta_E=    0  |g|= 2.78e-10  |ddm|= 2.29e-10
HOMO (B3u) = -0.395760429765423  LUMO (Ag) = -0.0983598901336986
cycle= 21 E= -75.3101998745822  delta_E= 4.26e-14  |g|= 2.31e-10  |ddm|= 1.7e-10
HOMO (B3u) = -0.395760429772695  LUMO (Ag) = -0.0983598901408026
cycle= 22 E= -75.3101998745823  delta_E= -8.53e-14  |g|= 1.87e-10  |ddm|= 1.33e-10
HOMO (B3u) = -0.395760429778192  LUMO (Ag) = -0.0983598901464971
cycle= 23 E= -75.3101998745822  delta_E= 8.53e-14  |g|= 1.51e-10  |ddm|= 1.13e-10
HOMO (B3u) = -0.395760429784151  LUMO (Ag) = -0.0983598901529704
cycle= 24 E= -75.3101998745822  delta_E= 1.42e-14  |g|= 1.2e-10  |ddm|= 1.11e-10
HOMO (B3u) = -0.395760429789064  LUMO (Ag) = -0.0983598901578732
cycle= 25 E= -75.3101998745822  delta_E= -4.26e-14  |g|= 9.18e-11  |ddm|= 9.33e-11
HOMO (B3u) = -0.395760429793047  LUMO (Ag) = -0.0983598901618839
cycle= 26 E= -75.3101998745822  delta_E= 1.42e-14  |g|= 6.61e-11  |ddm|= 8.5e-11
HOMO (B3u) = -0.395760429791677  LUMO (Ag) = -0.0983598901598056
cycle= 27 E= -75.3101998745821  delta_E= 9.95e-14  |g|= 5.42e-11  |ddm|= 2.88e-11
HOMO (B3u) = -0.395760429790041  LUMO (Ag) = -0.0983598901577133
cycle= 28 E= -75.3101998745821  delta_E= -4.26e-14  |g|= 4.43e-11  |ddm|= 2.17e-11
HOMO (B3u) = -0.39576042978885  LUMO (Ag) = -0.0983598901563148
cycle= 29 E= -75.3101998745819  delta_E= 2.13e-13  |g|= 3.6e-11  |ddm|= 1.7e-11
HOMO (B3u) = -0.395760429787904  LUMO (Ag) = -0.0983598901553607
cycle= 30 E= -75.3101998745817  delta_E= 1.71e-13  |g|= 2.91e-11  |ddm|= 1.33e-11
HOMO (B3u) = -0.395760429787239  LUMO (Ag) = -0.0983598901546877
cycle= 31 E= -75.3101998745813  delta_E= 4.41e-13  |g|= 2.38e-11  |ddm|= 1.01e-11
HOMO (B3u) = -0.395760429786783  LUMO (Ag) = -0.0983598901542165
cycle= 32 E= -75.3101998745808  delta_E= 5.12e-13  |g|= 2.15e-11  |ddm|= 7.38e-12
HOMO (B3u) = -0.395760429786477  LUMO (Ag) = -0.0983598901538544
cycle= 33 E= -75.3101998745806  delta_E= 1.99e-13  |g|= 1.77e-11  |ddm|= 8.41e-12
HOMO (B3u) = -0.395760429786313  LUMO (Ag) = -0.0983598901536178
cycle= 34 E= -75.3101998745803  delta_E= 2.84e-13  |g|= 1.51e-11  |ddm|= 8.42e-12
HOMO (B3u) = -0.395760429786263  LUMO (Ag) = -0.0983598901534825
cycle= 35 E= -75.31019987458  delta_E= 3.13e-13  |g|= 1.32e-11  |ddm|= 8.95e-12
HOMO (B3u) = -0.395760429786167  LUMO (Ag) = -0.0983598901533285
cycle= 36 E= -75.3101998745798  delta_E= 2.27e-13  |g|= 1.16e-11  |ddm|= 9.34e-12
HOMO (B3u) = -0.39576042978603  LUMO (Ag) = -0.0983598901531536
cycle= 37 E= -75.3101998745796  delta_E= 1.99e-13  |g|= 1e-11  |ddm|= 9.26e-12
HOMO (B3u) = -0.395760429785879  LUMO (Ag) = -0.098359890152985
cycle= 38 E= -75.3101998745795  delta_E= 2.84e-14  |g|= 8.67e-12  |ddm|= 9.51e-12
HOMO (B3u) = -0.395760429785725  LUMO (Ag) = -0.0983598901528276
cycle= 39 E= -75.3101998745796  delta_E= -1.42e-14  |g|= 7.58e-12  |ddm|= 9.01e-12
HOMO (B3u) = -0.395760429785583  LUMO (Ag) = -0.0983598901526857
cycle= 40 E= -75.3101998745794  delta_E= 1.56e-13  |g|= 6.56e-12  |ddm|= 8.43e-12
HOMO (B3u) = -0.39576042978546  LUMO (Ag) = -0.0983598901525604
cycle= 41 E= -75.3101998745792  delta_E= 2.27e-13  |g|= 5.55e-12  |ddm|= 3.88e-12
HOMO (B3u) = -0.395760429785336  LUMO (Ag) = -0.0983598901524277
cycle= 42 E= -75.3101998745788  delta_E= 3.27e-13  |g|= 4.75e-12  |ddm|= 4.28e-12
HOMO (B3u) = -0.395760429785214  LUMO (Ag) = -0.0983598901522846
cycle= 43 E= -75.3101998745785  delta_E= 3.27e-13  |g|= 4.14e-12  |ddm|= 4.27e-12
HOMO (B3u) = -0.395760429785099  LUMO (Ag) = -0.0983598901521522
cycle= 44 E= -75.3101998745781  delta_E= 4.12e-13  |g|= 3.98e-12  |ddm|= 3.64e-12
HOMO (B3u) = -0.395760429784991  LUMO (Ag) = -0.098359890152035
cycle= 45 E= -75.3101998745777  delta_E= 4.41e-13  |g|= 4.11e-12  |ddm|= 3.3e-12
HOMO (B3u) = -0.395760429784874  LUMO (Ag) = -0.0983598901519076
cycle= 46 E= -75.3101998745771  delta_E= 5.4e-13  |g|= 4.51e-12  |ddm|= 2.86e-12
HOMO (B3u) = -0.395760429784741  LUMO (Ag) = -0.0983598901517638
cycle= 47 E= -75.3101998745766  delta_E= 5.54e-13  |g|= 4.73e-12  |ddm|= 2.75e-12
HOMO (B3u) = -0.39576042978459  LUMO (Ag) = -0.0983598901516043
cycle= 48 E= -75.3101998745759  delta_E= 6.39e-13  |g|= 5.19e-12  |ddm|= 2.12e-12
HOMO (B3u) = -0.395760429784412  LUMO (Ag) = -0.0983598901514208
cycle= 49 E= -75.310199874575  delta_E= 9.09e-13  |g|= 5.87e-12  |ddm|= 2.19e-12
HOMO (B3u) = -0.395760429784211  LUMO (Ag) = -0.0983598901512229
cycle= 50 E= -75.3101998745747  delta_E= 3.41e-13  |g|= 6.31e-12  |ddm|= 3.32e-12
SCF not converged.
SCF energy = -75.3101998745747

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp7ki0s9nk
max_memory 4000 MB (current use 5132 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4998295378015  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5213159082324  dE = -0.02148637  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|= 3.71  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5334030892161  dE = -0.012087181  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0681  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5415710510219  dE = -0.0081679618  S^2 = 0.0000000
               |grad[o]|=0.0926  |ddm|=0.0324  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5475076686806  dE = -0.0059366177  S^2 = 0.0000000
               |grad[o]|=0.0732  |ddm|=0.0196  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5518232626569  dE = -0.004315594  S^2 = 0.0000000
               |grad[o]|=0.0563  |ddm|=0.0131  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5547903400475  dE = -0.0029670774  S^2 = 0.0000000
               |grad[o]|=0.0409  |ddm|=0.00919  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5565623680746  dE = -0.001772028  S^2 = 0.0000000
               |grad[o]|=0.0267  |ddm|=0.00731  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.557174970836  dE = -0.00061260276  S^2 = 0.0000000
               |grad[o]|=0.0136  |ddm|=0.00767  |maxRot[o]|= 0.06
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5572696084419  dE = -9.4637606e-05  S^2 = 0.0000000
               |grad[o]|=0.00458  |ddm|=0.00702  |maxRot[o]|=0.0325
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5572707210387  dE = -1.1125968e-06  S^2 = 0.0000000
               |grad[o]|=0.00063  |ddm|=0.00452  |maxRot[o]|=0.00289
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5572707457273  dE = -2.4688546e-08  S^2 = 0.0000000
               |grad[o]|=9.64e-05  |ddm|=0.000587  |maxRot[o]|=0.000339
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5572707462611  dE = -5.3378812e-10  S^2 = 0.0000000
               |grad[o]|=1.7e-05  |ddm|=7.45e-05  |maxRot[o]|=4.85e-05
macro iter 13 (4 JK  0 micro), CASSCF E = -75.5572707462971  dE = -3.6067149e-11  S^2 = 0.0000000
               |grad[o]|=5.3e-06  |ddm|=1.24e-05  |maxRot[o]|=9.48e-06
2-step CASSCF converged in 13 macro (64 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97414465 1.72120313 1.79044307 1.79044142 0.29254486 0.20379333
 0.20379267 0.02363686]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00710   0.00377   0.00000   0.00000  -0.00079
  0 C 2s       0.62989   0.60047   0.00000   0.00000  -0.31937
  0 C 3s      -0.02627   0.00941  -0.00000   0.00000   0.01911
  0 C 2px     -0.00000   0.00000   0.00000   0.70646  -0.00000
  0 C 2py      0.00000  -0.00000   0.70646   0.00000  -0.00000
  0 C 2pz      0.31779  -0.37325   0.00000   0.00000   0.62862
  0 C 3px     -0.00000   0.00000  -0.00000   0.02107  -0.00000
  0 C 3py      0.00000  -0.00000   0.02107  -0.00000  -0.00000
  0 C 3pz     -0.02764  -0.00196  -0.00000   0.00000  -0.04016
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.02166  -0.00000  -0.00000
  0 C 3dz^2    0.02729  -0.00296  -0.00000   0.00000   0.02921
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.02166  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00710  -0.00377   0.00000   0.00000  -0.00079
  1 C 2s       0.62989  -0.60047   0.00000  -0.00000  -0.31937
  1 C 3s      -0.02627  -0.00941  -0.00000  -0.00000   0.01911
  1 C 2px      0.00000   0.00000   0.00000   0.70646   0.00000
  1 C 2py      0.00000   0.00000   0.70646   0.00000   0.00000
  1 C 2pz     -0.31779  -0.37325   0.00000   0.00000  -0.62862
  1 C 3px      0.00000  -0.00000  -0.00000   0.02107   0.00000
  1 C 3py     -0.00000   0.00000   0.02107   0.00000   0.00000
  1 C 3pz      0.02764  -0.00196   0.00000   0.00000   0.04016
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.02166  -0.00000  -0.00000
  1 C 3dz^2    0.02729   0.00296  -0.00000  -0.00000   0.02921
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.02166  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00027
  0 C 2s       0.00000   0.00000   0.37274
  0 C 3s       0.00000  -0.00000  -0.04290
  0 C 2px      0.70665  -0.00000   0.00000
  0 C 2py     -0.00000   0.70665   0.00000
  0 C 2pz      0.00000  -0.00000   0.59862
  0 C 3px     -0.01384   0.00000   0.00000
  0 C 3py      0.00000  -0.01384  -0.00000
  0 C 3pz      0.00000  -0.00000   0.02142
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02139  -0.00000
  0 C 3dz^2    0.00000  -0.00000  -0.02055
  0 C 3dxz    -0.02139   0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00027
  1 C 2s      -0.00000   0.00000  -0.37274
  1 C 3s      -0.00000   0.00000   0.04290
  1 C 2px     -0.70665   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70665   0.00000
  1 C 2pz      0.00000   0.00000   0.59862
  1 C 3px      0.01384   0.00000  -0.00000
  1 C 3py      0.00000   0.01384   0.00000
  1 C 3pz      0.00000  -0.00000   0.02142
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.02139  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.02055
  1 C 3dxz    -0.02139  -0.00000   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99129319
<CAS-nat-orb|mo-hf>  4  4    0.99742899
<CAS-nat-orb|mo-hf>  5  5    0.99939340
<CAS-nat-orb|mo-hf>  6  6    0.99939339
<CAS-nat-orb|mo-hf>  7  7    0.97366305
<CAS-nat-orb|mo-hf>  8  8    0.97269188
<CAS-nat-orb|mo-hf>  9  9    0.97269178
<CAS-nat-orb|mo-hf>  10  10    0.74746757
<CAS-nat-orb|mo-hf>  10  14   -0.59840356
CASSCF energy = -75.5572707462971
CASCI E = -75.5572707462971  E(CI) = -16.2620311781178  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.339
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.101
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.666

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.030
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.278
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.013
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.010
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.013
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.382
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.09
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.04
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.226 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.145 | Tfpread = 0.000 | Tfpwrite = 0.142 | data = 74.1 MB | cpsd = 55.9 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.716 | E =     -75.6038617244 | DW = 3.07e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     13.398 | E =     -75.6627692549 | DE = -5.89e-02 | DW = 1.17e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     16.514 | E =     -75.6654671612 | DE = -2.70e-03 | DW = 2.22e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     17.346 | E =     -75.6671021311 | DE = -1.63e-03 | DW = 1.56e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.040 | E =     -75.6671583395 | DE = -5.62e-05 | DW = 2.21e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.820 | E =     -75.6674147988 | DE = -2.56e-04 | DW = 1.57e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.181 | E =     -75.6674256599 | DE = -1.09e-05 | DW = 2.18e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.945 | E =     -75.6674659405 | DE = -4.03e-05 | DW = 1.56e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.000 | E =     -75.6688866649 | DE = -1.42e-03 | DW = 2.12e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     28.315 | E =     -75.6692210557 | DE = -3.34e-04 | DW = 3.46e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.815 | E =     -75.6693257107 | DE = -1.05e-04 | DW = 5.13e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.718 | E =     -75.6693388882 | DE = -1.32e-05 | DW = 3.73e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.545 | E =     -75.6693430093 | DE = -4.12e-06 | DW = 5.19e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     46.425 | E =     -75.6693448134 | DE = -1.80e-06 | DW = 3.74e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     51.373 | E =     -75.6693472911 | DE = -2.48e-06 | DW = 5.19e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     56.402 | E =     -75.6693482460 | DE = -9.55e-07 | DW = 3.74e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     65.013 | E =     -75.6695408861 | DE = -1.93e-04 | DW = 3.29e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     76.198 | E =     -75.6695782545 | DE = -3.74e-05 | DW = 1.92e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     86.819 | E =     -75.6695864982 | DE = -8.24e-06 | DW = 4.95e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     98.605 | E =     -75.6695865961 | DE = -9.79e-08 | DW = 1.95e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.666 | E =     -75.6695875158 | DE = -9.20e-07 | DW = 4.94e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.416 | E =     -75.6695874527 | DE = 6.31e-08 | DW = 1.95e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    131.742 | E =     -75.6695881544 | DE = -7.02e-07 | DW = 4.93e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    143.128 | E =     -75.6695880716 | DE = 8.28e-08 | DW = 1.95e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    164.760 | E =     -75.6696023782 | DE = -1.43e-05 | DW = 3.08e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    193.500 | E =     -75.6696043113 | DE = -1.93e-06 | DW = 1.48e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    221.399 | E =     -75.6696050638 | DE = -7.52e-07 | DW = 3.32e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    249.254 | E =     -75.6696049016 | DE = 1.62e-07 | DW = 1.50e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    277.060 | E =     -75.6696049559 | DE = -5.43e-08 | DW = 2.88e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    307.048 | E =     -75.6696052705 | DE = -3.15e-07 | DW = 1.52e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    332.420 | E =     -75.6696051942 | DE = 7.63e-08 | DW = 2.95e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    363.835 | E =     -75.6696054507 | DE = -2.57e-07 | DW = 1.50e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    431.972 | E =     -75.6696074002 | DE = -1.95e-06 | DW = 7.36e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    463.397 | E =     -75.6696074003 | DE = -2.06e-11 | DW = 7.36e-08

E(MRCI) = -75.66960740025145  E_corr = -0.1123366539543298
Time cost =    803.199
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:34:56 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.587531632760 AA    0.000000000000   0.000000000000   3.000000000000 Bohr   0.0

nuclear repulsion = 12
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.5]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    188848.55


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpaes606me
max_memory 4000 MB (current use 5093 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9888325390205

WARN: Singularity detected in overlap matrix (condition number =  219). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.160268488606779  LUMO (Ag) = -0.156209924431071
cycle= 1 E= -75.2773690146387  delta_E= -0.289  |g|= 0.241  |ddm|= 1.43
HOMO (B3u) = -0.427459076932469  LUMO (Ag) = -0.148855300078026
cycle= 2 E= -75.2996288397617  delta_E= -0.0223  |g|= 0.0503  |ddm|= 0.321
HOMO (B3u) = -0.389387614274554  LUMO (Ag) = -0.0993360736972382
cycle= 3 E= -75.3006548036907  delta_E= -0.00103  |g|= 0.013  |ddm|= 0.0545
HOMO (B2u) = -0.391075001807691  LUMO (Ag) = -0.0963133132876637
cycle= 4 E= -75.3007634017489  delta_E= -0.000109  |g|= 0.00228  |ddm|= 0.0159
HOMO (B3u) = -0.391819817512154  LUMO (Ag) = -0.0969078799501825
cycle= 5 E= -75.3007673195955  delta_E= -3.92e-06  |g|= 0.000327  |ddm|= 0.00318
HOMO (B2u) = -0.391752968347539  LUMO (Ag) = -0.0968518020879507
cycle= 6 E= -75.3007673825198  delta_E= -6.29e-08  |g|= 4.07e-05  |ddm|= 0.000647
HOMO (B2u) = -0.391745163678225  LUMO (Ag) = -0.0968392001457639
cycle= 7 E= -75.3007673836115  delta_E= -1.09e-09  |g|= 5.16e-06  |ddm|= 0.00013
HOMO (B3u) = -0.391744579298911  LUMO (Ag) = -0.0968381087429976
cycle= 8 E= -75.3007673836274  delta_E= -1.6e-11  |g|= 5.37e-07  |ddm|= 2.12e-05
HOMO (B3u) = -0.39174454506944  LUMO (Ag) = -0.0968379095785099
cycle= 9 E= -75.3007673836275  delta_E= -9.95e-14  |g|= 2.23e-08  |ddm|= 1.2e-06
HOMO (B2u) = -0.391744537674295  LUMO (Ag) = -0.0968379222718529
cycle= 10 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 3.48e-09  |ddm|= 8.33e-08
HOMO (B2u) = -0.391744538795801  LUMO (Ag) = -0.0968379234294149
cycle= 11 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 2.62e-09  |ddm|= 4.63e-09
HOMO (B2u) = -0.391744538505134  LUMO (Ag) = -0.0968379230550611
cycle= 12 E= -75.3007673836276  delta_E= 1.42e-14  |g|= 2e-09  |ddm|= 2.49e-09
HOMO (B2u) = -0.391744538507637  LUMO (Ag) = -0.0968379229094328
cycle= 13 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 1.76e-09  |ddm|= 1.79e-09
HOMO (B2u) = -0.391744538455928  LUMO (Ag) = -0.0968379228638535
cycle= 14 E= -75.3007673836276  delta_E= -8.53e-14  |g|= 1.47e-09  |ddm|= 9.69e-10
HOMO (B2u) = -0.391744538422684  LUMO (Ag) = -0.0968379228450548
cycle= 15 E= -75.3007673836275  delta_E= 8.53e-14  |g|= 1.27e-09  |ddm|= 8.88e-10
HOMO (B2u) = -0.391744538403576  LUMO (Ag) = -0.0968379228365828
cycle= 16 E= -75.3007673836275  delta_E=    0  |g|= 1.13e-09  |ddm|= 6.92e-10
HOMO (B2u) = -0.391744538389969  LUMO (Ag) = -0.0968379228223015
cycle= 17 E= -75.3007673836275  delta_E= 2.84e-14  |g|= 1e-09  |ddm|= 4.87e-10
HOMO (B2u) = -0.391744538229784  LUMO (Ag) = -0.0968379227084984
cycle= 18 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 4.4e-10  |ddm|= 2.45e-09
HOMO (B2u) = -0.391744538229724  LUMO (Ag) = -0.0968379227020047
cycle= 19 E= -75.3007673836276  delta_E= -2.84e-14  |g|= 3.6e-10  |ddm|= 3.48e-10
HOMO (B2u) = -0.391744538248144  LUMO (Ag) = -0.096837922715391
cycle= 20 E= -75.3007673836275  delta_E= 5.68e-14  |g|= 2.95e-10  |ddm|= 2.31e-10
HOMO (B2u) = -0.391744538259758  LUMO (Ag) = -0.096837922722271
cycle= 21 E= -75.3007673836276  delta_E= -5.68e-14  |g|= 2.47e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.391744538266565  LUMO (Ag) = -0.0968379227297814
cycle= 22 E= -75.3007673836277  delta_E= -5.68e-14  |g|= 2e-10  |ddm|= 1.37e-10
HOMO (B2u) = -0.391744538271813  LUMO (Ag) = -0.0968379227358239
cycle= 23 E= -75.3007673836276  delta_E= 8.53e-14  |g|= 1.62e-10  |ddm|= 1.17e-10
HOMO (B2u) = -0.391744538277758  LUMO (Ag) = -0.0968379227428176
cycle= 24 E= -75.3007673836275  delta_E= 5.68e-14  |g|= 1.28e-10  |ddm|= 1.16e-10
HOMO (B2u) = -0.391744538282623  LUMO (Ag) = -0.0968379227484745
cycle= 25 E= -75.3007673836276  delta_E= -8.53e-14  |g|= 9.73e-11  |ddm|= 1.01e-10
HOMO (B2u) = -0.391744538286829  LUMO (Ag) = -0.0968379227536582
cycle= 26 E= -75.3007673836276  delta_E= 4.26e-14  |g|= 7.05e-11  |ddm|= 9.21e-11
HOMO (B2u) = -0.391744538285507  LUMO (Ag) = -0.0968379227518117
cycle= 27 E= -75.3007673836276  delta_E= -1.42e-14  |g|= 5.82e-11  |ddm|= 3.07e-11
HOMO (B2u) = -0.391744538283875  LUMO (Ag) = -0.0968379227498969
cycle= 28 E= -75.3007673836275  delta_E= 9.95e-14  |g|= 4.78e-11  |ddm|= 2.3e-11
HOMO (B2u) = -0.391744538282652  LUMO (Ag) = -0.0968379227486394
cycle= 29 E= -75.3007673836272  delta_E= 2.7e-13  |g|= 3.89e-11  |ddm|= 1.85e-11
HOMO (B2u) = -0.391744538281657  LUMO (Ag) = -0.0968379227478246
cycle= 30 E= -75.3007673836269  delta_E= 2.56e-13  |g|= 3.12e-11  |ddm|= 1.47e-11
HOMO (B2u) = -0.391744538280955  LUMO (Ag) = -0.0968379227472789
cycle= 31 E= -75.3007673836268  delta_E= 1.85e-13  |g|= 2.52e-11  |ddm|= 1.12e-11
HOMO (B2u) = -0.391744538280476  LUMO (Ag) = -0.0968379227469292
cycle= 32 E= -75.3007673836263  delta_E= 4.69e-13  |g|= 2.05e-11  |ddm|= 8.39e-12
HOMO (B2u) = -0.391744538280158  LUMO (Ag) = -0.0968379227466704
cycle= 33 E= -75.3007673836257  delta_E= 6.11e-13  |g|= 1.85e-11  |ddm|= 6.06e-12
HOMO (B2u) = -0.391744538279969  LUMO (Ag) = -0.0968379227464918
cycle= 34 E= -75.3007673836253  delta_E= 3.55e-13  |g|= 1.54e-11  |ddm|= 6.85e-12
HOMO (B2u) = -0.391744538279892  LUMO (Ag) = -0.0968379227463644
cycle= 35 E= -75.3007673836249  delta_E= 4.26e-13  |g|= 1.35e-11  |ddm|= 6.69e-12
HOMO (B2u) = -0.391744538279766  LUMO (Ag) = -0.0968379227462088
cycle= 36 E= -75.3007673836245  delta_E= 3.84e-13  |g|= 1.2e-11  |ddm|= 6.62e-12
HOMO (B2u) = -0.391744538279599  LUMO (Ag) = -0.0968379227460201
cycle= 37 E= -75.3007673836241  delta_E= 3.69e-13  |g|= 1.04e-11  |ddm|= 7.09e-12
HOMO (B2u) = -0.391744538279409  LUMO (Ag) = -0.0968379227458095
cycle= 38 E= -75.3007673836238  delta_E= 3.84e-13  |g|= 8.93e-12  |ddm|= 6.8e-12
HOMO (B2u) = -0.391744538279207  LUMO (Ag) = -0.096837922745585
cycle= 39 E= -75.3007673836234  delta_E= 3.27e-13  |g|= 7.6e-12  |ddm|= 5.88e-12
HOMO (B2u) = -0.391744538279  LUMO (Ag) = -0.0968379227453607
cycle= 40 E= -75.3007673836231  delta_E= 3.55e-13  |g|= 6.39e-12  |ddm|= 4.96e-12
HOMO (B2u) = -0.391744538278798  LUMO (Ag) = -0.0968379227451391
cycle= 41 E= -75.3007673836224  delta_E= 6.68e-13  |g|= 5.8e-12  |ddm|= 3.61e-12
HOMO (B2u) = -0.391744538278604  LUMO (Ag) = -0.0968379227449224
cycle= 42 E= -75.3007673836216  delta_E= 7.82e-13  |g|= 8.07e-12  |ddm|= 1.61e-12
HOMO (B2u) = -0.391744538278388  LUMO (Ag) = -0.0968379227446921
cycle= 43 E= -75.3007673836215  delta_E= 1.42e-13  |g|= 7.38e-12  |ddm|= 6.41e-12
HOMO (B2u) = -0.391744538278193  LUMO (Ag) = -0.0968379227444821
cycle= 44 E= -75.3007673836214  delta_E= 9.95e-14  |g|= 6.54e-12  |ddm|= 6.89e-12
HOMO (B2u) = -0.391744538278021  LUMO (Ag) = -0.0968379227443036
cycle= 45 E= -75.3007673836215  delta_E= -7.11e-14  |g|= 5.9e-12  |ddm|= 6.76e-12
HOMO (B2u) = -0.391744538277869  LUMO (Ag) = -0.0968379227441481
cycle= 46 E= -75.3007673836214  delta_E= 2.84e-14  |g|= 5.35e-12  |ddm|= 6.74e-12
HOMO (B2u) = -0.391744538277734  LUMO (Ag) = -0.096837922744002
cycle= 47 E= -75.3007673836213  delta_E= 9.95e-14  |g|= 4.8e-12  |ddm|= 6.86e-12
HOMO (B2u) = -0.391744538277616  LUMO (Ag) = -0.0968379227438623
cycle= 48 E= -75.3007673836214  delta_E= -9.95e-14  |g|= 3.82e-12  |ddm|= 7.39e-12
HOMO (B2u) = -0.391744538277513  LUMO (Ag) = -0.0968379227437329
cycle= 49 E= -75.3007673836216  delta_E= -1.28e-13  |g|= 3.09e-12  |ddm|= 7.73e-12
HOMO (B2u) = -0.39174453827743  LUMO (Ag) = -0.0968379227436173
cycle= 50 E= -75.3007673836217  delta_E= -9.95e-14  |g|= 2.44e-12  |ddm|= 7.38e-12
SCF not converged.
SCF energy = -75.3007673836217

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpaes606me
max_memory 4000 MB (current use 5093 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4927493145099  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5138643258636  dE = -0.021115011  S^2 = 0.0000000
               |grad[o]|=0.147  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.525909851245  dE = -0.012045525  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|=0.0671  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5340594672549  dE = -0.008149616  S^2 = 0.0000000
               |grad[o]|=0.0918  |ddm|=0.0329  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5399122654748  dE = -0.0058527982  S^2 = 0.0000000
               |grad[o]|=0.072  |ddm|=0.0206  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5440647795848  dE = -0.0041525141  S^2 = 0.0000000
               |grad[o]|=0.0544  |ddm|=0.0139  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5467989029076  dE = -0.0027341233  S^2 = 0.0000000
               |grad[o]|=0.0384  |ddm|=0.00993  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5482781760594  dE = -0.0014792732  S^2 = 0.0000000
               |grad[o]|=0.0236  |ddm|=0.00842  |maxRot[o]|=0.0799
macro iter 8 (5 JK  0 micro), CASSCF E = -75.5486404532945  dE = -0.00036227724  S^2 = 0.0000000
               |grad[o]|=0.00986  |ddm|=0.00939  |maxRot[o]|= 0.06
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5486450982924  dE = -4.6449979e-06  S^2 = 0.0000000
               |grad[o]|=0.00123  |ddm|=0.00881  |maxRot[o]|=0.00593
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5486452002597  dE = -1.0196725e-07  S^2 = 0.0000000
               |grad[o]|=0.000207  |ddm|=0.00137  |maxRot[o]|=0.000619
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5486452022816  dE = -2.0219346e-09  S^2 = 0.0000000
               |grad[o]|=3.39e-05  |ddm|=0.000185  |maxRot[o]|=8.81e-05
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5486452023544  dE = -7.281642e-11  S^2 = 0.0000000
               |grad[o]|=6.7e-06  |ddm|=2.89e-05  |maxRot[o]|=1.69e-05
2-step CASSCF converged in 12 macro (60 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97338743 1.72966225 1.77895395 1.77895251 0.28849482 0.21301937
 0.21301918 0.0245105 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00731   0.00385   0.00000   0.00000  -0.00077
  0 C 2s       0.63288   0.60630   0.00000  -0.00000  -0.31355
  0 C 3s      -0.02435   0.00955  -0.00000  -0.00000   0.02103
  0 C 2px      0.00000  -0.00000  -0.00000   0.70643  -0.00000
  0 C 2py     -0.00000   0.00000   0.70643   0.00000  -0.00000
  0 C 2pz      0.31214  -0.36370  -0.00000  -0.00000   0.63146
  0 C 3px      0.00000  -0.00000  -0.00000   0.02283  -0.00000
  0 C 3py      0.00000  -0.00000   0.02283   0.00000  -0.00000
  0 C 3pz     -0.02602  -0.00192  -0.00000  -0.00000  -0.03894
  0 C 3dxy     0.00000   0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.02081   0.00000  -0.00000
  0 C 3dz^2    0.02662  -0.00320  -0.00000  -0.00000   0.03135
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.02081  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000   0.00000   0.00000  -0.00000
  1 C 1s       0.00731  -0.00385   0.00000   0.00000  -0.00077
  1 C 2s       0.63288  -0.60630   0.00000   0.00000  -0.31355
  1 C 3s      -0.02435  -0.00955   0.00000   0.00000   0.02103
  1 C 2px     -0.00000   0.00000   0.00000   0.70643   0.00000
  1 C 2py      0.00000   0.00000   0.70643  -0.00000   0.00000
  1 C 2pz     -0.31214  -0.36370   0.00000   0.00000  -0.63146
  1 C 3px     -0.00000   0.00000   0.00000   0.02283   0.00000
  1 C 3py      0.00000  -0.00000   0.02283  -0.00000   0.00000
  1 C 3pz      0.02602  -0.00192  -0.00000  -0.00000   0.03894
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.02081   0.00000  -0.00000
  1 C 3dz^2    0.02662   0.00320   0.00000   0.00000   0.03135
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.02081  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s       0.00000   0.00000   0.36324
  0 C 3s      -0.00000   0.00000  -0.04244
  0 C 2px      0.70668   0.00000  -0.00000
  0 C 2py     -0.00000   0.70668  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.60447
  0 C 3px     -0.01294  -0.00000   0.00000
  0 C 3py      0.00000  -0.01294   0.00000
  0 C 3pz     -0.00000   0.00000   0.02137
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00000  -0.02104   0.00000
  0 C 3dz^2   -0.00000   0.00000  -0.02031
  0 C 3dxz    -0.02104  -0.00000   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000  -0.00000  -0.36324
  1 C 3s       0.00000  -0.00000   0.04244
  1 C 2px     -0.70668   0.00000  -0.00000
  1 C 2py     -0.00000  -0.70668  -0.00000
  1 C 2pz      0.00000   0.00000   0.60447
  1 C 3px      0.01294  -0.00000   0.00000
  1 C 3py      0.00000   0.01294  -0.00000
  1 C 3pz     -0.00000   0.00000   0.02137
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.02104   0.00000
  1 C 3dz^2    0.00000  -0.00000   0.02031
  1 C 3dxz    -0.02104   0.00000  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99111459
<CAS-nat-orb|mo-hf>  4  4    0.99735748
<CAS-nat-orb|mo-hf>  5  5    0.99934483
<CAS-nat-orb|mo-hf>  6  6    0.99934482
<CAS-nat-orb|mo-hf>  7  7    0.97351395
<CAS-nat-orb|mo-hf>  8  8    0.97438519
<CAS-nat-orb|mo-hf>  9  9    0.97438516
<CAS-nat-orb|mo-hf>  10  10    0.76990714
<CAS-nat-orb|mo-hf>  10  14   -0.57655981
CASSCF energy = -75.5486452023544
CASCI E = -75.5486452023544  E(CI) = -16.163032880256  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.006
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.012

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.064
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8633 T =      0.014
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.016
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.016
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.120
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.10
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.08
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.320 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.197 | Tfpread = 0.000 | Tfpwrite = 0.193 | data = 74.1 MB | cpsd = 55.9 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.863 | E =     -75.5970182702 | DW = 3.21e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.621 | E =     -75.6553454048 | DE = -5.83e-02 | DW = 1.29e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.532 | E =     -75.6574737682 | DE = -2.13e-03 | DW = 2.31e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.416 | E =     -75.6586102507 | DE = -1.14e-03 | DW = 1.75e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.254 | E =     -75.6591071725 | DE = -4.97e-04 | DW = 2.37e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.150 | E =     -75.6592978016 | DE = -1.91e-04 | DW = 1.65e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.936 | E =     -75.6593502815 | DE = -5.25e-05 | DW = 2.36e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.864 | E =     -75.6594014511 | DE = -5.12e-05 | DW = 1.65e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     11.298 | E =     -75.6611411060 | DE = -1.74e-03 | DW = 2.26e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.084 | E =     -75.6615870029 | DE = -4.46e-04 | DW = 3.63e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     18.758 | E =     -75.6617459902 | DE = -1.59e-04 | DW = 5.52e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     22.701 | E =     -75.6617661517 | DE = -2.02e-05 | DW = 4.03e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.686 | E =     -75.6617711171 | DE = -4.97e-06 | DW = 5.57e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.548 | E =     -75.6617732423 | DE = -2.13e-06 | DW = 4.06e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.016 | E =     -75.6617767126 | DE = -3.47e-06 | DW = 5.59e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     37.970 | E =     -75.6617777556 | DE = -1.04e-06 | DW = 4.07e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     46.953 | E =     -75.6619817932 | DE = -2.04e-04 | DW = 3.48e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     61.646 | E =     -75.6620213339 | DE = -3.95e-05 | DW = 2.04e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     75.559 | E =     -75.6620300089 | DE = -8.68e-06 | DW = 5.23e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.503 | E =     -75.6620302450 | DE = -2.36e-07 | DW = 2.06e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    101.111 | E =     -75.6620314835 | DE = -1.24e-06 | DW = 5.21e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    111.817 | E =     -75.6620314935 | DE = -1.00e-08 | DW = 2.05e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    126.125 | E =     -75.6620325411 | DE = -1.05e-06 | DW = 5.20e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    146.213 | E =     -75.6620325453 | DE = -4.20e-09 | DW = 2.06e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    167.272 | E =     -75.6620476343 | DE = -1.51e-05 | DW = 3.19e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    198.746 | E =     -75.6620497950 | DE = -2.16e-06 | DW = 1.53e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    227.922 | E =     -75.6620506801 | DE = -8.85e-07 | DW = 3.47e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    261.729 | E =     -75.6620508183 | DE = -1.38e-07 | DW = 1.53e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    293.933 | E =     -75.6620511274 | DE = -3.09e-07 | DW = 3.47e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    321.812 | E =     -75.6620509860 | DE = 1.41e-07 | DW = 1.57e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    350.165 | E =     -75.6620511572 | DE = -1.71e-07 | DW = 2.97e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    379.367 | E =     -75.6620515386 | DE = -3.81e-07 | DW = 1.58e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    460.828 | E =     -75.6620560986 | DE = -4.56e-06 | DW = 7.69e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    526.598 | E =     -75.6620560986 | DE = -1.17e-11 | DW = 7.69e-08

E(MRCI) = -75.66205609861613  E_corr = -0.1134108962617262
Time cost =    573.771
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:44:30 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.613990493306 AA    0.000000000000   0.000000000000   3.050000000000 Bohr   0.0

nuclear repulsion = 11.8032786885246
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.525]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    197958.22


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp1vjs74oa
max_memory 4000 MB (current use 5090 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9606241516019

WARN: Singularity detected in overlap matrix (condition number =  203). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.154846704479715  LUMO (Ag) = -0.154379304561516

WARN: Ag LUMO -0.154379304561516 < system HOMO -0.154846704479715


WARN: B2u HOMO -0.154846704479715 > system LUMO -0.154379304561516


WARN: B3u HOMO -0.154846704479715 > system LUMO -0.154379304561516

cycle= 1 E= -75.2674224197194  delta_E= -0.307  |g|= 0.242  |ddm|= 1.42
HOMO (B2u) = -0.423431408188682  LUMO (Ag) = -0.147745494594373
cycle= 2 E= -75.2901719236938  delta_E= -0.0227  |g|= 0.0499  |ddm|= 0.326
HOMO (B3u) = -0.385318413495461  LUMO (Ag) = -0.0975529483033129
cycle= 3 E= -75.2912021417109  delta_E= -0.00103  |g|= 0.0132  |ddm|= 0.0546
HOMO (B3u) = -0.387177687087389  LUMO (Ag) = -0.094695040835718
cycle= 4 E= -75.291314408399  delta_E= -0.000112  |g|= 0.00225  |ddm|= 0.0161
HOMO (B2u) = -0.38789931105226  LUMO (Ag) = -0.0952945928883295
cycle= 5 E= -75.2913182764059  delta_E= -3.87e-06  |g|= 0.000326  |ddm|= 0.00311
HOMO (B2u) = -0.387835444387876  LUMO (Ag) = -0.0952466102829228
cycle= 6 E= -75.2913183380417  delta_E= -6.16e-08  |g|= 4.01e-05  |ddm|= 0.000644
HOMO (B3u) = -0.387827943274185  LUMO (Ag) = -0.0952344140423403
cycle= 7 E= -75.2913183390841  delta_E= -1.04e-09  |g|= 5.01e-06  |ddm|= 0.000118
HOMO (B3u) = -0.387827276401285  LUMO (Ag) = -0.0952333329362683
cycle= 8 E= -75.2913183390995  delta_E= -1.54e-11  |g|= 5.51e-07  |ddm|= 1.99e-05
HOMO (B3u) = -0.387827240724852  LUMO (Ag) = -0.0952331169888421
cycle= 9 E= -75.2913183390998  delta_E= -2.84e-13  |g|= 2.29e-08  |ddm|= 1.04e-06
HOMO (B3u) = -0.387827233118365  LUMO (Ag) = -0.0952331317889691
cycle= 10 E= -75.2913183390997  delta_E= 1.42e-13  |g|= 3.63e-09  |ddm|= 8.55e-08
HOMO (B3u) = -0.387827234291161  LUMO (Ag) = -0.0952331330214446
cycle= 11 E= -75.2913183390998  delta_E= -1.14e-13  |g|= 2.64e-09  |ddm|= 5.05e-09
HOMO (B3u) = -0.387827234014556  LUMO (Ag) = -0.0952331326637951
cycle= 12 E= -75.2913183390998  delta_E= 2.84e-14  |g|= 2.05e-09  |ddm|= 2.41e-09
HOMO (B3u) = -0.387827234012783  LUMO (Ag) = -0.0952331324868721
cycle= 13 E= -75.2913183390997  delta_E= 2.84e-14  |g|= 1.85e-09  |ddm|= 1.69e-09
HOMO (B3u) = -0.387827233970933  LUMO (Ag) = -0.0952331324569901
cycle= 14 E= -75.2913183390999  delta_E= -1.14e-13  |g|= 1.55e-09  |ddm|= 1.03e-09
HOMO (B3u) = -0.387827233948759  LUMO (Ag) = -0.0952331324596939
cycle= 15 E= -75.2913183390998  delta_E= 8.53e-14  |g|= 1.35e-09  |ddm|= 1.05e-09
HOMO (B3u) = -0.387827233907028  LUMO (Ag) = -0.0952331324190733
cycle= 16 E= -75.2913183390997  delta_E= 7.11e-14  |g|= 1.21e-09  |ddm|= 4.04e-10
HOMO (B3u) = -0.387827233900505  LUMO (Ag) = -0.0952331324084415
cycle= 17 E= -75.2913183390999  delta_E= -1.71e-13  |g|= 1.05e-09  |ddm|= 5.32e-10
HOMO (B3u) = -0.387827233741219  LUMO (Ag) = -0.0952331323123501
cycle= 18 E= -75.2913183390997  delta_E= 1.99e-13  |g|= 4.6e-10  |ddm|= 2.57e-09
HOMO (B3u) = -0.387827233740552  LUMO (Ag) = -0.0952331323055832
cycle= 19 E= -75.2913183390997  delta_E= -1.42e-14  |g|= 3.76e-10  |ddm|= 3.58e-10
HOMO (B3u) = -0.38782723375858  LUMO (Ag) = -0.0952331323190907
cycle= 20 E= -75.2913183390998  delta_E= -1.42e-13  |g|= 3.11e-10  |ddm|= 2.31e-10
HOMO (B3u) = -0.387827233770308  LUMO (Ag) = -0.0952331323260128
cycle= 21 E= -75.2913183390998  delta_E= 5.68e-14  |g|= 2.64e-10  |ddm|= 1.74e-10
HOMO (B3u) = -0.387827233776462  LUMO (Ag) = -0.0952331323338169
cycle= 22 E= -75.2913183390998  delta_E= -5.68e-14  |g|= 2.14e-10  |ddm|= 1.42e-10
HOMO (B3u) = -0.387827233781413  LUMO (Ag) = -0.0952331323401955
cycle= 23 E= -75.2913183390997  delta_E= 1.71e-13  |g|= 1.74e-10  |ddm|= 1.2e-10
HOMO (B3u) = -0.387827233787543  LUMO (Ag) = -0.0952331323477051
cycle= 24 E= -75.2913183390997  delta_E= -5.68e-14  |g|= 1.37e-10  |ddm|= 1.15e-10
HOMO (B3u) = -0.387827233792202  LUMO (Ag) = -0.095233132353878
cycle= 25 E= -75.2913183390997  delta_E= -2.84e-14  |g|= 1.04e-10  |ddm|= 1.07e-10
HOMO (B3u) = -0.387827233796529  LUMO (Ag) = -0.0952331323601019
cycle= 26 E= -75.2913183390998  delta_E= -2.84e-14  |g|= 7.55e-11  |ddm|= 9.84e-11
HOMO (B3u) = -0.387827233795252  LUMO (Ag) = -0.0952331323584802
cycle= 27 E= -75.2913183390998  delta_E=    0  |g|= 6.25e-11  |ddm|= 3.22e-11
HOMO (B3u) = -0.387827233789686  LUMO (Ag) = -0.0952331323541201
Extra cycle  E= -75.2913183390998  delta_E= 1.42e-14  |g|= 1.98e-11  |ddm|= 8.89e-11
converged SCF energy = -75.2913183390998

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp1vjs74oa
max_memory 4000 MB (current use 5090 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u B2u B3u Ag B2g B3g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4857258490142  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.5064440237567  dE = -0.020718175  S^2 = 0.0000000
               |grad[o]|=0.146  |ddm|= 3.68  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.5184205876037  dE = -0.011976564  S^2 = 0.0000000
               |grad[o]|=0.115  |ddm|=0.0655  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5265374833885  dE = -0.0081168958  S^2 = 0.0000000
               |grad[o]|=0.0908  |ddm|=0.0339  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5322901948719  dE = -0.0057527115  S^2 = 0.0000000
               |grad[o]|=0.0705  |ddm|=0.0223  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5362645665317  dE = -0.0039743717  S^2 = 0.0000000
               |grad[o]|=0.0523  |ddm|=0.0155  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5387474751851  dE = -0.0024829087  S^2 = 0.0000000
               |grad[o]|=0.0357  |ddm|=0.0116  |maxRot[o]|=0.0799
macro iter 7 (6 JK  0 micro), CASSCF E = -75.5399094469675  dE = -0.0011619718  S^2 = 0.0000000
               |grad[o]|=0.0201  |ddm|=0.0105  |maxRot[o]|=0.0799
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5400388139254  dE = -0.00012936696  S^2 = 0.0000000
               |grad[o]|=0.00582  |ddm|=0.0121  |maxRot[o]|=0.0344
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5400404965121  dE = -1.6825867e-06  S^2 = 0.0000000
               |grad[o]|=0.000811  |ddm|=0.00672  |maxRot[o]|=0.00294
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5400405390173  dE = -4.250515e-08  S^2 = 0.0000000
               |grad[o]|=0.000141  |ddm|=0.00102  |maxRot[o]|=0.000305
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5400405400779  dE = -1.0605561e-09  S^2 = 0.0000000
               |grad[o]|=2.6e-05  |ddm|=0.000166  |maxRot[o]|=3.3e-05
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5400405401189  dE = -4.1012527e-11  S^2 = 0.0000000
               |grad[o]|=6.26e-06  |ddm|=3.01e-05  |maxRot[o]|=7.95e-06
macro iter 13 (3 JK  0 micro), CASSCF E = -75.54004054013  dE = -1.1084467e-11  S^2 = 0.0000000
               |grad[o]|=1.33e-06  |ddm|=6.81e-06  |maxRot[o]|=1.49e-06
2-step CASSCF converged in 13 macro (62 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97266798 1.73807552 1.76672213 1.76671796 0.28541775 0.22250966
 0.22250996 0.02537904]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00752   0.00393   0.00000   0.00000  -0.00075
  0 C 2s       0.63584   0.61195  -0.00000  -0.00000  -0.30764
  0 C 3s      -0.02245   0.00972   0.00000   0.00000   0.02272
  0 C 2px     -0.00000   0.00000  -0.00000   0.70640   0.00000
  0 C 2py     -0.00000   0.00000   0.70640  -0.00000   0.00000
  0 C 2pz      0.30639  -0.35411   0.00000   0.00000   0.63428
  0 C 3px     -0.00000  -0.00000  -0.00000   0.02449   0.00000
  0 C 3py     -0.00000   0.00000   0.02449  -0.00000   0.00000
  0 C 3pz     -0.02442  -0.00191   0.00000   0.00000  -0.03747
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.01996  -0.00000   0.00000
  0 C 3dz^2    0.02599  -0.00343   0.00000   0.00000   0.03354
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.01996   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00752  -0.00393   0.00000   0.00000  -0.00075
  1 C 2s       0.63584  -0.61195  -0.00000  -0.00000  -0.30764
  1 C 3s      -0.02245  -0.00972  -0.00000  -0.00000   0.02272
  1 C 2px     -0.00000   0.00000   0.00000   0.70640  -0.00000
  1 C 2py      0.00000  -0.00000   0.70640   0.00000   0.00000
  1 C 2pz     -0.30639  -0.35411  -0.00000   0.00000  -0.63428
  1 C 3px      0.00000  -0.00000   0.00000   0.02449  -0.00000
  1 C 3py      0.00000  -0.00000   0.02449   0.00000  -0.00000
  1 C 3pz      0.02442  -0.00191   0.00000   0.00000   0.03747
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000  -0.01996  -0.00000   0.00000
  1 C 3dz^2    0.02599   0.00343  -0.00000  -0.00000   0.03354
  1 C 3dxz    -0.00000   0.00000  -0.00000  -0.01996   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.35370
  0 C 3s       0.00000   0.00000  -0.04177
  0 C 2px      0.70670  -0.00000   0.00000
  0 C 2py     -0.00000   0.70670  -0.00000
  0 C 2pz      0.00000  -0.00000   0.61017
  0 C 3px     -0.01201   0.00000   0.00000
  0 C 3py      0.00000  -0.01201  -0.00000
  0 C 3pz      0.00000   0.00000   0.02109
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.02067  -0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01998
  0 C 3dxz    -0.02067   0.00000   0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s      -0.00000  -0.00000  -0.35370
  1 C 3s      -0.00000  -0.00000   0.04177
  1 C 2px     -0.70670  -0.00000  -0.00000
  1 C 2py     -0.00000  -0.70670   0.00000
  1 C 2pz      0.00000  -0.00000   0.61017
  1 C 3px      0.01201   0.00000  -0.00000
  1 C 3py      0.00000   0.01201   0.00000
  1 C 3pz      0.00000   0.00000   0.02109
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000  -0.02067  -0.00000
  1 C 3dz^2   -0.00000   0.00000   0.01998
  1 C 3dxz    -0.02067  -0.00000   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99096825
<CAS-nat-orb|mo-hf>  4  4    0.99730116
<CAS-nat-orb|mo-hf>  5  5    0.99929410
<CAS-nat-orb|mo-hf>  6  6    0.99929409
<CAS-nat-orb|mo-hf>  7  7    0.97345976
<CAS-nat-orb|mo-hf>  8  8    0.97595048
<CAS-nat-orb|mo-hf>  9  9    0.97595045
<CAS-nat-orb|mo-hf>  10  10    0.79085111
<CAS-nat-orb|mo-hf>  10  14   -0.55412106
CASSCF energy = -75.54004054013
CASCI E = -75.54004054013  E(CI) = -16.0670214627745  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.030
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.040
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.040
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.040
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.336
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.063
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.622

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.055
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.013
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.011
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.013
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.101
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.09
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.05
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 73.8 MB Rmem = 5.62 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 50.0 MB Rmem = 4.45 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.255 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.166 | Tfpread = 0.000 | Tfpwrite = 0.164 | data = 74.1 MB | cpsd = 55.9 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.360 | E =     -75.5905064594 | DW = 3.41e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.459 | E =     -75.6480899567 | DE = -5.76e-02 | DW = 1.22e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.729 | E =     -75.6494137420 | DE = -1.32e-03 | DW = 2.37e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.587 | E =     -75.6504070373 | DE = -9.93e-04 | DW = 1.58e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.514 | E =     -75.6504859359 | DE = -7.89e-05 | DW = 2.39e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.323 | E =     -75.6506102304 | DE = -1.24e-04 | DW = 1.62e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.285 | E =     -75.6506744261 | DE = -6.42e-05 | DW = 2.39e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     23.586 | E =     -75.6507523914 | DE = -7.80e-05 | DW = 1.62e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     28.693 | E =     -75.6533596621 | DE = -2.61e-03 | DW = 2.07e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.343 | E =     -75.6539688971 | DE = -6.09e-04 | DW = 3.39e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.437 | E =     -75.6542258730 | DE = -2.57e-04 | DW = 5.67e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     45.089 | E =     -75.6542647718 | DE = -3.89e-05 | DW = 4.07e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     50.268 | E =     -75.6543345036 | DE = -6.97e-05 | DW = 5.80e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.288 | E =     -75.6543393830 | DE = -4.88e-06 | DW = 4.15e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     60.182 | E =     -75.6543520174 | DE = -1.26e-05 | DW = 5.81e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     64.920 | E =     -75.6543539389 | DE = -1.92e-06 | DW = 4.15e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     73.746 | E =     -75.6545785939 | DE = -2.25e-04 | DW = 3.61e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     86.542 | E =     -75.6546237377 | DE = -4.51e-05 | DW = 2.22e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     97.911 | E =     -75.6546370442 | DE = -1.33e-05 | DW = 5.63e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    109.395 | E =     -75.6546384546 | DE = -1.41e-06 | DW = 2.17e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.500 | E =     -75.6546444456 | DE = -5.99e-06 | DW = 5.61e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    133.729 | E =     -75.6546457089 | DE = -1.26e-06 | DW = 2.17e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    145.546 | E =     -75.6546511393 | DE = -5.43e-06 | DW = 5.61e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    157.510 | E =     -75.6546522133 | DE = -1.07e-06 | DW = 2.17e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    183.595 | E =     -75.6547363723 | DE = -8.42e-05 | DW = 3.35e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    211.790 | E =     -75.6547390748 | DE = -2.70e-06 | DW = 1.60e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    239.439 | E =     -75.6547399615 | DE = -8.87e-07 | DW = 3.58e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    269.217 | E =     -75.6547400700 | DE = -1.08e-07 | DW = 1.59e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    297.876 | E =     -75.6547402884 | DE = -2.18e-07 | DW = 3.57e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    329.397 | E =     -75.6547403887 | DE = -1.00e-07 | DW = 1.58e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    359.048 | E =     -75.6547405792 | DE = -1.90e-07 | DW = 3.57e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    386.800 | E =     -75.6547406729 | DE = -9.37e-08 | DW = 1.57e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    468.834 | E =     -75.6547465697 | DE = -5.90e-06 | DW = 7.97e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    526.562 | E =     -75.6547465697 | DE = -6.66e-11 | DW = 7.96e-08

E(MRCI) = -75.65474656971989  E_corr = -0.1147060295899394
Time cost =    901.431
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 18:59:32 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.640449353852 AA    0.000000000000   0.000000000000   3.100000000000 Bohr   0.0

nuclear repulsion = 11.6129032258065
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.55]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    208012.13


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmptiqzwe9i
max_memory 4000 MB (current use 5086 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9340105731017

WARN: Singularity detected in overlap matrix (condition number =  188). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.149693266404789  LUMO (B3u) = -0.149693266404789

WARN: B2u HOMO -0.149693266404789 > system LUMO -0.149693266404789

cycle= 1 E= -75.3573845713054  delta_E= -0.423  |g|= 0.265  |ddm|= 1.55
HOMO (B2u) = -0.413310367291846  LUMO (B3u) = -0.0846696262312553
cycle= 2 E= -75.3843760014416  delta_E= -0.027  |g|= 0.0539  |ddm|= 0.354
HOMO (B2u) = -0.373182146511252  LUMO (B3u) = -0.0395668514335568
cycle= 3 E= -75.3858456567449  delta_E= -0.00147  |g|= 0.018  |ddm|= 0.0717
HOMO (B2u) = -0.377721327859491  LUMO (B3u) = -0.0440841679310619
cycle= 4 E= -75.3860530258635  delta_E= -0.000207  |g|= 0.000721  |ddm|= 0.0382
HOMO (B2u) = -0.377699771169469  LUMO (B3u) = -0.0442008432276683
cycle= 5 E= -75.3860532373451  delta_E= -2.11e-07  |g|= 8.07e-05  |ddm|= 0.00144
HOMO (B2u) = -0.377674560909568  LUMO (B3u) = -0.0441740446286822
cycle= 6 E= -75.3860532409994  delta_E= -3.65e-09  |g|= 1.32e-05  |ddm|= 0.000134
HOMO (B2u) = -0.377672848926058  LUMO (B3u) = -0.0441758015090624
cycle= 7 E= -75.3860532411127  delta_E= -1.13e-10  |g|= 1.86e-06  |ddm|= 3.43e-05
HOMO (B2u) = -0.377672100443066  LUMO (B3u) = -0.0441752784119647
cycle= 8 E= -75.3860532411149  delta_E= -2.2e-12  |g|= 1.02e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.377672134542525  LUMO (B3u) = -0.0441753126347232
cycle= 9 E= -75.3860532411149  delta_E= -5.68e-14  |g|= 9.15e-09  |ddm|= 2.08e-07
HOMO (B2u) = -0.377672135428699  LUMO (B3u) = -0.0441753150892547
cycle= 10 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 5.28e-09  |ddm|= 8.76e-09
HOMO (B2u) = -0.377672135485103  LUMO (B3u) = -0.0441753151245478
cycle= 11 E= -75.3860532411149  delta_E=    0  |g|= 4.99e-09  |ddm|= 4.29e-09
HOMO (B2u) = -0.377672134122641  LUMO (B3u) = -0.0441753136925206
cycle= 12 E= -75.3860532411148  delta_E= 8.53e-14  |g|= 4.61e-09  |ddm|= 2.33e-09
HOMO (B2u) = -0.377672133903664  LUMO (B3u) = -0.0441753133840757
cycle= 13 E= -75.3860532411148  delta_E= 2.84e-14  |g|= 8.94e-10  |ddm|= 7.69e-09
HOMO (B2u) = -0.377672133973399  LUMO (B3u) = -0.0441753134346
cycle= 14 E= -75.3860532411149  delta_E= -8.53e-14  |g|= 7.9e-10  |ddm|= 4.35e-10
HOMO (B2u) = -0.377672134141507  LUMO (B3u) = -0.0441753135504147
cycle= 15 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 6.66e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.377672134097406  LUMO (B3u) = -0.0441753135970835
cycle= 16 E= -75.3860532411148  delta_E= 1.42e-14  |g|= 7.82e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.377672134148783  LUMO (B3u) = -0.0441753136135237
cycle= 17 E= -75.3860532411149  delta_E= -9.95e-14  |g|= 8.39e-10  |ddm|= 6.59e-10
HOMO (B2u) = -0.37767213416224  LUMO (B3u) = -0.0441753136099321
cycle= 18 E= -75.3860532411149  delta_E= 8.53e-14  |g|= 5.71e-10  |ddm|= 5.55e-10
HOMO (B2u) = -0.377672134187563  LUMO (B3u) = -0.0441753136340424
cycle= 19 E= -75.386053241115  delta_E= -1.14e-13  |g|= 4.44e-10  |ddm|= 3.3e-10
HOMO (B2u) = -0.377672134218925  LUMO (B3u) = -0.0441753136628927
cycle= 20 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 3.14e-10  |ddm|= 2.63e-10
HOMO (B2u) = -0.377672134234335  LUMO (B3u) = -0.0441753136725864
cycle= 21 E= -75.3860532411148  delta_E= 1.42e-13  |g|= 1.86e-10  |ddm|= 2.78e-10
HOMO (B2u) = -0.377672134234366  LUMO (B3u) = -0.0441753136702858
cycle= 22 E= -75.3860532411149  delta_E= -1.42e-13  |g|= 1.62e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.377672134234205  LUMO (B3u) = -0.0441753136686047
cycle= 23 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 1.43e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.377672134231527  LUMO (B3u) = -0.044175313666878
cycle= 24 E= -75.3860532411149  delta_E= 1.42e-14  |g|= 1.3e-10  |ddm|= 5.92e-11
HOMO (B2u) = -0.377672134234441  LUMO (B3u) = -0.044175313667038
cycle= 25 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 1.06e-10  |ddm|= 6.65e-11
HOMO (B2u) = -0.377672134236894  LUMO (B3u) = -0.0441753136680629
cycle= 26 E= -75.3860532411149  delta_E= 4.26e-14  |g|= 7.85e-11  |ddm|= 6.23e-11
HOMO (B2u) = -0.37767213423819  LUMO (B3u) = -0.0441753136685394
cycle= 27 E= -75.3860532411149  delta_E= -4.26e-14  |g|= 6.04e-11  |ddm|= 4.28e-11
HOMO (B2u) = -0.377672134239311  LUMO (B3u) = -0.0441753136688978
cycle= 28 E= -75.386053241115  delta_E= -8.53e-14  |g|= 4.57e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.377672134240372  LUMO (B3u) = -0.0441753136693607
cycle= 29 E= -75.386053241115  delta_E= 5.68e-14  |g|= 3.53e-11  |ddm|= 2.49e-11
HOMO (B2u) = -0.377672134241077  LUMO (B3u) = -0.0441753136697285
cycle= 30 E= -75.3860532411149  delta_E= 2.84e-14  |g|= 2.96e-11  |ddm|= 1.52e-11
HOMO (B2u) = -0.377672134241626  LUMO (B3u) = -0.044175313670002
cycle= 31 E= -75.386053241115  delta_E= -2.84e-14  |g|= 2.44e-11  |ddm|= 1.32e-11
HOMO (B2u) = -0.377672134242058  LUMO (B3u) = -0.0441753136701948
cycle= 32 E= -75.3860532411149  delta_E= 5.68e-14  |g|= 1.98e-11  |ddm|= 1.16e-11
HOMO (B2u) = -0.37767213424253  LUMO (B3u) = -0.0441753136703631
cycle= 33 E= -75.3860532411148  delta_E= 8.53e-14  |g|= 1.54e-11  |ddm|= 1.05e-11
HOMO (B2u) = -0.377672134242864  LUMO (B3u) = -0.0441753136704918
cycle= 34 E= -75.3860532411146  delta_E= 1.99e-13  |g|= 1.17e-11  |ddm|= 8.56e-12
HOMO (B2u) = -0.377672134243104  LUMO (B3u) = -0.0441753136705743
cycle= 35 E= -75.3860532411145  delta_E= 8.53e-14  |g|= 9.08e-12  |ddm|= 6.39e-12
HOMO (B2u) = -0.377672134243286  LUMO (B3u) = -0.0441753136706219
cycle= 36 E= -75.3860532411144  delta_E= 1.14e-13  |g|= 7.08e-12  |ddm|= 5.11e-12
HOMO (B2u) = -0.377672134243424  LUMO (B3u) = -0.0441753136706502
cycle= 37 E= -75.3860532411142  delta_E= 2.27e-13  |g|= 6.12e-12  |ddm|= 3.56e-12
HOMO (B2u) = -0.377672134243519  LUMO (B3u) = -0.0441753136706549
cycle= 38 E= -75.3860532411137  delta_E= 4.83e-13  |g|= 6.07e-12  |ddm|= 2.46e-12
HOMO (B2u) = -0.377672134243569  LUMO (B3u) = -0.0441753136706251
cycle= 39 E= -75.3860532411133  delta_E= 3.69e-13  |g|= 6.24e-12  |ddm|= 2.98e-12
HOMO (B2u) = -0.377672134243581  LUMO (B3u) = -0.0441753136705613
cycle= 40 E= -75.3860532411132  delta_E= 1.71e-13  |g|= 5.93e-12  |ddm|= 3.22e-12
HOMO (B2u) = -0.377672134243563  LUMO (B3u) = -0.0441753136704729
cycle= 41 E= -75.3860532411127  delta_E= 4.55e-13  |g|= 6.54e-12  |ddm|= 2.57e-12
HOMO (B2u) = -0.377672134243501  LUMO (B3u) = -0.0441753136703465
cycle= 42 E= -75.3860532411124  delta_E= 3.41e-13  |g|= 7.13e-12  |ddm|= 2.74e-12
HOMO (B2u) = -0.3776721342434  LUMO (B3u) = -0.0441753136701874
cycle= 43 E= -75.3860532411121  delta_E= 2.56e-13  |g|= 6.26e-12  |ddm|= 3.3e-12
HOMO (B2u) = -0.377672134243276  LUMO (B3u) = -0.0441753136700104
cycle= 44 E= -75.3860532411117  delta_E= 4.69e-13  |g|= 6.83e-12  |ddm|= 2.42e-12
HOMO (B2u) = -0.377672134243106  LUMO (B3u) = -0.0441753136697902
cycle= 45 E= -75.3860532411116  delta_E= 7.11e-14  |g|= 5.54e-12  |ddm|= 3.91e-12
HOMO (B2u) = -0.377672134242939  LUMO (B3u) = -0.0441753136695765
cycle= 46 E= -75.3860532411115  delta_E= 5.68e-14  |g|= 4.77e-12  |ddm|= 3.95e-12
HOMO (B2u) = -0.377672134242795  LUMO (B3u) = -0.044175313669388
cycle= 47 E= -75.3860532411111  delta_E= 4.69e-13  |g|= 4.95e-12  |ddm|= 2.48e-12
HOMO (B2u) = -0.377672134242642  LUMO (B3u) = -0.0441753136691941
cycle= 48 E= -75.3860532411107  delta_E= 3.27e-13  |g|= 5.31e-12  |ddm|= 2.41e-12
HOMO (B2u) = -0.377672134242477  LUMO (B3u) = -0.0441753136689908
cycle= 49 E= -75.3860532411107  delta_E= 2.84e-14  |g|= 4.57e-12  |ddm|= 3.43e-12
HOMO (B2u) = -0.377672134242335  LUMO (B3u) = -0.0441753136688144
cycle= 50 E= -75.3860532411102  delta_E= 4.83e-13  |g|= 4.49e-12  |ddm|= 2.41e-12
SCF not converged.
SCF energy = -75.3860532411102

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmptiqzwe9i
max_memory 4000 MB (current use 5086 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4764159496087  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4872405393538  dE = -0.01082459  S^2 = 0.0000000
               |grad[o]|=0.0774  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4972333232108  dE = -0.0099927839  S^2 = 0.0000000
               |grad[o]|=0.0721  |ddm|=0.0605  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5064112292988  dE = -0.0091779061  S^2 = 0.0000000
               |grad[o]|=0.0682  |ddm|=0.0993  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5143948427259  dE = -0.0079836134  S^2 = 0.0000000
               |grad[o]|=0.0667  |ddm|=0.195  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5205000868507  dE = -0.0061052441  S^2 = 0.0000000
               |grad[o]|=0.0613  |ddm|=0.223  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5243819102444  dE = -0.0038818234  S^2 = 0.0000000
               |grad[o]|=0.048  |ddm|=0.157  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.5257550693778  dE = -0.0013731591  S^2 = 0.0000000
               |grad[o]|=0.0286  |ddm|=  0.1  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5259763702057  dE = -0.00022130083  S^2 = 0.0000000
               |grad[o]|=0.0123  |ddm|=0.094  |maxRot[o]|=0.0187
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5262894691243  dE = -0.00031309892  S^2 = 0.0000000
               |grad[o]|=0.012  |ddm|=0.173  |maxRot[o]|=0.00867
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5272879870042  dE = -0.00099851788  S^2 = 0.0000000
               |grad[o]|=0.0223  |ddm|=0.312  |maxRot[o]|=0.0193
macro iter 11 (4 JK  0 micro), CASSCF E = -75.5294593633399  dE = -0.0021713763  S^2 = 0.0000000
               |grad[o]|=0.0352  |ddm|=0.467  |maxRot[o]|=0.033
macro iter 12 (4 JK  0 micro), CASSCF E = -75.5311507169788  dE = -0.0016913536  S^2 = 0.0000000
               |grad[o]|=0.0305  |ddm|=0.343  |maxRot[o]|= 0.04
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5314728652934  dE = -0.00032214831  S^2 = 0.0000000
               |grad[o]|=0.0123  |ddm|=0.104  |maxRot[o]|= 0.02
macro iter 14 (3 JK  0 micro), CASSCF E = -75.531514853683  dE = -4.198839e-05  S^2 = 0.0000000
               |grad[o]|=0.00408  |ddm|=0.0221  |maxRot[o]|=0.00802
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5315176146196  dE = -2.7609366e-06  S^2 = 0.0000000
               |grad[o]|=0.00103  |ddm|=0.00743  |maxRot[o]|=0.00197
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5315177968731  dE = -1.8225344e-07  S^2 = 0.0000000
               |grad[o]|=0.000275  |ddm|=0.00192  |maxRot[o]|=0.000488
macro iter 17 (3 JK  0 micro), CASSCF E = -75.5315178086547  dE = -1.1781594e-08  S^2 = 0.0000000
               |grad[o]|=6.85e-05  |ddm|=0.00051  |maxRot[o]|=0.000124
macro iter 18 (3 JK  0 micro), CASSCF E = -75.5315178094356  dE = -7.8091489e-10  S^2 = 0.0000000
               |grad[o]|=1.85e-05  |ddm|=0.000128  |maxRot[o]|=3.1e-05
macro iter 19 (3 JK  0 micro), CASSCF E = -75.5315178094877  dE = -5.2054361e-11  S^2 = 0.0000000
               |grad[o]|=5.02e-06  |ddm|=3.41e-05  |maxRot[o]|=8.2e-06
macro iter 20 (2 JK  0 micro), CASSCF E = -75.5315178094906  dE = -2.9416469e-12  S^2 = 0.0000000
               |grad[o]|=1.29e-06  |ddm|=8.67e-06  |maxRot[o]|=2.07e-06
2-step CASSCF converged in 20 macro (81 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.97199268 1.74648651 0.28354267 1.75359787 1.75359626 0.23226963
 0.2322697  0.02624468]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00771   0.00402  -0.00073   0.00000   0.00000
  0 C 2s       0.63877   0.61742  -0.30165   0.00000   0.00000
  0 C 3s      -0.02059   0.00990   0.02411   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.70637
  0 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  0 C 2pz      0.30053  -0.34447   0.63708  -0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000   0.02607
  0 C 3py      0.00000  -0.00000   0.00000   0.02607  -0.00000
  0 C 3pz     -0.02284  -0.00193  -0.03571   0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000   0.01911  -0.00000
  0 C 3dz^2    0.02539  -0.00363   0.03576   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000   0.01911
 0 C 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 C 1s       0.00771  -0.00402  -0.00073   0.00000   0.00000
  1 C 2s       0.63877  -0.61742  -0.30165  -0.00000  -0.00000
  1 C 3s      -0.02059  -0.00990   0.02411  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000   0.00000   0.70637
  1 C 2py     -0.00000   0.00000   0.00000   0.70637   0.00000
  1 C 2pz     -0.30053  -0.34447  -0.63708  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000   0.02607
  1 C 3py      0.00000  -0.00000  -0.00000   0.02607  -0.00000
  1 C 3pz      0.02284  -0.00193   0.03571   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01911   0.00000
  1 C 3dz^2    0.02539   0.00363   0.03576  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000  -0.01911
 1 C 3dx2-y2  -0.00000  -0.00000  -0.00000   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s       0.00000   0.00000   0.34413
  0 C 3s       0.00000   0.00000  -0.04088
  0 C 2px      0.00000   0.70673   0.00000
  0 C 2py      0.70673   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.61571
  0 C 3px      0.00000  -0.01104   0.00000
  0 C 3py     -0.01104   0.00000   0.00000
  0 C 3pz      0.00000   0.00000   0.02055
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz    -0.02028   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000  -0.01955
  0 C 3dxz     0.00000  -0.02028   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.00000
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.34413
  1 C 3s      -0.00000  -0.00000   0.04088
  1 C 2px     -0.00000  -0.70673  -0.00000
  1 C 2py     -0.70673  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.61571
  1 C 3px     -0.00000   0.01104  -0.00000
  1 C 3py      0.01104  -0.00000  -0.00000
  1 C 3pz      0.00000   0.00000   0.02055
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz    -0.02028   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000   0.01955
  1 C 3dxz     0.00000  -0.02028   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.00000
<CAS-nat-orb|mo-hf>  3  3    0.99970732
<CAS-nat-orb|mo-hf>  4  4    0.99969115
<CAS-nat-orb|mo-hf>  5  5    0.99206274
<CAS-nat-orb|mo-hf>  6  6    0.99749856
<CAS-nat-orb|mo-hf>  7  7    0.98939317
<CAS-nat-orb|mo-hf>  8  8    0.97289815
<CAS-nat-orb|mo-hf>  9  9    0.95779869
<CAS-nat-orb|mo-hf>  10  10    0.87337006
<CAS-nat-orb|mo-hf>  10  12   -0.42886290
CASSCF energy = -75.5315178094906
CASCI E = -75.5315178094906  E(CI) = -15.9739146799275  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.016
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.006
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.028

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8638 T =      0.076
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.4 KB SPT = 0.8634 T =      0.018
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.49 KB SPT = 0.8860 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   755 KB SPT = 0.9668 T =      0.016
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.016
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.136
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.03
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.02
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.279 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.158 | Tfpread = 0.000 | Tfpwrite = 0.146 | data = 73.2 MB | cpsd = 55.2 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.156 | E =     -75.5981676369 | DW = 2.98e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.947 | E =     -75.6423716843 | DE = -4.42e-02 | DW = 1.05e-04

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.017 | E =     -75.6433992661 | DE = -1.03e-03 | DW = 2.34e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.127 | E =     -75.6441577737 | DE = -7.59e-04 | DW = 1.29e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.076 | E =     -75.6441957932 | DE = -3.80e-05 | DW = 2.30e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.124 | E =     -75.6442745046 | DE = -7.87e-05 | DW = 1.30e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.056 | E =     -75.6443098845 | DE = -3.54e-05 | DW = 2.33e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     11.116 | E =     -75.6443564788 | DE = -4.66e-05 | DW = 1.33e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.040 | E =     -75.6462532360 | DE = -1.90e-03 | DW = 2.26e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.032 | E =     -75.6467217033 | DE = -4.68e-04 | DW = 3.40e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.740 | E =     -75.6469444695 | DE = -2.23e-04 | DW = 5.37e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.864 | E =     -75.6469829539 | DE = -3.85e-05 | DW = 3.82e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.938 | E =     -75.6469956799 | DE = -1.27e-05 | DW = 5.47e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.222 | E =     -75.6469998483 | DE = -4.17e-06 | DW = 3.85e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.332 | E =     -75.6470097495 | DE = -9.90e-06 | DW = 5.50e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     47.827 | E =     -75.6470118725 | DE = -2.12e-06 | DW = 3.87e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     58.663 | E =     -75.6472174019 | DE = -2.06e-04 | DW = 3.57e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     78.793 | E =     -75.6472619616 | DE = -4.46e-05 | DW = 2.09e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     90.831 | E =     -75.6472751853 | DE = -1.32e-05 | DW = 5.64e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    102.251 | E =     -75.6472783038 | DE = -3.12e-06 | DW = 2.19e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.245 | E =     -75.6472843850 | DE = -6.08e-06 | DW = 5.64e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    123.551 | E =     -75.6472869813 | DE = -2.60e-06 | DW = 2.18e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    133.291 | E =     -75.6472926100 | DE = -5.63e-06 | DW = 5.64e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    144.599 | E =     -75.6472950576 | DE = -2.45e-06 | DW = 2.18e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    192.519 | E =     -75.6475690108 | DE = -2.74e-04 | DW = 3.19e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    228.332 | E =     -75.6475743325 | DE = -5.32e-06 | DW = 1.72e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    255.811 | E =     -75.6475760993 | DE = -1.77e-06 | DW = 3.35e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    286.265 | E =     -75.6475771094 | DE = -1.01e-06 | DW = 1.72e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    311.809 | E =     -75.6475784557 | DE = -1.35e-06 | DW = 3.08e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    340.096 | E =     -75.6475794580 | DE = -1.00e-06 | DW = 1.66e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    367.727 | E =     -75.6475815543 | DE = -2.10e-06 | DW = 3.33e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    395.993 | E =     -75.6475824032 | DE = -8.49e-07 | DW = 1.64e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    592.609 | E =     -75.6477543918 | DE = -1.72e-04 | DW = 7.89e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    699.561 | E =     -75.6477747782 | DE = -2.04e-05 | DW = 7.90e-08

Sweep =   34 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    743.688 | E =     -75.6477817136 | DE = -6.94e-06 | DW = 8.06e-08

Sweep =   35 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    829.845 | E =     -75.6477825720 | DE = -8.58e-07 | DW = 8.08e-08

ATTENTION: DMRG is not converged to desired tolerance of 1.00e-08
E(MRCI) = -75.64778257203571  E_corr = -0.1162647625451143
Time cost =    908.255
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:14:40 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.666908214398 AA    0.000000000000   0.000000000000   3.150000000000 Bohr   0.0

nuclear repulsion = 11.4285714285714
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.575]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    222794.75


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpqg356n4c
max_memory 4000 MB (current use 5109 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.9089301361996

WARN: Singularity detected in overlap matrix (condition number =  175). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.144793107119776  LUMO (B3u) = -0.144793107119776

WARN: B2u HOMO -0.144793107119776 > system LUMO -0.144793107119776

cycle= 1 E= -75.3499635205346  delta_E= -0.441  |g|= 0.262  |ddm|= 1.54
HOMO (B2u) = -0.407994029365037  LUMO (B3u) = -0.0815659278261189
cycle= 2 E= -75.3765746590878  delta_E= -0.0266  |g|= 0.0534  |ddm|= 0.353
HOMO (B2u) = -0.368435737958922  LUMO (B3u) = -0.0370562210896308
cycle= 3 E= -75.3780458200466  delta_E= -0.00147  |g|= 0.0181  |ddm|= 0.0711
HOMO (B2u) = -0.372975542135574  LUMO (B3u) = -0.0415562017768404
cycle= 4 E= -75.3782577251018  delta_E= -0.000212  |g|= 0.000712  |ddm|= 0.0382
HOMO (B2u) = -0.37298632026899  LUMO (B3u) = -0.0417075409102706
cycle= 5 E= -75.3782579293203  delta_E= -2.04e-07  |g|= 8.31e-05  |ddm|= 0.00134
HOMO (B2u) = -0.372958407634988  LUMO (B3u) = -0.0416782676150305
cycle= 6 E= -75.3782579331955  delta_E= -3.88e-09  |g|= 1.36e-05  |ddm|= 0.000138
HOMO (B2u) = -0.372956778075036  LUMO (B3u) = -0.0416799724229735
cycle= 7 E= -75.3782579333153  delta_E= -1.2e-10  |g|= 1.9e-06  |ddm|= 3.4e-05
HOMO (B2u) = -0.372956024408682  LUMO (B3u) = -0.0416794932468783
cycle= 8 E= -75.3782579333177  delta_E= -2.36e-12  |g|= 1.05e-07  |ddm|= 4.17e-06
HOMO (B2u) = -0.37295605202486  LUMO (B3u) = -0.0416795190615329
cycle= 9 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 8.21e-09  |ddm|= 2.09e-07
HOMO (B2u) = -0.372956052956151  LUMO (B3u) = -0.0416795215673734
cycle= 10 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 4.9e-09  |ddm|= 8.06e-09
HOMO (B2u) = -0.372956052899588  LUMO (B3u) = -0.0416795214844616
cycle= 11 E= -75.3782579333177  delta_E= -7.11e-14  |g|= 4.53e-09  |ddm|= 4.16e-09
HOMO (B2u) = -0.372956051584252  LUMO (B3u) = -0.0416795201015728
cycle= 12 E= -75.3782579333177  delta_E= 4.26e-14  |g|= 4.18e-09  |ddm|= 2.1e-09
HOMO (B2u) = -0.372956051455594  LUMO (B3u) = -0.0416795199045204
cycle= 13 E= -75.3782579333176  delta_E= 4.26e-14  |g|= 7.45e-10  |ddm|= 6.42e-09
HOMO (B2u) = -0.372956051505575  LUMO (B3u) = -0.0416795199393674
cycle= 14 E= -75.3782579333176  delta_E=    0  |g|= 6.37e-10  |ddm|= 3.44e-10
HOMO (B2u) = -0.372956051682258  LUMO (B3u) = -0.0416795200611513
cycle= 15 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 5.65e-10  |ddm|= 1.2e-09
HOMO (B2u) = -0.372956051619975  LUMO (B3u) = -0.0416795200925511
cycle= 16 E= -75.3782579333176  delta_E= 2.84e-14  |g|= 6.97e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.372956051666074  LUMO (B3u) = -0.0416795200994602
cycle= 17 E= -75.3782579333176  delta_E=    0  |g|= 7.14e-10  |ddm|= 6.65e-10
HOMO (B2u) = -0.372956051672836  LUMO (B3u) = -0.0416795200906297
cycle= 18 E= -75.3782579333177  delta_E= -2.84e-14  |g|= 4.81e-10  |ddm|= 4.43e-10
HOMO (B2u) = -0.372956051694891  LUMO (B3u) = -0.0416795201120374
cycle= 19 E= -75.3782579333177  delta_E= -1.42e-14  |g|= 3.77e-10  |ddm|= 2.62e-10
HOMO (B2u) = -0.372956051721211  LUMO (B3u) = -0.0416795201364588
cycle= 20 E= -75.3782579333176  delta_E= 5.68e-14  |g|= 2.65e-10  |ddm|= 2e-10
HOMO (B2u) = -0.372956051732298  LUMO (B3u) = -0.0416795201426071
cycle= 21 E= -75.3782579333177  delta_E= -4.26e-14  |g|= 1.52e-10  |ddm|= 2.27e-10
HOMO (B2u) = -0.372956051732463  LUMO (B3u) = -0.0416795201406799
cycle= 22 E= -75.3782579333178  delta_E= -8.53e-14  |g|= 1.33e-10  |ddm|= 6e-11
HOMO (B2u) = -0.37295605173233  LUMO (B3u) = -0.0416795201390882
cycle= 23 E= -75.3782579333177  delta_E= 2.84e-14  |g|= 1.2e-10  |ddm|= 5.32e-11
HOMO (B2u) = -0.372956051729609  LUMO (B3u) = -0.0416795201375015
cycle= 24 E= -75.3782579333177  delta_E= 1.42e-14  |g|= 1.1e-10  |ddm|= 5.13e-11
HOMO (B2u) = -0.372956051732419  LUMO (B3u) = -0.0416795201375896
cycle= 25 E= -75.3782579333177  delta_E=    0  |g|= 8.81e-11  |ddm|= 5.79e-11
HOMO (B2u) = -0.372956051737333  LUMO (B3u) = -0.0416795201391705
Extra cycle  E= -75.3782579333177  delta_E= -2.84e-14  |g|= 2.79e-11  |ddm|= 1.34e-10
converged SCF energy = -75.3782579333177

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpqg356n4c
max_memory 4000 MB (current use 5109 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.47259348959  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4837400648397  dE = -0.011146575  S^2 = 0.0000000
               |grad[o]|=0.0791  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4938692512147  dE = -0.010129186  S^2 = 0.0000000
               |grad[o]|=0.0724  |ddm|=0.0566  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.5029033629077  dE = -0.0090341117  S^2 = 0.0000000
               |grad[o]|=0.0659  |ddm|=0.0668  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5105744701319  dE = -0.0076711072  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.116  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.516254858957  dE = -0.0056803888  S^2 = 0.0000000
               |grad[o]|=0.051  |ddm|=0.122  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5197032282918  dE = -0.0034483693  S^2 = 0.0000000
               |grad[o]|=0.0355  |ddm|=0.0363  |maxRot[o]|=0.0799
macro iter 7 (5 JK  0 micro), CASSCF E = -75.5210737911638  dE = -0.0013705629  S^2 = 0.0000000
               |grad[o]|=0.0177  |ddm|=0.0636  |maxRot[o]|= 0.06
macro iter 8 (3 JK  0 micro), CASSCF E = -75.5215990210018  dE = -0.00052522984  S^2 = 0.0000000
               |grad[o]|=0.0113  |ddm|=0.115  |maxRot[o]|= 0.02
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5222375907737  dE = -0.00063856977  S^2 = 0.0000000
               |grad[o]|=0.0104  |ddm|=0.0771  |maxRot[o]|=0.033
macro iter 10 (4 JK  0 micro), CASSCF E = -75.5226564301129  dE = -0.00041883934  S^2 = 0.0000000
               |grad[o]|=0.0075  |ddm|=0.064  |maxRot[o]|=0.0335
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5227995243906  dE = -0.00014309428  S^2 = 0.0000000
               |grad[o]|=0.00438  |ddm|=0.0306  |maxRot[o]|= 0.02
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5228528701281  dE = -5.3345737e-05  S^2 = 0.0000000
               |grad[o]|=0.00249  |ddm|=0.0113  |maxRot[o]|=0.0144
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5228636270998  dE = -1.0756972e-05  S^2 = 0.0000000
               |grad[o]|=0.00112  |ddm|=0.00642  |maxRot[o]|=0.00668
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5228655523936  dE = -1.9252938e-06  S^2 = 0.0000000
               |grad[o]|=0.000477  |ddm|=0.00264  |maxRot[o]|=0.00287
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5228658807186  dE = -3.2832497e-07  S^2 = 0.0000000
               |grad[o]|=0.000198  |ddm|=0.00108  |maxRot[o]|=0.00119
macro iter 16 (3 JK  0 micro), CASSCF E = -75.5228659357654  dE = -5.5046854e-08  S^2 = 0.0000000
               |grad[o]|=8.19e-05  |ddm|=0.000438  |maxRot[o]|=0.000488
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5228659449376  dE = -9.172183e-09  S^2 = 0.0000000
               |grad[o]|=3.33e-05  |ddm|=0.000178  |maxRot[o]|=0.000199
macro iter 18 (2 JK  0 micro), CASSCF E = -75.5228659464735  dE = -1.5358808e-09  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=7.23e-05  |maxRot[o]|=8.09e-05
macro iter 19 (2 JK  0 micro), CASSCF E = -75.5228659467353  dE = -2.6182079e-10  S^2 = 0.0000000
               |grad[o]|=5.55e-06  |ddm|=2.93e-05  |maxRot[o]|=3.29e-05
macro iter 20 (2 JK  0 micro), CASSCF E = -75.522865946782  dE = -4.6654236e-11  S^2 = 0.0000000
               |grad[o]|=2.26e-06  |ddm|=1.19e-05  |maxRot[o]|=1.33e-05
2-step CASSCF converged in 20 macro (78 JK 20 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96757995 1.92636359 1.90257312 1.85304913 0.08669294 0.15330618
 0.05997837 0.05045671]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00942   0.00931  -0.00604   0.00000   0.00000
  0 C 2s       0.58733   0.63316  -0.39276   0.00000  -0.00000
  0 C 3s      -0.02996   0.01840  -0.05304   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69586
  0 C 2py      0.00000   0.00000   0.00000   0.70455   0.00000
  0 C 2pz      0.38981  -0.31366   0.58451   0.00000  -0.00000
  0 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05174
  0 C 3py      0.00000  -0.00000   0.00000   0.04283  -0.00000
  0 C 3pz     -0.02787  -0.00316  -0.00116   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.04212  -0.00000
  0 C 3dz^2    0.03630  -0.01553   0.03447   0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000  -0.11447
 0 C 3dx2-y2  -0.00196   0.00750  -0.00750   0.00000  -0.00000
  1 C 1s       0.00942  -0.00931  -0.00604   0.00000   0.00000
  1 C 2s       0.58733  -0.63316  -0.39276  -0.00000  -0.00000
  1 C 3s      -0.02996  -0.01840  -0.05304  -0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69586
  1 C 2py     -0.00000   0.00000  -0.00000   0.70455   0.00000
  1 C 2pz     -0.38981  -0.31366  -0.58451  -0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000   0.00000  -0.05174
  1 C 3py     -0.00000  -0.00000  -0.00000   0.04283  -0.00000
  1 C 3pz      0.02787  -0.00316   0.00116   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.04212   0.00000
  1 C 3dz^2    0.03630   0.01553   0.03447  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000  -0.00000   0.11447
 1 C 3dx2-y2  -0.00196  -0.00750  -0.00750   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00059
  0 C 2s       0.00000  -0.00000   0.31126
  0 C 3s       0.00000   0.00000   0.04123
  0 C 2px     -0.00000   0.69686   0.00000
  0 C 2py      0.70644  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.62985
  0 C 3px     -0.00000   0.00767   0.00000
  0 C 3py     -0.02723  -0.00000   0.00000
  0 C 3pz      0.00000   0.00000  -0.05999
  0 C 3dxy    -0.00000  -0.00000   0.00000
  0 C 3dyz     0.01434   0.00000   0.00000
  0 C 3dz^2    0.00000   0.00000   0.01543
  0 C 3dxz    -0.00000  -0.11967   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02938
  1 C 1s       0.00000   0.00000   0.00059
  1 C 2s      -0.00000  -0.00000  -0.31126
  1 C 3s      -0.00000  -0.00000  -0.04123
  1 C 2px     -0.00000  -0.69686  -0.00000
  1 C 2py     -0.70644   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.62985
  1 C 3px      0.00000  -0.00767  -0.00000
  1 C 3py      0.02723   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.05999
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01434  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.01543
  1 C 3dxz    -0.00000  -0.11967   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02938
<CAS-nat-orb|mo-hf>  3  3    0.98488178
<CAS-nat-orb|mo-hf>  4  4    0.99976478
<CAS-nat-orb|mo-hf>  5  5    0.98488756
<CAS-nat-orb|mo-hf>  6  6    0.99934351
<CAS-nat-orb|mo-hf>  7  7    0.94550983
<CAS-nat-orb|mo-hf>  8  8    0.96719800
<CAS-nat-orb|mo-hf>  9  9    0.95784087
<CAS-nat-orb|mo-hf>  10  10    0.82549313
<CAS-nat-orb|mo-hf>  10  11   -0.53364517
CASSCF energy = -75.522865946782
CASCI E = -75.522865946782  E(CI) = -15.8845982588023  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.030
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.040
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.040
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.337
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.090
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.649

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.030
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8638 T =      0.614
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.4 KB SPT = 0.8634 T =      1.736
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.722
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.49 KB SPT = 0.8860 T =      1.716
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.136
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.011
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      5.997
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.06
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.01
Time init sweep =        0.249 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.163 | Tfpread = 0.000 | Tfpwrite = 0.160 | data = 73.2 MB | cpsd = 55.2 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.900 | E =     -75.6162769756 | DW = 1.43e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.185 | E =     -75.6384963241 | DE = -2.22e-02 | DW = 5.80e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.993 | E =     -75.6391473368 | DE = -6.51e-04 | DW = 1.58e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.860 | E =     -75.6397228074 | DE = -5.75e-04 | DW = 7.04e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.575 | E =     -75.6397804015 | DE = -5.76e-05 | DW = 1.59e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     11.357 | E =     -75.6398504954 | DE = -7.01e-05 | DW = 7.39e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.128 | E =     -75.6398939226 | DE = -4.34e-05 | DW = 1.62e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.970 | E =     -75.6399425000 | DE = -4.86e-05 | DW = 7.58e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.551 | E =     -75.6412728429 | DE = -1.33e-03 | DW = 1.58e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.749 | E =     -75.6416577551 | DE = -3.85e-04 | DW = 2.32e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.663 | E =     -75.6417636740 | DE = -1.06e-04 | DW = 4.04e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.646 | E =     -75.6417850534 | DE = -2.14e-05 | DW = 2.68e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.318 | E =     -75.6417872889 | DE = -2.24e-06 | DW = 4.06e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.348 | E =     -75.6417889417 | DE = -1.65e-06 | DW = 2.69e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.510 | E =     -75.6417897034 | DE = -7.62e-07 | DW = 4.07e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.526 | E =     -75.6417903419 | DE = -6.38e-07 | DW = 2.70e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     47.081 | E =     -75.6419295017 | DE = -1.39e-04 | DW = 2.86e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     59.735 | E =     -75.6419688734 | DE = -3.94e-05 | DW = 1.84e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     69.947 | E =     -75.6419735522 | DE = -4.68e-06 | DW = 4.55e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     82.213 | E =     -75.6419743192 | DE = -7.67e-07 | DW = 1.87e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     92.692 | E =     -75.6419744496 | DE = -1.30e-07 | DW = 4.55e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    104.909 | E =     -75.6419743952 | DE = 5.45e-08 | DW = 1.78e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    116.446 | E =     -75.6419749373 | DE = -5.42e-07 | DW = 4.54e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    128.832 | E =     -75.6419753791 | DE = -4.42e-07 | DW = 1.87e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    150.966 | E =     -75.6419839898 | DE = -8.61e-06 | DW = 2.36e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    179.940 | E =     -75.6419864618 | DE = -2.47e-06 | DW = 1.00e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    206.651 | E =     -75.6419869953 | DE = -5.33e-07 | DW = 2.56e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    231.922 | E =     -75.6419868967 | DE = 9.86e-08 | DW = 9.77e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    261.891 | E =     -75.6419870530 | DE = -1.56e-07 | DW = 2.38e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    297.651 | E =     -75.6419872339 | DE = -1.81e-07 | DW = 9.97e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    324.722 | E =     -75.6419872355 | DE = -1.65e-09 | DW = 2.38e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    362.197 | E =     -75.6419874223 | DE = -1.87e-07 | DW = 1.00e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    544.279 | E =     -75.6419902355 | DE = -2.81e-06 | DW = 5.26e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    701.201 | E =     -75.6419902355 | DE = -1.87e-11 | DW = 5.26e-08

E(MRCI) = -75.64199023551842  E_corr = -0.1191242887364439
Time cost =    978.278
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:30:58 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.693367074944 AA    0.000000000000   0.000000000000   3.200000000000 Bohr   0.0

nuclear repulsion = 11.25
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.6]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    236826.67


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpw6msd5c9
max_memory 4000 MB (current use 5134 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8853199307072

WARN: Singularity detected in overlap matrix (condition number =  163). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.140132093357862  LUMO (B3u) = -0.140132093357862

WARN: B2u HOMO -0.140132093357862 > system LUMO -0.140132093357862

cycle= 1 E= -75.3423788059563  delta_E= -0.457  |g|= 0.259  |ddm|= 1.53
HOMO (B2u) = -0.402834374141249  LUMO (B3u) = -0.0785386739836394
cycle= 2 E= -75.3685959970364  delta_E= -0.0262  |g|= 0.053  |ddm|= 0.353
HOMO (B2u) = -0.363851731217672  LUMO (B3u) = -0.0346304224365227
cycle= 3 E= -75.3700649559039  delta_E= -0.00147  |g|= 0.0182  |ddm|= 0.0704
HOMO (B2u) = -0.368389012587524  LUMO (B3u) = -0.0391108103436429
cycle= 4 E= -75.3702805696255  delta_E= -0.000216  |g|= 0.000703  |ddm|= 0.0381
HOMO (B2u) = -0.368430097958785  LUMO (B3u) = -0.0392945410036866
cycle= 5 E= -75.37028076688  delta_E= -1.97e-07  |g|= 8.62e-05  |ddm|= 0.00125
HOMO (B2u) = -0.368399790742486  LUMO (B3u) = -0.0392632961118363
cycle= 6 E= -75.3702807710482  delta_E= -4.17e-09  |g|= 1.41e-05  |ddm|= 0.000143
HOMO (B2u) = -0.368398140839552  LUMO (B3u) = -0.0392648663308158
cycle= 7 E= -75.3702807711757  delta_E= -1.27e-10  |g|= 1.92e-06  |ddm|= 3.39e-05
HOMO (B2u) = -0.368397398349103  LUMO (B3u) = -0.0392644368518548
cycle= 8 E= -75.3702807711781  delta_E= -2.4e-12  |g|= 1.08e-07  |ddm|= 4.2e-06
HOMO (B2u) = -0.368397420522505  LUMO (B3u) = -0.0392644560498244
cycle= 9 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 7.49e-09  |ddm|= 2.14e-07
HOMO (B2u) = -0.368397421396854  LUMO (B3u) = -0.0392644584978844
cycle= 10 E= -75.3702807711782  delta_E=    0  |g|= 4.7e-09  |ddm|= 7.64e-09
HOMO (B2u) = -0.368397421278597  LUMO (B3u) = -0.0392644583523347
cycle= 11 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 4.19e-09  |ddm|= 4.06e-09
HOMO (B2u) = -0.368397419986852  LUMO (B3u) = -0.0392644569938277
cycle= 12 E= -75.3702807711782  delta_E= 8.53e-14  |g|= 3.87e-09  |ddm|= 1.95e-09
HOMO (B2u) = -0.368397420308937  LUMO (B3u) = -0.0392644572899772
cycle= 13 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 3.35e-09  |ddm|= 8.42e-10
HOMO (B2u) = -0.368397419921308  LUMO (B3u) = -0.0392644568735344
cycle= 14 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 5.28e-10  |ddm|= 5.01e-09
HOMO (B2u) = -0.368397420132909  LUMO (B3u) = -0.0392644570115384
cycle= 15 E= -75.3702807711782  delta_E=    0  |g|= 5.84e-10  |ddm|= 1.53e-09
HOMO (B2u) = -0.368397420047007  LUMO (B3u) = -0.0392644570360063
cycle= 16 E= -75.3702807711782  delta_E= -1.42e-14  |g|= 7.22e-10  |ddm|= 1.54e-09
HOMO (B2u) = -0.368397420093639  LUMO (B3u) = -0.0392644570384185
cycle= 17 E= -75.3702807711782  delta_E= 4.26e-14  |g|= 7.09e-10  |ddm|= 7.35e-10
HOMO (B2u) = -0.368397420094008  LUMO (B3u) = -0.0392644570253418
cycle= 18 E= -75.3702807711781  delta_E= 2.84e-14  |g|= 5.03e-10  |ddm|= 3.46e-10
HOMO (B2u) = -0.368397420112672  LUMO (B3u) = -0.039264457044093
cycle= 19 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 4.32e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.368397420134434  LUMO (B3u) = -0.0392644570647819
cycle= 20 E= -75.3702807711782  delta_E=    0  |g|= 3.41e-10  |ddm|= 1.43e-10
HOMO (B2u) = -0.368397420141438  LUMO (B3u) = -0.0392644570677939
cycle= 21 E= -75.3702807711781  delta_E= 5.68e-14  |g|= 2.32e-10  |ddm|= 1.8e-10
HOMO (B2u) = -0.368397420150081  LUMO (B3u) = -0.0392644570740909
cycle= 22 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 1.37e-10  |ddm|= 1.65e-10
HOMO (B2u) = -0.368397420149809  LUMO (B3u) = -0.0392644570721904
cycle= 23 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 1.32e-10  |ddm|= 4.11e-11
HOMO (B2u) = -0.368397420145917  LUMO (B3u) = -0.0392644570701002
cycle= 24 E= -75.3702807711781  delta_E= 8.53e-14  |g|= 1.23e-10  |ddm|= 5.38e-11
HOMO (B2u) = -0.368397420148399  LUMO (B3u) = -0.0392644570698313
cycle= 25 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 9.98e-11  |ddm|= 5.61e-11
HOMO (B2u) = -0.368397420149641  LUMO (B3u) = -0.039264457069986
cycle= 26 E= -75.3702807711781  delta_E= 5.68e-14  |g|= 7.85e-11  |ddm|= 4.06e-11
HOMO (B2u) = -0.368397420150146  LUMO (B3u) = -0.0392644570698639
cycle= 27 E= -75.3702807711782  delta_E= -5.68e-14  |g|= 6.42e-11  |ddm|= 2.78e-11
HOMO (B2u) = -0.368397420150628  LUMO (B3u) = -0.0392644570697296
cycle= 28 E= -75.3702807711781  delta_E= 1.42e-14  |g|= 5.01e-11  |ddm|= 2.78e-11
HOMO (B2u) = -0.368397420151192  LUMO (B3u) = -0.0392644570697694
cycle= 29 E= -75.3702807711782  delta_E= -2.84e-14  |g|= 3.86e-11  |ddm|= 2.35e-11
HOMO (B2u) = -0.368397420151568  LUMO (B3u) = -0.0392644570697937
cycle= 30 E= -75.370280771178  delta_E= 1.28e-13  |g|= 3.08e-11  |ddm|= 1.66e-11
HOMO (B2u) = -0.368397420151862  LUMO (B3u) = -0.0392644570698643
cycle= 31 E= -75.370280771178  delta_E= 2.84e-14  |g|= 2.64e-11  |ddm|= 1.02e-11
HOMO (B2u) = -0.36839742015205  LUMO (B3u) = -0.0392644570698703
cycle= 32 E= -75.370280771178  delta_E= 4.26e-14  |g|= 2.21e-11  |ddm|= 1.01e-11
HOMO (B2u) = -0.368397420152338  LUMO (B3u) = -0.0392644570698856
cycle= 33 E= -75.3702807711777  delta_E= 2.42e-13  |g|= 1.8e-11  |ddm|= 9.14e-12
HOMO (B2u) = -0.368397420152509  LUMO (B3u) = -0.0392644570698863
cycle= 34 E= -75.3702807711774  delta_E= 3.41e-13  |g|= 1.48e-11  |ddm|= 7.16e-12
HOMO (B2u) = -0.368397420152619  LUMO (B3u) = -0.0392644570698621
cycle= 35 E= -75.3702807711771  delta_E= 2.84e-13  |g|= 1.25e-11  |ddm|= 5.7e-12
HOMO (B2u) = -0.368397420152683  LUMO (B3u) = -0.0392644570698116
cycle= 36 E= -75.3702807711768  delta_E= 2.98e-13  |g|= 1.11e-11  |ddm|= 4.97e-12
HOMO (B2u) = -0.368397420152707  LUMO (B3u) = -0.0392644570697413
cycle= 37 E= -75.3702807711763  delta_E= 4.69e-13  |g|= 9.89e-12  |ddm|= 4.16e-12
HOMO (B2u) = -0.36839742015269  LUMO (B3u) = -0.0392644570696463
cycle= 38 E= -75.3702807711758  delta_E= 5.68e-13  |g|= 8.91e-12  |ddm|= 3.39e-12
HOMO (B2u) = -0.368397420152635  LUMO (B3u) = -0.0392644570695222
cycle= 39 E= -75.3702807711754  delta_E= 3.69e-13  |g|= 8.49e-12  |ddm|= 2.91e-12
HOMO (B2u) = -0.368397420152551  LUMO (B3u) = -0.039264457069372
cycle= 40 E= -75.3702807711751  delta_E= 3.41e-13  |g|= 7.89e-12  |ddm|= 3.21e-12
HOMO (B2u) = -0.368397420152447  LUMO (B3u) = -0.0392644570692037
cycle= 41 E= -75.3702807711748  delta_E= 2.56e-13  |g|= 7.03e-12  |ddm|= 3.39e-12
HOMO (B2u) = -0.368397420152327  LUMO (B3u) = -0.0392644570690246
cycle= 42 E= -75.3702807711746  delta_E= 1.85e-13  |g|= 6.73e-12  |ddm|= 3.26e-12
HOMO (B2u) = -0.368397420152199  LUMO (B3u) = -0.0392644570688407
cycle= 43 E= -75.3702807711746  delta_E= 2.84e-14  |g|= 5.72e-12  |ddm|= 3.61e-12
HOMO (B2u) = -0.368397420152073  LUMO (B3u) = -0.0392644570686593
cycle= 44 E= -75.3702807711743  delta_E= 2.98e-13  |g|= 5.95e-12  |ddm|= 3.06e-12
HOMO (B2u) = -0.368397420151944  LUMO (B3u) = -0.0392644570684746
cycle= 45 E= -75.3702807711742  delta_E= 5.68e-14  |g|= 5.39e-12  |ddm|= 3.57e-12
HOMO (B2u) = -0.368397420151827  LUMO (B3u) = -0.0392644570683019
cycle= 46 E= -75.3702807711742  delta_E= 8.53e-14  |g|= 5.14e-12  |ddm|= 3.46e-12
HOMO (B2u) = -0.368397420151724  LUMO (B3u) = -0.0392644570681461
cycle= 47 E= -75.3702807711738  delta_E= 3.13e-13  |g|= 5.1e-12  |ddm|= 3.37e-12
HOMO (B2u) = -0.368397420151633  LUMO (B3u) = -0.0392644570680039
cycle= 48 E= -75.3702807711735  delta_E= 3.13e-13  |g|= 5.09e-12  |ddm|= 3.1e-12
HOMO (B2u) = -0.368397420151539  LUMO (B3u) = -0.0392644570678587
cycle= 49 E= -75.3702807711731  delta_E= 4.26e-13  |g|= 5.23e-12  |ddm|= 2.94e-12
HOMO (B2u) = -0.368397420151432  LUMO (B3u) = -0.0392644570677009
cycle= 50 E= -75.3702807711728  delta_E= 3.41e-13  |g|= 4.84e-12  |ddm|= 3.35e-12
SCF not converged.
SCF energy = -75.3702807711728

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpw6msd5c9
max_memory 4000 MB (current use 5134 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4686639234808  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4801679751206  dE = -0.011504052  S^2 = 0.0000000
               |grad[o]|=0.0808  |ddm|= 3.84  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4904827984348  dE = -0.010314823  S^2 = 0.0000000
               |grad[o]|=0.073  |ddm|=0.0569  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.499456216187  dE = -0.0089734178  S^2 = 0.0000000
               |grad[o]|=0.0646  |ddm|=0.0513  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5069181130706  dE = -0.0074618969  S^2 = 0.0000000
               |grad[o]|=0.0562  |ddm|=0.0779  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5123693504982  dE = -0.0054512374  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=0.0794  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5156490123812  dE = -0.0032796619  S^2 = 0.0000000
               |grad[o]|=0.0301  |ddm|=0.021  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.516879268321  dE = -0.0012302559  S^2 = 0.0000000
               |grad[o]|=0.015  |ddm|=0.0787  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5176279528438  dE = -0.00074868452  S^2 = 0.0000000
               |grad[o]|=0.0101  |ddm|=0.0721  |maxRot[o]|= 0.04
macro iter 9 (4 JK  0 micro), CASSCF E = -75.5179503323422  dE = -0.0003223795  S^2 = 0.0000000
               |grad[o]|=0.00624  |ddm|=0.0442  |maxRot[o]|=0.0327
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5180291246604  dE = -7.8792318e-05  S^2 = 0.0000000
               |grad[o]|=0.00298  |ddm|=0.0185  |maxRot[o]|=0.0177
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5180431716693  dE = -1.4047009e-05  S^2 = 0.0000000
               |grad[o]|=0.00127  |ddm|=0.00706  |maxRot[o]|=0.00779
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5180453689782  dE = -2.1973089e-06  S^2 = 0.0000000
               |grad[o]|=0.000508  |ddm|=0.0027  |maxRot[o]|=0.00313
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5180456957242  dE = -3.2674606e-07  S^2 = 0.0000000
               |grad[o]|=0.000197  |ddm|=0.00103  |maxRot[o]|=0.00121
macro iter 14 (3 JK  0 micro), CASSCF E = -75.5180457433475  dE = -4.7623232e-08  S^2 = 0.0000000
               |grad[o]|=7.68e-05  |ddm|=0.000394  |maxRot[o]|=0.000466
macro iter 15 (3 JK  0 micro), CASSCF E = -75.5180457502022  dE = -6.8547337e-09  S^2 = 0.0000000
               |grad[o]|=2.93e-05  |ddm|=0.00015  |maxRot[o]|=0.000178
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5180457511758  dE = -9.7358566e-10  S^2 = 0.0000000
               |grad[o]|=1.12e-05  |ddm|=5.7e-05  |maxRot[o]|=6.76e-05
macro iter 17 (2 JK  0 micro), CASSCF E = -75.5180457513067  dE = -1.3095303e-10  S^2 = 0.0000000
               |grad[o]|=4.23e-06  |ddm|=2.16e-05  |maxRot[o]|=2.54e-05
macro iter 18 (2 JK  0 micro), CASSCF E = -75.518045751323  dE = -1.6257218e-11  S^2 = 0.0000000
               |grad[o]|=1.6e-06  |ddm|=8.15e-06  |maxRot[o]|=9.66e-06
2-step CASSCF converged in 18 macro (72 JK 18 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9663057  1.92713079 1.90282926 1.84406997 0.0836569  0.16227412
 0.0596417  0.05409157]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.00972   0.00945  -0.00589   0.00000   0.00000
  0 C 2s       0.59726   0.63748  -0.37752  -0.00000   0.00000
  0 C 3s      -0.02696   0.01811  -0.05147  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000  -0.00000   0.00000   0.69538
  0 C 2py     -0.00000   0.00000   0.00000   0.70451   0.00000
  0 C 2pz      0.37495  -0.30481   0.59459   0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.05355
  0 C 3py     -0.00000   0.00000   0.00000   0.04456  -0.00000
  0 C 3pz     -0.02582  -0.00292  -0.00005  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.04098  -0.00000
  0 C 3dz^2    0.03462  -0.01515   0.03455  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11653
 0 C 3dx2-y2  -0.00172   0.00737  -0.00749  -0.00000   0.00000
  1 C 1s       0.00972  -0.00945  -0.00589   0.00000   0.00000
  1 C 2s       0.59726  -0.63748  -0.37752  -0.00000   0.00000
  1 C 3s      -0.02696  -0.01811  -0.05147   0.00000   0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69538
  1 C 2py      0.00000  -0.00000   0.00000   0.70451  -0.00000
  1 C 2pz     -0.37495  -0.30481  -0.59459  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000   0.00000  -0.00000  -0.05355
  1 C 3py      0.00000  -0.00000  -0.00000   0.04456  -0.00000
  1 C 3pz      0.02582  -0.00292   0.00005  -0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.04098   0.00000
  1 C 3dz^2    0.03462   0.01515   0.03455   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000  -0.00000   0.00000   0.11653
 1 C 3dx2-y2  -0.00172  -0.00737  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00055
  0 C 2s      -0.00000   0.00000   0.30262
  0 C 3s      -0.00000   0.00000   0.04028
  0 C 2px      0.00000   0.69699  -0.00000
  0 C 2py      0.70653   0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.63446
  0 C 3px      0.00000   0.00537   0.00000
  0 C 3py     -0.02507   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05718
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01392   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01415
  0 C 3dxz     0.00000  -0.11904   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02809
  1 C 1s       0.00000   0.00000   0.00055
  1 C 2s      -0.00000   0.00000  -0.30262
  1 C 3s       0.00000  -0.00000  -0.04028
  1 C 2px     -0.00000  -0.69699  -0.00000
  1 C 2py     -0.70653  -0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.63446
  1 C 3px     -0.00000  -0.00537   0.00000
  1 C 3py      0.02507  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.05718
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.01392   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01415
  1 C 3dxz     0.00000  -0.11904  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02809
<CAS-nat-orb|mo-hf>  3  3    0.98713996
<CAS-nat-orb|mo-hf>  4  4    0.99975825
<CAS-nat-orb|mo-hf>  5  5    0.98714928
<CAS-nat-orb|mo-hf>  6  6    0.99929981
<CAS-nat-orb|mo-hf>  7  7    0.94370155
<CAS-nat-orb|mo-hf>  8  8    0.96917400
<CAS-nat-orb|mo-hf>  9  9    0.95823418
<CAS-nat-orb|mo-hf>  10  10    0.84381041
<CAS-nat-orb|mo-hf>  10  11   -0.50815316
CASSCF energy = -75.518045751323
CASCI E = -75.518045751323  E(CI) = -15.8005832006271  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.040

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8638 T =      0.046
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.4 KB SPT = 0.8634 T =      0.013
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.49 KB SPT = 0.8860 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.010
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.011
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.088
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.08
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.09
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.04
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.250 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.168 | Tfpread = 0.000 | Tfpwrite = 0.166 | data = 73.2 MB | cpsd = 55.2 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.829 | E =     -75.6113106402 | DW = 1.46e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.658 | E =     -75.6337655268 | DE = -2.25e-02 | DW = 5.75e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.691 | E =     -75.6343663140 | DE = -6.01e-04 | DW = 1.58e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     11.397 | E =     -75.6349299653 | DE = -5.64e-04 | DW = 7.00e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     14.136 | E =     -75.6349762017 | DE = -4.62e-05 | DW = 1.57e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     16.781 | E =     -75.6350359990 | DE = -5.98e-05 | DW = 7.25e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.143 | E =     -75.6350759563 | DE = -4.00e-05 | DW = 1.61e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.906 | E =     -75.6351197399 | DE = -4.38e-05 | DW = 7.51e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.113 | E =     -75.6363941947 | DE = -1.27e-03 | DW = 1.53e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.219 | E =     -75.6367963793 | DE = -4.02e-04 | DW = 2.26e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     37.598 | E =     -75.6369025795 | DE = -1.06e-04 | DW = 3.93e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.987 | E =     -75.6369275111 | DE = -2.49e-05 | DW = 2.61e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     46.391 | E =     -75.6369300992 | DE = -2.59e-06 | DW = 3.96e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     50.659 | E =     -75.6369315316 | DE = -1.43e-06 | DW = 2.63e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     55.307 | E =     -75.6369332485 | DE = -1.72e-06 | DW = 3.97e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     57.776 | E =     -75.6369340967 | DE = -8.48e-07 | DW = 2.64e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     65.159 | E =     -75.6370711299 | DE = -1.37e-04 | DW = 2.76e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     77.988 | E =     -75.6371096960 | DE = -3.86e-05 | DW = 1.85e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.983 | E =     -75.6371147688 | DE = -5.07e-06 | DW = 4.52e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    100.380 | E =     -75.6371148738 | DE = -1.05e-07 | DW = 1.79e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    111.492 | E =     -75.6371157154 | DE = -8.42e-07 | DW = 4.46e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    123.377 | E =     -75.6371157837 | DE = -6.84e-08 | DW = 1.79e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    134.554 | E =     -75.6371163900 | DE = -6.06e-07 | DW = 4.44e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    146.374 | E =     -75.6371165650 | DE = -1.75e-07 | DW = 1.81e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    168.235 | E =     -75.6371252898 | DE = -8.72e-06 | DW = 2.29e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    198.761 | E =     -75.6371279172 | DE = -2.63e-06 | DW = 9.23e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    225.346 | E =     -75.6371283335 | DE = -4.16e-07 | DW = 2.22e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    253.880 | E =     -75.6371286694 | DE = -3.36e-07 | DW = 9.40e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    280.560 | E =     -75.6371288709 | DE = -2.01e-07 | DW = 2.28e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    309.478 | E =     -75.6371291478 | DE = -2.77e-07 | DW = 9.37e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    335.691 | E =     -75.6371293087 | DE = -1.61e-07 | DW = 2.28e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    364.751 | E =     -75.6371295772 | DE = -2.68e-07 | DW = 9.33e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    581.217 | E =     -75.6371386481 | DE = -9.07e-06 | DW = 5.06e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    708.356 | E =     -75.6371386482 | DE = -1.20e-10 | DW = 5.07e-08

E(MRCI) = -75.63713864817512  E_corr = -0.1190928968521234
Time cost =    790.299
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:44:09 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.719825935490 AA    0.000000000000   0.000000000000   3.250000000000 Bohr   0.0

nuclear repulsion = 11.0769230769231
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.625]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    249168.97


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpcoahzdnx
max_memory 4000 MB (current use 5134 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8631164371269

WARN: Singularity detected in overlap matrix (condition number =  151). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.13569696344616  LUMO (B3u) = -0.13569696344616

WARN: B2u HOMO -0.13569696344616 > system LUMO -0.13569696344616

cycle= 1 E= -75.3346710578886  delta_E= -0.472  |g|= 0.257  |ddm|= 1.52
HOMO (B2u) = -0.397829563278946  LUMO (B3u) = -0.0755897093543543
cycle= 2 E= -75.360485940034  delta_E= -0.0258  |g|= 0.0524  |ddm|= 0.352
HOMO (B2u) = -0.359424194210821  LUMO (B3u) = -0.032286636697359
cycle= 3 E= -75.3619492644577  delta_E= -0.00146  |g|= 0.0182  |ddm|= 0.0697
HOMO (B2u) = -0.363955951245317  LUMO (B3u) = -0.0367454491314097
cycle= 4 E= -75.3621677667453  delta_E= -0.000219  |g|= 0.000695  |ddm|= 0.0379
HOMO (B2u) = -0.364024863853047  LUMO (B3u) = -0.0369588213878714
cycle= 5 E= -75.3621679575039  delta_E= -1.91e-07  |g|= 8.98e-05  |ddm|= 0.00116
HOMO (B2u) = -0.363992517085415  LUMO (B3u) = -0.0369261206635528
cycle= 6 E= -75.3621679620312  delta_E= -4.53e-09  |g|= 1.46e-05  |ddm|= 0.000149
HOMO (B2u) = -0.363990782245943  LUMO (B3u) = -0.0369275152560753
cycle= 7 E= -75.3621679621673  delta_E= -1.36e-10  |g|= 1.94e-06  |ddm|= 3.41e-05
HOMO (B2u) = -0.363990060624691  LUMO (B3u) = -0.0369271360119255
cycle= 8 E= -75.3621679621696  delta_E= -2.34e-12  |g|= 1.11e-07  |ddm|= 4.19e-06
HOMO (B2u) = -0.363990078365052  LUMO (B3u) = -0.0369271500510231
cycle= 9 E= -75.3621679621697  delta_E= -1.42e-13  |g|= 7.05e-09  |ddm|= 2.21e-07
HOMO (B2u) = -0.363990079133924  LUMO (B3u) = -0.0369271524019206
cycle= 10 E= -75.3621679621697  delta_E= 7.11e-14  |g|= 4.68e-09  |ddm|= 7.45e-09
HOMO (B2u) = -0.363990078969656  LUMO (B3u) = -0.0369271522093122
cycle= 11 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 4e-09  |ddm|= 4e-09
HOMO (B2u) = -0.363990077683332  LUMO (B3u) = -0.0369271508560225
cycle= 12 E= -75.3621679621697  delta_E=    0  |g|= 3.68e-09  |ddm|= 1.85e-09
HOMO (B2u) = -0.363990078039854  LUMO (B3u) = -0.0369271511908609
cycle= 13 E= -75.3621679621697  delta_E=    0  |g|= 3.23e-09  |ddm|= 8.5e-10
HOMO (B2u) = -0.36399007765768  LUMO (B3u) = -0.0369271508037113
cycle= 14 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 4.13e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.363990077851708  LUMO (B3u) = -0.0369271509288766
cycle= 15 E= -75.3621679621697  delta_E= -2.84e-14  |g|= 5.37e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.36399007776467  LUMO (B3u) = -0.0369271509415074
cycle= 16 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 6.62e-10  |ddm|= 1.35e-09
HOMO (B2u) = -0.363990077806214  LUMO (B3u) = -0.036927150939841
cycle= 17 E= -75.3621679621697  delta_E= -4.26e-14  |g|= 6.49e-10  |ddm|= 7.18e-10
HOMO (B2u) = -0.363990077800378  LUMO (B3u) = -0.0369271509230861
cycle= 18 E= -75.3621679621697  delta_E= -1.42e-14  |g|= 4.6e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.363990077815704  LUMO (B3u) = -0.0369271509392643
cycle= 19 E= -75.3621679621697  delta_E=    0  |g|= 3.99e-10  |ddm|= 1.87e-10
HOMO (B2u) = -0.363990077833269  LUMO (B3u) = -0.0369271509566507
cycle= 20 E= -75.3621679621697  delta_E=    0  |g|= 3.18e-10  |ddm|= 1.18e-10
HOMO (B2u) = -0.363990077836359  LUMO (B3u) = -0.0369271509567352
cycle= 21 E= -75.3621679621697  delta_E= 4.26e-14  |g|= 2.17e-10  |ddm|= 1.6e-10
HOMO (B2u) = -0.363990077841869  LUMO (B3u) = -0.0369271509608679
cycle= 22 E= -75.3621679621696  delta_E= 4.26e-14  |g|= 1.25e-10  |ddm|= 1.53e-10
HOMO (B2u) = -0.363990077841468  LUMO (B3u) = -0.0369271509589843
cycle= 23 E= -75.3621679621698  delta_E= -1.99e-13  |g|= 1.23e-10  |ddm|= 2.67e-11
HOMO (B2u) = -0.363990077837804  LUMO (B3u) = -0.0369271509570181
cycle= 24 E= -75.3621679621698  delta_E= 5.68e-14  |g|= 1.12e-10  |ddm|= 4.78e-11
HOMO (B2u) = -0.363990077839662  LUMO (B3u) = -0.0369271509564477
cycle= 25 E= -75.3621679621697  delta_E= 2.84e-14  |g|= 9.11e-11  |ddm|= 4.87e-11
HOMO (B2u) = -0.363990077840184  LUMO (B3u) = -0.0369271509561633
cycle= 26 E= -75.3621679621698  delta_E= -2.84e-14  |g|= 7.24e-11  |ddm|= 3.25e-11
HOMO (B2u) = -0.363990077840201  LUMO (B3u) = -0.0369271509557396
cycle= 27 E= -75.3621679621698  delta_E=    0  |g|= 6.03e-11  |ddm|= 2.13e-11
HOMO (B2u) = -0.363990077840967  LUMO (B3u) = -0.0369271509550103
Extra cycle  E= -75.3621679621698  delta_E=    0  |g|= 2.17e-11  |ddm|= 7.56e-11
converged SCF energy = -75.3621679621698

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpcoahzdnx
max_memory 4000 MB (current use 5134 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.464653004534  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4765381406285  dE = -0.011885136  S^2 = 0.0000000
               |grad[o]|=0.0827  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4870582692823  dE = -0.010520129  S^2 = 0.0000000
               |grad[o]|=0.0737  |ddm|=0.0593  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4959969238171  dE = -0.0089386545  S^2 = 0.0000000
               |grad[o]|=0.0638  |ddm|=0.0441  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.5032579692972  dE = -0.0072610455  S^2 = 0.0000000
               |grad[o]|=0.0535  |ddm|=0.0593  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5084987533348  dE = -0.005240784  S^2 = 0.0000000
               |grad[o]|=0.0416  |ddm|=0.0623  |maxRot[o]|=0.0799
macro iter 6 (6 JK  0 micro), CASSCF E = -75.5116053103643  dE = -0.003106557  S^2 = 0.0000000
               |grad[o]|=0.026  |ddm|=0.0318  |maxRot[o]|=0.0799
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5125696295349  dE = -0.00096431917  S^2 = 0.0000000
               |grad[o]|=0.0119  |ddm|=0.0749  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5130320960298  dE = -0.00046246649  S^2 = 0.0000000
               |grad[o]|=0.00731  |ddm|=0.0414  |maxRot[o]|=0.0388
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5131336072403  dE = -0.00010151121  S^2 = 0.0000000
               |grad[o]|=0.00337  |ddm|=0.0206  |maxRot[o]|= 0.02
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5131512745916  dE = -1.7667351e-05  S^2 = 0.0000000
               |grad[o]|=0.00142  |ddm|=0.00714  |maxRot[o]|=0.00886
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5131537381215  dE = -2.4635299e-06  S^2 = 0.0000000
               |grad[o]|=0.00054  |ddm|=0.00275  |maxRot[o]|=0.00336
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5131540652688  dE = -3.2714733e-07  S^2 = 0.0000000
               |grad[o]|=0.000199  |ddm|=0.000997  |maxRot[o]|=0.00123
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5131541079564  dE = -4.2687546e-08  S^2 = 0.0000000
               |grad[o]|=7.29e-05  |ddm|=0.00036  |maxRot[o]|=0.000447
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5131541134723  dE = -5.5159148e-09  S^2 = 0.0000000
               |grad[o]|=2.64e-05  |ddm|=0.000129  |maxRot[o]|=0.000161
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5131541141777  dE = -7.0544104e-10  S^2 = 0.0000000
               |grad[o]|=9.54e-06  |ddm|=4.66e-05  |maxRot[o]|=5.81e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.5131541142658  dE = -8.8107299e-11  S^2 = 0.0000000
               |grad[o]|=3.46e-06  |ddm|=1.68e-05  |maxRot[o]|=2.09e-05
2-step CASSCF converged in 16 macro (65 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96506513 1.92787019 1.90242017 1.83461645 0.08106129 0.17170011
 0.05932554 0.05794111]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01001   0.00958  -0.00569   0.00000   0.00000
  0 C 2s       0.60769   0.64161  -0.36054  -0.00000   0.00000
  0 C 3s      -0.02394   0.01781  -0.04989  -0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69498
  0 C 2py     -0.00000   0.00000  -0.00000   0.70448  -0.00000
  0 C 2pz      0.35831  -0.29606   0.60517  -0.00000  -0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.05520
  0 C 3py     -0.00000   0.00000   0.00000   0.04615   0.00000
  0 C 3pz     -0.02386  -0.00271   0.00109  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03981  -0.00000
  0 C 3dz^2    0.03287  -0.01476   0.03469  -0.00000  -0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.11816
 0 C 3dx2-y2  -0.00145   0.00725  -0.00749   0.00000  -0.00000
  1 C 1s       0.01001  -0.00958  -0.00569   0.00000   0.00000
  1 C 2s       0.60769  -0.64161  -0.36054   0.00000   0.00000
  1 C 3s      -0.02394  -0.01781  -0.04989   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69498
  1 C 2py      0.00000  -0.00000   0.00000   0.70448   0.00000
  1 C 2pz     -0.35831  -0.29606  -0.60517  -0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.05520
  1 C 3py      0.00000  -0.00000  -0.00000   0.04615   0.00000
  1 C 3pz      0.02386  -0.00271  -0.00109  -0.00000   0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03981  -0.00000
  1 C 3dz^2    0.03287   0.01476   0.03469   0.00000   0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11816
 1 C 3dx2-y2  -0.00145  -0.00725  -0.00749   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00052
  0 C 2s      -0.00000   0.00000   0.29408
  0 C 3s      -0.00000  -0.00000   0.03931
  0 C 2px      0.00000   0.69713  -0.00000
  0 C 2py      0.70661   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.63885
  0 C 3px      0.00000   0.00311  -0.00000
  0 C 3py     -0.02293   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.05440
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01349   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.01292
  0 C 3dxz     0.00000  -0.11834  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02684
  1 C 1s       0.00000   0.00000   0.00052
  1 C 2s       0.00000   0.00000  -0.29408
  1 C 3s       0.00000   0.00000  -0.03931
  1 C 2px     -0.00000  -0.69713   0.00000
  1 C 2py     -0.70661  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.63885
  1 C 3px     -0.00000  -0.00311   0.00000
  1 C 3py      0.02293  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.05440
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01349   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.01292
  1 C 3dxz     0.00000  -0.11834  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02684
<CAS-nat-orb|mo-hf>  3  3    0.98958164
<CAS-nat-orb|mo-hf>  4  4    0.99975150
<CAS-nat-orb|mo-hf>  5  5    0.98959418
<CAS-nat-orb|mo-hf>  6  6    0.99925429
<CAS-nat-orb|mo-hf>  7  7    0.94209803
<CAS-nat-orb|mo-hf>  8  8    0.97102423
<CAS-nat-orb|mo-hf>  9  9    0.95858984
<CAS-nat-orb|mo-hf>  10  10    0.86001481
<CAS-nat-orb|mo-hf>  10  11   -0.48380374
CASSCF energy = -75.5131541142658
CASCI E = -75.5131541142658  E(CI) = -15.718930760124  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.030
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.040
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.040
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.040
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.335
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.109
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.667

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.030
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.624
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.729
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.979
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.015
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.015
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      3.428
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.09
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.04
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.244 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.157 | Tfpread = 0.000 | Tfpwrite = 0.155 | data = 73.2 MB | cpsd = 55.2 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.890 | E =     -75.6067473459 | DW = 1.45e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.212 | E =     -75.6290298176 | DE = -2.23e-02 | DW = 5.88e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.983 | E =     -75.6295802809 | DE = -5.50e-04 | DW = 1.59e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.774 | E =     -75.6300937105 | DE = -5.13e-04 | DW = 7.06e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.453 | E =     -75.6301372189 | DE = -4.35e-05 | DW = 1.58e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.259 | E =     -75.6302021051 | DE = -6.49e-05 | DW = 7.28e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.884 | E =     -75.6302394874 | DE = -3.74e-05 | DW = 1.61e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     11.682 | E =     -75.6302774667 | DE = -3.80e-05 | DW = 7.48e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.302 | E =     -75.6315242841 | DE = -1.25e-03 | DW = 1.51e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     19.702 | E =     -75.6319532665 | DE = -4.29e-04 | DW = 2.27e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     22.455 | E =     -75.6320667538 | DE = -1.13e-04 | DW = 3.94e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     25.247 | E =     -75.6320959844 | DE = -2.92e-05 | DW = 2.64e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.902 | E =     -75.6320980076 | DE = -2.02e-06 | DW = 3.94e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.751 | E =     -75.6321001956 | DE = -2.19e-06 | DW = 2.65e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.515 | E =     -75.6321026328 | DE = -2.44e-06 | DW = 3.95e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.729 | E =     -75.6321038741 | DE = -1.24e-06 | DW = 2.66e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     45.955 | E =     -75.6322388585 | DE = -1.35e-04 | DW = 2.73e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     58.877 | E =     -75.6322777561 | DE = -3.89e-05 | DW = 1.89e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     69.723 | E =     -75.6322828703 | DE = -5.11e-06 | DW = 4.45e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     80.529 | E =     -75.6322838627 | DE = -9.92e-07 | DW = 1.91e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     89.642 | E =     -75.6322845488 | DE = -6.86e-07 | DW = 4.46e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    100.704 | E =     -75.6322846144 | DE = -6.56e-08 | DW = 1.82e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.215 | E =     -75.6322860297 | DE = -1.42e-06 | DW = 4.48e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    123.098 | E =     -75.6322861742 | DE = -1.45e-07 | DW = 1.84e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    143.060 | E =     -75.6322944112 | DE = -8.24e-06 | DW = 2.25e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    171.793 | E =     -75.6322971597 | DE = -2.75e-06 | DW = 9.20e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    196.655 | E =     -75.6322975950 | DE = -4.35e-07 | DW = 2.14e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    222.865 | E =     -75.6322980340 | DE = -4.39e-07 | DW = 9.07e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    248.302 | E =     -75.6322983708 | DE = -3.37e-07 | DW = 2.22e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    278.577 | E =     -75.6322987250 | DE = -3.54e-07 | DW = 9.08e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    306.609 | E =     -75.6322989572 | DE = -2.32e-07 | DW = 2.21e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    341.106 | E =     -75.6322993167 | DE = -3.59e-07 | DW = 9.07e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    586.028 | E =     -75.6323119544 | DE = -1.26e-05 | DW = 4.97e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    714.969 | E =     -75.6323119545 | DE = -6.51e-11 | DW = 4.98e-08

E(MRCI) = -75.63231195447253  E_corr = -0.1191578402066824
Time cost =    863.484
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 19:58:32 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.746284796036 AA    0.000000000000   0.000000000000   3.300000000000 Bohr   0.0

nuclear repulsion = 10.9090909090909
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.65]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    262832.76


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp1pc6ksi2
max_memory 4000 MB (current use 5135 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8422560677929

WARN: Singularity detected in overlap matrix (condition number =  141). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.131475269334873  LUMO (B3u) = -0.131475269334873

WARN: B2u HOMO -0.131475269334873 > system LUMO -0.131475269334873

cycle= 1 E= -75.3268751185368  delta_E= -0.485  |g|= 0.254  |ddm|= 1.52
HOMO (B2u) = -0.392977692990135  LUMO (B3u) = -0.0727206501017197
cycle= 2 E= -75.3522841088372  delta_E= -0.0254  |g|= 0.0519  |ddm|= 0.352
HOMO (B2u) = -0.355147584178281  LUMO (B3u) = -0.0300222920891322
cycle= 3 E= -75.3537386656222  delta_E= -0.00145  |g|= 0.0182  |ddm|= 0.0689
HOMO (B2u) = -0.359671017046592  LUMO (B3u) = -0.0344578300630369
cycle= 4 E= -75.3539592586542  delta_E= -0.000221  |g|= 0.000688  |ddm|= 0.0377
HOMO (B2u) = -0.359764894042611  LUMO (B3u) = -0.0346976899212323
cycle= 5 E= -75.3539594435199  delta_E= -1.85e-07  |g|= 9.37e-05  |ddm|= 0.00109
HOMO (B2u) = -0.359730880125603  LUMO (B3u) = -0.0346640305640357
cycle= 6 E= -75.3539594484633  delta_E= -4.94e-09  |g|= 1.51e-05  |ddm|= 0.000157
HOMO (B2u) = -0.359729026578329  LUMO (B3u) = -0.0346652386509433
cycle= 7 E= -75.3539594486084  delta_E= -1.45e-10  |g|= 1.94e-06  |ddm|= 3.44e-05
HOMO (B2u) = -0.359728331016699  LUMO (B3u) = -0.0346649076942356
cycle= 8 E= -75.3539594486108  delta_E= -2.47e-12  |g|= 1.14e-07  |ddm|= 4.16e-06
HOMO (B2u) = -0.359728345182822  LUMO (B3u) = -0.0346649176989655
cycle= 9 E= -75.3539594486108  delta_E=    0  |g|= 6.92e-09  |ddm|= 2.29e-07
HOMO (B2u) = -0.359728345811295  LUMO (B3u) = -0.0346649199293697
cycle= 10 E= -75.3539594486108  delta_E=    0  |g|= 4.84e-09  |ddm|= 7.44e-09
HOMO (B2u) = -0.359728345628422  LUMO (B3u) = -0.0346649197213792
cycle= 11 E= -75.3539594486108  delta_E=    0  |g|= 3.95e-09  |ddm|= 4.04e-09
HOMO (B2u) = -0.359728344324567  LUMO (B3u) = -0.0346649183507518
cycle= 12 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 3.62e-09  |ddm|= 1.85e-09
HOMO (B2u) = -0.359728344700651  LUMO (B3u) = -0.0346649187076226
cycle= 13 E= -75.3539594486109  delta_E= -5.68e-14  |g|= 3.21e-09  |ddm|= 9.28e-10
HOMO (B2u) = -0.359728344323037  LUMO (B3u) = -0.0346649183510421
cycle= 14 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 3.93e-10  |ddm|= 4.6e-09
HOMO (B2u) = -0.359728344496119  LUMO (B3u) = -0.0346649184551793
cycle= 15 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 5.5e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.359728344402529  LUMO (B3u) = -0.0346649184609871
cycle= 16 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 6.5e-10  |ddm|= 1.26e-09
HOMO (B2u) = -0.35972834444523  LUMO (B3u) = -0.0346649184557793
cycle= 17 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 6.39e-10  |ddm|= 8.11e-10
HOMO (B2u) = -0.359728344433413  LUMO (B3u) = -0.0346649184359331
cycle= 18 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 4.57e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.359728344445349  LUMO (B3u) = -0.0346649184497288
cycle= 19 E= -75.3539594486108  delta_E= -4.26e-14  |g|= 3.95e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.359728344459183  LUMO (B3u) = -0.0346649184644592
cycle= 20 E= -75.3539594486108  delta_E= 1.42e-14  |g|= 3.17e-10  |ddm|= 1.3e-10
HOMO (B2u) = -0.359728344458614  LUMO (B3u) = -0.034664918461953
cycle= 21 E= -75.3539594486108  delta_E= -2.84e-14  |g|= 2.19e-10  |ddm|= 1.63e-10
HOMO (B2u) = -0.359728344461003  LUMO (B3u) = -0.0346649184640458
cycle= 22 E= -75.3539594486109  delta_E= -8.53e-14  |g|= 1.27e-10  |ddm|= 1.59e-10
HOMO (B2u) = -0.359728344460419  LUMO (B3u) = -0.0346649184621536
cycle= 23 E= -75.3539594486109  delta_E= 1.42e-14  |g|= 1.24e-10  |ddm|= 1.77e-11
HOMO (B2u) = -0.359728344456517  LUMO (B3u) = -0.0346649184600727
cycle= 24 E= -75.3539594486109  delta_E= 4.26e-14  |g|= 1.11e-10  |ddm|= 4.7e-11
HOMO (B2u) = -0.359728344457844  LUMO (B3u) = -0.0346649184591156
cycle= 25 E= -75.3539594486108  delta_E= 5.68e-14  |g|= 9.05e-11  |ddm|= 4.76e-11
HOMO (B2u) = -0.359728344457601  LUMO (B3u) = -0.0346649184583866
cycle= 26 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 7.26e-11  |ddm|= 3.22e-11
HOMO (B2u) = -0.359728344457093  LUMO (B3u) = -0.0346649184576503
cycle= 27 E= -75.3539594486108  delta_E= -1.42e-14  |g|= 6.1e-11  |ddm|= 2.14e-11
HOMO (B2u) = -0.359728344456736  LUMO (B3u) = -0.0346649184570218
cycle= 28 E= -75.3539594486109  delta_E= -5.68e-14  |g|= 4.86e-11  |ddm|= 2.39e-11
HOMO (B2u) = -0.359728344456624  LUMO (B3u) = -0.0346649184566529
cycle= 29 E= -75.3539594486109  delta_E= 2.84e-14  |g|= 3.78e-11  |ddm|= 2.12e-11
HOMO (B2u) = -0.359728344456491  LUMO (B3u) = -0.0346649184563495
cycle= 30 E= -75.3539594486108  delta_E= 2.84e-14  |g|= 3.04e-11  |ddm|= 1.52e-11
HOMO (B2u) = -0.359728344456458  LUMO (B3u) = -0.0346649184561895
cycle= 31 E= -75.3539594486107  delta_E= 1.71e-13  |g|= 2.69e-11  |ddm|= 8.54e-12
HOMO (B2u) = -0.359728344456354  LUMO (B3u) = -0.0346649184559984
cycle= 32 E= -75.3539594486106  delta_E= 9.95e-14  |g|= 2.31e-11  |ddm|= 8.76e-12
HOMO (B2u) = -0.359728344456366  LUMO (B3u) = -0.0346649184558377
cycle= 33 E= -75.3539594486103  delta_E= 2.13e-13  |g|= 1.99e-11  |ddm|= 7.83e-12
HOMO (B2u) = -0.359728344456301  LUMO (B3u) = -0.0346649184556869
cycle= 34 E= -75.3539594486099  delta_E= 4.83e-13  |g|= 1.75e-11  |ddm|= 6.31e-12
HOMO (B2u) = -0.359728344456219  LUMO (B3u) = -0.0346649184555366
cycle= 35 E= -75.3539594486094  delta_E= 4.55e-13  |g|= 1.59e-11  |ddm|= 5.34e-12
HOMO (B2u) = -0.359728344456119  LUMO (B3u) = -0.0346649184553749
cycle= 36 E= -75.3539594486089  delta_E= 5.4e-13  |g|= 1.44e-11  |ddm|= 5.05e-12
HOMO (B2u) = -0.359728344456005  LUMO (B3u) = -0.0346649184552067
cycle= 37 E= -75.3539594486084  delta_E= 4.83e-13  |g|= 1.33e-11  |ddm|= 4.29e-12
HOMO (B2u) = -0.35972834445587  LUMO (B3u) = -0.0346649184550283
cycle= 38 E= -75.3539594486077  delta_E= 6.54e-13  |g|= 1.27e-11  |ddm|= 3.76e-12
HOMO (B2u) = -0.359728344455712  LUMO (B3u) = -0.0346649184548307
cycle= 39 E= -75.3539594486072  delta_E= 4.83e-13  |g|= 1.16e-11  |ddm|= 4e-12
HOMO (B2u) = -0.359728344455543  LUMO (B3u) = -0.0346649184546254
cycle= 40 E= -75.3539594486068  delta_E= 3.98e-13  |g|= 9.9e-12  |ddm|= 4.18e-12
HOMO (B2u) = -0.359728344455365  LUMO (B3u) = -0.0346649184544084
cycle= 41 E= -75.3539594486066  delta_E= 2.56e-13  |g|= 8.28e-12  |ddm|= 4.23e-12
HOMO (B2u) = -0.359728344455175  LUMO (B3u) = -0.0346649184541828
cycle= 42 E= -75.3539594486063  delta_E= 2.98e-13  |g|= 7.36e-12  |ddm|= 3.49e-12
HOMO (B2u) = -0.359728344454991  LUMO (B3u) = -0.034664918453961
cycle= 43 E= -75.3539594486061  delta_E= 1.85e-13  |g|= 6.55e-12  |ddm|= 3.45e-12
HOMO (B2u) = -0.359728344454816  LUMO (B3u) = -0.0346649184537467
cycle= 44 E= -75.3539594486057  delta_E= 4.55e-13  |g|= 6.28e-12  |ddm|= 2.67e-12
HOMO (B2u) = -0.359728344454635  LUMO (B3u) = -0.0346649184535258
cycle= 45 E= -75.3539594486054  delta_E= 2.27e-13  |g|= 5.83e-12  |ddm|= 3.11e-12
HOMO (B2u) = -0.359728344454466  LUMO (B3u) = -0.0346649184533132
cycle= 46 E= -75.353959448605  delta_E= 3.84e-13  |g|= 5.52e-12  |ddm|= 3.18e-12
HOMO (B2u) = -0.359728344454309  LUMO (B3u) = -0.0346649184531119
cycle= 47 E= -75.3539594486046  delta_E= 4.55e-13  |g|= 5.33e-12  |ddm|= 2.7e-12
HOMO (B2u) = -0.359728344454148  LUMO (B3u) = -0.0346649184529048
cycle= 48 E= -75.353959448604  delta_E= 5.68e-13  |g|= 5.09e-12  |ddm|= 2.76e-12
HOMO (B2u) = -0.359728344453985  LUMO (B3u) = -0.0346649184526947
cycle= 49 E= -75.3539594486037  delta_E= 2.98e-13  |g|= 5.06e-12  |ddm|= 3.01e-12
HOMO (B2u) = -0.35972834445382  LUMO (B3u) = -0.034664918452485
cycle= 50 E= -75.3539594486035  delta_E= 1.99e-13  |g|= 4.36e-12  |ddm|= 3.58e-12
SCF not converged.
SCF energy = -75.3539594486035

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp1pc6ksi2
max_memory 4000 MB (current use 5135 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4605852262859  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4728677550183  dE = -0.012282529  S^2 = 0.0000000
               |grad[o]|=0.0845  |ddm|= 3.83  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4835984582864  dE = -0.010730703  S^2 = 0.0000000
               |grad[o]|=0.0745  |ddm|=0.0627  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4925028379402  dE = -0.0089043797  S^2 = 0.0000000
               |grad[o]|=0.0631  |ddm|=0.0412  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4995495448693  dE = -0.0070467069  S^2 = 0.0000000
               |grad[o]|=0.0512  |ddm|=0.0504  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5045660817126  dE = -0.0050165368  S^2 = 0.0000000
               |grad[o]|=0.0382  |ddm|=0.0583  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5070424086876  dE = -0.002476327  S^2 = 0.0000000
               |grad[o]|=0.0222  |ddm|=0.0398  |maxRot[o]|= 0.06
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5078477488534  dE = -0.00080534017  S^2 = 0.0000000
               |grad[o]|=0.0105  |ddm|=0.0554  |maxRot[o]|= 0.04
macro iter 8 (4 JK  0 micro), CASSCF E = -75.5081673379985  dE = -0.00031958915  S^2 = 0.0000000
               |grad[o]|=0.00584  |ddm|=0.0262  |maxRot[o]|=0.0343
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5082201455236  dE = -5.2807525e-05  S^2 = 0.0000000
               |grad[o]|=0.0024  |ddm|=0.0133  |maxRot[o]|=0.0152
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5082271294189  dE = -6.9838953e-06  S^2 = 0.0000000
               |grad[o]|=0.000905  |ddm|=0.0045  |maxRot[o]|=0.00571
macro iter 11 (3 JK  0 micro), CASSCF E = -75.508227984407  dE = -8.5498814e-07  S^2 = 0.0000000
               |grad[o]|=0.00032  |ddm|=0.00156  |maxRot[o]|=0.00201
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5082280860976  dE = -1.0169057e-07  S^2 = 0.0000000
               |grad[o]|=0.000113  |ddm|=0.000537  |maxRot[o]|=0.000697
macro iter 13 (3 JK  0 micro), CASSCF E = -75.5082280980434  dE = -1.1945801e-08  S^2 = 0.0000000
               |grad[o]|=3.94e-05  |ddm|=0.000185  |maxRot[o]|=0.000241
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5082280994333  dE = -1.3898784e-09  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=6.38e-05  |maxRot[o]|=8.29e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5082280995928  dE = -1.5951684e-10  S^2 = 0.0000000
               |grad[o]|=4.72e-06  |ddm|=2.19e-05  |maxRot[o]|=2.85e-05
macro iter 16 (2 JK  0 micro), CASSCF E = -75.508228099607  dE = -1.4210855e-11  S^2 = 0.0000000
               |grad[o]|=1.58e-06  |ddm|=6.98e-06  |maxRot[o]|=9.45e-06
2-step CASSCF converged in 16 macro (64 JK 16 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96387359 1.92858696 1.90144123 1.82466896 0.07878277 0.18160433
 0.05902031 0.06202185]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01031   0.00970  -0.00544   0.00000   0.00000
  0 C 2s       0.61830   0.64554  -0.34208   0.00000  -0.00000
  0 C 3s      -0.02094   0.01752  -0.04828   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69463
  0 C 2py      0.00000  -0.00000   0.00000   0.70445   0.00000
  0 C 2pz      0.34017  -0.28744   0.61591   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.05672
  0 C 3py     -0.00000   0.00000   0.00000   0.04759  -0.00000
  0 C 3pz     -0.02200  -0.00251   0.00227   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.03863  -0.00000
  0 C 3dz^2    0.03108  -0.01437   0.03487   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.11945
 0 C 3dx2-y2  -0.00117   0.00712  -0.00747   0.00000  -0.00000
  1 C 1s       0.01031  -0.00970  -0.00544   0.00000   0.00000
  1 C 2s       0.61830  -0.64554  -0.34208   0.00000   0.00000
  1 C 3s      -0.02094  -0.01752  -0.04828  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69463
  1 C 2py      0.00000  -0.00000  -0.00000   0.70445   0.00000
  1 C 2pz     -0.34017  -0.28744  -0.61591   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.05672
  1 C 3py     -0.00000   0.00000  -0.00000   0.04759  -0.00000
  1 C 3pz      0.02200  -0.00251  -0.00227   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.03863   0.00000
  1 C 3dz^2    0.03108   0.01437   0.03487  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.11945
 1 C 3dx2-y2  -0.00117  -0.00712  -0.00747   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00049
  0 C 2s       0.00000  -0.00000   0.28563
  0 C 3s       0.00000  -0.00000   0.03833
  0 C 2px     -0.00000   0.69726  -0.00000
  0 C 2py      0.70668  -0.00000   0.00000
  0 C 2pz      0.00000  -0.00000   0.64303
  0 C 3px     -0.00000   0.00091  -0.00000
  0 C 3py     -0.02081  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.05165
  0 C 3dxy     0.00000   0.00000   0.00000
  0 C 3dyz     0.01306  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.01176
  0 C 3dxz    -0.00000  -0.11759  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.02562
  1 C 1s       0.00000   0.00000   0.00049
  1 C 2s      -0.00000   0.00000  -0.28563
  1 C 3s      -0.00000   0.00000  -0.03833
  1 C 2px      0.00000  -0.69726  -0.00000
  1 C 2py     -0.70668   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.64303
  1 C 3px      0.00000  -0.00091   0.00000
  1 C 3py      0.02081   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.05165
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01306  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.01176
  1 C 3dxz    -0.00000  -0.11759  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.02562
<CAS-nat-orb|mo-hf>  3  3    0.99201757
<CAS-nat-orb|mo-hf>  4  4    0.99974451
<CAS-nat-orb|mo-hf>  5  5    0.99203281
<CAS-nat-orb|mo-hf>  6  6    0.99920694
<CAS-nat-orb|mo-hf>  7  7    0.94066257
<CAS-nat-orb|mo-hf>  8  8    0.97275729
<CAS-nat-orb|mo-hf>  9  9    0.95891046
<CAS-nat-orb|mo-hf>  10  10    0.87431675
<CAS-nat-orb|mo-hf>  10  11   -0.46069474
CASSCF energy = -75.508228099607
CASCI E = -75.508228099607  E(CI) = -15.6395664158292  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.042
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.339
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.099
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.664

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.028
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.354
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.011
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.009
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.014
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.454
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.08
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.249 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.166 | Tfpread = 0.000 | Tfpwrite = 0.163 | data = 73.2 MB | cpsd = 55.2 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.751 | E =     -75.6016171465 | DW = 1.47e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.050 | E =     -75.6242638254 | DE = -2.26e-02 | DW = 5.88e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.082 | E =     -75.6247867601 | DE = -5.23e-04 | DW = 1.60e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.855 | E =     -75.6252804942 | DE = -4.94e-04 | DW = 7.25e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.667 | E =     -75.6253182859 | DE = -3.78e-05 | DW = 1.59e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.425 | E =     -75.6253769741 | DE = -5.87e-05 | DW = 7.53e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.217 | E =     -75.6254104767 | DE = -3.35e-05 | DW = 1.63e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     24.462 | E =     -75.6254471801 | DE = -3.67e-05 | DW = 7.73e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.135 | E =     -75.6266719959 | DE = -1.22e-03 | DW = 1.51e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.615 | E =     -75.6271211273 | DE = -4.49e-04 | DW = 2.29e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     46.329 | E =     -75.6272394582 | DE = -1.18e-04 | DW = 3.91e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     50.959 | E =     -75.6272733466 | DE = -3.39e-05 | DW = 2.65e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     54.326 | E =     -75.6272777113 | DE = -4.36e-06 | DW = 3.93e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     58.109 | E =     -75.6272808892 | DE = -3.18e-06 | DW = 2.66e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     62.273 | E =     -75.6272843083 | DE = -3.42e-06 | DW = 3.93e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     66.696 | E =     -75.6272863352 | DE = -2.03e-06 | DW = 2.67e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     75.481 | E =     -75.6274200453 | DE = -1.34e-04 | DW = 2.70e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.436 | E =     -75.6274592062 | DE = -3.92e-05 | DW = 1.90e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     99.502 | E =     -75.6274642009 | DE = -4.99e-06 | DW = 4.41e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.737 | E =     -75.6274648635 | DE = -6.63e-07 | DW = 1.84e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    122.188 | E =     -75.6274666100 | DE = -1.75e-06 | DW = 4.48e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    133.594 | E =     -75.6274667239 | DE = -1.14e-07 | DW = 1.85e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    145.138 | E =     -75.6274681453 | DE = -1.42e-06 | DW = 4.47e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    156.334 | E =     -75.6274684297 | DE = -2.84e-07 | DW = 1.87e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    177.855 | E =     -75.6274765937 | DE = -8.16e-06 | DW = 2.22e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    205.838 | E =     -75.6274795109 | DE = -2.92e-06 | DW = 9.46e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    231.419 | E =     -75.6274800013 | DE = -4.90e-07 | DW = 2.12e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    259.166 | E =     -75.6274805039 | DE = -5.03e-07 | DW = 9.30e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    284.583 | E =     -75.6274808966 | DE = -3.93e-07 | DW = 2.18e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    312.694 | E =     -75.6274813296 | DE = -4.33e-07 | DW = 9.32e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    337.801 | E =     -75.6274816497 | DE = -3.20e-07 | DW = 2.18e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    366.406 | E =     -75.6274820671 | DE = -4.17e-07 | DW = 9.30e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    558.272 | E =     -75.6274964078 | DE = -1.43e-05 | DW = 4.94e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    684.624 | E =     -75.6274964080 | DE = -1.27e-10 | DW = 4.95e-08

E(MRCI) = -75.62749640797583  E_corr = -0.1192683083688166
Time cost =    874.337
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:13:06 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.772743656582 AA    0.000000000000   0.000000000000   3.350000000000 Bohr   0.0

nuclear repulsion = 10.7462686567164
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.675]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    275907.50


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpptr9bjzn
max_memory 4000 MB (current use 5094 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8226756263582

WARN: Singularity detected in overlap matrix (condition number =  131). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.127455322759626  LUMO (B3u) = -0.127455322759626

WARN: B2u HOMO -0.127455322759626 > system LUMO -0.127455322759626

cycle= 1 E= -75.3190207821596  delta_E= -0.496  |g|= 0.252  |ddm|= 1.51
HOMO (B2u) = -0.38827677967466  LUMO (B3u) = -0.069932874908027
cycle= 2 E= -75.3440245529482  delta_E= -0.025  |g|= 0.0513  |ddm|= 0.351
HOMO (B2u) = -0.351016713810031  LUMO (B3u) = -0.0278350417390002
cycle= 3 E= -75.3454675220222  delta_E= -0.00144  |g|= 0.0181  |ddm|= 0.0681
HOMO (B2u) = -0.355529260677995  LUMO (B3u) = -0.0322458808802121
cycle= 4 E= -75.3456894433558  delta_E= -0.000222  |g|= 0.000681  |ddm|= 0.0375
HOMO (B2u) = -0.355644927845468  LUMO (B3u) = -0.0325087452095936
cycle= 5 E= -75.3456896230235  delta_E= -1.8e-07  |g|= 9.78e-05  |ddm|= 0.00103
HOMO (B2u) = -0.355609613190063  LUMO (B3u) = -0.0324745833916086
cycle= 6 E= -75.3456896284285  delta_E= -5.41e-09  |g|= 1.56e-05  |ddm|= 0.000165
HOMO (B2u) = -0.355607628482653  LUMO (B3u) = -0.0324756124305532
cycle= 7 E= -75.3456896285829  delta_E= -1.54e-10  |g|= 1.94e-06  |ddm|= 3.47e-05
HOMO (B2u) = -0.355606961354879  LUMO (B3u) = -0.0324753268421351
cycle= 8 E= -75.3456896285854  delta_E= -2.53e-12  |g|= 1.17e-07  |ddm|= 4.13e-06
HOMO (B2u) = -0.355606972649756  LUMO (B3u) = -0.0324753336780499
cycle= 9 E= -75.3456896285854  delta_E=    0  |g|= 7.02e-09  |ddm|= 2.39e-07
HOMO (B2u) = -0.355606973127071  LUMO (B3u) = -0.0324753357914219
cycle= 10 E= -75.3456896285854  delta_E= -2.84e-14  |g|= 5.11e-09  |ddm|= 7.54e-09
HOMO (B2u) = -0.355606972919596  LUMO (B3u) = -0.0324753355623412
cycle= 11 E= -75.3456896285854  delta_E= 5.68e-14  |g|= 4.03e-09  |ddm|= 4.14e-09
HOMO (B2u) = -0.355606971599852  LUMO (B3u) = -0.0324753341761098
cycle= 12 E= -75.3456896285854  delta_E=    0  |g|= 3.67e-09  |ddm|= 1.89e-09
HOMO (B2u) = -0.355606971984099  LUMO (B3u) = -0.0324753345459313
cycle= 13 E= -75.3456896285853  delta_E= 2.84e-14  |g|= 3.28e-09  |ddm|= 1.07e-09
HOMO (B2u) = -0.355606971978541  LUMO (B3u) = -0.0324753345652423
cycle= 14 E= -75.3456896285853  delta_E=    0  |g|= 3.08e-09  |ddm|= 7.32e-10
HOMO (B2u) = -0.35560697176414  LUMO (B3u) = -0.0324753342956816
cycle= 15 E= -75.3456896285854  delta_E= -5.68e-14  |g|= 7.16e-10  |ddm|= 4.68e-09
HOMO (B2u) = -0.355606971674219  LUMO (B3u) = -0.0324753342946617
cycle= 16 E= -75.3456896285853  delta_E= 5.68e-14  |g|= 7.7e-10  |ddm|= 1.3e-09
HOMO (B2u) = -0.355606971704629  LUMO (B3u) = -0.0324753342894964
cycle= 17 E= -75.3456896285854  delta_E= -8.53e-14  |g|= 7.69e-10  |ddm|= 6.14e-10
HOMO (B2u) = -0.355606971687433  LUMO (B3u) = -0.0324753342673643
cycle= 18 E= -75.3456896285853  delta_E= 1.42e-13  |g|= 5.86e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.35560697169639  LUMO (B3u) = -0.0324753342793525
cycle= 19 E= -75.3456896285855  delta_E= -1.71e-13  |g|= 5.26e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.355606971707022  LUMO (B3u) = -0.032475334292066
cycle= 20 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 4.51e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.355606971703299  LUMO (B3u) = -0.0324753342875934
cycle= 21 E= -75.3456896285855  delta_E= -2.84e-14  |g|= 3.58e-10  |ddm|= 1.74e-10
HOMO (B2u) = -0.355606971702999  LUMO (B3u) = -0.0324753342880864
cycle= 22 E= -75.3456896285854  delta_E= 8.53e-14  |g|= 2.68e-10  |ddm|= 1.69e-10
HOMO (B2u) = -0.355606971703309  LUMO (B3u) = -0.0324753342883293
cycle= 23 E= -75.3456896285855  delta_E= -8.53e-14  |g|= 1.73e-10  |ddm|= 1.82e-10
HOMO (B2u) = -0.35560697169846  LUMO (B3u) = -0.0324753342857336
cycle= 24 E= -75.3456896285855  delta_E=    0  |g|= 1.54e-10  |ddm|= 5.83e-11
HOMO (B2u) = -0.355606971698413  LUMO (B3u) = -0.0324753342842443
cycle= 25 E= -75.3456896285854  delta_E= 2.84e-14  |g|= 1.3e-10  |ddm|= 5.11e-11
HOMO (B2u) = -0.3556069716972  LUMO (B3u) = -0.032475334282931
cycle= 26 E= -75.3456896285855  delta_E= -2.84e-14  |g|= 1.08e-10  |ddm|= 4.42e-11
HOMO (B2u) = -0.355606971695944  LUMO (B3u) = -0.0324753342817222
cycle= 27 E= -75.3456896285855  delta_E=    0  |g|= 9.28e-11  |ddm|= 3.29e-11
HOMO (B2u) = -0.355606971692845  LUMO (B3u) = -0.0324753342784689
Extra cycle  E= -75.3456896285855  delta_E=    0  |g|= 3.46e-11  |ddm|= 1.21e-10
converged SCF energy = -75.3456896285855

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpptr9bjzn
max_memory 4000 MB (current use 5094 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4564838553942  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4691762964237  dE = -0.012692441  S^2 = 0.0000000
               |grad[o]|=0.0865  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4801149844246  dE = -0.010938688  S^2 = 0.0000000
               |grad[o]|=0.0752  |ddm|=0.0668  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4889721314989  dE = -0.0088571471  S^2 = 0.0000000
               |grad[o]|=0.0624  |ddm|=0.0407  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4957864339028  dE = -0.0068143024  S^2 = 0.0000000
               |grad[o]|=0.0491  |ddm|=0.0472  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.5005650305612  dE = -0.0047785967  S^2 = 0.0000000
               |grad[o]|=0.035  |ddm|=0.0607  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.5027278757617  dE = -0.0021628452  S^2 = 0.0000000
               |grad[o]|=0.0183  |ddm|=0.0448  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.5031956536227  dE = -0.00046777786  S^2 = 0.0000000
               |grad[o]|=0.0072  |ddm|=0.0469  |maxRot[o]|= 0.04
macro iter 8 (3 JK  0 micro), CASSCF E = -75.503286864624  dE = -9.1211001e-05  S^2 = 0.0000000
               |grad[o]|=0.00309  |ddm|=0.0149  |maxRot[o]|= 0.02
macro iter 9 (3 JK  0 micro), CASSCF E = -75.5032983068406  dE = -1.1442217e-05  S^2 = 0.0000000
               |grad[o]|=0.00115  |ddm|=0.0055  |maxRot[o]|=0.00736
macro iter 10 (3 JK  0 micro), CASSCF E = -75.5032996034576  dE = -1.296617e-06  S^2 = 0.0000000
               |grad[o]|=0.000397  |ddm|=0.00185  |maxRot[o]|=0.0025
macro iter 11 (3 JK  0 micro), CASSCF E = -75.5032997460358  dE = -1.4257814e-07  S^2 = 0.0000000
               |grad[o]|=0.000133  |ddm|=0.000615  |maxRot[o]|=0.000834
macro iter 12 (3 JK  0 micro), CASSCF E = -75.5032997615435  dE = -1.5507695e-08  S^2 = 0.0000000
               |grad[o]|=4.5e-05  |ddm|=0.000203  |maxRot[o]|=0.000276
macro iter 13 (2 JK  0 micro), CASSCF E = -75.5032997632064  dE = -1.66294e-09  S^2 = 0.0000000
               |grad[o]|=1.49e-05  |ddm|=6.63e-05  |maxRot[o]|=9.07e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.5032997633895  dE = -1.8309265e-10  S^2 = 0.0000000
               |grad[o]|=4.98e-06  |ddm|=2.24e-05  |maxRot[o]|=2.98e-05
macro iter 15 (2 JK  0 micro), CASSCF E = -75.5032997634143  dE = -2.4826363e-11  S^2 = 0.0000000
               |grad[o]|=1.67e-06  |ddm|=7.45e-06  |maxRot[o]|=1.02e-05
2-step CASSCF converged in 15 macro (60 JK 15 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96274302 1.92928248 1.89992237 1.81420276 0.07676462 0.19201087
 0.05872204 0.06635183]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01059   0.00982  -0.00515   0.00000   0.00000
  0 C 2s       0.62877   0.64927  -0.32247   0.00000   0.00000
  0 C 3s      -0.01802   0.01723  -0.04662  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69435
  0 C 2py     -0.00000   0.00000  -0.00000   0.70442   0.00000
  0 C 2pz      0.32084  -0.27893   0.62651  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000  -0.00000  -0.05813
  0 C 3py     -0.00000   0.00000  -0.00000   0.04890  -0.00000
  0 C 3pz     -0.02026  -0.00235   0.00351  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.03743  -0.00000
  0 C 3dz^2    0.02926  -0.01397   0.03504  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000  -0.00000  -0.12042
 0 C 3dx2-y2  -0.00088   0.00700  -0.00745  -0.00000   0.00000
  1 C 1s       0.01059  -0.00982  -0.00515   0.00000   0.00000
  1 C 2s       0.62877  -0.64927  -0.32247   0.00000  -0.00000
  1 C 3s      -0.01802  -0.01723  -0.04662   0.00000  -0.00000
  1 C 2px      0.00000   0.00000   0.00000   0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70442   0.00000
  1 C 2pz     -0.32084  -0.27893  -0.62651  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.05813
  1 C 3py      0.00000  -0.00000   0.00000   0.04890  -0.00000
  1 C 3pz      0.02026  -0.00235  -0.00351  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.03743   0.00000
  1 C 3dz^2    0.02926   0.01397   0.03504   0.00000  -0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12042
 1 C 3dx2-y2  -0.00088  -0.00700  -0.00745   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00046
  0 C 2s      -0.00000   0.00000   0.27729
  0 C 3s      -0.00000   0.00000   0.03734
  0 C 2px     -0.00000   0.69739   0.00000
  0 C 2py      0.70675   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.64700
  0 C 3px     -0.00000  -0.00124   0.00000
  0 C 3py     -0.01872   0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.04893
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01263  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.01067
  0 C 3dxz     0.00000  -0.11680   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.02442
  1 C 1s       0.00000   0.00000   0.00046
  1 C 2s      -0.00000  -0.00000  -0.27729
  1 C 3s       0.00000  -0.00000  -0.03734
  1 C 2px     -0.00000  -0.69739  -0.00000
  1 C 2py     -0.70675   0.00000   0.00000
  1 C 2pz     -0.00000   0.00000   0.64700
  1 C 3px      0.00000   0.00124  -0.00000
  1 C 3py      0.01872  -0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04893
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01263  -0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.01067
  1 C 3dxz    -0.00000  -0.11680   0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.02442
<CAS-nat-orb|mo-hf>  3  3    0.99427995
<CAS-nat-orb|mo-hf>  4  4    0.99973720
<CAS-nat-orb|mo-hf>  5  5    0.99429722
<CAS-nat-orb|mo-hf>  6  6    0.99915774
<CAS-nat-orb|mo-hf>  7  7    0.93938548
<CAS-nat-orb|mo-hf>  8  8    0.97438151
<CAS-nat-orb|mo-hf>  9  9    0.95919912
<CAS-nat-orb|mo-hf>  10  10    0.88692940
<CAS-nat-orb|mo-hf>  10  11   -0.43885974
CASSCF energy = -75.5032997634143
CASCI E = -75.5032997634143  E(CI) = -15.5624179292324  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.009

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.033
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.014
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.010
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.076
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.06
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.247 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.150 | Tfpread = 0.000 | Tfpwrite = 0.146 | data = 73.2 MB | cpsd = 55.2 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.188 | E =     -75.5954489026 | DW = 1.55e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.431 | E =     -75.6195006118 | DE = -2.41e-02 | DW = 5.91e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.232 | E =     -75.6200234663 | DE = -5.23e-04 | DW = 1.62e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.146 | E =     -75.6205154838 | DE = -4.92e-04 | DW = 7.37e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.147 | E =     -75.6205473573 | DE = -3.19e-05 | DW = 1.63e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.071 | E =     -75.6205919491 | DE = -4.46e-05 | DW = 7.69e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.973 | E =     -75.6206203237 | DE = -2.84e-05 | DW = 1.66e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.066 | E =     -75.6206576283 | DE = -3.73e-05 | DW = 8.03e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     11.151 | E =     -75.6218564072 | DE = -1.20e-03 | DW = 1.51e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     16.232 | E =     -75.6223164780 | DE = -4.60e-04 | DW = 2.31e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     19.687 | E =     -75.6224392506 | DE = -1.23e-04 | DW = 3.95e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.749 | E =     -75.6224750628 | DE = -3.58e-05 | DW = 2.68e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.956 | E =     -75.6224811807 | DE = -6.12e-06 | DW = 3.96e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.380 | E =     -75.6224847733 | DE = -3.59e-06 | DW = 2.69e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.166 | E =     -75.6224882323 | DE = -3.46e-06 | DW = 3.96e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.674 | E =     -75.6224898920 | DE = -1.66e-06 | DW = 2.69e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     47.644 | E =     -75.6226245778 | DE = -1.35e-04 | DW = 2.71e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     59.387 | E =     -75.6226640569 | DE = -3.95e-05 | DW = 1.92e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     69.207 | E =     -75.6226694175 | DE = -5.36e-06 | DW = 4.41e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     79.394 | E =     -75.6226700819 | DE = -6.64e-07 | DW = 1.85e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     89.673 | E =     -75.6226720149 | DE = -1.93e-06 | DW = 4.48e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    101.642 | E =     -75.6226724460 | DE = -4.31e-07 | DW = 1.89e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    114.123 | E =     -75.6226738858 | DE = -1.44e-06 | DW = 4.47e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    126.799 | E =     -75.6226741162 | DE = -2.30e-07 | DW = 1.87e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    149.690 | E =     -75.6226827959 | DE = -8.68e-06 | DW = 2.31e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    186.710 | E =     -75.6226854328 | DE = -2.64e-06 | DW = 9.52e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    216.163 | E =     -75.6226860374 | DE = -6.05e-07 | DW = 2.12e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    249.770 | E =     -75.6226865686 | DE = -5.31e-07 | DW = 9.56e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    274.419 | E =     -75.6226869800 | DE = -4.11e-07 | DW = 2.17e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    317.860 | E =     -75.6226874566 | DE = -4.77e-07 | DW = 9.55e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    360.220 | E =     -75.6226878106 | DE = -3.54e-07 | DW = 2.17e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    390.615 | E =     -75.6226882701 | DE = -4.59e-07 | DW = 9.52e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    597.690 | E =     -75.6227036065 | DE = -1.53e-05 | DW = 4.97e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    725.129 | E =     -75.6227036067 | DE = -1.45e-10 | DW = 4.98e-08

E(MRCI) = -75.6227036066627  E_corr = -0.1194038432483637
Time cost =    803.729
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:26:30 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.799202517128 AA    0.000000000000   0.000000000000   3.400000000000 Bohr   0.0

nuclear repulsion = 10.5882352941176
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.7]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    289378.97


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmptj1jxabm
max_memory 4000 MB (current use 5092 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.8043126951475

WARN: Singularity detected in overlap matrix (condition number =  122). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.123626145223849  LUMO (B3u) = -0.123626145223849

WARN: B2u HOMO -0.123626145223849 > system LUMO -0.123626145223849

cycle= 1 E= -75.3111334513161  delta_E= -0.507  |g|= 0.249  |ddm|=  1.5
HOMO (B2u) = -0.383724747851056  LUMO (B3u) = -0.067227518857361
cycle= 2 E= -75.3357364104633  delta_E= -0.0246  |g|= 0.0507  |ddm|= 0.351
HOMO (B2u) = -0.34702671827607  LUMO (B3u) = -0.0257227421999451
cycle= 3 E= -75.3371652899279  delta_E= -0.00143  |g|= 0.0181  |ddm|= 0.0673
HOMO (B2u) = -0.351526070447294  LUMO (B3u) = -0.0301077062023778
cycle= 4 E= -75.3373878233177  delta_E= -0.000223  |g|= 0.000675  |ddm|= 0.0372
HOMO (B2u) = -0.351660112314438  LUMO (B3u) = -0.0303898359337106
cycle= 5 E= -75.3373879985294  delta_E= -1.75e-07  |g|= 0.000102  |ddm|= 0.000975
HOMO (B2u) = -0.351623840121636  LUMO (B3u) = -0.0303555719623948
cycle= 6 E= -75.3373880044287  delta_E= -5.9e-09  |g|= 1.61e-05  |ddm|= 0.000173
HOMO (B2u) = -0.351621725064433  LUMO (B3u) = -0.0303564386936762
cycle= 7 E= -75.3373880045928  delta_E= -1.64e-10  |g|= 1.94e-06  |ddm|= 3.52e-05
HOMO (B2u) = -0.351621087023887  LUMO (B3u) = -0.0303561953012176
cycle= 8 E= -75.3373880045952  delta_E= -2.39e-12  |g|= 1.2e-07  |ddm|= 4.09e-06
HOMO (B2u) = -0.351621096028511  LUMO (B3u) = -0.0303561996525376
cycle= 9 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 7.3e-09  |ddm|= 2.5e-07
HOMO (B2u) = -0.35162109633055  LUMO (B3u) = -0.0303562016325223
cycle= 10 E= -75.3373880045952  delta_E=    0  |g|= 5.49e-09  |ddm|= 7.66e-09
HOMO (B2u) = -0.351621096127623  LUMO (B3u) = -0.0303562014173202
cycle= 11 E= -75.3373880045952  delta_E=    0  |g|= 4.19e-09  |ddm|= 4.36e-09
HOMO (B2u) = -0.351621094785318  LUMO (B3u) = -0.0303562000104918
cycle= 12 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 3.79e-09  |ddm|= 1.99e-09
HOMO (B2u) = -0.351621095168739  LUMO (B3u) = -0.0303562003841395
cycle= 13 E= -75.3373880045952  delta_E=    0  |g|= 3.4e-09  |ddm|= 1.23e-09
HOMO (B2u) = -0.351621095129905  LUMO (B3u) = -0.0303562003623645
cycle= 14 E= -75.3373880045952  delta_E=    0  |g|= 3.05e-09  |ddm|= 6.93e-10
HOMO (B2u) = -0.351621094932123  LUMO (B3u) = -0.0303562001383801
cycle= 15 E= -75.3373880045951  delta_E= 5.68e-14  |g|= 7.9e-10  |ddm|= 4.8e-09
HOMO (B2u) = -0.35162109482892  LUMO (B3u) = -0.0303562001339381
cycle= 16 E= -75.3373880045952  delta_E= -5.68e-14  |g|= 8.05e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.351621094865993  LUMO (B3u) = -0.0303562001250379
cycle= 17 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 8.23e-10  |ddm|= 8.24e-10
HOMO (B2u) = -0.351621094843663  LUMO (B3u) = -0.0303562001009839
cycle= 18 E= -75.3373880045953  delta_E= -2.84e-14  |g|= 6.29e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.351621094849333  LUMO (B3u) = -0.0303562001110582
cycle= 19 E= -75.3373880045952  delta_E= 5.68e-14  |g|= 5.5e-10  |ddm|= 3.08e-10
HOMO (B2u) = -0.351621094856912  LUMO (B3u) = -0.030356200122013
cycle= 20 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 4.68e-10  |ddm|= 2.06e-10
HOMO (B2u) = -0.35162109485013  LUMO (B3u) = -0.0303562001156976
cycle= 21 E= -75.3373880045952  delta_E= -2.84e-14  |g|= 3.7e-10  |ddm|= 2.04e-10
HOMO (B2u) = -0.351621094847086  LUMO (B3u) = -0.0303562001145413
cycle= 22 E= -75.3373880045952  delta_E= -1.42e-14  |g|= 2.74e-10  |ddm|= 1.96e-10
HOMO (B2u) = -0.351621094844433  LUMO (B3u) = -0.0303562001131803
cycle= 23 E= -75.3373880045953  delta_E= -4.26e-14  |g|= 1.83e-10  |ddm|= 1.88e-10
HOMO (B2u) = -0.351621094838947  LUMO (B3u) = -0.0303562001103526
cycle= 24 E= -75.3373880045951  delta_E= 1.14e-13  |g|= 1.61e-10  |ddm|= 6.43e-11
HOMO (B2u) = -0.351621094838502  LUMO (B3u) = -0.0303562001084888
cycle= 25 E= -75.3373880045952  delta_E= -8.53e-14  |g|= 1.36e-10  |ddm|= 5.73e-11
HOMO (B2u) = -0.351621094836495  LUMO (B3u) = -0.0303562001067954
cycle= 26 E= -75.3373880045952  delta_E=    0  |g|= 1.12e-10  |ddm|= 5.33e-11
HOMO (B2u) = -0.35162109483467  LUMO (B3u) = -0.0303562001053196
cycle= 27 E= -75.3373880045953  delta_E= -5.68e-14  |g|= 9.56e-11  |ddm|= 4.01e-11
HOMO (B2u) = -0.351621094833176  LUMO (B3u) = -0.0303562001040527
cycle= 28 E= -75.3373880045953  delta_E= 1.42e-14  |g|= 7.83e-11  |ddm|= 3.82e-11
HOMO (B2u) = -0.351621094832077  LUMO (B3u) = -0.0303562001031096
cycle= 29 E= -75.3373880045952  delta_E= 2.84e-14  |g|= 6.25e-11  |ddm|= 3.42e-11
HOMO (B2u) = -0.351621094831106  LUMO (B3u) = -0.0303562001022915
cycle= 30 E= -75.3373880045952  delta_E= 1.42e-14  |g|= 4.97e-11  |ddm|= 2.81e-11
HOMO (B2u) = -0.351621094830381  LUMO (B3u) = -0.0303562001016806
cycle= 31 E= -75.3373880045952  delta_E= 4.26e-14  |g|= 4.01e-11  |ddm|= 2.12e-11
HOMO (B2u) = -0.351621094829874  LUMO (B3u) = -0.0303562001012693
cycle= 32 E= -75.3373880045951  delta_E= 1.14e-13  |g|= 3.43e-11  |ddm|= 1.42e-11
HOMO (B2u) = -0.351621094829538  LUMO (B3u) = -0.0303562001009195
cycle= 33 E= -75.3373880045947  delta_E= 3.55e-13  |g|= 2.93e-11  |ddm|= 1.23e-11
HOMO (B2u) = -0.351621094829189  LUMO (B3u) = -0.0303562001006154
cycle= 34 E= -75.3373880045945  delta_E= 1.99e-13  |g|= 2.52e-11  |ddm|= 1.03e-11
HOMO (B2u) = -0.35162109482889  LUMO (B3u) = -0.0303562001003522
cycle= 35 E= -75.3373880045943  delta_E= 1.85e-13  |g|= 2.19e-11  |ddm|= 8.66e-12
HOMO (B2u) = -0.351621094828627  LUMO (B3u) = -0.030356200100113
cycle= 36 E= -75.3373880045939  delta_E= 3.84e-13  |g|= 1.9e-11  |ddm|= 7.63e-12
HOMO (B2u) = -0.351621094828393  LUMO (B3u) = -0.0303562000998949
cycle= 37 E= -75.3373880045935  delta_E= 4.12e-13  |g|= 1.66e-11  |ddm|= 6.45e-12
HOMO (B2u) = -0.351621094828178  LUMO (B3u) = -0.0303562000996919
cycle= 38 E= -75.3373880045928  delta_E= 7.39e-13  |g|= 1.51e-11  |ddm|= 5.31e-12
HOMO (B2u) = -0.35162109482797  LUMO (B3u) = -0.0303562000994923
cycle= 39 E= -75.3373880045921  delta_E= 6.68e-13  |g|= 1.41e-11  |ddm|= 4.47e-12
HOMO (B2u) = -0.351621094827766  LUMO (B3u) = -0.0303562000992926
cycle= 40 E= -75.3373880045916  delta_E= 5.68e-13  |g|= 1.32e-11  |ddm|= 3.99e-12
HOMO (B2u) = -0.351621094827558  LUMO (B3u) = -0.0303562000990851
cycle= 41 E= -75.337388004591  delta_E= 5.12e-13  |g|= 1.17e-11  |ddm|= 4.11e-12
HOMO (B2u) = -0.351621094827347  LUMO (B3u) = -0.0303562000988725
cycle= 42 E= -75.3373880045907  delta_E= 3.84e-13  |g|= 9.69e-12  |ddm|= 4.29e-12
HOMO (B2u) = -0.351621094827131  LUMO (B3u) = -0.030356200098651
cycle= 43 E= -75.3373880045903  delta_E= 4.12e-13  |g|= 7.9e-12  |ddm|= 4.1e-12
HOMO (B2u) = -0.351621094826914  LUMO (B3u) = -0.0303562000984209
cycle= 44 E= -75.33738800459  delta_E= 2.56e-13  |g|= 6.57e-12  |ddm|= 3.81e-12
HOMO (B2u) = -0.351621094826696  LUMO (B3u) = -0.0303562000981855
cycle= 45 E= -75.3373880045898  delta_E= 2.13e-13  |g|= 5.22e-12  |ddm|= 4.08e-12
HOMO (B2u) = -0.351621094826487  LUMO (B3u) = -0.0303562000979541
cycle= 46 E= -75.3373880045895  delta_E= 2.42e-13  |g|= 4.67e-12  |ddm|= 3.2e-12
HOMO (B2u) = -0.351621094826285  LUMO (B3u) = -0.0303562000977287
cycle= 47 E= -75.3373880045892  delta_E= 3.27e-13  |g|= 4.74e-12  |ddm|= 2.77e-12
HOMO (B2u) = -0.351621094826094  LUMO (B3u) = -0.0303562000975099
cycle= 48 E= -75.3373880045887  delta_E= 5.54e-13  |g|= 5.06e-12  |ddm|= 2.8e-12
HOMO (B2u) = -0.351621094825915  LUMO (B3u) = -0.0303562000973023
cycle= 49 E= -75.3373880045882  delta_E= 4.55e-13  |g|= 5.39e-12  |ddm|= 2.74e-12
HOMO (B2u) = -0.351621094825742  LUMO (B3u) = -0.0303562000971008
cycle= 50 E= -75.3373880045879  delta_E= 3.27e-13  |g|= 5.04e-12  |ddm|= 3.12e-12
SCF not converged.
SCF energy = -75.3373880045879

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmptj1jxabm
max_memory 4000 MB (current use 5092 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4523708352883  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.465482955385  dE = -0.01311212  S^2 = 0.0000000
               |grad[o]|=0.0884  |ddm|= 3.82  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4766240914356  dE = -0.011141136  S^2 = 0.0000000
               |grad[o]|=0.0759  |ddm|=0.0711  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4854152083736  dE = -0.0087911169  S^2 = 0.0000000
               |grad[o]|=0.0617  |ddm|=0.0413  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4919810124989  dE = -0.0065658041  S^2 = 0.0000000
               |grad[o]|=0.0469  |ddm|=0.048  |maxRot[o]|=0.0799
macro iter 5 (6 JK  0 micro), CASSCF E = -75.4965096722633  dE = -0.0045286598  S^2 = 0.0000000
               |grad[o]|=0.0318  |ddm|=0.065  |maxRot[o]|=0.0799
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4980385164093  dE = -0.0015288441  S^2 = 0.0000000
               |grad[o]|=0.0142  |ddm|=0.0476  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4983511494232  dE = -0.00031263301  S^2 = 0.0000000
               |grad[o]|=0.00563  |ddm|=0.0316  |maxRot[o]|=0.0357
macro iter 8 (3 JK  0 micro), CASSCF E = -75.498391787437  dE = -4.0638014e-05  S^2 = 0.0000000
               |grad[o]|=0.0021  |ddm|=0.0103  |maxRot[o]|=0.0138
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4983962110939  dE = -4.4236569e-06  S^2 = 0.0000000
               |grad[o]|=0.000734  |ddm|=0.00328  |maxRot[o]|=0.00466
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4983966689272  dE = -4.5783328e-07  S^2 = 0.0000000
               |grad[o]|=0.00024  |ddm|=0.00107  |maxRot[o]|=0.0015
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4983967154537  dE = -4.6526495e-08  S^2 = 0.0000000
               |grad[o]|=7.91e-05  |ddm|=0.000341  |maxRot[o]|=0.000481
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4983967201917  dE = -4.7380269e-09  S^2 = 0.0000000
               |grad[o]|=2.53e-05  |ddm|=0.000109  |maxRot[o]|=0.000154
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4983967206668  dE = -4.7502624e-10  S^2 = 0.0000000
               |grad[o]|=8.2e-06  |ddm|=3.45e-05  |maxRot[o]|=4.89e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4983967207138  dE = -4.6981086e-11  S^2 = 0.0000000
               |grad[o]|=2.58e-06  |ddm|=1.1e-05  |maxRot[o]|=1.53e-05
2-step CASSCF converged in 14 macro (58 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96168427 1.92995961 1.89788678 1.80319403 0.07495278 0.20294447
 0.05842681 0.07095124]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01086   0.00993  -0.00483   0.00000   0.00000
  0 C 2s       0.63886   0.65282  -0.30204  -0.00000  -0.00000
  0 C 3s      -0.01519   0.01695  -0.04490  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69411
  0 C 2py      0.00000  -0.00000  -0.00000   0.70440   0.00000
  0 C 2pz      0.30069  -0.27056   0.63672  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.05943
  0 C 3py      0.00000  -0.00000  -0.00000   0.05007   0.00000
  0 C 3pz     -0.01863  -0.00220   0.00482  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03622   0.00000
  0 C 3dz^2    0.02743  -0.01357   0.03519  -0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.12113
 0 C 3dx2-y2  -0.00059   0.00688  -0.00742  -0.00000  -0.00000
  1 C 1s       0.01086  -0.00993  -0.00483   0.00000   0.00000
  1 C 2s       0.63886  -0.65282  -0.30204   0.00000  -0.00000
  1 C 3s      -0.01519  -0.01695  -0.04490   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69411
  1 C 2py     -0.00000   0.00000   0.00000   0.70440  -0.00000
  1 C 2pz     -0.30069  -0.27056  -0.63672  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.05943
  1 C 3py     -0.00000   0.00000   0.00000   0.05007  -0.00000
  1 C 3pz      0.01863  -0.00220  -0.00482  -0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03622   0.00000
  1 C 3dz^2    0.02743   0.01357   0.03519   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12113
 1 C 3dx2-y2  -0.00059  -0.00688  -0.00742   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00043
  0 C 2s      -0.00000  -0.00000   0.26907
  0 C 3s      -0.00000  -0.00000   0.03634
  0 C 2px      0.00000   0.69753  -0.00000
  0 C 2py      0.70681   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.65078
  0 C 3px      0.00000  -0.00334  -0.00000
  0 C 3py     -0.01665   0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04624
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01219   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00964
  0 C 3dxz     0.00000  -0.11596  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02324
  1 C 1s       0.00000   0.00000   0.00043
  1 C 2s       0.00000  -0.00000  -0.26907
  1 C 3s       0.00000   0.00000  -0.03634
  1 C 2px      0.00000  -0.69753   0.00000
  1 C 2py     -0.70681  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.65078
  1 C 3px     -0.00000   0.00334   0.00000
  1 C 3py      0.01665  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04624
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.01219   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00964
  1 C 3dxz     0.00000  -0.11596  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02324
<CAS-nat-orb|mo-hf>  3  3    0.99623595
<CAS-nat-orb|mo-hf>  4  4    0.99972951
<CAS-nat-orb|mo-hf>  5  5    0.99625438
<CAS-nat-orb|mo-hf>  6  6    0.99910667
<CAS-nat-orb|mo-hf>  7  7    0.93825028
<CAS-nat-orb|mo-hf>  8  8    0.97590449
<CAS-nat-orb|mo-hf>  9  9    0.95945853
<CAS-nat-orb|mo-hf>  10  10    0.89805646
<CAS-nat-orb|mo-hf>  10  11   -0.41828628
CASSCF energy = -75.4983967207138
CASCI E = -75.4983967207138  E(CI) = -15.4874144008861  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.337
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.098
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.660

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.030
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.634
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.728
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.723
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.729
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      2.329
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.328
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.533
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.10
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.10
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.10
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.564 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.263 | Tfpread = 0.000 | Tfpwrite = 0.260 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.873 | E =     -75.5903534623 | DW = 1.56e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.467 | E =     -75.6147452164 | DE = -2.44e-02 | DW = 5.96e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     13.171 | E =     -75.6152594920 | DE = -5.14e-04 | DW = 1.62e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     13.890 | E =     -75.6157385139 | DE = -4.79e-04 | DW = 7.49e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     14.510 | E =     -75.6157707264 | DE = -3.22e-05 | DW = 1.61e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.254 | E =     -75.6158161433 | DE = -4.54e-05 | DW = 7.68e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.957 | E =     -75.6158417353 | DE = -2.56e-05 | DW = 1.66e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     16.693 | E =     -75.6158910105 | DE = -4.93e-05 | DW = 7.98e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.568 | E =     -75.6170753876 | DE = -1.18e-03 | DW = 1.52e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     28.146 | E =     -75.6175479216 | DE = -4.73e-04 | DW = 2.32e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.920 | E =     -75.6176782364 | DE = -1.30e-04 | DW = 4.03e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.076 | E =     -75.6177150430 | DE = -3.68e-05 | DW = 2.76e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.563 | E =     -75.6177215738 | DE = -6.53e-06 | DW = 4.04e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     44.016 | E =     -75.6177250278 | DE = -3.45e-06 | DW = 2.77e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     48.553 | E =     -75.6177281503 | DE = -3.12e-06 | DW = 4.03e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     53.039 | E =     -75.6177303844 | DE = -2.23e-06 | DW = 2.78e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     61.696 | E =     -75.6178663054 | DE = -1.36e-04 | DW = 2.72e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     74.746 | E =     -75.6179067051 | DE = -4.04e-05 | DW = 1.93e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     85.834 | E =     -75.6179126018 | DE = -5.90e-06 | DW = 4.42e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     97.591 | E =     -75.6179135938 | DE = -9.92e-07 | DW = 1.88e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    109.353 | E =     -75.6179157149 | DE = -2.12e-06 | DW = 4.48e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.131 | E =     -75.6179162586 | DE = -5.44e-07 | DW = 1.90e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    133.024 | E =     -75.6179179686 | DE = -1.71e-06 | DW = 4.49e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    144.687 | E =     -75.6179183284 | DE = -3.60e-07 | DW = 1.89e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    167.741 | E =     -75.6179272544 | DE = -8.93e-06 | DW = 2.32e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    195.919 | E =     -75.6179300445 | DE = -2.79e-06 | DW = 9.68e-08

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    221.853 | E =     -75.6179308436 | DE = -7.99e-07 | DW = 2.14e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    250.254 | E =     -75.6179314342 | DE = -5.91e-07 | DW = 9.86e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    276.164 | E =     -75.6179319282 | DE = -4.94e-07 | DW = 2.16e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    304.890 | E =     -75.6179324883 | DE = -5.60e-07 | DW = 9.83e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    331.487 | E =     -75.6179329324 | DE = -4.44e-07 | DW = 2.15e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    362.371 | E =     -75.6179334727 | DE = -5.40e-07 | DW = 9.80e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    539.086 | E =     -75.6179511185 | DE = -1.76e-05 | DW = 5.01e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    646.271 | E =     -75.6179511186 | DE = -1.69e-10 | DW = 5.03e-08

E(MRCI) = -75.61795111863303  E_corr = -0.1195543979192735
Time cost =    960.504
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:42:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.825661377674 AA    0.000000000000   0.000000000000   3.450000000000 Bohr   0.0

nuclear repulsion = 10.4347826086957
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.725]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    302130.97


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpr5z59afx
max_memory 4000 MB (current use 5134 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7871059587891

WARN: Singularity detected in overlap matrix (condition number =  114). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.119977421491999  LUMO (B3u) = -0.119977421491999

WARN: B2u HOMO -0.119977421491999 > system LUMO -0.119977421491999

cycle= 1 E= -75.3032347208423  delta_E= -0.516  |g|= 0.247  |ddm|=  1.5
HOMO (B2u) = -0.379319419622633  LUMO (B3u) = -0.0646054692258414
cycle= 2 E= -75.3274445047689  delta_E= -0.0242  |g|= 0.0501  |ddm|= 0.35
HOMO (B2u) = -0.343173022356372  LUMO (B3u) = -0.023683431563987
cycle= 3 E= -75.3288571081842  delta_E= -0.00141  |g|= 0.018  |ddm|= 0.0664
HOMO (B2u) = -0.347657119428849  LUMO (B3u) = -0.0280415501187841
cycle= 4 E= -75.3290795920014  delta_E= -0.000222  |g|= 0.00067  |ddm|= 0.0369
HOMO (B2u) = -0.347805946692308  LUMO (B3u) = -0.0283390207305954
cycle= 5 E= -75.3290797635007  delta_E= -1.71e-07  |g|= 0.000106  |ddm|= 0.000935
HOMO (B2u) = -0.347769025805503  LUMO (B3u) = -0.0283049912511385
cycle= 6 E= -75.3290797699135  delta_E= -6.41e-09  |g|= 1.65e-05  |ddm|= 0.000181
HOMO (B2u) = -0.347766788756666  LUMO (B3u) = -0.028305715831914
cycle= 7 E= -75.3290797700874  delta_E= -1.74e-10  |g|= 1.94e-06  |ddm|= 3.58e-05
HOMO (B2u) = -0.347766179407151  LUMO (B3u) = -0.0283055115206176
cycle= 8 E= -75.3290797700898  delta_E= -2.44e-12  |g|= 1.22e-07  |ddm|= 4.05e-06
HOMO (B2u) = -0.347766186617913  LUMO (B3u) = -0.0283055139495732
cycle= 9 E= -75.3290797700899  delta_E= -4.26e-14  |g|= 7.66e-09  |ddm|= 2.61e-07
HOMO (B2u) = -0.347766186764335  LUMO (B3u) = -0.0283055158281058
cycle= 10 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 5.87e-09  |ddm|= 7.81e-09
HOMO (B2u) = -0.347766186555852  LUMO (B3u) = -0.0283055156158966
cycle= 11 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 4.4e-09  |ddm|= 4.6e-09
HOMO (B2u) = -0.347766185192962  LUMO (B3u) = -0.0283055141895845
cycle= 12 E= -75.3290797700898  delta_E= -2.84e-14  |g|= 3.94e-09  |ddm|= 2.11e-09
HOMO (B2u) = -0.347766185565499  LUMO (B3u) = -0.0283055145569034
cycle= 13 E= -75.3290797700898  delta_E=    0  |g|= 3.55e-09  |ddm|= 1.37e-09
HOMO (B2u) = -0.347766185498123  LUMO (B3u) = -0.028305514500978
cycle= 14 E= -75.3290797700898  delta_E= 2.84e-14  |g|= 3.06e-09  |ddm|= 9.43e-10
HOMO (B2u) = -0.347766185312149  LUMO (B3u) = -0.0283055143166806
cycle= 15 E= -75.3290797700898  delta_E= -4.26e-14  |g|= 8.69e-10  |ddm|= 5.07e-09
HOMO (B2u) = -0.347766185214835  LUMO (B3u) = -0.0283055143060312
cycle= 16 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 8.64e-10  |ddm|= 1.38e-09
HOMO (B2u) = -0.347766185241231  LUMO (B3u) = -0.0283055142973395
cycle= 17 E= -75.3290797700899  delta_E= -5.68e-14  |g|= 8.92e-10  |ddm|= 6.4e-10
HOMO (B2u) = -0.347766185214374  LUMO (B3u) = -0.0283055142719705
cycle= 18 E= -75.3290797700899  delta_E= 2.84e-14  |g|= 6.83e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.347766185217242  LUMO (B3u) = -0.0283055142806536
cycle= 19 E= -75.3290797700899  delta_E= -1.42e-14  |g|= 5.83e-10  |ddm|= 3.64e-10
HOMO (B2u) = -0.347766185222219  LUMO (B3u) = -0.0283055142902924
cycle= 20 E= -75.3290797700899  delta_E= 1.42e-14  |g|= 4.91e-10  |ddm|= 2.5e-10
HOMO (B2u) = -0.347766185212758  LUMO (B3u) = -0.028305514282547
cycle= 21 E= -75.3290797700899  delta_E=    0  |g|= 3.86e-10  |ddm|= 2.35e-10
HOMO (B2u) = -0.347766185207215  LUMO (B3u) = -0.0283055142799947
cycle= 22 E= -75.3290797700899  delta_E=    0  |g|= 2.84e-10  |ddm|= 2.23e-10
HOMO (B2u) = -0.34776618520198  LUMO (B3u) = -0.0283055142773448
cycle= 23 E= -75.3290797700899  delta_E=    0  |g|= 1.94e-10  |ddm|= 1.98e-10
HOMO (B2u) = -0.347766185195901  LUMO (B3u) = -0.0283055142743
cycle= 24 E= -75.3290797700899  delta_E= -2.84e-14  |g|= 1.7e-10  |ddm|= 7.06e-11
HOMO (B2u) = -0.347766185194308  LUMO (B3u) = -0.0283055142721244
cycle= 25 E= -75.3290797700898  delta_E= 5.68e-14  |g|= 1.43e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.347766185191536  LUMO (B3u) = -0.0283055142701065
cycle= 26 E= -75.3290797700899  delta_E= -2.84e-14  |g|= 1.17e-10  |ddm|= 6.3e-11
HOMO (B2u) = -0.347766185189155  LUMO (B3u) = -0.0283055142684039
cycle= 27 E= -75.3290797700898  delta_E= 1.42e-14  |g|= 9.88e-11  |ddm|= 4.78e-11
HOMO (B2u) = -0.347766185187192  LUMO (B3u) = -0.0283055142669582
cycle= 28 E= -75.3290797700899  delta_E= -9.95e-14  |g|= 8.05e-11  |ddm|= 4.27e-11
HOMO (B2u) = -0.347766185185697  LUMO (B3u) = -0.0283055142658668
cycle= 29 E= -75.3290797700899  delta_E=    0  |g|= 6.41e-11  |ddm|= 3.73e-11
HOMO (B2u) = -0.347766185181772  LUMO (B3u) = -0.0283055142630158
Extra cycle  E= -75.32907977009  delta_E= -2.84e-14  |g|= 2.38e-11  |ddm|= 9.24e-11
converged SCF energy = -75.32907977009

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpr5z59afx
max_memory 4000 MB (current use 5134 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4482666492427  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4618070962042  dE = -0.013540447  S^2 = 0.0000000
               |grad[o]|=0.0903  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4731420455805  dE = -0.011334949  S^2 = 0.0000000
               |grad[o]|=0.0766  |ddm|=0.0757  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.48184363769  dE = -0.0087015921  S^2 = 0.0000000
               |grad[o]|=0.0609  |ddm|=0.0424  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4881479773694  dE = -0.0063043397  S^2 = 0.0000000
               |grad[o]|=0.0447  |ddm|=0.0517  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4917508554915  dE = -0.0036028781  S^2 = 0.0000000
               |grad[o]|=0.0284  |ddm|=0.0693  |maxRot[o]|= 0.06
macro iter 6 (5 JK  0 micro), CASSCF E = -75.4932334199218  dE = -0.0014825644  S^2 = 0.0000000
               |grad[o]|=0.014  |ddm|=0.0391  |maxRot[o]|=0.0599
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4935074486779  dE = -0.00027402876  S^2 = 0.0000000
               |grad[o]|=0.0052  |ddm|=0.0263  |maxRot[o]|=0.0339
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4935391472081  dE = -3.169853e-05  S^2 = 0.0000000
               |grad[o]|=0.00188  |ddm|=0.00865  |maxRot[o]|=0.0123
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4935423378568  dE = -3.1906488e-06  S^2 = 0.0000000
               |grad[o]|=0.000638  |ddm|=0.00269  |maxRot[o]|=0.00399
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4935426468785  dE = -3.0902164e-07  S^2 = 0.0000000
               |grad[o]|=0.000201  |ddm|=0.000852  |maxRot[o]|=0.00124
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4935426764439  dE = -2.9565413e-08  S^2 = 0.0000000
               |grad[o]|=6.51e-05  |ddm|=0.000265  |maxRot[o]|=0.000387
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4935426792637  dE = -2.8197604e-09  S^2 = 0.0000000
               |grad[o]|=2.01e-05  |ddm|=8.25e-05  |maxRot[o]|=0.00012
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4935426795294  dE = -2.6578562e-10  S^2 = 0.0000000
               |grad[o]|=6.34e-06  |ddm|=2.54e-05  |maxRot[o]|=3.71e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4935426795536  dE = -2.4144242e-11  S^2 = 0.0000000
               |grad[o]|=1.95e-06  |ddm|=7.86e-06  |maxRot[o]|=1.14e-05
2-step CASSCF converged in 14 macro (57 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.96070609 1.93062247 1.89534329 1.79161507 0.07330623 0.21443248
 0.0581318  0.07584257]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01111   0.01003  -0.00449   0.00000   0.00000
  0 C 2s       0.64834   0.65619  -0.28117   0.00000   0.00000
  0 C 3s      -0.01251   0.01666  -0.04312  -0.00000   0.00000
  0 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69393
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439   0.00000
  0 C 2pz      0.28005  -0.26233   0.64632  -0.00000   0.00000
  0 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06065
  0 C 3py      0.00000  -0.00000   0.00000   0.05111   0.00000
  0 C 3pz     -0.01714  -0.00207   0.00620  -0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.03500   0.00000
  0 C 3dz^2    0.02561  -0.01317   0.03529  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000   0.00000  -0.12160
 0 C 3dx2-y2  -0.00030   0.00676  -0.00739   0.00000   0.00000
  1 C 1s       0.01111  -0.01003  -0.00449   0.00000   0.00000
  1 C 2s       0.64834  -0.65619  -0.28117   0.00000   0.00000
  1 C 3s      -0.01251  -0.01666  -0.04312   0.00000  -0.00000
  1 C 2px     -0.00000  -0.00000   0.00000  -0.00000   0.69393
  1 C 2py     -0.00000   0.00000  -0.00000   0.70439  -0.00000
  1 C 2pz     -0.28005  -0.26233  -0.64632   0.00000   0.00000
  1 C 3px      0.00000   0.00000   0.00000  -0.00000  -0.06065
  1 C 3py     -0.00000   0.00000   0.00000   0.05111  -0.00000
  1 C 3pz      0.01714  -0.00207  -0.00620  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03500   0.00000
  1 C 3dz^2    0.02561   0.01317   0.03529   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12160
 1 C 3dx2-y2  -0.00030  -0.00676  -0.00739  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00040
  0 C 2s       0.00000   0.00000   0.26097
  0 C 3s      -0.00000   0.00000   0.03534
  0 C 2px     -0.00000   0.69766   0.00000
  0 C 2py      0.70686  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.65436
  0 C 3px     -0.00000  -0.00539  -0.00000
  0 C 3py     -0.01459  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.04356
  0 C 3dxy     0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01176  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00868
  0 C 3dxz    -0.00000  -0.11509   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.02209
  1 C 1s       0.00000   0.00000   0.00040
  1 C 2s       0.00000   0.00000  -0.26097
  1 C 3s       0.00000  -0.00000  -0.03534
  1 C 2px      0.00000  -0.69766   0.00000
  1 C 2py     -0.70686   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.65436
  1 C 3px      0.00000   0.00539  -0.00000
  1 C 3py      0.01459   0.00000   0.00000
  1 C 3pz     -0.00000   0.00000  -0.04356
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01176  -0.00000   0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00868
  1 C 3dxz    -0.00000  -0.11509   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02209
<CAS-nat-orb|mo-hf>  3  3    0.99779512
<CAS-nat-orb|mo-hf>  4  4    0.99972139
<CAS-nat-orb|mo-hf>  5  5    0.99781371
<CAS-nat-orb|mo-hf>  6  6    0.99905368
<CAS-nat-orb|mo-hf>  7  7    0.93724394
<CAS-nat-orb|mo-hf>  8  8    0.97733329
<CAS-nat-orb|mo-hf>  9  9    0.95969121
<CAS-nat-orb|mo-hf>  10  10    0.90788563
CASSCF energy = -75.4935426795536
CASCI E = -75.4935426795536  E(CI) = -15.4144875230009  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.010

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.057
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.013
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.009
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.011
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.098
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.04
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.02
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.286 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.168 | Tfpread = 0.000 | Tfpwrite = 0.164 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.133 | E =     -75.5855293080 | DW = 1.57e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.349 | E =     -75.6100556030 | DE = -2.45e-02 | DW = 5.99e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.107 | E =     -75.6105695328 | DE = -5.14e-04 | DW = 1.63e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.013 | E =     -75.6110590030 | DE = -4.89e-04 | DW = 7.60e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.857 | E =     -75.6110884482 | DE = -2.94e-05 | DW = 1.64e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.731 | E =     -75.6111355122 | DE = -4.71e-05 | DW = 7.87e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.614 | E =     -75.6111588506 | DE = -2.33e-05 | DW = 1.69e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.411 | E =     -75.6111836974 | DE = -2.48e-05 | DW = 8.02e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     10.072 | E =     -75.6122988021 | DE = -1.12e-03 | DW = 1.49e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     16.999 | E =     -75.6128202747 | DE = -5.21e-04 | DW = 2.28e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.497 | E =     -75.6129531140 | DE = -1.33e-04 | DW = 4.07e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.476 | E =     -75.6129972952 | DE = -4.42e-05 | DW = 2.86e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     27.843 | E =     -75.6130058520 | DE = -8.56e-06 | DW = 4.11e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     31.470 | E =     -75.6130101590 | DE = -4.31e-06 | DW = 2.82e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.178 | E =     -75.6130167149 | DE = -6.56e-06 | DW = 4.12e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     38.997 | E =     -75.6130208423 | DE = -4.13e-06 | DW = 2.88e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     48.150 | E =     -75.6131593648 | DE = -1.39e-04 | DW = 2.75e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     59.529 | E =     -75.6132004016 | DE = -4.10e-05 | DW = 1.96e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     68.662 | E =     -75.6132074815 | DE = -7.08e-06 | DW = 4.49e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     92.394 | E =     -75.6132087242 | DE = -1.24e-06 | DW = 1.90e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    109.332 | E =     -75.6132114167 | DE = -2.69e-06 | DW = 4.51e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    120.600 | E =     -75.6132129715 | DE = -1.55e-06 | DW = 2.02e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    130.091 | E =     -75.6132141638 | DE = -1.19e-06 | DW = 4.44e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    140.321 | E =     -75.6132150156 | DE = -8.52e-07 | DW = 1.91e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    160.564 | E =     -75.6132246817 | DE = -9.67e-06 | DW = 2.35e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    192.205 | E =     -75.6132278099 | DE = -3.13e-06 | DW = 1.01e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    239.401 | E =     -75.6132288144 | DE = -1.00e-06 | DW = 2.12e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    278.271 | E =     -75.6132295900 | DE = -7.76e-07 | DW = 1.03e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    302.766 | E =     -75.6132303540 | DE = -7.64e-07 | DW = 2.14e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    335.298 | E =     -75.6132310839 | DE = -7.30e-07 | DW = 1.02e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    359.290 | E =     -75.6132317685 | DE = -6.85e-07 | DW = 2.15e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    388.358 | E =     -75.6132324632 | DE = -6.95e-07 | DW = 1.02e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    575.591 | E =     -75.6132565150 | DE = -2.41e-05 | DW = 5.08e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    680.519 | E =     -75.6132565151 | DE = -1.06e-10 | DW = 5.09e-08

E(MRCI) = -75.61325651514829  E_corr = -0.1197138355947089
Time cost =    737.684
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 20:54:48 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.852120238220 AA    0.000000000000   0.000000000000   3.500000000000 Bohr   0.0

nuclear repulsion = 10.2857142857143
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.75]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    314170.94


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpkibitlyx
max_memory 4000 MB (current use 5157 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.770995471526

WARN: Singularity detected in overlap matrix (condition number =  106). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.116499456302711  LUMO (B3u) = -0.116499456302711

WARN: B2u HOMO -0.116499456302711 > system LUMO -0.116499456302711

cycle= 1 E= -75.2953428985396  delta_E= -0.524  |g|= 0.245  |ddm|= 1.49
HOMO (B2u) = -0.375058505355513  LUMO (B3u) = -0.0620673626538308
cycle= 2 E= -75.3191698853078  delta_E= -0.0238  |g|= 0.0495  |ddm|= 0.35
HOMO (B2u) = -0.339451307241011  LUMO (B3u) = -0.0217153065240383
cycle= 3 E= -75.3205643325183  delta_E= -0.00139  |g|= 0.0179  |ddm|= 0.0655
HOMO (B2u) = -0.343918314413034  LUMO (B3u) = -0.0260457604373075
cycle= 4 E= -75.320786165773  delta_E= -0.000222  |g|= 0.000666  |ddm|= 0.0365
HOMO (B2u) = -0.344078228753201  LUMO (B3u) = -0.0263545301612761
cycle= 5 E= -75.3207863342661  delta_E= -1.68e-07  |g|= 0.00011  |ddm|= 0.000905
HOMO (B2u) = -0.34404092812384  LUMO (B3u) = -0.0263210064987917
cycle= 6 E= -75.3207863411989  delta_E= -6.93e-09  |g|= 1.7e-05  |ddm|= 0.000188
HOMO (B2u) = -0.344038581299433  LUMO (B3u) = -0.0263216091209551
cycle= 7 E= -75.3207863413827  delta_E= -1.84e-10  |g|= 1.93e-06  |ddm|= 3.63e-05
HOMO (B2u) = -0.344037999604642  LUMO (B3u) = -0.026321440957216
cycle= 8 E= -75.3207863413852  delta_E= -2.44e-12  |g|= 1.24e-07  |ddm|= 4.02e-06
HOMO (B2u) = -0.344038005467255  LUMO (B3u) = -0.0263214419458158
cycle= 9 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 8.04e-09  |ddm|= 2.72e-07
HOMO (B2u) = -0.344038005447966  LUMO (B3u) = -0.0263214437150757
cycle= 10 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 6.26e-09  |ddm|= 7.9e-09
HOMO (B2u) = -0.344038005257676  LUMO (B3u) = -0.0263214435356963
cycle= 11 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 4.62e-09  |ddm|= 4.91e-09
HOMO (B2u) = -0.344038003880613  LUMO (B3u) = -0.0263214420965956
cycle= 12 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 4.1e-09  |ddm|= 2.25e-09
HOMO (B2u) = -0.344038004235215  LUMO (B3u) = -0.0263214424504661
cycle= 13 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 3.69e-09  |ddm|= 1.48e-09
HOMO (B2u) = -0.344038004143401  LUMO (B3u) = -0.0263214423662649
cycle= 14 E= -75.3207863413851  delta_E= 8.53e-14  |g|= 3.11e-09  |ddm|= 1.26e-09
HOMO (B2u) = -0.344038003955598  LUMO (B3u) = -0.0263214422137809
cycle= 15 E= -75.3207863413851  delta_E=    0  |g|= 9.32e-10  |ddm|= 5.21e-09
HOMO (B2u) = -0.344038003851174  LUMO (B3u) = -0.0263214422045425
cycle= 16 E= -75.3207863413851  delta_E= -5.68e-14  |g|= 8.98e-10  |ddm|= 1.22e-09
HOMO (B2u) = -0.34403800388924  LUMO (B3u) = -0.0263214421914407
cycle= 17 E= -75.3207863413852  delta_E= -5.68e-14  |g|= 9.61e-10  |ddm|= 9.8e-10
HOMO (B2u) = -0.344038003858523  LUMO (B3u) = -0.0263214421653593
cycle= 18 E= -75.3207863413852  delta_E= 2.84e-14  |g|= 7.37e-10  |ddm|= 5.28e-10
HOMO (B2u) = -0.344038003858572  LUMO (B3u) = -0.0263214421728071
cycle= 19 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 6.17e-10  |ddm|= 4.19e-10
HOMO (B2u) = -0.3440380038613  LUMO (B3u) = -0.0263214421815347
cycle= 20 E= -75.3207863413852  delta_E= -2.84e-14  |g|= 5.15e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.344038003849511  LUMO (B3u) = -0.0263214421727787
cycle= 21 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 4.04e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.344038003841708  LUMO (B3u) = -0.026321442169123
cycle= 22 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 2.96e-10  |ddm|= 2.48e-10
HOMO (B2u) = -0.344038003834217  LUMO (B3u) = -0.0263214421655069
cycle= 23 E= -75.3207863413851  delta_E= -5.68e-14  |g|= 2.07e-10  |ddm|= 2.11e-10
HOMO (B2u) = -0.344038003827954  LUMO (B3u) = -0.0263214421623574
cycle= 24 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.79e-10  |ddm|= 7.45e-11
HOMO (B2u) = -0.344038003826299  LUMO (B3u) = -0.0263214421599125
cycle= 25 E= -75.3207863413851  delta_E= -2.84e-14  |g|= 1.51e-10  |ddm|= 6.69e-11
HOMO (B2u) = -0.344038003822882  LUMO (B3u) = -0.026321442157639
cycle= 26 E= -75.3207863413851  delta_E= 5.68e-14  |g|= 1.23e-10  |ddm|= 7.2e-11
HOMO (B2u) = -0.344038003820043  LUMO (B3u) = -0.0263214421557619
cycle= 27 E= -75.3207863413851  delta_E= 2.84e-14  |g|= 1.03e-10  |ddm|= 5.49e-11
HOMO (B2u) = -0.34403800381771  LUMO (B3u) = -0.026321442154178
cycle= 28 E= -75.3207863413852  delta_E= -1.14e-13  |g|= 8.37e-11  |ddm|= 4.71e-11
HOMO (B2u) = -0.344038003815912  LUMO (B3u) = -0.0263214421529724
cycle= 29 E= -75.3207863413851  delta_E= 1.14e-13  |g|= 6.66e-11  |ddm|= 4.03e-11
HOMO (B2u) = -0.34403800381439  LUMO (B3u) = -0.0263214421519508
cycle= 30 E= -75.3207863413851  delta_E=    0  |g|= 5.29e-11  |ddm|= 3.22e-11
HOMO (B2u) = -0.344038003810771  LUMO (B3u) = -0.0263214421494699
Extra cycle  E= -75.3207863413851  delta_E= -2.84e-14  |g|= 1.95e-11  |ddm|= 7.79e-11
converged SCF energy = -75.3207863413851

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpkibitlyx
max_memory 4000 MB (current use 5157 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4441902032779  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4581675445269  dE = -0.013977341  S^2 = 0.0000000
               |grad[o]|=0.0923  |ddm|= 3.81  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4696863277995  dE = -0.011518783  S^2 = 0.0000000
               |grad[o]|=0.0772  |ddm|=0.0805  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4782736014074  dE = -0.0085872736  S^2 = 0.0000000
               |grad[o]|= 0.06  |ddm|=0.0433  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4843087113819  dE = -0.00603511  S^2 = 0.0000000
               |grad[o]|=0.0424  |ddm|=0.0577  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4876594647996  dE = -0.0033507534  S^2 = 0.0000000
               |grad[o]|=0.025  |ddm|=0.0723  |maxRot[o]|=0.0598
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4884291461424  dE = -0.00076968134  S^2 = 0.0000000
               |grad[o]|=0.0102  |ddm|=0.0384  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4887234221596  dE = -0.00029427602  S^2 = 0.0000000
               |grad[o]|=0.00536  |ddm|=0.0131  |maxRot[o]|=0.0349
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4887546649271  dE = -3.1242768e-05  S^2 = 0.0000000
               |grad[o]|=0.00188  |ddm|=0.00827  |maxRot[o]|=0.0123
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4887576343245  dE = -2.9693974e-06  S^2 = 0.0000000
               |grad[o]|=0.000631  |ddm|=0.00252  |maxRot[o]|=0.00387
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4887579069092  dE = -2.7258467e-07  S^2 = 0.0000000
               |grad[o]|=0.000193  |ddm|=0.000781  |maxRot[o]|=0.00117
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4887579316638  dE = -2.4754584e-08  S^2 = 0.0000000
               |grad[o]|=6.19e-05  |ddm|=0.000237  |maxRot[o]|=0.000356
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4887579338997  dE = -2.235879e-09  S^2 = 0.0000000
               |grad[o]|=1.84e-05  |ddm|=7.09e-05  |maxRot[o]|=0.000107
macro iter 13 (2 JK  0 micro), CASSCF E = -75.488757934101  dE = -2.0138202e-10  S^2 = 0.0000000
               |grad[o]|=5.66e-06  |ddm|=2.14e-05  |maxRot[o]|=3.21e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4887579341157  dE = -1.462297e-11  S^2 = 0.0000000
               |grad[o]|=1.71e-06  |ddm|=6.48e-06  |maxRot[o]|=9.76e-06
2-step CASSCF converged in 14 macro (56 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95981392 1.93127287 1.89228264 1.77943939 0.07180266 0.22650184
 0.05783603 0.08105066]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01133   0.01013  -0.00414   0.00000   0.00000
  0 C 2s       0.65705   0.65938  -0.26022  -0.00000  -0.00000
  0 C 3s      -0.00998   0.01639  -0.04128   0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69378
  0 C 2py     -0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.25932  -0.25424   0.65514  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06179
  0 C 3py     -0.00000   0.00000   0.00000   0.05203   0.00000
  0 C 3pz     -0.01577  -0.00197   0.00765   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.03378   0.00000
  0 C 3dz^2    0.02382  -0.01278   0.03532  -0.00000   0.00000
  0 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000  -0.12186
 0 C 3dx2-y2  -0.00000   0.00665  -0.00734  -0.00000   0.00000
  1 C 1s       0.01133  -0.01013  -0.00414   0.00000   0.00000
  1 C 2s       0.65705  -0.65938  -0.26022  -0.00000  -0.00000
  1 C 3s      -0.00998  -0.01639  -0.04128   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69378
  1 C 2py     -0.00000   0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.25932  -0.25424  -0.65514  -0.00000   0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06179
  1 C 3py      0.00000  -0.00000  -0.00000   0.05203  -0.00000
  1 C 3pz      0.01577  -0.00197  -0.00765  -0.00000   0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.03378   0.00000
  1 C 3dz^2    0.02382   0.01278   0.03532   0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000  -0.00000   0.00000   0.12186
 1 C 3dx2-y2  -0.00000  -0.00665  -0.00734  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00037
  0 C 2s      -0.00000  -0.00000   0.25300
  0 C 3s      -0.00000   0.00000   0.03435
  0 C 2px     -0.00000   0.69779  -0.00000
  0 C 2py      0.70690   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.65775
  0 C 3px     -0.00000  -0.00738  -0.00000
  0 C 3py     -0.01256  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.04088
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01132  -0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00778
  0 C 3dxz    -0.00000  -0.11419   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.02095
  1 C 1s       0.00000   0.00000   0.00037
  1 C 2s      -0.00000  -0.00000  -0.25300
  1 C 3s       0.00000   0.00000  -0.03435
  1 C 2px      0.00000  -0.69779  -0.00000
  1 C 2py     -0.70690   0.00000  -0.00000
  1 C 2pz     -0.00000   0.00000   0.65775
  1 C 3px      0.00000   0.00738   0.00000
  1 C 3py      0.01256   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.04088
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01132  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00778
  1 C 3dxz    -0.00000  -0.11419  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.02095
<CAS-nat-orb|mo-hf>  3  3    0.99891159
<CAS-nat-orb|mo-hf>  4  4    0.99971276
<CAS-nat-orb|mo-hf>  5  5    0.99892918
<CAS-nat-orb|mo-hf>  6  6    0.99899872
<CAS-nat-orb|mo-hf>  7  7    0.93636100
<CAS-nat-orb|mo-hf>  8  8    0.97867430
<CAS-nat-orb|mo-hf>  9  9    0.95989984
<CAS-nat-orb|mo-hf>  10  10    0.91658565
CASSCF energy = -75.4887579341157
CASCI E = -75.4887579341157  E(CI) = -15.3435702518704  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.009

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.036
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.013
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.011
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.011
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.078
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.05
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.233 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.144 | Tfpread = 0.000 | Tfpwrite = 0.141 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.352 | E =     -75.5799334603 | DW = 1.55e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.038 | E =     -75.6054310055 | DE = -2.55e-02 | DW = 6.33e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.734 | E =     -75.6059386838 | DE = -5.08e-04 | DW = 1.61e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.976 | E =     -75.6064249749 | DE = -4.86e-04 | DW = 7.49e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     13.373 | E =     -75.6064502176 | DE = -2.52e-05 | DW = 1.63e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     14.492 | E =     -75.6065062190 | DE = -5.60e-05 | DW = 7.85e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     17.332 | E =     -75.6065286123 | DE = -2.24e-05 | DW = 1.68e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.013 | E =     -75.6065571678 | DE = -2.86e-05 | DW = 7.99e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     25.162 | E =     -75.6076499007 | DE = -1.09e-03 | DW = 1.48e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.866 | E =     -75.6081796952 | DE = -5.30e-04 | DW = 2.28e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.437 | E =     -75.6083208337 | DE = -1.41e-04 | DW = 4.14e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.293 | E =     -75.6083689096 | DE = -4.81e-05 | DW = 2.92e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.815 | E =     -75.6083772488 | DE = -8.34e-06 | DW = 4.18e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     44.522 | E =     -75.6083819654 | DE = -4.72e-06 | DW = 2.88e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     46.890 | E =     -75.6083882262 | DE = -6.26e-06 | DW = 4.18e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     49.467 | E =     -75.6083914715 | DE = -3.25e-06 | DW = 2.90e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     56.069 | E =     -75.6085335092 | DE = -1.42e-04 | DW = 2.75e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     68.465 | E =     -75.6085745925 | DE = -4.11e-05 | DW = 1.97e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     79.499 | E =     -75.6085824238 | DE = -7.83e-06 | DW = 4.53e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     91.006 | E =     -75.6085847192 | DE = -2.30e-06 | DW = 2.04e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    100.319 | E =     -75.6085867797 | DE = -2.06e-06 | DW = 4.49e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.819 | E =     -75.6085877509 | DE = -9.71e-07 | DW = 1.92e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.944 | E =     -75.6085905439 | DE = -2.79e-06 | DW = 4.52e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    134.197 | E =     -75.6085921375 | DE = -1.59e-06 | DW = 2.04e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    157.662 | E =     -75.6086018848 | DE = -9.75e-06 | DW = 2.36e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    186.189 | E =     -75.6086052102 | DE = -3.33e-06 | DW = 1.05e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    213.599 | E =     -75.6086069040 | DE = -1.69e-06 | DW = 2.79e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    241.057 | E =     -75.6086071260 | DE = -2.22e-07 | DW = 8.97e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    268.477 | E =     -75.6086086147 | DE = -1.49e-06 | DW = 2.79e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    295.137 | E =     -75.6086088047 | DE = -1.90e-07 | DW = 8.95e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    323.340 | E =     -75.6086102335 | DE = -1.43e-06 | DW = 2.77e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    352.398 | E =     -75.6086104016 | DE = -1.68e-07 | DW = 8.96e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    540.891 | E =     -75.6086365990 | DE = -2.62e-05 | DW = 5.14e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    696.055 | E =     -75.6086365991 | DE = -1.28e-10 | DW = 5.15e-08

E(MRCI) = -75.60863659908404  E_corr = -0.1198786649683683
Time cost =   1161.216
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 21:14:09 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.878579098766 AA    0.000000000000   0.000000000000   3.550000000000 Bohr   0.0

nuclear repulsion = 10.1408450704225
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.775]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    327746.75


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpfmao93xm
max_memory 4000 MB (current use 5134 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.755922874727

WARN: Singularity detected in overlap matrix (condition number = 98.8). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.113183134036075  LUMO (B3u) = -0.113183134036075

WARN: B2u HOMO -0.113183134036075 > system LUMO -0.113183134036075

cycle= 1 E= -75.287473469352  delta_E= -0.532  |g|= 0.242  |ddm|= 1.48
HOMO (B2u) = -0.370939595595209  LUMO (B3u) = -0.0596135835397201
cycle= 2 E= -75.3109303175841  delta_E= -0.0235  |g|= 0.0489  |ddm|= 0.349
HOMO (B2u) = -0.335857476925405  LUMO (B3u) = -0.0198166980956899
cycle= 3 E= -75.3123050204643  delta_E= -0.00137  |g|= 0.0178  |ddm|= 0.0646
HOMO (B2u) = -0.340305747412609  LUMO (B3u) = -0.0241187549333964
cycle= 4 E= -75.3125256665475  delta_E= -0.000221  |g|= 0.000662  |ddm|= 0.0362
HOMO (B2u) = -0.340473004463874  LUMO (B3u) = -0.0244347316795402
cycle= 5 E= -75.3125258326695  delta_E= -1.66e-07  |g|= 0.000114  |ddm|= 0.000883
HOMO (B2u) = -0.340435552234747  LUMO (B3u) = -0.0244019229355891
cycle= 6 E= -75.3125258401167  delta_E= -7.45e-09  |g|= 1.75e-05  |ddm|= 0.000196
HOMO (B2u) = -0.340433109442996  LUMO (B3u) = -0.0244024220699501
cycle= 7 E= -75.3125258403105  delta_E= -1.94e-10  |g|= 1.93e-06  |ddm|= 3.69e-05
HOMO (B2u) = -0.340432553987336  LUMO (B3u) = -0.0244022873481917
cycle= 8 E= -75.3125258403128  delta_E= -2.3e-12  |g|= 1.26e-07  |ddm|= 4e-06
HOMO (B2u) = -0.340432558917047  LUMO (B3u) = -0.0244022873230074
cycle= 9 E= -75.3125258403128  delta_E= -2.84e-14  |g|= 8.37e-09  |ddm|= 2.82e-07
HOMO (B2u) = -0.340432558754947  LUMO (B3u) = -0.0244022890121892
cycle= 10 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 6.6e-09  |ddm|= 7.96e-09
HOMO (B2u) = -0.340432558578542  LUMO (B3u) = -0.0244022888598054
cycle= 11 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 4.82e-09  |ddm|= 5.19e-09
HOMO (B2u) = -0.340432557195132  LUMO (B3u) = -0.024402287416901
cycle= 12 E= -75.312525840313  delta_E= -1.42e-13  |g|= 4.25e-09  |ddm|= 2.4e-09
HOMO (B2u) = -0.340432557527146  LUMO (B3u) = -0.0244022877527925
cycle= 13 E= -75.3125258403129  delta_E= 5.68e-14  |g|= 3.83e-09  |ddm|= 1.59e-09
HOMO (B2u) = -0.340432557415096  LUMO (B3u) = -0.0244022876441997
cycle= 14 E= -75.3125258403129  delta_E= 2.84e-14  |g|= 3.17e-09  |ddm|= 1.55e-09
HOMO (B2u) = -0.340432557231977  LUMO (B3u) = -0.0244022875215862
cycle= 15 E= -75.3125258403129  delta_E=    0  |g|= 9.91e-10  |ddm|= 5.61e-09
HOMO (B2u) = -0.340432557132607  LUMO (B3u) = -0.0244022875080979
cycle= 16 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 9.51e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.340432557163374  LUMO (B3u) = -0.0244022874951745
cycle= 17 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 1.02e-09  |ddm|= 8.59e-10
HOMO (B2u) = -0.34043255712963  LUMO (B3u) = -0.0244022874689911
cycle= 18 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 7.86e-10  |ddm|= 5.81e-10
HOMO (B2u) = -0.340432557127468  LUMO (B3u) = -0.0244022874756969
cycle= 19 E= -75.3125258403128  delta_E= 8.53e-14  |g|= 6.48e-10  |ddm|= 4.67e-10
HOMO (B2u) = -0.340432557128436  LUMO (B3u) = -0.0244022874838917
cycle= 20 E= -75.3125258403128  delta_E= -2.84e-14  |g|= 5.37e-10  |ddm|= 3.25e-10
HOMO (B2u) = -0.340432557114878  LUMO (B3u) = -0.0244022874745592
cycle= 21 E= -75.3125258403129  delta_E= -2.84e-14  |g|= 4.2e-10  |ddm|= 2.9e-10
HOMO (B2u) = -0.340432557105277  LUMO (B3u) = -0.0244022874701126
cycle= 22 E= -75.3125258403128  delta_E= 2.84e-14  |g|= 3.06e-10  |ddm|= 2.69e-10
HOMO (B2u) = -0.340432557096  LUMO (B3u) = -0.0244022874658634
cycle= 23 E= -75.3125258403129  delta_E= -5.68e-14  |g|= 2.17e-10  |ddm|= 2.24e-10
HOMO (B2u) = -0.340432557089279  LUMO (B3u) = -0.0244022874625686
cycle= 24 E= -75.3125258403129  delta_E=    0  |g|= 1.88e-10  |ddm|= 7.9e-11
HOMO (B2u) = -0.34043255708676  LUMO (B3u) = -0.0244022874599234
cycle= 25 E= -75.3125258403128  delta_E= 1.14e-13  |g|= 1.58e-10  |ddm|= 7.17e-11
HOMO (B2u) = -0.340432557082767  LUMO (B3u) = -0.0244022874574695
cycle= 26 E= -75.3125258403128  delta_E= -5.68e-14  |g|= 1.28e-10  |ddm|= 7.98e-11
HOMO (B2u) = -0.340432557079513  LUMO (B3u) = -0.0244022874554742
cycle= 27 E= -75.3125258403128  delta_E= 5.68e-14  |g|= 1.06e-10  |ddm|= 6.11e-11
HOMO (B2u) = -0.340432557076834  LUMO (B3u) = -0.0244022874537976
cycle= 28 E= -75.3125258403128  delta_E=    0  |g|= 8.57e-11  |ddm|= 5.1e-11
HOMO (B2u) = -0.340432557070014  LUMO (B3u) = -0.0244022874496095
Extra cycle  E= -75.3125258403128  delta_E=    0  |g|= 3.07e-11  |ddm|= 1.34e-10
converged SCF energy = -75.3125258403128

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpfmao93xm
max_memory 4000 MB (current use 5134 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4401587585067  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.454582028033  dE = -0.01442327  S^2 = 0.0000000
               |grad[o]|=0.0942  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4662731313429  dE = -0.011691103  S^2 = 0.0000000
               |grad[o]|=0.0778  |ddm|=0.0854  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4747186173543  dE = -0.008445486  S^2 = 0.0000000
               |grad[o]|=0.059  |ddm|=0.0439  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4804815517941  dE = -0.0057629344  S^2 = 0.0000000
               |grad[o]|= 0.04  |ddm|=0.0656  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4831482680068  dE = -0.0026667162  S^2 = 0.0000000
               |grad[o]|=0.0214  |ddm|=0.0733  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4838263888523  dE = -0.00067812085  S^2 = 0.0000000
               |grad[o]|=0.00923  |ddm|=0.0307  |maxRot[o]|= 0.04
macro iter 7 (4 JK  0 micro), CASSCF E = -75.4840373805921  dE = -0.00021099174  S^2 = 0.0000000
               |grad[o]|=0.00452  |ddm|=0.0109  |maxRot[o]|=0.0302
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4840578015726  dE = -2.0420981e-05  S^2 = 0.0000000
               |grad[o]|=0.00157  |ddm|=0.00639  |maxRot[o]|= 0.01
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4840596374038  dE = -1.8358311e-06  S^2 = 0.0000000
               |grad[o]|=0.000514  |ddm|=0.00193  |maxRot[o]|=0.00306
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4840597985685  dE = -1.6116468e-07  S^2 = 0.0000000
               |grad[o]|=0.000153  |ddm|=0.00059  |maxRot[o]|=0.000904
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4840598125583  dE = -1.3989862e-08  S^2 = 0.0000000
               |grad[o]|=4.79e-05  |ddm|=0.000175  |maxRot[o]|=0.000268
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4840598137758  dE = -1.2174723e-09  S^2 = 0.0000000
               |grad[o]|=1.41e-05  |ddm|=5.18e-05  |maxRot[o]|=7.9e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4840598138814  dE = -1.0561507e-10  S^2 = 0.0000000
               |grad[o]|=4.22e-06  |ddm|=1.53e-05  |maxRot[o]|=2.34e-05
macro iter 14 (2 JK  0 micro), CASSCF E = -75.4840598138905  dE = -9.094947e-12  S^2 = 0.0000000
               |grad[o]|=1.24e-06  |ddm|=4.51e-06  |maxRot[o]|=6.88e-06
2-step CASSCF converged in 14 macro (56 JK 14 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95901066 1.93191387 1.8886991  1.76663822 0.07041578 0.23918108
 0.05753793 0.08660336]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01153   0.01022  -0.00378   0.00000   0.00000
  0 C 2s       0.66488   0.66240  -0.23954  -0.00000  -0.00000
  0 C 3s      -0.00763   0.01613  -0.03939  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69368
  0 C 2py      0.00000  -0.00000  -0.00000   0.70438  -0.00000
  0 C 2pz      0.23883  -0.24630   0.66308  -0.00000  -0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06285
  0 C 3py     -0.00000  -0.00000  -0.00000   0.05282  -0.00000
  0 C 3pz     -0.01454  -0.00188   0.00916  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000  -0.00000  -0.00000   0.03256  -0.00000
  0 C 3dz^2    0.02207  -0.01238   0.03528  -0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.12191
 0 C 3dx2-y2   0.00028   0.00654  -0.00728   0.00000  -0.00000
  1 C 1s       0.01153  -0.01022  -0.00378   0.00000   0.00000
  1 C 2s       0.66488  -0.66240  -0.23954   0.00000   0.00000
  1 C 3s      -0.00763  -0.01613  -0.03939   0.00000   0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69368
  1 C 2py      0.00000  -0.00000   0.00000   0.70438   0.00000
  1 C 2pz     -0.23883  -0.24630  -0.66308   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06285
  1 C 3py     -0.00000   0.00000   0.00000   0.05282   0.00000
  1 C 3pz      0.01454  -0.00188  -0.00916  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03256  -0.00000
  1 C 3dz^2    0.02207   0.01238   0.03528   0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000  -0.00000   0.00000   0.12191
 1 C 3dx2-y2   0.00028  -0.00654  -0.00728   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00035
  0 C 2s      -0.00000  -0.00000   0.24517
  0 C 3s      -0.00000  -0.00000   0.03335
  0 C 2px     -0.00000   0.69791  -0.00000
  0 C 2py      0.70694   0.00000   0.00000
  0 C 2pz     -0.00000  -0.00000   0.66096
  0 C 3px      0.00000  -0.00931  -0.00000
  0 C 3py     -0.01055  -0.00000   0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03822
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.01090  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00694
  0 C 3dxz     0.00000  -0.11326  -0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01984
  1 C 1s       0.00000   0.00000   0.00035
  1 C 2s       0.00000   0.00000  -0.24517
  1 C 3s       0.00000   0.00000  -0.03335
  1 C 2px     -0.00000  -0.69791  -0.00000
  1 C 2py     -0.70694   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.66096
  1 C 3px      0.00000   0.00931   0.00000
  1 C 3py      0.01055  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03822
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.01090   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00694
  1 C 3dxz    -0.00000  -0.11326  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01984
<CAS-nat-orb|mo-hf>  3  3    0.99958549
<CAS-nat-orb|mo-hf>  4  4    0.99970353
<CAS-nat-orb|mo-hf>  5  5    0.99960080
<CAS-nat-orb|mo-hf>  6  6    0.99894173
<CAS-nat-orb|mo-hf>  7  7    0.93559186
<CAS-nat-orb|mo-hf>  8  8    0.97993346
<CAS-nat-orb|mo-hf>  9  9    0.96008674
<CAS-nat-orb|mo-hf>  10  10    0.92430540
CASSCF energy = -75.4840598138905
CASCI E = -75.4840598138905  E(CI) = -15.2745978794695  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.009

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.080
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.014
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.012
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.125
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.04
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.240 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.149 | Tfpread = 0.000 | Tfpwrite = 0.147 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.135 | E =     -75.5748456332 | DW = 1.59e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.317 | E =     -75.6008961510 | DE = -2.61e-02 | DW = 6.36e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.107 | E =     -75.6014015295 | DE = -5.05e-04 | DW = 1.62e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.920 | E =     -75.6018967291 | DE = -4.95e-04 | DW = 7.49e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.655 | E =     -75.6019202062 | DE = -2.35e-05 | DW = 1.63e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.413 | E =     -75.6019664739 | DE = -4.63e-05 | DW = 7.82e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.085 | E =     -75.6019872089 | DE = -2.07e-05 | DW = 1.67e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.897 | E =     -75.6020131592 | DE = -2.60e-05 | DW = 8.03e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     11.118 | E =     -75.6030941816 | DE = -1.08e-03 | DW = 1.50e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     19.578 | E =     -75.6036285318 | DE = -5.34e-04 | DW = 2.31e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     25.115 | E =     -75.6037720038 | DE = -1.43e-04 | DW = 4.19e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.418 | E =     -75.6038204977 | DE = -4.85e-05 | DW = 2.98e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.544 | E =     -75.6038323421 | DE = -1.18e-05 | DW = 4.24e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.286 | E =     -75.6038377739 | DE = -5.43e-06 | DW = 2.96e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     45.091 | E =     -75.6038432933 | DE = -5.52e-06 | DW = 4.25e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     49.810 | E =     -75.6038485872 | DE = -5.29e-06 | DW = 3.02e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     58.952 | E =     -75.6039940530 | DE = -1.45e-04 | DW = 2.76e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     74.029 | E =     -75.6040355739 | DE = -4.15e-05 | DW = 1.99e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     86.259 | E =     -75.6040439351 | DE = -8.36e-06 | DW = 4.51e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    100.173 | E =     -75.6040467184 | DE = -2.78e-06 | DW = 2.05e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.117 | E =     -75.6040489823 | DE = -2.26e-06 | DW = 4.48e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    124.093 | E =     -75.6040512808 | DE = -2.30e-06 | DW = 2.06e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    135.225 | E =     -75.6040534265 | DE = -2.15e-06 | DW = 4.50e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    147.315 | E =     -75.6040544837 | DE = -1.06e-06 | DW = 1.93e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    170.561 | E =     -75.6040650007 | DE = -1.05e-05 | DW = 2.38e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    198.731 | E =     -75.6040685946 | DE = -3.59e-06 | DW = 1.07e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    226.686 | E =     -75.6040705812 | DE = -1.99e-06 | DW = 2.86e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    253.465 | E =     -75.6040708850 | DE = -3.04e-07 | DW = 9.19e-08

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    281.073 | E =     -75.6040726166 | DE = -1.73e-06 | DW = 2.85e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    307.548 | E =     -75.6040728842 | DE = -2.68e-07 | DW = 9.17e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    335.844 | E =     -75.6040745426 | DE = -1.66e-06 | DW = 2.83e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    363.081 | E =     -75.6040747835 | DE = -2.41e-07 | DW = 9.17e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    579.020 | E =     -75.6041055920 | DE = -3.08e-05 | DW = 5.22e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    714.761 | E =     -75.6041055920 | DE = -8.30e-11 | DW = 5.22e-08

E(MRCI) = -75.60410559204178  E_corr = -0.1200457781512654
Time cost =    836.428
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 21:28:06 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.905037959312 AA    0.000000000000   0.000000000000   3.600000000000 Bohr   0.0

nuclear repulsion = 10
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.8]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    340613.34


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpe212suiu
max_memory 4000 MB (current use 5136 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7418315703506

WARN: Singularity detected in overlap matrix (condition number = 92.3). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.11001988110011  LUMO (B3u) = -0.11001988110011

WARN: B2u HOMO -0.11001988110011 > system LUMO -0.11001988110011

cycle= 1 E= -75.2796395081188  delta_E= -0.538  |g|= 0.24  |ddm|= 1.48
HOMO (B2u) = -0.366960154497  LUMO (B3u) = -0.0572442637655636
cycle= 2 E= -75.3027407260661  delta_E= -0.0231  |g|= 0.0483  |ddm|= 0.349
HOMO (B2u) = -0.332387624443795  LUMO (B3u) = -0.0179860460523905
cycle= 3 E= -75.3040943705399  delta_E= -0.00135  |g|= 0.0177  |ddm|= 0.0637
HOMO (B2u) = -0.336815650622684  LUMO (B3u) = -0.0222589901147891
cycle= 4 E= -75.3043133588736  delta_E= -0.000219  |g|= 0.000659  |ddm|= 0.0358
HOMO (B2u) = -0.336986521904539  LUMO (B3u) = -0.0225780980112818
cycle= 5 E= -75.3043135231658  delta_E= -1.64e-07  |g|= 0.000118  |ddm|= 0.000867
HOMO (B2u) = -0.336949107818825  LUMO (B3u) = -0.0225461573189892
cycle= 6 E= -75.304313531111  delta_E= -7.95e-09  |g|= 1.79e-05  |ddm|= 0.000202
HOMO (B2u) = -0.336946583100421  LUMO (B3u) = -0.0225465689188807
cycle= 7 E= -75.3043135313143  delta_E= -2.03e-10  |g|= 1.93e-06  |ddm|= 3.75e-05
HOMO (B2u) = -0.33694605225586  LUMO (B3u) = -0.0225464651749517
cycle= 8 E= -75.3043135313167  delta_E= -2.39e-12  |g|= 1.28e-07  |ddm|= 3.99e-06
HOMO (B2u) = -0.336946056653499  LUMO (B3u) = -0.0225464645227561
cycle= 9 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 8.64e-09  |ddm|= 2.92e-07
HOMO (B2u) = -0.336946056352744  LUMO (B3u) = -0.0225464661350554
cycle= 10 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 6.9e-09  |ddm|= 7.93e-09
HOMO (B2u) = -0.336946056204075  LUMO (B3u) = -0.022546466027244
cycle= 11 E= -75.3043135313167  delta_E=    0  |g|= 5e-09  |ddm|= 5.47e-09
HOMO (B2u) = -0.336946054829705  LUMO (B3u) = -0.0225464645959414
cycle= 12 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 4.37e-09  |ddm|= 2.55e-09
HOMO (B2u) = -0.336946055134035  LUMO (B3u) = -0.0225464649077606
cycle= 13 E= -75.3043135313167  delta_E=    0  |g|= 3.93e-09  |ddm|= 1.64e-09
HOMO (B2u) = -0.336946055006462  LUMO (B3u) = -0.0225464647809869
cycle= 14 E= -75.3043135313167  delta_E= -1.42e-14  |g|= 3.23e-09  |ddm|= 1.79e-09
HOMO (B2u) = -0.33694605481691  LUMO (B3u) = -0.0225464646820566
cycle= 15 E= -75.3043135313167  delta_E=    0  |g|= 1.03e-09  |ddm|= 5.76e-09
HOMO (B2u) = -0.336946054733919  LUMO (B3u) = -0.0225464646668242
cycle= 16 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 1.01e-09  |ddm|= 1.16e-09
HOMO (B2u) = -0.336946054756348  LUMO (B3u) = -0.0225464646548156
cycle= 17 E= -75.3043135313167  delta_E= -5.68e-14  |g|= 1.07e-09  |ddm|= 6.91e-10
HOMO (B2u) = -0.336946054720463  LUMO (B3u) = -0.0225464646290975
cycle= 18 E= -75.3043135313167  delta_E= 4.26e-14  |g|= 8.28e-10  |ddm|= 6.21e-10
HOMO (B2u) = -0.336946054716361  LUMO (B3u) = -0.0225464646352981
cycle= 19 E= -75.3043135313166  delta_E= 2.84e-14  |g|= 6.75e-10  |ddm|= 5.08e-10
HOMO (B2u) = -0.336946054716006  LUMO (B3u) = -0.0225464646432749
cycle= 20 E= -75.3043135313166  delta_E= 4.26e-14  |g|= 5.55e-10  |ddm|= 3.53e-10
HOMO (B2u) = -0.336946054701177  LUMO (B3u) = -0.0225464646337962
cycle= 21 E= -75.3043135313167  delta_E= -9.95e-14  |g|= 4.34e-10  |ddm|= 3.09e-10
HOMO (B2u) = -0.336946054690181  LUMO (B3u) = -0.0225464646289064
cycle= 22 E= -75.3043135313167  delta_E= 1.42e-14  |g|= 3.16e-10  |ddm|= 2.86e-10
HOMO (B2u) = -0.336946054679549  LUMO (B3u) = -0.0225464646243564
cycle= 23 E= -75.3043135313166  delta_E= 7.11e-14  |g|= 2.25e-10  |ddm|= 2.36e-10
HOMO (B2u) = -0.336946054672853  LUMO (B3u) = -0.0225464646210285
cycle= 24 E= -75.3043135313166  delta_E= -2.84e-14  |g|= 1.95e-10  |ddm|= 8.13e-11
HOMO (B2u) = -0.336946054669537  LUMO (B3u) = -0.0225464646182657
cycle= 25 E= -75.3043135313167  delta_E= -2.84e-14  |g|= 1.63e-10  |ddm|= 7.74e-11
HOMO (B2u) = -0.336946054665105  LUMO (B3u) = -0.0225464646157189
cycle= 26 E= -75.3043135313166  delta_E= 4.26e-14  |g|= 1.31e-10  |ddm|= 8.61e-11
HOMO (B2u) = -0.336946054661539  LUMO (B3u) = -0.0225464646136726
cycle= 27 E= -75.3043135313166  delta_E= 1.42e-14  |g|= 1.08e-10  |ddm|= 6.62e-11
HOMO (B2u) = -0.336946054658601  LUMO (B3u) = -0.0225464646119541
cycle= 28 E= -75.3043135313165  delta_E= 1.42e-13  |g|= 8.69e-11  |ddm|= 5.42e-11
HOMO (B2u) = -0.336946054656287  LUMO (B3u) = -0.0225464646106319
cycle= 29 E= -75.3043135313164  delta_E= 4.26e-14  |g|= 6.88e-11  |ddm|= 4.51e-11
HOMO (B2u) = -0.336946054654358  LUMO (B3u) = -0.0225464646095273
cycle= 30 E= -75.3043135313164  delta_E= 5.68e-14  |g|= 5.45e-11  |ddm|= 3.55e-11
HOMO (B2u) = -0.336946054652903  LUMO (B3u) = -0.0225464646087119
cycle= 31 E= -75.3043135313162  delta_E= 1.71e-13  |g|= 4.43e-11  |ddm|= 2.6e-11
HOMO (B2u) = -0.336946054651859  LUMO (B3u) = -0.0225464646081071
cycle= 32 E= -75.304313531316  delta_E= 2.42e-13  |g|= 3.72e-11  |ddm|= 1.83e-11
HOMO (B2u) = -0.336946054651024  LUMO (B3u) = -0.0225464646075892
cycle= 33 E= -75.3043135313158  delta_E= 1.14e-13  |g|= 3.13e-11  |ddm|= 1.59e-11
HOMO (B2u) = -0.336946054650276  LUMO (B3u) = -0.0225464646071504
cycle= 34 E= -75.3043135313156  delta_E= 2.13e-13  |g|= 2.66e-11  |ddm|= 1.34e-11
HOMO (B2u) = -0.336946054649659  LUMO (B3u) = -0.0225464646067815
cycle= 35 E= -75.3043135313153  delta_E= 3.69e-13  |g|= 2.29e-11  |ddm|= 1.08e-11
HOMO (B2u) = -0.336946054649136  LUMO (B3u) = -0.0225464646064567
cycle= 36 E= -75.3043135313148  delta_E= 4.83e-13  |g|= 1.96e-11  |ddm|= 9.1e-12
HOMO (B2u) = -0.336946054648687  LUMO (B3u) = -0.0225464646061657
cycle= 37 E= -75.3043135313142  delta_E= 5.68e-13  |g|= 1.7e-11  |ddm|= 7.54e-12
HOMO (B2u) = -0.336946054648295  LUMO (B3u) = -0.0225464646059003
cycle= 38 E= -75.3043135313138  delta_E= 4.12e-13  |g|= 1.48e-11  |ddm|= 6.24e-12
HOMO (B2u) = -0.336946054647947  LUMO (B3u) = -0.0225464646056519
cycle= 39 E= -75.3043135313132  delta_E= 5.68e-13  |g|= 1.29e-11  |ddm|= 5.33e-12
HOMO (B2u) = -0.336946054647627  LUMO (B3u) = -0.0225464646054094
cycle= 40 E= -75.3043135313125  delta_E= 7.11e-13  |g|= 1.15e-11  |ddm|= 4.43e-12
HOMO (B2u) = -0.336946054647315  LUMO (B3u) = -0.0225464646051576
cycle= 41 E= -75.3043135313117  delta_E= 7.67e-13  |g|= 1.01e-11  |ddm|= 4.17e-12
HOMO (B2u) = -0.336946054647001  LUMO (B3u) = -0.0225464646048902
cycle= 42 E= -75.304313531311  delta_E= 7.11e-13  |g|= 9.08e-12  |ddm|= 3.5e-12
HOMO (B2u) = -0.336946054646684  LUMO (B3u) = -0.0225464646046069
cycle= 43 E= -75.3043135313104  delta_E= 6.25e-13  |g|= 8.08e-12  |ddm|= 3.01e-12
HOMO (B2u) = -0.336946054646367  LUMO (B3u) = -0.0225464646043096
cycle= 44 E= -75.3043135313098  delta_E= 5.97e-13  |g|= 7.38e-12  |ddm|= 2.7e-12
HOMO (B2u) = -0.336946054646049  LUMO (B3u) = -0.022546464604003
cycle= 45 E= -75.3043135313093  delta_E= 5.12e-13  |g|= 6.59e-12  |ddm|= 2.37e-12
HOMO (B2u) = -0.336946054645731  LUMO (B3u) = -0.0225464646036864
cycle= 46 E= -75.3043135313086  delta_E= 7.11e-13  |g|= 6.22e-12  |ddm|= 2.26e-12
HOMO (B2u) = -0.336946054645403  LUMO (B3u) = -0.0225464646033532
cycle= 47 E= -75.3043135313079  delta_E= 7.11e-13  |g|= 6.02e-12  |ddm|= 2.12e-12
HOMO (B2u) = -0.336946054645064  LUMO (B3u) = -0.0225464646030041
cycle= 48 E= -75.3043135313074  delta_E= 5.12e-13  |g|= 5.56e-12  |ddm|= 2.3e-12
HOMO (B2u) = -0.336946054644728  LUMO (B3u) = -0.0225464646026561
cycle= 49 E= -75.3043135313068  delta_E= 5.4e-13  |g|= 5.17e-12  |ddm|= 2.13e-12
HOMO (B2u) = -0.336946054644397  LUMO (B3u) = -0.0225464646023124
cycle= 50 E= -75.3043135313063  delta_E= 4.83e-13  |g|= 4.6e-12  |ddm|= 2.26e-12
SCF not converged.
SCF energy = -75.3043135313063

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpe212suiu
max_memory 4000 MB (current use 5136 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4361879187434  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4510674042747  dE = -0.014879486  S^2 = 0.0000000
               |grad[o]|=0.0962  |ddm|=  3.8  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4629189235359  dE = -0.011851519  S^2 = 0.0000000
               |grad[o]|=0.0783  |ddm|=0.0904  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4711959375459  dE = -0.008277014  S^2 = 0.0000000
               |grad[o]|=0.0578  |ddm|=0.0437  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4766896839062  dE = -0.0054937464  S^2 = 0.0000000
               |grad[o]|=0.0374  |ddm|=0.0747  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4787687090211  dE = -0.0020790251  S^2 = 0.0000000
               |grad[o]|=0.0177  |ddm|=0.0719  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4793255751277  dE = -0.00055686611  S^2 = 0.0000000
               |grad[o]|=0.00796  |ddm|=0.0238  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4794395830804  dE = -0.00011400795  S^2 = 0.0000000
               |grad[o]|=0.00351  |ddm|=0.00912  |maxRot[o]|= 0.02
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4794610609728  dE = -2.1477892e-05  S^2 = 0.0000000
               |grad[o]|=0.00156  |ddm|=0.00383  |maxRot[o]|=0.0103
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4794629155068  dE = -1.854534e-06  S^2 = 0.0000000
               |grad[o]|=0.000524  |ddm|=0.0019  |maxRot[o]|=0.00308
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4794630731664  dE = -1.5765967e-07  S^2 = 0.0000000
               |grad[o]|=0.000157  |ddm|=0.000572  |maxRot[o]|=0.000897
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4794630864324  dE = -1.3266003e-08  S^2 = 0.0000000
               |grad[o]|=4.79e-05  |ddm|=0.000168  |maxRot[o]|=0.000261
macro iter 12 (3 JK  0 micro), CASSCF E = -75.4794630875505  dE = -1.1180816e-09  S^2 = 0.0000000
               |grad[o]|=1.38e-05  |ddm|=4.9e-05  |maxRot[o]|=7.6e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4794630876439  dE = -9.3407948e-11  S^2 = 0.0000000
               |grad[o]|=4.16e-06  |ddm|=1.42e-05  |maxRot[o]|=2.21e-05
2-step CASSCF converged in 13 macro (53 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95829685 1.93254562 1.88457147 1.75318651 0.06913522 0.25249636
 0.05723696 0.09253102]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01171   0.01031  -0.00343   0.00000   0.00000
  0 C 2s       0.67180   0.66526  -0.21945   0.00000  -0.00000
  0 C 3s      -0.00547   0.01587  -0.03746   0.00000   0.00000
  0 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69361
  0 C 2py      0.00000   0.00000   0.00000   0.70438   0.00000
  0 C 2pz      0.21892  -0.23851   0.67009   0.00000  -0.00000
  0 C 3px      0.00000   0.00000   0.00000   0.00000  -0.06384
  0 C 3py      0.00000   0.00000   0.00000   0.05350  -0.00000
  0 C 3pz     -0.01342  -0.00181   0.01074   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000   0.03134   0.00000
  0 C 3dz^2    0.02038  -0.01199   0.03514   0.00000   0.00000
  0 C 3dxz     0.00000   0.00000   0.00000  -0.00000  -0.12178
 0 C 3dx2-y2   0.00055   0.00643  -0.00721  -0.00000  -0.00000
  1 C 1s       0.01171  -0.01031  -0.00343   0.00000   0.00000
  1 C 2s       0.67180  -0.66526  -0.21945  -0.00000  -0.00000
  1 C 3s      -0.00547  -0.01587  -0.03746  -0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69361
  1 C 2py     -0.00000  -0.00000   0.00000   0.70438  -0.00000
  1 C 2pz     -0.21892  -0.23851  -0.67009   0.00000  -0.00000
  1 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06384
  1 C 3py     -0.00000  -0.00000  -0.00000   0.05350  -0.00000
  1 C 3pz      0.01342  -0.00181  -0.01074   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000   0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000  -0.03134   0.00000
  1 C 3dz^2    0.02038   0.01199   0.03514  -0.00000   0.00000
  1 C 3dxz    -0.00000   0.00000   0.00000   0.00000   0.12178
 1 C 3dx2-y2   0.00055  -0.00643  -0.00721   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00032
  0 C 2s       0.00000  -0.00000   0.23748
  0 C 3s      -0.00000  -0.00000   0.03235
  0 C 2px      0.00000   0.69804  -0.00000
  0 C 2py      0.70698  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.66400
  0 C 3px     -0.00000  -0.01120  -0.00000
  0 C 3py     -0.00856  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03555
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.01047  -0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00616
  0 C 3dxz    -0.00000  -0.11230  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01875
  1 C 1s       0.00000   0.00000   0.00032
  1 C 2s       0.00000  -0.00000  -0.23748
  1 C 3s       0.00000   0.00000  -0.03235
  1 C 2px      0.00000  -0.69804   0.00000
  1 C 2py     -0.70698   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66400
  1 C 3px     -0.00000   0.01120   0.00000
  1 C 3py      0.00856   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03555
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.01047  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00616
  1 C 3dxz     0.00000  -0.11230  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01875
<CAS-nat-orb|mo-hf>  3  3    0.99985292
<CAS-nat-orb|mo-hf>  4  4    0.99969360
<CAS-nat-orb|mo-hf>  5  5    0.99986456
<CAS-nat-orb|mo-hf>  6  6    0.99888267
<CAS-nat-orb|mo-hf>  7  7    0.93493360
<CAS-nat-orb|mo-hf>  8  8    0.98111604
<CAS-nat-orb|mo-hf>  9  9    0.96025422
<CAS-nat-orb|mo-hf>  10  10    0.93117475
CASSCF energy = -75.4794630876439
CASCI E = -75.4794630876439  E(CI) = -15.2075075478094  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.010

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.028
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.013
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.009
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.069
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.03
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.06
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.439 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.224 | Tfpread = 0.000 | Tfpwrite = 0.221 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.422 | E =     -75.5698582087 | DW = 1.60e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.652 | E =     -75.5964800288 | DE = -2.66e-02 | DW = 6.41e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.522 | E =     -75.5969661440 | DE = -4.86e-04 | DW = 1.61e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.356 | E =     -75.5974570929 | DE = -4.91e-04 | DW = 7.38e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.073 | E =     -75.5974776040 | DE = -2.05e-05 | DW = 1.59e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.851 | E =     -75.5975210780 | DE = -4.35e-05 | DW = 7.66e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.562 | E =     -75.5975385828 | DE = -1.75e-05 | DW = 1.64e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.492 | E =     -75.5975697320 | DE = -3.11e-05 | DW = 7.89e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     10.817 | E =     -75.5986547409 | DE = -1.09e-03 | DW = 1.51e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.839 | E =     -75.5991853727 | DE = -5.31e-04 | DW = 2.37e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     18.401 | E =     -75.5993332903 | DE = -1.48e-04 | DW = 4.25e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     21.256 | E =     -75.5993827409 | DE = -4.95e-05 | DW = 3.04e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.960 | E =     -75.5993944384 | DE = -1.17e-05 | DW = 4.30e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.819 | E =     -75.5993997334 | DE = -5.29e-06 | DW = 3.02e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.540 | E =     -75.5994070243 | DE = -7.29e-06 | DW = 4.33e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.849 | E =     -75.5994124991 | DE = -5.47e-06 | DW = 3.08e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.786 | E =     -75.5995605451 | DE = -1.48e-04 | DW = 2.75e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     57.880 | E =     -75.5996029223 | DE = -4.24e-05 | DW = 2.00e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     67.734 | E =     -75.5996118821 | DE = -8.96e-06 | DW = 4.57e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     78.002 | E =     -75.5996147874 | DE = -2.91e-06 | DW = 2.08e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     87.317 | E =     -75.5996175807 | DE = -2.79e-06 | DW = 4.56e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    101.683 | E =     -75.5996188266 | DE = -1.25e-06 | DW = 1.95e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    115.328 | E =     -75.5996221329 | DE = -3.31e-06 | DW = 4.57e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    128.766 | E =     -75.5996231453 | DE = -1.01e-06 | DW = 1.95e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    150.908 | E =     -75.5996337329 | DE = -1.06e-05 | DW = 2.38e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    180.780 | E =     -75.5996373885 | DE = -3.66e-06 | DW = 1.09e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    208.080 | E =     -75.5996394324 | DE = -2.04e-06 | DW = 2.88e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    236.758 | E =     -75.5996402344 | DE = -8.02e-07 | DW = 1.15e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    263.717 | E =     -75.5996418361 | DE = -1.60e-06 | DW = 2.84e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    290.520 | E =     -75.5996421191 | DE = -2.83e-07 | DW = 9.33e-08

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    325.007 | E =     -75.5996438108 | DE = -1.69e-06 | DW = 2.85e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    349.640 | E =     -75.5996440625 | DE = -2.52e-07 | DW = 9.33e-08

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    597.882 | E =     -75.5996760903 | DE = -3.20e-05 | DW = 5.29e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    747.656 | E =     -75.5996760904 | DE = -1.16e-10 | DW = 5.29e-08

E(MRCI) = -75.59967609039171  E_corr = -0.120213002747775
Time cost =    812.608
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 21:41:39 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.931496819858 AA    0.000000000000   0.000000000000   3.650000000000 Bohr   0.0

nuclear repulsion = 9.86301369863014
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.825]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    354667.77


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmphzsyjkg9
max_memory 4000 MB (current use 5094 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7286668554631

WARN: Singularity detected in overlap matrix (condition number = 86.3). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.107001630831574  LUMO (B3u) = -0.107001630831574

WARN: B2u HOMO -0.107001630831574 > system LUMO -0.107001630831574

cycle= 1 E= -75.2718520447977  delta_E= -0.543  |g|= 0.238  |ddm|= 1.48
HOMO (B2u) = -0.363117515186497  LUMO (B3u) = -0.0549592840356633
cycle= 2 E= -75.2946135925964  delta_E= -0.0228  |g|= 0.0477  |ddm|= 0.349
HOMO (B2u) = -0.329037998444989  LUMO (B3u) = -0.0162218724304535
cycle= 3 E= -75.2959451182036  delta_E= -0.00133  |g|= 0.0175  |ddm|= 0.0628
HOMO (B2u) = -0.333444355785578  LUMO (B3u) = -0.0204649331299245
cycle= 4 E= -75.2961620440469  delta_E= -0.000217  |g|= 0.000656  |ddm|= 0.0354
HOMO (B2u) = -0.333615190019287  LUMO (B3u) = -0.0207831790531227
cycle= 5 E= -75.2961622069416  delta_E= -1.63e-07  |g|= 0.000121  |ddm|= 0.000855
HOMO (B2u) = -0.333577969876335  LUMO (B3u) = -0.0207522115134184
cycle= 6 E= -75.2961622153582  delta_E= -8.42e-09  |g|= 1.83e-05  |ddm|= 0.000208
HOMO (B2u) = -0.333575376692481  LUMO (B3u) = -0.0207525487418174
cycle= 7 E= -75.2961622155709  delta_E= -2.13e-10  |g|= 1.93e-06  |ddm|= 3.81e-05
HOMO (B2u) = -0.333574868730931  LUMO (B3u) = -0.0207524737519143
cycle= 8 E= -75.2961622155733  delta_E= -2.34e-12  |g|= 1.29e-07  |ddm|= 4e-06
HOMO (B2u) = -0.333574872987137  LUMO (B3u) = -0.0207524728268864
cycle= 9 E= -75.2961622155733  delta_E= -5.68e-14  |g|= 8.8e-09  |ddm|= 3e-07
HOMO (B2u) = -0.333574872571759  LUMO (B3u) = -0.0207524743926053
cycle= 10 E= -75.2961622155732  delta_E= 8.53e-14  |g|= 7.1e-09  |ddm|= 7.86e-09
HOMO (B2u) = -0.333574872450829  LUMO (B3u) = -0.0207524743252671
cycle= 11 E= -75.2961622155734  delta_E= -1.28e-13  |g|= 5.12e-09  |ddm|= 5.67e-09
HOMO (B2u) = -0.333574871097617  LUMO (B3u) = -0.0207524729163974
cycle= 12 E= -75.2961622155733  delta_E= 9.95e-14  |g|= 4.45e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.333574871371889  LUMO (B3u) = -0.0207524732023052
cycle= 13 E= -75.2961622155733  delta_E=    0  |g|= 4e-09  |ddm|= 1.72e-09
HOMO (B2u) = -0.333574871232241  LUMO (B3u) = -0.0207524730610019
cycle= 14 E= -75.2961622155733  delta_E= -5.68e-14  |g|= 3.27e-09  |ddm|= 2e-09
HOMO (B2u) = -0.333574871044342  LUMO (B3u) = -0.0207524729849
cycle= 15 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 1.05e-09  |ddm|= 6.09e-09
HOMO (B2u) = -0.333574870948568  LUMO (B3u) = -0.0207524729724885
cycle= 16 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 9.82e-10  |ddm|= 1.12e-09
HOMO (B2u) = -0.33357487098377  LUMO (B3u) = -0.0207524729552194
cycle= 17 E= -75.2961622155733  delta_E=    0  |g|= 1.1e-09  |ddm|= 1.11e-09
HOMO (B2u) = -0.333574870946634  LUMO (B3u) = -0.0207524729305071
cycle= 18 E= -75.2961622155733  delta_E= 4.26e-14  |g|= 8.5e-10  |ddm|= 6.48e-10
HOMO (B2u) = -0.333574870941364  LUMO (B3u) = -0.0207524729366941
cycle= 19 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 6.86e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.333574870940211  LUMO (B3u) = -0.0207524729448027
cycle= 20 E= -75.2961622155733  delta_E= 5.68e-14  |g|= 5.62e-10  |ddm|= 3.75e-10
HOMO (B2u) = -0.333574870924655  LUMO (B3u) = -0.0207524729356255
cycle= 21 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 4.37e-10  |ddm|= 3.24e-10
HOMO (B2u) = -0.333574870912727  LUMO (B3u) = -0.02075247293063
cycle= 22 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 3.18e-10  |ddm|= 2.97e-10
HOMO (B2u) = -0.333574870901193  LUMO (B3u) = -0.0207524729260978
cycle= 23 E= -75.2961622155733  delta_E= -2.84e-14  |g|= 2.27e-10  |ddm|= 2.46e-10
HOMO (B2u) = -0.333574870894272  LUMO (B3u) = -0.0207524729227359
cycle= 24 E= -75.2961622155733  delta_E= 2.84e-14  |g|= 1.96e-10  |ddm|= 8.28e-11
HOMO (B2u) = -0.333574870891265  LUMO (B3u) = -0.0207524729198866
cycle= 25 E= -75.2961622155733  delta_E= 1.42e-14  |g|= 1.66e-10  |ddm|= 7.51e-11
HOMO (B2u) = -0.333574870886561  LUMO (B3u) = -0.0207524729173319
cycle= 26 E= -75.2961622155733  delta_E= -4.26e-14  |g|= 1.33e-10  |ddm|= 9e-11
HOMO (B2u) = -0.333574870882817  LUMO (B3u) = -0.0207524729152981
cycle= 27 E= -75.2961622155731  delta_E= 1.56e-13  |g|= 1.08e-10  |ddm|= 6.94e-11
HOMO (B2u) = -0.333574870879732  LUMO (B3u) = -0.0207524729135876
cycle= 28 E= -75.2961622155731  delta_E= 1.42e-14  |g|= 8.72e-11  |ddm|= 5.59e-11
HOMO (B2u) = -0.333574870877294  LUMO (B3u) = -0.0207524729122674
cycle= 29 E= -75.296162215573  delta_E= 1.14e-13  |g|= 6.89e-11  |ddm|= 4.61e-11
HOMO (B2u) = -0.333574870875279  LUMO (B3u) = -0.0207524729111681
cycle= 30 E= -75.296162215573  delta_E= 5.68e-14  |g|= 5.47e-11  |ddm|= 3.62e-11
HOMO (B2u) = -0.333574870873767  LUMO (B3u) = -0.0207524729103586
cycle= 31 E= -75.2961622155728  delta_E= 1.42e-13  |g|= 4.47e-11  |ddm|= 2.64e-11
HOMO (B2u) = -0.33357487087269  LUMO (B3u) = -0.0207524729097495
cycle= 32 E= -75.2961622155727  delta_E= 1.42e-13  |g|= 3.75e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.333574870871831  LUMO (B3u) = -0.0207524729092289
cycle= 33 E= -75.2961622155725  delta_E= 2.13e-13  |g|= 3.12e-11  |ddm|= 1.61e-11
HOMO (B2u) = -0.33357487087104  LUMO (B3u) = -0.020752472908785
cycle= 34 E= -75.2961622155721  delta_E= 3.41e-13  |g|= 2.65e-11  |ddm|= 1.37e-11
HOMO (B2u) = -0.333574870870387  LUMO (B3u) = -0.0207524729084097
cycle= 35 E= -75.2961622155715  delta_E= 6.11e-13  |g|= 2.25e-11  |ddm|= 1.11e-11
HOMO (B2u) = -0.333574870869832  LUMO (B3u) = -0.0207524729080755
cycle= 36 E= -75.2961622155712  delta_E= 3.41e-13  |g|= 1.92e-11  |ddm|= 9.14e-12
HOMO (B2u) = -0.333574870869354  LUMO (B3u) = -0.0207524729077737
cycle= 37 E= -75.2961622155707  delta_E= 5.12e-13  |g|= 1.67e-11  |ddm|= 7.52e-12
HOMO (B2u) = -0.333574870868938  LUMO (B3u) = -0.020752472907498
cycle= 38 E= -75.2961622155703  delta_E= 3.69e-13  |g|= 1.45e-11  |ddm|= 6.21e-12
HOMO (B2u) = -0.333574870868567  LUMO (B3u) = -0.0207524729072354
cycle= 39 E= -75.2961622155696  delta_E= 6.54e-13  |g|= 1.25e-11  |ddm|= 5.28e-12
HOMO (B2u) = -0.333574870868223  LUMO (B3u) = -0.020752472906975
cycle= 40 E= -75.2961622155689  delta_E= 7.82e-13  |g|= 1.1e-11  |ddm|= 4.54e-12
HOMO (B2u) = -0.333574870867887  LUMO (B3u) = -0.0207524729067023
cycle= 41 E= -75.2961622155681  delta_E= 7.67e-13  |g|= 9.87e-12  |ddm|= 3.91e-12
HOMO (B2u) = -0.333574870867552  LUMO (B3u) = -0.0207524729064177
cycle= 42 E= -75.2961622155674  delta_E= 6.54e-13  |g|= 8.76e-12  |ddm|= 3.4e-12
HOMO (B2u) = -0.333574870867224  LUMO (B3u) = -0.0207524729061229
cycle= 43 E= -75.2961622155668  delta_E= 6.11e-13  |g|= 7.99e-12  |ddm|= 3.11e-12
HOMO (B2u) = -0.3335748708669  LUMO (B3u) = -0.0207524729058206
cycle= 44 E= -75.2961622155662  delta_E= 6.54e-13  |g|= 7.32e-12  |ddm|= 2.72e-12
HOMO (B2u) = -0.333574870866576  LUMO (B3u) = -0.0207524729055087
cycle= 45 E= -75.2961622155655  delta_E= 6.54e-13  |g|= 6.55e-12  |ddm|= 2.35e-12
HOMO (B2u) = -0.333574870866243  LUMO (B3u) = -0.0207524729051786
cycle= 46 E= -75.2961622155648  delta_E= 7.39e-13  |g|= 6.15e-12  |ddm|= 2.28e-12
HOMO (B2u) = -0.333574870865903  LUMO (B3u) = -0.0207524729048363
cycle= 47 E= -75.2961622155642  delta_E= 5.68e-13  |g|= 6.06e-12  |ddm|= 2.09e-12
HOMO (B2u) = -0.333574870865553  LUMO (B3u) = -0.0207524729044786
cycle= 48 E= -75.2961622155637  delta_E= 4.83e-13  |g|= 5.47e-12  |ddm|= 2.33e-12
HOMO (B2u) = -0.333574870865211  LUMO (B3u) = -0.0207524729041284
cycle= 49 E= -75.2961622155633  delta_E= 4.26e-13  |g|= 4.89e-12  |ddm|= 2.41e-12
HOMO (B2u) = -0.33357487086488  LUMO (B3u) = -0.0207524729037903
cycle= 50 E= -75.296162215563  delta_E= 2.84e-13  |g|= 4.36e-12  |ddm|= 2.52e-12
SCF not converged.
SCF energy = -75.296162215563

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmphzsyjkg9
max_memory 4000 MB (current use 5094 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.432291665502  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4476382203374  dE = -0.015346555  S^2 = 0.0000000
               |grad[o]|=0.0982  |ddm|= 3.79  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4596363662672  dE = -0.011998146  S^2 = 0.0000000
               |grad[o]|=0.0787  |ddm|=0.0955  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4677180638968  dE = -0.0080816976  S^2 = 0.0000000
               |grad[o]|=0.0566  |ddm|=0.0425  |maxRot[o]|=0.0799
macro iter 4 (6 JK  0 micro), CASSCF E = -75.4729439437055  dE = -0.0052258798  S^2 = 0.0000000
               |grad[o]|=0.0348  |ddm|=0.0843  |maxRot[o]|=0.0799
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4745190827378  dE = -0.001575139  S^2 = 0.0000000
               |grad[o]|=0.0141  |ddm|=0.0685  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4749268246372  dE = -0.0004077419  S^2 = 0.0000000
               |grad[o]|=0.00641  |ddm|=0.0178  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4749757494103  dE = -4.8924773e-05  S^2 = 0.0000000
               |grad[o]|=0.00236  |ddm|=0.00766  |maxRot[o]|=0.0155
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4749799403129  dE = -4.1909026e-06  S^2 = 0.0000000
               |grad[o]|=0.000797  |ddm|=0.00271  |maxRot[o]|=0.00464
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4749802902404  dE = -3.4992746e-07  S^2 = 0.0000000
               |grad[o]|=0.000242  |ddm|=0.000827  |maxRot[o]|=0.00134
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4749803191895  dE = -2.8949131e-08  S^2 = 0.0000000
               |grad[o]|=7.13e-05  |ddm|=0.000245  |maxRot[o]|=0.000385
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4749803215846  dE = -2.3950832e-09  S^2 = 0.0000000
               |grad[o]|=2.09e-05  |ddm|=7.03e-05  |maxRot[o]|=0.000111
macro iter 12 (2 JK  0 micro), CASSCF E = -75.474980321779  dE = -1.9433344e-10  S^2 = 0.0000000
               |grad[o]|=6.07e-06  |ddm|=2.04e-05  |maxRot[o]|=3.19e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4749803217952  dE = -1.6257218e-11  S^2 = 0.0000000
               |grad[o]|=1.76e-06  |ddm|=5.82e-06  |maxRot[o]|=8.97e-06
2-step CASSCF converged in 13 macro (52 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95767234 1.93317379 1.87988787 1.73905603 0.06793607 0.26647544
 0.056932   0.09886645]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01187   0.01040  -0.00309   0.00000   0.00000
  0 C 2s       0.67780   0.66796  -0.20019  -0.00000  -0.00000
  0 C 3s      -0.00350   0.01562  -0.03551  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69358
  0 C 2py      0.00000  -0.00000  -0.00000   0.70439  -0.00000
  0 C 2pz      0.19981  -0.23087   0.67619  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06476
  0 C 3py      0.00000  -0.00000  -0.00000   0.05406  -0.00000
  0 C 3pz     -0.01243  -0.00176   0.01236  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.03012  -0.00000
  0 C 3dz^2    0.01877  -0.01161   0.03492  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.12148
 0 C 3dx2-y2   0.00081   0.00633  -0.00713   0.00000   0.00000
  1 C 1s       0.01187  -0.01040  -0.00309   0.00000   0.00000
  1 C 2s       0.67780  -0.66796  -0.20019   0.00000   0.00000
  1 C 3s      -0.00350  -0.01562  -0.03551   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000   0.00000   0.69358
  1 C 2py     -0.00000   0.00000   0.00000   0.70439   0.00000
  1 C 2pz     -0.19981  -0.23087  -0.67619  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06476
  1 C 3py     -0.00000   0.00000   0.00000   0.05406   0.00000
  1 C 3pz      0.01243  -0.00176  -0.01236  -0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.03012  -0.00000
  1 C 3dz^2    0.01877   0.01161   0.03492   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12148
 1 C 3dx2-y2   0.00081  -0.00633  -0.00713  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00030
  0 C 2s      -0.00000  -0.00000   0.22994
  0 C 3s      -0.00000  -0.00000   0.03135
  0 C 2px     -0.00000   0.69817  -0.00000
  0 C 2py      0.70700  -0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.66687
  0 C 3px      0.00000  -0.01303  -0.00000
  0 C 3py     -0.00659   0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.03288
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.01006   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00544
  0 C 3dxz     0.00000  -0.11131  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01768
  1 C 1s       0.00000   0.00000   0.00030
  1 C 2s       0.00000   0.00000  -0.22994
  1 C 3s       0.00000   0.00000  -0.03135
  1 C 2px     -0.00000  -0.69817   0.00000
  1 C 2py     -0.70700  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66687
  1 C 3px     -0.00000   0.01303   0.00000
  1 C 3py      0.00659   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.03288
  1 C 3dxy     0.00000   0.00000  -0.00000
  1 C 3dyz     0.01006   0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00544
  1 C 3dxz     0.00000  -0.11131  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01768
<CAS-nat-orb|mo-hf>  3  3    0.99977692
<CAS-nat-orb|mo-hf>  4  4    0.99968291
<CAS-nat-orb|mo-hf>  5  5    0.99978338
<CAS-nat-orb|mo-hf>  6  6    0.99882147
<CAS-nat-orb|mo-hf>  7  7    0.93437317
<CAS-nat-orb|mo-hf>  8  8    0.98222691
<CAS-nat-orb|mo-hf>  9  9    0.96040422
<CAS-nat-orb|mo-hf>  10  10    0.93730552
CASSCF energy = -75.4749803217952
CASCI E = -75.4749803217952  E(CI) = -15.1422389411508  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.338
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.097
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.660

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.028
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.633
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.730
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.725
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.724
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      2.321
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.318
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.512
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.12
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.12
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.10
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.606 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.311 | Tfpread = 0.000 | Tfpwrite = 0.308 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.065 | E =     -75.5698279180 | DW = 1.65e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.075 | E =     -75.5921906703 | DE = -2.24e-02 | DW = 6.41e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.089 | E =     -75.5927105096 | DE = -5.20e-04 | DW = 1.63e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     17.935 | E =     -75.5931304145 | DE = -4.20e-04 | DW = 7.47e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.693 | E =     -75.5931610005 | DE = -3.06e-05 | DW = 1.60e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     23.498 | E =     -75.5931929026 | DE = -3.19e-05 | DW = 7.69e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     26.212 | E =     -75.5932179810 | DE = -2.51e-05 | DW = 1.64e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     28.129 | E =     -75.5932334187 | DE = -1.54e-05 | DW = 7.95e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.103 | E =     -75.5943122996 | DE = -1.08e-03 | DW = 1.51e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.080 | E =     -75.5948449121 | DE = -5.33e-04 | DW = 2.39e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     38.594 | E =     -75.5949989216 | DE = -1.54e-04 | DW = 4.29e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.389 | E =     -75.5950527645 | DE = -5.38e-05 | DW = 3.10e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     48.072 | E =     -75.5950653929 | DE = -1.26e-05 | DW = 4.37e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.737 | E =     -75.5950741189 | DE = -8.73e-06 | DW = 3.13e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     57.335 | E =     -75.5950830550 | DE = -8.94e-06 | DW = 4.40e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     61.896 | E =     -75.5950866380 | DE = -3.58e-06 | DW = 3.09e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     70.547 | E =     -75.5952345808 | DE = -1.48e-04 | DW = 2.75e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     83.515 | E =     -75.5952779043 | DE = -4.33e-05 | DW = 2.01e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     95.132 | E =     -75.5952881141 | DE = -1.02e-05 | DW = 4.55e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    107.352 | E =     -75.5952914035 | DE = -3.29e-06 | DW = 2.10e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    118.247 | E =     -75.5952939295 | DE = -2.53e-06 | DW = 4.52e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    129.850 | E =     -75.5952954652 | DE = -1.54e-06 | DW = 1.94e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    141.522 | E =     -75.5952992513 | DE = -3.79e-06 | DW = 4.58e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    152.895 | E =     -75.5953005055 | DE = -1.25e-06 | DW = 1.96e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    176.368 | E =     -75.5953114995 | DE = -1.10e-05 | DW = 2.40e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    204.737 | E =     -75.5953153341 | DE = -3.83e-06 | DW = 1.12e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    232.116 | E =     -75.5953175261 | DE = -2.19e-06 | DW = 2.93e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    260.396 | E =     -75.5953184417 | DE = -9.16e-07 | DW = 1.17e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    288.148 | E =     -75.5953202424 | DE = -1.80e-06 | DW = 2.89e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    316.806 | E =     -75.5953210767 | DE = -8.34e-07 | DW = 1.16e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    344.753 | E =     -75.5953227726 | DE = -1.70e-06 | DW = 2.87e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    373.279 | E =     -75.5953235330 | DE = -7.60e-07 | DW = 1.15e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    594.236 | E =     -75.5953586344 | DE = -3.51e-05 | DW = 5.37e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    739.187 | E =     -75.5953586345 | DE = -6.40e-11 | DW = 5.36e-08

E(MRCI) = -75.5953586344904  E_corr = -0.1203783126951805
Time cost =    881.385
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 21:56:20 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.957955680404 AA    0.000000000000   0.000000000000   3.700000000000 Bohr   0.0

nuclear repulsion = 9.72972972972973
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.85]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    368673.99


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmphwwje9sf
max_memory 4000 MB (current use 5156 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7163760223708

WARN: Singularity detected in overlap matrix (condition number = 80.7). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.104120790735628  LUMO (B3u) = -0.104120790735628

WARN: B2u HOMO -0.104120790735628 > system LUMO -0.104120790735628

cycle= 1 E= -75.2641203852924  delta_E= -0.548  |g|= 0.236  |ddm|= 1.47
HOMO (B2u) = -0.359408877513718  LUMO (B3u) = -0.0527582771899437
cycle= 2 E= -75.2865593123333  delta_E= -0.0224  |g|= 0.0471  |ddm|= 0.348
HOMO (B2u) = -0.325804970810899  LUMO (B3u) = -0.0145227547118883
cycle= 3 E= -75.2878678904737  delta_E= -0.00131  |g|= 0.0174  |ddm|= 0.0619
HOMO (B2u) = -0.330188258882721  LUMO (B3u) = -0.0187350374973052
cycle= 4 E= -75.2880824131579  delta_E= -0.000215  |g|= 0.000653  |ddm|= 0.035
HOMO (B2u) = -0.330355542534975  LUMO (B3u) = -0.0190485772808916
cycle= 5 E= -75.288082574972  delta_E= -1.62e-07  |g|= 0.000124  |ddm|= 0.000847
HOMO (B2u) = -0.330318643630837  LUMO (B3u) = -0.0190186484174822
cycle= 6 E= -75.2880825838255  delta_E= -8.85e-09  |g|= 1.86e-05  |ddm|= 0.000214
HOMO (B2u) = -0.330315994378313  LUMO (B3u) = -0.0190189216398534
cycle= 7 E= -75.2880825840469  delta_E= -2.21e-10  |g|= 1.93e-06  |ddm|= 3.86e-05
HOMO (B2u) = -0.330315507539185  LUMO (B3u) = -0.0190188734083588
cycle= 8 E= -75.2880825840494  delta_E= -2.47e-12  |g|= 1.29e-07  |ddm|= 4.01e-06
HOMO (B2u) = -0.330315512036509  LUMO (B3u) = -0.0190188725353976
cycle= 9 E= -75.2880825840494  delta_E=    0  |g|= 8.84e-09  |ddm|= 3.07e-07
HOMO (B2u) = -0.330315511516023  LUMO (B3u) = -0.0190188740618194
cycle= 10 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 7.23e-09  |ddm|= 7.7e-09
HOMO (B2u) = -0.330315511430118  LUMO (B3u) = -0.0190188740426807
cycle= 11 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 5.2e-09  |ddm|= 5.82e-09
HOMO (B2u) = -0.33031551011709  LUMO (B3u) = -0.0190188726787201
cycle= 12 E= -75.2880825840493  delta_E= 8.53e-14  |g|= 4.48e-09  |ddm|= 2.8e-09
HOMO (B2u) = -0.330315510361655  LUMO (B3u) = -0.0190188729364834
cycle= 13 E= -75.2880825840493  delta_E= -4.26e-14  |g|= 4.02e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.330315510214359  LUMO (B3u) = -0.0190188727856386
cycle= 14 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 3.28e-09  |ddm|= 2.15e-09
HOMO (B2u) = -0.330315510029076  LUMO (B3u) = -0.0190188727303302
cycle= 15 E= -75.2880825840493  delta_E= -5.68e-14  |g|= 1.06e-09  |ddm|= 6.34e-09
HOMO (B2u) = -0.330315509940816  LUMO (B3u) = -0.0190188727155718
cycle= 16 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 9.94e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.330315509970181  LUMO (B3u) = -0.0190188726986174
cycle= 17 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 1.11e-09  |ddm|= 1e-09
HOMO (B2u) = -0.330315509932798  LUMO (B3u) = -0.019018872675381
cycle= 18 E= -75.2880825840494  delta_E= -4.26e-14  |g|= 8.61e-10  |ddm|= 6.58e-10
HOMO (B2u) = -0.330315509926831  LUMO (B3u) = -0.0190188726818151
cycle= 19 E= -75.2880825840494  delta_E= 2.84e-14  |g|= 6.9e-10  |ddm|= 5.6e-10
HOMO (B2u) = -0.330315509925312  LUMO (B3u) = -0.0190188726902667
cycle= 20 E= -75.2880825840493  delta_E= 1.42e-14  |g|= 5.63e-10  |ddm|= 3.89e-10
HOMO (B2u) = -0.330315509909679  LUMO (B3u) = -0.0190188726817632
cycle= 21 E= -75.2880825840493  delta_E= 2.84e-14  |g|= 4.37e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.330315509897374  LUMO (B3u) = -0.0190188726770185
cycle= 22 E= -75.2880825840493  delta_E= -2.84e-14  |g|= 3.17e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.33031550988547  LUMO (B3u) = -0.0190188726728182
cycle= 23 E= -75.2880825840493  delta_E= 5.68e-14  |g|= 2.27e-10  |ddm|= 2.52e-10
HOMO (B2u) = -0.330315509878511  LUMO (B3u) = -0.0190188726694835
cycle= 24 E= -75.2880825840493  delta_E=    0  |g|= 1.96e-10  |ddm|= 8.25e-11
HOMO (B2u) = -0.330315509875092  LUMO (B3u) = -0.019018872666667
cycle= 25 E= -75.2880825840492  delta_E= 7.11e-14  |g|= 1.65e-10  |ddm|= 7.65e-11
HOMO (B2u) = -0.330315509870251  LUMO (B3u) = -0.0190188726641984
cycle= 26 E= -75.2880825840493  delta_E= -4.26e-14  |g|= 1.32e-10  |ddm|= 9.21e-11
HOMO (B2u) = -0.330315509866422  LUMO (B3u) = -0.0190188726622499
cycle= 27 E= -75.2880825840491  delta_E= 1.71e-13  |g|= 1.07e-10  |ddm|= 7.13e-11
HOMO (B2u) = -0.33031550986326  LUMO (B3u) = -0.0190188726606045
cycle= 28 E= -75.2880825840491  delta_E= 1.42e-14  |g|= 8.6e-11  |ddm|= 5.68e-11
HOMO (B2u) = -0.330315509860747  LUMO (B3u) = -0.0190188726593304
cycle= 29 E= -75.288082584049  delta_E= 9.95e-14  |g|= 6.79e-11  |ddm|= 4.65e-11
HOMO (B2u) = -0.330315509858676  LUMO (B3u) = -0.0190188726582743
cycle= 30 E= -75.288082584049  delta_E= -5.68e-14  |g|= 5.37e-11  |ddm|= 3.64e-11
HOMO (B2u) = -0.33031550985712  LUMO (B3u) = -0.0190188726574981
cycle= 31 E= -75.2880825840488  delta_E= 2.84e-13  |g|= 4.37e-11  |ddm|= 2.65e-11
HOMO (B2u) = -0.330315509856004  LUMO (B3u) = -0.0190188726569033
cycle= 32 E= -75.2880825840485  delta_E= 2.27e-13  |g|= 3.64e-11  |ddm|= 1.87e-11
HOMO (B2u) = -0.330315509855103  LUMO (B3u) = -0.019018872656393
cycle= 33 E= -75.2880825840482  delta_E= 2.98e-13  |g|= 3.04e-11  |ddm|= 1.62e-11
HOMO (B2u) = -0.330315509854284  LUMO (B3u) = -0.0190188726559574
cycle= 34 E= -75.2880825840479  delta_E= 3.55e-13  |g|= 2.55e-11  |ddm|= 1.39e-11
HOMO (B2u) = -0.330315509853608  LUMO (B3u) = -0.0190188726555872
cycle= 35 E= -75.2880825840474  delta_E= 4.26e-13  |g|= 2.15e-11  |ddm|= 1.11e-11
HOMO (B2u) = -0.330315509853029  LUMO (B3u) = -0.0190188726552522
cycle= 36 E= -75.2880825840468  delta_E= 6.11e-13  |g|= 1.85e-11  |ddm|= 9.08e-12
HOMO (B2u) = -0.330315509852526  LUMO (B3u) = -0.0190188726549436
cycle= 37 E= -75.2880825840464  delta_E= 4.69e-13  |g|= 1.62e-11  |ddm|= 7.47e-12
HOMO (B2u) = -0.330315509852086  LUMO (B3u) = -0.0190188726546573
cycle= 38 E= -75.2880825840459  delta_E= 4.97e-13  |g|= 1.41e-11  |ddm|= 6.13e-12
HOMO (B2u) = -0.33031550985169  LUMO (B3u) = -0.0190188726543802
cycle= 39 E= -75.2880825840452  delta_E= 6.39e-13  |g|= 1.23e-11  |ddm|= 5.09e-12
HOMO (B2u) = -0.330315509851319  LUMO (B3u) = -0.0190188726541015
cycle= 40 E= -75.2880825840445  delta_E= 7.53e-13  |g|= 1.07e-11  |ddm|= 4.48e-12
HOMO (B2u) = -0.330315509850963  LUMO (B3u) = -0.0190188726538174
cycle= 41 E= -75.2880825840438  delta_E= 6.68e-13  |g|= 9.53e-12  |ddm|= 3.8e-12
HOMO (B2u) = -0.330315509850618  LUMO (B3u) = -0.019018872653527
cycle= 42 E= -75.2880825840432  delta_E= 5.68e-13  |g|= 8.59e-12  |ddm|= 3.35e-12
HOMO (B2u) = -0.33031550985028  LUMO (B3u) = -0.0190188726532285
cycle= 43 E= -75.2880825840427  delta_E= 5.68e-13  |g|= 7.77e-12  |ddm|= 3.06e-12
HOMO (B2u) = -0.330315509849953  LUMO (B3u) = -0.0190188726529286
cycle= 44 E= -75.2880825840421  delta_E= 5.4e-13  |g|= 6.9e-12  |ddm|= 2.61e-12
HOMO (B2u) = -0.330315509849637  LUMO (B3u) = -0.0190188726526311
cycle= 45 E= -75.2880825840415  delta_E= 6.25e-13  |g|= 6.25e-12  |ddm|= 2.31e-12
HOMO (B2u) = -0.330315509849324  LUMO (B3u) = -0.0190188726523287
cycle= 46 E= -75.2880825840409  delta_E= 6.39e-13  |g|= 5.77e-12  |ddm|= 2.13e-12
HOMO (B2u) = -0.330315509849013  LUMO (B3u) = -0.0190188726520225
cycle= 47 E= -75.2880825840402  delta_E= 7.11e-13  |g|= 5.37e-12  |ddm|= 1.96e-12
HOMO (B2u) = -0.330315509848698  LUMO (B3u) = -0.0190188726517072
cycle= 48 E= -75.2880825840397  delta_E= 4.69e-13  |g|= 5.07e-12  |ddm|= 1.89e-12
HOMO (B2u) = -0.330315509848381  LUMO (B3u) = -0.0190188726513867
cycle= 49 E= -75.2880825840392  delta_E= 4.83e-13  |g|= 4.68e-12  |ddm|= 2.16e-12
HOMO (B2u) = -0.330315509848069  LUMO (B3u) = -0.0190188726510715
cycle= 50 E= -75.2880825840389  delta_E= 2.84e-13  |g|= 4.18e-12  |ddm|= 2.19e-12
SCF not converged.
SCF energy = -75.2880825840389

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmphwwje9sf
max_memory 4000 MB (current use 5156 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4284824270337  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4443078950972  dE = -0.015825468  S^2 = 0.0000000
               |grad[o]|=  0.1  |ddm|= 3.78  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4564374553095  dE = -0.01212956  S^2 = 0.0000000
               |grad[o]|=0.0791  |ddm|=0.101  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4642977992811  dE = -0.007860344  S^2 = 0.0000000
               |grad[o]|=0.0552  |ddm|=0.0401  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4683807784877  dE = -0.0040829792  S^2 = 0.0000000
               |grad[o]|=0.0319  |ddm|=0.0934  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4701492368426  dE = -0.0017684584  S^2 = 0.0000000
               |grad[o]|=0.0156  |ddm|=0.0554  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4705691466082  dE = -0.00041990977  S^2 = 0.0000000
               |grad[o]|=0.00654  |ddm|=0.0184  |maxRot[o]|= 0.04
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4706177408615  dE = -4.8594253e-05  S^2 = 0.0000000
               |grad[o]|=0.0024  |ddm|=0.0076  |maxRot[o]|=0.0154
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4706218263526  dE = -4.085491e-06  S^2 = 0.0000000
               |grad[o]|=0.000811  |ddm|=0.00265  |maxRot[o]|=0.00457
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4706221630049  dE = -3.3665231e-07  S^2 = 0.0000000
               |grad[o]|=0.000246  |ddm|=0.000806  |maxRot[o]|=0.00131
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4706221904788  dE = -2.7473916e-08  S^2 = 0.0000000
               |grad[o]|=7.15e-05  |ddm|=0.000238  |maxRot[o]|=0.000374
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4706221927186  dE = -2.2398154e-09  S^2 = 0.0000000
               |grad[o]|=2.09e-05  |ddm|=6.78e-05  |maxRot[o]|=0.000107
macro iter 12 (2 JK  0 micro), CASSCF E = -75.470622192902  dE = -1.8336266e-10  S^2 = 0.0000000
               |grad[o]|=6e-06  |ddm|=1.97e-05  |maxRot[o]|=3.05e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.470622192917  dE = -1.5006663e-11  S^2 = 0.0000000
               |grad[o]|=1.75e-06  |ddm|=5.59e-06  |maxRot[o]|=8.71e-06
2-step CASSCF converged in 13 macro (51 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95713289 1.93379644 1.87461994 1.72422802 0.06681525 0.28113863
 0.05662336 0.10564547]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01200   0.01047  -0.00276   0.00000   0.00000
  0 C 2s       0.68293   0.67051  -0.18198   0.00000  -0.00000
  0 C 3s      -0.00172   0.01539  -0.03356   0.00000  -0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69358
  0 C 2py     -0.00000   0.00000  -0.00000   0.70441   0.00000
  0 C 2pz      0.18173  -0.22338   0.68140   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06561
  0 C 3py     -0.00000   0.00000  -0.00000   0.05451   0.00000
  0 C 3pz     -0.01154  -0.00172   0.01401   0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02892  -0.00000
  0 C 3dz^2    0.01723  -0.01123   0.03460   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.12102
 0 C 3dx2-y2   0.00106   0.00623  -0.00705   0.00000   0.00000
  1 C 1s       0.01200  -0.01047  -0.00276   0.00000   0.00000
  1 C 2s       0.68293  -0.67051  -0.18198   0.00000  -0.00000
  1 C 3s      -0.00172  -0.01539  -0.03356  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69358
  1 C 2py      0.00000  -0.00000  -0.00000   0.70441   0.00000
  1 C 2pz     -0.18173  -0.22338  -0.68140   0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06561
  1 C 3py      0.00000  -0.00000   0.00000   0.05451  -0.00000
  1 C 3pz      0.01154  -0.00172  -0.01401   0.00000  -0.00000
  1 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02892   0.00000
  1 C 3dz^2    0.01723   0.01123   0.03460  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.12102
 1 C 3dx2-y2   0.00106  -0.00623  -0.00705   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00028
  0 C 2s       0.00000  -0.00000   0.22254
  0 C 3s       0.00000  -0.00000   0.03036
  0 C 2px     -0.00000   0.69830  -0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.66959
  0 C 3px     -0.00000  -0.01481   0.00000
  0 C 3py     -0.00465   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.03021
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00965   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00477
  0 C 3dxz    -0.00000  -0.11029  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01664
  1 C 1s       0.00000   0.00000   0.00028
  1 C 2s      -0.00000   0.00000  -0.22254
  1 C 3s      -0.00000   0.00000  -0.03036
  1 C 2px      0.00000  -0.69830  -0.00000
  1 C 2py     -0.70703  -0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.66959
  1 C 3px      0.00000   0.01481   0.00000
  1 C 3py      0.00465   0.00000  -0.00000
  1 C 3pz      0.00000  -0.00000  -0.03021
  1 C 3dxy     0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00965  -0.00000   0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00477
  1 C 3dxz    -0.00000  -0.11029  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01664
<CAS-nat-orb|mo-hf>  3  3    0.99943449
<CAS-nat-orb|mo-hf>  4  4    0.99967130
<CAS-nat-orb|mo-hf>  5  5    0.99943415
<CAS-nat-orb|mo-hf>  6  6    0.99875809
<CAS-nat-orb|mo-hf>  7  7    0.93391054
<CAS-nat-orb|mo-hf>  8  8    0.98327030
<CAS-nat-orb|mo-hf>  9  9    0.96053902
<CAS-nat-orb|mo-hf>  10  10    0.94279395
CASSCF energy = -75.470622192917
CASCI E = -75.470622192917  E(CI) = -15.078733269316  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.027
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.037

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.050
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.013
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.012
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.095
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.08
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.06
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.05
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.02
Time init sweep =        0.259 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.156 | Tfpread = 0.000 | Tfpwrite = 0.152 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.478 | E =     -75.5655389508 | DW = 1.68e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.593 | E =     -75.5880121229 | DE = -2.25e-02 | DW = 6.55e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.396 | E =     -75.5885314470 | DE = -5.19e-04 | DW = 1.64e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.190 | E =     -75.5889387227 | DE = -4.07e-04 | DW = 7.57e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.965 | E =     -75.5889703033 | DE = -3.16e-05 | DW = 1.61e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.804 | E =     -75.5890099110 | DE = -3.96e-05 | DW = 7.93e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.537 | E =     -75.5890300786 | DE = -2.02e-05 | DW = 1.65e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.327 | E =     -75.5890409444 | DE = -1.09e-05 | DW = 8.02e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.683 | E =     -75.5901181874 | DE = -1.08e-03 | DW = 1.53e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.648 | E =     -75.5906392170 | DE = -5.21e-04 | DW = 2.43e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     17.254 | E =     -75.5907881215 | DE = -1.49e-04 | DW = 4.32e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.294 | E =     -75.5908452494 | DE = -5.71e-05 | DW = 3.13e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.179 | E =     -75.5908584518 | DE = -1.32e-05 | DW = 4.44e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     28.571 | E =     -75.5908677834 | DE = -9.33e-06 | DW = 3.19e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.528 | E =     -75.5908769154 | DE = -9.13e-06 | DW = 4.51e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     37.771 | E =     -75.5908813182 | DE = -4.40e-06 | DW = 3.20e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     46.998 | E =     -75.5910331256 | DE = -1.52e-04 | DW = 2.76e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     61.784 | E =     -75.5910764043 | DE = -4.33e-05 | DW = 2.01e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     73.949 | E =     -75.5910868822 | DE = -1.05e-05 | DW = 4.57e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     87.040 | E =     -75.5910903791 | DE = -3.50e-06 | DW = 2.11e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     97.984 | E =     -75.5910934571 | DE = -3.08e-06 | DW = 4.60e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.520 | E =     -75.5910961205 | DE = -2.66e-06 | DW = 2.10e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.151 | E =     -75.5910989558 | DE = -2.84e-06 | DW = 4.60e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    132.634 | E =     -75.5911002506 | DE = -1.29e-06 | DW = 1.96e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    160.346 | E =     -75.5911531643 | DE = -5.29e-05 | DW = 2.38e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    188.970 | E =     -75.5911563367 | DE = -3.17e-06 | DW = 1.08e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    214.109 | E =     -75.5911566930 | DE = -3.56e-07 | DW = 2.24e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    240.347 | E =     -75.5911570811 | DE = -3.88e-07 | DW = 1.07e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    264.347 | E =     -75.5911571322 | DE = -5.12e-08 | DW = 2.30e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    290.384 | E =     -75.5911574394 | DE = -3.07e-07 | DW = 1.07e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    315.497 | E =     -75.5911574583 | DE = -1.89e-08 | DW = 2.31e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    344.409 | E =     -75.5911577401 | DE = -2.82e-07 | DW = 1.07e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    535.170 | E =     -75.5911623710 | DE = -4.63e-06 | DW = 5.43e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    663.930 | E =     -75.5911623711 | DE = -1.32e-10 | DW = 5.44e-08

E(MRCI) = -75.59116237114593  E_corr = -0.1205401782289641
Time cost =    717.205
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:08:17 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   1.984414540950 AA    0.000000000000   0.000000000000   3.750000000000 Bohr   0.0

nuclear repulsion = 9.6
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.875]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    380599.03


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpy5axysno
max_memory 4000 MB (current use 5158 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.7049084284725

WARN: Singularity detected in overlap matrix (condition number = 75.6). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.10137021191345  LUMO (B3u) = -0.101370211913451

WARN: B2u HOMO -0.10137021191345 > system LUMO -0.101370211913451

cycle= 1 E= -75.2564523906342  delta_E= -0.552  |g|= 0.234  |ddm|= 1.47
HOMO (B2u) = -0.355831308623929  LUMO (B3u) = -0.0506406338501535
cycle= 2 E= -75.2785865089974  delta_E= -0.0221  |g|= 0.0465  |ddm|= 0.348
HOMO (B2u) = -0.322685006141468  LUMO (B3u) = -0.0128872994795369
cycle= 3 E= -75.2798715208091  delta_E= -0.00129  |g|= 0.0172  |ddm|= 0.061
HOMO (B2u) = -0.327043790963021  LUMO (B3u) = -0.0170677233110562
cycle= 4 E= -75.2800833606865  delta_E= -0.000212  |g|= 0.000651  |ddm|= 0.0346
HOMO (B2u) = -0.327204207243865  LUMO (B3u) = -0.0173729266447939
cycle= 5 E= -75.280083521623  delta_E= -1.61e-07  |g|= 0.000127  |ddm|= 0.00084
HOMO (B2u) = -0.327167734029069  LUMO (B3u) = -0.0173440705847748
cycle= 6 E= -75.2800835308717  delta_E= -9.25e-09  |g|= 1.89e-05  |ddm|= 0.000218
HOMO (B2u) = -0.327165039753309  LUMO (B3u) = -0.0173442874866643
cycle= 7 E= -75.2800835311012  delta_E= -2.3e-10  |g|= 1.94e-06  |ddm|= 3.91e-05
HOMO (B2u) = -0.32716457228414  LUMO (B3u) = -0.0173442642259164
cycle= 8 E= -75.2800835311035  delta_E= -2.39e-12  |g|= 1.3e-07  |ddm|= 4.03e-06
HOMO (B2u) = -0.327164577390585  LUMO (B3u) = -0.0173442637009293
cycle= 9 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 8.76e-09  |ddm|= 3.12e-07
HOMO (B2u) = -0.32716457678051  LUMO (B3u) = -0.0173442652043367
cycle= 10 E= -75.2800835311036  delta_E= -5.68e-14  |g|= 7.28e-09  |ddm|= 7.49e-09
HOMO (B2u) = -0.327164576737275  LUMO (B3u) = -0.0173442652402208
cycle= 11 E= -75.2800835311036  delta_E=    0  |g|= 5.21e-09  |ddm|= 5.91e-09
HOMO (B2u) = -0.327164575481269  LUMO (B3u) = -0.0173442639354093
cycle= 12 E= -75.2800835311035  delta_E= 5.68e-14  |g|= 4.47e-09  |ddm|= 2.89e-09
HOMO (B2u) = -0.327164575694898  LUMO (B3u) = -0.0173442641643246
cycle= 13 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 4e-09  |ddm|= 1.71e-09
HOMO (B2u) = -0.327164575241135  LUMO (B3u) = -0.0173442639315225
cycle= 14 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 9.56e-10  |ddm|= 7.34e-09
HOMO (B2u) = -0.327164575348957  LUMO (B3u) = -0.0173442639680668
cycle= 15 E= -75.2800835311035  delta_E=    0  |g|= 9.67e-10  |ddm|= 1.36e-09
HOMO (B2u) = -0.327164575274781  LUMO (B3u) = -0.0173442639512637
cycle= 16 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 9.33e-10  |ddm|= 1.13e-09
HOMO (B2u) = -0.327164575295805  LUMO (B3u) = -0.0173442639367919
cycle= 17 E= -75.2800835311036  delta_E= -2.84e-14  |g|= 1.03e-09  |ddm|= 7.83e-10
HOMO (B2u) = -0.327164575258638  LUMO (B3u) = -0.017344263915318
cycle= 18 E= -75.2800835311035  delta_E= 8.53e-14  |g|= 7.77e-10  |ddm|= 6.6e-10
HOMO (B2u) = -0.327164575252137  LUMO (B3u) = -0.0173442639221963
cycle= 19 E= -75.2800835311035  delta_E= -5.68e-14  |g|= 6.03e-10  |ddm|= 5.76e-10
HOMO (B2u) = -0.327164575250309  LUMO (B3u) = -0.0173442639311217
cycle= 20 E= -75.2800835311035  delta_E=    0  |g|= 4.74e-10  |ddm|= 4.02e-10
HOMO (B2u) = -0.327164575234639  LUMO (B3u) = -0.0173442639235529
cycle= 21 E= -75.2800835311035  delta_E= 2.84e-14  |g|= 3.48e-10  |ddm|= 3.39e-10
HOMO (B2u) = -0.327164575221932  LUMO (B3u) = -0.0173442639192384
cycle= 22 E= -75.2800835311035  delta_E= -2.84e-14  |g|= 2.28e-10  |ddm|= 3.09e-10
HOMO (B2u) = -0.327164575218982  LUMO (B3u) = -0.0173442639164658
cycle= 23 E= -75.2800835311034  delta_E= 1.42e-13  |g|= 2.02e-10  |ddm|= 7.25e-11
HOMO (B2u) = -0.327164575212585  LUMO (B3u) = -0.0173442639133738
cycle= 24 E= -75.2800835311033  delta_E= 5.68e-14  |g|= 1.73e-10  |ddm|= 7.56e-11
HOMO (B2u) = -0.327164575209121  LUMO (B3u) = -0.017344263910818
cycle= 25 E= -75.2800835311034  delta_E= -5.68e-14  |g|= 1.44e-10  |ddm|= 7.32e-11
HOMO (B2u) = -0.327164575204641  LUMO (B3u) = -0.0173442639086162
cycle= 26 E= -75.2800835311032  delta_E= 1.71e-13  |g|= 1.13e-10  |ddm|= 8.65e-11
HOMO (B2u) = -0.327164575201219  LUMO (B3u) = -0.0173442639069198
cycle= 27 E= -75.2800835311032  delta_E=    0  |g|= 9.1e-11  |ddm|= 6.56e-11
HOMO (B2u) = -0.327164575192805  LUMO (B3u) = -0.0173442639025149
Extra cycle  E= -75.2800835311032  delta_E= 2.84e-14  |g|= 3.1e-11  |ddm|= 1.55e-10
converged SCF energy = -75.2800835311032

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpy5axysno
max_memory 4000 MB (current use 5158 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4247711667705  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4410888633252  dE = -0.016317697  S^2 = 0.0000000
               |grad[o]|=0.102  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4533325047287  dE = -0.012243641  S^2 = 0.0000000
               |grad[o]|=0.0793  |ddm|=0.106  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4609477172264  dE = -0.0076152125  S^2 = 0.0000000
               |grad[o]|=0.0536  |ddm|=0.0363  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4644456692549  dE = -0.003497952  S^2 = 0.0000000
               |grad[o]|=0.029  |ddm|=0.101  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4660376434373  dE = -0.0015919742  S^2 = 0.0000000
               |grad[o]|=0.0144  |ddm|=0.046  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4663659925422  dE = -0.0003283491  S^2 = 0.0000000
               |grad[o]|=0.00573  |ddm|=0.0163  |maxRot[o]|=0.0373
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4663951153512  dE = -2.9122809e-05  S^2 = 0.0000000
               |grad[o]|=0.00201  |ddm|=0.00667  |maxRot[o]|=0.012
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4663975386565  dE = -2.4233053e-06  S^2 = 0.0000000
               |grad[o]|=0.000657  |ddm|=0.00204  |maxRot[o]|=0.00351
macro iter 9 (3 JK  0 micro), CASSCF E = -75.466397737344  dE = -1.986875e-07  S^2 = 0.0000000
               |grad[o]|=0.000196  |ddm|=0.000621  |maxRot[o]|=0.000999
macro iter 10 (3 JK  0 micro), CASSCF E = -75.466397753514  dE = -1.6169992e-08  S^2 = 0.0000000
               |grad[o]|=5.71e-05  |ddm|=0.000182  |maxRot[o]|=0.000286
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4663977548352  dE = -1.3211832e-09  S^2 = 0.0000000
               |grad[o]|=1.67e-05  |ddm|=5.2e-05  |maxRot[o]|=8.12e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4663977549446  dE = -1.0939516e-10  S^2 = 0.0000000
               |grad[o]|=4.83e-06  |ddm|=1.5e-05  |maxRot[o]|=2.33e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4663977549535  dE = -8.9244168e-12  S^2 = 0.0000000
               |grad[o]|=1.4e-06  |ddm|=4.39e-06  |maxRot[o]|=6.59e-06
2-step CASSCF converged in 13 macro (51 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95667458 1.9344164  1.86874335 1.70868175 0.06576131 0.29650692
 0.0563102  0.11290549]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01211   0.01055  -0.00246   0.00000   0.00000
  0 C 2s       0.68726   0.67292  -0.16495  -0.00000  -0.00000
  0 C 3s      -0.00012   0.01517  -0.03163  -0.00000  -0.00000
  0 C 2px      0.00000  -0.00000  -0.00000   0.00000   0.69361
  0 C 2py      0.00000  -0.00000  -0.00000   0.70443  -0.00000
  0 C 2pz      0.16481  -0.21605   0.68580   0.00000   0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06639
  0 C 3py      0.00000  -0.00000  -0.00000   0.05485  -0.00000
  0 C 3pz     -0.01075  -0.00170   0.01569  -0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02772  -0.00000
  0 C 3dz^2    0.01579  -0.01087   0.03419  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.12041
 0 C 3dx2-y2   0.00128   0.00613  -0.00696   0.00000  -0.00000
  1 C 1s       0.01211  -0.01055  -0.00246   0.00000   0.00000
  1 C 2s       0.68726  -0.67292  -0.16495   0.00000   0.00000
  1 C 3s      -0.00012  -0.01517  -0.03163   0.00000   0.00000
  1 C 2px     -0.00000  -0.00000  -0.00000  -0.00000   0.69361
  1 C 2py      0.00000  -0.00000  -0.00000   0.70443   0.00000
  1 C 2pz     -0.16481  -0.21605  -0.68580   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000  -0.00000  -0.06639
  1 C 3py     -0.00000   0.00000   0.00000   0.05485   0.00000
  1 C 3pz      0.01075  -0.00170  -0.01569  -0.00000  -0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02772  -0.00000
  1 C 3dz^2    0.01579   0.01087   0.03419   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000   0.00000   0.12041
 1 C 3dx2-y2   0.00128  -0.00613  -0.00696   0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00026
  0 C 2s      -0.00000  -0.00000   0.21528
  0 C 3s      -0.00000  -0.00000   0.02936
  0 C 2px     -0.00000   0.69842   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67214
  0 C 3px      0.00000  -0.01654  -0.00000
  0 C 3py     -0.00273  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02753
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00925   0.00000   0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00414
  0 C 3dxz     0.00000  -0.10923   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01562
  1 C 1s       0.00000   0.00000   0.00026
  1 C 2s       0.00000   0.00000  -0.21528
  1 C 3s       0.00000   0.00000  -0.02936
  1 C 2px     -0.00000  -0.69842   0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.67214
  1 C 3px      0.00000   0.01654  -0.00000
  1 C 3py      0.00273  -0.00000  -0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02753
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00925   0.00000   0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00414
  1 C 3dxz    -0.00000  -0.10923   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01562
<CAS-nat-orb|mo-hf>  3  3    0.99890662
<CAS-nat-orb|mo-hf>  4  4    0.99965866
<CAS-nat-orb|mo-hf>  5  5    0.99889779
<CAS-nat-orb|mo-hf>  6  6    0.99869247
<CAS-nat-orb|mo-hf>  7  7    0.93353912
<CAS-nat-orb|mo-hf>  8  8    0.98425022
<CAS-nat-orb|mo-hf>  9  9    0.96066028
<CAS-nat-orb|mo-hf>  10  10    0.94772193
CASSCF energy = -75.4663977549535
CASCI E = -75.4663977549535  E(CI) = -15.0169341218208  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.026
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.046
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.036
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.346
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.097
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.664

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.030
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.644
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.731
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.728
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.729
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      2.331
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.329
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.554
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.11
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.12
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.09
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.06
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.596 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.310 | Tfpread = 0.000 | Tfpwrite = 0.293 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.969 | E =     -75.5610777100 | DW = 1.70e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.930 | E =     -75.5839531154 | DE = -2.29e-02 | DW = 6.58e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.992 | E =     -75.5844703494 | DE = -5.17e-04 | DW = 1.65e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     17.816 | E =     -75.5849046225 | DE = -4.34e-04 | DW = 7.59e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.456 | E =     -75.5849250177 | DE = -2.04e-05 | DW = 1.62e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     19.170 | E =     -75.5849576551 | DE = -3.26e-05 | DW = 7.89e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     20.734 | E =     -75.5849766992 | DE = -1.90e-05 | DW = 1.66e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.679 | E =     -75.5849890720 | DE = -1.24e-05 | DW = 8.18e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.947 | E =     -75.5860496151 | DE = -1.06e-03 | DW = 1.54e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.546 | E =     -75.5865630563 | DE = -5.13e-04 | DW = 2.47e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     35.293 | E =     -75.5867151544 | DE = -1.52e-04 | DW = 4.38e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.037 | E =     -75.5867752241 | DE = -6.01e-05 | DW = 3.21e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     44.880 | E =     -75.5867877472 | DE = -1.25e-05 | DW = 4.51e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     49.393 | E =     -75.5867959647 | DE = -8.22e-06 | DW = 3.24e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.462 | E =     -75.5868042287 | DE = -8.26e-06 | DW = 4.55e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     57.148 | E =     -75.5868091286 | DE = -4.90e-06 | DW = 3.26e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     65.280 | E =     -75.5869606445 | DE = -1.52e-04 | DW = 2.76e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     78.232 | E =     -75.5870040272 | DE = -4.34e-05 | DW = 2.01e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     89.306 | E =     -75.5870135822 | DE = -9.55e-06 | DW = 4.53e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    102.085 | E =     -75.5870173006 | DE = -3.72e-06 | DW = 2.11e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    113.350 | E =     -75.5870206218 | DE = -3.32e-06 | DW = 4.57e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    125.578 | E =     -75.5870232164 | DE = -2.59e-06 | DW = 2.11e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    137.107 | E =     -75.5870259702 | DE = -2.75e-06 | DW = 4.56e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    149.645 | E =     -75.5870283867 | DE = -2.42e-06 | DW = 2.10e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    177.856 | E =     -75.5870844354 | DE = -5.60e-05 | DW = 2.38e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    208.272 | E =     -75.5870876709 | DE = -3.24e-06 | DW = 1.11e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    235.031 | E =     -75.5870879427 | DE = -2.72e-07 | DW = 2.22e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    264.430 | E =     -75.5870883858 | DE = -4.43e-07 | DW = 1.09e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    292.401 | E =     -75.5870884871 | DE = -1.01e-07 | DW = 2.32e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    322.918 | E =     -75.5870887978 | DE = -3.11e-07 | DW = 1.09e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    349.634 | E =     -75.5870888157 | DE = -1.79e-08 | DW = 2.31e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    379.322 | E =     -75.5870891194 | DE = -3.04e-07 | DW = 1.08e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    585.517 | E =     -75.5870941885 | DE = -5.07e-06 | DW = 5.50e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    717.437 | E =     -75.5870941886 | DE = -7.57e-11 | DW = 5.51e-08

E(MRCI) = -75.58709418857813  E_corr = -0.1206964336246017
Time cost =    867.840
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:22:45 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.010873401496 AA    0.000000000000   0.000000000000   3.800000000000 Bohr   0.0

nuclear repulsion = 9.47368421052632
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.  0.  1.9]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    394483.77


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpmwnfz_mh
max_memory 4000 MB (current use 5119 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6942155395782

WARN: Singularity detected in overlap matrix (condition number = 70.9). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.0987431605477894  LUMO (B3u) = -0.0987431605477894

WARN: B2u HOMO -0.0987431605477894 > system LUMO -0.0987431605477894

cycle= 1 E= -75.2488547171613  delta_E= -0.555  |g|= 0.232  |ddm|= 1.46
HOMO (B2u) = -0.352381746665131  LUMO (B3u) = -0.0486055106896998
cycle= 2 E= -75.2707023112209  delta_E= -0.0218  |g|= 0.046  |ddm|= 0.348
HOMO (B2u) = -0.319674633980572  LUMO (B3u) = -0.0113141174561868
cycle= 3 E= -75.2719633258624  delta_E= -0.00126  |g|= 0.0171  |ddm|= 0.0602
HOMO (B2u) = -0.324007395733246  LUMO (B3u) = -0.0154613624878811
cycle= 4 E= -75.2721722602516  delta_E= -0.000209  |g|= 0.000648  |ddm|= 0.0343
HOMO (B2u) = -0.324157880743128  LUMO (B3u) = -0.0157548749526129
cycle= 5 E= -75.2721724204055  delta_E= -1.6e-07  |g|= 0.000129  |ddm|= 0.000835
HOMO (B2u) = -0.324121920212105  LUMO (B3u) = -0.0157271018699669
cycle= 6 E= -75.2721724300014  delta_E= -9.6e-09  |g|= 1.92e-05  |ddm|= 0.000222
HOMO (B2u) = -0.324119190447227  LUMO (B3u) = -0.015727267628408
cycle= 7 E= -75.2721724302383  delta_E= -2.37e-10  |g|= 1.95e-06  |ddm|= 3.95e-05
HOMO (B2u) = -0.324118740620276  LUMO (B3u) = -0.0157272677303712
cycle= 8 E= -75.2721724302408  delta_E= -2.44e-12  |g|= 1.3e-07  |ddm|= 4.06e-06
HOMO (B2u) = -0.324118746684939  LUMO (B3u) = -0.0157272678197168
cycle= 9 E= -75.2721724302407  delta_E= 8.53e-14  |g|= 8.56e-09  |ddm|= 3.15e-07
HOMO (B2u) = -0.324118746003072  LUMO (B3u) = -0.0157272693229342
cycle= 10 E= -75.2721724302408  delta_E= -1.14e-13  |g|= 7.22e-09  |ddm|= 7.25e-09
HOMO (B2u) = -0.324118746008896  LUMO (B3u) = -0.0157272694156986
cycle= 11 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 5.15e-09  |ddm|= 5.89e-09
HOMO (B2u) = -0.324118744820905  LUMO (B3u) = -0.0157272681801322
cycle= 12 E= -75.2721724302408  delta_E= -4.26e-14  |g|= 4.4e-09  |ddm|= 2.93e-09
HOMO (B2u) = -0.324118745005511  LUMO (B3u) = -0.0157272683815496
cycle= 13 E= -75.2721724302407  delta_E= 5.68e-14  |g|= 3.94e-09  |ddm|= 1.69e-09
HOMO (B2u) = -0.32411874456031  LUMO (B3u) = -0.0157272681653051
cycle= 14 E= -75.2721724302408  delta_E= -2.84e-14  |g|= 9.12e-10  |ddm|= 7.35e-09
HOMO (B2u) = -0.324118744667788  LUMO (B3u) = -0.0157272682017973
cycle= 15 E= -75.2721724302408  delta_E= -5.68e-14  |g|= 9.35e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.324118744590962  LUMO (B3u) = -0.0157272681872695
cycle= 16 E= -75.2721724302408  delta_E= 5.68e-14  |g|= 8.7e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.324118744616221  LUMO (B3u) = -0.0157272681691153
cycle= 17 E= -75.2721724302407  delta_E= 8.53e-14  |g|= 9.97e-10  |ddm|= 9.91e-10
HOMO (B2u) = -0.32411874458062  LUMO (B3u) = -0.0157272681499045
cycle= 18 E= -75.2721724302408  delta_E= -1.14e-13  |g|= 7.53e-10  |ddm|= 6.37e-10
HOMO (B2u) = -0.324118744574874  LUMO (B3u) = -0.0157272681577597
cycle= 19 E= -75.2721724302407  delta_E= 7.11e-14  |g|= 5.82e-10  |ddm|= 5.72e-10
HOMO (B2u) = -0.32411874457381  LUMO (B3u) = -0.0157272681676045
cycle= 20 E= -75.2721724302407  delta_E= 4.26e-14  |g|= 4.57e-10  |ddm|= 3.98e-10
HOMO (B2u) = -0.324118744559211  LUMO (B3u) = -0.0157272681614896
cycle= 21 E= -75.2721724302406  delta_E= 2.84e-14  |g|= 3.35e-10  |ddm|= 3.32e-10
HOMO (B2u) = -0.324118744547189  LUMO (B3u) = -0.0157272681581051
cycle= 22 E= -75.2721724302407  delta_E= -2.84e-14  |g|= 2.18e-10  |ddm|= 3.02e-10
HOMO (B2u) = -0.324118744544415  LUMO (B3u) = -0.0157272681554593
cycle= 23 E= -75.2721724302406  delta_E= 2.84e-14  |g|= 1.93e-10  |ddm|= 6.87e-11
HOMO (B2u) = -0.324118744538212  LUMO (B3u) = -0.0157272681524936
cycle= 24 E= -75.2721724302406  delta_E= 8.53e-14  |g|= 1.65e-10  |ddm|= 7.25e-11
HOMO (B2u) = -0.324118744535101  LUMO (B3u) = -0.0157272681500455
cycle= 25 E= -75.2721724302405  delta_E= 8.53e-14  |g|= 1.38e-10  |ddm|= 6.71e-11
HOMO (B2u) = -0.324118744530822  LUMO (B3u) = -0.0157272681480841
cycle= 26 E= -75.2721724302404  delta_E= 7.11e-14  |g|= 1.08e-10  |ddm|= 8.36e-11
HOMO (B2u) = -0.324118744527575  LUMO (B3u) = -0.0157272681465808
cycle= 27 E= -75.2721724302403  delta_E= 7.11e-14  |g|= 8.72e-11  |ddm|= 6.36e-11
HOMO (B2u) = -0.324118744524961  LUMO (B3u) = -0.0157272681452983
cycle= 28 E= -75.2721724302403  delta_E= 1.42e-14  |g|= 6.95e-11  |ddm|= 4.83e-11
HOMO (B2u) = -0.324118744522971  LUMO (B3u) = -0.0157272681443219
cycle= 29 E= -75.2721724302402  delta_E= 7.11e-14  |g|= 5.47e-11  |ddm|= 3.78e-11
HOMO (B2u) = -0.324118744521453  LUMO (B3u) = -0.0157272681435362
cycle= 30 E= -75.27217243024  delta_E= 2.7e-13  |g|= 4.37e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.324118744520461  LUMO (B3u) = -0.0157272681429921
cycle= 31 E= -75.2721724302396  delta_E= 3.41e-13  |g|= 3.68e-11  |ddm|= 1.77e-11
HOMO (B2u) = -0.324118744519503  LUMO (B3u) = -0.0157272681424923
cycle= 32 E= -75.2721724302392  delta_E= 4.12e-13  |g|= 3.08e-11  |ddm|= 1.59e-11
HOMO (B2u) = -0.324118744518729  LUMO (B3u) = -0.0157272681420612
cycle= 33 E= -75.2721724302388  delta_E= 4.26e-13  |g|= 2.57e-11  |ddm|= 1.37e-11
HOMO (B2u) = -0.324118744518028  LUMO (B3u) = -0.015727268141691
cycle= 34 E= -75.2721724302384  delta_E= 3.69e-13  |g|= 2.16e-11  |ddm|= 1.16e-11
HOMO (B2u) = -0.324118744517449  LUMO (B3u) = -0.0157272681413647
cycle= 35 E= -75.2721724302379  delta_E= 4.83e-13  |g|= 1.86e-11  |ddm|= 9.14e-12
HOMO (B2u) = -0.324118744516944  LUMO (B3u) = -0.0157272681410546
cycle= 36 E= -75.2721724302376  delta_E= 3.69e-13  |g|= 1.6e-11  |ddm|= 7.5e-12
HOMO (B2u) = -0.324118744516496  LUMO (B3u) = -0.0157272681407549
cycle= 37 E= -75.272172430237  delta_E= 5.68e-13  |g|= 1.38e-11  |ddm|= 6.19e-12
HOMO (B2u) = -0.324118744516093  LUMO (B3u) = -0.0157272681404662
cycle= 38 E= -75.2721724302364  delta_E= 5.97e-13  |g|= 1.18e-11  |ddm|= 5.11e-12
HOMO (B2u) = -0.324118744515717  LUMO (B3u) = -0.0157272681401788
cycle= 39 E= -75.2721724302358  delta_E= 6.25e-13  |g|= 1.03e-11  |ddm|= 4.33e-12
HOMO (B2u) = -0.324118744515359  LUMO (B3u) = -0.0157272681398901
cycle= 40 E= -75.2721724302352  delta_E= 6.25e-13  |g|= 9.22e-12  |ddm|= 3.78e-12
HOMO (B2u) = -0.324118744515018  LUMO (B3u) = -0.0157272681396014
cycle= 41 E= -75.2721724302347  delta_E= 4.55e-13  |g|= 8.34e-12  |ddm|= 3.38e-12
HOMO (B2u) = -0.324118744514691  LUMO (B3u) = -0.0157272681393123
cycle= 42 E= -75.2721724302341  delta_E= 5.68e-13  |g|= 7.42e-12  |ddm|= 2.83e-12
HOMO (B2u) = -0.324118744514376  LUMO (B3u) = -0.0157272681390228
cycle= 43 E= -75.2721724302337  delta_E= 4.26e-13  |g|= 6.35e-12  |ddm|= 2.41e-12
HOMO (B2u) = -0.324118744514072  LUMO (B3u) = -0.0157272681387355
cycle= 44 E= -75.2721724302331  delta_E= 5.97e-13  |g|= 5.63e-12  |ddm|= 2.11e-12
HOMO (B2u) = -0.324118744513777  LUMO (B3u) = -0.0157272681384491
cycle= 45 E= -75.2721724302326  delta_E= 5.4e-13  |g|= 5.31e-12  |ddm|= 1.9e-12
HOMO (B2u) = -0.324118744513485  LUMO (B3u) = -0.0157272681381599
cycle= 46 E= -75.272172430232  delta_E= 5.54e-13  |g|= 5.2e-12  |ddm|= 1.85e-12
HOMO (B2u) = -0.324118744513198  LUMO (B3u) = -0.0157272681378723
cycle= 47 E= -75.2721724302317  delta_E= 3.55e-13  |g|= 4.58e-12  |ddm|= 1.92e-12
HOMO (B2u) = -0.32411874451292  LUMO (B3u) = -0.0157272681375912
cycle= 48 E= -75.2721724302314  delta_E= 3.13e-13  |g|= 4.1e-12  |ddm|= 1.9e-12
HOMO (B2u) = -0.32411874451265  LUMO (B3u) = -0.0157272681373174
cycle= 49 E= -75.2721724302309  delta_E= 4.55e-13  |g|= 3.61e-12  |ddm|= 1.89e-12
HOMO (B2u) = -0.324118744512387  LUMO (B3u) = -0.0157272681370478
cycle= 50 E= -75.2721724302306  delta_E= 2.84e-13  |g|= 3.11e-12  |ddm|= 1.98e-12
SCF not converged.
SCF energy = -75.2721724302306

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpmwnfz_mh
max_memory 4000 MB (current use 5119 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4211674784894  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4379918121482  dE = -0.016824334  S^2 = 0.0000000
               |grad[o]|=0.104  |ddm|= 3.77  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4503289251306  dE = -0.012337113  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.111  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4576762812411  dE = -0.0073473561  S^2 = 0.0000000
               |grad[o]|=0.052  |ddm|=0.0312  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4606569087801  dE = -0.0029806275  S^2 = 0.0000000
               |grad[o]|=0.0258  |ddm|=0.107  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4620588880305  dE = -0.0014019793  S^2 = 0.0000000
               |grad[o]|=0.0131  |ddm|=0.037  |maxRot[o]|=0.0599
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4622924874447  dE = -0.00023359941  S^2 = 0.0000000
               |grad[o]|=0.00491  |ddm|=0.0145  |maxRot[o]|=0.0321
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4623128145835  dE = -2.0327139e-05  S^2 = 0.0000000
               |grad[o]|=0.00177  |ddm|=0.00549  |maxRot[o]|= 0.01
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4623145092852  dE = -1.6947017e-06  S^2 = 0.0000000
               |grad[o]|=0.000572  |ddm|=0.00171  |maxRot[o]|=0.00292
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4623146491677  dE = -1.3988243e-07  S^2 = 0.0000000
               |grad[o]|=0.000171  |ddm|=0.000523  |maxRot[o]|=0.000831
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4623146606567  dE = -1.1489021e-08  S^2 = 0.0000000
               |grad[o]|=4.97e-05  |ddm|=0.000154  |maxRot[o]|=0.000238
macro iter 11 (3 JK  0 micro), CASSCF E = -75.462314661606  dE = -9.4934194e-10  S^2 = 0.0000000
               |grad[o]|=1.46e-05  |ddm|=4.41e-05  |maxRot[o]|=6.81e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4623146616922  dE = -8.6231466e-11  S^2 = 0.0000000
               |grad[o]|=4.22e-06  |ddm|=1.28e-05  |maxRot[o]|=1.92e-05
2-step CASSCF converged in 12 macro (49 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9562916  1.93503351 1.86223013 1.69240301 0.06476757 0.31259504
 0.05599298 0.12068616]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01220   0.01062  -0.00217   0.00000   0.00000
  0 C 2s       0.69087   0.67520  -0.14918  -0.00000   0.00000
  0 C 3s       0.00130   0.01496  -0.02972  -0.00000   0.00000
  0 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69367
  0 C 2py      0.00000  -0.00000  -0.00000   0.70446   0.00000
  0 C 2pz      0.14914  -0.20886   0.68947  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000  -0.06711
  0 C 3py      0.00000  -0.00000  -0.00000   0.05509  -0.00000
  0 C 3pz     -0.01004  -0.00168   0.01737  -0.00000   0.00000
  0 C 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02654   0.00000
  0 C 3dz^2    0.01444  -0.01051   0.03370  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.11966
 0 C 3dx2-y2   0.00150   0.00603  -0.00686  -0.00000  -0.00000
  1 C 1s       0.01220  -0.01062  -0.00217   0.00000   0.00000
  1 C 2s       0.69087  -0.67520  -0.14918   0.00000  -0.00000
  1 C 3s       0.00130  -0.01496  -0.02972   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.69367
  1 C 2py     -0.00000   0.00000   0.00000   0.70446   0.00000
  1 C 2pz     -0.14914  -0.20886  -0.68947   0.00000   0.00000
  1 C 3px     -0.00000  -0.00000   0.00000   0.00000  -0.06711
  1 C 3py     -0.00000   0.00000   0.00000   0.05509  -0.00000
  1 C 3pz      0.01004  -0.00168  -0.01737  -0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02654   0.00000
  1 C 3dz^2    0.01444   0.01051   0.03370   0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11966
 1 C 3dx2-y2   0.00150  -0.00603  -0.00686  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00024
  0 C 2s      -0.00000   0.00000   0.20816
  0 C 3s      -0.00000   0.00000   0.02837
  0 C 2px     -0.00000   0.69855   0.00000
  0 C 2py      0.70705  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.67455
  0 C 3px     -0.00000  -0.01822   0.00000
  0 C 3py     -0.00084  -0.00000   0.00000
  0 C 3pz     -0.00000   0.00000  -0.02485
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00885  -0.00000   0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00357
  0 C 3dxz    -0.00000  -0.10813  -0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.01462
  1 C 1s       0.00000   0.00000   0.00024
  1 C 2s       0.00000   0.00000  -0.20816
  1 C 3s       0.00000  -0.00000  -0.02837
  1 C 2px      0.00000  -0.69855  -0.00000
  1 C 2py     -0.70705   0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.67455
  1 C 3px      0.00000   0.01822  -0.00000
  1 C 3py      0.00084   0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.02485
  1 C 3dxy    -0.00000   0.00000   0.00000
  1 C 3dyz     0.00885  -0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00357
  1 C 3dxz    -0.00000  -0.10813   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01462
<CAS-nat-orb|mo-hf>  3  3    0.99826977
<CAS-nat-orb|mo-hf>  4  4    0.99964485
<CAS-nat-orb|mo-hf>  5  5    0.99825062
<CAS-nat-orb|mo-hf>  6  6    0.99862457
<CAS-nat-orb|mo-hf>  7  7    0.93325603
<CAS-nat-orb|mo-hf>  8  8    0.98517025
<CAS-nat-orb|mo-hf>  9  9    0.96077009
<CAS-nat-orb|mo-hf>  10  10    0.95215925
CASSCF energy = -75.4623146616922
CASCI E = -75.4623146616922  E(CI) = -14.956787191147  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.006
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.012

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.001
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.061
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.017
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.004
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.004
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.015
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.014
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.116
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.08
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.09
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.292 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.172 | Tfpread = 0.000 | Tfpwrite = 0.168 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.560 | E =     -75.5568040966 | DW = 1.68e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.802 | E =     -75.5800331423 | DE = -2.32e-02 | DW = 6.56e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.615 | E =     -75.5805376490 | DE = -5.05e-04 | DW = 1.65e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.812 | E =     -75.5809749879 | DE = -4.37e-04 | DW = 8.07e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.862 | E =     -75.5809947449 | DE = -1.98e-05 | DW = 1.62e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.946 | E =     -75.5810324710 | DE = -3.77e-05 | DW = 7.97e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.919 | E =     -75.5810526138 | DE = -2.01e-05 | DW = 1.66e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.040 | E =     -75.5810690295 | DE = -1.64e-05 | DW = 8.21e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     12.756 | E =     -75.5821486543 | DE = -1.08e-03 | DW = 1.55e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.267 | E =     -75.5826319934 | DE = -4.83e-04 | DW = 2.52e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     24.337 | E =     -75.5827815282 | DE = -1.50e-04 | DW = 4.43e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     28.570 | E =     -75.5828397879 | DE = -5.83e-05 | DW = 3.23e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.409 | E =     -75.5828513019 | DE = -1.15e-05 | DW = 4.60e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.690 | E =     -75.5828594743 | DE = -8.17e-06 | DW = 3.27e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     40.499 | E =     -75.5828681277 | DE = -8.65e-06 | DW = 4.62e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     43.686 | E =     -75.5828726031 | DE = -4.48e-06 | DW = 3.29e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.497 | E =     -75.5830268891 | DE = -1.54e-04 | DW = 2.76e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     63.669 | E =     -75.5830698410 | DE = -4.30e-05 | DW = 2.01e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     75.729 | E =     -75.5830797539 | DE = -9.91e-06 | DW = 4.56e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     91.745 | E =     -75.5830832835 | DE = -3.53e-06 | DW = 2.10e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    102.087 | E =     -75.5830866675 | DE = -3.38e-06 | DW = 4.60e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.699 | E =     -75.5830893570 | DE = -2.69e-06 | DW = 2.10e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    121.944 | E =     -75.5830920342 | DE = -2.68e-06 | DW = 4.56e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    132.530 | E =     -75.5830943415 | DE = -2.31e-06 | DW = 2.10e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    155.209 | E =     -75.5831067120 | DE = -1.24e-05 | DW = 2.40e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    182.440 | E =     -75.5831106346 | DE = -3.92e-06 | DW = 1.16e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    282.016 | E =     -75.5831564475 | DE = -4.58e-05 | DW = 2.55e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    309.081 | E =     -75.5831571907 | DE = -7.43e-07 | DW = 1.17e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    341.876 | E =     -75.5831572371 | DE = -4.64e-08 | DW = 2.25e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    376.732 | E =     -75.5831576792 | DE = -4.42e-07 | DW = 1.11e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    404.436 | E =     -75.5831577264 | DE = -4.73e-08 | DW = 2.34e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    435.102 | E =     -75.5831580172 | DE = -2.91e-07 | DW = 1.11e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    663.132 | E =     -75.5831607537 | DE = -2.74e-06 | DW = 5.57e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    806.744 | E =     -75.5831607538 | DE = -7.82e-11 | DW = 5.58e-08

E(MRCI) = -75.58316075375613  E_corr = -0.1208460920638856
Time cost =    859.508
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:37:04 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.037332262042 AA    0.000000000000   0.000000000000   3.850000000000 Bohr   0.0

nuclear repulsion = 9.35064935064935
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.925]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    408806.42


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpyq7irgis
max_memory 4000 MB (current use 5097 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6842509501291

WARN: Singularity detected in overlap matrix (condition number = 66.5). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.096233291331383  LUMO (B3u) = -0.0962332913313831

WARN: B2u HOMO -0.096233291331383 > system LUMO -0.0962332913313831

cycle= 1 E= -75.241333020414  delta_E= -0.557  |g|= 0.231  |ddm|= 1.46
HOMO (B2u) = -0.349057007799765  LUMO (B3u) = -0.0466518414985259
cycle= 2 E= -75.2629125920112  delta_E= -0.0216  |g|= 0.0454  |ddm|= 0.348
HOMO (B2u) = -0.316770424633126  LUMO (B3u) = -0.00980180087757371
cycle= 3 E= -75.2641493459228  delta_E= -0.00124  |g|= 0.0169  |ddm|= 0.0593
HOMO (B2u) = -0.321075514288453  LUMO (B3u) = -0.0139142694602797
cycle= 4 E= -75.2643552043106  delta_E= -0.000206  |g|= 0.000645  |ddm|= 0.0339
HOMO (B2u) = -0.321213308623813  LUMO (B3u) = -0.0141930697532558
cycle= 5 E= -75.2643553636796  delta_E= -1.59e-07  |g|= 0.000131  |ddm|= 0.00083
HOMO (B2u) = -0.321177935176444  LUMO (B3u) = -0.0141663723644065
cycle= 6 E= -75.2643553735705  delta_E= -9.89e-09  |g|= 1.94e-05  |ddm|= 0.000225
HOMO (B2u) = -0.321175177873357  LUMO (B3u) = -0.014166489841589
cycle= 7 E= -75.2643553738139  delta_E= -2.43e-10  |g|= 1.96e-06  |ddm|= 3.98e-05
HOMO (B2u) = -0.321174743989146  LUMO (B3u) = -0.0141665118435128
cycle= 8 E= -75.2643553738163  delta_E= -2.4e-12  |g|= 1.29e-07  |ddm|= 4.1e-06
HOMO (B2u) = -0.321174751334008  LUMO (B3u) = -0.0141665127830991
cycle= 9 E= -75.2643553738164  delta_E= -1.14e-13  |g|= 8.24e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.321174750584952  LUMO (B3u) = -0.0141665142894426
cycle= 10 E= -75.2643553738163  delta_E= 8.53e-14  |g|= 7.1e-09  |ddm|= 7e-09
HOMO (B2u) = -0.321174750650722  LUMO (B3u) = -0.0141665144507412
cycle= 11 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 5.04e-09  |ddm|= 5.83e-09
HOMO (B2u) = -0.321174749547505  LUMO (B3u) = -0.0141665133016324
cycle= 12 E= -75.2643553738163  delta_E= 1.42e-14  |g|= 4.3e-09  |ddm|= 2.94e-09
HOMO (B2u) = -0.321174749705739  LUMO (B3u) = -0.0141665134762837
cycle= 13 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 3.84e-09  |ddm|= 1.62e-09
HOMO (B2u) = -0.321174749276046  LUMO (B3u) = -0.0141665132806752
cycle= 14 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 8.46e-10  |ddm|= 7.27e-09
HOMO (B2u) = -0.321174749384385  LUMO (B3u) = -0.01416651331755
cycle= 15 E= -75.2643553738163  delta_E= -7.11e-14  |g|= 8.86e-10  |ddm|= 1.28e-09
HOMO (B2u) = -0.321174749304162  LUMO (B3u) = -0.0141665133064282
cycle= 16 E= -75.2643553738163  delta_E= 4.26e-14  |g|= 7.94e-10  |ddm|= 9.85e-10
HOMO (B2u) = -0.321174749333596  LUMO (B3u) = -0.0141665132831892
cycle= 17 E= -75.2643553738162  delta_E= 5.68e-14  |g|= 9.47e-10  |ddm|= 1.24e-09
HOMO (B2u) = -0.321174749300381  LUMO (B3u) = -0.0141665132664835
cycle= 18 E= -75.2643553738163  delta_E= -2.84e-14  |g|= 7.16e-10  |ddm|= 5.97e-10
HOMO (B2u) = -0.321174749295833  LUMO (B3u) = -0.0141665132755054
cycle= 19 E= -75.2643553738163  delta_E= -1.42e-14  |g|= 5.5e-10  |ddm|= 5.57e-10
HOMO (B2u) = -0.321174749295965  LUMO (B3u) = -0.0141665132864369
cycle= 20 E= -75.2643553738162  delta_E= 4.26e-14  |g|= 4.32e-10  |ddm|= 3.85e-10
HOMO (B2u) = -0.321174749282987  LUMO (B3u) = -0.0141665132820904
cycle= 21 E= -75.2643553738162  delta_E= 2.84e-14  |g|= 3.14e-10  |ddm|= 3.18e-10
HOMO (B2u) = -0.321174749272132  LUMO (B3u) = -0.0141665132799465
cycle= 22 E= -75.2643553738163  delta_E= -7.11e-14  |g|= 2.03e-10  |ddm|= 2.88e-10
HOMO (B2u) = -0.321174749269654  LUMO (B3u) = -0.0141665132774818
cycle= 23 E= -75.2643553738162  delta_E= 1.14e-13  |g|= 1.8e-10  |ddm|= 6.28e-11
HOMO (B2u) = -0.32117474926374  LUMO (B3u) = -0.0141665132746971
cycle= 24 E= -75.2643553738162  delta_E= 1.42e-14  |g|= 1.53e-10  |ddm|= 6.81e-11
HOMO (B2u) = -0.32117474926111  LUMO (B3u) = -0.0141665132723735
cycle= 25 E= -75.2643553738161  delta_E= 8.53e-14  |g|= 1.29e-10  |ddm|= 6e-11
HOMO (B2u) = -0.321174749257179  LUMO (B3u) = -0.0141665132707343
cycle= 26 E= -75.264355373816  delta_E= 1.14e-13  |g|= 1.01e-10  |ddm|= 7.85e-11
HOMO (B2u) = -0.321174749254215  LUMO (B3u) = -0.0141665132694849
cycle= 27 E= -75.264355373816  delta_E= -1.42e-14  |g|= 8.19e-11  |ddm|= 5.99e-11
HOMO (B2u) = -0.321174749251807  LUMO (B3u) = -0.0141665132683819
cycle= 28 E= -75.2643553738158  delta_E= 1.42e-13  |g|= 6.53e-11  |ddm|= 4.52e-11
HOMO (B2u) = -0.321174749249962  LUMO (B3u) = -0.0141665132675277
cycle= 29 E= -75.2643553738157  delta_E= 9.95e-14  |g|= 5.17e-11  |ddm|= 3.53e-11
HOMO (B2u) = -0.321174749248556  LUMO (B3u) = -0.0141665132668279
cycle= 30 E= -75.2643553738154  delta_E= 2.84e-13  |g|= 4.13e-11  |ddm|= 2.58e-11
HOMO (B2u) = -0.32117474924764  LUMO (B3u) = -0.0141665132663293
cycle= 31 E= -75.2643553738151  delta_E= 3.98e-13  |g|= 3.5e-11  |ddm|= 1.64e-11
HOMO (B2u) = -0.321174749246748  LUMO (B3u) = -0.014166513265871
cycle= 32 E= -75.2643553738146  delta_E= 4.26e-13  |g|= 2.92e-11  |ddm|= 1.48e-11
HOMO (B2u) = -0.32117474924603  LUMO (B3u) = -0.0141665132654738
cycle= 33 E= -75.2643553738143  delta_E= 3.69e-13  |g|= 2.45e-11  |ddm|= 1.28e-11
HOMO (B2u) = -0.321174749245367  LUMO (B3u) = -0.014166513265133
cycle= 34 E= -75.2643553738139  delta_E= 3.13e-13  |g|= 2.06e-11  |ddm|= 1.09e-11
HOMO (B2u) = -0.321174749244817  LUMO (B3u) = -0.0141665132648277
cycle= 35 E= -75.2643553738135  delta_E= 3.98e-13  |g|= 1.78e-11  |ddm|= 8.55e-12
HOMO (B2u) = -0.321174749244337  LUMO (B3u) = -0.0141665132645346
cycle= 36 E= -75.264355373813  delta_E= 5.4e-13  |g|= 1.53e-11  |ddm|= 7.05e-12
HOMO (B2u) = -0.321174749243908  LUMO (B3u) = -0.0141665132642471
cycle= 37 E= -75.2643553738125  delta_E= 4.83e-13  |g|= 1.3e-11  |ddm|= 5.89e-12
HOMO (B2u) = -0.321174749243518  LUMO (B3u) = -0.0141665132639656
cycle= 38 E= -75.2643553738119  delta_E= 6.11e-13  |g|= 1.12e-11  |ddm|= 4.91e-12
HOMO (B2u) = -0.321174749243158  LUMO (B3u) = -0.0141665132636862
cycle= 39 E= -75.2643553738113  delta_E= 5.68e-13  |g|= 9.87e-12  |ddm|= 4.04e-12
HOMO (B2u) = -0.321174749242813  LUMO (B3u) = -0.0141665132634064
cycle= 40 E= -75.2643553738107  delta_E= 5.97e-13  |g|= 8.75e-12  |ddm|= 3.61e-12
HOMO (B2u) = -0.321174749242489  LUMO (B3u) = -0.0141665132631288
cycle= 41 E= -75.2643553738103  delta_E= 4.41e-13  |g|= 7.77e-12  |ddm|= 3.09e-12
HOMO (B2u) = -0.321174749242179  LUMO (B3u) = -0.0141665132628535
cycle= 42 E= -75.2643553738098  delta_E= 4.55e-13  |g|= 6.8e-12  |ddm|= 2.61e-12
HOMO (B2u) = -0.321174749241878  LUMO (B3u) = -0.0141665132625761
cycle= 43 E= -75.2643553738093  delta_E= 5.97e-13  |g|= 6.23e-12  |ddm|= 2.41e-12
HOMO (B2u) = -0.321174749241584  LUMO (B3u) = -0.0141665132622965
cycle= 44 E= -75.2643553738087  delta_E= 5.12e-13  |g|= 5.75e-12  |ddm|= 2.24e-12
HOMO (B2u) = -0.321174749241297  LUMO (B3u) = -0.0141665132620178
cycle= 45 E= -75.2643553738083  delta_E= 4.55e-13  |g|= 5.46e-12  |ddm|= 2.1e-12
HOMO (B2u) = -0.321174749241011  LUMO (B3u) = -0.0141665132617349
cycle= 46 E= -75.2643553738078  delta_E= 5.26e-13  |g|= 5.33e-12  |ddm|= 2.05e-12
HOMO (B2u) = -0.321174749240726  LUMO (B3u) = -0.014166513261451
cycle= 47 E= -75.2643553738074  delta_E= 3.41e-13  |g|= 4.98e-12  |ddm|= 2.22e-12
HOMO (B2u) = -0.321174749240447  LUMO (B3u) = -0.0141665132611716
cycle= 48 E= -75.264355373807  delta_E= 3.69e-13  |g|= 4.29e-12  |ddm|= 2.29e-12
HOMO (B2u) = -0.32117474924018  LUMO (B3u) = -0.0141665132609041
cycle= 49 E= -75.2643553738068  delta_E= 2.98e-13  |g|= 3.55e-12  |ddm|= 2.37e-12
HOMO (B2u) = -0.32117474923992  LUMO (B3u) = -0.0141665132606443
cycle= 50 E= -75.2643553738065  delta_E= 2.56e-13  |g|= 3.05e-12  |ddm|= 2.27e-12
SCF not converged.
SCF energy = -75.2643553738065

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpyq7irgis
max_memory 4000 MB (current use 5097 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4176796778916  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4350254781542  dE = -0.0173458  S^2 = 0.0000000
               |grad[o]|=0.106  |ddm|= 3.76  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4474337661387  dE = -0.012408288  S^2 = 0.0000000
               |grad[o]|=0.0797  |ddm|=0.116  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.454492809712  dE = -0.0070590436  S^2 = 0.0000000
               |grad[o]|=0.0502  |ddm|=0.0257  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4570198551691  dE = -0.0025270455  S^2 = 0.0000000
               |grad[o]|=0.0225  |ddm|=0.109  |maxRot[o]|=0.0599
macro iter 5 (5 JK  0 micro), CASSCF E = -75.4582156668854  dE = -0.0011958117  S^2 = 0.0000000
               |grad[o]|=0.0117  |ddm|=0.029  |maxRot[o]|=0.0599
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4583447280451  dE = -0.00012906116  S^2 = 0.0000000
               |grad[o]|=0.00413  |ddm|=0.013  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4583764279366  dE = -3.1699892e-05  S^2 = 0.0000000
               |grad[o]|=0.00208  |ddm|=0.00331  |maxRot[o]|=0.0124
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4583791016405  dE = -2.6737039e-06  S^2 = 0.0000000
               |grad[o]|=0.000717  |ddm|=0.00209  |maxRot[o]|=0.00364
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4583793258095  dE = -2.24169e-07  S^2 = 0.0000000
               |grad[o]|=0.000222  |ddm|=0.000651  |maxRot[o]|=0.00105
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4583793445603  dE = -1.8750811e-08  S^2 = 0.0000000
               |grad[o]|=6.53e-05  |ddm|=0.000197  |maxRot[o]|=0.000301
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4583793461255  dE = -1.5652262e-09  S^2 = 0.0000000
               |grad[o]|=1.94e-05  |ddm|=5.74e-05  |maxRot[o]|=8.66e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.458379346256  dE = -1.3049828e-10  S^2 = 0.0000000
               |grad[o]|=5.65e-06  |ddm|=1.67e-05  |maxRot[o]|=2.51e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4583793462636  dE = -7.5459639e-12  S^2 = 0.0000000
               |grad[o]|=1.67e-06  |ddm|=4.59e-06  |maxRot[o]|=7.48e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95597951 1.93565085 1.85505359 1.67538712 0.06382139 0.32940991
 0.0556711  0.12902653]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01228   0.01069  -0.00190   0.00000   0.00000
  0 C 2s       0.69385   0.67734  -0.13470  -0.00000  -0.00000
  0 C 3s       0.00257   0.01477  -0.02786  -0.00000  -0.00000
  0 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69376
  0 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  0 C 2pz      0.13475  -0.20184   0.69251   0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000   0.00000  -0.06778
  0 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  0 C 3pz     -0.00941  -0.00168   0.01906  -0.00000  -0.00000
  0 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02538  -0.00000
  0 C 3dz^2    0.01317  -0.01016   0.03314  -0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000  -0.11878
 0 C 3dx2-y2   0.00169   0.00594  -0.00676   0.00000  -0.00000
  1 C 1s       0.01228  -0.01069  -0.00190   0.00000   0.00000
  1 C 2s       0.69385  -0.67734  -0.13470   0.00000  -0.00000
  1 C 3s       0.00257  -0.01477  -0.02786  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000  -0.00000   0.69376
  1 C 2py      0.00000  -0.00000   0.00000   0.70449  -0.00000
  1 C 2pz     -0.13475  -0.20184  -0.69251  -0.00000  -0.00000
  1 C 3px      0.00000   0.00000  -0.00000   0.00000  -0.06778
  1 C 3py     -0.00000   0.00000  -0.00000   0.05523   0.00000
  1 C 3pz      0.00941  -0.00168  -0.01906   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.02538   0.00000
  1 C 3dz^2    0.01317   0.01016   0.03314  -0.00000   0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000  -0.00000   0.11878
 1 C 3dx2-y2   0.00169  -0.00594  -0.00676  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00022
  0 C 2s      -0.00000  -0.00000   0.20120
  0 C 3s      -0.00000  -0.00000   0.02738
  0 C 2px     -0.00000   0.69868  -0.00000
  0 C 2py      0.70706  -0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.67682
  0 C 3px     -0.00000  -0.01985  -0.00000
  0 C 3py      0.00101  -0.00000  -0.00000
  0 C 3pz     -0.00000  -0.00000  -0.02216
  0 C 3dxy     0.00000  -0.00000   0.00000
  0 C 3dyz     0.00847   0.00000  -0.00000
  0 C 3dz^2   -0.00000  -0.00000   0.00304
  0 C 3dxz    -0.00000  -0.10700  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01365
  1 C 1s       0.00000   0.00000   0.00022
  1 C 2s       0.00000   0.00000  -0.20120
  1 C 3s       0.00000   0.00000  -0.02738
  1 C 2px      0.00000  -0.69868   0.00000
  1 C 2py     -0.70706   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67682
  1 C 3px      0.00000   0.01985   0.00000
  1 C 3py     -0.00101   0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.02216
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00847  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00304
  1 C 3dxz    -0.00000  -0.10700  -0.00000
 1 C 3dx2-y2  -0.00000  -0.00000   0.01365
<CAS-nat-orb|mo-hf>  3  3    0.99758992
<CAS-nat-orb|mo-hf>  4  4    0.99962978
<CAS-nat-orb|mo-hf>  5  5    0.99755850
<CAS-nat-orb|mo-hf>  6  6    0.99855438
<CAS-nat-orb|mo-hf>  7  7    0.93304991
<CAS-nat-orb|mo-hf>  8  8    0.98603349
<CAS-nat-orb|mo-hf>  9  9    0.96086979
<CAS-nat-orb|mo-hf>  10  10    0.95616483
CASSCF energy = -75.4583793462636
CASCI E = -75.4583793462636  E(CI) = -14.8982404186176  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.030
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.040
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.040
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.337
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.082
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.642

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.030
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.611
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.722
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.723
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.724
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      2.322
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      2.320
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =     10.483
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.10
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.13
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.10
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.05
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.594 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.309 | Tfpread = 0.000 | Tfpwrite = 0.307 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.755 | E =     -75.5527002841 | DW = 1.68e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.732 | E =     -75.5762225084 | DE = -2.35e-02 | DW = 6.67e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.763 | E =     -75.5767488066 | DE = -5.26e-04 | DW = 1.65e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.641 | E =     -75.5771968439 | DE = -4.48e-04 | DW = 8.11e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.396 | E =     -75.5772199181 | DE = -2.31e-05 | DW = 1.61e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     23.778 | E =     -75.5772557611 | DE = -3.58e-05 | DW = 7.82e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     25.906 | E =     -75.5772681311 | DE = -1.24e-05 | DW = 1.64e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     28.593 | E =     -75.5772897424 | DE = -2.16e-05 | DW = 8.08e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.267 | E =     -75.5783255272 | DE = -1.04e-03 | DW = 1.54e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     41.493 | E =     -75.5788172133 | DE = -4.92e-04 | DW = 2.52e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     46.169 | E =     -75.5789648341 | DE = -1.48e-04 | DW = 4.42e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     49.364 | E =     -75.5790247652 | DE = -5.99e-05 | DW = 3.24e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     53.476 | E =     -75.5790396661 | DE = -1.49e-05 | DW = 4.53e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     57.907 | E =     -75.5790498493 | DE = -1.02e-05 | DW = 3.29e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     62.787 | E =     -75.5790597068 | DE = -9.86e-06 | DW = 4.57e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     67.754 | E =     -75.5790655994 | DE = -5.89e-06 | DW = 3.31e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     76.628 | E =     -75.5792234233 | DE = -1.58e-04 | DW = 2.75e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     89.398 | E =     -75.5792657772 | DE = -4.24e-05 | DW = 2.01e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    100.936 | E =     -75.5792773172 | DE = -1.15e-05 | DW = 4.57e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.739 | E =     -75.5792806606 | DE = -3.34e-06 | DW = 2.11e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    123.683 | E =     -75.5792837672 | DE = -3.11e-06 | DW = 4.54e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    135.873 | E =     -75.5792865607 | DE = -2.79e-06 | DW = 2.10e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    145.560 | E =     -75.5792893045 | DE = -2.74e-06 | DW = 4.53e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    156.157 | E =     -75.5792919446 | DE = -2.64e-06 | DW = 2.10e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    183.481 | E =     -75.5793553704 | DE = -6.34e-05 | DW = 2.39e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    211.341 | E =     -75.5793585366 | DE = -3.17e-06 | DW = 1.16e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    237.018 | E =     -75.5793590003 | DE = -4.64e-07 | DW = 2.28e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    265.800 | E =     -75.5793594438 | DE = -4.44e-07 | DW = 1.12e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    292.528 | E =     -75.5793595535 | DE = -1.10e-07 | DW = 2.32e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    322.259 | E =     -75.5793599200 | DE = -3.66e-07 | DW = 1.12e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    347.039 | E =     -75.5793599761 | DE = -5.62e-08 | DW = 2.32e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    378.304 | E =     -75.5793603257 | DE = -3.50e-07 | DW = 1.11e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    584.769 | E =     -75.5793668106 | DE = -6.48e-06 | DW = 5.63e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    723.015 | E =     -75.5793668107 | DE = -6.75e-11 | DW = 5.63e-08

E(MRCI) = -75.57936681065868  E_corr = -0.1209874643951139
Time cost =   1003.485
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 22:53:48 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.063791122588 AA    0.000000000000   0.000000000000   3.900000000000 Bohr   0.0

nuclear repulsion = 9.23076923076923
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   1.95]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    423100.27


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpxl9mafiz
max_memory 4000 MB (current use 5099 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6749703835052

WARN: Singularity detected in overlap matrix (condition number = 62.4). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.0938346227346621  LUMO (B3u) = -0.0938346227346621

WARN: B2u HOMO -0.0938346227346621 > system LUMO -0.0938346227346621

cycle= 1 E= -75.2338921256661  delta_E= -0.559  |g|= 0.229  |ddm|= 1.46
HOMO (B2u) = -0.345853796512396  LUMO (B3u) = -0.0447783510681931
cycle= 2 E= -75.2552221736389  delta_E= -0.0213  |g|= 0.0449  |ddm|= 0.347
HOMO (B2u) = -0.313968969330057  LUMO (B3u) = -0.00834890411119893
cycle= 3 E= -75.2564345511741  delta_E= -0.00121  |g|= 0.0167  |ddm|= 0.0585
HOMO (B2u) = -0.318244577067684  LUMO (B3u) = -0.0124246975036506
cycle= 4 E= -75.2566372099209  delta_E= -0.000203  |g|= 0.000641  |ddm|= 0.0335
HOMO (B2u) = -0.318367270990409  LUMO (B3u) = -0.0126861477138977
cycle= 5 E= -75.2566373684186  delta_E= -1.58e-07  |g|= 0.000132  |ddm|= 0.000824
HOMO (B2u) = -0.318332550664859  LUMO (B3u) = -0.0126605067829988
cycle= 6 E= -75.2566373785487  delta_E= -1.01e-08  |g|= 1.96e-05  |ddm|= 0.000227
HOMO (B2u) = -0.318329772186369  LUMO (B3u) = -0.0126605767315263
cycle= 7 E= -75.2566373787974  delta_E= -2.49e-10  |g|= 1.98e-06  |ddm|= 4.01e-05
HOMO (B2u) = -0.318329352566567  LUMO (B3u) = -0.0126606192769706
cycle= 8 E= -75.2566373788  delta_E= -2.53e-12  |g|= 1.29e-07  |ddm|= 4.15e-06
HOMO (B2u) = -0.318329361479119  LUMO (B3u) = -0.0126606212717807
cycle= 9 E= -75.2566373788  delta_E= 2.84e-14  |g|= 7.84e-09  |ddm|= 3.16e-07
HOMO (B2u) = -0.31832936067614  LUMO (B3u) = -0.0126606228040161
cycle= 10 E= -75.2566373788  delta_E= -5.68e-14  |g|= 6.9e-09  |ddm|= 6.79e-09
HOMO (B2u) = -0.318329360806424  LUMO (B3u) = -0.0126606230301896
cycle= 11 E= -75.2566373788  delta_E= 5.68e-14  |g|= 4.88e-09  |ddm|= 5.61e-09
HOMO (B2u) = -0.318329359796188  LUMO (B3u) = -0.0126606219766804
cycle= 12 E= -75.2566373788  delta_E=    0  |g|= 4.15e-09  |ddm|= 2.93e-09
HOMO (B2u) = -0.318329359932217  LUMO (B3u) = -0.0126606221275516
cycle= 13 E= -75.2566373788  delta_E=    0  |g|= 3.71e-09  |ddm|= 1.52e-09
HOMO (B2u) = -0.318329359524989  LUMO (B3u) = -0.0126606219552329
cycle= 14 E= -75.2566373788  delta_E=    0  |g|= 7.6e-10  |ddm|= 7.09e-09
HOMO (B2u) = -0.318329359627898  LUMO (B3u) = -0.0126606219882047
cycle= 15 E= -75.2566373787999  delta_E= 2.84e-14  |g|= 8.15e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.318329359559799  LUMO (B3u) = -0.0126606219793819
cycle= 16 E= -75.2566373787999  delta_E=    0  |g|= 7.33e-10  |ddm|= 8.25e-10
HOMO (B2u) = -0.31832935958447  LUMO (B3u) = -0.0126606219560549
cycle= 17 E= -75.2566373788  delta_E= -5.68e-14  |g|= 8.82e-10  |ddm|= 1.15e-09
HOMO (B2u) = -0.318329359554326  LUMO (B3u) = -0.012660621941993
cycle= 18 E= -75.2566373788  delta_E=    0  |g|= 6.69e-10  |ddm|= 5.39e-10
HOMO (B2u) = -0.318329359551771  LUMO (B3u) = -0.0126606219524592
cycle= 19 E= -75.2566373788  delta_E= 2.84e-14  |g|= 5.12e-10  |ddm|= 5.27e-10
HOMO (B2u) = -0.31832935955355  LUMO (B3u) = -0.0126606219646638
cycle= 20 E= -75.2566373787999  delta_E= 2.84e-14  |g|= 4.02e-10  |ddm|= 3.62e-10
HOMO (B2u) = -0.318329359542686  LUMO (B3u) = -0.0126606219622955
cycle= 21 E= -75.2566373787999  delta_E= 5.68e-14  |g|= 2.91e-10  |ddm|= 2.95e-10
HOMO (B2u) = -0.318329359533467  LUMO (B3u) = -0.0126606219616156
cycle= 22 E= -75.2566373787999  delta_E=    0  |g|= 1.86e-10  |ddm|= 2.67e-10
HOMO (B2u) = -0.318329359531395  LUMO (B3u) = -0.0126606219593452
cycle= 23 E= -75.2566373788  delta_E= -1.42e-13  |g|= 1.65e-10  |ddm|= 5.47e-11
HOMO (B2u) = -0.318329359526161  LUMO (B3u) = -0.0126606219569053
cycle= 24 E= -75.2566373787998  delta_E= 2.27e-13  |g|= 1.4e-10  |ddm|= 6.18e-11
HOMO (B2u) = -0.318329359523757  LUMO (B3u) = -0.0126606219548878
cycle= 25 E= -75.2566373787998  delta_E=    0  |g|= 1.18e-10  |ddm|= 5.42e-11
HOMO (B2u) = -0.318329359520312  LUMO (B3u) = -0.012660621953642
cycle= 26 E= -75.2566373787996  delta_E= 1.71e-13  |g|= 9.27e-11  |ddm|= 7.11e-11
HOMO (B2u) = -0.318329359517734  LUMO (B3u) = -0.0126606219527
cycle= 27 E= -75.2566373787996  delta_E= 2.84e-14  |g|= 7.51e-11  |ddm|= 5.46e-11
HOMO (B2u) = -0.318329359515607  LUMO (B3u) = -0.0126606219518194
cycle= 28 E= -75.2566373787995  delta_E= 8.53e-14  |g|= 6.04e-11  |ddm|= 4.09e-11
HOMO (B2u) = -0.318329359513965  LUMO (B3u) = -0.0126606219511223
cycle= 29 E= -75.2566373787993  delta_E= 1.71e-13  |g|= 4.77e-11  |ddm|= 3.2e-11
HOMO (B2u) = -0.318329359512715  LUMO (B3u) = -0.0126606219505382
cycle= 30 E= -75.256637378799  delta_E= 3.13e-13  |g|= 3.8e-11  |ddm|= 2.33e-11
HOMO (B2u) = -0.318329359511903  LUMO (B3u) = -0.0126606219501112
cycle= 31 E= -75.2566373787986  delta_E= 3.69e-13  |g|= 3.21e-11  |ddm|= 1.48e-11
HOMO (B2u) = -0.318329359511105  LUMO (B3u) = -0.0126606219497203
cycle= 32 E= -75.2566373787983  delta_E= 3.41e-13  |g|= 2.69e-11  |ddm|= 1.33e-11
HOMO (B2u) = -0.318329359510459  LUMO (B3u) = -0.0126606219493823
cycle= 33 E= -75.256637378798  delta_E= 3.41e-13  |g|= 2.26e-11  |ddm|= 1.14e-11
HOMO (B2u) = -0.318329359509859  LUMO (B3u) = -0.0126606219490871
cycle= 34 E= -75.2566373787976  delta_E= 3.41e-13  |g|= 1.93e-11  |ddm|= 9.66e-12
HOMO (B2u) = -0.318329359509354  LUMO (B3u) = -0.0126606219488131
cycle= 35 E= -75.2566373787972  delta_E= 4.26e-13  |g|= 1.67e-11  |ddm|= 7.67e-12
HOMO (B2u) = -0.318329359508902  LUMO (B3u) = -0.0126606219485376
cycle= 36 E= -75.2566373787967  delta_E= 5.4e-13  |g|= 1.42e-11  |ddm|= 6.46e-12
HOMO (B2u) = -0.318329359508495  LUMO (B3u) = -0.0126606219482634
cycle= 37 E= -75.256637378796  delta_E= 6.25e-13  |g|= 1.21e-11  |ddm|= 5.4e-12
HOMO (B2u) = -0.31832935950812  LUMO (B3u) = -0.0126606219479872
cycle= 38 E= -75.2566373787954  delta_E= 6.54e-13  |g|= 1.06e-11  |ddm|= 4.47e-12
HOMO (B2u) = -0.318329359507772  LUMO (B3u) = -0.012660621947713
cycle= 39 E= -75.2566373787949  delta_E= 4.83e-13  |g|= 9.4e-12  |ddm|= 3.83e-12
HOMO (B2u) = -0.318329359507437  LUMO (B3u) = -0.012660621947437
cycle= 40 E= -75.2566373787945  delta_E= 4.26e-13  |g|= 8.37e-12  |ddm|= 3.26e-12
HOMO (B2u) = -0.318329359507118  LUMO (B3u) = -0.0126606219471606
cycle= 41 E= -75.256637378794  delta_E= 4.83e-13  |g|= 7.26e-12  |ddm|= 2.77e-12
HOMO (B2u) = -0.318329359506815  LUMO (B3u) = -0.0126606219468887
cycle= 42 E= -75.2566373787934  delta_E= 5.68e-13  |g|= 6.28e-12  |ddm|= 2.42e-12
HOMO (B2u) = -0.318329359506519  LUMO (B3u) = -0.0126606219466126
cycle= 43 E= -75.2566373787929  delta_E= 5.12e-13  |g|= 5.69e-12  |ddm|= 2.16e-12
HOMO (B2u) = -0.318329359506228  LUMO (B3u) = -0.012660621946334
cycle= 44 E= -75.2566373787923  delta_E= 5.68e-13  |g|= 5.51e-12  |ddm|= 2e-12
HOMO (B2u) = -0.318329359505938  LUMO (B3u) = -0.0126606219460514
cycle= 45 E= -75.2566373787918  delta_E= 5.4e-13  |g|= 5.06e-12  |ddm|= 2.01e-12
HOMO (B2u) = -0.31832935950565  LUMO (B3u) = -0.0126606219457674
cycle= 46 E= -75.2566373787915  delta_E= 2.56e-13  |g|= 4.54e-12  |ddm|= 2.02e-12
HOMO (B2u) = -0.318329359505372  LUMO (B3u) = -0.0126606219454915
cycle= 47 E= -75.2566373787912  delta_E= 3.69e-13  |g|= 3.89e-12  |ddm|= 2.02e-12
HOMO (B2u) = -0.318329359505106  LUMO (B3u) = -0.0126606219452272
cycle= 48 E= -75.256637378791  delta_E= 1.71e-13  |g|= 3.29e-12  |ddm|= 1.99e-12
HOMO (B2u) = -0.318329359504853  LUMO (B3u) = -0.0126606219449749
cycle= 49 E= -75.2566373787908  delta_E= 2.27e-13  |g|= 2.86e-12  |ddm|= 1.91e-12
HOMO (B2u) = -0.318329359504611  LUMO (B3u) = -0.0126606219447341
cycle= 50 E= -75.2566373787905  delta_E= 2.27e-13  |g|= 2.53e-12  |ddm|= 1.65e-12
SCF not converged.
SCF energy = -75.2566373787905

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpxl9mafiz
max_memory 4000 MB (current use 5099 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4143148843344  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4321977296481  dE = -0.017882845  S^2 = 0.0000000
               |grad[o]|=0.108  |ddm|= 3.75  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4446520957583  dE = -0.012454366  S^2 = 0.0000000
               |grad[o]|=0.0797  |ddm|=0.121  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4513995122573  dE = -0.0067474165  S^2 = 0.0000000
               |grad[o]|=0.0482  |ddm|=0.0219  |maxRot[o]|=0.0798
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4535335662461  dE = -0.002134054  S^2 = 0.0000000
               |grad[o]|=0.019  |ddm|=0.108  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4543108797402  dE = -0.00077731349  S^2 = 0.0000000
               |grad[o]|= 0.01  |ddm|=0.0225  |maxRot[o]|= 0.04
macro iter 6 (4 JK  0 micro), CASSCF E = -75.4545719136318  dE = -0.00026103389  S^2 = 0.0000000
               |grad[o]|=0.0052  |ddm|=0.00808  |maxRot[o]|=0.033
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4545949695584  dE = -2.3055927e-05  S^2 = 0.0000000
               |grad[o]|=0.00193  |ddm|=0.00569  |maxRot[o]|=0.0106
macro iter 8 (3 JK  0 micro), CASSCF E = -75.454596971422  dE = -2.0018636e-06  S^2 = 0.0000000
               |grad[o]|=0.000646  |ddm|=0.00183  |maxRot[o]|=0.00312
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4545971434662  dE = -1.7204415e-07  S^2 = 0.0000000
               |grad[o]|=0.0002  |ddm|=0.000578  |maxRot[o]|=0.000903
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4545971581455  dE = -1.4679301e-08  S^2 = 0.0000000
               |grad[o]|=5.9e-05  |ddm|=0.000175  |maxRot[o]|=0.000264
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4545971593865  dE = -1.2410055e-09  S^2 = 0.0000000
               |grad[o]|=1.78e-05  |ddm|=5.13e-05  |maxRot[o]|=7.65e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4545971594912  dE = -1.0466294e-10  S^2 = 0.0000000
               |grad[o]|=5.1e-06  |ddm|=1.54e-05  |maxRot[o]|=2.23e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4545971594996  dE = -8.4270368e-12  S^2 = 0.0000000
               |grad[o]|=1.52e-06  |ddm|=4.45e-06  |maxRot[o]|=6.52e-06
2-step CASSCF converged in 13 macro (50 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95573076 1.93626698 1.84718163 1.65763445 0.06292257 0.34695114
 0.05534506 0.1379674 ]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01234   0.01075  -0.00166   0.00000   0.00000
  0 C 2s       0.69629   0.67936  -0.12152  -0.00000  -0.00000
  0 C 3s       0.00370   0.01459  -0.02605   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69387
  0 C 2py     -0.00000   0.00000   0.00000   0.70453  -0.00000
  0 C 2pz      0.12164  -0.19495   0.69500  -0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000   0.00000  -0.06838
  0 C 3py     -0.00000   0.00000  -0.00000   0.05527   0.00000
  0 C 3pz     -0.00884  -0.00169   0.02073   0.00000  -0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02424   0.00000
  0 C 3dz^2    0.01200  -0.00982   0.03250   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000   0.00000  -0.11777
 0 C 3dx2-y2   0.00188   0.00585  -0.00666  -0.00000  -0.00000
  1 C 1s       0.01234  -0.01075  -0.00166   0.00000   0.00000
  1 C 2s       0.69629  -0.67936  -0.12152  -0.00000   0.00000
  1 C 3s       0.00370  -0.01459  -0.02605  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000   0.00000  -0.00000   0.69387
  1 C 2py      0.00000  -0.00000   0.00000   0.70453  -0.00000
  1 C 2pz     -0.12164  -0.19495  -0.69500  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06838
  1 C 3py      0.00000  -0.00000  -0.00000   0.05527   0.00000
  1 C 3pz      0.00884  -0.00169  -0.02073   0.00000  -0.00000
  1 C 3dxy     0.00000   0.00000  -0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.02424  -0.00000
  1 C 3dz^2    0.01200   0.00982   0.03250  -0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.11777
 1 C 3dx2-y2   0.00188  -0.00585  -0.00666   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00021
  0 C 2s      -0.00000  -0.00000   0.19437
  0 C 3s       0.00000  -0.00000   0.02640
  0 C 2px     -0.00000   0.69881  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000   0.00000   0.67895
  0 C 3px      0.00000  -0.02144   0.00000
  0 C 3py      0.00283  -0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01949
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00809  -0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00255
  0 C 3dxz     0.00000  -0.10583   0.00000
 0 C 3dx2-y2   0.00000  -0.00000  -0.01271
  1 C 1s       0.00000   0.00000   0.00021
  1 C 2s      -0.00000   0.00000  -0.19437
  1 C 3s       0.00000   0.00000  -0.02640
  1 C 2px     -0.00000  -0.69881  -0.00000
  1 C 2py     -0.70705   0.00000   0.00000
  1 C 2pz     -0.00000  -0.00000   0.67895
  1 C 3px      0.00000   0.02144   0.00000
  1 C 3py     -0.00283  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01949
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00809  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00255
  1 C 3dxz    -0.00000  -0.10583  -0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.01271
<CAS-nat-orb|mo-hf>  3  3    0.99692136
<CAS-nat-orb|mo-hf>  4  4    0.99961325
<CAS-nat-orb|mo-hf>  5  5    0.99687558
<CAS-nat-orb|mo-hf>  6  6    0.99848189
<CAS-nat-orb|mo-hf>  7  7    0.93292274
<CAS-nat-orb|mo-hf>  8  8    0.98684296
<CAS-nat-orb|mo-hf>  9  9    0.96096128
<CAS-nat-orb|mo-hf>  10  10    0.95978892
CASSCF energy = -75.4545971594996
CASCI E = -75.4545971594996  E(CI) = -14.841242977047  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.339
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.098
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.663

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.030
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.606
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.722
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.717
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.545
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.011
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      4.674
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.10
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.06
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.06
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.07
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.506 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.235 | Tfpread = 0.000 | Tfpwrite = 0.232 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.215 | E =     -75.5475653767 | DW = 1.73e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.713 | E =     -75.5725875423 | DE = -2.50e-02 | DW = 6.71e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.714 | E =     -75.5730708298 | DE = -4.83e-04 | DW = 1.64e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.554 | E =     -75.5735519604 | DE = -4.81e-04 | DW = 8.07e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     15.413 | E =     -75.5735648259 | DE = -1.29e-05 | DW = 1.58e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     18.208 | E =     -75.5736063801 | DE = -4.16e-05 | DW = 7.70e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     21.047 | E =     -75.5736195414 | DE = -1.32e-05 | DW = 1.60e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     23.832 | E =     -75.5736373290 | DE = -1.78e-05 | DW = 7.91e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.388 | E =     -75.5746917425 | DE = -1.05e-03 | DW = 1.54e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     37.472 | E =     -75.5751651181 | DE = -4.73e-04 | DW = 2.53e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     42.797 | E =     -75.5753139438 | DE = -1.49e-04 | DW = 4.44e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     47.767 | E =     -75.5753724240 | DE = -5.85e-05 | DW = 3.28e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.460 | E =     -75.5753855963 | DE = -1.32e-05 | DW = 4.62e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     57.494 | E =     -75.5753940573 | DE = -8.46e-06 | DW = 3.31e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     62.404 | E =     -75.5754037449 | DE = -9.69e-06 | DW = 4.62e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     66.986 | E =     -75.5754095833 | DE = -5.84e-06 | DW = 3.36e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     74.997 | E =     -75.5755667115 | DE = -1.57e-04 | DW = 2.71e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.001 | E =     -75.5756091179 | DE = -4.24e-05 | DW = 1.94e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     99.492 | E =     -75.5756215547 | DE = -1.24e-05 | DW = 4.54e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    111.679 | E =     -75.5756251078 | DE = -3.55e-06 | DW = 2.10e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    122.639 | E =     -75.5756287300 | DE = -3.62e-06 | DW = 4.60e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    135.059 | E =     -75.5756317539 | DE = -3.02e-06 | DW = 2.08e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    146.160 | E =     -75.5756351401 | DE = -3.39e-06 | DW = 4.60e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    157.655 | E =     -75.5756364392 | DE = -1.30e-06 | DW = 1.95e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    185.327 | E =     -75.5757033089 | DE = -6.69e-05 | DW = 2.40e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    214.529 | E =     -75.5757067884 | DE = -3.48e-06 | DW = 1.15e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    242.833 | E =     -75.5757077232 | DE = -9.35e-07 | DW = 2.74e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    270.220 | E =     -75.5757077026 | DE = 2.06e-08 | DW = 1.02e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    299.544 | E =     -75.5757083309 | DE = -6.28e-07 | DW = 2.73e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    327.528 | E =     -75.5757082802 | DE = 5.07e-08 | DW = 1.02e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    353.331 | E =     -75.5757083801 | DE = -9.99e-08 | DW = 2.21e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    382.042 | E =     -75.5757088376 | DE = -4.58e-07 | DW = 1.12e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    595.810 | E =     -75.5757166721 | DE = -7.83e-06 | DW = 5.69e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    742.447 | E =     -75.5757166722 | DE = -1.15e-10 | DW = 5.69e-08

E(MRCI) = -75.57571667224084  E_corr = -0.1211195127412594
Time cost =    836.285
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:07:44 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.090249983134 AA    0.000000000000   0.000000000000   3.950000000000 Bohr   0.0

nuclear repulsion = 9.11392405063291
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    1.975]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    436306.49


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp30c5func
max_memory 4000 MB (current use 5119 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6663316753772

WARN: Singularity detected in overlap matrix (condition number = 58.7). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0915415140147796  LUMO (B3u) = -0.0915415140147796

WARN: B2u HOMO -0.0915415140147796 > system LUMO -0.0915415140147796

cycle= 1 E= -75.2265361682301  delta_E= -0.56  |g|= 0.228  |ddm|= 1.46
HOMO (B2u) = -0.342768719019987  LUMO (B3u) = -0.0429835717594423
cycle= 2 E= -75.2476350005993  delta_E= -0.0211  |g|= 0.0444  |ddm|= 0.347
HOMO (B2u) = -0.311266865337972  LUMO (B3u) = -0.00695392831510911
cycle= 3 E= -75.2488230162567  delta_E= -0.00119  |g|= 0.0166  |ddm|= 0.0577
HOMO (B2u) = -0.315511002797545  LUMO (B3u) = -0.010990840618904
cycle= 4 E= -75.24902239302  delta_E= -0.000199  |g|= 0.000637  |ddm|= 0.0332
HOMO (B2u) = -0.315616573066829  LUMO (B3u) = -0.0112327274277411
cycle= 5 E= -75.2490225504908  delta_E= -1.57e-07  |g|= 0.000134  |ddm|= 0.000817
HOMO (B2u) = -0.315582567140402  LUMO (B3u) = -0.0112081163367538
cycle= 6 E= -75.2490225608019  delta_E= -1.03e-08  |g|= 1.98e-05  |ddm|= 0.000228
HOMO (B2u) = -0.315579772310337  LUMO (B3u) = -0.0112081376157125
cycle= 7 E= -75.249022561055  delta_E= -2.53e-10  |g|= 2e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.315579365287539  LUMO (B3u) = -0.0112081994129459
cycle= 8 E= -75.2490225610576  delta_E= -2.56e-12  |g|= 1.29e-07  |ddm|= 4.21e-06
HOMO (B2u) = -0.315579376014584  LUMO (B3u) = -0.0112082026370646
cycle= 9 E= -75.2490225610575  delta_E= 5.68e-14  |g|= 7.39e-09  |ddm|= 3.13e-07
HOMO (B2u) = -0.315579375159299  LUMO (B3u) = -0.0112082041996799
cycle= 10 E= -75.2490225610576  delta_E= -1.14e-13  |g|= 6.68e-09  |ddm|= 6.7e-09
HOMO (B2u) = -0.315579375372017  LUMO (B3u) = -0.0112082045104394
cycle= 11 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 4.7e-09  |ddm|= 5.38e-09
HOMO (B2u) = -0.315579374456029  LUMO (B3u) = -0.0112082035522789
cycle= 12 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 3.98e-09  |ddm|= 2.88e-09
HOMO (B2u) = -0.315579374574187  LUMO (B3u) = -0.0112082036829932
cycle= 13 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 3.56e-09  |ddm|= 1.41e-09
HOMO (B2u) = -0.31557937420497  LUMO (B3u) = -0.0112082035344109
cycle= 14 E= -75.2490225610576  delta_E= 5.68e-14  |g|= 7.08e-10  |ddm|= 6.53e-09
HOMO (B2u) = -0.31557937430368  LUMO (B3u) = -0.0112082035701466
cycle= 15 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 7.46e-10  |ddm|= 1.14e-09
HOMO (B2u) = -0.315579374231822  LUMO (B3u) = -0.0112082035635359
cycle= 16 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 6.5e-10  |ddm|= 8.6e-10
HOMO (B2u) = -0.315579374257301  LUMO (B3u) = -0.0112082035349904
cycle= 17 E= -75.2490225610576  delta_E= -2.84e-14  |g|= 8.07e-10  |ddm|= 1.32e-09
HOMO (B2u) = -0.315579374230771  LUMO (B3u) = -0.0112082035236274
cycle= 18 E= -75.2490225610576  delta_E= 2.84e-14  |g|= 6.13e-10  |ddm|= 4.66e-10
HOMO (B2u) = -0.315579374230605  LUMO (B3u) = -0.0112082035356827
cycle= 19 E= -75.2490225610576  delta_E=    0  |g|= 4.68e-10  |ddm|= 4.87e-10
HOMO (B2u) = -0.31557937423453  LUMO (B3u) = -0.0112082035493864
cycle= 20 E= -75.2490225610576  delta_E= -5.68e-14  |g|= 3.68e-10  |ddm|= 3.31e-10
HOMO (B2u) = -0.315579374226199  LUMO (B3u) = -0.0112082035491772
cycle= 21 E= -75.2490225610575  delta_E= 8.53e-14  |g|= 2.65e-10  |ddm|= 2.65e-10
HOMO (B2u) = -0.315579374219015  LUMO (B3u) = -0.0112082035501454
cycle= 22 E= -75.2490225610575  delta_E=    0  |g|= 1.67e-10  |ddm|= 2.4e-10
HOMO (B2u) = -0.315579374217204  LUMO (B3u) = -0.011208203548262
cycle= 23 E= -75.2490225610575  delta_E= 5.68e-14  |g|= 1.48e-10  |ddm|= 4.95e-11
HOMO (B2u) = -0.315579374212321  LUMO (B3u) = -0.0112082035460582
cycle= 24 E= -75.2490225610574  delta_E= 8.53e-14  |g|= 1.25e-10  |ddm|= 5.57e-11
HOMO (B2u) = -0.315579374210464  LUMO (B3u) = -0.0112082035442361
cycle= 25 E= -75.2490225610572  delta_E= 1.42e-13  |g|= 1.06e-10  |ddm|= 4.69e-11
HOMO (B2u) = -0.315579374207603  LUMO (B3u) = -0.0112082035434344
cycle= 26 E= -75.2490225610572  delta_E= 2.84e-14  |g|= 8.35e-11  |ddm|= 6.15e-11
HOMO (B2u) = -0.315579374205477  LUMO (B3u) = -0.0112082035428356
cycle= 27 E= -75.2490225610571  delta_E= 1.42e-13  |g|= 6.81e-11  |ddm|= 4.75e-11
HOMO (B2u) = -0.315579374203675  LUMO (B3u) = -0.0112082035421961
cycle= 28 E= -75.2490225610569  delta_E= 1.42e-13  |g|= 5.49e-11  |ddm|= 3.53e-11
HOMO (B2u) = -0.315579374202262  LUMO (B3u) = -0.0112082035416665
cycle= 29 E= -75.2490225610567  delta_E= 2.27e-13  |g|= 4.35e-11  |ddm|= 2.77e-11
HOMO (B2u) = -0.315579374201176  LUMO (B3u) = -0.0112082035412007
cycle= 30 E= -75.2490225610564  delta_E= 2.56e-13  |g|= 3.47e-11  |ddm|= 2.02e-11
HOMO (B2u) = -0.315579374200465  LUMO (B3u) = -0.0112082035408417
cycle= 31 E= -75.2490225610561  delta_E= 3.13e-13  |g|= 2.93e-11  |ddm|= 1.28e-11
HOMO (B2u) = -0.315579374199762  LUMO (B3u) = -0.0112082035405087
cycle= 32 E= -75.2490225610558  delta_E= 3.13e-13  |g|= 2.48e-11  |ddm|= 1.13e-11
HOMO (B2u) = -0.3155793741992  LUMO (B3u) = -0.0112082035402182
cycle= 33 E= -75.2490225610554  delta_E= 4.26e-13  |g|= 2.1e-11  |ddm|= 9.53e-12
HOMO (B2u) = -0.315579374198661  LUMO (B3u) = -0.0112082035399596
cycle= 34 E= -75.249022561055  delta_E= 4.26e-13  |g|= 1.81e-11  |ddm|= 8.08e-12
HOMO (B2u) = -0.315579374198198  LUMO (B3u) = -0.0112082035397083
cycle= 35 E= -75.2490225610546  delta_E= 3.98e-13  |g|= 1.55e-11  |ddm|= 6.44e-12
HOMO (B2u) = -0.315579374197779  LUMO (B3u) = -0.0112082035394487
cycle= 36 E= -75.2490225610541  delta_E= 5.12e-13  |g|= 1.32e-11  |ddm|= 5.51e-12
HOMO (B2u) = -0.315579374197391  LUMO (B3u) = -0.0112082035391772
cycle= 37 E= -75.2490225610533  delta_E= 7.67e-13  |g|= 1.14e-11  |ddm|= 4.7e-12
HOMO (B2u) = -0.315579374197029  LUMO (B3u) = -0.0112082035388991
cycle= 38 E= -75.2490225610527  delta_E= 6.25e-13  |g|= 1e-11  |ddm|= 4.02e-12
HOMO (B2u) = -0.315579374196689  LUMO (B3u) = -0.0112082035386193
cycle= 39 E= -75.2490225610522  delta_E= 4.83e-13  |g|= 8.95e-12  |ddm|= 3.42e-12
HOMO (B2u) = -0.315579374196364  LUMO (B3u) = -0.0112082035383406
cycle= 40 E= -75.2490225610517  delta_E= 4.55e-13  |g|= 7.77e-12  |ddm|= 2.84e-12
HOMO (B2u) = -0.315579374196055  LUMO (B3u) = -0.0112082035380647
cycle= 41 E= -75.2490225610512  delta_E= 4.83e-13  |g|= 6.76e-12  |ddm|= 2.4e-12
HOMO (B2u) = -0.315579374195764  LUMO (B3u) = -0.0112082035377971
cycle= 42 E= -75.2490225610507  delta_E= 5.12e-13  |g|= 6.16e-12  |ddm|= 2.16e-12
HOMO (B2u) = -0.315579374195479  LUMO (B3u) = -0.0112082035375266
cycle= 43 E= -75.2490225610503  delta_E= 3.98e-13  |g|= 5.67e-12  |ddm|= 2e-12
HOMO (B2u) = -0.3155793741952  LUMO (B3u) = -0.0112082035372557
cycle= 44 E= -75.2490225610499  delta_E= 4.26e-13  |g|= 5.35e-12  |ddm|= 1.93e-12
HOMO (B2u) = -0.315579374194934  LUMO (B3u) = -0.0112082035369956
cycle= 45 E= -75.2490225610495  delta_E= 3.69e-13  |g|= 4.99e-12  |ddm|= 1.94e-12
HOMO (B2u) = -0.315579374194683  LUMO (B3u) = -0.0112082035367491
cycle= 46 E= -75.2490225610493  delta_E= 2.84e-13  |g|= 4.55e-12  |ddm|= 2e-12
HOMO (B2u) = -0.315579374194447  LUMO (B3u) = -0.0112082035365171
cycle= 47 E= -75.2490225610491  delta_E= 1.99e-13  |g|= 4.01e-12  |ddm|= 2.07e-12
HOMO (B2u) = -0.315579374194223  LUMO (B3u) = -0.0112082035362982
cycle= 48 E= -75.2490225610488  delta_E= 2.27e-13  |g|= 3.5e-12  |ddm|= 2.1e-12
HOMO (B2u) = -0.315579374194015  LUMO (B3u) = -0.0112082035360938
cycle= 49 E= -75.2490225610486  delta_E= 1.99e-13  |g|= 3.28e-12  |ddm|= 1.9e-12
HOMO (B2u) = -0.315579374193823  LUMO (B3u) = -0.0112082035359061
cycle= 50 E= -75.2490225610483  delta_E= 2.84e-13  |g|= 3.14e-12  |ddm|= 1.67e-12
SCF not converged.
SCF energy = -75.2490225610483

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp30c5func
max_memory 4000 MB (current use 5119 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.411079088155  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4295148015792  dE = -0.018435713  S^2 = 0.0000000
               |grad[o]|= 0.11  |ddm|= 3.74  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4419615955667  dE = -0.012446794  S^2 = 0.0000000
               |grad[o]|=0.0796  |ddm|=0.126  |maxRot[o]|=0.0797
macro iter 3 (6 JK  0 micro), CASSCF E = -75.448309208189  dE = -0.0063476126  S^2 = 0.0000000
               |grad[o]|=0.0462  |ddm|=0.0237  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.450151313191  dE = -0.001842105  S^2 = 0.0000000
               |grad[o]|=0.0163  |ddm|=0.103  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4507915066912  dE = -0.0006401935  S^2 = 0.0000000
               |grad[o]|=0.00864  |ddm|=0.018  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4509315553988  dE = -0.00014004871  S^2 = 0.0000000
               |grad[o]|=0.00425  |ddm|=0.00738  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4509688489376  dE = -3.7293539e-05  S^2 = 0.0000000
               |grad[o]|=0.00223  |ddm|=0.00337  |maxRot[o]|=0.0132
macro iter 8 (3 JK  0 micro), CASSCF E = -75.450972149416  dE = -3.3004785e-06  S^2 = 0.0000000
               |grad[o]|=0.000816  |ddm|=0.00227  |maxRot[o]|=0.00397
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4509724425349  dE = -2.9311892e-07  S^2 = 0.0000000
               |grad[o]|=0.000262  |ddm|=0.000737  |maxRot[o]|=0.00117
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4509724683906  dE = -2.5855684e-08  S^2 = 0.0000000
               |grad[o]|=7.99e-05  |ddm|=0.00023  |maxRot[o]|=0.000344
macro iter 11 (3 JK  0 micro), CASSCF E = -75.4509724706905  dE = -2.2998847e-09  S^2 = 0.0000000
               |grad[o]|=2.43e-05  |ddm|=6.91e-05  |maxRot[o]|=0.000102
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4509724708879  dE = -1.9738877e-10  S^2 = 0.0000000
               |grad[o]|=7.21e-06  |ddm|=2.12e-05  |maxRot[o]|=3.02e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4509724709117  dE = -2.3788971e-11  S^2 = 0.0000000
               |grad[o]|=2.23e-06  |ddm|=6.19e-06  |maxRot[o]|=8.84e-06
2-step CASSCF converged in 13 macro (49 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95553918 1.93688267 1.83858345 1.6391569  0.06206759 0.36520862
 0.0550149  0.14754669]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01239   0.01081  -0.00143   0.00000   0.00000
  0 C 2s       0.69827   0.68127  -0.10961  -0.00000   0.00000
  0 C 3s       0.00470   0.01443  -0.02431  -0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000   0.00000   0.69401
  0 C 2py     -0.00000  -0.00000  -0.00000   0.70457   0.00000
  0 C 2pz      0.10978  -0.18822   0.69702  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  0 C 3py     -0.00000   0.00000   0.00000   0.05523   0.00000
  0 C 3pz     -0.00833  -0.00170   0.02237  -0.00000   0.00000
  0 C 3dxy    -0.00000  -0.00000  -0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000  -0.00000   0.02312   0.00000
  0 C 3dz^2    0.01091  -0.00949   0.03179  -0.00000   0.00000
  0 C 3dxz     0.00000   0.00000  -0.00000  -0.00000  -0.11663
 0 C 3dx2-y2   0.00204   0.00576  -0.00656   0.00000  -0.00000
  1 C 1s       0.01239  -0.01081  -0.00143   0.00000   0.00000
  1 C 2s       0.69827  -0.68127  -0.10961   0.00000  -0.00000
  1 C 3s       0.00470  -0.01443  -0.02431   0.00000  -0.00000
  1 C 2px     -0.00000   0.00000   0.00000   0.00000   0.69401
  1 C 2py      0.00000  -0.00000   0.00000   0.70457  -0.00000
  1 C 2pz     -0.10978  -0.18822  -0.69702   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000  -0.00000  -0.06893
  1 C 3py      0.00000   0.00000   0.00000   0.05523   0.00000
  1 C 3pz      0.00833  -0.00170  -0.02237  -0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000  -0.02312  -0.00000
  1 C 3dz^2    0.01091   0.00949   0.03179   0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000   0.00000   0.11663
 1 C 3dx2-y2   0.00204  -0.00576  -0.00656   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00019
  0 C 2s      -0.00000   0.00000   0.18769
  0 C 3s       0.00000  -0.00000   0.02542
  0 C 2px      0.00000   0.69895  -0.00000
  0 C 2py      0.70705   0.00000  -0.00000
  0 C 2pz     -0.00000  -0.00000   0.68096
  0 C 3px      0.00000  -0.02298  -0.00000
  0 C 3py      0.00461   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.01682
  0 C 3dxy    -0.00000   0.00000  -0.00000
  0 C 3dyz     0.00772   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00210
  0 C 3dxz     0.00000  -0.10461  -0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01180
  1 C 1s       0.00000   0.00000   0.00019
  1 C 2s      -0.00000  -0.00000  -0.18769
  1 C 3s       0.00000   0.00000  -0.02542
  1 C 2px     -0.00000  -0.69895   0.00000
  1 C 2py     -0.70705  -0.00000  -0.00000
  1 C 2pz      0.00000  -0.00000   0.68096
  1 C 3px     -0.00000   0.02298   0.00000
  1 C 3py     -0.00461  -0.00000   0.00000
  1 C 3pz     -0.00000  -0.00000  -0.01682
  1 C 3dxy     0.00000  -0.00000   0.00000
  1 C 3dyz     0.00772  -0.00000  -0.00000
  1 C 3dz^2    0.00000   0.00000  -0.00210
  1 C 3dxz     0.00000  -0.10461  -0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01180
<CAS-nat-orb|mo-hf>  3  3    0.99630521
<CAS-nat-orb|mo-hf>  4  4    0.99959512
<CAS-nat-orb|mo-hf>  5  5    0.99624281
<CAS-nat-orb|mo-hf>  6  6    0.99840712
<CAS-nat-orb|mo-hf>  7  7    0.93287016
<CAS-nat-orb|mo-hf>  8  8    0.98760133
<CAS-nat-orb|mo-hf>  9  9    0.96104579
<CAS-nat-orb|mo-hf>  10  10    0.96307389
CASSCF energy = -75.4509724709117
CASCI E = -75.4509724709117  E(CI) = -14.7857466796762  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.004
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.010

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.059
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.015
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.015
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.018
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.114
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.11
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.29
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.501 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.304 | Tfpread = 0.000 | Tfpwrite = 0.301 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.639 | E =     -75.5439710192 | DW = 1.72e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.793 | E =     -75.5690855219 | DE = -2.51e-02 | DW = 6.77e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.548 | E =     -75.5695771231 | DE = -4.92e-04 | DW = 1.65e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.334 | E =     -75.5700861389 | DE = -5.09e-04 | DW = 7.96e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.445 | E =     -75.5701090147 | DE = -2.29e-05 | DW = 1.62e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      8.349 | E =     -75.5701358872 | DE = -2.69e-05 | DW = 7.84e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.279 | E =     -75.5701515088 | DE = -1.56e-05 | DW = 1.63e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.010 | E =     -75.5701708697 | DE = -1.94e-05 | DW = 8.15e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.497 | E =     -75.5712295556 | DE = -1.06e-03 | DW = 1.56e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     22.186 | E =     -75.5716728716 | DE = -4.43e-04 | DW = 2.61e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.943 | E =     -75.5718193660 | DE = -1.46e-04 | DW = 4.47e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.830 | E =     -75.5718721364 | DE = -5.28e-05 | DW = 3.30e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.524 | E =     -75.5718833009 | DE = -1.12e-05 | DW = 4.61e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     36.336 | E =     -75.5718928363 | DE = -9.54e-06 | DW = 3.35e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.478 | E =     -75.5719025832 | DE = -9.75e-06 | DW = 4.71e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     42.391 | E =     -75.5719079259 | DE = -5.34e-06 | DW = 3.39e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     49.347 | E =     -75.5720697972 | DE = -1.62e-04 | DW = 2.71e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     62.453 | E =     -75.5721115368 | DE = -4.17e-05 | DW = 1.98e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     74.807 | E =     -75.5721232562 | DE = -1.17e-05 | DW = 4.52e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     87.720 | E =     -75.5721265074 | DE = -3.25e-06 | DW = 2.10e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     99.269 | E =     -75.5721293383 | DE = -2.83e-06 | DW = 4.51e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    109.175 | E =     -75.5721321090 | DE = -2.77e-06 | DW = 2.09e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    117.956 | E =     -75.5721353754 | DE = -3.27e-06 | DW = 4.59e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    131.141 | E =     -75.5721376710 | DE = -2.30e-06 | DW = 2.09e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    162.450 | E =     -75.5722001213 | DE = -6.25e-05 | DW = 2.39e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    189.490 | E =     -75.5722037272 | DE = -3.61e-06 | DW = 1.18e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    219.750 | E =     -75.5722046380 | DE = -9.11e-07 | DW = 2.75e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    244.320 | E =     -75.5722046129 | DE = 2.52e-08 | DW = 1.03e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    273.424 | E =     -75.5722052262 | DE = -6.13e-07 | DW = 2.73e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    299.406 | E =     -75.5722051722 | DE = 5.39e-08 | DW = 1.03e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    326.705 | E =     -75.5722057143 | DE = -5.42e-07 | DW = 2.72e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    352.550 | E =     -75.5722056460 | DE = 6.84e-08 | DW = 1.02e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    569.188 | E =     -75.5722136565 | DE = -8.01e-06 | DW = 5.74e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    712.620 | E =     -75.5722136567 | DE = -1.56e-10 | DW = 5.74e-08

E(MRCI) = -75.57221365666933  E_corr = -0.1212411857576541
Time cost =    792.491
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:20:57 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.116708843680 AA    0.000000000000   0.000000000000   4.000000000000 Bohr   0.0

nuclear repulsion = 9
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0. 0. 2.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    449882.29


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpttfg_pjx
max_memory 4000 MB (current use 5139 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.65829474285

WARN: Singularity detected in overlap matrix (condition number = 55.3). SCF may be inaccurate and hard to converge.

HOMO (B3u) = -0.0893486438705823  LUMO (B3u) = -0.0893486438705823

WARN: B2u HOMO -0.0893486438705823 > system LUMO -0.0893486438705823

cycle= 1 E= -75.2192687068769  delta_E= -0.561  |g|= 0.226  |ddm|= 1.45
HOMO (B2u) = -0.339798299416296  LUMO (B3u) = -0.041265862456372
cycle= 2 E= -75.240154283596  delta_E= -0.0209  |g|= 0.0439  |ddm|= 0.347
HOMO (B2u) = -0.308660706394017  LUMO (B3u) = -0.00561531074292567
cycle= 3 E= -75.2413180659383  delta_E= -0.00116  |g|= 0.0164  |ddm|= 0.0569
HOMO (B2u) = -0.312871203858109  LUMO (B3u) = -0.00961084060264919
cycle= 4 E= -75.2415141140048  delta_E= -0.000196  |g|= 0.000633  |ddm|= 0.0328
HOMO (B2u) = -0.312958040513247  LUMO (B3u) = -0.00983140550670129
cycle= 5 E= -75.2415142702404  delta_E= -1.56e-07  |g|= 0.000135  |ddm|= 0.00081
HOMO (B2u) = -0.312924808517806  LUMO (B3u) = -0.00980779398986145
cycle= 6 E= -75.2415142806734  delta_E= -1.04e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.312922000715272  LUMO (B3u) = -0.00980776379454734
cycle= 7 E= -75.2415142809298  delta_E= -2.56e-10  |g|= 2.02e-06  |ddm|= 4.04e-05
HOMO (B2u) = -0.312921604622324  LUMO (B3u) = -0.00980784357418808
cycle= 8 E= -75.2415142809325  delta_E= -2.64e-12  |g|= 1.28e-07  |ddm|= 4.27e-06
HOMO (B2u) = -0.312921617364979  LUMO (B3u) = -0.0098078481710803
cycle= 9 E= -75.2415142809324  delta_E= 5.68e-14  |g|= 6.97e-09  |ddm|= 3.09e-07
HOMO (B2u) = -0.312921616459927  LUMO (B3u) = -0.00980784977548457
cycle= 10 E= -75.2415142809325  delta_E= -9.95e-14  |g|= 6.47e-09  |ddm|= 6.76e-09
HOMO (B2u) = -0.312921616767833  LUMO (B3u) = -0.00980785018189258
cycle= 11 E= -75.2415142809325  delta_E= 2.84e-14  |g|= 4.52e-09  |ddm|= 5.1e-09
HOMO (B2u) = -0.312921615945114  LUMO (B3u) = -0.00980784931540634
cycle= 12 E= -75.2415142809324  delta_E= 4.26e-14  |g|= 3.83e-09  |ddm|= 2.76e-09
HOMO (B2u) = -0.312921616048482  LUMO (B3u) = -0.00980784942792094
cycle= 13 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 3.44e-09  |ddm|= 1.28e-09
HOMO (B2u) = -0.312921615711669  LUMO (B3u) = -0.00980784930675397
cycle= 14 E= -75.2415142809325  delta_E=    0  |g|= 6.02e-10  |ddm|= 6.18e-09
HOMO (B2u) = -0.312921615819668  LUMO (B3u) = -0.00980784934693056
cycle= 15 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 6.91e-10  |ddm|= 1.19e-09
HOMO (B2u) = -0.312921615744761  LUMO (B3u) = -0.00980784933898525
cycle= 16 E= -75.2415142809324  delta_E=    0  |g|= 5.81e-10  |ddm|= 9.25e-10
HOMO (B2u) = -0.312921615768062  LUMO (B3u) = -0.00980784930678692
cycle= 17 E= -75.2415142809325  delta_E= -2.84e-14  |g|= 7.3e-10  |ddm|= 1.37e-09
HOMO (B2u) = -0.312921615745458  LUMO (B3u) = -0.00980784929807701
cycle= 18 E= -75.2415142809325  delta_E= 1.42e-14  |g|= 5.55e-10  |ddm|= 3.83e-10
HOMO (B2u) = -0.312921615748108  LUMO (B3u) = -0.00980784931184778
cycle= 19 E= -75.2415142809325  delta_E= -7.11e-14  |g|= 4.22e-10  |ddm|= 4.38e-10
HOMO (B2u) = -0.312921615754576  LUMO (B3u) = -0.00980784932722052
cycle= 20 E= -75.2415142809325  delta_E= 4.26e-14  |g|= 3.33e-10  |ddm|= 2.91e-10
HOMO (B2u) = -0.312921615749071  LUMO (B3u) = -0.00980784932930565
cycle= 21 E= -75.2415142809325  delta_E= -1.42e-14  |g|= 2.38e-10  |ddm|= 2.3e-10
HOMO (B2u) = -0.31292161574419  LUMO (B3u) = -0.00980784933207293
cycle= 22 E= -75.2415142809324  delta_E= 5.68e-14  |g|= 1.48e-10  |ddm|= 2.1e-10
HOMO (B2u) = -0.312921615742996  LUMO (B3u) = -0.00980784933046021
cycle= 23 E= -75.2415142809324  delta_E= 2.84e-14  |g|= 1.31e-10  |ddm|= 3.97e-11
HOMO (B2u) = -0.312921615738458  LUMO (B3u) = -0.00980784932845032
cycle= 24 E= -75.2415142809323  delta_E= 1.14e-13  |g|= 1.11e-10  |ddm|= 5.14e-11
HOMO (B2u) = -0.312921615737114  LUMO (B3u) = -0.00980784932689817
cycle= 25 E= -75.2415142809323  delta_E=    0  |g|= 9.41e-11  |ddm|= 4.14e-11
HOMO (B2u) = -0.312921615730103  LUMO (B3u) = -0.0098078493251258
Extra cycle  E= -75.2415142809322  delta_E= 8.53e-14  |g|= 3.08e-11  |ddm|= 1.48e-10
converged SCF energy = -75.2415142809322

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpttfg_pjx
max_memory 4000 MB (current use 5139 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4079772031603  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4269817802736  dE = -0.019004577  S^2 = 0.0000000
               |grad[o]|=0.112  |ddm|= 3.73  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4392390609018  dE = -0.012257281  S^2 = 0.0000000
               |grad[o]|=0.0795  |ddm|=0.131  |maxRot[o]|=0.079
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4452011083886  dE = -0.0059620475  S^2 = 0.0000000
               |grad[o]|=0.0446  |ddm|=0.0299  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4468486060941  dE = -0.0016474977  S^2 = 0.0000000
               |grad[o]|=0.0145  |ddm|=0.0972  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.44739130476  dE = -0.00054269867  S^2 = 0.0000000
               |grad[o]|=0.00768  |ddm|=0.0155  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.447493175425  dE = -0.00010187067  S^2 = 0.0000000
               |grad[o]|=0.00359  |ddm|=0.00705  |maxRot[o]|= 0.02
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4475072918856  dE = -1.4116461e-05  S^2 = 0.0000000
               |grad[o]|=0.00155  |ddm|=0.0034  |maxRot[o]|=0.00814
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4475086026484  dE = -1.3107628e-06  S^2 = 0.0000000
               |grad[o]|=0.000542  |ddm|=0.00148  |maxRot[o]|=0.00246
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4475087235355  dE = -1.2088705e-07  S^2 = 0.0000000
               |grad[o]|=0.000173  |ddm|=0.000483  |maxRot[o]|=0.000736
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4475087346378  dE = -1.1102287e-08  S^2 = 0.0000000
               |grad[o]|=5.34e-05  |ddm|=0.000152  |maxRot[o]|=0.000222
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4475087356532  dE = -1.015465e-09  S^2 = 0.0000000
               |grad[o]|=1.65e-05  |ddm|=4.64e-05  |maxRot[o]|=6.64e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.44750873574  dE = -8.6799901e-11  S^2 = 0.0000000
               |grad[o]|=5.06e-06  |ddm|=1.42e-05  |maxRot[o]|=1.98e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95539888 1.93749713 1.82923655 1.61997885 0.06124689 0.38415951
 0.05468072 0.15780146]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01243   0.01086  -0.00123   0.00000   0.00000
  0 C 2s       0.69987   0.68306  -0.09890  -0.00000   0.00000
  0 C 3s       0.00559   0.01429  -0.02264   0.00000   0.00000
  0 C 2px     -0.00000  -0.00000   0.00000   0.00000   0.69417
  0 C 2py      0.00000  -0.00000  -0.00000   0.70461   0.00000
  0 C 2pz      0.09912  -0.18163   0.69866   0.00000   0.00000
  0 C 3px     -0.00000   0.00000   0.00000   0.00000  -0.06942
  0 C 3py      0.00000  -0.00000  -0.00000   0.05510   0.00000
  0 C 3pz     -0.00787  -0.00173   0.02398   0.00000   0.00000
  0 C 3dxy     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00000  -0.00000  -0.00000   0.02202   0.00000
  0 C 3dz^2    0.00990  -0.00917   0.03103   0.00000   0.00000
  0 C 3dxz    -0.00000   0.00000   0.00000   0.00000  -0.11537
 0 C 3dx2-y2   0.00220   0.00568  -0.00646   0.00000   0.00000
  1 C 1s       0.01243  -0.01086  -0.00123   0.00000   0.00000
  1 C 2s       0.69987  -0.68306  -0.09890  -0.00000   0.00000
  1 C 3s       0.00559  -0.01429  -0.02264  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000  -0.00000  -0.00000   0.69417
  1 C 2py     -0.00000   0.00000   0.00000   0.70461  -0.00000
  1 C 2pz     -0.09912  -0.18163  -0.69866   0.00000   0.00000
  1 C 3px      0.00000   0.00000  -0.00000  -0.00000  -0.06942
  1 C 3py     -0.00000   0.00000   0.00000   0.05510  -0.00000
  1 C 3pz      0.00787  -0.00173  -0.02398   0.00000   0.00000
  1 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz     0.00000  -0.00000  -0.00000  -0.02202  -0.00000
  1 C 3dz^2    0.00990   0.00917   0.03103  -0.00000  -0.00000
  1 C 3dxz    -0.00000  -0.00000   0.00000   0.00000   0.11537
 1 C 3dx2-y2   0.00220  -0.00568  -0.00646  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00018
  0 C 2s      -0.00000  -0.00000   0.18114
  0 C 3s      -0.00000   0.00000   0.02444
  0 C 2px      0.00000   0.69909   0.00000
  0 C 2py      0.70704   0.00000   0.00000
  0 C 2pz     -0.00000   0.00000   0.68284
  0 C 3px     -0.00000  -0.02448   0.00000
  0 C 3py      0.00635  -0.00000  -0.00000
  0 C 3pz     -0.00000   0.00000  -0.01417
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz     0.00736   0.00000  -0.00000
  0 C 3dz^2   -0.00000   0.00000   0.00169
  0 C 3dxz    -0.00000  -0.10334   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01092
  1 C 1s       0.00000   0.00000   0.00018
  1 C 2s       0.00000  -0.00000  -0.18114
  1 C 3s       0.00000  -0.00000  -0.02444
  1 C 2px      0.00000  -0.69909  -0.00000
  1 C 2py     -0.70704   0.00000   0.00000
  1 C 2pz      0.00000   0.00000   0.68284
  1 C 3px     -0.00000   0.02448  -0.00000
  1 C 3py     -0.00635  -0.00000  -0.00000
  1 C 3pz     -0.00000   0.00000  -0.01417
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00736   0.00000  -0.00000
  1 C 3dz^2    0.00000  -0.00000  -0.00169
  1 C 3dxz     0.00000  -0.10334   0.00000
 1 C 3dx2-y2   0.00000   0.00000   0.01092
<CAS-nat-orb|mo-hf>  3  3    0.99576779
<CAS-nat-orb|mo-hf>  4  4    0.99957524
<CAS-nat-orb|mo-hf>  5  5    0.99568631
<CAS-nat-orb|mo-hf>  6  6    0.99833014
<CAS-nat-orb|mo-hf>  7  7    0.93288522
<CAS-nat-orb|mo-hf>  8  8    0.98831105
<CAS-nat-orb|mo-hf>  9  9    0.96112499
<CAS-nat-orb|mo-hf>  10  10    0.96605594
CASSCF energy = -75.44750873574
CASCI E = -75.44750873574  E(CI) = -14.7317047760603  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.031
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.339
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.095
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.660

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.031
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.631
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.040
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.010
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.012
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      1.762
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.239 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.154 | Tfpread = 0.000 | Tfpwrite = 0.152 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.195 | E =     -75.5403633606 | DW = 1.72e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.214 | E =     -75.5657498808 | DE = -2.54e-02 | DW = 6.72e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.962 | E =     -75.5662425863 | DE = -4.93e-04 | DW = 1.59e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.661 | E =     -75.5667320417 | DE = -4.89e-04 | DW = 7.97e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.338 | E =     -75.5667531911 | DE = -2.11e-05 | DW = 1.59e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.090 | E =     -75.5667863254 | DE = -3.31e-05 | DW = 7.85e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.761 | E =     -75.5668013629 | DE = -1.50e-05 | DW = 1.61e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.519 | E =     -75.5668084733 | DE = -7.11e-06 | DW = 7.95e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.371 | E =     -75.5678737432 | DE = -1.07e-03 | DW = 1.55e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     15.724 | E =     -75.5683124503 | DE = -4.39e-04 | DW = 2.61e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.661 | E =     -75.5684577192 | DE = -1.45e-04 | DW = 4.46e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     25.381 | E =     -75.5685112227 | DE = -5.35e-05 | DW = 3.30e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     30.089 | E =     -75.5685234942 | DE = -1.23e-05 | DW = 4.62e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.418 | E =     -75.5685334887 | DE = -9.99e-06 | DW = 3.37e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.064 | E =     -75.5685426076 | DE = -9.12e-06 | DW = 4.70e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     42.712 | E =     -75.5685478301 | DE = -5.22e-06 | DW = 3.41e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     52.104 | E =     -75.5687089804 | DE = -1.61e-04 | DW = 2.70e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     65.137 | E =     -75.5687518755 | DE = -4.29e-05 | DW = 1.97e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     76.791 | E =     -75.5687636290 | DE = -1.18e-05 | DW = 4.50e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.843 | E =     -75.5687669555 | DE = -3.33e-06 | DW = 2.08e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    100.320 | E =     -75.5687710699 | DE = -4.11e-06 | DW = 4.50e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    112.154 | E =     -75.5687738965 | DE = -2.83e-06 | DW = 2.09e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    123.442 | E =     -75.5687762435 | DE = -2.35e-06 | DW = 4.47e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    135.504 | E =     -75.5687789796 | DE = -2.74e-06 | DW = 2.08e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    163.882 | E =     -75.5688451702 | DE = -6.62e-05 | DW = 2.38e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    193.146 | E =     -75.5688487868 | DE = -3.62e-06 | DW = 1.18e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    221.083 | E =     -75.5688497775 | DE = -9.91e-07 | DW = 2.75e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    248.146 | E =     -75.5688497540 | DE = 2.35e-08 | DW = 1.03e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    277.718 | E =     -75.5688504065 | DE = -6.53e-07 | DW = 2.74e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    304.279 | E =     -75.5688503592 | DE = 4.74e-08 | DW = 1.03e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    333.322 | E =     -75.5688509455 | DE = -5.86e-07 | DW = 2.73e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    360.597 | E =     -75.5688508829 | DE = 6.26e-08 | DW = 1.03e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    588.046 | E =     -75.5688599937 | DE = -9.11e-06 | DW = 5.80e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    741.113 | E =     -75.5688599938 | DE = -1.08e-10 | DW = 5.79e-08

E(MRCI) = -75.56885999377828  E_corr = -0.1213512580382314
Time cost =    922.114
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:36:19 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.143167704226 AA    0.000000000000   0.000000000000   4.050000000000 Bohr   0.0

nuclear repulsion = 8.88888888888889
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.025]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    463786.02


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp4jkf4uhk
max_memory 4000 MB (current use 5119 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.650821541947

WARN: Singularity detected in overlap matrix (condition number = 52.1). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0872509906487009  LUMO (B3u) = -0.0872509906487007

WARN: B2u HOMO -0.0872509906487009 > system LUMO -0.0872509906487007

cycle= 1 E= -75.2120928138537  delta_E= -0.561  |g|= 0.225  |ddm|= 1.45
HOMO (B2u) = -0.336938998033693  LUMO (B3u) = -0.0396234294723655
cycle= 2 E= -75.2327826177341  delta_E= -0.0207  |g|= 0.0434  |ddm|= 0.347
HOMO (B2u) = -0.306147078592025  LUMO (B3u) = -0.00433141905845612
cycle= 3 E= -75.2339223949765  delta_E= -0.00114  |g|= 0.0162  |ddm|= 0.0561
HOMO (B2u) = -0.310321597199801  LUMO (B3u) = -0.00828279864970623
cycle= 4 E= -75.2341150976661  delta_E= -0.000193  |g|= 0.000629  |ddm|= 0.0325
HOMO (B2u) = -0.310388518956865  LUMO (B3u) = -0.00848075571953718
cycle= 5 E= -75.2341152524229  delta_E= -1.55e-07  |g|= 0.000135  |ddm|= 0.000802
HOMO (B2u) = -0.310356121170238  LUMO (B3u) = -0.00845811286980798
cycle= 6 E= -75.2341152629183  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000229
HOMO (B2u) = -0.310353302460647  LUMO (B3u) = -0.00845802697819558
cycle= 7 E= -75.2341152631768  delta_E= -2.58e-10  |g|= 2.04e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.310352915622104  LUMO (B3u) = -0.00845812345206009
cycle= 8 E= -75.2341152631795  delta_E= -2.7e-12  |g|= 1.28e-07  |ddm|= 4.34e-06
HOMO (B2u) = -0.310352930535094  LUMO (B3u) = -0.00845812953625347
cycle= 9 E= -75.2341152631794  delta_E= 7.11e-14  |g|= 6.66e-09  |ddm|= 3.04e-07
HOMO (B2u) = -0.310352929576746  LUMO (B3u) = -0.00845813118916161
cycle= 10 E= -75.2341152631794  delta_E=    0  |g|= 6.31e-09  |ddm|= 7.04e-09
HOMO (B2u) = -0.310352929991887  LUMO (B3u) = -0.0084581317008041
cycle= 11 E= -75.2341152631795  delta_E= -9.95e-14  |g|= 4.39e-09  |ddm|= 4.78e-09
HOMO (B2u) = -0.310352929258389  LUMO (B3u) = -0.00845813092327023
cycle= 12 E= -75.2341152631794  delta_E= 8.53e-14  |g|= 3.72e-09  |ddm|= 2.66e-09
HOMO (B2u) = -0.310352929350486  LUMO (B3u) = -0.00845813101898259
cycle= 13 E= -75.2341152631794  delta_E= -2.84e-14  |g|= 3.35e-09  |ddm|= 1.11e-09
HOMO (B2u) = -0.310352929050747  LUMO (B3u) = -0.00845813092930915
cycle= 14 E= -75.2341152631794  delta_E=    0  |g|= 5.26e-10  |ddm|= 5.83e-09
HOMO (B2u) = -0.310352929162668  LUMO (B3u) = -0.00845813096843038
cycle= 15 E= -75.2341152631795  delta_E= -5.68e-14  |g|= 6.38e-10  |ddm|= 1.08e-09
HOMO (B2u) = -0.310352929093806  LUMO (B3u) = -0.00845813095605681
cycle= 16 E= -75.2341152631794  delta_E= 9.95e-14  |g|= 5.3e-10  |ddm|= 9.18e-10
HOMO (B2u) = -0.310352929110809  LUMO (B3u) = -0.00845813092663165
cycle= 17 E= -75.2341152631795  delta_E= -9.95e-14  |g|= 6.74e-10  |ddm|= 1.16e-09
HOMO (B2u) = -0.310352929092283  LUMO (B3u) = -0.00845813092038636
cycle= 18 E= -75.2341152631794  delta_E= 1.14e-13  |g|= 5.14e-10  |ddm|= 3e-10
HOMO (B2u) = -0.310352929098004  LUMO (B3u) = -0.00845813093592169
cycle= 19 E= -75.2341152631795  delta_E= -8.53e-14  |g|= 3.9e-10  |ddm|= 3.84e-10
HOMO (B2u) = -0.310352929107252  LUMO (B3u) = -0.00845813095308993
cycle= 20 E= -75.2341152631794  delta_E= 2.84e-14  |g|= 3.09e-10  |ddm|= 2.49e-10
HOMO (B2u) = -0.310352929104757  LUMO (B3u) = -0.00845813095747195
cycle= 21 E= -75.2341152631793  delta_E= 1.14e-13  |g|= 2.2e-10  |ddm|= 1.93e-10
HOMO (B2u) = -0.31035292910236  LUMO (B3u) = -0.00845813096210893
cycle= 22 E= -75.2341152631794  delta_E= -5.68e-14  |g|= 1.33e-10  |ddm|= 1.79e-10
HOMO (B2u) = -0.31035292910178  LUMO (B3u) = -0.00845813096067
cycle= 23 E= -75.2341152631791  delta_E= 2.98e-13  |g|= 1.19e-10  |ddm|= 3.47e-11
HOMO (B2u) = -0.310352929097862  LUMO (B3u) = -0.00845813095899314
cycle= 24 E= -75.234115263179  delta_E= 9.95e-14  |g|= 1.01e-10  |ddm|= 4.74e-11
HOMO (B2u) = -0.310352929096946  LUMO (B3u) = -0.00845813095797771
cycle= 25 E= -75.2341152631788  delta_E= 2.27e-13  |g|= 8.5e-11  |ddm|= 3.5e-11
HOMO (B2u) = -0.310352929095509  LUMO (B3u) = -0.00845813095818302
cycle= 26 E= -75.2341152631787  delta_E= 5.68e-14  |g|= 6.77e-11  |ddm|= 3.88e-11
HOMO (B2u) = -0.310352929094485  LUMO (B3u) = -0.00845813095836032
cycle= 27 E= -75.2341152631786  delta_E= 8.53e-14  |g|= 5.66e-11  |ddm|= 3.04e-11
HOMO (B2u) = -0.310352929093488  LUMO (B3u) = -0.00845813095827486
cycle= 28 E= -75.2341152631784  delta_E= 1.85e-13  |g|= 4.63e-11  |ddm|= 2.25e-11
HOMO (B2u) = -0.310352929092656  LUMO (B3u) = -0.00845813095813761
cycle= 29 E= -75.2341152631782  delta_E= 2.42e-13  |g|= 3.68e-11  |ddm|= 1.88e-11
HOMO (B2u) = -0.310352929091993  LUMO (B3u) = -0.00845813095794948
cycle= 30 E= -75.2341152631779  delta_E= 2.42e-13  |g|= 2.96e-11  |ddm|= 1.4e-11
HOMO (B2u) = -0.310352929091551  LUMO (B3u) = -0.00845813095775513
cycle= 31 E= -75.2341152631774  delta_E= 5.54e-13  |g|= 2.52e-11  |ddm|= 9.07e-12
HOMO (B2u) = -0.310352929091072  LUMO (B3u) = -0.00845813095756448
cycle= 32 E= -75.234115263177  delta_E= 3.55e-13  |g|= 2.14e-11  |ddm|= 8.06e-12
HOMO (B2u) = -0.310352929090703  LUMO (B3u) = -0.00845813095739625
cycle= 33 E= -75.2341152631765  delta_E= 5.54e-13  |g|= 1.85e-11  |ddm|= 6.5e-12
HOMO (B2u) = -0.310352929090338  LUMO (B3u) = -0.00845813095724343
cycle= 34 E= -75.234115263176  delta_E= 5.26e-13  |g|= 1.64e-11  |ddm|= 5.35e-12
HOMO (B2u) = -0.310352929090001  LUMO (B3u) = -0.00845813095706435
cycle= 35 E= -75.2341152631753  delta_E= 6.25e-13  |g|= 1.45e-11  |ddm|= 4.51e-12
HOMO (B2u) = -0.310352929089671  LUMO (B3u) = -0.00845813095685044
cycle= 36 E= -75.2341152631748  delta_E= 5.54e-13  |g|= 1.28e-11  |ddm|= 4.22e-12
HOMO (B2u) = -0.310352929089356  LUMO (B3u) = -0.00845813095662071
cycle= 37 E= -75.2341152631742  delta_E= 5.54e-13  |g|= 1.12e-11  |ddm|= 3.78e-12
HOMO (B2u) = -0.310352929089057  LUMO (B3u) = -0.00845813095638165
cycle= 38 E= -75.2341152631736  delta_E= 5.68e-13  |g|= 9.83e-12  |ddm|= 3.19e-12
HOMO (B2u) = -0.310352929088774  LUMO (B3u) = -0.00845813095614098
cycle= 39 E= -75.2341152631732  delta_E= 4.97e-13  |g|= 8.8e-12  |ddm|= 2.68e-12
HOMO (B2u) = -0.310352929088503  LUMO (B3u) = -0.00845813095590569
cycle= 40 E= -75.2341152631725  delta_E= 6.82e-13  |g|= 7.89e-12  |ddm|= 2.4e-12
HOMO (B2u) = -0.310352929088248  LUMO (B3u) = -0.00845813095567863
cycle= 41 E= -75.2341152631721  delta_E= 3.69e-13  |g|= 7.19e-12  |ddm|= 2.17e-12
HOMO (B2u) = -0.310352929088001  LUMO (B3u) = -0.00845813095545647
cycle= 42 E= -75.2341152631717  delta_E= 4.26e-13  |g|= 6.6e-12  |ddm|= 2.01e-12
HOMO (B2u) = -0.310352929087767  LUMO (B3u) = -0.00845813095524095
cycle= 43 E= -75.2341152631713  delta_E= 3.98e-13  |g|= 6.06e-12  |ddm|= 1.89e-12
HOMO (B2u) = -0.310352929087544  LUMO (B3u) = -0.00845813095503373
cycle= 44 E= -75.234115263171  delta_E= 2.56e-13  |g|= 5.54e-12  |ddm|= 1.79e-12
HOMO (B2u) = -0.310352929087337  LUMO (B3u) = -0.00845813095483977
cycle= 45 E= -75.2341152631708  delta_E= 2.27e-13  |g|= 5.22e-12  |ddm|= 1.78e-12
HOMO (B2u) = -0.310352929087143  LUMO (B3u) = -0.00845813095465802
cycle= 46 E= -75.2341152631707  delta_E= 1.42e-13  |g|= 4.87e-12  |ddm|= 1.97e-12
HOMO (B2u) = -0.310352929086967  LUMO (B3u) = -0.00845813095449199
cycle= 47 E= -75.2341152631705  delta_E= 1.99e-13  |g|= 4.49e-12  |ddm|= 2.06e-12
HOMO (B2u) = -0.310352929086806  LUMO (B3u) = -0.00845813095434147
cycle= 48 E= -75.2341152631702  delta_E= 2.84e-13  |g|= 4.32e-12  |ddm|= 2.07e-12
HOMO (B2u) = -0.310352929086659  LUMO (B3u) = -0.00845813095420355
cycle= 49 E= -75.2341152631701  delta_E= 1.14e-13  |g|= 3.85e-12  |ddm|= 2.17e-12
HOMO (B2u) = -0.310352929086528  LUMO (B3u) = -0.00845813095407843
cycle= 50 E= -75.2341152631697  delta_E= 3.13e-13  |g|= 3.45e-12  |ddm|= 2.12e-12
SCF not converged.
SCF energy = -75.2341152631697

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmp4jkf4uhk
max_memory 4000 MB (current use 5119 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3u B3g B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4050131046161  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4242568550097  dE = -0.01924375  S^2 = 0.0000000
               |grad[o]|=0.114  |ddm|= 3.72  |maxRot[o]|=0.0783
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4363763708232  dE = -0.012119516  S^2 = 0.0000000
               |grad[o]|=0.0799  |ddm|=0.133  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4421108433167  dE = -0.0057344725  S^2 = 0.0000000
               |grad[o]|=0.044  |ddm|=0.0334  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4436341195497  dE = -0.0015232762  S^2 = 0.0000000
               |grad[o]|=0.0135  |ddm|=0.0929  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4441217799775  dE = -0.00048766043  S^2 = 0.0000000
               |grad[o]|=0.00714  |ddm|=0.0141  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4441999159764  dE = -7.8135999e-05  S^2 = 0.0000000
               |grad[o]|=0.00324  |ddm|=0.00699  |maxRot[o]|=0.0188
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4442076928441  dE = -7.7768677e-06  S^2 = 0.0000000
               |grad[o]|=0.00125  |ddm|=0.00327  |maxRot[o]|=0.00597
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4442084526307  dE = -7.5978657e-07  S^2 = 0.0000000
               |grad[o]|=0.000426  |ddm|=0.00115  |maxRot[o]|=0.00183
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4442085258774  dE = -7.3246653e-08  S^2 = 0.0000000
               |grad[o]|=0.000137  |ddm|=0.000379  |maxRot[o]|=0.000563
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4442085329124  dE = -7.035041e-09  S^2 = 0.0000000
               |grad[o]|=4.32e-05  |ddm|=0.000121  |maxRot[o]|=0.000173
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4442085335836  dE = -6.7124972e-10  S^2 = 0.0000000
               |grad[o]|=1.36e-05  |ddm|=3.77e-05  |maxRot[o]|=5.35e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4442085336482  dE = -6.450307e-11  S^2 = 0.0000000
               |grad[o]|=4.2e-06  |ddm|=1.18e-05  |maxRot[o]|=1.64e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.95530406 1.9381115  1.81911526 1.60013609 0.06045908 0.40376979
 0.05434301 0.16876121]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01246   0.01091  -0.00105   0.00000   0.00000
  0 C 2s       0.70117   0.68475  -0.08932   0.00000   0.00000
  0 C 3s       0.00639   0.01416  -0.02106   0.00000   0.00000
  0 C 2px      0.00000   0.00000   0.00000  -0.00000   0.69435
  0 C 2py      0.00000   0.00000  -0.00000   0.70466  -0.00000
  0 C 2pz      0.08959  -0.17518   0.69998   0.00000   0.00000
  0 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.06986
  0 C 3py     -0.00000   0.00000   0.00000   0.05490   0.00000
  0 C 3pz     -0.00744  -0.00175   0.02554   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000   0.00000  -0.00000   0.00000
  0 C 3dyz    -0.00000   0.00000   0.00000   0.02095   0.00000
  0 C 3dz^2    0.00897  -0.00886   0.03021   0.00000  -0.00000
  0 C 3dxz    -0.00000   0.00000  -0.00000   0.00000  -0.11401
 0 C 3dx2-y2   0.00234   0.00560  -0.00636   0.00000   0.00000
  1 C 1s       0.01246  -0.01091  -0.00105   0.00000   0.00000
  1 C 2s       0.70117  -0.68475  -0.08932   0.00000   0.00000
  1 C 3s       0.00639  -0.01416  -0.02106  -0.00000  -0.00000
  1 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.69435
  1 C 2py      0.00000  -0.00000  -0.00000   0.70466  -0.00000
  1 C 2pz     -0.08959  -0.17518  -0.69998   0.00000  -0.00000
  1 C 3px     -0.00000  -0.00000  -0.00000   0.00000  -0.06986
  1 C 3py      0.00000  -0.00000   0.00000   0.05490  -0.00000
  1 C 3pz      0.00744  -0.00175  -0.02554   0.00000   0.00000
  1 C 3dxy     0.00000   0.00000   0.00000  -0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000  -0.00000  -0.02095   0.00000
  1 C 3dz^2    0.00897   0.00886   0.03021  -0.00000  -0.00000
  1 C 3dxz     0.00000   0.00000   0.00000  -0.00000   0.11401
 1 C 3dx2-y2   0.00234  -0.00560  -0.00636  -0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00016
  0 C 2s       0.00000   0.00000   0.17473
  0 C 3s       0.00000   0.00000   0.02347
  0 C 2px     -0.00000   0.69923   0.00000
  0 C 2py      0.70703  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68460
  0 C 3px     -0.00000  -0.02593  -0.00000
  0 C 3py      0.00804  -0.00000  -0.00000
  0 C 3pz      0.00000   0.00000  -0.01155
  0 C 3dxy    -0.00000   0.00000   0.00000
  0 C 3dyz     0.00702  -0.00000  -0.00000
  0 C 3dz^2    0.00000   0.00000   0.00132
  0 C 3dxz    -0.00000  -0.10203   0.00000
 0 C 3dx2-y2   0.00000   0.00000  -0.01008
  1 C 1s       0.00000   0.00000   0.00016
  1 C 2s      -0.00000  -0.00000  -0.17473
  1 C 3s      -0.00000  -0.00000  -0.02347
  1 C 2px      0.00000  -0.69923   0.00000
  1 C 2py     -0.70703   0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68460
  1 C 3px      0.00000   0.02593  -0.00000
  1 C 3py     -0.00804   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.01155
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz     0.00702   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00132
  1 C 3dxz    -0.00000  -0.10203   0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.01008
<CAS-nat-orb|mo-hf>  3  3    0.99532682
<CAS-nat-orb|mo-hf>  4  4    0.99955353
<CAS-nat-orb|mo-hf>  5  5    0.99522358
<CAS-nat-orb|mo-hf>  6  6    0.99825105
<CAS-nat-orb|mo-hf>  7  7    0.93296318
<CAS-nat-orb|mo-hf>  8  8    0.98897441
<CAS-nat-orb|mo-hf>  9  9    0.96119968
<CAS-nat-orb|mo-hf>  10  10    0.96876542
CASSCF energy = -75.4442085336482
CASCI E = -75.4442085336482  E(CI) = -14.6790718460616  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.009

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.069
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.011
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.014
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.011
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.113
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.08
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.12
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.07
 INIT-R <-- Site =    4 ..  Bmem =  112 MB Rmem = 7.06 MB T = 0.01
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.01
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.308 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.193 | Tfpread = 0.000 | Tfpwrite = 0.190 | data = 73.2 MB | cpsd = 55.1 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.340 | E =     -75.5368291102 | DW = 1.70e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.485 | E =     -75.5625382745 | DE = -2.57e-02 | DW = 6.83e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.428 | E =     -75.5630652114 | DE = -5.27e-04 | DW = 1.63e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.396 | E =     -75.5635618733 | DE = -4.97e-04 | DW = 8.16e-05

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.177 | E =     -75.5635889714 | DE = -2.71e-05 | DW = 1.60e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.940 | E =     -75.5636153668 | DE = -2.64e-05 | DW = 8.18e-05

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.684 | E =     -75.5636334870 | DE = -1.81e-05 | DW = 1.63e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.538 | E =     -75.5636372243 | DE = -3.74e-06 | DW = 8.14e-05

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.910 | E =     -75.5646616619 | DE = -1.02e-03 | DW = 1.54e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.907 | E =     -75.5650970093 | DE = -4.35e-04 | DW = 2.56e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     17.527 | E =     -75.5652413312 | DE = -1.44e-04 | DW = 4.47e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     20.364 | E =     -75.5652896339 | DE = -4.83e-05 | DW = 3.28e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.228 | E =     -75.5653046800 | DE = -1.50e-05 | DW = 4.65e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.058 | E =     -75.5653166034 | DE = -1.19e-05 | DW = 3.34e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.850 | E =     -75.5653266194 | DE = -1.00e-05 | DW = 4.67e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     34.403 | E =     -75.5653329503 | DE = -6.33e-06 | DW = 3.40e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     42.733 | E =     -75.5654926753 | DE = -1.60e-04 | DW = 2.63e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     56.745 | E =     -75.5655355949 | DE = -4.29e-05 | DW = 1.92e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     67.546 | E =     -75.5655483728 | DE = -1.28e-05 | DW = 4.43e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     79.456 | E =     -75.5655517811 | DE = -3.41e-06 | DW = 2.05e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     88.449 | E =     -75.5655550166 | DE = -3.24e-06 | DW = 4.42e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     98.553 | E =     -75.5655582238 | DE = -3.21e-06 | DW = 2.06e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    110.835 | E =     -75.5655617995 | DE = -3.58e-06 | DW = 4.45e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    125.373 | E =     -75.5655645599 | DE = -2.76e-06 | DW = 2.06e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    154.552 | E =     -75.5656389113 | DE = -7.44e-05 | DW = 2.37e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    187.207 | E =     -75.5656422687 | DE = -3.36e-06 | DW = 1.19e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    214.308 | E =     -75.5656434915 | DE = -1.22e-06 | DW = 2.78e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    241.450 | E =     -75.5656435117 | DE = -2.02e-08 | DW = 1.04e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    267.543 | E =     -75.5656442927 | DE = -7.81e-07 | DW = 2.76e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    296.950 | E =     -75.5656442823 | DE = 1.04e-08 | DW = 1.04e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    322.629 | E =     -75.5656449873 | DE = -7.05e-07 | DW = 2.74e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    347.287 | E =     -75.5656449592 | DE = 2.81e-08 | DW = 1.03e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    616.124 | E =     -75.5656572449 | DE = -1.23e-05 | DW = 5.83e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    756.354 | E =     -75.5656572450 | DE = -1.12e-10 | DW = 5.83e-08

E(MRCI) = -75.56565724502843  E_corr = -0.1214487113802818
Time cost =    814.827
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Sun May 28 23:49:54 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.169626564772 AA    0.000000000000   0.000000000000   4.100000000000 Bohr   0.0

nuclear repulsion = 8.78048780487805
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.   0.   2.05]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    477753.11


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpqfz8c3br
max_memory 4000 MB (current use 5117 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6438760157729

WARN: Singularity detected in overlap matrix (condition number = 49.2). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0852438140031957  LUMO (B3u) = -0.0852438140031957

WARN: B2u HOMO -0.0852438140031957 > system LUMO -0.0852438140031957

cycle= 1 E= -75.2050111450144  delta_E= -0.561  |g|= 0.224  |ddm|= 1.45
HOMO (B2u) = -0.334187231388071  LUMO (B3g) = -0.0398454588841031
cycle= 2 E= -75.2255220782413  delta_E= -0.0205  |g|= 0.043  |ddm|= 0.347
HOMO (B2u) = -0.30372256156516  LUMO (B3g) = -0.00486882385407491
cycle= 3 E= -75.2266381654048  delta_E= -0.00112  |g|= 0.0161  |ddm|= 0.0554
HOMO (B2u) = -0.307858619678188  LUMO (B3g) = -0.0077666680528308
cycle= 4 E= -75.2268275306809  delta_E= -0.000189  |g|= 0.000623  |ddm|= 0.0321
HOMO (B2u) = -0.307904877132325  LUMO (B3g) = -0.0079120047359308
cycle= 5 E= -75.2268276836983  delta_E= -1.53e-07  |g|= 0.000135  |ddm|= 0.000792
HOMO (B2u) = -0.307873376598217  LUMO (B3g) = -0.0078718186414497
cycle= 6 E= -75.2268276941976  delta_E= -1.05e-08  |g|= 1.99e-05  |ddm|= 0.000228
HOMO (B2u) = -0.307870547891905  LUMO (B3g) = -0.00786924076200173
cycle= 7 E= -75.2268276944567  delta_E= -2.59e-10  |g|= 2.07e-06  |ddm|= 4.05e-05
HOMO (B2u) = -0.307870168621817  LUMO (B3g) = -0.00786899944460292
cycle= 8 E= -75.2268276944594  delta_E= -2.74e-12  |g|= 1.28e-07  |ddm|= 4.42e-06
HOMO (B2u) = -0.307870185809366  LUMO (B3g) = -0.00786900390117577
cycle= 9 E= -75.2268276944594  delta_E= 2.84e-14  |g|= 6.56e-09  |ddm|= 2.97e-07
HOMO (B2u) = -0.307870184795259  LUMO (B3g) = -0.00786900501367667
cycle= 10 E= -75.2268276944594  delta_E= -4.26e-14  |g|= 6.26e-09  |ddm|= 7.52e-09
HOMO (B2u) = -0.307870185325629  LUMO (B3g) = -0.00786900549296982
cycle= 11 E= -75.2268276944594  delta_E=    0  |g|= 4.35e-09  |ddm|= 4.43e-09
HOMO (B2u) = -0.307870184673259  LUMO (B3g) = -0.00786900468938985
cycle= 12 E= -75.2268276944595  delta_E= -8.53e-14  |g|= 3.7e-09  |ddm|= 2.56e-09
HOMO (B2u) = -0.307870184756425  LUMO (B3g) = -0.00786900477073713
cycle= 13 E= -75.2268276944595  delta_E= 2.84e-14  |g|= 3.33e-09  |ddm|= 9.6e-10
HOMO (B2u) = -0.307870184502857  LUMO (B3g) = -0.00786900460315198
cycle= 14 E= -75.2268276944596  delta_E= -5.68e-14  |g|= 5.16e-10  |ddm|= 5.31e-09
HOMO (B2u) = -0.307870184616368  LUMO (B3g) = -0.00786900470665598
cycle= 15 E= -75.2268276944595  delta_E= 7.11e-14  |g|= 6.33e-10  |ddm|= 1.11e-09
HOMO (B2u) = -0.307870184548759  LUMO (B3g) = -0.00786900464747879
cycle= 16 E= -75.2268276944595  delta_E= 1.42e-14  |g|= 5.31e-10  |ddm|= 1.04e-09
HOMO (B2u) = -0.307870184560441  LUMO (B3g) = -0.0078690046596384
cycle= 17 E= -75.2268276944595  delta_E= -2.84e-14  |g|= 6.57e-10  |ddm|= 9.06e-10
HOMO (B2u) = -0.307870184545934  LUMO (B3g) = -0.00786900465087811
cycle= 18 E= -75.2268276944595  delta_E= 4.26e-14  |g|= 5.03e-10  |ddm|= 2.42e-10
HOMO (B2u) = -0.307870184554947  LUMO (B3g) = -0.00786900465781755
cycle= 19 E= -75.2268276944594  delta_E= 1.42e-14  |g|= 3.83e-10  |ddm|= 3.33e-10
HOMO (B2u) = -0.307870184567197  LUMO (B3g) = -0.00786900467028308
cycle= 20 E= -75.2268276944595  delta_E= -1.42e-14  |g|= 3.05e-10  |ddm|= 2.09e-10
HOMO (B2u) = -0.307870184567794  LUMO (B3g) = -0.00786900467434109
cycle= 21 E= -75.2268276944594  delta_E= 7.11e-14  |g|= 2.16e-10  |ddm|= 1.61e-10
HOMO (B2u) = -0.30787018456797  LUMO (B3g) = -0.00786900467912575
cycle= 22 E= -75.2268276944593  delta_E= 1.14e-13  |g|= 1.3e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.307870184567947  LUMO (B3g) = -0.00786900467997868
cycle= 23 E= -75.2268276944591  delta_E= 1.71e-13  |g|= 1.16e-10  |ddm|= 3.48e-11
HOMO (B2u) = -0.307870184564505  LUMO (B3g) = -0.00786900467807376
cycle= 24 E= -75.226827694459  delta_E= 9.95e-14  |g|= 9.85e-11  |ddm|= 4.86e-11
HOMO (B2u) = -0.307870184564104  LUMO (B3g) = -0.00786900467867828
cycle= 25 E= -75.2268276944588  delta_E= 2.27e-13  |g|= 8.27e-11  |ddm|= 3.06e-11
HOMO (B2u) = -0.307870184563433  LUMO (B3g) = -0.00786900467875063
cycle= 26 E= -75.2268276944587  delta_E= 9.95e-14  |g|= 6.63e-11  |ddm|= 2.96e-11
HOMO (B2u) = -0.307870184562996  LUMO (B3g) = -0.00786900467871481
cycle= 27 E= -75.2268276944585  delta_E= 1.28e-13  |g|= 5.6e-11  |ddm|= 2.32e-11
HOMO (B2u) = -0.307870184562419  LUMO (B3g) = -0.00786900467872891
cycle= 28 E= -75.2268276944584  delta_E= 1.71e-13  |g|= 4.61e-11  |ddm|= 1.81e-11
HOMO (B2u) = -0.307870184561889  LUMO (B3g) = -0.00786900467886443
cycle= 29 E= -75.2268276944583  delta_E= 9.95e-14  |g|= 3.68e-11  |ddm|= 1.63e-11
HOMO (B2u) = -0.30787018456144  LUMO (B3g) = -0.00786900467895938
cycle= 30 E= -75.226827694458  delta_E= 3.27e-13  |g|= 2.97e-11  |ddm|= 1.27e-11
HOMO (B2u) = -0.307870184561135  LUMO (B3g) = -0.00786900467902489
cycle= 31 E= -75.2268276944574  delta_E= 5.4e-13  |g|= 2.54e-11  |ddm|= 8.46e-12
HOMO (B2u) = -0.307870184560779  LUMO (B3g) = -0.00786900467901494
cycle= 32 E= -75.2268276944569  delta_E= 5.26e-13  |g|= 2.17e-11  |ddm|= 7.48e-12
HOMO (B2u) = -0.307870184560515  LUMO (B3g) = -0.00786900467903826
cycle= 33 E= -75.2268276944564  delta_E= 5.26e-13  |g|= 1.88e-11  |ddm|= 5.92e-12
HOMO (B2u) = -0.30787018456024  LUMO (B3g) = -0.00786900467901103
cycle= 34 E= -75.2268276944557  delta_E= 6.54e-13  |g|= 1.67e-11  |ddm|= 4.9e-12
HOMO (B2u) = -0.307870184559966  LUMO (B3g) = -0.0078690046789698
cycle= 35 E= -75.226827694455  delta_E= 7.25e-13  |g|= 1.5e-11  |ddm|= 4.27e-12
HOMO (B2u) = -0.307870184559676  LUMO (B3g) = -0.00786900467891458
cycle= 36 E= -75.2268276944545  delta_E= 5.12e-13  |g|= 1.32e-11  |ddm|= 4.13e-12
HOMO (B2u) = -0.30787018455939  LUMO (B3g) = -0.00786900467884393
cycle= 37 E= -75.226827694454  delta_E= 4.55e-13  |g|= 1.17e-11  |ddm|= 3.73e-12
HOMO (B2u) = -0.307870184559112  LUMO (B3g) = -0.00786900467876468
cycle= 38 E= -75.2268276944535  delta_E= 5.54e-13  |g|= 1.04e-11  |ddm|= 3.16e-12
HOMO (B2u) = -0.307870184558834  LUMO (B3g) = -0.00786900467866806
cycle= 39 E= -75.226827694453  delta_E= 4.97e-13  |g|= 9.35e-12  |ddm|= 2.73e-12
HOMO (B2u) = -0.307870184558562  LUMO (B3g) = -0.00786900467856577
cycle= 40 E= -75.2268276944524  delta_E= 5.68e-13  |g|= 8.43e-12  |ddm|= 2.49e-12
HOMO (B2u) = -0.307870184558297  LUMO (B3g) = -0.00786900467846049
cycle= 41 E= -75.2268276944519  delta_E= 5.26e-13  |g|= 7.54e-12  |ddm|= 2.24e-12
HOMO (B2u) = -0.307870184558037  LUMO (B3g) = -0.00786900467834929
cycle= 42 E= -75.2268276944515  delta_E= 3.55e-13  |g|= 6.75e-12  |ddm|= 2.09e-12
HOMO (B2u) = -0.307870184557792  LUMO (B3g) = -0.00786900467823774
cycle= 43 E= -75.2268276944511  delta_E= 3.69e-13  |g|= 6.21e-12  |ddm|= 1.88e-12
HOMO (B2u) = -0.30787018455756  LUMO (B3g) = -0.00786900467812496
cycle= 44 E= -75.2268276944509  delta_E= 2.84e-13  |g|= 5.66e-12  |ddm|= 1.81e-12
HOMO (B2u) = -0.307870184557338  LUMO (B3g) = -0.00786900467801507
cycle= 45 E= -75.2268276944507  delta_E= 1.85e-13  |g|= 5.21e-12  |ddm|= 1.82e-12
HOMO (B2u) = -0.307870184557129  LUMO (B3g) = -0.00786900467790704
cycle= 46 E= -75.2268276944504  delta_E= 2.56e-13  |g|= 4.93e-12  |ddm|= 1.88e-12
HOMO (B2u) = -0.307870184556939  LUMO (B3g) = -0.00786900467780729
cycle= 47 E= -75.2268276944502  delta_E= 2.42e-13  |g|= 4.64e-12  |ddm|= 1.98e-12
HOMO (B2u) = -0.307870184556764  LUMO (B3g) = -0.00786900467771272
cycle= 48 E= -75.2268276944498  delta_E= 3.55e-13  |g|= 4.37e-12  |ddm|= 1.97e-12
HOMO (B2u) = -0.307870184556609  LUMO (B3g) = -0.00786900467762731
cycle= 49 E= -75.2268276944496  delta_E= 1.85e-13  |g|= 4.2e-12  |ddm|= 2.01e-12
HOMO (B2u) = -0.307870184556469  LUMO (B3g) = -0.00786900467755079
cycle= 50 E= -75.2268276944494  delta_E= 1.99e-13  |g|= 4.03e-12  |ddm|= 2.1e-12
SCF not converged.
SCF energy = -75.2268276944494

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpqfz8c3br
max_memory 4000 MB (current use 5117 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.4021896555603  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.4214622710138  dE = -0.019272615  S^2 = 0.0000000
               |grad[o]|=0.116  |ddm|= 3.71  |maxRot[o]|=0.0798
macro iter 2 (6 JK  0 micro), CASSCF E = -75.4334669884672  dE = -0.012004717  S^2 = 0.0000000
               |grad[o]|=0.0809  |ddm|=0.133  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4390840831122  dE = -0.0056170946  S^2 = 0.0000000
               |grad[o]|=0.0441  |ddm|=0.033  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4405313907274  dE = -0.0014473076  S^2 = 0.0000000
               |grad[o]|=0.0131  |ddm|=0.0907  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4409977480208  dE = -0.00046635729  S^2 = 0.0000000
               |grad[o]|=0.00691  |ddm|=0.0135  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4410655925372  dE = -6.7844516e-05  S^2 = 0.0000000
               |grad[o]|=0.00313  |ddm|=0.00709  |maxRot[o]|=0.0174
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4410727624915  dE = -7.1699543e-06  S^2 = 0.0000000
               |grad[o]|=0.00122  |ddm|=0.00314  |maxRot[o]|=0.00565
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4410735010525  dE = -7.3856098e-07  S^2 = 0.0000000
               |grad[o]|=0.000424  |ddm|=0.00113  |maxRot[o]|=0.00178
macro iter 9 (3 JK  0 micro), CASSCF E = -75.441073576053  dE = -7.5000514e-08  S^2 = 0.0000000
               |grad[o]|=0.000139  |ddm|=0.00038  |maxRot[o]|=0.000561
macro iter 10 (3 JK  0 micro), CASSCF E = -75.4410735836074  dE = -7.5544335e-09  S^2 = 0.0000000
               |grad[o]|=4.5e-05  |ddm|=0.000124  |maxRot[o]|=0.000177
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4410735843693  dE = -7.6192919e-10  S^2 = 0.0000000
               |grad[o]|=1.45e-05  |ddm|=4.01e-05  |maxRot[o]|=5.59e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4410735844463  dE = -7.6951778e-11  S^2 = 0.0000000
               |grad[o]|=4.62e-06  |ddm|=1.28e-05  |maxRot[o]|=1.77e-05
2-step CASSCF converged in 12 macro (46 JK 12 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.955248   1.93872422 1.80820219 1.57967992 0.42398996 0.05970208
 0.05400185 0.18045177]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01248   0.01096  -0.00089   0.00000   0.00000
  0 C 2s       0.70221   0.68634  -0.08081   0.00000   0.00000
  0 C 3s       0.00710   0.01405  -0.01955  -0.00000   0.00000
  0 C 2px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 2py      0.00000  -0.00000   0.00000   0.70471   0.70701
  0 C 2pz      0.08112  -0.16887   0.70104   0.00000   0.00000
  0 C 3px      0.00000  -0.00000  -0.00000  -0.00000  -0.00000
  0 C 3py      0.00000  -0.00000   0.00000   0.05462   0.00967
  0 C 3pz     -0.00705  -0.00178   0.02705  -0.00000  -0.00000
  0 C 3dxy     0.00000  -0.00000   0.00000   0.00000   0.00000
  0 C 3dyz     0.00000  -0.00000   0.00000   0.01990   0.00668
  0 C 3dz^2    0.00810  -0.00856   0.02935  -0.00000   0.00000
  0 C 3dxz     0.00000  -0.00000  -0.00000   0.00000  -0.00000
 0 C 3dx2-y2   0.00247   0.00552  -0.00626   0.00000  -0.00000
  1 C 1s       0.01248  -0.01096  -0.00089   0.00000   0.00000
  1 C 2s       0.70221  -0.68634  -0.08081   0.00000   0.00000
  1 C 3s       0.00710  -0.01405  -0.01955  -0.00000  -0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000   0.00000
  1 C 2py     -0.00000   0.00000  -0.00000   0.70471  -0.70701
  1 C 2pz     -0.08112  -0.16887  -0.70104   0.00000   0.00000
  1 C 3px     -0.00000   0.00000   0.00000   0.00000   0.00000
  1 C 3py     -0.00000   0.00000  -0.00000   0.05462  -0.00967
  1 C 3pz      0.00705  -0.00178  -0.02705   0.00000   0.00000
  1 C 3dxy    -0.00000  -0.00000  -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000  -0.00000   0.00000  -0.01990   0.00668
  1 C 3dz^2    0.00810   0.00856   0.02935  -0.00000  -0.00000
  1 C 3dxz     0.00000  -0.00000  -0.00000  -0.00000  -0.00000
 1 C 3dx2-y2   0.00247  -0.00552  -0.00626  -0.00000  -0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00015
  0 C 2s       0.00000   0.00000   0.16846
  0 C 3s       0.00000  -0.00000   0.02250
  0 C 2px      0.69455   0.69937   0.00000
  0 C 2py     -0.00000  -0.00000   0.00000
  0 C 2pz      0.00000   0.00000   0.68626
  0 C 3px     -0.07025  -0.02735   0.00000
  0 C 3py     -0.00000   0.00000   0.00000
  0 C 3pz      0.00000  -0.00000  -0.00897
  0 C 3dxy    -0.00000  -0.00000  -0.00000
  0 C 3dyz    -0.00000  -0.00000   0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00098
  0 C 3dxz    -0.11253  -0.10066   0.00000
 0 C 3dx2-y2  -0.00000   0.00000  -0.00927
  1 C 1s       0.00000   0.00000   0.00015
  1 C 2s      -0.00000   0.00000  -0.16846
  1 C 3s      -0.00000  -0.00000  -0.02250
  1 C 2px      0.69455  -0.69937  -0.00000
  1 C 2py     -0.00000  -0.00000  -0.00000
  1 C 2pz      0.00000   0.00000   0.68626
  1 C 3px     -0.07025   0.02735  -0.00000
  1 C 3py     -0.00000   0.00000  -0.00000
  1 C 3pz      0.00000   0.00000  -0.00897
  1 C 3dxy    -0.00000   0.00000  -0.00000
  1 C 3dyz     0.00000   0.00000   0.00000
  1 C 3dz^2   -0.00000  -0.00000  -0.00098
  1 C 3dxz     0.11253  -0.10066   0.00000
 1 C 3dx2-y2  -0.00000   0.00000   0.00927
<CAS-nat-orb|mo-hf>  3  3    0.99498964
<CAS-nat-orb|mo-hf>  4  4    0.99952981
<CAS-nat-orb|mo-hf>  5  5    0.99486174
<CAS-nat-orb|mo-hf>  6  6    0.99817000
<CAS-nat-orb|mo-hf>  7  7    0.98959360
<CAS-nat-orb|mo-hf>  8  8    0.93310237
<CAS-nat-orb|mo-hf>  9  9    0.96127106
<CAS-nat-orb|mo-hf>  10  10    0.97122879
CASSCF energy = -75.4410735844463
CASCI E = -75.4410735844463  E(CI) = -14.6278044350828  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.030
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.031
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.041
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.041
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.041
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.041
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.340
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      2.093
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      2.659

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.028
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.031
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.629
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      1.720
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      1.724
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      1.724
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      2.324
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      1.299
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      9.479
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.06
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.07
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.03
 INIT-R <-- Site =    4 ..  Bmem =  104 MB Rmem = 6.55 MB T = 0.05
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.05
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.05
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.05
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.05
Time init sweep =        0.435 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.211 | Tfpread = 0.000 | Tfpwrite = 0.208 | data = 72.7 MB | cpsd = 54.6 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.955 | E =     -75.5327084724 | DW = 1.39e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      9.580 | E =     -75.5594243244 | DE = -2.67e-02 | DW = 3.40e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     10.231 | E =     -75.5601676437 | DE = -7.43e-04 | DW = 2.00e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     12.160 | E =     -75.5607898906 | DE = -6.22e-04 | DW = 1.07e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     14.782 | E =     -75.5608569957 | DE = -6.71e-05 | DW = 2.01e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     16.807 | E =     -75.5608778951 | DE = -2.09e-05 | DW = 1.02e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     19.006 | E =     -75.5609039489 | DE = -2.61e-05 | DW = 2.03e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =     19.729 | E =     -75.5609160312 | DE = -1.21e-05 | DW = 1.09e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     22.472 | E =     -75.5617263729 | DE = -8.10e-04 | DW = 1.72e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.110 | E =     -75.5621450234 | DE = -4.19e-04 | DW = 2.96e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     33.951 | E =     -75.5622548315 | DE = -1.10e-04 | DW = 4.69e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     38.942 | E =     -75.5623199712 | DE = -6.51e-05 | DW = 3.49e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     45.282 | E =     -75.5623778835 | DE = -5.79e-05 | DW = 5.00e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     49.913 | E =     -75.5623957919 | DE = -1.79e-05 | DW = 3.64e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     54.134 | E =     -75.5624019220 | DE = -6.13e-06 | DW = 5.04e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     58.442 | E =     -75.5624035062 | DE = -1.58e-06 | DW = 3.63e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     67.189 | E =     -75.5625329747 | DE = -1.29e-04 | DW = 2.75e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     79.454 | E =     -75.5625773333 | DE = -4.44e-05 | DW = 2.03e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     90.249 | E =     -75.5625854285 | DE = -8.10e-06 | DW = 4.59e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    102.217 | E =     -75.5625867916 | DE = -1.36e-06 | DW = 2.16e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    113.170 | E =     -75.5625873230 | DE = -5.31e-07 | DW = 4.64e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    124.770 | E =     -75.5625880999 | DE = -7.77e-07 | DW = 2.17e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    135.293 | E =     -75.5625883104 | DE = -2.10e-07 | DW = 4.61e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    147.550 | E =     -75.5625889899 | DE = -6.79e-07 | DW = 2.15e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    169.889 | E =     -75.5625942130 | DE = -5.22e-06 | DW = 2.40e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    197.898 | E =     -75.5625973464 | DE = -3.13e-06 | DW = 1.15e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    220.998 | E =     -75.5625980195 | DE = -6.73e-07 | DW = 2.62e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    246.794 | E =     -75.5625982246 | DE = -2.05e-07 | DW = 1.17e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    272.267 | E =     -75.5625985080 | DE = -2.83e-07 | DW = 2.64e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    298.358 | E =     -75.5625986952 | DE = -1.87e-07 | DW = 1.18e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    322.644 | E =     -75.5625988696 | DE = -1.74e-07 | DW = 2.61e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    349.025 | E =     -75.5625990603 | DE = -1.91e-07 | DW = 1.17e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    509.354 | E =     -75.5626072367 | DE = -8.18e-06 | DW = 6.43e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    545.109 | E =     -75.5626072368 | DE = -1.23e-10 | DW = 6.43e-08

E(MRCI) = -75.56260723683543  E_corr = -0.1215336523891324
Time cost =    817.501
#INFO: **** input file is /central/groups/changroup/members/hczhai/work/software/07-C2/01-uc-ic.py ****

import numpy as np, time
from pyscf import gto, scf, mcscf, dmrgscf, lib
import os, sys

ith = int(sys.argv[1])

theory = [
    "dmrgscf",
    "uc-mrcisd",
    "uc-mrrept2",
    "uc-nevpt2",
    "ic-mrcisd",
    "ic-mrrept2",
    "ic-nevpt2",
    "sc-nevpt2",
][ith]

if theory == "uc-mrcisd":
    from pyblock2.mrpt import UCMRCISD as MR
elif theory == "uc-mrrept2":
    from pyblock2.mrpt import UCMRREPT2 as MR
elif theory == "uc-nevpt2":
    from pyblock2.mrpt import UCNEVPT2 as MR
elif theory == "ic-mrcisd":
    from pyblock2.icmr.icmrcisd_full import ICMRCISD as MR
elif theory == "ic-mrrept2":
    from pyblock2.icmr.icmrrept2_full import ICMRREPT2 as MR
elif theory == "ic-nevpt2":
    from pyblock2.icmr.icnevpt2_full import ICNEVPT2 as MR
elif theory == "sc-nevpt2":
    from pyblock2.icmr.scnevpt2 import SCNEVPT2 as MR
elif theory != "dmrgscf":
    raise RuntimeError('unsupported theory' + theory)

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ''

lib.param.TMPDIR = '/central/scratch/hczhai/st-07-01-%s' % theory

if not os.path.exists(lib.param.TMPDIR):
    os.mkdir(lib.param.TMPDIR)

mcscf.casci.FRAC_OCC_THRESHOLD = -1

dists = np.arange(1.80, 4.16, 0.05)
eners = np.zeros_like(dists)
eners_dq = np.zeros_like(dists)

cas_cur = []
ic_cur = []
for ix, d in enumerate(dists):

    tstart = time.perf_counter()

    mol = gto.M(atom='C 0 0 0; C 0 0 %f' % d, unit='bohr',
        symmetry='d2h', basis='cc-pvdz', spin=0, verbose=4)
    mf = scf.RHF(mol).run(conv_tol=1E-20)
    mc = mcscf.CASSCF(mf, 8, 8)
    mc.fcisolver = dmrgscf.DMRGCI(mol, maxM=1000, tol=1e-10)
    mc.fcisolver.runtimeDir = lib.param.TMPDIR
    mc.fcisolver.scratchDirectory = lib.param.TMPDIR
    mc.fcisolver.threads = 24
    mc.conv_tol = 1e-10
    mc.fcisolver.conv_tol = 1e-12
    mc.canonicalization = True
    mc.natorb = True
    mc.mc2step()

    mol.verbose = 5
    mol.symmetry = 'c1'
    mol.build()

    if "uc" in theory:
        mr = MR(mc).set(scratch=lib.param.TMPDIR).run()
        eners[ix] = mr.e_tot
    elif "ic-mrcisd" in theory:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot
        eners_dq[ix] = mr.e_tot + mr.de_dav_q
    elif "dmrgscf" in theory:
        eners[ix] = mc.e_tot
    else:
        mr = MR(mc).run()
        eners[ix] = mr.e_tot

    print('Time cost = %10.3f' % (time.perf_counter() - tstart))

np.save('%s.npy' % theory, np.array(eners))
if "ic-mrcisd" in theory:
    np.save('%s-dq.npy' % theory, np.array(eners_dq))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-19-15.cm.cluster', release='3.10.0-1160.53.1.el7.x86_64', version='#1 SMP Fri Jan 14 13:59:45 UTC 2022', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.5 (default, Sep  4 2020, 07:30:14) 
[GCC 7.3.0]
numpy 1.19.4  scipy 1.4.1
Date: Mon May 29 00:03:31 2023
PySCF version 2.1.1
PySCF path  /central/groups/changroup/members/hczhai/program/pyscf
GIT ORIG_HEAD 9d5b5bd309d1cc55fbd1a0ec76e26b5b0c7f76af
GIT HEAD (branch ccsd_t_cas) bce349cd58351d56507ebb3005a119fa94c75308

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.000000000000   0.000000000000   2.196085425318 AA    0.000000000000   0.000000000000   4.150000000000 Bohr   0.0

nuclear repulsion = 8.67469879518072
point group symmetry = Dooh, use subgroup D2h
symmetry origin: [0.    0.    2.075]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:    488287.45


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-20
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpggunyhqc
max_memory 4000 MB (current use 5098 MB)
Freeze 0 electrons in irreps []
    12 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 1e-10
init E= -74.6374240354882

WARN: Singularity detected in overlap matrix (condition number = 46.4). SCF may be inaccurate and hard to converge.

HOMO (B2u) = -0.0833226379096652  LUMO (B3u) = -0.0833226379096652

WARN: B2u HOMO -0.0833226379096652 > system LUMO -0.0833226379096652

cycle= 1 E= -75.1980259935244  delta_E= -0.561  |g|= 0.223  |ddm|= 1.45
HOMO (B2u) = -0.331539393004466  LUMO (B3g) = -0.042479426899903
cycle= 2 E= -75.2183742970649  delta_E= -0.0203  |g|= 0.0426  |ddm|= 0.347
HOMO (B2u) = -0.301383734536958  LUMO (B3g) = -0.00782777517474283
cycle= 3 E= -75.2194670845425  delta_E= -0.00109  |g|= 0.0159  |ddm|= 0.0547
HOMO (B2u) = -0.305478746489495  LUMO (B3g) = -0.010733308875924
cycle= 4 E= -75.2196531399389  delta_E= -0.000186  |g|= 0.000618  |ddm|= 0.0318
HOMO (B2u) = -0.305504012954427  LUMO (B3g) = -0.0108540193385371
cycle= 5 E= -75.2196532909579  delta_E= -1.51e-07  |g|= 0.000135  |ddm|= 0.000782
HOMO (B2u) = -0.305473477058594  LUMO (B3g) = -0.0108148524604041
cycle= 6 E= -75.219653301404  delta_E= -1.04e-08  |g|= 1.98e-05  |ddm|= 0.000227
HOMO (B2u) = -0.305470638287291  LUMO (B3g) = -0.0108121741027792
cycle= 7 E= -75.2196533016625  delta_E= -2.58e-10  |g|= 2.1e-06  |ddm|= 4.03e-05
HOMO (B2u) = -0.305470264892431  LUMO (B3g) = -0.0108119322510386
cycle= 8 E= -75.2196533016654  delta_E= -2.87e-12  |g|= 1.29e-07  |ddm|= 4.5e-06
HOMO (B2u) = -0.305470284406465  LUMO (B3g) = -0.0108119381626839
cycle= 9 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 6.74e-09  |ddm|= 2.91e-07
HOMO (B2u) = -0.305470283327175  LUMO (B3g) = -0.0108119393051191
cycle= 10 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 6.37e-09  |ddm|= 8.17e-09
HOMO (B2u) = -0.305470283985962  LUMO (B3g) = -0.0108119399154113
cycle= 11 E= -75.2196533016653  delta_E= -2.84e-14  |g|= 4.44e-09  |ddm|= 4.14e-09
HOMO (B2u) = -0.305470283403762  LUMO (B3g) = -0.0108119391826612
cycle= 12 E= -75.2196533016653  delta_E=    0  |g|= 3.79e-09  |ddm|= 2.46e-09
HOMO (B2u) = -0.305470283231267  LUMO (B3g) = -0.0108119391067099
cycle= 13 E= -75.2196533016654  delta_E= -2.84e-14  |g|= 3.38e-10  |ddm|= 5.65e-09
HOMO (B2u) = -0.305470283280833  LUMO (B3g) = -0.0108119391356951
cycle= 14 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 4.47e-10  |ddm|= 6.62e-10
HOMO (B2u) = -0.305470283380742  LUMO (B3g) = -0.0108119392267769
cycle= 15 E= -75.2196533016654  delta_E= -4.26e-14  |g|= 5.45e-10  |ddm|= 9.28e-10
HOMO (B2u) = -0.305470283318582  LUMO (B3g) = -0.0108119391708652
cycle= 16 E= -75.2196533016653  delta_E= 4.26e-14  |g|= 4.69e-10  |ddm|= 8.42e-10
HOMO (B2u) = -0.305470283328601  LUMO (B3g) = -0.0108119391822765
cycle= 17 E= -75.2196533016653  delta_E= 2.84e-14  |g|= 5.85e-10  |ddm|= 9.63e-10
HOMO (B2u) = -0.30547028331764  LUMO (B3g) = -0.0108119391766986
cycle= 18 E= -75.2196533016652  delta_E= 9.95e-14  |g|= 4.24e-10  |ddm|= 2.55e-10
HOMO (B2u) = -0.305470283329685  LUMO (B3g) = -0.0108119391863874
cycle= 19 E= -75.2196533016652  delta_E= -1.42e-14  |g|= 2.87e-10  |ddm|= 2.99e-10
HOMO (B2u) = -0.305470283344797  LUMO (B3g) = -0.0108119392016171
cycle= 20 E= -75.2196533016652  delta_E= 2.84e-14  |g|= 1.97e-10  |ddm|= 1.86e-10
HOMO (B2u) = -0.305470283348183  LUMO (B3g) = -0.0108119392084041
cycle= 21 E= -75.2196533016651  delta_E= 8.53e-14  |g|= 1.04e-10  |ddm|= 1.54e-10
HOMO (B2u) = -0.305470283348753  LUMO (B3g) = -0.0108119392083464
cycle= 22 E= -75.2196533016653  delta_E= -1.42e-13  |g|= 1.02e-10  |ddm|= 1.99e-11
HOMO (B2u) = -0.305470283349391  LUMO (B3g) = -0.0108119392095878
cycle= 23 E= -75.2196533016652  delta_E= 8.53e-14  |g|= 8.99e-11  |ddm|= 3.47e-11
HOMO (B2u) = -0.305470283347049  LUMO (B3g) = -0.0108119392083947
cycle= 24 E= -75.2196533016651  delta_E= 8.53e-14  |g|= 7.52e-11  |ddm|= 4.37e-11
HOMO (B2u) = -0.305470283347479  LUMO (B3g) = -0.0108119392096187
cycle= 25 E= -75.219653301665  delta_E= 8.53e-14  |g|= 6.16e-11  |ddm|= 3.41e-11
HOMO (B2u) = -0.305470283347749  LUMO (B3g) = -0.0108119392103766
cycle= 26 E= -75.2196533016651  delta_E= -8.53e-14  |g|= 4.61e-11  |ddm|= 2.42e-11
HOMO (B2u) = -0.305470283348095  LUMO (B3g) = -0.0108119392108431
cycle= 27 E= -75.219653301665  delta_E= 5.68e-14  |g|= 3.73e-11  |ddm|= 1.77e-11
HOMO (B2u) = -0.305470283348156  LUMO (B3g) = -0.0108119392111906
cycle= 28 E= -75.2196533016649  delta_E= 1.42e-13  |g|= 2.99e-11  |ddm|= 1.24e-11
HOMO (B2u) = -0.305470283348175  LUMO (B3g) = -0.0108119392115457
cycle= 29 E= -75.2196533016646  delta_E= 3.13e-13  |g|= 2.38e-11  |ddm|= 1.05e-11
HOMO (B2u) = -0.305470283348207  LUMO (B3g) = -0.010811939211774
cycle= 30 E= -75.2196533016642  delta_E= 3.41e-13  |g|= 2.05e-11  |ddm|= 6.48e-12
HOMO (B2u) = -0.305470283348146  LUMO (B3g) = -0.0108119392119533
cycle= 31 E= -75.2196533016638  delta_E= 3.98e-13  |g|= 1.72e-11  |ddm|= 6.8e-12
HOMO (B2u) = -0.305470283348023  LUMO (B3g) = -0.0108119392120479
cycle= 32 E= -75.2196533016634  delta_E= 4.26e-13  |g|= 1.44e-11  |ddm|= 5.82e-12
HOMO (B2u) = -0.305470283347959  LUMO (B3g) = -0.0108119392121555
cycle= 33 E= -75.2196533016629  delta_E= 4.97e-13  |g|= 1.24e-11  |ddm|= 4.48e-12
HOMO (B2u) = -0.305470283347856  LUMO (B3g) = -0.010811939212193
cycle= 34 E= -75.2196533016623  delta_E= 5.83e-13  |g|= 1.11e-11  |ddm|= 3.43e-12
HOMO (B2u) = -0.305470283347727  LUMO (B3g) = -0.0108119392121968
cycle= 35 E= -75.2196533016616  delta_E= 7.11e-13  |g|= 1.02e-11  |ddm|= 2.96e-12
HOMO (B2u) = -0.305470283347554  LUMO (B3g) = -0.0108119392121644
cycle= 36 E= -75.2196533016611  delta_E= 5.4e-13  |g|= 9.17e-12  |ddm|= 3.09e-12
HOMO (B2u) = -0.305470283347355  LUMO (B3g) = -0.0108119392121019
cycle= 37 E= -75.2196533016605  delta_E= 5.97e-13  |g|= 8.14e-12  |ddm|= 2.86e-12
HOMO (B2u) = -0.305470283347143  LUMO (B3g) = -0.0108119392120135
cycle= 38 E= -75.21965330166  delta_E= 4.55e-13  |g|= 7.12e-12  |ddm|= 2.69e-12
HOMO (B2u) = -0.305470283346919  LUMO (B3g) = -0.0108119392119047
cycle= 39 E= -75.2196533016595  delta_E= 4.83e-13  |g|= 6.29e-12  |ddm|= 2.49e-12
HOMO (B2u) = -0.305470283346686  LUMO (B3g) = -0.0108119392117769
cycle= 40 E= -75.2196533016591  delta_E= 4.12e-13  |g|= 5.67e-12  |ddm|= 2.35e-12
HOMO (B2u) = -0.305470283346459  LUMO (B3g) = -0.0108119392116394
cycle= 41 E= -75.2196533016588  delta_E= 3.84e-13  |g|= 5.05e-12  |ddm|= 2.15e-12
HOMO (B2u) = -0.305470283346234  LUMO (B3g) = -0.0108119392114926
cycle= 42 E= -75.2196533016584  delta_E= 3.84e-13  |g|= 4.57e-12  |ddm|= 1.93e-12
HOMO (B2u) = -0.305470283346019  LUMO (B3g) = -0.0108119392113402
cycle= 43 E= -75.2196533016579  delta_E= 4.41e-13  |g|= 4.2e-12  |ddm|= 1.74e-12
HOMO (B2u) = -0.305470283345817  LUMO (B3g) = -0.0108119392111903
cycle= 44 E= -75.2196533016576  delta_E= 3.69e-13  |g|= 3.93e-12  |ddm|= 1.63e-12
HOMO (B2u) = -0.305470283345625  LUMO (B3g) = -0.0108119392110409
cycle= 45 E= -75.2196533016572  delta_E= 3.55e-13  |g|= 3.74e-12  |ddm|= 1.6e-12
HOMO (B2u) = -0.305470283345446  LUMO (B3g) = -0.0108119392108958
cycle= 46 E= -75.2196533016569  delta_E= 3.13e-13  |g|= 3.56e-12  |ddm|= 1.59e-12
HOMO (B2u) = -0.305470283345279  LUMO (B3g) = -0.010811939210758
cycle= 47 E= -75.2196533016564  delta_E= 4.69e-13  |g|= 3.4e-12  |ddm|= 1.59e-12
HOMO (B2u) = -0.305470283345122  LUMO (B3g) = -0.0108119392106254
cycle= 48 E= -75.2196533016562  delta_E= 2.7e-13  |g|= 3.26e-12  |ddm|= 1.53e-12
HOMO (B2u) = -0.305470283344973  LUMO (B3g) = -0.0108119392104975
cycle= 49 E= -75.2196533016559  delta_E= 2.7e-13  |g|= 3.16e-12  |ddm|= 1.43e-12
HOMO (B2u) = -0.305470283344833  LUMO (B3g) = -0.010811939210374
cycle= 50 E= -75.2196533016556  delta_E= 2.56e-13  |g|= 3.09e-12  |ddm|= 1.43e-12
SCF not converged.
SCF energy = -75.2196533016556

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (4e+4e, 8o), ncore = 2, nvir = 18
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-10
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /central/scratch/hczhai/st-07-01-uc-mrcisd/tmpggunyhqc
max_memory 4000 MB (current use 5098 MB)
internal_rotation = False

******** Block flags ********
executable             = /home/hczhai/program/anaconda3/envs/python3.7/bin/block2main
BLOCKEXE_COMPRESS_NEVPT= /path/to/serially/compiled/Block/block.spin_adapted
Block version          = 2.0
mpiprefix              = 
scratchDirectory       = /central/scratch/hczhai/st-07-01-uc-mrcisd
integralFile           = /central/scratch/hczhai/st-07-01-uc-mrcisd/FCIDUMP
configFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.conf
outputFile             = /central/scratch/hczhai/st-07-01-uc-mrcisd/dmrg.out
maxIter                = 38
scheduleSweeps         = [0, 4, 8, 12, 14, 16, 18, 20, 22, 24, 26]
scheduleMaxMs          = [200, 400, 800, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
scheduleTols           = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 1.0000000000000001e-11]
scheduleNoises         = [0.0001, 0.0001, 0.0001, 0.0001, 1e-05, 1.0000000000000002e-06, 1.0000000000000002e-07, 1.0000000000000002e-08, 1.0000000000000003e-09, 1.0000000000000003e-10, 0.0]
twodot_to_onedot       = 30
tol                    = 1e-10
maxM                   = 1000
dmrg switch tol        = 0.001
wfnsym                 = 1
fullrestart            = False
num_thrds              = 24
memory                 = None

Symmetries of active orbitals: Ag B1u Ag B2u B3g B3u B2g B1u
Active space CI wfn symmetry = B1g
CASCI E = -75.3995087253759  S^2 = 0.0000000
Set conv_tol_grad to 1e-05
macro iter 1 (6 JK  0 micro), CASSCF E = -75.418537909442  dE = -0.019029184  S^2 = 0.0000000
               |grad[o]|=0.118  |ddm|=  3.7  |maxRot[o]|=0.0799
macro iter 2 (6 JK  0 micro), CASSCF E = -75.430581220288  dE = -0.012043311  S^2 = 0.0000000
               |grad[o]|=0.0825  |ddm|= 0.13  |maxRot[o]|=0.0799
macro iter 3 (6 JK  0 micro), CASSCF E = -75.4361629115961  dE = -0.0055816913  S^2 = 0.0000000
               |grad[o]|=0.0449  |ddm|=0.0292  |maxRot[o]|=0.0799
macro iter 4 (5 JK  0 micro), CASSCF E = -75.4375634990098  dE = -0.0014005874  S^2 = 0.0000000
               |grad[o]|=0.0129  |ddm|= 0.09  |maxRot[o]|=0.0599
macro iter 5 (4 JK  0 micro), CASSCF E = -75.4380295769846  dE = -0.00046607797  S^2 = 0.0000000
               |grad[o]|=0.00687  |ddm|=0.0132  |maxRot[o]|= 0.04
macro iter 6 (3 JK  0 micro), CASSCF E = -75.4380962924987  dE = -6.6715514e-05  S^2 = 0.0000000
               |grad[o]|=0.00315  |ddm|=0.00729  |maxRot[o]|=0.0171
macro iter 7 (3 JK  0 micro), CASSCF E = -75.4381038259102  dE = -7.5334115e-06  S^2 = 0.0000000
               |grad[o]|=0.00126  |ddm|=0.00318  |maxRot[o]|=0.00571
macro iter 8 (3 JK  0 micro), CASSCF E = -75.4381046488813  dE = -8.2297107e-07  S^2 = 0.0000000
               |grad[o]|=0.000447  |ddm|=0.00118  |maxRot[o]|=0.00185
macro iter 9 (3 JK  0 micro), CASSCF E = -75.4381047373476  dE = -8.8466308e-08  S^2 = 0.0000000
               |grad[o]|=0.000151  |ddm|=0.000407  |maxRot[o]|=0.0006
macro iter 10 (2 JK  0 micro), CASSCF E = -75.4381047467734  dE = -9.4258183e-09  S^2 = 0.0000000
               |grad[o]|=5.02e-05  |ddm|=0.000136  |maxRot[o]|=0.000195
macro iter 11 (2 JK  0 micro), CASSCF E = -75.4381047477702  dE = -9.968204e-10  S^2 = 0.0000000
               |grad[o]|=1.66e-05  |ddm|=4.5e-05  |maxRot[o]|=6.33e-05
macro iter 12 (2 JK  0 micro), CASSCF E = -75.4381047478757  dE = -1.0545875e-10  S^2 = 0.0000000
               |grad[o]|=5.39e-06  |ddm|=1.48e-05  |maxRot[o]|=2.05e-05
macro iter 13 (2 JK  0 micro), CASSCF E = -75.4381047478867  dE = -1.097078e-11  S^2 = 0.0000000
               |grad[o]|=1.79e-06  |ddm|=4.81e-06  |maxRot[o]|=6.74e-06
2-step CASSCF converged in 13 macro (47 JK 13 micro) steps
CASSCF canonicalization
FCI vector not available, call CASCI to update wavefunction
Natural occ [1.9552256  1.93933509 1.79648698 1.55867496 0.44475737 0.0589722
 0.05365784 0.19288996]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 C 1s       0.01249   0.01101  -0.00075   0.00000   0.00000
  0 C 2s       0.70304   0.68783  -0.07328   0.00000   0.00000
  0 C 3s       0.00773   0.01395  -0.01813   0.00000  -0.00000
  0 C 2px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 2py     -0.00000   0.00000  -0.00000   0.70477   0.70699
  0 C 2pz      0.07361  -0.16270   0.70188  -0.00000  -0.00000
  0 C 3px      0.00000  -0.00000   0.00000  -0.00000   0.00000
  0 C 3py      0.00000   0.00000  -0.00000   0.05427   0.01126
  0 C 3pz     -0.00668  -0.00182   0.02850   0.00000   0.00000
  0 C 3dxy    -0.00000   0.00000  -0.00000   0.00000   0.00000
  0 C 3dyz     0.00000   0.00000   0.00000   0.01889   0.00635
  0 C 3dz^2    0.00731  -0.00827   0.02845   0.00000  -0.00000
  0 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 0 C 3dx2-y2   0.00258   0.00545  -0.00616  -0.00000  -0.00000
  1 C 1s       0.01249  -0.01101  -0.00075   0.00000   0.00000
  1 C 2s       0.70304  -0.68783  -0.07328  -0.00000  -0.00000
  1 C 3s       0.00773  -0.01395  -0.01813  -0.00000   0.00000
  1 C 2px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 2py     -0.00000   0.00000   0.00000   0.70477  -0.70699
  1 C 2pz     -0.07361  -0.16270  -0.70188  -0.00000  -0.00000
  1 C 3px     -0.00000   0.00000  -0.00000   0.00000  -0.00000
  1 C 3py      0.00000  -0.00000  -0.00000   0.05427  -0.01126
  1 C 3pz      0.00668  -0.00182  -0.02850   0.00000  -0.00000
  1 C 3dxy    -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000   0.00000   0.00000  -0.01889   0.00635
  1 C 3dz^2    0.00731   0.00827   0.02845   0.00000   0.00000
  1 C 3dxz     0.00000  -0.00000   0.00000  -0.00000   0.00000
 1 C 3dx2-y2   0.00258  -0.00545  -0.00616   0.00000   0.00000
               #6        #7        #8       
  0 C 1s       0.00000   0.00000  -0.00014
  0 C 2s      -0.00000   0.00000   0.16232
  0 C 3s       0.00000  -0.00000   0.02153
  0 C 2px      0.69477   0.69952  -0.00000
  0 C 2py      0.00000  -0.00000  -0.00000
  0 C 2pz      0.00000  -0.00000   0.68780
  0 C 3px     -0.07060  -0.02872  -0.00000
  0 C 3py      0.00000   0.00000  -0.00000
  0 C 3pz      0.00000  -0.00000  -0.00644
  0 C 3dxy     0.00000   0.00000  -0.00000
  0 C 3dyz     0.00000   0.00000  -0.00000
  0 C 3dz^2    0.00000  -0.00000   0.00067
  0 C 3dxz    -0.11095  -0.09923  -0.00000
 0 C 3dx2-y2  -0.00000  -0.00000  -0.00851
  1 C 1s       0.00000   0.00000   0.00014
  1 C 2s       0.00000   0.00000  -0.16232
  1 C 3s      -0.00000   0.00000  -0.02153
  1 C 2px      0.69477  -0.69952   0.00000
  1 C 2py      0.00000  -0.00000   0.00000
  1 C 2pz      0.00000  -0.00000   0.68780
  1 C 3px     -0.07060   0.02872   0.00000
  1 C 3py     -0.00000   0.00000   0.00000
  1 C 3pz      0.00000  -0.00000  -0.00644
  1 C 3dxy     0.00000   0.00000   0.00000
  1 C 3dyz    -0.00000  -0.00000  -0.00000
  1 C 3dz^2   -0.00000   0.00000  -0.00067
  1 C 3dxz     0.11095  -0.09923  -0.00000
 1 C 3dx2-y2   0.00000  -0.00000   0.00851
<CAS-nat-orb|mo-hf>  3  3    0.99475641
<CAS-nat-orb|mo-hf>  4  4    0.99950402
<CAS-nat-orb|mo-hf>  5  5    0.99460067
<CAS-nat-orb|mo-hf>  6  6    0.99808720
<CAS-nat-orb|mo-hf>  7  7    0.99017070
<CAS-nat-orb|mo-hf>  8  8    0.93329643
<CAS-nat-orb|mo-hf>  9  9    0.96133983
<CAS-nat-orb|mo-hf>  10  10    0.97346862
CASSCF energy = -75.4381047478867
CASCI E = -75.4381047478867  E(CI) = -14.5778601831506  S^2 = 0.0000000
 UseMainStack = 0 MinDiskUsage = 1 MinMemUsage = 0 IBuf = 0 OBuf = 0
 FPCompression: prec = 1.00e-16 chunk = 1024
 IMain = 0 B / 134 MB DMain = 0 B / 2.48 GB ISeco = 0 B / 57.2 MB DSeco = 0 B / 1.06 GB
 OpenMP = 1 TBB = 0 MKL = GNU 2021.0.4 SeqType = None MKLIntLen = 4
 THREADING = 2 layers : Global | Operator BatchedGEMM 
 NUMBER : Global = 24 Operator = 24 Quanta = 0 MKL = 1
 COMPLEX = 1 SINGLE-PREC = 1 KSYMM = 0
symm error =  0.0

DRT Big Site :: NORBS = 2 Left ORB-SYM = [ 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.000
  Build normal operator C0.. NOPS = 2 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 2
    SIZE =    160 B NNZ =    160 B SPT = 0.0000 T =      0.000
  Build normal operator A0.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=0 PG=0 > ] EXPRS = [ (C+C)0 ] NTERMS = 3
    SIZE =     72 B NNZ =     72 B SPT = 0.0000 T =      0.000
  Build normal operator A1.. NOPS = 3 ..
    HDRT :: QS = [ < N=2 S=1 PG=0 > ] EXPRS = [ (C+C)2 ] NTERMS = 3
    SIZE =     24 B NNZ =      8 B SPT = 0.6667 T =      0.000
  Build normal operator B0.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 4
    SIZE =    360 B NNZ =    152 B SPT = 0.5778 T =      0.000
  Build normal operator B1.. NOPS = 3 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 4
    SIZE =    264 B NNZ =    184 B SPT = 0.3030 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 22
    SIZE =    120 B NNZ =    120 B SPT = 0.0000 T =      0.003
  Build complementary operator R0 .. NOPS = 26 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 12
    SIZE =  2.03 KB NNZ =  2.03 KB SPT = 0.0000 T =      0.005
ALL SIZE =  3.12 KB NNZ =  2.83 KB SPT = 0.0950 T =      0.009

DRT Big Site :: NORBS = 18 Right ORB-SYM = [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]
  Build normal operator I.. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [  ] NTERMS = 1
    SIZE =   414 KB NNZ =  2.68 KB SPT = 0.9935 T =      0.000
  Build normal operator C0.. NOPS = 18 ..
    HDRT :: QS = [ < N=1 S=1/2 PG=0 > ] EXPRS = [ C ] NTERMS = 18
    SIZE =   823 KB NNZ =  5.06 KB SPT = 0.9938 T =      0.000
  Build complementary operator H .. NOPS = 1 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ ((C+(C+D)0)1+D)0 + (C+D)0 ] NTERMS = 58806
    SIZE =   414 KB NNZ =  56.4 KB SPT = 0.8637 T =      0.034
  Build complementary operator R0 .. NOPS = 10 ..
    HDRT :: QS = [ < N=-1 S=1/2 PG=0 > ] EXPRS = [ ((C+D)0+D)1 + D ] NTERMS = 6156
    SIZE =   457 KB NNZ =  62.5 KB SPT = 0.8632 T =      0.013
  Build complementary operator P0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=0 PG=0 > ] EXPRS = [ (D+D)0 ] NTERMS = 171
    SIZE =  73.5 KB NNZ =  11.0 KB SPT = 0.8509 T =      0.003
  Build complementary operator P1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=-2 S=1 PG=0 > ] EXPRS = [ (D+D)2 ] NTERMS = 171
    SIZE =  65.7 KB NNZ =  7.53 KB SPT = 0.8854 T =      0.003
  Build complementary operator Q0 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=0 PG=0 > ] EXPRS = [ (C+D)0 ] NTERMS = 324
    SIZE =  22.2 MB NNZ =   754 KB SPT = 0.9669 T =      0.008
  Build complementary operator Q1 .. NOPS = 55 ..
    HDRT :: QS = [ < N=0 S=1 PG=0 > ] EXPRS = [ (C+D)2 ] NTERMS = 324
    SIZE =  31.9 MB NNZ =  1.07 MB SPT = 0.9665 T =      0.011
ALL SIZE =  56.3 MB NNZ =  1.95 MB SPT = 0.9654 T =      0.074
Environment initialization | Nsites =    10 | Center =     0
 INIT-R <-- Site =    7 ..  Bmem =     0 B Rmem = 30.2 MB T = 0.07
 INIT-R <-- Site =    6 ..  Bmem =  187 MB Rmem = 15.3 MB T = 0.08
 INIT-R <-- Site =    5 ..  Bmem =  148 MB Rmem = 11.1 MB T = 0.06
 INIT-R <-- Site =    4 ..  Bmem =  104 MB Rmem = 6.55 MB T = 0.02
 INIT-R <-- Site =    3 ..  Bmem = 67.4 MB Rmem = 5.12 MB T = 0.05
 INIT-R <-- Site =    2 ..  Bmem = 45.4 MB Rmem = 4.02 MB T = 0.01
 INIT-R <-- Site =    1 ..  Bmem = 35.2 MB Rmem =  398 KB T = 0.01
 INIT-R <-- Site =    0 ..  Bmem = 2.86 MB Rmem = 26.9 KB T = 0.00
Time init sweep =        0.298 | MaxBmem =  187 MB | MaxRmem = 15.3 MB
 | Tread = 0.000 | Twrite = 0.189 | Tfpread = 0.000 | Tfpwrite = 0.186 | data = 72.7 MB | cpsd = 54.6 MB | Tasync = 0.000


Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      1.265 | E =     -75.5296653335 | DW = 1.38e-05

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      2.389 | E =     -75.5565207931 | DE = -2.69e-02 | DW = 3.41e-05

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      3.213 | E =     -75.5572939307 | DE = -7.73e-04 | DW = 2.00e-04

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.082 | E =     -75.5579095381 | DE = -6.16e-04 | DW = 1.07e-04

Sweep =    4 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      4.788 | E =     -75.5579778297 | DE = -6.83e-05 | DW = 2.01e-04

Sweep =    5 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      5.694 | E =     -75.5579984486 | DE = -2.06e-05 | DW = 1.02e-04

Sweep =    6 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      6.431 | E =     -75.5580195351 | DE = -2.11e-05 | DW = 2.02e-04

Sweep =    7 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-03 | Dav threshold =  1.00e-04
Time elapsed =      7.277 | E =     -75.5580172771 | DE = 2.26e-06 | DW = 1.01e-04

Sweep =    8 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =      9.699 | E =     -75.5588340938 | DE = -8.17e-04 | DW = 1.71e-05

Sweep =    9 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     14.303 | E =     -75.5592429112 | DE = -4.09e-04 | DW = 2.93e-05

Sweep =   10 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     17.075 | E =     -75.5593481535 | DE = -1.05e-04 | DW = 4.68e-05

Sweep =   11 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     19.933 | E =     -75.5594151934 | DE = -6.70e-05 | DW = 3.49e-05

Sweep =   12 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     23.598 | E =     -75.5594766272 | DE = -6.14e-05 | DW = 5.03e-05

Sweep =   13 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     26.558 | E =     -75.5594964714 | DE = -1.98e-05 | DW = 3.66e-05

Sweep =   14 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     29.228 | E =     -75.5595019572 | DE = -5.49e-06 | DW = 5.07e-05

Sweep =   15 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     32.682 | E =     -75.5595041949 | DE = -2.24e-06 | DW = 3.66e-05

Sweep =   16 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     39.437 | E =     -75.5596324068 | DE = -1.28e-04 | DW = 2.70e-06

Sweep =   17 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     50.350 | E =     -75.5596772125 | DE = -4.48e-05 | DW = 2.04e-06

Sweep =   18 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     61.365 | E =     -75.5596855340 | DE = -8.32e-06 | DW = 4.60e-06

Sweep =   19 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     75.297 | E =     -75.5596868586 | DE = -1.32e-06 | DW = 2.16e-06

Sweep =   20 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     84.930 | E =     -75.5596872739 | DE = -4.15e-07 | DW = 4.59e-06

Sweep =   21 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =     96.768 | E =     -75.5596880866 | DE = -8.13e-07 | DW = 2.15e-06

Sweep =   22 | Direction =  forward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    105.199 | E =     -75.5596883162 | DE = -2.30e-07 | DW = 4.56e-06

Sweep =   23 | Direction = backward | Bond dimension = 1000 | Noise =  1.00e-04 | Dav threshold =  1.00e-05
Time elapsed =    116.604 | E =     -75.5596890597 | DE = -7.44e-07 | DW = 2.14e-06

Sweep =   24 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    144.517 | E =     -75.5596944261 | DE = -5.37e-06 | DW = 2.39e-07

Sweep =   25 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    171.399 | E =     -75.5596975718 | DE = -3.15e-06 | DW = 1.15e-07

Sweep =   26 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    205.007 | E =     -75.5596982578 | DE = -6.86e-07 | DW = 2.59e-07

Sweep =   27 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    252.991 | E =     -75.5596984855 | DE = -2.28e-07 | DW = 1.16e-07

Sweep =   28 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    276.609 | E =     -75.5596987686 | DE = -2.83e-07 | DW = 2.59e-07

Sweep =   29 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    300.817 | E =     -75.5596989857 | DE = -2.17e-07 | DW = 1.17e-07

Sweep =   30 | Direction =  forward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    323.932 | E =     -75.5596991207 | DE = -1.35e-07 | DW = 2.52e-07

Sweep =   31 | Direction = backward | Bond dimension = 1800 | Noise =  5.00e-05 | Dav threshold =  5.00e-06
Time elapsed =    364.247 | E =     -75.5596993666 | DE = -2.46e-07 | DW = 1.17e-07

Sweep =   32 | Direction =  forward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    532.820 | E =     -75.5597087771 | DE = -9.41e-06 | DW = 6.47e-08

Sweep =   33 | Direction = backward | Bond dimension = 1800 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    571.544 | E =     -75.5597087772 | DE = -8.56e-11 | DW = 6.47e-08

E(MRCI) = -75.55970877721553  E_corr = -0.1216040293288643
Time cost =    636.066
